Repository: plone.restapi


Branch: refs/heads/master
Date: 2021-03-13T01:13:56+01:00
Author: Tiberiu Ichim (tiberiuichim) <tiberiuichim@users.noreply.github.com>
Commit: https://github.com/plone/plone.restapi/commit/629a59cd029813225c151ee7b0e19b57c665c2bb

Try to fix buildout for all python versions (#1086)

* Fix buildout - WIP

* Add pin for pyroma for version compatible with py2

* Pin version for importlib-metadata

* Add changelog entry

* More pins

* More pins

Files changed:
A news/1086.bugfix
M Makefile
M base.cfg
M plone-5.1.x.cfg
M plone-5.2.x.cfg

b"diff --git a/Makefile b/Makefile\nindex 9af7ff733..aa9317a06 100644\n--- a/Makefile\n+++ b/Makefile\n@@ -40,10 +40,10 @@ bin/buildout: bin/pip\n \t@touch -c $@\n \n bin/python bin/pip:\n-\tpython$(version) -m venv . || virtualenv --clear --python=python$(version) .\n+\tpython$(version) -m venv . || virtualenv --python=python$(version) .\n \n py2:\n-\tvirtualenv --clear --python=python2 .\n+\tvirtualenv --python=python2 .\n \tbin/pip install --upgrade pip\n \tbin/pip install -r requirements.txt\n \ndiff --git a/base.cfg b/base.cfg\nindex 00cb642cb..e03ff03e7 100644\n--- a/base.cfg\n+++ b/base.cfg\n@@ -205,3 +205,6 @@ plone.schema = git git://github.com/plone/plone.schema.git pushurl=git@github.co\n \n [versions]\n plone.restapi =\n+\n+# 3.0 drops python2 compatibility\n+pyroma = 2.6.1\ndiff --git a/news/1086.bugfix b/news/1086.bugfix\nnew file mode 100644\nindex 000000000..0409d19a2\n--- /dev/null\n+++ b/news/1086.bugfix\n@@ -0,0 +1 @@\n+Pin some package versions to fix buildout @tiberiuichim\ndiff --git a/plone-5.1.x.cfg b/plone-5.1.x.cfg\nindex 40165e1c1..3e60f1181 100644\n--- a/plone-5.1.x.cfg\n+++ b/plone-5.1.x.cfg\n@@ -16,6 +16,10 @@ distlib = 0.3.1\n # fixes: SyntaxError: invalid syntax (more.py, line 340)\n zipp = 0.5.2\n \n+# Error: The requirement ('importlib-metadata>=1') is not allowed by your [versions] constraint (0.23)\n+importlib-metadata = 2.1.1\n+keyring = 22.0.1\n+\n # zest.releaser\n zest.releaser = 6.20.1\n twine = 1.11.0\ndiff --git a/plone-5.2.x.cfg b/plone-5.2.x.cfg\nindex 37644474e..5cb4ebcab 100644\n--- a/plone-5.2.x.cfg\n+++ b/plone-5.2.x.cfg\n@@ -15,7 +15,8 @@ virtualenv = 20.0.35\n pep517 = 0.9.1\n \n # Error: The requirement ('importlib-metadata>=1') is not allowed by your [versions] constraint (0.23)\n-importlib-metadata = 2.0.0\n+importlib-metadata = 2.1.1\n+keyring = 22.0.1\n \n # avoid dynamic schema updates: https://github.com/plone/plone.dexterity/pull/137\n plone.dexterity = 2.9.8\n@@ -24,4 +25,4 @@ plone.dexterity = 2.9.8\n plone.restapi =\n \n # cffi 1.14.3 fails on apple m1\n-cffi = 1.14.4\n\\ No newline at end of file\n+cffi = 1.14.4\n"

