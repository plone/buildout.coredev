Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/0c50262be06e18cac3df38f35a82c69d6d9d2b8e

refactoring actionmenu robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_actionmenu.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_actionmenu.robot b/Products/CMFPlone/tests/robot/test_actionmenu.robot\nindex 58539cb3ec..40d93dc9b7 100644\n--- a/Products/CMFPlone/tests/robot/test_actionmenu.robot\n+++ b/Products/CMFPlone/tests/robot/test_actionmenu.robot\n@@ -1,24 +1,21 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n+*** Variables ***\n \n-*** Variables ****************************************************************\n+${TITLE}    An actionsmenu page\n+${PAGE_ID}    an-actionsmenu-page\n \n-${TITLE}  An actionsmenu page\n-${PAGE_ID}  an-actionsmenu-page\n \n-\n-*** Test cases ***************************************************************\n+*** Test Cases ***\n \n # ---\n # Basic Contentactions menu\n@@ -41,13 +38,13 @@ Scenario: Clicking again collapses action menu\n       and an actionsmenu page\n      When menu link is clicked\n       and menu link is clicked\n+     Then actions menu should not be visible\n \n # ---\n # Switching Contentactions menu by MouseOver\n # ---\n \n-Scenario: Hovering mouse from expanded menu on other menu shows that menu\n-    Pass Execution  This functionality needs to be fixed for Plone 5, but let\'s not make it break the build for now.\n+Scenario: Click from expanded menu on other menu shows that menu\n     Given a logged-in site administrator\n       and an actionsmenu page\n      When first menu link is clicked\n@@ -55,9 +52,9 @@ Scenario: Hovering mouse from expanded menu on other menu shows that menu\n      Then second menu should be visible\n       and first menu should not be visible\n \n-# ---\n-# Clicking outside of Contentactions menu\n-# ---\n+---\n+Clicking outside of Contentactions menu\n+---\n \n Scenario: Clicking outside of Contentactions menu\n     Given a logged-in site administrator\n@@ -88,95 +85,78 @@ Scenario:\n      Then I should see \'Item(s) pasted.\' in the page\n \n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n-# --- GIVEN ------------------------------------------------------------------\n+# GIVEN\n \n an actionsmenu page\n-    Create content  type=Document  title=${TITLE}\n-    Go to  ${PLONE_URL}/${PAGE_ID}\n-    Wait until page contains  An actionsmenu page\n+    Create content    type=Document    title=${TITLE}\n+    Go To    ${PLONE_URL}/${PAGE_ID}\n+    Get Text    //body    contains    An actionsmenu page\n+\n+# WHEN\n \n-# --- WHEN -------------------------------------------------------------------\n+first menu link is clicked\n+    Click    xpath=//li[@id=\'plone-contentmenu-workflow\']/a\n \n mouse moves to second menu\n-    Click Link  xpath=(//div[@class="contentActions"]//a[contains(@class, \'actionMenuHeader\')])[2]\n+    Click    xpath=//li[@id=\'plone-contentmenu-actions\']/a\n \n I click outside of menu\n-    Click Element  xpath=//h1\n+    Click    xpath=//h1\n \n workflow link is clicked\n     # store current state\n-    ${OLD_STATE} =  Get Text  xpath=(//span[contains(@class,\'state-\')])\n-    Set Suite Variable  ${OLD_STATE}  ${OLD_STATE}\n-    Given patterns are loaded\n-    Click Link  xpath=//li[@id=\'plone-contentmenu-workflow\']/a\n-    Click Link  xpath=(//li[@id=\'plone-contentmenu-workflow\']/ul/li/a)[1]\n-    Page Should Contain  Item state changed.\n-\n-Open Menu\n-    [Arguments]  ${elementId}\n-    Element Should Not Be Visible  css=#${elementId} ul.actionMenuContent\n-    Click link  css=#${elementId} a.actionMenuHeader\n-    Wait until keyword succeeds  5  1  Element Should Be Visible  css=#${elementId} .actionMenuContent\n-\n-Open Action Menu\n-    Given patterns are loaded\n-    Click link  xpath=//li[@id=\'plone-contentmenu-actions\']/a\n-    Wait until keyword succeeds  5  1  Element Should Be Visible  css=#plone-contentmenu-actions .dropdown-menu\n+    ${OLD_STATE}=    Get Text    xpath=(//span[contains(@class,\'state-\')])\n+    Set Suite Variable    ${OLD_STATE}    ${OLD_STATE}\n+    Click    xpath=//li[@id=\'plone-contentmenu-workflow\']/a\n+    Click    xpath=(//li[@id=\'plone-contentmenu-workflow\']/ul/li/a)[1]\n+    Get Text    //body    contains    Item state changed.\n \n I copy the page\n     Open Action Menu\n-    Click Link  css=#plone-contentmenu-actions .actionicon-object_buttons-copy\n-    Page should contain  copied\n+    Click    xpath=//li[@id=\'plone-contentmenu-actions\']//a[contains(@class,\'actionicon-object_buttons-copy\')]\n+    Get Text    //body    contains    copied\n \n I paste\n     Go to  ${PLONE_URL}\n     Open Action Menu\n-    Click Link  css=#plone-contentmenu-actions .actionicon-object_buttons-paste\n+    Click    xpath=//li[@id=\'plone-contentmenu-actions\']//a[contains(@class,\'actionicon-object_buttons-paste\')]\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n delete link exists\n-     Page Should Contain Element  xpath=//a[@id=\'plone-contentmenu-actions-delete\']\n+    Get Element Count    xpath=//a[@id=\'plone-contentmenu-actions-delete\']    should be    1\n \n delete link should not be visible\n-     Element Should Not Be Visible  xpath=//div[@class=\'contentActions\']//a[@id=\'plone-contentmenu-actions-delete\']\n+    Wait For Elements State    xpath=//li[@id=\'plone-contentmenu-actions\']/a[@id=\'plone-contentmenu-actions-delete\']    hidden\n \n menu link is clicked\n-    Given patterns are loaded\n-    Click link  xpath=//li[@id=\'plone-contentmenu-actions\']/a\n+    Click    xpath=//li[@id=\'plone-contentmenu-actions\']/a\n \n-delete link should be visible\n-    Given patterns are loaded\n-    Element Should Be Visible  xpath=//div[@class=\'contentActions\']//a[@id=\'plone-contentmenu-actions-delete\']\n+second menu should be visible\n+    Get Element States    xpath=//li[@id=\'plone-contentmenu-actions\']/ul[contains(@class,\'dropdown-menu\')]    contains    visible\n \n-actions menu should be visible\n-    Given patterns are loaded\n-    Element Should Be Visible  xpath=//li[@id=\'plone-contentmenu-actions\']\n+first menu should not be visible\n+    Get Element States    xpath=//li[@id=\'plone-contentmenu-workflow\']/ul[contains(@class,\'dropdown-menu\')]    contains    hidden\n \n-first menu link is clicked\n-    Given patterns are loaded\n-    Click Link  xpath=(//div[@class="contentActions"]//a[contains(@class, \'actionMenuHeader\')])[1]\n+actions menu should not be visible\n+    Get Element States    xpath=//li[@id=\'plone-contentmenu-actions\']/ul[contains(@class,\'dropdown-menu\')]    contains    hidden\n \n-I should see \'${message}\' in the page\n-    Wait until page contains  ${message}\n-    Page should contain  ${message}\n+actions menu should be visible\n+    Get Element States    xpath=//li[@id=\'plone-contentmenu-actions\']/ul[contains(@class,\'dropdown-menu\')]    contains    visible\n \n state should have changed\n-    Wait until page contains  Item state changed\n-    ${NEW_STATE} =  Get Text  xpath=(//span[contains(@class,\'state-\')])\n-    # Should Not Be Equal  ${NEW_STATE}  ${OLD_STATE}\n+    ${NEW_STATE}=    Get Text    xpath=(//span[contains(@class,\'state-\')])\n+    Should Not Be Equal As Strings    ${NEW_STATE}    ${OLD_STATE}\n \n-second menu should be visible\n-    Element Should Be Visible  xpath=(//li[contains(@class, \'actionMenu\')])[2]\n+I should see \'${message}\' in the page\n+    Get Text    //body    contains    ${message}\n \n-first menu should not be visible\n-    Given patterns are loaded\n-    Wait until keyword succeeds  10s  1s  Element Should Not Be Visible  xpath=(//li[contains(@class, \'actionMenu\')])[1]//li\n \n-actions menu should not be visible\n-    Given patterns are loaded\n-    Wait until keyword succeeds  10s  1s  Element Should Not Be Visible  xpath=//li[@id=\'plone-contentmenu-actions-delete\']\n+# DRY\n \n+Open Action Menu\n+    Click    xpath=//li[@id=\'plone-contentmenu-actions\']/a\n+    actions menu should be visible\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/73c5332a7670d455108837e33a70c8029ad88253

Fix missing comment char

Files changed:
M Products/CMFPlone/tests/robot/test_actionmenu.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_actionmenu.robot b/Products/CMFPlone/tests/robot/test_actionmenu.robot\nindex 40d93dc9b7..27a4bd10c2 100644\n--- a/Products/CMFPlone/tests/robot/test_actionmenu.robot\n+++ b/Products/CMFPlone/tests/robot/test_actionmenu.robot\n@@ -52,9 +52,9 @@ Scenario: Click from expanded menu on other menu shows that menu\n      Then second menu should be visible\n       and first menu should not be visible\n \n----\n-Clicking outside of Contentactions menu\n----\n+# ---\n+# Clicking outside of Contentactions menu\n+# ---\n \n Scenario: Clicking outside of Contentactions menu\n     Given a logged-in site administrator\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/28c279a4e0773cb4f3277a3ae4a3c0af9deba1cd

refactoring controlpanel actions robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_actions.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot b/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot\nindex 8bb0a2513c..21a44f06ce 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot\n@@ -1,137 +1,143 @@\n *** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run Keywords  Plone test setup\n-Test Teardown  Run keywords  Plone test teardown\n \n+*** Test Cases ***\n \n-*** Test Cases ***************************************************************\n+# hint: the `Sleep` Statement is needed for the `Disable autologin` and the commit in the DB, it takes a while\n \n Scenario: Modify an existing action in Actions Control Panel\n-  Given a logged-in administrator\n-    and the actions control panel\n-   When I modify an action title\n-   Sleep  1\n-   Then anonymous users can see the new action title\n+    Given a logged-in administrator\n+      and the actions control panel\n+     When I modify an action title\n+      and Sleep    1\n+     Then anonymous users can see the new action title\n \n Scenario: Reorder in Actions Control Panel\n-  Given a logged-in administrator\n-    and the actions control panel\n-   When I change the actions order\n-   Sleep  1\n-   Then anonymous users can see the actions new ordering\n+    Given a logged-in administrator\n+      and the actions control panel\n+     When I change the actions order\n+      and Sleep    1\n+     Then anonymous users can see the actions new ordering\n \n Scenario: Create a new action in Actions Control Panel\n-  Given a logged-in administrator\n-    and the actions control panel\n-   When I add a new action\n-   Sleep  1\n-   Then logged-in users can see the new action\n+    Given a logged-in administrator\n+      and the actions control panel\n+     When I add a new action\n+      and Sleep    1\n+     Then logged-in users can see the new action\n \n Scenario: Hide/show an action in Actions Control Panel\n-  Given a logged-in administrator\n-    and the actions control panel\n-   When I hide an action\n-   Sleep  1\n-   Then anonymous users cannot see the action anymore\n-  Given a logged-in administrator\n-    and the actions control panel\n-   When I unhide the action\n-   Sleep  1\n-   Then anonymous users can see the action again\n+    Given a logged-in administrator\n+      and the actions control panel\n+    When I hide an action\n+      and Sleep  1\n+    Then anonymous users cannot see the action anymore\n+    Given a logged-in administrator\n+      and the actions control panel\n+    When I unhide the action\n+      and Sleep  1\n+    Then anonymous users can see the action again\n \n Scenario: Delete an action in Actions Control Panel\n-  Given a logged-in administrator\n-    and the actions control panel\n-   When I delete an action\n-   Sleep  1\n-   Then anonymous users cannot see the action anymore\n+    Given a logged-in administrator\n+      and the actions control panel\n+     When I delete an action\n+      and Sleep  1\n+     Then anonymous users cannot see the action anymore\n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n-# --- GIVEN ------------------------------------------------------------------\n+# GIVEN\n \n a logged-in administrator\n-  Enable autologin as  Manager\n+    Enable autologin as    Manager\n+\n \n the actions control panel\n-  Go to  ${PLONE_URL}/@@actions-controlpanel\n-  Wait until page contains  Portal actions\n+    Go to    ${PLONE_URL}/@@actions-controlpanel\n+    Get Text    //body    contains    Portal actions\n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I modify an action title\n-  Click Link    css=section:nth-child(3) li:first-child a\n-  Wait until page contains  Action Settings\n-  Input Text for sure  form.widgets.title  A new site map\n-  Wait For Then Click Element  css=.pattern-modal-buttons > button\n+    Click    //*[@id="content-core"]/section[2]/section/ol/li[1]/form/a\n+    Get Text    //body    contains    Action Settings\n+    Type Text    //input[@name="form.widgets.title"]    A new site map\n+    Click    //div[contains(@class,\'pattern-modal-buttons\')]/button\n+\n \n I change the actions order\n-  Click Link    css=section:nth-child(3) li:first-child a\n-  Wait until page contains  Action Settings\n-  Input Text for sure  form.widgets.position  3\n-  Wait For Then Click Element  css=.pattern-modal-buttons > button\n+    Click    //*[@id="content-core"]/section[2]/section/ol/li[1]/form/a\n+    Get Text    //body    contains    Action Settings\n+    Type Text    //input[@name="form.widgets.position"]    3\n+    Click    //div[contains(@class,\'pattern-modal-buttons\')]/button\n+\n \n I add a new action\n-  Click Link  Add new action\n-  Wait until page contains  New action\n-  Select From List By Label   form.widgets.category:list   User actions\n-  Input Text for sure  form.widgets.id  favorites\n-  Wait For Then Click Element  css=.pattern-modal-buttons > button\n-  Wait until page contains  favorites\n-  Wait For Then Click Element  css=section.category:last-child li:last-child a\n-  Wait until page contains  Action Settings\n-  Input Text for sure  form.widgets.title  My favorites\n-  Input Text for sure  form.widgets.url_expr  string:\\${globals_view/navigationRootUrl}/favorites\n-  Wait For Then Click Element  css=.pattern-modal-buttons > button\n+    Click    //*[@id="content-core"]/p[@class="addAction"]/a\n+    Get Text    //body    contains    New action\n+    Select Options By    //select[@name="form.widgets.category:list"]    label    User actions\n+    Type Text    //input[@name="form.widgets.id"]    favorites\n+    Click    //div[contains(@class,\'pattern-modal-buttons\')]/button\n+    Get Text    //body    contains    favorites\n+    Click    //*[@id="content-core"]/section[6]/section/ol/li[8]/form/a\n+    Get Text    //body    contains    Action Settings\n+    Type Text    //input[@name="form.widgets.title"]    My favorites\n+    Type Text    //input[@name="form.widgets.url_expr"]    string:\\${globals_view/navigationRootUrl}/favorites\n+    Click    //div[contains(@class,\'pattern-modal-buttons\')]/button\n \n-I delete an action\n-  Click Button    css=section:nth-child(3) li:first-child button[name=delete]\n-  Handle alert\n \n I hide an action\n-  Click Button    css=section:nth-child(3) li:first-child button[name=hide]\n+    Click    //*[@id="content-core"]/section[2]/section/ol/li[1]/form/button[@name="hide"]\n+\n \n I unhide the action\n-  Click Button    css=section:nth-child(3) li:first-child button[name=show]\n+    Click    //*[@id="content-core"]/section[2]/section/ol/li[1]/form/button[@name="show"]\n+\n \n-# --- THEN -------------------------------------------------------------------\n+I delete an action\n+    Handle Future Dialogs    action=accept\n+    Click    //*[@id="content-core"]/section[2]/section/ol/li[1]/form/button[@name="delete"]\n+\n+\n+# THEN\n \n anonymous users can see the new action title\n-  Disable autologin\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Accessibility\n-  Page Should Contain  A new site map\n+    Disable autologin\n+    Go to    ${PLONE_URL}\n+    Get Text    //body    contains    A new site map\n+\n \n anonymous users can see the actions new ordering\n-  Disable autologin\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Accessibility\n-  Page Should Contain Element   xpath=//div[@id=\'portal-footer\']//ul/li[1]/a/span[contains(text(), \'Accessibility\')]\n-  Page Should Contain Element   xpath=//div[@id=\'portal-footer\']//ul/li[3]/a/span[contains(text(), \'Site Map\')]\n+    Disable autologin\n+    Go to  ${PLONE_URL}\n+    Get Element    //div[@id=\'portal-footer\']//ul/li[1]/a/span[contains(text(), \'Accessibility\')]\n+    Get Element    //div[@id=\'portal-footer\']//ul/li[3]/a/span[contains(text(), \'Site Map\')]\n+\n \n logged-in users can see the new action\n-  Disable autologin\n-  Enable autologin as   Contributor\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Accessibility\n-  Page Should Contain  My favorites\n+    Disable autologin\n+    Enable autologin as   Contributor\n+    Go to  ${PLONE_URL}\n+    Get Element Count    //*[@id="personaltools-favorites"]    should be    1\n+    Get Text    //*[@id="personaltools-favorites"]    contains    My favorites\n+\n \n anonymous users cannot see the action anymore\n-  Disable autologin\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Accessibility\n-  Page Should Not Contain  Site Map\n+    Disable autologin\n+    Go to  ${PLONE_URL}\n+    Get Text    //body    not contains    Site Map\n+\n \n anonymous users can see the action again\n-  Disable autologin\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Accessibility\n-  Page Should Contain  Site Map\n+    Disable autologin\n+    Go to  ${PLONE_URL}\n+    Get Text    //body    contains    Site Map\n\\ No newline at end of file\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/50c97d3c29a956c4ce4b90c666d7145f6f0bc454

polish keywords

Files changed:
M Products/CMFPlone/tests/robot/keywords.robot
M Products/CMFPlone/tests/robot/test_controlpanel_actions.robot

b"diff --git a/Products/CMFPlone/tests/robot/keywords.robot b/Products/CMFPlone/tests/robot/keywords.robot\nindex ca0c598c4b..d7a29f2a70 100644\n--- a/Products/CMFPlone/tests/robot/keywords.robot\n+++ b/Products/CMFPlone/tests/robot/keywords.robot\n@@ -1,39 +1,57 @@\n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n-# --- SETUP ------------------------------------------------------------------\n+# SETUP\n \n Refresh JS/CSS resources\n   # Not needed anymore, and it is breaking the Plone Zope 4 tests.\n   # Keep the keyword for backwards compatibility purposes.\n   Sleep  0.0000001\n \n-# --- GIVEN ------------------------------------------------------------------\n+# GIVEN\n+\n+a logged-in administrator\n+    Enable autologin as\n+    ...    Manager\n \n a logged-in site administrator\n-  Enable autologin as  Site Administrator  Contributor  Reviewer\n+    Enable autologin as\n+    ...    Site Administrator\n+    ...    Contributor\n+    ...    Reviewer\n+\n \n a document '${title}'\n-  Create content  type=Document  id=doc  title=${title}\n+    Create content\n+    ...    type=Document\n+    ...    id=doc\n+    ...    title=${title}\n \n a file '${title}'\n-  Create content  type=File  id=file  title=${title}\n+    Create content\n+    ...    type=File\n+    ...    id=file\n+    ...    title=${title}\n \n a news item '${title}'\n-  Create content  type=News Item  id=doc  title=${title}\n+    Create content\n+    ...    type=News Item\n+    ...    id=doc\n+    ...    title=${title}\n \n an image '${title}'\n-  Create content  type=Image  id=doc  title=${title}\n+    Create content\n+    ...    type=Image\n+    ...    id=doc\n+    ...    title=${title}\n \n a folder '${title}'\n-  Create content  type=Folder  title=${title}\n-\n-patterns are loaded\n-  Wait For Condition  return !!document.querySelector('body.patterns-loaded')\n+    Create content\n+    ...    type=Folder\n+    ...    title=${title}\n \n a folder with a document '${title}'\n-  ${folder_uid}=  Create content  type=Folder  title=folder\n-  Create content  type=Document  container=${folder_uid}  title=${title}\n-\n-folder contents pattern loaded\n-    Page should contain element  css=.pat-structure\n-    Wait For Condition  return !!document.querySelector('.pat-structure div.navbar')\n+    ${folder_uid}=    Create content    type=Folder    title=folder\n+    Create content\n+    ...    type=Document\n+    ...    container=${folder_uid}\n+    ...    title=${title}\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot b/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot\nindex 21a44f06ce..76d00ba201 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot\n@@ -57,10 +57,6 @@ Scenario: Delete an action in Actions Control Panel\n \n # GIVEN\n \n-a logged-in administrator\n-    Enable autologin as    Manager\n-\n-\n the actions control panel\n     Go to    ${PLONE_URL}/@@actions-controlpanel\n     Get Text    //body    contains    Portal actions\n"

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/101d29ac3f7b339e3845e1583116acf6635a2920

refactoring controlpanel robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_editing.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_editing.robot b/Products/CMFPlone/tests/robot/test_controlpanel_editing.robot\nindex 3d997f0899..d9fd742bba 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_editing.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_editing.robot\n@@ -1,105 +1,107 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n+*** Variables ***\n \n-*** Test Cases ***************************************************************\n+${PAGE_TITLE}    Doc\n+${PAGE_ID}    doc\n+\n+*** Test Cases ***\n \n Scenario: Disable Standard Editor in the Editing Control Panel\n-  Given a logged-in site administrator\n-    and the editing control panel\n-   When I disable the standard editor\n-# XXX: This test fails because the TinyMCE 4 widget ignores both the old and\n-# the new setting.\n-#   Then I do not see the standard editor when I create a document\n+    Given a logged-in site administrator\n+      and the editing control panel\n+     When I disable the standard editor\n+     Then I do not see the standard editor when I create a document\n+\n+     When I go to the editing control panel\n+      and I enable the standard editor\n+     Then I see the standard editor when I create a document\n+\n \n Scenario: Enable Link Integrity Check in the Editing Control Panel\n   Given a logged-in site administrator\n     and the editing control panel\n    When I enable link integrity checks\n-# XXX: Enabling referencefield behaviour for Documents to make this test work makes other tests fail.\n-# See https://github.com/plone/Products.CMFPlone/issues/255 for details.\n-#   Then I will be warned if I remove a linked document\n+  # Linkintegrity checks are in `test_linkintegrity.robot`\n \n \n Scenario: Enable Lock on Through The Web in the Editing Control Panel\n   Given a logged-in site administrator\n     and the editing control panel\n+    and a document \'${PAGE_TITLE}\'\n    When I enable lock on through the web\n-# XXX: This test is not finished yet.\n-#   Then I will see a warning if a document is edited by another user\n+    and I edit the document\n+   Then I will see a warning if a document is edited by another user\n \n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n-# --- GIVEN ------------------------------------------------------------------\n+# GIVEN\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+the editing control panel\n+    Go to    ${PLONE_URL}/@@editing-controlpanel\n \n-a logged-in manager\n-  Enable autologin as  Manager\n \n-a document \'${title}\'\n-  Create content  type=Document  id=doc  title=${title}\n+# WHEN\n \n-the editing control panel\n-  Go to  ${PLONE_URL}/@@editing-controlpanel\n-  Wait until page contains  Editing Settings\n+I disable the standard editor\n+    Select Options By    //select[@name="form.widgets.default_editor:list"]    label    None\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n-# --- WHEN -------------------------------------------------------------------\n \n-I disable the standard editor\n-  Select from list by label  name=form.widgets.default_editor:list  None\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+I enable the standard editor\n+    Select Options By    //select[@name="form.widgets.default_editor:list"]    label    TinyMCE\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n+\n+\n+I go to the editing control panel\n+    Go to    ${PLONE_URL}/@@editing-controlpanel\n+\n \n I enable link integrity checks\n-  Select Checkbox  name=form.widgets.enable_link_integrity_checks:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.enable_link_integrity_checks:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n+\n \n I enable lock on through the web\n-  Select Checkbox  name=form.widgets.lock_on_ttw_edit:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.lock_on_ttw_edit:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n+I edit the document\n+    Go to    ${PLONE_URL}/${PAGE_ID}\n+    Click    //li[@id="contentview-edit"]/a\n+    Get Text    //body    contains    Edit Page\n \n-# --- THEN -------------------------------------------------------------------\n \n-I can see an id field in the settings tab when I create a document\n-  Go To  ${PLONE_URL}/++add++Document\n-  Given patterns are loaded\n-  Execute Javascript  $(\'#form-widgets-IDublinCore-title\').val(\'My Document\'); return 0;\n-  Click Link  Settings\n-  Page should contain element  name=form.widgets.IShortName.id\n-  Input Text  name=form.widgets.IShortName.id  this-is-my-custom-short-name\n-  Click Button  Save\n-  Wait until page contains  Item created\n-  Location should be  ${PLONE_URL}/this-is-my-custom-short-name/view\n+# THEN\n \n I do not see the standard editor when I create a document\n-  Go To  ${PLONE_URL}/++add++Document\n-  Wait until page contains  Add Page\n-  Page should not contain element  css=.mce-tinymce\n-\n-I will be warned if I remove a linked document\n-  ${doc1_uid}=  Create content  id=doc1  type=Document\n-  ${doc2_uid}=  Create content  id=doc2  type=Document\n-  Set field value  uid=${doc1_uid}  field=text  field_type=text/html  value=<p><a href=\'resolveuid/${doc2_uid}\' data-val=\'${doc2_uid}\' data-linktype=\'internal\'>link</a></p>\n-  Go To  ${PLONE_URL}/doc2/delete_confirmation\n-  Wait until page contains  doc2\n-  Click Button  Delete\n-  Wait until page contains  Potential link breakage\n+    Go To  ${PLONE_URL}/++add++Document\n+    Get Element Count    //*[@id="formfield-form-widgets-IRichTextBehavior-text"]/div[@role="application"]    should be    0\n+    Get Element States    //textarea[@name="form.widgets.IRichTextBehavior.text"]    contains    visible\n+\n+\n+I see the standard editor when I create a document\n+    Go To  ${PLONE_URL}/++add++Document\n+    Get Element Count    //*[@id="formfield-form-widgets-IRichTextBehavior-text"]/div[@role="application"]    should be    1\n+    Get Element States    //textarea[@name="form.widgets.IRichTextBehavior.text"]    contains    hidden\n \n I will see a warning if a document is edited by another user\n-  ${doc1_uid}=  Create content  id=doc1  type=Document\n+    Disable autologin\n+    Enable autologin as   Contributor    Reviewer    Manager\n+    New Page    ${PLONE_URL}/${PAGE_ID}\n+    Get Text    //body    contains    Lock\n+    Get Element Count    //input[@value="Unlock"]    should be    1\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/1d4bdb0760f20495566e7a7837cd687618cdb51c

polishing controlpanel editing robot test

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_editing.robot

b"diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_editing.robot b/Products/CMFPlone/tests/robot/test_controlpanel_editing.robot\nindex d9fd742bba..132b75c494 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_editing.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_editing.robot\n@@ -28,19 +28,19 @@ Scenario: Disable Standard Editor in the Editing Control Panel\n \n \n Scenario: Enable Link Integrity Check in the Editing Control Panel\n-  Given a logged-in site administrator\n-    and the editing control panel\n-   When I enable link integrity checks\n-  # Linkintegrity checks are in `test_linkintegrity.robot`\n+    Given a logged-in site administrator\n+      and the editing control panel\n+    When I enable link integrity checks\n+    # Linkintegrity checks are in `test_linkintegrity.robot`\n \n \n Scenario: Enable Lock on Through The Web in the Editing Control Panel\n-  Given a logged-in site administrator\n-    and the editing control panel\n-    and a document '${PAGE_TITLE}'\n-   When I enable lock on through the web\n-    and I edit the document\n-   Then I will see a warning if a document is edited by another user\n+    Given a logged-in site administrator\n+      and the editing control panel\n+      and a document '${PAGE_TITLE}'\n+     When I enable lock on through the web\n+      and I edit the document\n+     Then I will see a warning if a document is edited by another user\n \n \n *** Keywords ***\n"

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/5ab4b5a5ba4f675393bd9616bb398e504cd921be

add keywords

Files changed:
M Products/CMFPlone/tests/robot/keywords.robot

b'diff --git a/Products/CMFPlone/tests/robot/keywords.robot b/Products/CMFPlone/tests/robot/keywords.robot\nindex d7a29f2a70..29899db3c7 100644\n--- a/Products/CMFPlone/tests/robot/keywords.robot\n+++ b/Products/CMFPlone/tests/robot/keywords.robot\n@@ -54,4 +54,36 @@ a folder with a document \'${title}\'\n     Create content\n     ...    type=Document\n     ...    container=${folder_uid}\n-    ...    title=${title}\n\\ No newline at end of file\n+    ...    title=${title}\n+\n+Remove line from textarea\n+    [Arguments]    ${fieldName}    ${value}\n+\n+    Import library    String\n+    ${lines}=  Get Text    //textarea[@name="${fieldName}"]\n+    ${lines}=  Remove String    ${lines}    ${value}\\n\n+    Type Text    //textarea[@name="${fieldName}"]    ${lines}\n+\n+\n+Fill text to tinymce editor\n+    [Arguments]    ${attr_name}    ${input}\n+\n+    Wait For Condition    Attribute    //body    class    contains    patterns-loaded\n+\n+    Sleep    1\n+\n+    Evaluate JavaScript    //textarea[@name="${attr_name}"]\n+    ...    (elem, text) => {\n+    ...        elem["pattern-tinymce"].instance.tiny.setContent(\'${input}\');\n+    ...    }\n+    ...    all_elements=False\n+\n+    Sleep    0.5\n+\n+    ${check}=    Evaluate JavaScript    //textarea[@name="${attr_name}"]\n+    ...    (elem) => {\n+    ...        return elem["pattern-tinymce"].instance.tiny.getContent();\n+    ...    }\n+    ...    all_elements=False\n+\n+    Should not be empty    ${check}\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/fa2c4bcafd0c92a48c5948327faa11b3c6a902a4

port controlpanel filter robot test

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_filter.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot b/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot\nindex bcdf3307aa..aa5c60f1be 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot\n@@ -1,160 +1,162 @@\n-# ============================================================================\n-# Tests for the Plone Filter Control Panel\n-# ============================================================================\n-#\n-# $ bin/robot-server --reload-path src/Products.CMFPlone/Products/CMFPlone/ Products.CMFPlone.testing.PRODUCTS_CMFPLONE_ROBOT_TESTING\n-#\n-# $ bin/robot src/Products.CMFPlone/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot\n-#\n-# ============================================================================\n-\n *** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n-\n-Library  Remote  ${PLONE_URL}/RobotRemote\n-Library  Collections\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Resource  keywords.robot\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n \n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Configure Filter Control Panel to filter out nasty tags\n-  Given a logged-in site administrator\n-    and the filter control panel\n-   When I add \'h1\' to the nasty tags list and remove it from the valid tags list\n-   Then the \'h1\' tag is filtered out when a document is saved\n+    Given a logged-in site administrator\n+      and the filter control panel\n+     When I add \'h1\' to the nasty tags list and remove it from the valid tags list\n+     Then the \'h1\' tag is filtered out when a document is saved\n \n Scenario: Configure Filter Control Panel to strip out tags\n-  Given a logged-in site administrator\n-    and the filter control panel\n-   When I remove \'h1\' from the valid tags list\n-   Then the \'h1\' tag is stripped when a document is saved\n+    Given a logged-in site administrator\n+      and the filter control panel\n+     When I remove \'h1\' from the valid tags list\n+     Then the \'h1\' tag is stripped when a document is saved\n \n Scenario: Configure Filter Control Panel to allow custom tags\n-  Given a logged-in site administrator\n-    and the filter control panel\n-   When I add \'foobar\' to the valid tags list\n-   Then the \'foobar\' tag is preserved when a document is saved\n+    Given a logged-in site administrator\n+      and the filter control panel\n+     When I add \'foobar\' to the valid tags list\n+     Then the \'foobar\' tag is preserved when a document is saved\n \n Scenario: Configure Filter Control Panel to allow custom attributes\n-  Given a logged-in site administrator\n-    and the filter control panel\n-   When I add \'foo-foo\' to the custom attributes list\n-   Then the \'foo-foo\' attribute is preserved when a document is saved\n+    Given a logged-in site administrator\n+      and the filter control panel\n+     When I add \'foo-foo\' to the custom attributes list\n+     Then the \'foo-foo\' attribute is preserved when a document is saved\n \n Scenario: Filter Control Panel displays information regarding caching when saved\n-  Given a logged-in site administrator\n-    and the filter control panel\n-   When I save the form\n-   Then success message should contain information regarding caching\n-\n+    Given a logged-in site administrator\n+      and the filter control panel\n+     When I save the form\n+     Then success message should contain information regarding caching\n \n-*** Keywords *****************************************************************\n \n-# --- GIVEN ------------------------------------------------------------------\n+*** Keywords ***\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+# GIVEN\n \n the filter control panel\n-  Go to  ${PLONE_URL}/@@filter-controlpanel\n-  Wait until page contains  HTML Filtering Settings\n-\n-Input RichText\n-  [Arguments]  ${input}\n-  # Sleep to avoid random failures where the text is not actually set.\n-  # This warning from the robotframework docs might be the cause:\n-  # "Starting from Robot Framework 2.5 errors caused by invalid syntax, timeouts,\n-  # or fatal exceptions are not caught by this keyword."\n-  # See https://robotframework.org/robotframework/2.6.1/libraries/BuiltIn.html#Wait%20Until%20Keyword%20Succeeds\n-  Sleep  1\n-  Wait until keyword succeeds  5s  1s  Set and Check TinyMCE Content  ${input}\n-\n-Set and Check TinyMCE Content\n-  [Arguments]  ${input}\n-  # Simply check if tinyMCE.getContent() isn\'t empty when we set an input\n-  Execute Javascript   tinyMCE.activeEditor.setContent(\'${input}\');\n-  Sleep  0.5\n-  ${check}=  Execute Javascript  return tinyMCE.activeEditor.getContent();\n-  Should not be empty  ${check}\n-\n-\n-# --- WHEN -------------------------------------------------------------------\n+    Go to    ${PLONE_URL}/@@filter-controlpanel\n+\n+# WHEN\n \n I add \'${tag}\' to the nasty tags list and remove it from the valid tags list\n-  Input Text  name=form.widgets.nasty_tags  ${tag}\n-  Remove line from textarea  form.widgets.valid_tags  ${tag}\n-  I save the form\n+    Type Text    //textarea[@name="form.widgets.nasty_tags"]    ${tag}\n+    Remove line from textarea    form.widgets.valid_tags    ${tag}\n+    I save the form\n+\n+\n+I save the form\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n+\n \n I remove \'${tag}\' from the valid tags list\n-  Remove line from textarea  form.widgets.valid_tags  ${tag}\n-  I save the form\n+    Remove line from textarea    form.widgets.valid_tags    ${tag}\n+    I save the form\n+\n \n I add \'${tag}\' to the valid tags list\n-  Input Text  name=form.widgets.valid_tags  ${tag}\n-  I save the form\n-  Page Should Contain  ${tag}\n+    Type Text    //textarea[@name="form.widgets.valid_tags"]    ${tag}\n+    I save the form\n+    Get Text    //textarea[@name="form.widgets.valid_tags"]    contains    ${tag}\n+\n \n I add \'${tag}\' to the custom attributes list\n-  Input Text  name=form.widgets.custom_attributes  ${tag}\n-  I save the form\n-  Page Should Contain  ${tag}\n+    Type Text    //textarea[@name="form.widgets.custom_attributes"]    ${tag}\n+    I save the form\n+    Get Text    //textarea[@name="form.widgets.custom_attributes"]    contains    ${tag}\n \n-I save the form\n-  Wait For Then Click Element  form.buttons.save\n-  Wait until page contains  Changes saved\n+# THEN\n \n+the \'h1\' tag is filtered out when a document is saved\n \n-# --- THEN -------------------------------------------------------------------\n+    ${doc1_uid}=    Create content\n+    ...    id=doc1\n+    ...    title=Document 1\n+    ...    type=Document\n+    Go To    ${PLONE_URL}/doc1/edit\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <p>heading</p><p>Spanish Inquisition</p>\n+    Mark text heading as h1 in tinymce editor\n+    I save the form\n+    Get Text    //body    contains    Spanish Inquisition\n+    Get Text    //body    not contains    heading\n \n-the \'h1\' tag is filtered out when a document is saved\n-  ${doc1_uid}=  Create content  id=doc1  title=Document 1  type=Document\n-  Go To  ${PLONE_URL}/doc1/edit\n-  patterns are loaded\n-  Input RichText  <h1>h1 heading</h1><p>Spanish Inquisition</p>\n-  I save the form\n-  # We check that some standard text is there, before checking the interesting part.\n-  # If the standard text is invisible, then something completely different is wrong.\n-  # I see tests randomly fail where the safe html transform is not even called.\n-  # In fact, no text is saved.  Maybe some timing problem.\n-  # I suspect the Input RichText keyword, which is why I added Sleep in there.\n-  Page should contain  Spanish Inquisition\n-  Page should not contain  heading\n \n the \'h1\' tag is stripped when a document is saved\n-  ${doc1_uid}=  Create content  id=doc1  title=Document 1  type=Document\n-  Go To  ${PLONE_URL}/doc1/edit\n-  patterns are loaded\n-  Input RichText  <h1>h1 heading</h1><p>Spanish Inquisition</p>\n-  I save the form\n-  Page should contain  Spanish Inquisition\n-  Page should contain  heading\n-  Page Should Contain Element  //div[@id=\'content-core\']//h1  limit=0  message=h1 should have been stripped out\n+\n+    ${doc1_uid}=    Create content\n+    ...    id=doc1\n+    ...    title=Document 1\n+    ...    type=Document\n+    Go To  ${PLONE_URL}/doc1/edit\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <p>heading</p><p>Spanish Inquisition</p>\n+    Mark text heading as h1 in tinymce editor\n+    I save the form\n+    Get Text    //body    contains    Spanish Inquisition\n+    Get Text    //body    contains    heading\n+    Get Element Count    //div[@id=\'content-core\']//h1    should be    0    message=h1 should have been stripped out\n+\n \n the \'${tag}\' tag is preserved when a document is saved\n-  ${doc1_uid}=  Create content  id=doc1  title=Document 1  type=Document\n-  Go To  ${PLONE_URL}/doc1/edit\n-  patterns are loaded\n-  Input RichText  <${tag}>lorem ipsum</${tag}><p>Spanish Inquisition</p>\n-  I save the form\n-  Page should contain  Spanish Inquisition\n-  Page Should Contain Element  //div[@id=\'content-core\']//${tag}  limit=1  message=the ${tag} tag should have been preserved\n+\n+    ${doc1_uid}=    Create content\n+    ...    id=doc1\n+    ...    title=Document 1\n+    ...    type=Document\n+    Go To    ${PLONE_URL}/doc1/edit\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <${tag}>lorem ipsum</${tag}><p>Spanish Inquisition</p>\n+    I save the form\n+    Get Text    //body    contains    Spanish Inquisition\n+    Get Element Count    //div[@id=\'content-core\']//${tag}    should be    1    message=the ${tag} tag should have been preserved\n+\n \n the \'${attribute}\' attribute is preserved when a document is saved\n-  ${doc1_uid}=  Create content  id=doc1  title=Document 1  type=Document\n-  Go To  ${PLONE_URL}/doc1/edit\n-  patterns are loaded\n-  Input RichText  <span ${attribute}="foo">lorem ipsum</span><p>Spanish Inquisition</p>\n-  I save the form\n-  Page should contain  Spanish Inquisition\n-  Page Should Contain Element  //span[@${attribute}]  limit=1  message=the ${attribute} tag should have been preserved\n+\n+    ${doc1_uid}=  Create content\n+    ...    id=doc1\n+    ...    title=Document 1\n+    ...    type=Document\n+    Go To    ${PLONE_URL}/doc1/edit\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <span ${attribute}="foo">lorem ipsum</span><p>Spanish Inquisition</p>\n+    I save the form\n+    Get Text    //body    contains    Spanish Inquisition\n+    Get Element Count    //span[@${attribute}]    should be    1    message=the ${attribute} tag should have been preserved\n+\n \n success message should contain information regarding caching\n-  Element Should Contain  css=.alert-warning  HTML generation is heavily cached across Plone. You may have to edit existing content or restart your server to see the changes.\n+    Get Text    //*[contains(@class,"alert-warning")]    contains    HTML generation is heavily cached across Plone. You may have to edit existing content or restart your server to see the changes.\n+\n+\n+# DRY\n+\n+Mark text heading as h1 in tinymce editor\n+\n+    # select the text `heading` via javascript\n+    Evaluate JavaScript    ${None}\n+    ...    () => {\n+    ...        let iframe_document = document.querySelector(".tox-edit-area iframe").contentDocument;\n+    ...        let body = iframe_document.body;\n+    ...        let p = body.firstChild;\n+    ...        let range = new Range();\n+    ...        range.setStart(p.firstChild, 0);\n+    ...        range.setEnd(p.firstChild, 7);\n+    ...        iframe_document.getSelection().removeAllRanges();\n+    ...        iframe_document.getSelection().addRange(range);\n+    ...    }\n+    ...    all_elements=False\n+    # here we use the editor to format the text `heading` with h1\n+    Click    //button[@aria-label="Format Paragraph"]\n+    Hover    //div[@aria-label="Headers"]\n+    Click    //h1[contains(text(), "Header 1")]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/f9c0006c45a21197119cf47c5f68c38504c38ee0

port controlpanel language robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_language.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_language.robot b/Products/CMFPlone/tests/robot/test_controlpanel_language.robot\nindex 163081cffa..f7f9c265ad 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_language.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_language.robot\n@@ -1,51 +1,43 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n-\n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Set Site Language in the Language Control Panel\n-  Given a logged-in site administrator\n-    and the language control panel\n-   When I set the site language to German\n-   Then the Plone user interface is in German\n-\n+    Given a logged-in site administrator\n+      and the language control panel\n+     When I set the site language to German\n+     Then the Plone user interface is in German\n \n-*** Keywords *****************************************************************\n \n-# --- GIVEN ------------------------------------------------------------------\n+*** Keywords ***\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+# GIVEN\n \n the language control panel\n-  Go to  ${PLONE_URL}/@@language-controlpanel\n-  Wait until page contains  Language Settings\n+    Go to  ${PLONE_URL}/@@language-controlpanel\n+    Get Text    //body    contains    Language Settings\n \n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I set the site language to German\n-  Select From List By Label  form.widgets.default_language:list  Deutsch\n-  Select From List By Label  form.widgets.available_languages.from  Deutsch\n-  Click Button  \xe2\x86\x92\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Select Options By    //select[@name="form.widgets.default_language:list"]    label    Deutsch\n+    Select Options By    //select[@name="form.widgets.available_languages.from"]    label    Deutsch\n+    Click    //button[@value="\xe2\x86\x92"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n the Plone user interface is in German\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Lizensiert unter der\n-  Page should contain  Lizensiert unter der\n+    Go to    ${PLONE_URL}\n+    Get Text    //body    contains    Lizensiert unter der\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/e32db344969e58dc107178a77dba04f7292df690

refactoring controlpanel markup robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_markup.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot b/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot\nindex d629df48a9..c43732a00d 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot\n@@ -1,70 +1,67 @@\n-Documentation\n-...            $ bin/robot-server Products.CMFPlone.testing.PRODUCTS_CMFPLONE_ROBOT_TESTING\n-...            $ bin/robot test_controlpanel_markup.robot\n+*** Settings ***\n \n-*** Settings *****************************************************************\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Resource  keywords.robot\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n-\n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Change Default Markup Types in the Markup Control Panel\n-  Given a logged-in site administrator\n-    and the markup control panel\n-   When I set allowed types to "text/restructured"\n-#TODO: Waiting on richtext pattern to support this\n-#   Then I do not see the standard editor when I create a document\n+    Given a logged-in site administrator\n+      and the markup control panel\n+     When I set allowed types to    text/restructured\n+\n+    #TODO: Waiting on richtext pattern to support this\n+    #Then I do not see the standard editor when I create a document\n \n Scenario: Set Default Markup to be Restructured Text\n-  Given a logged-in site administrator\n-    and the markup control panel\n-   When I set the default type to "text/restructured"\n-#TODO: Waiting on richtext pattern to support this\n-#   Then I do not see the standard editor when I create a document\n+    Given a logged-in administrator\n+      and the markup control panel\n+     When I set the default type to    text/restructured\n \n-*** Keywords *****************************************************************\n+    #TODO: Waiting on richtext pattern to support this\n+    #Then I do not see the standard editor when I create a document\n \n-# --- GIVEN ------------------------------------------------------------------\n+*** Keywords ***\n \n-a document \'${title}\'\n-  Create content  type=Document  id=doc  title=${title}\n+# GIVEN\n \n the markup control panel\n-  Go to  ${PLONE_URL}/@@markup-controlpanel\n-  Wait until page contains  Markup Settings\n+    Go to    ${PLONE_URL}/@@markup-controlpanel\n+    Get Text    //body    contains    Markup Settings\n \n \n # --- WHEN -------------------------------------------------------------------\n \n-I set allowed types to "${type}"\n-  with the label  ${type}   Select Checkbox\n-  with the label  text/html  UnSelect Checkbox\n-  with the label  text/x-web-textile  UnSelect Checkbox\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n-  Checkbox Should Be Selected  ${type}\n-  Checkbox Should Not Be Selected  text/html\n-  Checkbox Should Not Be Selected  text/x-web-textile\n+I set allowed types to\n+    [Arguments]    ${type}\n \n-I set the default type to "${type}"\n-  Select from list by label  name=form.widgets.default_type:list  ${type}\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.allowed_types:list" and @value="${type}"]\n+    Uncheck Checkbox    //input[@name="form.widgets.allowed_types:list" and @value="text/html"]\n+    Uncheck Checkbox    //input[@name="form.widgets.allowed_types:list" and @value="text/x-web-textile"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n-I disable the standard editor\n-  Select from list by label  name=form.widgets.default_editor:list  None\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Get Element States    //input[@name="form.widgets.allowed_types:list" and @value="${type}"]    contains    checked\n+    Get Element States    //input[@name="form.widgets.allowed_types:list" and @value="text/html"]    not contains    checked\n+    Get Element States    //input[@name="form.widgets.allowed_types:list" and @value="text/x-web-textile"]    not contains    checked\n+\n+I set the default type to\n+    [Arguments]    ${type}\n+\n+    Select Options By    //select[@name="form.widgets.default_type:list"]    value    ${type}\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n+\n+# I disable the standard editor\n+#   Select from list by label  name=form.widgets.default_editor:list  None\n+#   Click Button  Save\n+#   Wait until page contains  Changes saved\n \n \n # --- THEN -------------------------------------------------------------------\n@@ -80,22 +77,7 @@ Then I can see only "${type}" when creating a document\n   Wait until page contains  Item created\n   Location should be  ${PLONE_URL}/this-is-my-custom-short-name/view\n \n-I do not see the standard editor when I create a document\n-  Go To  ${PLONE_URL}/++add++Document\n-  Wait until page contains  Add Page\n-  Page should not contain element  css=.mce-tinymce\n-\n-# --- Helpers -----------------------------------------------------------------\n-\n-With the label\n-    [arguments]  ${title}    ${extra_keyword}   @{list}\n-    ${for}=  label "${title}"\n-    Run Keyword     ${extra_keyword}  id=${for}   @{list}\n-\n-label "${title}"\n-    [Return]  ${for}\n-    ${for}=  Get Element Attribute  xpath=//label[contains(., "${title}")]  for\n-\n-label2 "${title}"\n-    [Return]  ${for}\n-    ${for}=  Get Element Attribute  xpath=//label[contains(., "${title}")]//input\n+# I do not see the standard editor when I create a document\n+#     Go To  ${PLONE_URL}/++add++Document\n+#     Pause\n+#     Page should not contain element  css=.mce-tinymce\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/3167c9459644af19db4ad64a37e4fdc209c9c694

refactoring controlpanel navigation robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_navigation.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_navigation.robot b/Products/CMFPlone/tests/robot/test_controlpanel_navigation.robot\nindex c277aedf52..f40e8b751c 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_navigation.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_navigation.robot\n@@ -1,115 +1,115 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n \n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Disable Generate Tabs in the Navigation Control Panel\n-  Given a logged-in site administrator\n-    and a document \'My Document\'\n-    and the navigation control panel\n-   When I disable generate tabs\n-   Then the document \'My Document\' does not show up in the navigation\n+    Given a logged-in site administrator\n+      and a document \'My Document\'\n+      and the navigation control panel\n+     When I disable generate tabs\n+     Then the document \'My Document\' does not show up in the navigation\n \n Scenario: Enable Folderish Tabs in the Navigation Control Panel\n-  Given a logged-in site administrator\n-    and a document \'My Document\'\n-    and the navigation control panel\n-   When I disable non-folderish tabs\n-   Then the document \'My Document\' does not show up in the navigation\n+    Given a logged-in site administrator\n+      and a document \'My Document\'\n+      and the navigation control panel\n+     When I disable non-folderish tabs\n+     Then the document \'My Document\' does not show up in the navigation\n \n Scenario: Filter Navigation By Displayed Types in the Navigation Control Panel\n-  Given a logged-in site administrator\n-    and a document \'My Document\'\n-    and the navigation control panel\n-   When I remove \'Document\' from the displayed types list\n-   Then the document \'My Document\' does not show up in the navigation\n-    and the document \'My Document\' does not show up in the sitemap\n+    Given a logged-in site administrator\n+      and a document \'My Document\'\n+      and the navigation control panel\n+     When I remove \'Document\' from the displayed types list\n+     Then the document \'My Document\' does not show up in the navigation\n+      and the document \'My Document\' does not show up in the sitemap\n \n-#Scenario: Filter Navigation By Workflow States in the Navigation Control Panel\n-#  Given a logged-in site administrator\n-#    and a published document \'My Document\'\n-#    and a private document \'My Internal Document\'\n-#    and the navigation control panel\n-#   When I enable filtering by workflow states\n-#    and I choose to show \'published\' items\n-#    and I choose to not show \'private\' items\n-#   Then the document \'My Document\' shows up in the navigation\n-#    and the document \'My Internal Document\' does not show up in the navigation\n+Scenario: Filter Navigation By Workflow States in the Navigation Control Panel\n+    Given a logged-in site administrator\n+      and a published document \'My Document\'\n+      and a private document \'My Internal Document\'\n+      and the navigation control panel\n+     When I enable filtering by workflow states\n+      and I choose to show \'published\' items\n+      and I choose to not show \'private\' items\n+     Then the document \'My Document\' shows up in the navigation\n+      and the document \'My Internal Document\' does not show up in the navigation\n \n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n-# --- GIVEN ------------------------------------------------------------------\n+# GIVEN\n \n the navigation control panel\n-  Go to  ${PLONE_URL}/@@navigation-controlpanel\n-  Wait until page contains  Navigation Settings\n+    Go to  ${PLONE_URL}/@@navigation-controlpanel\n+    Get Text    //body    contains    Navigation Settings\n \n a published document \'${title}\'\n-  ${uid}=  a document \'${title}\'\n-  Fire transition  ${uid}  publish\n+    ${uid}=    Create content\n+    ...    type=Document\n+    ...    id=doc\n+    ...    title=${title}\n+    Fire transition    ${uid}    publish\n \n a private document \'${title}\'\n-  a document \'${title}\'\n+    Create content\n+    ...    type=Document\n+    ...    id=doc1\n+    ...    title=${title}\n \n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I disable generate tabs\n-  Unselect Checkbox  form.widgets.generate_tabs:list\n-  Wait For Then Click Element  form.buttons.save\n-  Wait until page contains  Changes saved\n+    Uncheck Checkbox    //input[@name="form.widgets.generate_tabs:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n I disable non-folderish tabs\n-  Unselect Checkbox  xpath=//input[@value=\'Document\']\n-  Wait For Then Click Element  form.buttons.save\n-  Wait until page contains  Changes saved\n+    Uncheck Checkbox  //input[@value=\'Document\']\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n I remove \'${portal_type}\' from the displayed types list\n-  Unselect Checkbox  xpath=//input[@value=\'Document\']\n-  Wait For Then Click Element  form.buttons.save\n-  Wait until page contains  Changes saved\n+    Uncheck Checkbox  //input[@value=\'Document\']\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n I enable filtering by workflow states\n-  Select Checkbox  name=form.widgets.filter_on_workflow:list\n-  Wait For Then Click Element  form.buttons.save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.filter_on_workflow:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n I choose to show \'${workflow_state}\' items\n-  Select Checkbox  xpath=//input[@value=\'${workflow_state}\']\n-  Wait For Then Click Element  form.buttons.save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@value=\'${workflow_state}\']\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n I choose to not show \'${workflow_state}\' items\n-  Unselect Checkbox  xpath=//input[@value=\'${workflow_state}\']\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Uncheck Checkbox    //input[@value=\'${workflow_state}\']\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n the document \'${title}\' shows up in the navigation\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Powered by Plone\n-  Page Should Contain Element  //ul[@id=\'portal-globalnav\']/li/a[contains(text(), \'${title}\')]  limit=1  message=The global navigation should have contained the item \'${title}\'\n+    Go to    ${PLONE_URL}\n+    Get Element Count    //ul[@id=\'portal-globalnav\']/li/a[contains(text(), \'${title}\')]    should be    1    message=The global navigation should have contained the item \'${title}\'\n \n the document \'${title}\' does not show up in the navigation\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Powered by Plone\n-  Page Should Contain Element  //ul[@id=\'portal-globalnav\']/li/a[contains(text(), \'${title}\')]  limit=0  message=The global navigation should not have contained the item \'${title}\'\n+    Go to    ${PLONE_URL}\n+    Get Element Count    //ul[@id=\'portal-globalnav\']/li/a[contains(text(), \'${title}\')]    should be    0    message=The global navigation should not have contained the item \'${title}\'\n \n the document \'${title}\' does not show up in the sitemap\n-  Go to  ${PLONE_URL}/sitemap\n-  Wait until page contains  Powered by Plone\n-  Page Should Contain Element  //ul[@id=\'portal-sitemap\']/li/a/span[contains(text(), \'${title}\')]  limit=0  message=The sitemap should not have contained the item \'${title}\'\n+    Go to    ${PLONE_URL}/sitemap\n+    Get Element Count    //ul[@id=\'portal-sitemap\']/li/a/span[contains(text(), \'${title}\')]    should be    0    message=The sitemap should not have contained the item \'${title}\'\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/0146064d61370e16677a28284dd690e855d6d56a

refactoring controlpanel redirection robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot b/Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot\nindex 6c2f6673c5..4daf784098 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot\n@@ -1,43 +1,40 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n \n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Add redirect in the URL Management Control Panel\n-  Given a logged-in site administrator\n-    and the URL Management control panel\n-  When I add a redirect to the test folder from alternative url  /old\n-  Then I get redirected to the test folder when visiting  /old\n+    Given a logged-in site administrator\n+      and the URL Management control panel\n+     When I add a redirect to the test folder from alternative url  /old\n+     Then I get redirected to the test folder when visiting  /old\n \n \n Scenario: Remove redirect in the URL Management Control Panel\n-  Given a logged-in site administrator\n-    and the URL Management control panel\n-  When I add a redirect to the test folder from alternative url  /old\n-   and I remove the redirect from alternative url  /old\n-  Then I do not get redirected when visiting  /old\n+    Given a logged-in site administrator\n+      and the URL Management control panel\n+     When I add a redirect to the test folder from alternative url  /old\n+      and I remove the redirect from alternative url  /old\n+     Then I do not get redirected when visiting  /old\n \n \n Scenario: Remove filtered redirects in the URL Management Control Panel\n-  Given a logged-in site administrator\n-    and the URL Management control panel\n-  When I add a redirect to the test folder from alternative url  /a\n-   and I add a redirect to the test folder from alternative url  /b\n-   and I filter the redirects with path  /a\n-   and I remove the matching redirects\n-  Then I do not get redirected when visiting  /a\n-   and I get redirected to the test folder when visiting  /b\n+    Given a logged-in site administrator\n+      and the URL Management control panel\n+     When I add a redirect to the test folder from alternative url  /a\n+      and I add a redirect to the test folder from alternative url  /b\n+      and I filter the redirects with path  /a\n+      and I remove the matching redirects\n+     Then I do not get redirected when visiting  /a\n+      and I get redirected to the test folder when visiting  /b\n \n \n Scenario: Download all redirects in the URL Management Control Panel\n@@ -48,58 +45,59 @@ Scenario: Download all redirects in the URL Management Control Panel\n   Then I can download all redirects as CSV\n \n \n-*** Keywords *****************************************************************\n-\n-# --- GIVEN ------------------------------------------------------------------\n+*** Keywords ***\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+# GIVEN\n \n the URL Management control panel\n-  Go to  ${PLONE_URL}/@@redirection-controlpanel\n+    Go to  ${PLONE_URL}/@@redirection-controlpanel\n \n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I add a redirect to the test folder from alternative url\n-  [Documentation]  target path must exist in the site\n-  [Arguments]  ${old}\n-  Input Text  name=redirection  ${old}\n-  Input Text  name=target_path  /test-folder\n-  Click Button  Add\n+    [Documentation]  target path must exist in the site\n+    [Arguments]    ${old}\n+    Type Text    //input[@name="redirection"]    ${old}\n+    Type Text    //input[@name="target_path"]    /test-folder\n+    Click    //button[@name="form.button.Add"]\n \n \n I remove the redirect from alternative url\n-  [Arguments]  ${old}\n-  Select Checkbox  xpath=//input[@value=\'/plone${old}\']\n-  Click Button  Remove selected\n-\n+    [Arguments]  ${old}\n+    Check Checkbox    //input[@value="/plone${old}"]\n+    Click    //button[@name="form.button.Remove"]\n \n I filter the redirects with path\n-  [Arguments]  ${old}\n-  Input Text  name=q  ${old}\n-  Click Button  Filter\n+    [Arguments]    ${old}\n+    Type Text    //input[@name="q"]    ${old}\n+    Click    //button[@name="form.button.filter"]\n \n I remove the matching redirects\n-  Click Button  Remove all that match filter\n+    Click    //button[@name="form.button.MatchRemove"]\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n I get redirected to the test folder when visiting\n-  [Arguments]  ${old}\n-  Go to  ${PLONE_URL}/${old}\n-  Location Should Be  ${PLONE_URL}/test-folder\n+    [Arguments]    ${old}\n+    Go to    ${PLONE_URL}/${old}\n+    Get Url    should be    ${PLONE_URL}/test-folder\n \n \n I do not get redirected when visiting\n-  [Arguments]  ${old}\n-  Go to  ${PLONE_URL}/${old}\n-  Location Should Be  ${PLONE_URL}/${old}\n-  Wait Until Page Contains  This page does not seem to exist\n+    [Arguments]    ${old}\n+    Go to    ${PLONE_URL}/${old}\n+    Get Url    should be    ${PLONE_URL}/${old}\n+    Get Text    //body    contains    This page does not seem to exist\n \n \n I can download all redirects as CSV\n-  [Documentation]  I don\'t know how to get the contents of the downloaded file\n-  Click Button  Download all as CSV\n-  Page Should Not Contain  there seems to be an error\n+    [Documentation]  Test the download of CSV file\n+\n+    Import library    OperatingSystem\n+\n+    ${dl_promise}    Promise To Wait For Download    saveAs=/tmp/redirections.csv\n+    Click    //button[@name="form.button.Download"]\n+    ${file_obj}=    Wait For    ${dl_promise}\n+    File Should Exist      ${file_obj}[saveAs]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/10e31018f566948ac9bf52a7c9901ae72b81426c

refactoring controlpanel search robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_search.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_search.robot b/Products/CMFPlone/tests/robot/test_controlpanel_search.robot\nindex de9c3b5cfe..8bc821890b 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_search.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_search.robot\n@@ -1,81 +1,65 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n \n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Enable Livesearch in the Search Control Panel\n-  Given a logged-in site administrator\n-    and a document \'My Document\'\n-    and the search control panel\n-   When I enable livesearch\n-#   Then then searching for \'My Document\' will show a live search\n-# XXX: Not implemented yet. See https://github.com/plone/Products.CMFPlone/issues/176 for details\n+    Given a logged-in site administrator\n+      and a document \'My Document\'\n+      and the search control panel\n+     When I enable livesearch\n+     Then then searching for \'My Document\' will show a live search\n \n Scenario: Exclude Content Types from Search\n-  Given a logged-in site administrator\n-    and a document \'My Document\'\n-    and the search control panel\n-   When I exclude the \'Document\' type from search\n-   Then searching for \'My Document\' will not return any results\n-\n-\n-*** Keywords *****************************************************************\n+    Given a logged-in site administrator\n+      and a document \'My Document\'\n+      and the search control panel\n+     When I exclude the \'Document\' type from search\n+     Then searching for \'My Document\' will not return any results\n \n-# --- GIVEN ------------------------------------------------------------------\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+*** Keywords ***\n \n-a document \'${title}\'\n-  Create content  type=Document  id=doc  title=${title}\n+# GIVEN\n \n the search control panel\n-  Go to  ${PLONE_URL}/@@search-controlpanel\n-  Wait until page contains  Search Settings\n+    Go to    ${PLONE_URL}/@@search-controlpanel\n+    Get Text    //body    contains    Search Settings\n \n-\n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I enable livesearch\n-  Select Checkbox  form.widgets.enable_livesearch:list\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    Check Checkbox  //input[@name="form.widgets.enable_livesearch:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I exclude the \'${portal_type}\' type from search\n-  # Make sure we see the checkbox, in expanded in jenkins it gets a bit under the toolbar\n-  ${element}  Set Variable  xpath=//input[@name=\'form.widgets.types_not_searched:list\' and @value=\'${portal_type}\']\n-  Wait For Element  ${element}\n-  Unselect Checkbox  ${element}\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    # Make sure we see the checkbox, in expanded in jenkins it gets a bit under the toolbar\n+    Check Checkbox  //input[@name=\'form.widgets.types_not_searched:list\' and @value=\'${portal_type}\']\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n then searching for \'My Document\' will show a live search\n-  # XXX: Not implemented yet.\n-  Go to  ${PLONE_URL}\n-  Wait until page contains element  xpath=//input[@name=\'SearchableText\']\n-  Input Text  name=SearchableText  My\n+    Go to    ${PLONE_URL}\n+    Type Text    //input[@name="SearchableText"]    My D\n+    Get Element States    //ul[contains(@class,"livesearch-results")]    contains    visible\n+    Get Text    //ul[contains(@class,"livesearch-results")]    contains    My Document\n \n searching for \'${search_term}\' will not return any results\n-  Go to  ${PLONE_URL}/@@search\n-  Given patterns are loaded\n-  Wait until page contains  No results were found\n-  Input Text  xpath=//form[@id=\'searchform\']//input[@name=\'SearchableText\']  ${search_term}\n-  Submit Form  name=searchform\n-  Wait until page contains  items matching your search terms\n-  Page Should Contain Element  //span[@id=\'search-results-number\' and contains(.,\'0\')]  1\n-\n-\n+    Go to    ${PLONE_URL}/@@search\n+    Get Text    //body    contains    No results were found\n+    Type Text    //form[@id=\'searchform\']//input[@name=\'SearchableText\']    ${search_term}\n+    Click    //input[@type="submit" and @value="Search"]\n+    Get Text    //body    contains    items matching your search terms\n+    Get Text    //span[@id=\'search-results-number\']    should be    0\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/000358dbc42adf3d3a8a21b2f4b64149397a326c

refactoring controlpanel security robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_security.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_security.robot b/Products/CMFPlone/tests/robot/test_controlpanel_security.robot\nindex 535f96945e..f7dd470b21 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_security.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_security.robot\n@@ -1,190 +1,172 @@\n *** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Enable self registration in the Security Control Panel\n-  Given a logged-in site administrator\n-    and the security control panel\n-   When I enable self registration\n-   Then anonymous users can register to the site\n+    Given a logged-in site administrator\n+      and the security control panel\n+     When I enable self registration\n+     Then anonymous users can register to the site\n \n Scenario: Enable users to select their own passwords in the Security Control Panel\n-  Given a logged-in site administrator\n-    and the security control panel\n-   When I enable users to select their own passwords\n-   Then users can select their own passwords when registering\n+    Given a logged-in site administrator\n+      and the security control panel\n+     When I enable users to select their own passwords\n+     Then users can select their own passwords when registering\n \n Scenario: Enable user folders in the Security Control Panel\n-  Given a logged-in site administrator\n-    and the security control panel\n-   When I enable user folders\n-   Then a user folder should be created when a user registers and logs in to the site\n+    Given a logged-in site administrator\n+      and the security control panel\n+     When I enable user folders\n+     Then a user folder should be created when a user registers and logs in to the site\n \n Scenario: Enable anyone to view \'about\' information in the Security Control Panel\n-  Given a logged-in site administrator\n-    and a published test folder\n-    and the security control panel\n-   When I enable anyone to view \'about\' information\n-   Then anonymous users can view \'about\' information\n+    Given a logged-in site administrator\n+      and a published test folder\n+      and the security control panel\n+     When I enable anyone to view \'about\' information\n+     Then anonymous users can view \'about\' information\n \n Scenario: Enable use email as login in the Security Control Panel\n-  Given a logged-in site administrator\n-    and the security control panel\n-   When I enable email to be used as a login name\n-   Then users can use email as their login name\n+    Given a logged-in site administrator\n+      and the security control panel\n+     When I enable email to be used as a login name\n+     Then users can use email as their login name\n \n Scenario: Enable use uuid as uid in the Security Control Panel\n-  Given a logged-in site administrator\n-    and the security control panel\n-   When I enable UUID to be used as a user id\n-   Then UUID should be used for the user id\n-\n+    Given a logged-in site administrator\n+      and the security control panel\n+     When I enable UUID to be used as a user id\n+     Then UUID should be used for the user id\n \n-*** Keywords *****************************************************************\n \n-# --- GIVEN ------------------------------------------------------------------\n+*** Keywords ***\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+# GIVEN\n \n the security control panel\n-  Go to  ${PLONE_URL}/@@security-controlpanel\n-  Wait until page contains  Security Settings\n+    Go to    ${PLONE_URL}/@@security-controlpanel\n+    Get Text    //body    contains    Security Settings\n \n a published test folder\n-  Go to  ${PLONE_URL}/test-folder\n-  Wait For Element  css=#plone-contentmenu-workflow\n-  Click link  xpath=//li[@id=\'plone-contentmenu-workflow\']/a\n-  Wait For Element  id=workflow-transition-publish\n-  Click link  id=workflow-transition-publish\n-  Wait until page contains  Item state changed\n+    Go to    ${PLONE_URL}/test-folder\n+    Click    //li[@id="plone-contentmenu-workflow"]/a\n+    Click    //*[@id="workflow-transition-publish"]\n+    Get Text    //body    contains    Item state changed\n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I enable self registration\n-  Select Checkbox  form.widgets.enable_self_reg:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox  //input[@name="form.widgets.enable_self_reg:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I enable users to select their own passwords\n-  Select Checkbox  form.widgets.enable_self_reg:list\n-  Select Checkbox  form.widgets.enable_user_pwd_choice:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.enable_self_reg:list"]\n+    Check Checkbox    //input[@name="form.widgets.enable_user_pwd_choice:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I enable user folders\n-  Select Checkbox  form.widgets.enable_self_reg:list\n-  Select Checkbox  form.widgets.enable_user_pwd_choice:list\n-  Select Checkbox  form.widgets.enable_user_folders:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.enable_self_reg:list"]\n+    Check Checkbox    //input[@name="form.widgets.enable_user_pwd_choice:list"]\n+    Check Checkbox    //input[@name="form.widgets.enable_user_folders:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I enable anyone to view \'about\' information\n-  Select Checkbox  form.widgets.allow_anon_views_about:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.allow_anon_views_about:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I enable email to be used as a login name\n-  Select Checkbox  form.widgets.enable_self_reg:list\n-  Select Checkbox  form.widgets.enable_user_pwd_choice:list\n-  Select Checkbox  form.widgets.use_email_as_login:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.enable_self_reg:list"]\n+    Check Checkbox    //input[@name="form.widgets.enable_user_pwd_choice:list"]\n+    Check Checkbox    //input[@name="form.widgets.use_email_as_login:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I enable UUID to be used as a user id\n-  Select Checkbox  form.widgets.enable_self_reg:list\n-  Select Checkbox  form.widgets.enable_user_pwd_choice:list\n-  Select Checkbox  form.widgets.use_uuid_as_userid:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.enable_self_reg:list"]\n+    Check Checkbox    //input[@name="form.widgets.enable_user_pwd_choice:list"]\n+    Check Checkbox    //input[@name="form.widgets.use_uuid_as_userid:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n Anonymous users can register to the site\n-  Disable autologin\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Plone site\n-  Element Should Be Visible  xpath=//a[@id=\'personaltools-join\']\n+    Disable autologin\n+    Go to    ${PLONE_URL}\n+    Get Text    //body    contains    Plone site\n+    Get Element States    //a[@id="personaltools-join"]    contains    visible\n \n Users can select their own passwords when registering\n-  Disable autologin\n-  Go to  ${PLONE_URL}/@@register\n-  Wait until page contains  Registration form\n-  Element Should Be Visible  xpath=//input[@id=\'form-widgets-password\']\n+    Disable autologin\n+    Go to    ${PLONE_URL}/@@register\n+    Get Text    //body    contains    Registration form\n+    Get Element States    //input[@id="form-widgets-password"]    contains    visible\n \n Users can use email as their login name\n-  Disable autologin\n-  Go to  ${PLONE_URL}/@@register\n-  Wait until page contains  Registration form\n-  Element Should Be Visible  xpath=//input[@id=\'form-widgets-email\']\n-  Element Should Not Be Visible  xpath=//input[@id=\'form-widgets-username\']\n+    Disable autologin\n+    Go to    ${PLONE_URL}/@@register\n+    Get Text    //body    contains    Registration form\n+    Get Element States    //input[@id="form-widgets-email"]    contains    visible\n+    Get Element States    //input[@id="form-widgets-username"]    not contains    visible\n \n A user folder should be created when a user registers and logs in to the site\n \n-  Disable autologin\n-\n-  # I register to the site\n-  Go to  ${PLONE_URL}/@@register\n-  Wait until page contains  Registration form\n-  Input Text for sure  form.widgets.username  joe\n-  Input Text for sure  form.widgets.email  joe@test.com\n-  Input Text for sure  form.widgets.password  supersecret\n-  Input Text for sure  form.widgets.password_ctl  supersecret\n-  Wait For Then Click Element  css=#form-buttons-register\n-\n-  # I login to the site\n-  Go to  ${PLONE_URL}/login\n-  Wait until page contains  Login Name\n-  Input text for sure  __ac_name  joe\n-  Input text for sure  __ac_password  supersecret\n-  Click Button  Log in\n-  Wait until page contains  You are now logged in\n-\n-  # The user folder should be created\n-  Go to  ${PLONE_URL}/Members/joe\n-  Wait until element contains  css=h1  joe\n-  Page should Not contain  This page does not seem to exist\n+    Disable autologin\n+    I register to the site\n+    I login to the site\n+    # The user folder should be created\n+    Go to    ${PLONE_URL}/Members/joe\n+    Get Element Count    //h1[contains(text(),\'joe doe\')]    should be    1\n+    Get Text    //body    not contains    This page does not seem to exist\n \n Anonymous users can view \'about\' information\n-  Disable autologin\n-  Go to  ${PLONE_URL}/@@search?SearchableText=test\n-  Wait until page contains  Search results\n-  Element Should Be Visible  xpath=//span[contains(@class, \'documentAuthor\')]\n+    Disable autologin\n+    Go to    ${PLONE_URL}/@@search?SearchableText=test\n+    Get Text    //body    contains    Search results\n+    Get Element States    //span[contains(@class, \'documentAuthor\')]    contains    visible\n \n UUID should be used for the user id\n \n-  Disable autologin\n-\n-  # I register to the site\n-  Go to  ${PLONE_URL}/@@register\n-  Wait until page contains  Registration form\n-  Input Text for sure  form.widgets.username  joe\n-  Input Text for sure  form.widgets.email  joe@test.com\n-  Input Text for sure  form.widgets.password  supersecret\n-  Input Text for sure  form.widgets.password_ctl  supersecret\n-  Wait For Then Click Element  css=#form-buttons-register\n-\n-  # I login to the site\n-  Go to  ${PLONE_URL}/login\n-  Wait until page contains  Login Name\n-  Input text for sure  __ac_name  joe\n-  Input text for sure  __ac_password  supersecret\n-  Click Button  Log in\n-  Wait until page contains  You are now logged in\n-  # XXX: Here we can\'t really test that this is a uuid, since it\'s random, so\n-  # we just check that user id is not equal to username or email\n-  ${userid}=  Get Text  xpath=//a[@id=\'personaltools-menulink\']\n-  Should Not Be Equal As Strings  ${userid}  joe\n-  Should Not Be Equal As Strings  ${userid}  joe@test.com\n+    Disable autologin\n+    I register to the site\n+    I login to the site\n+    # XXX: Here we can\'t really test that this is a uuid, since it\'s random, so\n+    # we just check that user id is not equal to username or email\n+    ${userid}=  Get Text    //a[@id=\'personaltools-menulink\']\n+    Should Not Be Equal As Strings    ${userid}    joe\n+    Should Not Be Equal As Strings    ${userid}    joe@test.com\n+\n+\n+# DRY\n+\n+I register to the site\n+    Go to  ${PLONE_URL}/@@register\n+    Get Text    //body    contains    Registration form\n+    Type Text    //input[@name="form.widgets.fullname"]    joe doe\n+    Type Text    //input[@name="form.widgets.username"]    joe\n+    Type Text    //input[@name="form.widgets.email"]    joe@test.com\n+    Type Text    //input[@name="form.widgets.password"]    supersecret\n+    Type Text    //input[@name="form.widgets.password_ctl"]    supersecret\n+    Click    //button[@name="form.buttons.register"]\n+\n+I login to the site\n+    Go to    ${PLONE_URL}/login\n+    Get Text    //body    contains    Login Name\n+    Type Text    //input[@name="__ac_name"]    joe\n+    Type Text    //input[@name="__ac_password"]    supersecret\n+    Click    //button[@name="buttons.login"]\n+    Get Text    //body    contains    You are now logged in\n\\ No newline at end of file\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/ba2720efafbe68ee2bb83983e0099827736d5f79

correct spaces  in keyword

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot b/Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot\nindex 4daf784098..0ab19f02de 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot\n@@ -100,4 +100,4 @@ I can download all redirects as CSV\n     ${dl_promise}    Promise To Wait For Download    saveAs=/tmp/redirections.csv\n     Click    //button[@name="form.button.Download"]\n     ${file_obj}=    Wait For    ${dl_promise}\n-    File Should Exist      ${file_obj}[saveAs]\n+    File Should Exist    ${file_obj}[saveAs]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/0e2cdf199618232fa9d99ac8ed52266b91cb4669

refactoring controlpanel site robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_site.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_site.robot b/Products/CMFPlone/tests/robot/test_controlpanel_site.robot\nindex 1844ac2d65..451b7f9aee 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_site.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_site.robot\n@@ -1,125 +1,110 @@\n-Documentation\n-...            $ bin/robot-server Products.CMFPlone.testing.PRODUCTS_CMFPLONE_ROBOT_TESTING\n-...            $ bin/robot test_controlpanel_site.robot\n+*** Settings ***\n \n-*** Settings *****************************************************************\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n-Variables  Products/CMFPlone/tests/robot/variables.py\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Resource  keywords.robot\n+Variables    variables.py\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n-\n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Set Site Title in the Site Control Panel\n-  Given a logged-in site administrator\n-    and the site control panel\n-   When I set the site title to \'My Site\'\n-   Then the site title should be set to \'My Site\'\n+    Given a logged-in site administrator\n+      and the site control panel\n+     When I set the site title to \'My Site\'\n+     Then the site title should be set to \'My Site\'\n \n Scenario: Set Site Logo in the Site Control Panel\n-  Given a logged-in site administrator\n-    and the site control panel\n-   When I set a custom logo\n-   Then the site logo should be set to the custom logo\n+    Given a logged-in site administrator\n+      and the site control panel\n+     When I set a custom logo\n+     Then the site logo should be set to the custom logo\n \n Scenario: Enable Dublin Core Metadata in the Site Control Panel\n-  Given a logged-in site administrator\n-    and the site control panel\n-   When I enable dublin core metadata\n-   Then the dublin core metadata shows up on the site\n+    Given a logged-in site administrator\n+      and the site control panel\n+     When I enable dublin core metadata\n+     Then the dublin core metadata shows up on the site\n \n Scenario: Enable Sitemap in the Site Control Panel\n-  Given a logged-in site administrator\n-    and the site control panel\n-   When I enable the sitemap\n-   Then then I can see a sitemap\n+    Given a logged-in site administrator\n+      and the site control panel\n+     When I enable the sitemap\n+     Then then I can see a sitemap\n \n Scenario: Add Webstats Javascript in the Site Control Panel\n-  Given a logged-in site administrator\n-    and the site control panel\n-   When I add a Javascript snippet to the webstats javascript\n-   Then the Javascript snippet shows up on the site\n+    Given a logged-in site administrator\n+      and the site control panel\n+     When I add a Javascript snippet to the webstats javascript\n+     Then the Javascript snippet shows up on the site\n \n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n-# --- GIVEN ------------------------------------------------------------------\n+# GIVEN\n \n the site control panel\n-  Go to  ${PLONE_URL}/@@site-controlpanel\n-  Wait until page contains  Site Settings\n+    Go to    ${PLONE_URL}/@@site-controlpanel\n+    Get Text    //body    contains    Site Settings\n \n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I enable the sitemap\n-  Given patterns are loaded\n-  Wait For Element  css=#formfield-form-widgets-enable_sitemap\n-  Select Checkbox  form.widgets.enable_sitemap:list\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.enable_sitemap:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I set the site title to \'${site_title}\'\n-  Given patterns are loaded\n-  Input Text  name=form.widgets.site_title  ${site_title}\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    Type Text    //input[@name="form.widgets.site_title"]    ${site_title}\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I set a custom logo\n-  Given patterns are loaded\n-  Choose File  name=form.widgets.site_logo  ${PATH_TO_TEST_FILES}/pixel.png\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    Upload File By Selector    //input[@name="form.widgets.site_logo"]    ${PATH_TO_TEST_FILES}/pixel.png\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I enable dublin core metadata\n-  Given patterns are loaded\n-  Select Checkbox  form.widgets.exposeDCMetaTags:list\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.exposeDCMetaTags:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I add a Javascript snippet to the webstats javascript\n-  Given patterns are loaded\n-  Input Text  name=form.widgets.webstats_js  <script id="webstats_snippet"></script>\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    Type Text    //textarea[@name="form.widgets.webstats_js"]    <script id="webstats_snippet"></script>\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n the site title should be set to \'${expected_site_title}\'\n-  Go To  ${PLONE_URL}\n-  ${actual_site_title}=  Get title\n-  Should be equal  ${actual_site_title}  ${expected_site_title}\n+    Go To    ${PLONE_URL}\n+    Get Text    //head/title    should be    ${expected_site_title}\n \n the site logo should be set to the custom logo\n-  Go To  ${PLONE_URL}\n-  Wait Until Element Is Visible  css=#portal-logo\n-  Page should contain element  //*[@id="portal-logo"]/img[contains(@src,\'@@site-logo/pixel.png\')]\n+    Go To    ${PLONE_URL}\n+    Get Element Count    //*[@id="portal-logo"]/img[contains(@src,\'@@site-logo/pixel.png\')]    should be    1\n \n then I can see a sitemap\n-  Go to  ${PLONE_URL}/sitemap.xml.gz\n-  # We need a \'Download file\' selenium2library keyword to test this:\n-  # https://github.com/rtomac/robotframework-selenium2library/issues/24\n+\n+    Import library    OperatingSystem\n+\n+    Download    ${PLONE_URL}/sitemap.xml.gz    saveAs=/tmp/sitemap.xml.gz\n+    File Should Exist    /tmp/sitemap.xml.gz\n \n the dublin core metadata shows up on the site\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Powered by Plone\n-  Page should contain element  xpath=//html/head/meta[@name=\'DC.date.modified\']\n-  Page should contain element  xpath=//html/head/meta[@name=\'DC.format\']\n-  Page should contain element  xpath=//html/head/meta[@name=\'DC.type\']\n-  Page should contain element  xpath=//html/head/meta[@name=\'DC.date.created\']\n-  Page should contain element  xpath=//html/head/meta[@name=\'DC.language\']\n+    Go to    ${PLONE_URL}\n+    Get Element Count    //html/head/meta[@name="DC.date.modified"]    should be    1\n+    Get Element Count    //html/head/meta[@name="DC.format"]    should be    1\n+    Get Element Count    //html/head/meta[@name="DC.type"]    should be    1\n+    Get Element Count    //html/head/meta[@name="DC.date.created"]    should be    1\n+    Get Element Count    //html/head/meta[@name="DC.language"]    should be    1\n \n the Javascript snippet shows up on the site\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Powered by Plone\n-  Page should contain element  id=webstats_snippet\n+    Go to  ${PLONE_URL}\n+    Get Element Count    //*[@id="webstats_snippet"]    should be    1\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/bf4f1ada336e539ff409e0b3373cefd0cac553cc

refactoring controlpanel social robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_social.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_social.robot b/Products/CMFPlone/tests/robot/test_controlpanel_social.robot\nindex 2fae936771..01239426e3 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_social.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_social.robot\n@@ -1,78 +1,69 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n \n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Social settings are provided\n-  Given a logged-in site administrator\n-    and the social control panel\n-   When I provide social settings\n-   Then social tags should exist for anonymous\n+    Given a logged-in site administrator\n+      and the social control panel\n+     When I provide social settings\n+     Then social tags should exist for anonymous\n \n Scenario: Social tags are disabled\n-  Given a logged-in site administrator\n-    and the social control panel\n-   When I provide social settings\n-   When I disable social\n-   Then social tags should not exist\n-\n+    Given a logged-in site administrator\n+      and the social control panel\n+     When I provide social settings\n+     When I disable social\n+     Then social tags should not exist\n \n-*** Keywords *****************************************************************\n \n-# --- GIVEN ------------------------------------------------------------------\n+*** Keywords ***\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+# GIVEN\n \n the social control panel\n-  Go to  ${PLONE_URL}/@@social-controlpanel\n-  Wait until page contains  Social Media Settings\n+    Go to  ${PLONE_URL}/@@social-controlpanel\n+    Get Text    //body    contains    Social Media Settings\n \n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I disable social\n-  UnSelect Checkbox  form.widgets.share_social_data:list\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    Uncheck Checkbox    //input[@name="form.widgets.share_social_data:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I provide social settings\n-  Input Text  name=form.widgets.twitter_username  plonecms\n-  Input Text  name=form.widgets.facebook_app_id  123456\n-  Input Text  name=form.widgets.facebook_username  plonecms\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    Type Text    //input[@name="form.widgets.twitter_username"]    plonecms\n+    Type Text    //input[@name="form.widgets.facebook_app_id"]    123456\n+    Type Text    //input[@name="form.widgets.facebook_username"]    plonecms\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n social tags should exist for anonymous\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Plone site\n-  Page should not contain element  css=meta[name="twitter:site"]\n-  Page should not contain element  css=meta[property="og:article:publisher"]\n-  Page should not contain element  css=meta[property="fb:app_id"]\n-  Disable autologin\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Plone site\n-  Page should contain element  css=meta[name="twitter:site"]\n-  Page should contain element  css=meta[property="og:article:publisher"]\n-  Page should contain element  css=meta[property="fb:app_id"]\n+    Go to    ${PLONE_URL}\n+    Get Element Count    //meta[@name="twitter:site"]    should be    0\n+    Get Element Count    //meta[@property="og:article:publisher"]    should be    0\n+    Get Element Count    //meta[@property="fb:app_id"]    should be    0\n+    Disable autologin\n+    Go to     ${PLONE_URL}\n+    Get Element Count    //meta[@name="twitter:site"]    should be    1\n+    Get Element Count    //meta[@property="og:article:publisher"]    should be    1\n+    Get Element Count    //meta[@property="fb:app_id"]    should be    1\n \n social tags should not exist\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Plone site\n-  Page should not contain element  css=meta[name="twitter:site"]\n-  Page should not contain element  css=meta[property="og:article:publisher"]\n-  Page should not contain element  css=meta[property="fb:app_id"]\n+    Go to    ${PLONE_URL}\n+    Get Element Count    //meta[@name="twitter:site"]    should be    0\n+    Get Element Count    //meta[@property="og:article:publisher"]    should be    0\n+    Get Element Count    //meta[@property="fb:app_id"]    should be    0\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/542792a6a9f936387d5dbb80b46f7b24448a2698

refactoring controlpanel types robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_types.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_types.robot b/Products/CMFPlone/tests/robot/test_controlpanel_types.robot\nindex b611a93109..4413ba0437 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_types.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_types.robot\n@@ -1,50 +1,50 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n \n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n Scenario: Change default workflow\n-  Given a logged-in site administrator\n-    and the types control panel\n-   When I select \'Single State Workflow\' workflow\n-   Then Wait until page contains  Content Settings\n-   When I add new Link \'my_link\'\n-    Then Link \'my_link\' should have Single State Workflow enabled\n+    Given a logged-in site administrator\n+      and the types control panel\n+     When I select \'Single State Workflow\' workflow\n+      and I add new Link \'my_link\'\n+     Then Link \'my_link\' should have Single State Workflow enabled\n \n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n-# --- GIVEN ------------------------------------------------------------------\n+# GIVEN\n the types control panel\n-  Go to  ${PLONE_URL}/@@content-controlpanel\n-  Wait until page contains  Content Settings\n+    Go to    ${PLONE_URL}/@@content-controlpanel\n+    Get Text    //body    contains    Content Settings\n \n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n I select \'${workflow}\' workflow\n-  Select from list by label  name=new_workflow  ${workflow}\n-  Click Button  Save\n+    Select Options By    //select[@name="new_workflow"]    label    ${workflow}\n+    Click    //button[@name="form.button.Save"]\n+    Wait For Condition    Text    //body    contains   Content Settings\n+\n \n I add new Link \'${id}\'\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Plone site\n-  Create content  type=Link  id=${id}  title=${id}  remoteUrl=http://www.starzel.de\n+    Go to    ${PLONE_URL}\n+    Create content\n+    ...    type=Link\n+    ...    id=${id}\n+    ...    title=${id}\n+    ...    remoteUrl=https://www.plone.org\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n Link \'${id}\' should have Single State Workflow enabled\n-  Go to  ${PLONE_URL}/${id}\n-  Wait until page contains  ${id}\n-  # We check that single state worklow is used, publish button is not present\n-  Page should not contain element  xpath=//a[@id="workflow-transition-publish"]\n+    Go to    ${PLONE_URL}/${id}\n+    # We check that single state worklow is used, publish button is not present\n+    Get Element Count    //a[@id="workflow-transition-publish"]    should be    0\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/97e45bae1af7cacb1a8675698c002a745ab9f100

refactoring controlpanel usergroups robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_usergroups.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_usergroups.robot b/Products/CMFPlone/tests/robot/test_controlpanel_usergroups.robot\nindex 0a4a2a9e1c..1b041b035e 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_usergroups.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_usergroups.robot\n@@ -1,123 +1,103 @@\n-# ============================================================================\n-# Tests for the Plone Usergroups Control Panel\n-# ============================================================================\n-#\n-# $ bin/robot-server --reload-path src/Products.CMFPlone/Products/CMFPlone/ Products.CMFPlone.testing.PRODUCTS_CMFPLONE_ROBOT_TESTING\n-#\n-# $ bin/robot src/Products.CMFPlone/Products/CMFPlone/tests/robot/test_controlpanel_usergroups.robot\n-#\n-# ============================================================================\n+*** Settings ***\n \n-*** Settings *****************************************************************\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Resource  keywords.robot\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n-\n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Show all users in users control panel\n-  Given a logged-in site administrator\n-    and the users control panel\n-   When I click show all users\n-   Then all users should be shown\n+    Given a logged-in site administrator\n+      and the users control panel\n+     When I click show all users\n+     Then all users should be shown\n \n Scenario: Show all groups in groups control panel\n-  Given a logged-in site administrator\n-    and the groups control panel\n-   When I click show all groups\n-   Then all groups should be shown\n+    Given a logged-in site administrator\n+      and the groups control panel\n+     When I click show all groups\n+     Then all groups should be shown\n \n Scenario: Create new group\n-  Given a logged-in site administrator\n-    and the groups control panel\n-   When I create new group\n-   Then new group should show under all groups\n+    Given a logged-in site administrator\n+      and the groups control panel\n+     When I create new group\n+      and I click show all groups\n+     Then new group should show under all groups\n \n Scenario: Enable many groups and many users settings in usergroups control panel\n-  Given a logged-in site administrator\n-    and the user group settings control panel\n-   When I enable many groups and many users settings\n-   Then showing all users is disabled\n-    and showing all groups is disabled\n-\n+    Given a logged-in site administrator\n+      and the user group settings control panel\n+     When I enable many groups and many users settings\n+     Then showing all users is disabled\n+      and showing all groups is disabled\n \n-*** Keywords *****************************************************************\n \n-# --- GIVEN ------------------------------------------------------------------\n+*** Keywords ***\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+# GIVEN\n \n the users control panel\n-  Go to  ${PLONE_URL}/@@usergroup-userprefs\n-  Wait until page contains  User Search\n+    Go to    ${PLONE_URL}/@@usergroup-userprefs\n+    Get Text    //body    contains    User Search\n \n the groups control panel\n-  Go to  ${PLONE_URL}/@@usergroup-groupprefs\n-  Wait until page contains  Group Search\n+    Go to    ${PLONE_URL}/@@usergroup-groupprefs\n+    Get Text    //body    contains    Group Search\n \n the user group settings control panel\n-  Go to  ${PLONE_URL}/@@usergroup-controlpanel\n-  Wait until page contains  User and Groups Settings\n+    Go to    ${PLONE_URL}/@@usergroup-controlpanel\n+    Get Text    //body    contains    User and Groups Settings\n \n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I click show all users\n-  Click button  Show all\n-  Wait until page contains  User Search\n+    Click    //button[@name="form.button.FindAll"]\n+    Get Text    //body    contains    User Search\n \n I click show all groups\n-  Click button  Show all\n-  Wait until page contains  Group Search\n+    Click    //button[@name="form.button.FindAll"]\n+    Get Text    //body    contains    Group Search\n \n I create new group\n-  Click link  Add New Group\n-  Wait until page contains element  name=addname\n-  patterns are loaded\n-  Input Text  name=addname  my-new-group\n-  Input Text  name=title:string  My New Group\n-  Input Text  name=description:text  This is my new group\n-  Input Text  name=email:string  my-group@plone.org\n-  Submit Form  id=createGroup\n-#  "Click button  Save" does not work for modals. See https://stackoverflow.com/questions/17602334/element-is-not-currently-visible-and-so-may-not-be-interacted-with-but-another for details.\n-  I click show all groups\n-  Page should contain  my-new-group\n+    Click    //a[@id="add-group"]\n+    Type Text    //input[@name="addname"]    my-new-group\n+    Type Text    //input[@name="title:string"]    My New Group\n+    Type Text    //textarea[@name="description:text"]    This is my new group\n+    Type Text    //input[@name="email:string"]    my-group@plone.org\n+    Click    //form[@id="createGroup"]//button[@name="form.button.Save"]\n \n I enable many groups and many users settings\n-  Select Checkbox  name=form.widgets.many_groups:list\n-  Select Checkbox  name=form.widgets.many_users:list\n-  Click button  Save\n-  Wait until page contains  Data successfully updated.\n+    Check Checkbox    //input[@name="form.widgets.many_groups:list"]\n+    Check Checkbox    //input[@name="form.widgets.many_users:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Data successfully updated.\n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n all users should be shown\n-  Page should contain  test-user\n-  Page should contain  admin\n+    Get Text    //body    contains    test-user\n+    Get Text    //body    contains    admin\n \n all groups should be shown\n-  Page should contain  Administrators\n-  Page should contain  Authenticated Users (Virtual Group) (AuthenticatedUsers)\n-  Page should contain  Reviewers\n-  Page should contain  Site Administrators\n+    Get Text    //body    contains    Administrators\n+    Get Text    //body    contains    Authenticated Users (Virtual Group) (AuthenticatedUsers)\n+    Get Text    //body    contains    Reviewers\n+    Get Text    //body    contains    Site Administrators\n \n showing all users is disabled\n-  the users control panel\n-  Page should not contain  Show all\n+    the users control panel\n+    Get Text    //body    not contains    Show all\n \n showing all groups is disabled\n-  the users control panel\n-  Page should not contain  Show all\n+    the groups control panel\n+    Get Text    //body    not contains    Show all\n \n new group should show under all groups\n-  Page should contain  my-new-group\n+    Get Text    //body    contains    my-new-group\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/a08b8b75311c204f5ee4b1a99f6d05def5402075

Fix keyword naming

Files changed:
M Products/CMFPlone/tests/robot/keywords.robot
M Products/CMFPlone/tests/robot/test_controlpanel_actions.robot
M Products/CMFPlone/tests/robot/test_controlpanel_markup.robot

b'diff --git a/Products/CMFPlone/tests/robot/keywords.robot b/Products/CMFPlone/tests/robot/keywords.robot\nindex 29899db3c7..10fff221ed 100644\n--- a/Products/CMFPlone/tests/robot/keywords.robot\n+++ b/Products/CMFPlone/tests/robot/keywords.robot\n@@ -9,7 +9,7 @@ Refresh JS/CSS resources\n \n # GIVEN\n \n-a logged-in administrator\n+a logged-in manager\n     Enable autologin as\n     ...    Manager\n \n@@ -87,3 +87,7 @@ Fill text to tinymce editor\n     ...    all_elements=False\n \n     Should not be empty    ${check}\n+\n+Pause\n+   Import library    Dialogs\n+   Pause execution\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot b/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot\nindex 76d00ba201..1574010f60 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot\n@@ -14,40 +14,40 @@ Test Teardown    Run keywords     Plone test teardown\n # hint: the `Sleep` Statement is needed for the `Disable autologin` and the commit in the DB, it takes a while\n \n Scenario: Modify an existing action in Actions Control Panel\n-    Given a logged-in administrator\n+    Given a logged-in manager\n       and the actions control panel\n      When I modify an action title\n       and Sleep    1\n      Then anonymous users can see the new action title\n \n Scenario: Reorder in Actions Control Panel\n-    Given a logged-in administrator\n+    Given a logged-in manager\n       and the actions control panel\n      When I change the actions order\n       and Sleep    1\n      Then anonymous users can see the actions new ordering\n \n Scenario: Create a new action in Actions Control Panel\n-    Given a logged-in administrator\n+    Given a logged-in manager\n       and the actions control panel\n      When I add a new action\n       and Sleep    1\n      Then logged-in users can see the new action\n \n Scenario: Hide/show an action in Actions Control Panel\n-    Given a logged-in administrator\n+    Given a logged-in manager\n       and the actions control panel\n     When I hide an action\n       and Sleep  1\n     Then anonymous users cannot see the action anymore\n-    Given a logged-in administrator\n+    Given a logged-in manager\n       and the actions control panel\n     When I unhide the action\n       and Sleep  1\n     Then anonymous users can see the action again\n \n Scenario: Delete an action in Actions Control Panel\n-    Given a logged-in administrator\n+    Given a logged-in manager\n       and the actions control panel\n      When I delete an action\n       and Sleep  1\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot b/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot\nindex c43732a00d..9b43a45cec 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot\n@@ -20,7 +20,7 @@ Scenario: Change Default Markup Types in the Markup Control Panel\n     #Then I do not see the standard editor when I create a document\n \n Scenario: Set Default Markup to be Restructured Text\n-    Given a logged-in administrator\n+    Given a logged-in manager\n       and the markup control panel\n      When I set the default type to    text/restructured\n \n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/e2af3c77c884ad00d10c2c57df17c08d2d3102a1

remove unused keyword 'Pause'

Files changed:
M Products/CMFPlone/tests/robot/keywords.robot

b'diff --git a/Products/CMFPlone/tests/robot/keywords.robot b/Products/CMFPlone/tests/robot/keywords.robot\nindex 10fff221ed..71d2dfec69 100644\n--- a/Products/CMFPlone/tests/robot/keywords.robot\n+++ b/Products/CMFPlone/tests/robot/keywords.robot\n@@ -87,7 +87,3 @@ Fill text to tinymce editor\n     ...    all_elements=False\n \n     Should not be empty    ${check}\n-\n-Pause\n-   Import library    Dialogs\n-   Pause execution\n\\ No newline at end of file\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/8dfb312e50c4c88101fb8c5e3792c41467f7a6af

refactoring edit user schema robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_edit_user_schema.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_edit_user_schema.robot b/Products/CMFPlone/tests/robot/test_edit_user_schema.robot\nindex 439bb5b074..60e1a0a691 100644\n--- a/Products/CMFPlone/tests/robot/test_edit_user_schema.robot\n+++ b/Products/CMFPlone/tests/robot/test_edit_user_schema.robot\n@@ -1,36 +1,23 @@\n-# ============================================================================\n-# Tests Editing the User Schema\n-# ============================================================================\n-#\n-# $ bin/robot-server --reload-path src/Products.CMFPlone/Products/CMFPlone/ Products.CMFPlone.testing.PRODUCTS_CMFPLONE_ROBOT_TESTING\n-#\n-# $ bin/robot src/Products.CMFPlone/Products/CMFPlone/tests/robot/test_edit_user_schema.robot\n-#\n-# ============================================================================\n-\n *** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n-\n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Resource  keywords.robot\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n \n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: As a manager I can add a field to the registration form\n-  Given a logged-in manager\n-    and the mail setup configured\n-    and site registration enabled\n-   When I add a new text field to the member fields\n-    and choose to show the field on registration\n-   Then an anonymous user will see the field in the registration form\n+    Given a logged-in manager\n+      and the mail setup configured\n+      and site registration enabled\n+     When I add a new text field to the member fields\n+      and choose to show the field on registration\n+     Then an anonymous user will see the field in the registration form\n \n Scenario: As a manager I can add a field to the user form\n   Given a logged-in manager\n@@ -41,12 +28,12 @@ Scenario: As a manager I can add a field to the user form\n    Then a logged-in user will see the field in the user profile\n \n Scenario: As a manager I can add a required field to the user form\n-  Given a logged-in manager\n-    and the mail setup configured\n-    and site registration enabled\n-   When I add a new required text field to the member fields\n-    and choose to show the field in the user profile\n-   Then a logged-in user will see the required field in the user profile\n+    Given a logged-in manager\n+      and the mail setup configured\n+      and site registration enabled\n+     When I add a new required text field to the member fields\n+      and choose to show the field in the user profile\n+     Then a logged-in user will see the required field in the user profile\n \n Scenario: As a manager I can move user form fields\n   Pass Execution  Drag and drop in schemaeditor does not work\n@@ -69,111 +56,92 @@ Scenario: As a manager I can add a field with constraints to the registration fo\n \n \n \n-*** Keywords *****************************************************************\n-\n-# --- GIVEN ------------------------------------------------------------------\n+*** Keywords ***\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n-\n-a logged-in manager\n-  Enable autologin as  Manager\n+# GIVEN\n \n site registration enabled\n-  Go To  ${PLONE_URL}/@@security-controlpanel\n-  Wait until page contains  Security Settings\n-  Wait until page contains element  form.widgets.enable_self_reg:list\n-  Select Checkbox  form.widgets.enable_self_reg:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved.\n-\n+    Go To  ${PLONE_URL}/@@security-controlpanel\n+    Get Text    //body    contains    Security Settings\n+    Check Checkbox    //input[@name="form.widgets.enable_self_reg:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I add a new text field to the member fields\n-  Go to  ${PLONE_URL}/@@member-fields\n-  Wait until page contains element  css=#add-field\n-  Click Link  Add new field\xe2\x80\xa6\n-  Wait Until Element Is visible  css=#add-field-form #form-widgets-title\n-  Input Text  css=#add-field-form #form-widgets-title  Test Field\n-  Press Keys  css=#add-field-form #form-widgets-title  TAB\n-  Select From List By Label  css=#form-widgets-factory  Text line (String)\n-  Click button  css=.pattern-modal-buttons button#form-buttons-add\n-  Wait until page contains  Field added successfully.\n+    Go to    ${PLONE_URL}/@@member-fields\n+    Click    //a[@id="add-field"]\n+    Type Text    //form[@id="add-field-form"]//input[@name="form.widgets.title"]    Test Field\n+    Press Keys  //form[@id="add-field-form"]//input[@name="form.widgets.title"]    Tab\n+    Select Options By    //form[@id="add-field-form"]//select[@name="form.widgets.factory:list"]    label    Text line (String)\n+    Click    //div[@class="modal-footer"]//button[@name="form.buttons.add"]\n+    Get Text    //body    contains    Field added successfully.\n \n I Open the test_field Settings\n-  Go to  ${PLONE_URL}/@@member-fields\n-  Wait For Element  css=div[data-field_id=\'test_field\']\n-  Wait For Then Click Element  css=div[data-field_id=\'test_field\'] a.fieldSettings\n+    Go to    ${PLONE_URL}/@@member-fields\n+    Click    //div[@data-field_id="test_field"]//a[contains(@class,"fieldSettings")]\n \n I add a new required text field to the member fields\n-  Go to  ${PLONE_URL}/@@member-fields\n-  Wait until page contains element  css=#add-field\n-  Click Link  Add new field\xe2\x80\xa6\n-  Wait Until Element Is visible  css=#add-field-form #form-widgets-title\n-  Input Text  css=#add-field-form #form-widgets-title  Test Field\n-  Press Keys  css=#add-field-form #form-widgets-title  TAB\n-  Select From List By Label  css=#form-widgets-factory  Text line (String)\n-  Select Checkbox  form.widgets.required:list\n-  Click button  css=.pattern-modal-buttons button#form-buttons-add\n-  Wait until page contains  Field added successfully.\n+    Go to  ${PLONE_URL}/@@member-fields\n+    Click    //a[@id="add-field"]\n+    Type Text    //form[@id="add-field-form"]//input[@name="form.widgets.title"]    Test Field\n+    Press Keys  //form[@id="add-field-form"]//input[@name="form.widgets.title"]    Tab\n+    Select Options By    //form[@id="add-field-form"]//select[@name="form.widgets.factory:list"]    label    Text line (String)\n+    Check Checkbox    //input[@name="form.widgets.required:list"]\n+    Click    //div[@class="modal-footer"]//button[@name="form.buttons.add"]\n+    Get Text    //body    contains    Field added successfully.\n \n choose to show the field on registration\n-  I Open the test_field Settings\n-  Wait Until Element Is visible  form.widgets.IUserFormSelection.forms:list\n-  Select Checkbox  css=#form-widgets-IUserFormSelection-forms-0\n-  Click button  css=.pattern-modal-buttons button#form-buttons-save\n-  Wait until page contains  Data successfully updated.\n+    I Open the test_field Settings\n+    Check Checkbox  //input[@name="form.widgets.IUserFormSelection.forms:list" and @value="On Registration"]\n+    Click    //div[@class="modal-footer"]//button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Data successfully updated.\n \n choose to show the field in the user profile\n-  I Open the test_field Settings\n-  Wait Until Element Is visible  form.widgets.IUserFormSelection.forms:list\n-  Select Checkbox  css=#form-widgets-IUserFormSelection-forms-1\n-  Click button  css=.pattern-modal-buttons button#form-buttons-save\n-  Wait until page contains  Data successfully updated.\n+    I Open the test_field Settings\n+    Check Checkbox  //input[@name="form.widgets.IUserFormSelection.forms:list" and @value="In User Profile"]\n+    Click    //div[@class="modal-footer"]//button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Data successfully updated.\n \n I move the new field to the top\n-  # XXX: Drag and drop is not working!!!\n-  Drag And Drop  xpath=//div[@data-field_id="test_field"]//span[contains(@class, "draghandle")]  xpath=//div[@data-field_id="home_page"]\n+    Drag And Drop    //div[@data-field_id="test_field"]//span[contains(@class, "draghandle")]    //div[@data-field_id="home_page"]\n+\n \n add a min/max constraint to the field\n-  I Open the test_field Settings\n-  Wait until page contains element  form.widgets.min_length\n-  Input Text  form.widgets.min_length  4\n-  Input Text  form.widgets.max_length  6\n-  Wait Until Element Is visible  css=.pattern-modal-buttons button#form-buttons-save\n-  Click Button  css=.pattern-modal-buttons button#form-buttons-save\n-  Sleep  1\n+    I Open the test_field Settings\n+    Type Text    //input[@name="form.widgets.min_length"]    4\n+    Type Text    //input[@name="form.widgets.max_length"]    6\n+    Click    //div[@class="modal-footer"]//button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Data successfully updated.\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n an anonymous user will see the field in the registration form\n-  Disable Autologin\n-  Go to  ${PLONE_URL}/@@register\n-  Wait until page contains  Register\n-  Page should contain element  form.widgets.test_field\n+    Disable Autologin\n+    Go to    ${PLONE_URL}/@@register\n+    Get Text    //body    contains    Register\n+    Get Element Count    //input[@name="form.widgets.test_field"]    should be    1\n \n a logged-in user will see the field in the user profile\n-  Disable Autologin\n-  Enable autologin as  Member\n-  Go to  ${PLONE_URL}/@@personal-information\n-  Wait until page contains  Change your personal information\n-  Page should contain element  form.widgets.test_field\n+    Disable Autologin\n+    a logged-in member\n+    Go to    ${PLONE_URL}/@@personal-information\n+    Get Element Count    //input[@name="form.widgets.test_field"]    should be    1\n \n a logged-in user will see the required field in the user profile\n-  a logged-in user will see the field in the user profile\n-  Page Should Contain Element  //div[@id=\'formfield-form-widgets-test_field\']//span[contains(@class, \'required\')]  limit=1  message=test_field should be required\n+    a logged-in user will see the field in the user profile\n+    Get Element Count    //div[@id=\'formfield-form-widgets-test_field\']//span[contains(@class, \'required\')]    should be    1    message=test_field should be required\n \n a logged-in user will see the field on top of the user profile\n-  a logged-in user will see the field in the user profile\n-  Page Should Contain Element  //form[@id=\'form\']/div[1]//input[@id=\'form-widgets-test_field\']  limit=1  message=test_field should be on top\n+    a logged-in user will see the field in the user profile\n+    Get Element Count    //form[@id=\'form\']/div[1]//input[@id=\'form-widgets-test_field\']    should be    1    message=test_field should be on top\n \n a logged-in user will see a field with min/max constraints\n-  a logged-in user will see the field in the user profile\n-  Input Text  form.widgets.email  test@plone.org\n-  Wait For Element  css=#form-widgets-test_field\n-  Input Text  form.widgets.test_field  1\n-  Wait For Then Click Element  css=.formControls button#form-buttons-save\n-  Wait until page contains  There were some errors.\n-  Page should contain  Value is too short\n+    a logged-in user will see the field in the user profile\n+    Type Text    //input[@name="form.widgets.email"]    test@plone.org\n+    Type Text    //input[@name="form.widgets.test_field"]    1\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    There were some errors.\n+    Get Text    //body    contains    Value is too short\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/c94d90851a652c21db3cac50d41f787f804c2470

refactoring edit content robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_edit.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_edit.robot b/Products/CMFPlone/tests/robot/test_edit.robot\nindex 169b44418d..aede766e59 100644\n--- a/Products/CMFPlone/tests/robot/test_edit.robot\n+++ b/Products/CMFPlone/tests/robot/test_edit.robot\n@@ -1,26 +1,23 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n \n-\n-*** Variables ****************************************************************\n+*** Variables ***\n \n ${TITLE}  An edited page\n ${LINK_TITLE}  An edited link item\n ${PAGE_ID}  an-edited-page\n ${LINK_ID}  an-edited-link-item\n-${SELENIUM_RUN_ON_FAILURE}  Capture Page Screenshot and log source\n \n-*** Test cases ***************************************************************\n+\n+*** Test cases ***\n \n Scenario: A page is opened to edit\n     Given a logged-in site administrator\n@@ -31,7 +28,7 @@ Scenario: A page is opened to edit\n Scenario: Switch tabs\n     Given a logged-in site administrator\n       and an edited page\n-     When i click the Categorization tab\n+     When i click the \'Categorization\' tab\n      Then the Categorization tab is shown\n       and no other tab is shown\n \n@@ -41,7 +38,7 @@ Scenario: Adding a related item\n     Given a logged-in site administrator\n       and at least one other item\n       and an edited page\n-     When i click the Categorization tab\n+     When i click the \'Categorization\' tab\n       and i select a related item\n       and i save the page\n      Then the related item is shown in the page\n@@ -79,68 +76,70 @@ Scenario: Add an internal link to linked item\n      Then the linked item is shown in the page\n       and Capture page screenshot and log source\n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n-# --- GIVEN ------------------------------------------------------------------\n+# GIVEN\n \n an edited page\n-    Create content  type=Document  title=${TITLE}\n-    Go to  ${PLONE_URL}/${PAGE_ID}/edit\n-    Wait until page contains  Edit Page\n+    Create content\n+    ...    type=Document\n+    ...    title=${TITLE}\n+    Go to    ${PLONE_URL}/${PAGE_ID}/edit\n+    Get Text    //body    contains    Edit Page\n \n an edited link item\n-    Create content  type=Link  title=${LINK_TITLE}\n-    Go to  ${PLONE_URL}/${LINK_ID}/edit\n-    Wait until page contains  Edit Link\n+    Create content\n+    ...    type=Link\n+    ...    title=${LINK_TITLE}\n+    Go to    ${PLONE_URL}/${LINK_ID}/edit\n+    Get Text    //body    contains    Edit Link\n \n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I have the title input field\n-    Element Should Be Visible  xpath=//fieldset[@id=\'fieldset-default\']\n+    Get Element States    //fieldset[@id=\'fieldset-default\']    contains    visible\n \n I can only see the default tab\n-    Wait For Condition  return window.jQuery(\'.autotoc-nav .active:visible\').length > 0\n-    Element Should Not Be Visible  xpath=//fieldset[@id=\'fieldset-settings\']\n-    Element Should Not Be Visible  xpath=//fieldset[@id=\'fieldset-dates\']\n-    Element Should Not Be Visible  xpath=//fieldset[@id=\'fieldset-categorization\']\n+    Get Element States    //fieldset[@id=\'fieldset-default\']    contains    visible\n+    Get Element States    //fieldset[@id=\'fieldset-dates\']    not contains    visible\n+    Get Element States    //fieldset[@id=\'fieldset-categorization\']   not contains    visible\n \n I click the ${tab} tab\n-    Given patterns are loaded\n-    Click link  ${tab}\n+    Click    //a[contains(text(),${tab})]\n \n I select a related item\n     # Click the select button\n-    Wait For Then Click Element  //div[@id="formfield-form-widgets-IRelatedItems-relatedItems"]//button\n+    Click    //div[@id="formfield-form-widgets-IRelatedItems-relatedItems"]//button\n     # Click first element in first column\n-    Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[1]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[1]\n     # Click the select Button in the Toolbar of column 2\n-    Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[2]/div[contains(@class, "levelToolbar")]/button\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[2]/div[contains(@class, "levelToolbar")]/button\n \n I select a linked item\n     # Click the select button\n-    Wait For Then Click Element  //div[@id="formfield-form-widgets-remoteUrl"]//button\n+    Click  //div[@id="formfield-form-widgets-remoteUrl"]//button\n     # Click first element in first column\n-    Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[1]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[1]\n     # Click the select Button in the Toolbar of column 2\n     # This selects the "test-folder"\n-    Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[2]/div[contains(@class, "levelToolbar")]/button\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[2]/div[contains(@class, "levelToolbar")]/button\n \n I save the page\n-   Click Button  Save\n+    Click    //button[@name="form.buttons.save"]\n \n I click the calendar icon\n-    Click Element  xpath=//span[@id=\'edit_form_effectiveDate_0_popup\']\n-    Element Should Be Visible  xpath=//div[@class=\'calendar\']\n+    Click    //span[@id=\'edit_form_effectiveDate_0_popup\']\n+    Get Element States    //div[@class=\'calendar\']   contains    visible\n \n I select a date using the widget\n-    Click Element  xpath=//div[@class=\'calendar\']/table/thead/tr[2]/td[4]/div\n+    Click    //div[@class=\'calendar\']/table/thead/tr[2]/td[4]/div\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n popup calendar should have the same date\n-    Element Text Should Be  xpath=//div[@class=\'calendar\']//thead//td[@class=\'title\']  January, 2001\n+    Get Text    //div[@class=\'calendar\']//thead//td[@class=\'title\']    should be    January, 2001\n \n form dropdowns should not have the default values anymore\n     ${yearLabel} =  Get Selected List Label  xpath=//select[@id=\'edit_form_effectiveDate_0_year\']\n@@ -151,25 +150,26 @@ form dropdowns should not have the default values anymore\n     Should Not Be Equal  ${dayLabel}  --\n \n the related item is shown in the page\n-    Page should contain element  css=#section-related\n+    Get Element Count    //*[@id="section-related"]    should be    1\n \n the linked item is shown in the page\n     # check if the selected testfolder is linked\n-    Page should contain element  xpath=//a[@href=\'${PLONE_URL}/test-folder\']\n+    Get Element Count    //a[@href=\'${PLONE_URL}/test-folder\']    greater than    0\n+\n \n an overlay pops up\n-    Wait Until Page Contains Element  xpath=//div[contains(@class, \'overlay\')]//input[@class=\'insertreference\']\n+    Get Element Count    //div[contains(@class, \'overlay\')]//input[@class=\'insertreference\']    should be    1\n \n the categorization tab is shown\n-    Element Should Be Visible  xpath=//fieldset[@id=\'fieldset-categorization\']\n+    Get Element States    //fieldset[@id=\'fieldset-categorization\']    contains    visible\n \n no other tab is shown\n-    Element Should Not Be Visible  xpath=//fieldset[@id=\'fieldset-dates\']\n-    Element Should Not Be Visible  xpath=//fieldset[@id=\'fieldset-default\']\n-    Element Should Not Be Visible  xpath=//fieldset[@id=\'fieldset-settings\']\n+    Get Element States    //fieldset[@id=\'fieldset-dates\']    not contains    visible\n+    Get Element States    //fieldset[@id=\'fieldset-default\']    not contains    visible\n+    Get Element States    //fieldset[@id=\'fieldset-settings\']    not contains    visible\n \n at least one other item\n-    Go to  ${PLONE_URL}/++add++Document\n-    Given patterns are loaded\n-    Execute Javascript  $(\'#form-widgets-IDublinCore-title\').val(\'${TITLE}\'); return 0;\n-    Click Button  Save\n+    Go to    ${PLONE_URL}/++add++Document\n+    Type Text    //input[@id="form-widgets-IDublinCore-title"]    ${TITLE}\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Item created\n\\ No newline at end of file\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/35e8c62491c0546e578f64cc37634ec64e5fb7c8

refactoring folder contents robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_folder_contents.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_folder_contents.robot b/Products/CMFPlone/tests/robot/test_folder_contents.robot\nindex 1406b233e7..2cf3140cdf 100644\n--- a/Products/CMFPlone/tests/robot/test_folder_contents.robot\n+++ b/Products/CMFPlone/tests/robot/test_folder_contents.robot\n@@ -1,18 +1,15 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n \n-\n-*** Test cases ***************************************************************\n+*** Test cases ***\n \n \n Scenario: Select All items\n@@ -36,77 +33,83 @@ Scenario: Reorder Folder Contents\n    Given a logged-in site administrator\n      and a folder with four pages\n      and the folder contents view\n-    Then The Order Should Be  1   2   3   4\n+    Then The Order Should Be    1    2    3    4\n     When I reorder the elements\n-    Then The Order Should Be  4   3   2   1\n+    Then The Order Should Be    4    3    2    1\n \n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n \n a folder with four pages\n-    ${folder_uid}=  Create content  type=Folder  title=My Folder\n-    Create content  type=Document  title=Doc1  container=${folder_uid}\n-    Create content  type=Document  title=Doc2  container=${folder_uid}\n-    Create content  type=Document  title=Doc3  container=${folder_uid}\n-    Create content  type=Document  title=Doc4  container=${folder_uid}\n+    ${folder_uid}=    Create content\n+    ...    type=Folder\n+    ...    title=My Folder\n+    Create content\n+    ...    type=Document\n+    ...    title=Doc1\n+    ...    container=${folder_uid}\n+    Create content\n+    ...    type=Document\n+    ...    title=Doc2\n+    ...    container=${folder_uid}\n+    Create content\n+    ...    type=Document\n+    ...    title=Doc3\n+    ...    container=${folder_uid}\n+    Create content\n+    ...    type=Document\n+    ...    title=Doc4\n+    ...    container=${folder_uid}\n \n the folder contents view\n-    Go to  ${PLONE_URL}/my-folder/folder_contents\n-    Given folder contents pattern loaded\n+    Go to    ${PLONE_URL}/my-folder/folder_contents\n \n I click the \'${link_name}\' link\n-    Click Link  ${link_name}\n+    Click    //a[contains(text(),${link_name})]\n \n I select all the elements\n-    Wait until page contains element  css=.pat-structure .select-all\n-    Sleep  1s\n-    ${select_all_selector}  Set Variable  .pat-structure .select-all\n-    Wait Until Element Is Visible  css=${select_all_selector}\n-    Click Element  css=${select_all_selector}\n+    Check Checkbox    //*[contains(@class,"pat-structure")]//input[contains(@class,"select-all")]\n \n the four elements got selected\n-    Checkbox Should Be Selected  css=tr[data-id="doc1"] input\n-    Checkbox Should Be Selected  css=tr[data-id="doc2"] input\n-    Checkbox Should Be Selected  css=tr[data-id="doc3"] input\n-    Checkbox Should Be Selected  css=tr[data-id="doc4"] input\n+    Get Checkbox State      //tr[@data-id="doc1"]//input    ==    checked\n+    Get Checkbox State      //tr[@data-id="doc2"]//input    ==    checked\n+    Get Checkbox State      //tr[@data-id="doc3"]//input    ==    checked\n+    Get Checkbox State      //tr[@data-id="doc4"]//input    ==    checked\n \n the selection count appears\n-    Wait until page contains element  css=#btn-selected-items .label-success\n-    Element Should Contain  css=#btn-selected-items .label-success  4\n+    Get Text    //*[@id="btn-selected-items"]//*[contains(@class,"label-success")]    should be    4\n \n the clear selection link appears\n-    Page Should Contain Element  css=a.remove-all\n+    Get Element Count    //a[contains(@class,"remove-all")]    greater than    0\n \n I clear the selection\n-    Click link  id=btn-selected-items\n-    Click link  css=a.remove-all\n+    Click    //a[@id="btn-selected-items"]\n+    Wait For Condition    Element States    //*[@id="popover-selected-items"]    contains    visible\n+    Click    //a[contains(@class,"remove-all")]\n \n no elements should be selected\n-    Checkbox Should Not Be Selected  css=tr[data-id="doc1"] input\n-    Checkbox Should Not Be Selected  css=tr[data-id="doc2"] input\n-    Checkbox Should Not Be Selected  css=tr[data-id="doc3"] input\n-    Checkbox Should Not Be Selected  css=tr[data-id="doc4"] input\n+    Get Checkbox State      //tr[@data-id="doc1"]//input    ==    unchecked\n+    Get Checkbox State      //tr[@data-id="doc2"]//input    ==    unchecked\n+    Get Checkbox State      //tr[@data-id="doc3"]//input    ==    unchecked\n+    Get Checkbox State      //tr[@data-id="doc4"]//input    ==    unchecked\n \n I reorder the elements\n-    Click link  css=#btn-structure-rearrange\n-    Click element  name=reversed\n-    Click button  css=#popover-structure-rearrange .btn-primary\n-    Wait until page contains  Successfully rearranged folder\n+    Click    //a[@id="btn-structure-rearrange"]\n+    Check Checkbox    //*[@id="popover-structure-rearrange"]//input[@name="reversed"]\n+    Click    //*[@id="popover-structure-rearrange"]//button[contains(text(),"Rearrange")]\n+    Wait For Condition    Text    //body    contains    Successfully rearranged folder\n \n The Order Should Be\n-    [Arguments]  ${first}  ${second}  ${third}  ${fourth}\n-    Wait Until Element Is Visible  css=#doc${first}\n-    Wait Until Element Is Visible  css=#doc${second}\n-    Wait Until Element Is Visible  css=#doc${third}\n-    Wait Until Element Is Visible  css=#doc${fourth}\n-    Should be above  css=tr[data-id="doc${first}"]   css=tr[data-id="doc${second}"]\n-    Should be above  css=tr[data-id="doc${second}"]  css=tr[data-id="doc${third}"]\n-    Should be above  css=tr[data-id="doc${third}"]   css=tr[data-id="doc${fourth}"]\n+    [Arguments]    ${first}    ${second}    ${third}    ${fourth}\n+    Should be above    //tr[@data-id="doc${first}"]    //tr[@data-id="doc${second}"]\n+    Should be above    //tr[@data-id="doc${second}"]    //tr[@data-id="doc${third}"]\n+    Should be above    //tr[@data-id="doc${third}"]    //tr[@data-id="doc${fourth}"]\n \n Should be above\n-    [Arguments]  ${locator1}  ${locator2}\n+    [Arguments]    ${locator1}    ${locator2}\n+\n+    ${locator1-position}=    Get BoundingBox    ${locator1}    y\n+    ${locator2-position}=    Get BoundingBox    ${locator2}    y\n \n-    ${locator1-position} =  Get vertical position  ${locator1}\n-    ${locator2-position} =  Get vertical position  ${locator2}\n-    Should be true  ${locator1-position} < ${locator2-position}\n+    Should be true    ${locator1-position} < ${locator2-position}\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/f418d36348fba3d9bdc1d2546ebccde54bcd6131

refactoring linkintegrity robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_linkintegrity.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_linkintegrity.robot b/Products/CMFPlone/tests/robot/test_linkintegrity.robot\nindex b45dc121ac..d84decd51e 100644\n--- a/Products/CMFPlone/tests/robot/test_linkintegrity.robot\n+++ b/Products/CMFPlone/tests/robot/test_linkintegrity.robot\n@@ -1,147 +1,132 @@\n-# ============================================================================\n-# Tests for the Plone Link Integrity Support\n-# ============================================================================\n-#\n-# $ bin/robot-server --reload-path src/Products.CMFPlone/Products/CMFPlone/ Products.CMFPlone.testing.PRODUCTS_CMFPLONE_ROBOT_TESTING\n-#\n-# $ bin/robot src/Products.CMFPlone/Products/CMFPlone/tests/robot/test_linkintegrity.robot\n-#\n-# ============================================================================\n+*** Settings ***\n \n-*** Settings *****************************************************************\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Resource  keywords.robot\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n-\n-*** Variables ****************************************************************\n-\n-${SELENIUM_RUN_ON_FAILURE}  Capture page screenshot and log source\n-\n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: When page is linked show warning\n   Given a logged-in site administrator\n     and a page to link to\n     and a page to edit\n-    and a link in rich text\n-    should show warning when deleting page\n-\n+   When I add a link in rich text\n+   Then I should see a warning when deleting page\n \n Scenario: After you fix linked page no longer show warning\n   Given a logged-in site administrator\n-  a page to link to\n+    and a page to link to\n     and a page to edit\n-    and a link in rich text\n-  should show warning when deleting page\n-    remove link to page\n-  should not show warning when deleting page\n+   When I add a link in rich text\n+   Then I should see a warning when deleting page\n \n+   When I remove link to page\n+   Then I should not see a warning when deleting page\n \n Scenario: Show warning when deleting linked item from folder_contents\n-  Given a logged-in site administrator\n-  a page to link to\n-    and a page to edit\n-    and a link in rich text\n-  should show warning when deleting page from folder_contents\n-    remove link to page\n-  should not show warning when deleting page from folder_contents\n-\n-\n-*** Keywords *****************************************************************\n+    Given a logged-in site administrator\n+      and a page to link to\n+      and a page to edit\n+     When I add a link in rich text\n+     Then I should see a warning when deleting page from folder_contents\n \n-# --- GIVEN ------------------------------------------------------------------\n+     When I remove link to page\n+     Then I should not see a warning when deleting page from folder_contents\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+*** Keywords ***\n \n+# GIVEN\n \n a page to link to\n-  Create content  type=Document  id=foo  title=Foo\n+    Create content\n+    ...    type=Document\n+    ...    id=foo\n+    ...    title=Foo\n \n a page to edit\n-  Create content  type=Document  id=bar  title=Bar\n-\n-\n-a link in rich text\n-  Go To  ${PLONE_URL}/bar/edit\n-  Wait until element is visible  css=.tox-edit-area iframe\n-  Select Frame  css=.tox-edit-area iframe\n-  Input text  css=.mce-content-body  foo\n-  Execute Javascript    function selectElementContents(el) {var range = document.createRange(); range.selectNodeContents(el); var sel = window.getSelection(); sel.removeAllRanges(); sel.addRange(range);} var el = document.getElementById("tinymce"); selectElementContents(el);\n-  UnSelect Frame\n-\n-  Click Button  css=button[aria-label="Insert/edit link"]\n-  Wait For Then Click Element  css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n-  Wait For Then Click Element  xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[3]\n-  Wait For Then Click Element  xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n-  Wait Until Element Is Not Visible    xpath=//div[contains(@class,"content-browser-position-wrapper")]\n-  Wait For Then Click Element  css=.modal-footer input[name="insert"]\n-  Select Frame  css=.tox-edit-area iframe\n-  Execute Javascript  window.getSelection().removeAllRanges()\n-  UnSelect Frame\n-  Wait Until Element Is Not Visible  css=.modal-footer input[name="insert"]\n-  Wait For Then Click Element  css=#form-buttons-save\n-\n-\n-should show warning when deleting page\n-\n-  Go To  ${PLONE_URL}/foo\n-  Wait For Then Click Element  css=#plone-contentmenu-actions > a\n-  Wait For Then Click Element  css=#plone-contentmenu-actions-delete\n-  Wait until page contains element  css=.breach-container .breach-item\n-\n-\n-should show warning when deleting page from folder_contents\n-  Go To  ${PLONE_URL}/folder_contents\n-  Given folder contents pattern loaded\n-  Wait For Then Click Element  css=tr[data-id="foo"] input\n-  Checkbox Should Be Selected  css=tr[data-id="foo"] input\n-  Wait until keyword succeeds  30  1  Page should not contain element  css=#btn-delete.disabled\n-\n-  Wait For Then Click Element  css=#btngroup-mainbuttons #btn-delete\n-  Wait until page contains element  css=.popover-content .btn-danger\n-  Page should contain element  css=.breach-container .breach-item\n-  Wait For Then Click Element  css=#popover-delete .closeBtn\n-  Checkbox Should Be Selected  css=tr[data-id="foo"] input\n-\n-\n-should not show warning when deleting page from folder_contents\n-  Go To  ${PLONE_URL}/folder_contents\n-  Given folder contents pattern loaded\n-  Wait For Then Click Element  css=tr[data-id="foo"] input\n-  Checkbox Should Be Selected  css=tr[data-id="foo"] input\n-  Wait until keyword succeeds  30  1  Page should not contain element  css=#btn-delete.disabled\n-  Wait For Then Click Element  css=#btngroup-mainbuttons #btn-delete\n-  Wait until page contains element  css=.popover-content .btn-danger\n-  Page should not contain element  css=.breach-container .breach-item\n-  Wait For Then Click Element  css=#popover-delete .applyBtn\n-  Wait until page contains  Successfully delete items\n-  Wait until keyword succeeds  30  1  Page should not contain Element  css=tr[data-id="foo"] input\n-\n-\n-should not show warning when deleting page\n-  Go To  ${PLONE_URL}/foo\n-  Wait For Then Click Element  css=#plone-contentmenu-actions > a\n-  Wait For Then Click Element  css=#plone-contentmenu-actions-delete\n-  Page should not contain element  css=.breach-container .breach-item\n-\n-\n-remove link to page\n-  Go To  ${PLONE_URL}/bar\n-  Wait For Then Click Element  css=#contentview-edit a\n-  Wait For Element  css=.tox-edit-area iframe\n-  Select Frame  css=.tox-edit-area iframe\n-  Input text  css=.mce-content-body  foo\n-  Execute Javascript    function selectElementContents(el) {var range = document.createRange(); range.selectNodeContents(el); var sel = window.getSelection(); sel.removeAllRanges(); sel.addRange(range);} var el = document.getElementById("tinymce"); selectElementContents(el);\n-  UnSelect Frame\n-  Click Button  css=button[aria-label="Remove link"]\n-  Wait For Then Click Element  css=#form-buttons-save\n+    Create content\n+    ...    type=Document\n+    ...    id=bar\n+    ...    title=Bar\n+\n+# When\n+I add a link in rich text\n+    Go To    ${PLONE_URL}/bar/edit\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    foo\n+    Mark text foo in tinymce editor\n+    Click    //button[@aria-label="Insert/edit link"]\n+    Click    //div[contains(@class,"linkModal")]//div[contains(@class,"content-browser-selected-items-wrapper")]//button[contains(@class,"btn-primary")]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[3]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n+    Click    //div[contains(@class,"modal-footer")]//input[@name="insert"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n+\n+I remove link to page\n+    Go To    ${PLONE_URL}/bar\n+    Click    //*[@id="contentview-edit"]//a\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    foo\n+    Mark text foo in tinymce editor\n+    Click    //button[@aria-label="Remove link"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n+\n+# Then\n+\n+I should see a warning when deleting page\n+    Go To  ${PLONE_URL}/foo\n+    Click    //*[@id="plone-contentmenu-actions"]/a\n+    Click    //*[@id="plone-contentmenu-actions-delete"]\n+    Get Element Count    //*[contains(@class,"breach-container")]//*[contains(@class,"breach-item")]    greater than    0\n+\n+I should not see a warning when deleting page\n+    Go To  ${PLONE_URL}/foo\n+    Click    //*[@id="plone-contentmenu-actions"]/a\n+    Click    //*[@id="plone-contentmenu-actions-delete"]\n+    Get Element Count    //*[contains(@class,"breach-container")]//*[contains(@class,"breach-item")]    should be    0\n+\n+\n+I should see a warning when deleting page from folder_contents\n+    Go To  ${PLONE_URL}/folder_contents\n+    Check Checkbox    //tr[@data-id="foo"]//input\n+    Get Checkbox State      //tr[@data-id="foo"]//input    ==    checked\n+    Get Element Count    //*[@id="btngroup-mainbuttons"]//a[@id="btn-delete" and contains(@class,"disabled")]    should be    0\n+    Click    //*[@id="btngroup-mainbuttons"]//a[@id="btn-delete"]\n+    Get Element Count    //*[contains(@class,"breach-container")]//*[contains(@class,"breach-item")]    greater than    0\n+    Get Checkbox State      //tr[@data-id="foo"]//input    ==    checked\n+\n+\n+I should not see a warning when deleting page from folder_contents\n+    Go To  ${PLONE_URL}/folder_contents\n+    Check Checkbox    //tr[@data-id="foo"]//input\n+    Get Checkbox State      //tr[@data-id="foo"]//input    ==    checked\n+    Get Element Count    //*[@id="btngroup-mainbuttons"]//a[@id="btn-delete" and contains(@class,"disabled")]    should be    0\n+    Click    //*[@id="btngroup-mainbuttons"]//a[@id="btn-delete"]\n+    Get Element States    //*[@id="popover-delete"]//*[contains(@class,"popover-content")]    contains    visible\n+    Get Element Count    //*[contains(@class,"breach-container")]//*[contains(@class,"breach-item")]    should be    0\n+    Click    //*[contains(@class,"popover-content")]//button[contains(@class,"applyBtn")]\n+    Get Text    //body    contains    Successfully delete items\n+    Get Element Count      //tr[@data-id="foo"]//input    should be    0\n+\n+# DRY\n+\n+Mark text foo in tinymce editor\n+\n+    # select the text `heading` via javascript\n+    Evaluate JavaScript    ${None}\n+    ...    () => {\n+    ...        let iframe_document = document.querySelector(".tox-edit-area iframe").contentDocument;\n+    ...        let body = iframe_document.body;\n+    ...        let p = body.firstChild;\n+    ...        let range = new Range();\n+    ...        range.setStart(p.firstChild, 0);\n+    ...        range.setEnd(p.firstChild, 3);\n+    ...        iframe_document.getSelection().removeAllRanges();\n+    ...        iframe_document.getSelection().addRange(range);\n+    ...    }\n+    ...    all_elements=False\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/cbf2add6bf53445f847e876cd6a815956d545c78

refactoring livesearch robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_livesearch.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_livesearch.robot b/Products/CMFPlone/tests/robot/test_livesearch.robot\nindex 8bed725311..a8a2c33ee5 100644\n--- a/Products/CMFPlone/tests/robot/test_livesearch.robot\n+++ b/Products/CMFPlone/tests/robot/test_livesearch.robot\n@@ -1,84 +1,82 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Variables  Products/CMFPlone/tests/robot/variables.py\n+Variables    variables.py\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n \n-\n-*** Test cases ***************************************************************\n+*** Test cases ***\n \n \n Scenario: Simple Livesearch\n     Given a logged-in site administrator\n-      and a document  Welcome to Plone\n-     When I search for  Welcome\n-     Then the livesearch results should contain  Welcome to Plone\n-      and expected livesearch results  1\n+      and a document    Welcome to Plone\n+     When I search for    Welcome\n+     Then the livesearch results should contain    Welcome to Plone\n+      and expected livesearch results    1\n \n Scenario: Livesearch with image results\n     Given a logged-in site administrator\n-      and a news item  My News with Image\n-     When I search for  My News\n-     Then the livesearch results should contain  My News with Image\n-      and expected livesearch results  1\n-      and Page should contain image  css=.livesearch-results li.search-result .col.img img\n+      and a news item    My News with Image\n+     When I search for    My News\n+     Then the livesearch results should contain    My News with Image\n+      and expected livesearch results    1\n+      and Get Element Count    //*[contains(@class,"livesearch-results")]//li[contains(@class,"search-result")]//*[contains(@class,"col") and contains(@class,"img")]//img    greater than    0\n \n      When I disable images in results in search controlpanel\n       and I search for  My News\n-     Then Page should not contain image  css=.livesearch-results li.search-result .col.img img\n+     and Get Element Count    //*[contains(@class,"livesearch-results")]//li[contains(@class,"search-result")]//*[contains(@class,"col") and contains(@class,"img")]//img    should be    0\n \n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n a document\n-    [Arguments]  ${title}\n-    Create content  type=Document  id=doc  title=${title}\n+    [Arguments]    ${title}\n+    Create content\n+    ...    type=Document\n+    ...    id=doc\n+    ...    title=${title}\n \n a news item\n-    [Arguments]  ${title}\n-    Go to  ${PLONE_URL}/++add++News Item\n-    Wait until page contains  Add News Item\n-    Input text  name=form.widgets.IDublinCore.title  ${title}\n-    Choose File  name=form.widgets.ILeadImageBehavior.image  ${PATH_TO_TEST_FILES}/plone-logo.png\n-    Click Button  Save\n-    Wait until page contains  Item created  error=Image could not be created.\n+    [Arguments]    ${title}\n+    Go to    ${PLONE_URL}/++add++News Item\n+    Type text    //input[@name="form.widgets.IDublinCore.title"]    ${title}\n+    Upload File By Selector    //input[@name="form.widgets.ILeadImageBehavior.image"]    ${PATH_TO_TEST_FILES}/pixel.png\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Item created    message=Image could not be created.\n \n I search for\n-    [Arguments]  ${searchtext}\n-    Input text  css=input#searchGadget  ${searchtext}\n-    Wait For Element  css=input#searchGadget\n+    [Arguments]    ${searchtext}\n+    Type Text    //input[@id="searchGadget"]    ${searchtext}\n \n I search the currentfolder only for\n-    [Arguments]  ${searchtext}\n-    Select checkbox  id=searchbox_currentfolder_only\n-    Input text  css=input#searchGadget  ${searchtext}\n-    Wait For Element  css=input#searchGadget\n+    [Arguments]    ${searchtext}\n+    Check Checkbox    //*[@id="searchbox_currentfolder_only"]\n+    Type Text    //input[@id="searchGadget"]    ${searchtext}\n \n the livesearch results should contain\n-    [Arguments]  ${text}\n-    Wait until keyword succeeds  5s  1s  Element should contain  css=.livesearch-results li a .heading  ${text}\n+    [Arguments]    ${text}\n+    Get Element States    //ul[contains(@class,"livesearch-results")]    contains    visible\n+    Get Text    //ul[contains(@class,"livesearch-results")]    contains    ${text}\n \n the livesearch results should not contain\n-    [Arguments]  ${text}\n-    Wait until keyword succeeds  5s  1s  Page should not contain  css=.livesearch-results li a .heading  ${text}\n+    [Arguments]    ${text}\n+    Get Element States    //ul[contains(@class,"livesearch-results")]    contains    visible\n+    Get Text    //ul[contains(@class,"livesearch-results")]    not contains    ${text}\n \n expected livesearch results\n-    [Arguments]  ${num}\n-    ${count} =  Get Element Count  css=.livesearch-results li.search-result\n-    Should Be Equal as Numbers  ${count}  ${num}\n+    [Arguments]    ${num}\n+    Get Element Count    //*[contains(@class,"livesearch-results")]//li[contains(@class,"search-result")]    should be    ${num}\n+\n \n I disable images in results in search controlpanel\n-    Go to  ${PLONE_URL}/@@search-controlpanel\n-    Wait until page contains  Search Settings\n-    Unselect Checkbox  form.widgets.search_show_images:list\n-    Click Button  Save\n-    Wait until page contains  Changes saved\n+    Go to    ${PLONE_URL}/@@search-controlpanel\n+    Uncheck Checkbox    //input[@name="form.widgets.search_show_images:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/34663e8222a3272f1f5ab44859dab81d754a5005

add new keyword "a logged-in member"

Files changed:
M Products/CMFPlone/tests/robot/keywords.robot

b'diff --git a/Products/CMFPlone/tests/robot/keywords.robot b/Products/CMFPlone/tests/robot/keywords.robot\nindex 71d2dfec69..fc83e57593 100644\n--- a/Products/CMFPlone/tests/robot/keywords.robot\n+++ b/Products/CMFPlone/tests/robot/keywords.robot\n@@ -13,6 +13,10 @@ a logged-in manager\n     Enable autologin as\n     ...    Manager\n \n+a logged-in member\n+    Enable autologin as\n+    ...    Member\n+\n a logged-in site administrator\n     Enable autologin as\n     ...    Site Administrator\n@@ -87,3 +91,8 @@ Fill text to tinymce editor\n     ...    all_elements=False\n \n     Should not be empty    ${check}\n+\n+\n+Pause\n+   Import library    Dialogs\n+   Pause execution\n\\ No newline at end of file\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/f590f3d926670fd97c333baeb7529382bc2b3d40

refactoring overlays robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_overlays.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_overlays.robot b/Products/CMFPlone/tests/robot/test_overlays.robot\nindex b8fca6d3d9..4647d3f89c 100644\n--- a/Products/CMFPlone/tests/robot/test_overlays.robot\n+++ b/Products/CMFPlone/tests/robot/test_overlays.robot\n@@ -1,22 +1,18 @@\n *** Settings ***\n \n-Documentation  These tests are just testing the overlay behavior not the\n-...            functionality of each form. This is supposed to be tested in\n-...            functional tests somewhere. At some point in the future the\n-...            functional tests can be transferred to robot tests into each\n-...            scenario test case.\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Variables    variables.py\n \n-Resource  common.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run Keywords  Plone test setup\n-Test Teardown  Run keywords  Plone test teardown\n+*** Variables ***\n \n+${TEST_FOLDER}  test-folder\n \n *** Test cases ***\n \n@@ -25,78 +21,65 @@ Scenario: Contact form overlay opens\n      When I click the \'Contact\' link\n      Then overlay should open\n \n+\n Scenario: Contact form overlay closes\n-    Go to  ${PLONE_URL}/logout\n-    Given the \'Contact\' overlay\n+    Given the site root logged out\n+      and the \'Contact\' overlay\n      When I close the overlay\n      Then overlay should close\n \n Scenario: Log in form overlay opens\n-    Go to  ${PLONE_URL}/logout\n-    Given the site root\n+    Given the site root logged out\n+      and the site root\n      When I click the \'Log in\' link\n      Then overlay should open\n \n Scenario: Log in form overlay closes\n-    Go to  ${PLONE_URL}/logout\n-    Given the site root\n-    Given the \'Log in\' overlay\n+    Given the site root logged out\n+      and the site root\n+      and the \'Log in\' overlay\n      When I close the overlay\n      Then overlay should close\n \n Scenario: Log in form overlay remains on wrong credentials\n-    Go to  ${PLONE_URL}/logout\n-    Given the site root\n-    Given the \'Log in\' overlay\n+    Given the site root logged out\n+      and the site root\n+      and the \'Log in\' overlay\n      When I enter wrong credentials\n      Then overlay should remain open\n-      And login overlay shows an error\n+      and login overlay shows an error\n \n Scenario: Log in form overlay closes on valid credentials\n-    Go to  ${PLONE_URL}/logout\n-    Given the site root\n-    Given the \'Log in\' overlay\n+    Given the site root logged out\n+      and the site root\n+      and the \'Log in\' overlay\n      When I enter valid credentials\n      Then overlay should close\n \n Scenario: Set default content item of a folder overlay opens\n     Given a logged-in site administrator\n-      And a document \'doc\' in the test folder\n+      and a document \'doc\' in the test folder\n      When I set the default content view of the test folder\n      Then overlay should open\n \n-# XXX Next 2 tests are commented out. After hours of messing around,\n-# I still can not pinpoint why this is happening.\n-# The error originates from this change https://github.com/plone/mockup/commit/ccec87028bc22e082d6d9a95874d8a961f91b707\n-# which provides at least some error reporting(window.alert) to users when modals\n-# experience issues. We need this change in modals...\n-#\n-# However, in these 2 cases, it is triggering the window.alert\n-# and causing the tests to fail in certain cases.\n-# It ONLY happens when running automatically by the robot framework\n-# runner. If you try to use Import library  DebugLibrary and\n-# run the commands manually, of course it works fine. So yes,\n-# there is no way to really figure out this AFAIK.\n-# Also, of course, this doesn\'t happen in real user testing.\n-#\n-#Scenario: Change default content item of a folder overlay opens\n-#    Given a logged-in site administrator\n-#      And a document as the default view of the test folder\n-#     When I change the default content view of the test folder\n-#     Then overlay should open\n-\n-#Scenario: Change default content item of a folder overlay closes\n-#    Given a logged-in site administrator\n-#      And a document as the default view of the test folder\n-#     When I change the default content view of the test folder\n-#      And I \'Cancel\' the form\n-#     Then overlay should close\n-#     When I change the default content view of the test folder\n-#      And I \'Save\' the form\n-#     Then overlay should close\n-#     When I change the default content view of the test folder\n-#      And I close the overlay\n-#     Then overlay should close\n+Scenario: Change default content item of a folder overlay opens\n+   Given a logged-in site administrator\n+     and a document as the default view of the test folder\n+    When I change the default content view of the test folder\n+    Then overlay should open\n+\n+Scenario: Change default content item of a folder overlay closes\n+   Given a logged-in site administrator\n+     And a document as the default view of the test folder\n+    When I change the default content view of the test folder\n+     And I \'Cancel\' the form\n+    Then overlay should close\n+    When I change the default content view of the test folder\n+     And I \'Save\' the form\n+    Then overlay should close\n+    When I change the default content view of the test folder\n+     And I close the overlay\n+    Then overlay should close\n \n Scenario: Delete content action overlay opens\n     Given a logged-in site administrator\n@@ -132,7 +115,7 @@ Scenario: Rename content action overlay closes\n Scenario: Register user overlay opens\n     Given the mail setup configured\n       And the self registration enabled\n-      Go to  ${PLONE_URL}/logout\n+      and the site root logged out\n       And the site root\n      When I click the \'Register\' link\n      Then overlay should open\n@@ -140,7 +123,7 @@ Scenario: Register user overlay opens\n Scenario: Register user overlay closes\n     Given the mail setup configured\n       And the self registration enabled\n-      Go to  ${PLONE_URL}/logout\n+      and the site root logged out\n       And the site root\n       And the \'Register\' overlay\n      When I close the overlay\n@@ -149,24 +132,22 @@ Scenario: Register user overlay closes\n Scenario: Register user overlay remains on wrong data\n     Given the mail setup configured\n       And the self registration enabled\n-      Go to  ${PLONE_URL}/logout\n+      and the site root logged out\n       And the site root\n       And the \'Register\' overlay\n      When I send the register form\n      Then overlay should remain open\n       And overlay shows an error\n \n-# Note: For this one we need to fake the mail server, as it tries to send the\n-# mail right away. Or change the somehow confusing message that shows when this\n-# happens.\n-#Scenario: Register user overlay closes on valid data\n-#    Given the mail setup configured\n-#      And the self registration enabled\n-#      And the site root\n-#      And the \'Register\' overlay\n-#     When I enter valid register user data\n-#      And I send the register form\n-#     Then overlay should close\n+# Tests based on MockupMailServer, this should be a valid tests\n+Scenario: Register user overlay closes on valid data\n+   Given the mail setup configured\n+     And the self registration enabled\n+     And the site root\n+     And the \'Register\' overlay\n+    When I enter valid register user data\n+     And I send the register form\n+    Then overlay should close\n \n Scenario: New user overlay opens\n     Given a logged-in site administrator\n@@ -190,144 +171,137 @@ Scenario: New user overlay closes on valid data\n       And I send the register form\n      Then overlay should close\n \n-# There is no more history overlay\n-# Scenario: History overlay opens\n-#     Given a logged-in site administrator\n-#       And the test folder\n-#      When I click the \'Content Info\' link\n-#       And I click the \'History\' link\n-#      Then overlay should open\n-#\n-# Scenario: History overlay closes\n-#     Given a logged-in site administrator\n-#       And the test folder\n-#       When I click the \'Content Info\' link\n-#       And I click the \'History\' link\n-#      When I close the overlay\n-#      Then overlay should close\n-#\n+\n *** Keywords ***\n \n-Background\n-    Given a logged-in site administrator\n-      and a test folder\n-    Disable autologin\n-    Go to homepage\n+# GIVEN\n+the site root logged out\n+    Go to    ${PLONE_URL}/logout\n+\n+the site root\n+    Go to    ${PLONE_URL}\n+\n+\n+the \'${link_name}\' overlay\n+    Click    //a[descendant-or-self::*[contains(text(), "${link_name}")]]\n+    Get Element Count    //div[contains(@class,"modal-dialog")]    greater than    0\n+\n+\n+a document \'${title}\' in the test folder\n+    Go to    ${PLONE_URL}/${TEST_FOLDER}/++add++Document\n+    Type Text    //input[@id="form-widgets-IDublinCore-title"]    ${title}\n+    Click    //button[@name="form.buttons.save"]\n+\n+\n+a document as the default view of the test folder\n+    a document \'doc\' in the test folder\n+    Go to    ${PLONE_URL}/${TEST_FOLDER}\n+    Click    //li[@id=\'plone-contentmenu-display\']/a\n+    Click    //a[@id="contextSetDefaultPage"]\n+    Click    //input[@id="doc"]\n+    Click    //div[contains(@class,"modal-footer")]//button[@name="form.buttons.Save"]\n+    Get Text    //body//h1    contains    doc\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n \n the users and groups configlet\n-    Go to  ${PLONE_URL}/@@usergroup-userprefs\n-    Wait until page contains  User Search\n+    Go to    ${PLONE_URL}/@@usergroup-userprefs\n+    Get Text    //body    contains    User Search\n+\n+# WHEN\n \n I click the \'${link_name}\' link\n-    Wait until page contains  ${link_name}\n-    Element should be visible  xpath=//a[descendant-or-self::*[contains(text(), \'${link_name}\')]]\n-    Click Link  xpath=//a[descendant-or-self::*[contains(text(), \'${link_name}\')]]\n+    Get Element Count    //a[descendant-or-self::*[contains(text(), "${link_name}")]]    greater than    0\n+    Click    //a[descendant-or-self::*[contains(text(), "${link_name}")]]\n \n-the \'${link_name}\' overlay\n-    Wait until page contains  ${link_name}\n-    Click Link  xpath=//a[descendant-or-self::*[contains(text(), \'${link_name}\')]]\n-    Wait until keyword succeeds  30  1  Page should contain element  css=div.modal-dialog\n \n-overlay should open\n-    Wait until keyword succeeds  30  1  Element Should Be Visible  css=div.modal-dialog\n+I close the overlay\n+    Click    //div[contains(@class,"modal-header")]//button[contains(@class,"modal-close")]\n \n-overlay should remain open\n-    Wait until page contains element  css=div.modal-wrapper\n-    Wait until element is visible  css=div.modal-wrapper\n \n-I close the overlay\n-    Click Element  css=div.modal-header button.modal-close\n+I enter wrong credentials\n+    I enter credentials    wrong    user\n \n-overlay should close\n-    Wait until keyword succeeds  40  1  Page should not contain element  css=div.modal-dialog\n \n-login overlay shows an error\n-    Wait Until Page Contains  Error\n+I enter valid credentials\n+    I enter credentials    ${SITE_OWNER_NAME}    ${SITE_OWNER_PASSWORD}\n \n-overlay shows an error\n-    Wait Until Page Contains  There were errors\n \n-overlay requires to compile a field\n-    Wait Until Page Contains  Required input is missing\n+I set the default content view of the test folder\n+    Go to    ${PLONE_URL}/${TEST_FOLDER}\n+    Click    //li[@id=\'plone-contentmenu-display\']/a\n+    Click    //a[@id="contextSetDefaultPage"]\n+\n+\n+I change the default content view of the test folder\n+    Go to    ${PLONE_URL}/${TEST_FOLDER}\n+    Click    //li[@id=\'plone-contentmenu-display\']/a\n+    Click    //a[@id="folderChangeDefaultPage"]\n+\n \n I \'${action}\' the form\n-    Wait until keyword succeeds  30  1  Element Should Be Visible  css=div.modal-footer button[name="form.buttons.${action}"]\n-    Click Element  css=div.modal-footer button[name="form.buttons.${action}"]\n+    Click    //div[contains(@class,"modal-footer")]//button[@name="form.buttons.${action}"]\n \n-I enter wrong credentials\n-    Input text  __ac_name  wrong\n-    Input text  __ac_password  user\n-    Wait For Then Click Element  css=div.modal-footer button\n \n-I enter valid credentials\n-    Wait until page contains element  name=__ac_name\n-    Input text for sure  __ac_name  ${SITE_OWNER_NAME}\n-    Input text for sure  __ac_password  ${SITE_OWNER_PASSWORD}\n-    Wait For Then Click Element  css=div.modal-footer button\n+I trigger the \'${action}\' action menu item of the test folder\n+    Go to    ${PLONE_URL}/${TEST_FOLDER}\n+    Click    //li[@id="plone-contentmenu-actions"]/a\n+    Click    //a[@id="plone-contentmenu-actions-${action}"]\n \n-I enter valid user data\n-    Wait until page contains element  name=form.widgets.password_ctl\n-    Input text for sure  form.widgets.username       myuser\n-    Input text for sure  form.widgets.email          my@email.eu\n-    Input text for sure  form.widgets.password       newpassword\n-    Input text for sure  form.widgets.password_ctl   newpassword\n \n-I enter valid register user data\n-    Wait until page contains element  name=form.widgets.username\n-    Input text  form.widgets.username       myuser\n-    Input text  form.widgets.email          my@email.eu\n+I confirm deletion of the content\n+    Click    //div[contains(@class,"modal-footer")]//button[@name="form.buttons.Delete"]\n+\n \n I send the register form\n-    Wait until page contains element  css=div.modal-footer #form-buttons-register\n-    Click Element  css=div.modal-footer #form-buttons-register\n+    Click    //div[contains(@class,"modal-footer")]//button[@name="form.buttons.register"]\n+\n+\n+I enter valid register user data\n+    Type Text    //input[@name="form.widgets.username"]    myuser\n+    Type Text    //input[@name="form.widgets.email"]    myuser@plone.org\n+\n \n I trigger the add a new user action\n-    Click Element  id=add-user\n+    Click    //a[@id="add-user"]\n \n-a document \'${title}\' in the test folder\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}/++add++Document\n-    Wait For Condition  return window.jQuery(\'.autotoc-nav .active:visible\').length > 0\n-    Execute Javascript  $(\'#form-widgets-IDublinCore-title\').val(\'${title}\'); return 0;\n-    Click Button  Save\n \n-I set the default content view of the test folder\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}\n-    Given patterns are loaded\n-    Click link  xpath=//li[@id=\'plone-contentmenu-display\']/a\n-    Click link  id=contextSetDefaultPage\n+I enter valid user data\n+    Type Text    //input[@name="form.widgets.username"]    myuser\n+    Type Text    //input[@name="form.widgets.email"]    myuser@plone.org\n+    Type Text    //input[@name="form.widgets.password"]    newpassword\n+    Type Text    //input[@name="form.widgets.password_ctl"]    newpassword\n \n-a document as the default view of the test folder\n-    a document \'doc\' in the test folder\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}\n-    Given patterns are loaded\n-    Click link  xpath=//li[@id=\'plone-contentmenu-display\']/a\n-    Wait until element is visible  id=contextSetDefaultPage\n-    Click link  id=contextSetDefaultPage\n-    Click element  id=doc\n-    Click element  css=div.modal-footer button[name="form.buttons.Save"]\n \n-I change the default content view of the test folder\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}\n-    Given patterns are loaded\n-    Click link  xpath=//li[@id=\'plone-contentmenu-display\']/a\n-    Wait until element is visible  id=folderChangeDefaultPage\n-    Click link  id=folderChangeDefaultPage\n \n-I trigger the \'${action}\' action menu item of the test folder\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}\n-    Given patterns are loaded\n-    Element should be visible  xpath=//li[@id=\'plone-contentmenu-actions\']/a\n-    Click link  xpath=//li[@id=\'plone-contentmenu-actions\']/a\n-    Wait until element is visible  id=plone-contentmenu-actions-${action}\n-    Click link  id=plone-contentmenu-actions-${action}\n-    Wait until page contains Element  css=div.modal-dialog\n+# THEN\n+\n+overlay should open\n+    Get Element States    //div[contains(@class,"modal-dialog")]    contains    visible\n+\n+\n+overlay should close\n+    Get Element Count    //div[contains(@class,"modal-dialog")]    should be    0\n+\n+\n+overlay should remain open\n+    Get Element States    //div[contains(@class,"modal-wrapper")]    contains    visible\n+\n+\n+login overlay shows an error\n+    Get Text    //div[contains(@class,"modal-wrapper")]    contains    Error\n+\n+\n+overlay shows an error\n+    Get Text    //div[contains(@class,"modal-wrapper")]    contains    There were errors\n+\n+\n+overlay requires to compile a field\n+    Get Text    //div[contains(@class,"modal-wrapper")]    contains    Required input is missing\n \n-I confirm deletion of the content\n-    # Note: The \'delete\' button has no standard z3c.form name attribute\n-    Wait until keyword succeeds  2  2  Click Element  css=div.modal-footer button#form-buttons-Delete\n \n-modals loaded\n-    Wait For Condition  return window.jQuery(\'.modal-wrapper\').size() > 0\n+# DRY\n+I enter credentials\n+    [Arguments]    ${username}    ${password}\n+    Type Text    //input[@name="__ac_name"]    ${username}\n+    Type Text    //input[@name="__ac_password"]    ${password}\n+    Click    //div[contains(@class,"modal-footer")]//button\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/3c5c8777320b671b7e51e4aa671339b370789956

refactoring portlets robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_portlets.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_portlets.robot b/Products/CMFPlone/tests/robot/test_portlets.robot\nindex 6167adc91b..5641220fab 100644\n--- a/Products/CMFPlone/tests/robot/test_portlets.robot\n+++ b/Products/CMFPlone/tests/robot/test_portlets.robot\n@@ -1,56 +1,89 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Variables    variables.py\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n \n-*** Test cases ***************************************************************\n+*** Test cases ***\n \n-Scenario: Add Login Portlet\n+Scenario: Add Login Portlet to left column\n     Given a logged-in site administrator\n       and a manage portlets view\n      When I add a \'Login\' portlet to the left column\n+      and I go to portal root\n      Then I should see a \'Login\' portlet in the left column\n \n+Scenario: Add Login Portlet to right column\n+    Given a logged-in site administrator\n+      and a manage portlets view\n+     When I add a \'Login\' portlet to the right column\n+      and I go to portal root\n+     Then I should see a \'Login\' portlet in the right column\n \n-*** Keywords *****************************************************************\n+Scenario: Delete Login Portlet from left column\n+    Given a logged-in site administrator\n+      and a manage portlets view\n+     When I add a \'Login\' portlet to the left column\n+      and I delete a \'Login\' portlet from the left column\n+      and I go to portal root\n+     Then I should not see a \'Login\' portlet in the left column\n+\n+Scenario: Delete Login Portlet from right column\n+    Given a logged-in site administrator\n+      and a manage portlets view\n+     When I add a \'Login\' portlet to the right column\n+      and I delete a \'Login\' portlet from the right column\n+      and I go to portal root\n+     Then I should not see a \'Login\' portlet in the right column\n+\n+# TODO: Move Portlets Up and Down\n+*** Keywords ***\n+\n+# Given\n \n a manage portlets view\n-    Go to   ${PLONE_URL}/@@manage-portlets\n-    Wait until page contains  Manage portlets\n+    Go to    ${PLONE_URL}/@@manage-portlets\n+    Get Text    //body    contains    Manage portlets\n+\n+# When\n \n I add a \'${portletname}\' portlet to the left column\n-    Select from list by label  xpath=//div[@id="portletmanager-plone-leftcolumn"]//select  ${portletname}\n+    Select Options By    //div[@id="portletmanager-plone-leftcolumn"]//select[contains(@class,"add-portlet")]    label    ${portletname}\n+    Get Text    //body    contains    Portlet added\n \n I add a \'${portletname}\' portlet to the right column\n-    Select from list by label  xpath=//div[@id="portletmanager-plone-rightcolumn"]//select  ${portletname}\n+    Select Options By    //div[@id="portletmanager-plone-rightcolumn"]//select[contains(@class,"add-portlet")]    label    ${portletname}\n+    Get Text    //body    contains    Portlet added\n+\n+I go to portal root\n+    Disable autologin\n+    Go to    ${PLONE_URL}\n+\n+I delete a \'${portlet}\' portlet from the left column\n+    Click    //*[@id="portletmanager-plone-leftcolumn"]/div[2]/div[2]/div[2]/form[3]/button\n+    Get Element Count    //*[@id="portletmanager-plone-leftcolumn"]//div[@class="portletAssignment"]    <=    1\n \n-I delete a \'${portlet}\'\' portlet from the left column\n-    Click Link  xpath=//div[@id="portal-column-one"]//div[@class="portletHeader" and contains(.,"${portlet}")]//a[@class="delete"]  don\'t wait\n-    Wait until keyword succeeds  1s  10s  Flex Element Should not exist  xpath=//div[@id="portal-column-one"]//div[@class="portletHeader" and contains(.,"${portlet}")]\n+I delete a \'${portlet}\' portlet from the right column\n+    Click    //*[@id="portletmanager-plone-rightcolumn"]/div[2]/div[2]/div[2]/form[3]/button\n+    Get Element Count    //*[@id="portletmanager-plone-rightcolumn"]//div[@class="portletAssignment"]    <=    1\n \n-when I delete the \'${portlet}\' portlet from the right column\n-    Click Link  xpath=//div[@id="portal-column-two"]//div[@class="portletHeader" and contains(.,"${portlet}")]//a[@class="delete"]  don\'t wait\n-    Wait until keyword succeeds  1s  10s  Flex Element Should not exist  xpath=//div[@id="portal-column-two"]//div[@class="portletHeader" and contains(.,"${portlet}")]\n \n+# Then\n I should see a \'${portletname}\' portlet in the left column\n-    Wait until page contains  ${portletname}\n-    Element should contain  portal-column-one  ${portletname}\n+    Get Element Count    //*[@id="portal-column-one"]//div[contains(@class,"portlet${portletname}")]    should be    1\n \n I should see a \'${portletname}\' portlet in the right column\n-    Wait until page contains  ${portletname}\n-    Element should contain  portal-column-two  ${portletname}\n+    Get Element Count    //*[@id="portal-column-two"]//div[contains(@class,"portlet${portletname}")]    should be    1\n \n-I should not see \'${text}\' in the left column\n-    Flex Element should not exist  xpath=//div[@id="portal-column-one" and contains(.,"${text}")]\n+I should not see a \'${text}\' portlet in the left column\n+    Get Element Count    //*[@id="portal-column-one"]//div[contains(@class,"portlet${text}")]    should be    0\n \n-I should not see \'${text}\' in the right column\n-    Flex Element should not exist  xpath=//div[@id="portal-column-two" and contains(.,"${text}")]\n+I should not see a \'${text}\' portlet in the right column\n+    Get Element Count    //*[@id="portal-column-two"]//div[contains(@class,"portlet${text}")]    should be    0\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/4d830f1f1e6c5bcdc67a938a49ab0bd3a3dedb58

ported `contentbrowser` tests

Files changed:
M Products/CMFPlone/tests/robot/test_contentbrowser.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_contentbrowser.robot b/Products/CMFPlone/tests/robot/test_contentbrowser.robot\nindex 577fbf2b32..2025e9af4f 100644\n--- a/Products/CMFPlone/tests/robot/test_contentbrowser.robot\n+++ b/Products/CMFPlone/tests/robot/test_contentbrowser.robot\n@@ -1,8 +1,6 @@\n *** Settings *****************************************************************\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource  plone/app/robotframework/browser.robot\n Resource  keywords.robot\n \n Library  Remote  ${PLONE_URL}/RobotRemote\n@@ -114,121 +112,112 @@ a document\n I select a related item image via contentbrowser\n    Go to  ${PLONE_URL}/${DOCUMENT_ID}/edit\n    # Click the Categorization Tab\n-   Wait For Then Click Element    //a[@id="autotoc-item-autotoc-2"]\n+   Click    //a[@id="autotoc-item-autotoc-2"]\n    # Click the select button\n-   Wait For Then Click Element    //div[@id="formfield-form-widgets-IRelatedItems-relatedItems"]//button\n+   Click    //div[@id="formfield-form-widgets-IRelatedItems-relatedItems"]//button\n    # Click third element in first column, that is the "Assets" folder\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[4]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[4]\n    # Click first element in second column, that is the "Mixed" folder\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[2]/div[contains(@class, "levelItems")]/div[1]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[2]/div[contains(@class, "levelItems")]/div[1]\n    # Click fifth element in third column, that is the "Files" folder\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[3]/div[contains(@class, "levelItems")]/div[5]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[3]/div[contains(@class, "levelItems")]/div[5]\n    # Click third element in fourth column, that is the "Images" folder\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[4]/div[contains(@class, "levelItems")]/div[3]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[4]/div[contains(@class, "levelItems")]/div[3]\n    # Click second element in fifth column, that is the "Image2" Object\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[5]/div[contains(@class, "levelItems")]/div[2]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[5]/div[contains(@class, "levelItems")]/div[2]\n    # Click the select Button in the Toolbar of column 6\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[6]/div[contains(@class, "levelToolbar")]/button\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[6]/div[contains(@class, "levelToolbar")]/button\n \n \n I select two related item images via contentbrowser\n    Go to  ${PLONE_URL}/${DOCUMENT_ID}/edit\n    # Click the Categorization Tab\n-   Wait For Then Click Element    //a[@id="autotoc-item-autotoc-2"]\n+   Click    //a[@id="autotoc-item-autotoc-2"]\n    # Click the select button\n-   Wait For Then Click Element    //div[@id="formfield-form-widgets-IRelatedItems-relatedItems"]//button\n+   Click    //div[@id="formfield-form-widgets-IRelatedItems-relatedItems"]//button\n    # Click third element in first column, that is the "Assets" folder\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[4]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[4]\n    # Click first element in second column, that is the "Mixed" folder\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[2]/div[contains(@class, "levelItems")]/div[1]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[2]/div[contains(@class, "levelItems")]/div[1]\n    # Click fifth element in third column, that is the "Files" folder\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[3]/div[contains(@class, "levelItems")]/div[5]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[3]/div[contains(@class, "levelItems")]/div[5]\n    # Click third element in fourth column, that is the "Images" folder\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[4]/div[contains(@class, "levelItems")]/div[3]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[4]/div[contains(@class, "levelItems")]/div[3]\n \n    # now we select two items in a colum via Shift+Click\n    # Click first element in fifth column, that is the "Image1" Object\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[5]/div[contains(@class, "levelItems")]/div[1]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[5]/div[contains(@class, "levelItems")]/div[1]\n    # Click second element in fifth column with SHIFT, that is the "Image2" Object\n-   Wait For Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[5]/div[contains(@class, "levelItems")]/div[2]\n-   Click Element        //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[5]/div[contains(@class, "levelItems")]/div[2]    SHIFT\n+   Click With Options    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[5]/div[contains(@class, "levelItems")]/div[2]    left    Shift\n    # Click the select Button in the Toolbar of column 6\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[6]/div[contains(@class, "levelToolbar")]/button\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[6]/div[contains(@class, "levelToolbar")]/button\n \n \n I set an internal link via contentbrowser\n     Go to  ${PLONE_URL}/${DOCUMENT_ID}/edit\n-    Fill text to tinymce editor    Susi Sorglos and John Doe\n-    Execute Javascript    function selectText() {\n-    ...    var iframe_document = document.querySelector(".tox-edit-area iframe").contentDocument;\n-    ...    var body = iframe_document.body;\n-    ...    var p = body.firstChild;\n-    ...    var range = new Range();\n-    ...    range.setStart(p.firstChild, 5);\n-    ...    range.setEnd(p.firstChild, 12);\n-    ...    iframe_document.getSelection().removeAllRanges();\n-    ...    iframe_document.getSelection().addRange(range);\n-    ...    }; selectText();\n-    Click Button    //button[@aria-label=\'Insert/edit link\']\n-    Wait For Then Click Element  css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <p>Susi Sorglos and John Doe</p>\n+    Evaluate JavaScript   //div[contains(@class, \'tox-edit-area\')]//iframe\n+    ...    (elem, args) => {\n+    ...        const iframe_document = elem.contentDocument;\n+    ...        const body = iframe_document.body;\n+    ...        const p = body.firstChild;\n+    ...        const range = new Range();\n+    ...        range.setStart(p.firstChild, 5);\n+    ...        range.setEnd(p.firstChild, 12);\n+    ...        iframe_document.getSelection().removeAllRanges();\n+    ...        iframe_document.getSelection().addRange(range);\n+    ...    }\n+    ...    all_elements=False\n+    Click    //button[@aria-label=\'Insert/edit link\']\n+    Click    css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n     Click item in column    1    3\n-    Wait For Then Click Element  //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n-    Wait Until Element Is Not Visible    //div[contains(@class,"content-browser-position-wrapper")]\n-    Wait For Then Click Element    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n-    Wait Until Element Is Not Visible  css=.modal-footer input[name="insert"]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n+    Click    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n \n I set an image via contentbrowser\n     Go to  ${PLONE_URL}/${DOCUMENT_ID}/edit\n-    Fill text to tinymce editor    Susi Sorglos and John Doe\n-    Click Button    //button[@aria-label=\'Insert/edit image\']\n-    Wait For Then Click Element  css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <p>Susi Sorglos and John Doe</p>\n+    Click    //button[@aria-label=\'Insert/edit image\']\n+    Click    css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n     Click item in column    1    3\n     Click item in column    2    1\n     Click item in column    3    1\n-    Wait For Then Click Element  //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n-    Wait Until Element Is Not Visible    //div[contains(@class,"content-browser-position-wrapper")]\n-    Wait For Then Click Element    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n-    Wait Until Element Is Not Visible  css=.modal-footer input[name="insert"]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n+    Click    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n \n I upload an image via contentbrowser\n     Go to  ${PLONE_URL}/${DOCUMENT_ID}/edit\n-    Fill text to tinymce editor    Susi Sorglos and John Doe\n-    Click Button  //button[@aria-label="Insert/edit image"]\n-    Wait For Then Click Element  css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <p>Susi Sorglos and John Doe</p>\n+    Click    //button[@aria-label="Insert/edit image"]\n+    Click    css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n     Click item in column    1    3\n     Click item in column    2    1\n-    Wait For Then Click Element  //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "toolBar")]/button[contains(@class,"upload")]\n-    Choose File    //div[contains(@class,"pat-upload")]//input[@class="dz-hidden-input"]    ${PATH_TO_TEST_FILES}/plone-logo.png\n-    Wait For Then Click Element  //div[contains(@class,"pat-upload")]//button[contains(@class,"upload-all")]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "toolBar")]//button[contains(@class,"upload")]\n+    Upload File By Selector    //div[contains(@class,"pat-upload")]//input[@class="dz-hidden-input"]    ${PATH_TO_TEST_FILES}/plone-logo.png\n+    Click    //div[contains(@class,"pat-upload")]//button[contains(@class,"upload-all")]\n     Click item in column    3    3\n-    Wait For Then Click Element  //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n-    Wait Until Element Is Not Visible    //div[contains(@class,"content-browser-position-wrapper")]\n-    Wait For Then Click Element    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n-    Wait Until Element Is Not Visible  css=.modal-footer input[name="insert"]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n+    Click    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n \n I search and select an image via contentbrowser\n     Go to  ${PLONE_URL}/${DOCUMENT_ID}/edit\n-    Fill text to tinymce editor    Susi Sorglos and John Doe\n-    Click Button  //button[@aria-label="Insert/edit image"]\n-    Wait For Then Click Element  css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <p>Susi Sorglos and John Doe</p>\n+    Click    //button[@aria-label="Insert/edit image"]\n+    Click    css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n     Click item in column    1    3\n     Click item in column    2    1\n     Click item in column    3    2\n     Click item in column    4    1\n-    Wait For Then Click Element  //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "toolBar")]//input[contains(@name,"filter")]\n-    Press Keys    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "toolBar")]//input[contains(@name,"filter")]    Anot\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "toolBar")]//input[contains(@name,"filter")]\n+    Type Text    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "toolBar")]//input[contains(@name,"filter")]    Anot\n     # here we need a timeout, because the search filter is not so fast like the testbrowser, it looks like a asynch operation\n-    ${speed}    Get Selenium Speed\n-    Set Selenium Speed    1 seconds\n+    Sleep    1\n     Click item in column    5    1\n-    Set Selenium Speed    ${speed}\n-    Wait For Then Click Element  //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n-    Wait Until Element Is Not Visible    //div[contains(@class,"content-browser-position-wrapper")]\n-    Wait For Then Click Element    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n-    Wait Until Element Is Not Visible  css=.modal-footer input[name="insert"]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n+    Click    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n \n I save the document\n-    Click Button    //button[@id="form-buttons-save"]\n+    Click    //button[@id="form-buttons-save"]\n \n \n \n@@ -257,13 +246,6 @@ the document contain the uploaded image\n \n #--- Helper DRY -------------------------------------------------------------\n \n-Fill text to tinymce editor\n-    [arguments]    ${text}\n-    Wait Until Element Is Visible    css=.tox-edit-area iframe\n-    Select Frame    css=.tox-edit-area iframe\n-    Input Text    //body[@id="tinymce"]    ${text}\n-    UnSelect Frame\n-\n image is releated item\n     [arguments]    ${xpath}    ${imagepath}\n     Element exists    ${xpath}    src    ${imagepath}\n@@ -274,11 +256,8 @@ rendered textfield contain the image with title\n \n Element exists\n     [arguments]  ${xpath}    ${attr}    ${value}\n-    ${element}=    Set Variable    ${xpath}\n-    Element Should Be Visible    ${element}\n-    ${_attr}=  Get Element Attribute    ${element}    ${attr}\n-    Should End With    ${_attr}    ${value}\n+    Wait for condition    Attribute    ${xpath}    ${attr}    should end with    ${value}\n \n Click item in column\n     [arguments]  ${colnumber}    ${itemposition}\n-    Wait For Then Click Element  //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[${colnumber}]/div[contains(@class, "levelItems")]/div[${itemposition}]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[${colnumber}]/div[contains(@class, "levelItems")]/div[${itemposition}]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T09:54:27+02:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/4a2982332e0491a678f74ca780227c8328365216

ported tinymce robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_tinymce.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_tinymce.robot b/Products/CMFPlone/tests/robot/test_tinymce.robot\nindex 69eb813598..5a126857d6 100644\n--- a/Products/CMFPlone/tests/robot/test_tinymce.robot\n+++ b/Products/CMFPlone/tests/robot/test_tinymce.robot\n@@ -1,8 +1,6 @@\n *** Settings *****************************************************************\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource  plone/app/robotframework/browser.robot\n \n Library  Remote  ${PLONE_URL}/RobotRemote\n \n@@ -28,8 +26,8 @@ Scenario: A page is opened to edit in TinyMCE\n       and insert link\n       and insert image\n \n-    Wait For Then Click Element  css=#form-buttons-save\n-    Wait until page contains  Changes saved\n+    Click    //*[@id="form-buttons-save"]\n+    Get Text    //body    contains    Changes saved\n \n \n *** Keywords *****************************************************************\n@@ -39,47 +37,38 @@ Scenario: A page is opened to edit in TinyMCE\n an edited page\n     Create content  type=Document  title=${TITLE}\n     Go to  ${PLONE_URL}/${PAGE_ID}/edit\n-    Wait until page contains  Edit Page\n+    Get Text    //body    contains    Edit Page\n \n an uploaded image\n     Create content  type=Image  title=an-image\n \n text inserted into wysiwyg\n-    Wait Until Element Is Visible  css=.tox-edit-area iframe\n-    Select Frame  css=.tox-edit-area iframe\n-    Press Keys    //body[@id="tinymce"]    Susi Sorglos and John Doe\n-    UnSelect Frame\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <p>Susi Sorglos and John Doe</p>\n \n insert link\n-    Execute Javascript    function selectText() {\n-    ...    var iframe_document = document.querySelector(".tox-edit-area iframe").contentDocument;\n-    ...    var body = iframe_document.body;\n-    ...    var p = body.firstChild;\n-    ...    var range = new Range();\n-    ...    range.setStart(p.firstChild, 5);\n-    ...    range.setEnd(p.firstChild, 12);\n-    ...    iframe_document.getSelection().removeAllRanges();\n-    ...    iframe_document.getSelection().addRange(range);\n-    ...    }; selectText();\n-    Click Button  css=button[aria-label="Insert/edit link"]\n-    Wait For Then Click Element  css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n-    Wait For Then Click Element  xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[3]\n-    Wait For Then Click Element  xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n-    Wait Until Element Is Not Visible    xpath=//div[contains(@class,"content-browser-position-wrapper")]\n-    Wait For Then Click Element  css=.modal-footer input[name="insert"]\n-    Select Frame  css=.tox-edit-area iframe\n-    Execute Javascript  window.getSelection().removeAllRanges()\n-    UnSelect Frame\n-    Wait Until Element Is Not Visible  css=.modal-footer input[name="insert"]\n+    Evaluate JavaScript   //div[contains(@class, \'tox-edit-area\')]//iframe\n+    ...    (elem, args) => {\n+    ...        const iframe_document = elem.contentDocument;\n+    ...        const body = iframe_document.body;\n+    ...        const p = body.firstChild;\n+    ...        const range = new Range();\n+    ...        range.setStart(p.firstChild, 5);\n+    ...        range.setEnd(p.firstChild, 12);\n+    ...        iframe_document.getSelection().removeAllRanges();\n+    ...        iframe_document.getSelection().addRange(range);\n+    ...    }\n+    ...    all_elements=False\n+    Click    //button[@aria-label=\'Insert/edit link\']\n+    Click    css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n+    Click    xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[3]\n+    Click    xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n+    Click    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n \n insert image\n-    Click Button  css=button[aria-label="Insert/edit image"]\n-    Wait For Then Click Element  css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n-    Wait For Then Click Element  xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[3]\n-    Capture Page Screenshot\n-    Wait For Then Click Element  xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n-    Wait Until Element Is Not Visible    xpath=//div[contains(@class,"content-browser-position-wrapper")]\n-    Input Text  css=.modal-body [name="title"]  SomeTitle\n-    Input Text  css=.modal-body [name="alt"]  SomeAlt\n-    Click Button  css=.modal-footer input[name="insert"]\n-    Wait Until Element Is Not Visible  css=.modal-footer input[name="insert"]\n\\ No newline at end of file\n+    Click    //button[@aria-label="Insert/edit image"]\n+    Click    css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n+    Click    xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[3]\n+    Click    xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n+    Type Text    //div[contains(@class, \'modal-body\')]//input[@name="title"]    SomeTitle\n+    Type Text    //div[contains(@class, \'modal-body\')]//input[@name="alt"]    SomeAlt\n+    Click    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T10:56:34+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/1e9e137e77f58dee84589a87a1b2b37be7de7d10

refactoring querystring robot tests

Files changed:
M Products/CMFPlone/tests/robot/test_querystring.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_querystring.robot b/Products/CMFPlone/tests/robot/test_querystring.robot\nindex 5a5e66fbf7..ae0a1a3bf4 100644\n--- a/Products/CMFPlone/tests/robot/test_querystring.robot\n+++ b/Products/CMFPlone/tests/robot/test_querystring.robot\n@@ -1,246 +1,346 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Variables    variables.py\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-*** Test Cases **************************************************************\n+\n+*** Test Cases ***\n \n Scenario: Location query Current\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I activate the operator Current in the criteria Location\n-    Then we expect 1 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I activate the operator Current in the criteria Location\n+     Then we expect 1 hits\n \n Scenario: Location query Parent\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I activate the operator Parent in the criteria Location\n-    Then we expect 3 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I activate the operator Parent in the criteria Location\n+     Then we expect 3 hits\n \n Scenario: Location query Custom\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I activate the operator Custom in the criteria Location\n-    and I search in B subfolder in the related items widget\n-    Then we expect 5 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I activate the operator Custom in the criteria Location\n+      and I search in B subfolder in the related items widget\n+     Then we expect 5 hits\n \n Scenario: Location query Advanced\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I activate the operator Advanced in the criteria Location\n-    Then I expect to be in Advanced mode\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I activate the operator Advanced in the criteria Location\n+     Then I expect to be in Advanced mode\n \n Scenario: Location query Simple\n+    # this fails simple is not available, first select \'Advanced Mode\' then you can select \'Simple Mode\'\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I activate the operator Simple in the criteria Location\n-    Then I expect to be in Simple mode\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I activate the operator Advanced in the criteria Location\n+      and I open the select box titled operator\n+      and I select index Simple\n+     Then I expect to be in Simple mode\n \n Scenario: Title query\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I open the criteria Title\n-    and I search for A\n-    Then we expect 1 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I open the criteria Title\n+      and I search for A\n+     Then we expect 1 hits\n \n Scenario: Description query\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I open the criteria Description\n-    and I search for a\n-    Then we expect 1 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I open the criteria Description\n+      and I search for a\n+     Then we expect 1 hits\n \n Scenario: Searchable text query\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I open the criteria Searchable text\n-    and I search for a\n-    and Sleep  0.2\n-    and Wait For Then Click Element  css=div.querystring-preview\n-    Then we expect 2 hits\n-    When I open the criteria Searchable text\n-    and I search for d\n-    Then we expect 1 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I open the criteria Searchable text\n+      and I search for a\n+      and Sleep  0.2\n+     Then we expect 2 hits\n+\n+     When I open the criteria Searchable text\n+      and I search for d\n+     Then we expect 1 hits\n \n Scenario: Tag query one\n+\n+    ${base_option_selector}=    Set Variable    select2-results-dept-0 select2-result select2-result-selectable select2-option\n+    ${base_option_selector_o}=    Set Variable    ${base_option_selector}-o\n+    ${base_option_selector_n}=    Set Variable    ${base_option_selector}-n\n+    ${base_option_selector_p}=    Set Variable    ${base_option_selector}-p\n+    ${base_option_selector_e}=    Set Variable    ${base_option_selector}-e\n     # tests the "Matches any of" option\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I activate the default operator in the criteria Tag\n-    and I open the Selection Widget\n-    ${base_option_selector}  Set Variable  li.select2-results-dept-0.select2-result.select2-result-selectable.select2-option\n-    and Wait For Then Click Element  css=${base_option_selector}-o\n-    Then we expect 4 hits\n-    When I open the Selection Widget\n-    and Wait For Then Click Element  css=${base_option_selector}-n\n-    Then we expect 4 hits\n-    When I delete my selection\n-    and I open the Selection Widget\n-    and Wait For Then Click Element  css=${base_option_selector}-p\n-    Then we expect 1 hits\n-    When I open the Selection Widget\n-    and Wait For Then Click Element  css=${base_option_selector}-e\n-    Then we expect 2 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I activate the default operator in the criteria Tag\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"${base_option_selector_o}")]\n+     Then we expect 4 hits\n+\n+     When I open the Selection Widget\n+      and Click    //li[contains(@class,"${base_option_selector_n}")]\n+     Then we expect 4 hits\n+\n+     When I delete my selection\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"${base_option_selector_p}")]\n+     Then we expect 1 hits\n+\n+     When I open the Selection Widget\n+      and Click    //li[contains(@class,"${base_option_selector_e}")]\n+     Then we expect 2 hits\n \n Scenario Tag query two\n+    ${base_option_selector}=    Set Variable    select2-results-dept-0 select2-result select2-result-selectable select2-option\n+    ${base_option_selector_o}=    Set Variable    ${base_option_selector}-o\n+    ${base_option_selector_n}=    Set Variable    ${base_option_selector}-n\n+    ${base_option_selector_p}=    Set Variable    ${base_option_selector}-p\n+    ${base_option_selector_e}=    Set Variable    ${base_option_selector}-e\n     # tests the "Matches all of" option\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I expect an empty result after open the operator Matches all of in the criteria Tag\n-    and I open the Selection Widget\n-    ${base_option_selector}  Set Variable  li.select2-results-dept-0.select2-result.select2-result-selectable.select2-option\n-    and Wait For Then Click Element  css=${base_option_selector}-o\n-    Then we expect 4 hits\n-    When and I open the Selection Widget\n-    and Wait For Then Click Element  css=${base_option_selector}-n\n-    Then we expect 3 hits\n-    When I delete my selection\n-    and and I open the Selection Widget\n-    and Wait For Then Click Element  css=${base_option_selector}-p\n-    Then we expect 1 hits\n-    When and I open the Selection Widget\n-    and Wait For Then Click Element  css=${base_option_selector}-e\n-    Then we expect 1 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I expect an empty result after open the operator Matches all of in the criteria Tag\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"${base_option_selector_o}")]\n+     Then we expect 4 hits\n+\n+     When I open the Selection Widget\n+      and Click    //li[contains(@class,"${base_option_selector_n}")]\n+     Then we expect 3 hits\n+\n+     When I delete my selection\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"${base_option_selector_p}")]\n+     Then we expect 1 hits\n+\n+     When I open the Selection Widget\n+      and Click    //li[contains(@class,"${base_option_selector_e}")]\n+     Then we expect 1 hits\n \n \n Scenario Event end date query\n     Given a logged-in manager\n-    and a bunch of events\n-    and the querystring pattern\n+      and a bunch of events\n+      and the querystring pattern\n     # Before date\n-    When I activate the default operator in the criteria Event end date\n-    and Execute Javascript  $(\'.querystring-criteria-value input[type="date"]\').val(\'2018-07-01\')\n-    Then we do not expect any hits\n+     When I activate the default operator in the criteria Event end date\n+      and Evaluate Javascript    //div[contains(@class,"querystring-criteria-value")]//input[@type="date"]\n+ ...    (element) => {\n+ ...        # fire the event for the browser build-in date input field\n+ ...        element.value="2018-07-01";\n+ ...        element.dispatchEvent(new Event("change", { bubbles: true }));\n+ ...    }\n+ ...    all_elements=False\n+\n+     Then we do not expect any hits\n \n     # When Execute Javascript  $(\'.querystring-criteria-value input[type="date"]\').val(\'2018-07-06\')\n \n-    # !!! BUG in plone.app.robotframework?\n+    # !!! BUG in plone.app.robotframework ?\n     # File "~/.buildout/shared-eggs/plone.app.event-3.2.1-py3.6.egg/plone/app/event/recurrence.py", line 77, in occurrences\n     #     duration = event_end - event_start\n     # TypeError: can\'t subtract offset-naive and offset-aware datetimes\n \n-    # for some reason the timezone is not applied correctly here. this is\n-    # probably a problem with plone.app.robotframework.content creation mechanism.\n-    # actually we got 3 hits, but right would be:\n-    # Then we expect 2 hits\n-    # Between dates\n-    # When I activate the operator Between dates in the criteria Event end date\n-    # and Execute Javascript  $($(\'.querystring-criteria-value .pattern-pickadate-date-wrapper > input[type="text"]\')[0]).pickadate(\'picker\').set(\'select\', new Date(2018, 7, 1))\n-    # and Execute Javascript  $($(\'.querystring-criteria-value .pattern-pickadate-date-wrapper > input[type="text"]\')[1]).pickadate(\'picker\').set(\'select\', new Date(2018, 7, 7))\n-    # Then we expect 3 hits\n-    # When Execute Javascript  $($(\'.querystring-criteria-value .pattern-pickadate-date-wrapper > input[type="text"]\')[0]).pickadate(\'picker\').set(\'select\', new Date(2018, 7, 6))\n-    # and Execute Javascript  $($(\'.querystring-criteria-value .pattern-pickadate-date-wrapper > input[type="text"]\')[1]).pickadate(\'picker\').set(\'select\', new Date(2018, 7, 8))\n-    # Then we expect 2 hits\n+    #      When Evaluate Javascript    //div[contains(@class,"querystring-criteria-value")]//input[@type="date"]\n+    #  ...    (element) => {\n+    #  ...        # fire the event for the browser build-in date input field\n+    #  ...        element.value="2018-08-06";\n+    #  ...        element.dispatchEvent(new Event("change", { bubbles: true }));\n+    #  ...    }\n+    #  ...    all_elements=False\n+    #      Then we expect 2 hits\n+\n+    #     # Between dates\n+    #      When I activate the operator Between dates in the criteria Event end date\n+    #       and Evaluate Javascript    //div[contains(@class,"querystring-criteria-value")]//input[@type="date" and contains(@class,"querystring-criteria-value-DateRangeWidget-start")]\n+    #  ...    (element) => {\n+    #  ...        # fire the event for the browser build-in date input field\n+    #  ...        element.value="2018-08-01";\n+    #  ...        element.dispatchEvent(new Event("change", { bubbles: true }));\n+    #  ...    }\n+    #  ...    all_elements=False\n+    #       and Evaluate Javascript    //div[contains(@class,"querystring-criteria-value")]//input[@type="date" and contains(@class,"querystring-criteria-value-DateRangeWidget-end")]\n+    #  ...    (element) => {\n+    #  ...        # fire the event for the browser build-in date input field\n+    #  ...        element.value="2018-08-07";\n+    #  ...        element.dispatchEvent(new Event("change", { bubbles: true }));\n+    #  ...    }\n+    #  ...    all_elements=False\n+    #      Then we expect 3 hits\n+\n+    #     # Between dates\n+    #      When I activate the operator Between dates in the criteria Event end date\n+    #       and Evaluate Javascript    //div[contains(@class,"querystring-criteria-value")]//input[@type="date" and contains(@class,"querystring-criteria-value-DateRangeWidget-start")]\n+    #  ...    (element) => {\n+    #  ...        # fire the event for the browser build-in date input field\n+    #  ...        element.value="2018-08-06";\n+    #  ...        element.dispatchEvent(new Event("change", { bubbles: true }));\n+    #  ...    }\n+    #  ...    all_elements=False\n+    #       and Evaluate Javascript    //div[contains(@class,"querystring-criteria-value")]//input[@type="date" and contains(@class,"querystring-criteria-value-DateRangeWidget-end")]\n+    #  ...    (element) => {\n+    #  ...        # fire the event for the browser build-in date input field\n+    #  ...        element.value="2018-08-06";\n+    #  ...        element.dispatchEvent(new Event("change", { bubbles: true }));\n+    #  ...    }\n+    #  ...    all_elements=False\n+    #      Then we expect 2 hits\n+\n+\n \n Scenario Short name (id) query\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I open the criteria Short name (id)\n-    And I search for a\n-    Then Page Should Contain  A\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I open the criteria Short name (id)\n+      and I search for a\n+     Then I see A in Preview\n \n Scenario Review state query\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I open the criteria Review State\n-    and I open the Selection Widget\n-    and Wait For Then Click Element  css=li.select2-option-private\n-    Then we expect 7 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I open the criteria Review State\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"select2-option-private")]\n+     Then we expect 7 hits\n \n Scenario Type query\n     Given a logged-in site administrator\n-    and a bunch of events\n-    and the querystring pattern\n-    When I open the criteria Type\n-    and I open the Selection Widget\n-    and Wait For Then Click Element  css=li.select2-option-event\n-    Then we expect 4 hits\n-    When I delete one selection\n-    and I open the Selection Widget\n-    and Wait For Then Click Element  css=li.select2-option-file\n-    Then we do not expect any hits\n-    When I delete one selection\n-    and I open the Selection Widget\n-    and Wait For Then Click Element  css=li.select2-option-folder\n-    Then we expect 5 hits\n-    When I delete one selection\n-    and I open the Selection Widget\n-    and Wait For Then Click Element  css=li.select2-option-link\n-    Then we expect 1 hits\n-    When I delete one selection\n-    and I open the Selection Widget\n-    and Wait For Then Click Element  css=li.select2-option-document\n-    Then we expect 2 hits\n-    When I open the Selection Widget\n-    and Wait For Then Click Element  css=li.select2-option-link\n-    Then we expect 3 hits\n+      and a bunch of events\n+      and the querystring pattern\n+     When I open the criteria Type\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"select2-option-event")]\n+     Then we expect 4 hits\n+\n+     When I delete one selection\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"select2-option-file")]\n+     Then we do not expect any hits\n+\n+     When I delete one selection\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"select2-option-folder")]\n+     Then we expect 5 hits\n+\n+     When I delete one selection\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"select2-option-link")]\n+     Then we expect 1 hits\n+\n+     When I delete one selection\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"select2-option-document")]\n+     Then we expect 2 hits\n+\n+     When I open the Selection Widget\n+      and Click    //li[contains(@class,"select2-option-link")]\n+     Then we expect 3 hits\n \n Scenario Creator query\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I activate the default operator in the criteria Creator\n-    Then we expect 6 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I activate the default operator in the criteria Creator\n+     Then we expect 6 hits\n \n \n-*** Keywords ****************************************************************\n+*** Keywords ***\n \n-save\n-    Click Link  css=input#form-buttons-save\n-\n-the querystring pattern\n-    #We go the /a to give more useful query results\n-    Go to  ${PLONE_URL}/a/++add++Collection\n-    Wait until page contains element  css=.pat-querystring\n-    Given querystring pattern loaded\n-    # Set a title, otherwise you see \'Please fill out this field\'\n-    Execute Javascript  $(\'#form-widgets-IDublinCore-title\').val(\'A Collection\'); return 0;\n-    # for some unknown reason unload protection pops up, but only in robot tests\n-    Execute Javascript  $(window).unbind(\'beforeunload\')\n-\n-querystring pattern loaded\n-    Wait For Condition  return !!document.querySelector(\'.querystring-criteria-remove\')\n+# GIVEN\n \n a bunch of folders\n     #We create enough items to give meaningful test results\n-    ${F1}=  Create content  type=Folder  title=A  description=a  subject=onep\n-    ${F2}=  Create content  type=Folder  title=B  description=b  subject=one  container=${F1}\n-    ${F3}=  Create content  type=Folder  title=C  description=and  subject=on  container=${F2}\n-    Create content  type=Document  title=D  subject=o  container=${F3}\n-    Create content  type=Document  title=E  container=${F3}\n-    Create content  type=Link  title=Link  remoteUrl=/front-page  container=${F3}\n+    ${F1}=    Create content\n+    ...    type=Folder\n+    ...    title=A\n+    ...    description=a\n+    ...    subject=onep\n+    ${F2}=    Create content\n+    ...    type=Folder\n+    ...    title=B\n+    ...    description=b\n+    ...    subject=one\n+    ...    container=${F1}\n+    ${F3}=    Create content\n+    ...    type=Folder\n+    ...    title=C\n+    ...    description=and\n+    ...    subject=on\n+    ...    container=${F2}\n+    Create content\n+    ...    type=Document\n+    ...    title=D\n+    ...    subject=o\n+    ...    container=${F3}\n+    Create content\n+    ...    type=Document\n+    ...    title=E\n+    ...    container=${F3}\n+    Create content\n+    ...    type=Link\n+    ...    title=Link\n+    ...    remoteUrl=/front-page\n+    ...    container=${F3}\n     [Return]  ${F1}\n \n+\n a bunch of events\n     ${F1}=  a bunch of folders\n-    Create content  type=Event  title=Event1  start=2018-08-01T15:00  end=2018-08-01T17:00  container=${F1}\n-    Create content  type=Event  title=Event2  start=2018-08-05T16:00  end=2018-08-07T11:00  container=${F1}\n-    Create content  type=Event  title=Event3  start=2018-08-05T16:30  open_end-empty-marker=1  container=${F1}\n-    Create content  type=Event  title=Event4  start=2018-08-06  end=2018-08-06  whole_day-empty-marker=1  container=${F1}\n+    Create content\n+    ...    type=Event\n+    ...    title=Event1\n+    ...    start=2018-08-01T15:00\n+    ...    end=2018-08-01T17:00\n+    ...    container=${F1}\n+    Create content\n+    ...    type=Event\n+    ...    title=Event2\n+    ...    start=2018-08-05T16:00\n+    ...    end=2018-08-07T11:00\n+    ...    container=${F1}\n+    Create content\n+    ...    type=Event\n+    ...    title=Event3\n+    ...    start=2018-08-05T16:30\n+    ...    open_end-empty-marker=1\n+    ...    container=${F1}\n+    Create content\n+    ...    type=Event\n+    ...    title=Event4\n+    ...    start=2018-08-06\n+    ...    end=2018-08-06\n+    ...    whole_day-empty-marker=1\n+    ...    container=${F1}\n \n-I activate the default operator in the criteria ${CRITERIA}\n-    open the select box titled index\n-    select index type ${CRITERIA}\n+the querystring pattern\n+    #We go the /a to give more useful query results\n+    Go to    ${PLONE_URL}/a/++add++Collection\n+    Type Text    //input[@id="form-widgets-IDublinCore-title"]    A Collection\n+\n+# WHEN\n \n I activate the operator ${OPERATOR} in the criteria ${CRITERIA}\n     open the select box titled index\n@@ -249,98 +349,129 @@ I activate the operator ${OPERATOR} in the criteria ${CRITERIA}\n     open the select box titled operator\n     select index type ${OPERATOR}\n \n-I expect an empty result after open the operator ${OPERATOR} in the criteria ${CRITERIA}\n-    open the select box titled index\n-    select index type ${CRITERIA}\n-    Wait for condition  return $("dl.searchResults").length == 0\n+\n+I search in ${NAME} subfolder in the related items widget\n+    mark results\n+    Click    //div[@class="pat-relateditems-container"]//ul[@class="select2-choices"]\n+    # I have seen this fail sometimes, where the screen shot showed the NAME just fine.\n+    Sleep    0.1\n+    Click    //a[contains(concat(\' \', normalize-space(@class), \' \'), \' pat-relateditems-result-select \')]//span[contains(text(),\'${NAME}\')]\n+\n+\n+I open the select box titled operator\n     open the select box titled operator\n-    select index type ${OPERATOR}\n+\n+\n+I select index Simple\n+    select index type Simple\n+\n \n I open the criteria ${CRITERIA}\n     open the select box titled index\n     select index type ${CRITERIA}\n \n+\n I search for ${KEYWORD}\n-    ${keyword_selector}  Set Variable  input.querystring-criteria-value-StringWidget\n-    Wait For Then Click Element  css=${keyword_selector}\n-    Input Text  css=${keyword_selector}  ${KEYWORD}\n-    Click Element  css=div#content-core\n+    ${element}    Get Element    //input[contains(@class,"querystring-criteria-value-StringWidget")]\n+    Click    ${element}\n+    Type Text    ${element}    ${KEYWORD}\n+    Click    //div[@id="content-core"]\n+\n+\n+I activate the default operator in the criteria ${CRITERIA}\n+    open the select box titled index\n+    select index type ${CRITERIA}\n+\n \n I open the Selection Widget\n-    Wait For Then Click Element  css=div.select2-container-multi.querystring-criteria-value-MultipleSelectionWidget\n+    Click    //div[contains(@class,"select2-container-multi") and contains(@class,"querystring-criteria-value-MultipleSelectionWidget")]\n \n-I delete one selection\n-    #deletes one element\n-    Wait For Then Click Element  jquery=a.select2-search-choice-close:visible\n \n I delete my selection\n     #deletes two elements\n-    Wait For Then Click Element  jquery=a.select2-search-choice-close:visible:first\n+    Click    (//div[contains(@class,"querystring-criteria-value-MultipleSelectionWidget")]//a[contains(@class,"select2-search-choice-close")])[1]\n     Sleep  0.1\n-    Wait For Then Click Element  jquery=a.select2-search-choice-close:visible\n+    Click    //div[contains(@class,"querystring-criteria-value-MultipleSelectionWidget")]//a[contains(@class,"select2-search-choice-close")]\n \n-I search in ${NAME} subfolder in the related items widget\n-    mark results\n-    Wait For Then Click Element  jquery=.pat-relateditems-container ul.select2-choices:visible\n-    Wait Until Page Contains  ${NAME}\n-    # I have seen this fail sometimes, where the screen shot showed the NAME just fine.\n-    Sleep  0.1\n-    Click Element  //a[contains(concat(\' \', normalize-space(@class), \' \'), \' pat-relateditems-result-select \')]//span[contains(text(),\'${NAME}\')]\n \n-I expect to be in Advanced mode\n-    open the select box titled operator\n-    ${selector}  Set Variable  .select2-drop-active[style*="display: block;"]\n-    Element Should Contain  jquery=${selector}   Navigation Path\n-    Element Should Contain  jquery=${selector}   Absolute Path\n-    Element Should Contain  jquery=${selector}   Relative Path\n-    Element Should Contain  jquery=${selector}   Simple Mode\n-    ${selector}  Set Variable  div#select2-drop-mask\n-    Wait For Then Click Invisible Element  css=${selector}\n-    Wait Until Element Is Not Visible  css=${selector}\n+I delete one selection\n+    # :visible -  should this be checked?\n+    Click    //div[contains(@class,"querystring-criteria-value-MultipleSelectionWidget")]//a[contains(@class,"select2-search-choice-close")]\n \n-I expect to be in Simple mode\n+\n+I expect an empty result after open the operator ${OPERATOR} in the criteria ${CRITERIA}\n+    open the select box titled index\n+    select index type ${CRITERIA}\n+    Wait For Condition    Element Count    //dl[@class="searchResults"]    should be    0\n     open the select box titled operator\n-    ${selector}  Set Variable  .select2-drop-active[style*="display: block;"]\n-    Element Should Contain  jquery=${selector}   Custom\n-    Element Should Contain  jquery=${selector}   Parent (../)\n-    Element Should Contain  jquery=${selector}   Current (./)\n-    Element Should Contain  jquery=${selector}   Advanced Mode\n-    ${selector}  Set Variable  div#select2-drop-mask\n-    Wait For Then Click Invisible Element  css=${selector}\n-    Wait Until Element Is Not Visible  css=${selector}\n+    select index type ${OPERATOR}\n \n-open the select box titled ${NAME}\n-    Click Element  css=body\n-    Wait For Then Click Element  jquery=.querystring-criteria-${NAME} .select2-container:first\n \n-select index type ${INDEX}\n-    ${input_selector}  Set Variable  .select2-drop-active[style*="display: block;"] input\n-    Wait For Element  css=${input_selector}\n-    Input Text  css=${input_selector}   text=${INDEX}\n-    Press Keys  jquery=:focus  RETURN\n+# THEN\n \n we expect ${NUM} hits\n     #This assumes we have the 2 "Test document" and "Test folder" items from the\n     #robot setup, as well as the 4 additional items from the "a bunch of folders" macro\n     #works only for ${NUM} > 0\n-    Sleep  0.5s\n+    # we need as `Sleep`, the select2 js is very slow\n+    Sleep    0.5s\n     Wait until result is no longer marked\n-    ${hits}=  Execute Javascript  return $(\'.searchResults > dd\').length\n-    Should Be Equal As Integers  ${hits}  ${NUM}\n+    ${hits}=    Evaluate Javascript    //dl[@class="searchResults"]\n+ ...    (element) => {\n+ ...        return document.querySelectorAll(".searchResults > dd").length\n+ ...    }\n+ ...    all_elements=False\n+    Should Be Equal As Integers    ${hits}    ${NUM}\n     mark results\n \n we do not expect any hits\n     [Documentation]  The search results may be the previous results that are still visible for a short time, so sleep a bit.  Alternatively look at http://www.obeythetestinggoat.com/how-to-get-selenium-to-wait-for-page-load-after-a-click.html\n-    Sleep  0.2\n-    Wait Until Element Is Visible  css=div#search-results\n-    Wait Until Element Contains  css=div#search-results  No results were found.\n+    Sleep    0.2\n+    Get Text    //div[@id="search-results"]    contains    No results were found.\n+\n+I expect to be in Advanced mode\n+    open the select box titled operator\n+    ${element}=    Get Element    //div[contains(@class,"select2-drop-active") and contains(@style,"display: block;")]\n+    Get Text    ${element}    contains    Navigation Path\n+    Get Text    ${element}    contains    Absolute Path\n+    Get Text    ${element}    contains    Relative Path\n+    Get Text    ${element}    contains    Simple Mode\n+    Click    //div[@id="select2-drop-mask"]\n+    Get Element States    //div[@id="select2-drop-mask"]    contains    hidden\n+\n+I expect to be in Simple mode\n+    open the select box titled operator\n+    ${element}=    Get Element    //div[contains(@class,"select2-drop-active") and contains(@style,"display: block;")]\n+    Get Text    ${element}    contains    Custom\n+    Get Text    ${element}    contains    Parent (../)\n+    Get Text    ${element}    contains    Current (./)\n+    Get Text    ${element}    contains    Advanced Mode\n+    Click    //div[@id="select2-drop-mask"]\n+    Get Element States    //div[@id="select2-drop-mask"]    contains    hidden\n+\n+I see ${TEXT} in Preview\n+    Sleep    0.2\n+    Get Text    //div[@id="search-results"]    contains    ${TEXT}\n+# Helper\n+\n+open the select box titled ${NAME}\n+    Click    //body\n+    Click    (//div[@class="querystring-criteria-${NAME}"])[1]//div[contains(@class,"select2-container")]\n \n-a logged-in manager\n-    Enable autologin as  Manager  Site Administrator  Contributor  Reviewer\n+select index type ${INDEX}\n+    Type Text    //div[contains(@class,"select2-drop-active") and contains(@style, "display: block;")]//input    ${INDEX}\n+    Click    //*[contains(@class,"select2-match")]\n \n mark results\n-    Wait for condition  return $("dl.searchResults").length > 0\n-    Execute Javascript  $("dl.searchResults").attr("marker", "marked")\n+    Evaluate Javascript    //dl[@class="searchResults"]\n+ ...    (element) => {\n+ ...        element.setAttribute("marker", "marked")\n+ ...    }\n+ ...    all_elements=False\n \n wait until result is no longer marked\n-    Wait for condition  return $("dl.searchResults").length > 0 && $("dl.searchResults").attr("marker") != "marked"\n+    Evaluate Javascript    //dl[@class="searchResults"]\n+ ...    (element) => {\n+ ...        return element && element.getAttribute("marker") != "marked"\n+ ...    }\n+ ...    all_elements=False\n\\ No newline at end of file\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T12:56:12+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/cf2e8d5cfac24c072a5f43f2f272a60281568495

make folder_contents robot  test more robust

Files changed:
M Products/CMFPlone/tests/robot/test_folder_contents.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_folder_contents.robot b/Products/CMFPlone/tests/robot/test_folder_contents.robot\nindex 2cf3140cdf..b49619a551 100644\n--- a/Products/CMFPlone/tests/robot/test_folder_contents.robot\n+++ b/Products/CMFPlone/tests/robot/test_folder_contents.robot\n@@ -21,11 +21,6 @@ Scenario: Select All items\n       and the four elements got selected\n       and the clear selection link appears\n \n-Scenario: Clear selection\n-   Given a logged-in site administrator\n-     and a folder with four pages\n-     and the folder contents view\n-     And I select all the elements\n     When I clear the selection\n     Then no elements should be selected\n \n@@ -69,25 +64,34 @@ I click the \'${link_name}\' link\n     Click    //a[contains(text(),${link_name})]\n \n I select all the elements\n+    Wait For Condition    Classes    //body    contains    patterns-loaded\n     Check Checkbox    //*[contains(@class,"pat-structure")]//input[contains(@class,"select-all")]\n+    Sleep    5s\n \n the four elements got selected\n-    Get Checkbox State      //tr[@data-id="doc1"]//input    ==    checked\n-    Get Checkbox State      //tr[@data-id="doc2"]//input    ==    checked\n-    Get Checkbox State      //tr[@data-id="doc3"]//input    ==    checked\n-    Get Checkbox State      //tr[@data-id="doc4"]//input    ==    checked\n+    Get Checkbox State      //tr[@data-id="doc1"]//input    should be    True\n+    Get Checkbox State      //tr[@data-id="doc2"]//input    should be    True\n+    Get Checkbox State      //tr[@data-id="doc3"]//input    should be    True\n+    Get Checkbox State      //tr[@data-id="doc4"]//input    should be    True\n \n the selection count appears\n+    Wait For Condition    Checkbox State    //tr[@data-id="doc1"]//input    should be    True\n+    Wait For Condition    Checkbox State    //tr[@data-id="doc2"]//input    should be    True\n+    Wait For Condition    Checkbox State    //tr[@data-id="doc3"]//input    should be    True\n+    Wait For Condition    Checkbox State    //tr[@data-id="doc4"]//input    should be    True\n     Get Text    //*[@id="btn-selected-items"]//*[contains(@class,"label-success")]    should be    4\n \n the clear selection link appears\n     Get Element Count    //a[contains(@class,"remove-all")]    greater than    0\n \n I clear the selection\n+    Wait For Condition    Classes    //body    contains    patterns-loaded\n+    Sleep    2s\n+    Check Checkbox    //*[contains(@class,"pat-structure")]//input[contains(@class,"select-all")]\n     Click    //a[@id="btn-selected-items"]\n-    Wait For Condition    Element States    //*[@id="popover-selected-items"]    contains    visible\n     Click    //a[contains(@class,"remove-all")]\n \n+\n no elements should be selected\n     Get Checkbox State      //tr[@data-id="doc1"]//input    ==    unchecked\n     Get Checkbox State      //tr[@data-id="doc2"]//input    ==    unchecked\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T12:57:05+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/9278551b1caea7c0256044b9aa79bb2e90f5b74c

delete obsolete robodoc folder

Files changed:
D Products/CMFPlone/tests/robot/robodoc/README.rst
D Products/CMFPlone/tests/robot/robodoc/TODO.rst
D Products/CMFPlone/tests/robot/robodoc/anonymous.robot
D Products/CMFPlone/tests/robot/robodoc/collaboration-advanced_control.robot
D Products/CMFPlone/tests/robot/robodoc/collaboration.robot
D Products/CMFPlone/tests/robot/robodoc/common.robot
D Products/CMFPlone/tests/robot/robodoc/config-screens.robot
D Products/CMFPlone/tests/robot/robodoc/content.robot
D Products/CMFPlone/tests/robot/robodoc/managing-working_copy.robot
D Products/CMFPlone/tests/robot/robodoc/managing_content.robot
D Products/CMFPlone/tests/robot/robodoc/personalsettings.robot
D Products/CMFPlone/tests/robot/robodoc/working_with_tinymce.robot

b"diff --git a/Products/CMFPlone/tests/robot/robodoc/README.rst b/Products/CMFPlone/tests/robot/robodoc/README.rst\ndeleted file mode 100644\nindex d25585bf30..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/README.rst\n+++ /dev/null\n@@ -1,85 +0,0 @@\n-==============\n-ROBODOC README\n-==============\n-\n-The ``robodoc`` folder contains Robot Framework tests moved from the Plone documentation project.\n-Because they are designed to be run as test suite level stories (sandbox is cleared only when changing a robot file),\n-they are not integrated with zope.testrunner (``./bin/test``), but are designed to be run with Robot Framework test runner (``pybot``).\n-\n-\n-Installing Robot Framework\n-==========================\n-\n-Most tools needed to run the tests and generate the screenshots are available from within a standard Plone buildout.coredev environment.\n-The only extra piece of software needed is `webdriver` for your operating system and browser of choice, and that browser.\n-\n-Minimal buildout to generate a good enough Robot Framework test runner would look like the following:\n-\n-.. code:: ini\n-\n-   [buildout]\n-   extends = https://dist.plone.org/release/5-latest/versions.cfg\n-   parts = robot\n-\n-   [robot]\n-   recipe = zc.recipe.egg\n-   eggs =\n-       Plone\n-       Pillow\n-       robotframework-selenium2screenshots\n-       plone.app.robotframework [debug]\n-\n-\n-Running the tests\n-=================\n-\n-There are two possible ways to run the tests.\n-\n-The first option is to run them with a single command:\n-\n-.. code:: bash\n-\n-   $ bin/pybot -v BROWSER:phantomjs src/Products.CMFPlone/Products/CMFPlone/tests/robot/robodoc/collaboration-advanced_control.robot\n-\n-This command will 1) start up a Plone site, 2) run the defined test suite and 3) shut down the Plone site. It will take some time.\n-``-v BROWSER:phantomjs`` is optional, and will define a Robot Framework variable named ``BROWSER`` with value ``phantomjs``, effectively running the test suite using headless PhantomJS browser.\n-\n-You can run multiple test suites in the same directory,\n-\n-.. code:: bash\n-\n-   $ bin/pybot -v BROWSER:phantomjs src/Products.CMFPlone/Products/CMFPlone/tests/robot/robodoc\n-\n-will run all tests and generate all screenshots.\n-\n-The second option is to first start a robot server and only then, in parallel, to execute the desired test suite:\n-\n-.. code:: bash\n-\n-   $\xc2\xa0APPLY_PROFILES=plone.app.contenttypes:plone-content bin/robot-server plone.app.robotframework.PLONE_ROBOT_TESTING\n-\n-or\n-\n-.. code:: bash\n-\n-   $\xc2\xa0CONFIGURE_PACKAGES=plone.app.iterate APPLY_PROFILES=plone.app.contenttypes:plone-content,plone.app.iterate:default bin/robot-server plone.app.robotframework.PLONE_ROBOT_TESTING\n-\n-and\n-\n-   $ bin/pybot -v ROBOT_SERVER:True -v BROWSER:phantomjs src/Products.CMFPlone/Products/CMFPlone/tests/robot/robodoc/screenshot-tall/collaboration-advanced_control.robot\n-\n-This option will be faster for subsequent runs.\n-\n-Environment variable ``APPLY_PROFILES`` can be set to a comma separated list of Generic Setup profiles and is used by the very special test fixture ``PLONE_ROBOT_TESTING`` to prepare a Plone site with those profiles installed. There's also an another special variable ``CONFIGURE_PACKAGES`` that can be set to a comma separated list of package names (e.g. to ``plone.app.iterate``) to configure more profiles to be available for ``APPLY_PROFILES``.\n-\n-A special variable ``ROBOT_SERVER:True`` must be set for Robot Framework test runner to fix the test suite to be aware of being executed against long-running robot server.\n-\n-Screenshots for documentation\n-=============================\n-\n-The screenshots are meant for the Plone documentation.\n-\n-As there are still browser bugs, it is good to visually inspect them before they are uploaded in the repository\n-https://github.com/plone/documentation-roboshots\n-\n-In there, the tagged releases should contain known-good-sets of screenshots for a particular Plone version.\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/TODO.rst b/Products/CMFPlone/tests/robot/robodoc/TODO.rst\ndeleted file mode 100644\nindex f6136f2724..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/TODO.rst\n+++ /dev/null\n@@ -1,10 +0,0 @@\n-Browser and webdriver support\n------------------------------\n-\n-2017-07-20:\n-\n-Ubuntu 16.04:\n-\n-- Phantomjs works well, but has issues with iframes. The `working_with_tinymce.robot` tests have visual errors in the screenshots.\n-- Chrome 59 with chromedriver has issues, reportedly Chrome 60 should be better, and be able to do headless screenshots.\n-- Firefox 54 does not work with the current geckodriver software for Linux.\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/anonymous.robot b/Products/CMFPlone/tests/robot/robodoc/anonymous.robot\ndeleted file mode 100644\nindex 89cb4c1c16..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/anonymous.robot\n+++ /dev/null\n@@ -1,96 +0,0 @@\n-*** Settings ***\n-\n-Resource  plone/app/robotframework/keywords.robot\n-Resource  Selenium2Screenshots/keywords.robot\n-\n-Library  plone.app.robotframework.Zope2Server\n-Library  OperatingSystem\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-*** Variables ***\n-\n-${FIXTURE}  plone.app.robotframework.PLONE_ROBOT_TESTING\n-@{CONFIGURE_PACKAGES}\n-@{APPLY_PROFILES}  plone.app.contenttypes:plone-content\n-@{DIMENSIONS}  1024  768\n-${ROBOT_SERVER}  False\n-\n-*** Keywords ***\n-\n-Common Suite Setup\n-    Run keyword if  ${ROBOT_SERVER}  Setup Plone keywords\n-    Run keyword if  ${ROBOT_SERVER}  Remote ZODB setup  ${FIXTURE}\n-    Run keyword if  not ${ROBOT_SERVER}  Setup Plone site  ${FIXTURE}\n-    Run keyword if  not ${ROBOT_SERVER}  ZODB setup  ${FIXTURE}\n-\n-    ${language} =  Get environment variable  LANGUAGE  'en'\n-    Set default language  ${language}\n-\n-    Open test browser\n-    Run keyword and ignore error  Set window size  @{DIMENSIONS}\n-\n-Common Suite Teardown\n-    Close all browsers\n-    Run keyword if  ${ROBOT_SERVER}  Remote ZODB TearDown  ${FIXTURE}\n-    Run keyword if  not ${ROBOT_SERVER}  ZODB TearDown  ${FIXTURE}\n-    Run keyword if  not ${ROBOT_SERVER}  Teardown Plone site\n-\n-Setup Plone site\n-    [Arguments]  ${zope_layer_dotted_name}\n-    Start Zope server  ${zope_layer_dotted_name}\n-    Wait until keyword succeeds  2min  0s  Setup Plone keywords\n-\n-Setup Plone keywords\n-    Import library  Remote  ${PLONE_URL}/RobotRemote\n-\n-Teardown Plone site\n-    Close all browsers\n-    Stop Zope server\n-\n-Highlight link\n-    [Arguments]  ${locator}\n-    Update element style  ${locator}  padding  0.5em\n-    Highlight  ${locator}\n-\n-\n-*** Test Cases ***\n-\n-Take login link screenshot\n-    Go to  ${PLONE_URL}\n-    Highlight link  css=#personaltools-login\n-    Capture and crop page screenshot\n-    ...    ${CURDIR}/_robot/login-link.png\n-    ...    css=#content-header\n-    ...    css=#above-content-wrapper\n-\n-\n-Take login screenshot\n-    Go to  ${PLONE_URL}/login\n-    Capture and crop page screenshot\n-    ...    ${CURDIR}/_robot/login-popup.png\n-    ...    css=#content-core\n-\n-Take annotated screenshot\n-    Go to  ${PLONE_URL}\n-    Highlight link  css=#personaltools-login\n-    Capture and crop page screenshot\n-    ...    ${CURDIR}/_robot/anonymous-surfing.png\n-    ...    css=#content-header\n-    ...    css=#above-content-wrapper\n-\n-    Enable autologin as  Manager\n-    ${user_id} =  Translate  user_id\n-    ...  default=jane-doe\n-    ${user_fullname} =  Translate  user_fullname\n-    ...  default=Jane Doe\n-    Create user  ${user_id}  Member  fullname=${user_fullname}\n-    Set autologin username  ${user_id}\n-\n-Take logged in screenshot\n-    Go to  ${PLONE_URL}\n-    Capture and crop page screenshot\n-    ...    ${CURDIR}/_robot/loggedin-surfing.png\n-    ...    css=#above-content-wrapper\n-    ...    css=div.plone-toolbar-container\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/collaboration-advanced_control.robot b/Products/CMFPlone/tests/robot/robodoc/collaboration-advanced_control.robot\ndeleted file mode 100644\nindex a81141374d..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/collaboration-advanced_control.robot\n+++ /dev/null\n@@ -1,44 +0,0 @@\n-*** Settings ***\n-\n-Resource  common.robot\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-*** Variables ***\n-\n-@{DIMENSIONS}  1024  1200\n-\n-*** Test Cases ***\n-\n-Create sample content\n-    Go to  ${PLONE_URL}\n-    Capture page screenshot\n-\n-    ${item} =  Create content  type=Folder\n-    ...  id=documentation  title=Documentation\n-    ...  description=Here you can find the documentation on our new product\n-\n-Show state menu\n-    Go to  ${PLONE_URL}/documentation\n-\n-    Click link  css=#plone-contentmenu-workflow a\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-workflow li.plone-toolbar-submenu-header\n-\n-    Mouse over  workflow-transition-advanced\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/workflow-advanced-menu.png\n-    ...  css=#content-header\n-    ...  css=div.plone-toolbar-container\n-\n-    Click link  workflow-transition-advanced\n-    Wait until element is visible\n-    ...   css=div.modal-content\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/workflow-advanced.png\n-    ...  css=div.modal-wrapper\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/collaboration.robot b/Products/CMFPlone/tests/robot/robodoc/collaboration.robot\ndeleted file mode 100644\nindex 32508a142a..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/collaboration.robot\n+++ /dev/null\n@@ -1,92 +0,0 @@\n-*** Settings ***\n-\n-Resource  common.robot\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-*** Variables ***\n-\n-@{DIMENSIONS}  1280  1600\n-\n-*** Test Cases ***\n-\n-Create sample content\n-    Go to  ${PLONE_URL}\n-\n-    ${item} =  Create content  type=Document\n-    ...  id=samplepage  title=Sample Page\n-    ...  description=The long wait is now over\n-    ...  text=<p>Our new site is built with Plone.</p>\n-\n-\n-Show state menu\n-    Go to  ${PLONE_URL}/samplepage\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-workflow\n-    Click element  css=span.icon-plone-contentmenu-workflow\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-workflow li.plone-toolbar-submenu-header\n-\n-    Mouse over  workflow-transition-publish\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/workflow-basic.png\n-            ...  css=#content-header\n-            ...  css=div.plone-toolbar-container\n-\n-Show sendback\n-    Go to  ${PLONE_URL}/samplepage\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-workflow\n-    Click element  css=span.icon-plone-contentmenu-workflow\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-workflow li.plone-toolbar-submenu-header\n-\n-    click link  workflow-transition-submit\n-\n-    Go to  ${PLONE_URL}/samplepage\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-workflow\n-    Click element  css=span.icon-plone-contentmenu-workflow\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-workflow li.plone-toolbar-submenu-header\n-\n-    Mouse over  workflow-transition-reject\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/workflow-reject.png\n-            ...  css=#content-header\n-            ...  css=div.plone-toolbar-container\n-\n-Create sample folder\n-    Go to  ${PLONE_URL}\n-\n-    ${item} =  Create content  type=Folder\n-    ...  id=documentation  title=Documentation\n-    ...  description=Here you can find the documentation on our new product\n-\n-Show sharing menu\n-\n-    Go to  ${PLONE_URL}/documentation\n-\n-    Click link  css=#contentview-local_roles a\n-\n-    Wait until element is visible\n-    ...  css=#user-group-sharing-container\n-\n-    Update element style  portal-footer  display  none\n-\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/sharing-menu.png\n-            ...  css=#content-header\n-            ...  css=div.plone-toolbar-container\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/common.robot b/Products/CMFPlone/tests/robot/robodoc/common.robot\ndeleted file mode 100644\nindex 7c2a33733b..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/common.robot\n+++ /dev/null\n@@ -1,55 +0,0 @@\n-*** Settings ***\n-\n-Resource  plone/app/robotframework/keywords.robot\n-Resource  Selenium2Screenshots/keywords.robot\n-\n-Library  plone.app.robotframework.Zope2Server\n-Library  OperatingSystem\n-\n-*** Variables ***\n-\n-${FIXTURE}  plone.app.robotframework.PLONE_ROBOT_TESTING\n-@{CONFIGURE_PACKAGES}\n-@{APPLY_PROFILES}  plone.app.contenttypes:plone-content\n-@{DIMENSIONS}  1024  768\n-${ROBOT_SERVER}  False\n-\n-*** Keywords ***\n-\n-Common Suite Setup\n-    Run keyword if  ${ROBOT_SERVER}  Setup Plone keywords\n-    Run keyword if  ${ROBOT_SERVER}  Remote ZODB setup  ${FIXTURE}\n-    Run keyword if  not ${ROBOT_SERVER}  Setup Plone site  ${FIXTURE}\n-    Run keyword if  not ${ROBOT_SERVER}  ZODB setup  ${FIXTURE}\n-\n-    ${language} =  Get environment variable  LANGUAGE  'en'\n-    Set default language  ${language}\n-\n-    Enable autologin as  Manager\n-    ${user_id} =  Translate  user_id\n-    ...  default=jane-doe\n-    ${user_fullname} =  Translate  user_fullname\n-    ...  default=Jane Doe\n-    Create user  ${user_id}  Member  fullname=${user_fullname}\n-    Set autologin username  ${user_id}\n-\n-    Open test browser\n-    Run keyword and ignore error  Set window size  @{DIMENSIONS}\n-\n-Common Suite Teardown\n-    Close all browsers\n-    Run keyword if  ${ROBOT_SERVER}  Remote ZODB TearDown  ${FIXTURE}\n-    Run keyword if  not ${ROBOT_SERVER}  ZODB TearDown  ${FIXTURE}\n-    Run keyword if  not ${ROBOT_SERVER}  Teardown Plone site\n-\n-Setup Plone site\n-    [Arguments]  ${zope_layer_dotted_name}\n-    Start Zope server  ${zope_layer_dotted_name}\n-    Wait until keyword succeeds  2min  0s  Setup Plone keywords\n-\n-Setup Plone keywords\n-    Import library  Remote  ${PLONE_URL}/RobotRemote\n-\n-Teardown Plone site\n-    Close all browsers\n-    Stop Zope server\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/config-screens.robot b/Products/CMFPlone/tests/robot/robodoc/config-screens.robot\ndeleted file mode 100644\nindex 8422f57999..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/config-screens.robot\n+++ /dev/null\n@@ -1,212 +0,0 @@\n-*** Settings ***\n-\n-Resource  common.robot\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-*** Variables ***\n-\n-@{DIMENSIONS}  1280  1600\n-@{CONFIGURE_PACKAGES}  plone.app.caching\n-@{APPLY_PROFILES}  plone.app.contenttypes:plone-content  plone.app.caching:default\n-\n-\n-*** Keywords ***\n-\n-Highlight field\n-    [Arguments]  ${locator}\n-    Update element style  ${locator}  padding  0.5em\n-    Highlight  ${locator}\n-\n-*** Test Cases ***\n-\n-Show Add-ons setup screen\n-    Go to  ${PLONE_URL}/prefs_install_products_form\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/addon-setup.png\n-    ...  css=#content\n-\n-Show caching setup screen\n-    Go to  ${PLONE_URL}/@@caching-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/caching-setup.png\n-    ...  css=#content\n-\n-Show Configuration Registry screen\n-    Go to  ${PLONE_URL}/portal_registry\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/configuration-registry.png\n-    ...  css=#content\n-\n-Show Content setup screen\n-    Go to  ${PLONE_URL}/@@content-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/content-setup.png\n-    ...  css=#content\n-\n-    Click element  type_id\n-\n-    Select From List By Label  name=type_id  Document\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/content-document.png\n-    ...  css=#content\n-\n-Show Date setup screen\n-    Go to  ${PLONE_URL}/@@dateandtime-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/date-setup.png\n-    ...  css=#content\n-\n-Show Dexterity setup screen\n-    Go to  ${PLONE_URL}/@@dexterity-types\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/dexterity-setup.png\n-    ...  css=#content\n-\n-Show Discussion setup screen\n-    Go to  ${PLONE_URL}/@@discussion-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/discussion-setup.png\n-    ...  css=#content\n-\n-Show Editing setup screen\n-    Go to  ${PLONE_URL}/@@editing-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/editing-setup.png\n-    ...  css=#content\n-\n-Show Error log setup screen\n-    Go to  ${PLONE_URL}/@@error-log-form\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/errorlog-setup.png\n-    ...  css=#content\n-\n-Show HTML filter setup screen\n-    Go to  ${PLONE_URL}/@@filter-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/filter-setup.png\n-    ...  css=#content\n-\n-Show Image handling setup screen\n-    Go to  ${PLONE_URL}/@@imaging-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/imaging-setup.png\n-    ...  css=#content\n-\n-Show Site setup overview screen\n-    Go to  ${PLONE_URL}/@@overview-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/site-overview.png\n-    ...  css=#content\n-\n-Show Language setup screen\n-    Go to  ${PLONE_URL}/@@language-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/language-setup.png\n-    ...  css=#content\n-\n-    Click link  autotoc-item-autotoc-1\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/language-negotiation.png\n-    ...  css=#content\n-\n-Show Mail setup screen\n-    Go to  ${PLONE_URL}/@@mail-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/mail-setup.png\n-    ...  css=#content\n-\n-Show ZODB maintenance setup screen\n-    Go to  ${PLONE_URL}/@@maintenance-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/zodb-setup.png\n-    ...  css=#content\n-\n-Show Markup setup screen\n-    Go to  ${PLONE_URL}/@@markup-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/markup-setup.png\n-    ...  css=#content\n-\n-Show Navigation setup screen\n-    Go to  ${PLONE_URL}/@@navigation-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/navigation-setup.png\n-    ...  css=#content\n-\n-Show Resource Registry screen\n-    Go to  ${PLONE_URL}/@@resourceregistry-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/resource-registry.png\n-    ...  css=#content\n-\n-Show Search setup screen\n-    Go to  ${PLONE_URL}/@@search-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/search-setup.png\n-    ...  css=#content\n-\n-Show Security setup screen\n-    Go to  ${PLONE_URL}/@@security-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/security-setup.png\n-    ...  css=#content\n-\n-Show Site setup screen\n-    Go to  ${PLONE_URL}/@@site-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/site-setup.png\n-    ...  css=#content\n-\n-Show socialmedia setup screen\n-    Go to  ${PLONE_URL}/@@social-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/social-setup.png\n-    ...  css=#content\n-\n-Show Syndication setup screen\n-    Go to  ${PLONE_URL}/@@syndication-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/syndication-setup.png\n-    ...  css=#content\n-\n-Show Theming setup screen\n-    Go to  ${PLONE_URL}/@@theming-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/theme-setup.png\n-    ...  css=#content\n-\n-Show Tinymce setup screen\n-    Go to  ${PLONE_URL}/@@tinymce-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/tinymce-setup.png\n-    ...  css=#content\n-\n-Show Users setup screen\n-    Go to  ${PLONE_URL}/@@usergroup-userprefs\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/users-setup.png\n-    ...  css=#content\n-\n-    Go to  ${PLONE_URL}/@@usergroup-groupprefs\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/groups-setup.png\n-    ...  css=#content\n-    Go to  ${PLONE_URL}/@@usergroup-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/users-settings.png\n-    ...  css=#content\n-    Go to  ${PLONE_URL}/@@member-fields\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/users-fields.png\n-    ...  css=#content\n-\n-Changing the logo\n-    Go to  ${PLONE_URL}/@@site-controlpanel\n-    Highlight field  css=#formfield-form-widgets-site_logo\n-    Capture and crop page screenshot\n-    ...    ${CURDIR}/_robot/change-logo-in-site-control-panel.png\n-    ...    css=#content\n-    ...    css=#formfield-form-widgets-site_logo\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/content.robot b/Products/CMFPlone/tests/robot/robodoc/content.robot\ndeleted file mode 100644\nindex 891622ab6a..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/content.robot\n+++ /dev/null\n@@ -1,334 +0,0 @@\n-*** Settings ***\n-\n-Resource  common.robot\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-\n-\n-*** Test Cases ***\n-\n-Show add collection menu\n-    Go to  ${PLONE_URL}\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  collection\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-collections_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-\n-Select collection criteria\n-    Go to  ${PLONE_URL}/++add++Collection\n-    Click element  css=div.querystring-criteria-index a\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/collection-criteria.png\n-    ...  css=div.select2-drop-active\n-\n-Show add new event menu\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  event\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-events_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-Show new event add form\n-    Page should contain element  event\n-    Click link  event\n-\n-    Wait until element is visible\n-    ...  css=#mceu_16-body\n-    Wait until element is visible\n-    ...  id=portal-footer\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-events_add-form.png\n-    ...  id=content\n-\n-Show add files menu\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  file\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-files_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-Show new file add form\n-    Page should contain element  file\n-    Click link  file\n-\n-    Wait until element is visible\n-    ...  css=#form-widgets-title\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-files_add-form.png\n-    ...  css=#content\n-\n-Show add new folder menu\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  folder\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-folders_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-Show new folder add form\n-    Page should contain element  folder\n-    Click link  folder\n-\n-    Wait until element is visible\n-    ...  css=#form-widgets-IDublinCore-title\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-folders_add-form.png\n-    ...  css=#content\n-\n-Show add new image menu\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  image\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-images_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-Show new image edit form\n-    Page should contain element  image\n-    Click link  image\n-\n-    Wait until element is visible\n-    ...  css=#form-widgets-title\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-images_add-form.png\n-    ...  css=#content\n-\n-*** Test Cases ***\n-\n-Show add new link menu\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  link\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-links_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-*** Test Cases ***\n-\n-Show new link add form\n-    Page should contain element  link\n-    Click link  link\n-\n-    Wait until element is visible\n-    ...  css=#form-widgets-IDublinCore-title\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-links_add-form.png\n-    ...  css=#content\n-\n-Show add new content menu\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  document\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-content_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-Show add new news-item menu\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  news-item\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-news-items_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-Show new news-item edit form\n-    Page should contain element  news-item\n-    Click link  news-item\n-\n-    Wait until element is visible\n-    ...  css=#mceu_16-body\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-news-items_add-form.png\n-    ...  css=#content\n-\n-Show add new page menu\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  document\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-pages_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-Show new page edit form\n-    Page should contain element  document\n-    Click link  document\n-\n-    Wait until element is visible\n-    ...  css=#mceu_16-body\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-pages_add-form.png\n-    ...  css=#content\n-\n-Show Content restrictions\n-    Go to  ${PLONE_URL}/news\n-\n-    Click link  css=#plone-contentmenu-factories a\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  plone-contentmenu-settings\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/show-restrictions.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-Menu restrictions\n-    Go to  ${PLONE_URL}/news/folder_constraintypes_form\n-\n-    Click element  form-widgets-constrain_types_mode\n-\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/menu-restrictions.png\n-    ...  css=#main-container\n-\n-Show basic content properties tab\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Page should contain element  document\n-    Click link  document\n-    Update element style  portal-footer  display  none\n-\n-    Wait until element is visible\n-    ...  css=#form-widgets-IDublinCore-title\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/basicpropertiestabs.png\n-    ...  css=nav.autotoc-nav\n-\n-Show edit page categorization\n-    Click link  Categorization\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/editpagecategorization.png\n-    ...  css=#content-core\n-\n-Show content dates settings\n-    Click link  Dates\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/datessettings.png\n-    ...  css=#content-core\n-\n-Show content ownershippanel\n-    Click link  Ownership\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/ownershippanel.png\n-    ...  css=#content-core\n-\n-Show content settingspanel\n-    Click link  Settings\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/settingspanel.png\n-    ...  css=#content-core\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/managing-working_copy.robot b/Products/CMFPlone/tests/robot/robodoc/managing-working_copy.robot\ndeleted file mode 100644\nindex 6677e9cb83..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/managing-working_copy.robot\n+++ /dev/null\n@@ -1,114 +0,0 @@\n-*** Settings ***\n-\n-Resource  common.robot\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-*** Variables ***\n-\n-@{CONFIGURE_PACKAGES}  plone.app.iterate\n-@{APPLY_PROFILES}  plone.app.contenttypes:plone-content  plone.app.iterate:default\n-# ${REGISTER_TRANSLATIONS}  ${CURDIR}/../../_locales\n-\n-*** Test Cases ***\n-\n-Show how to checkout\n-    Go to  ${PLONE_URL}/front-page\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-actions\n-    Click element  css=span.icon-plone-contentmenu-actions\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-actions li.plone-toolbar-submenu-header\n-\n-    Mouse over  css=#plone-contentmenu-actions-iterate_checkout\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/working-copy_checkout.png\n-    ...  css=#content-header\n-    ...  css=div.plone-toolbar-container\n-\n-Show checkout notification\n-    Go to  ${PLONE_URL}/front-page\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-actions\n-    Click element  css=span.icon-plone-contentmenu-actions\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-actions li.plone-toolbar-submenu-header\n-    Click link  css=#plone-contentmenu-actions-iterate_checkout\n-    Wait until element is visible\n-    ...  name=form.button.Checkout\n-    Click button  name=form.button.Checkout\n-    Element should be visible  css=.portalMessage\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/working-copy_checkout-notification.png\n-    ...  css=#content-header\n-    ...  css=div.plone-toolbar-container\n-\n-Show locked original\n-    Go to  ${PLONE_URL}/front-page\n-\n-    Element should be visible  css=#plone-lock-status\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/working-copy_locked.png\n-    ...  css=#content-header\n-    ...  css=div.plone-toolbar-container\n-\n-Show check-in option\n-    Go to  ${PLONE_URL}/copy_of_front-page\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-actions\n-    Click element  css=span.icon-plone-contentmenu-actions\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-actions li.plone-toolbar-submenu-header\n-\n-    Mouse over  css=#plone-contentmenu-actions-iterate_checkin\n-    Update element style  portal-footer  display  none\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/working-copy_checkin.png\n-    ...  css=#content-header\n-    ...  css=div.plone-toolbar-container\n-\n-    Click link  css=#plone-contentmenu-actions-iterate_checkin\n-\n-    Element should be visible  css=#checkin_message\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/working-copy_checkin-form.png\n-    ...  css=#content-header\n-    ...  css=div.plone-toolbar-container\n-\n-Show cancel checkout\n-    Go to  ${PLONE_URL}/copy_of_front-page\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-actions\n-    Click element  css=span.icon-plone-contentmenu-actions\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-actions li.plone-toolbar-submenu-header\n-\n-    Mouse over  css=#plone-contentmenu-actions-iterate_checkout_cancel\n-    Update element style  portal-footer  display  none\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/working-copy_cancel-checkout.png\n-    ...  css=#content-header\n-    ...  css=div.plone-toolbar-container\n-\n-    Click link  css=#plone-contentmenu-actions-iterate_checkout_cancel\n-\n-    Element should be visible  css=.destructive\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/working-copy_cancel-checkout-form.png\n-    ...  css=#content-header\n-    ...  css=div.plone-toolbar-container\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/managing_content.robot b/Products/CMFPlone/tests/robot/robodoc/managing_content.robot\ndeleted file mode 100644\nindex 1d5de8ccb7..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/managing_content.robot\n+++ /dev/null\n@@ -1,198 +0,0 @@\n-*** Settings ***\n-\n-Resource  common.robot\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-\n-\n-*** Test Cases ***\n-\n-Show contentrules\n-    Go to  ${PLONE_URL}/@@rules-controlpanel\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/contentrules-start.png\n-            ...  css=#content\n-            ...  css=div.plone-toolbar-container\n-\n-add rule\n-    Go to  ${PLONE_URL}/+rule/plone.ContentRule\n-    Wait until element is visible\n-    ...  css=#formfield-form-widgets-title\n-    Click element  css=#form-widgets-title\n-    Input text  css=#form-widgets-title  Send Email when any Page is Modified\n-\n-    Click element  css=#form-widgets-description\n-    Input text  css=#form-widgets-description  this rule is meant for folders where new staff is having a go\n-    Click element  css=#formfield-form-widgets-event\n-    Select From List By Label  id=form-widgets-event  Object modified\n-\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/contentrules-add.png\n-            ...  css=#content\n-    Click button  css=#form-buttons-save\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/contentrules-conditions.png\n-            ...  css=#content\n-    Wait until element is visible\n-    ...  name=form.button.Save\n-    Click button  name=form.button.Save\n-\n-\n-assign rule\n-    Go to  ${PLONE_URL}/news\n-    Click link  css=#contentview-contentrules a\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/contentrules-assign.png\n-            ...  css=#content\n-            ...  css=div.plone-toolbar-container\n-\n-Edit folder\n-    Go to  ${PLONE_URL}\n-    Click element  css=#contentview-folderContents a\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-cutpaste.png\n-    ...  css=#content\n-\n-Deleting content\n-    Go to  ${PLONE_URL}\n-    Click element  css=#contentview-folderContents a\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-delete.png\n-    ...  css=#content\n-\n-Edit Page\n-    Go to  ${PLONE_URL}\n-    Click element  css=#contentview-edit a\n-    Wait until element is visible\n-    ...  css=#mceu_16-body\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/edit-page.png\n-    ...  css=#content\n-\n-Foldercontents\n-    Go to  ${PLONE_URL}\n-    Click element  css=#contentview-folderContents a\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents.png\n-    ...  css=#content\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-columns.png\n-    ...  css=#btn-attribute-columns\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-selected.png\n-    ...  css=#btn-selected-items\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-rearrange.png\n-    ...  css=#btn-rearrange\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-rearrange.png\n-    ...  css=#btn-rearrange\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-upload.png\n-    ...  css=#btn-upload\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-cut.png\n-    ...  css=#btn-cut\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-copy.png\n-    ...  css=#btn-copy\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-paste.png\n-    ...  css=#btn-paste\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-delete.png\n-    ...  css=#btn-delete\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-rename.png\n-    ...  css=#btn-rename\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-tags.png\n-    ...  css=#btn-tags\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-state.png\n-    ...  css=#btn-workflow\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-properties.png\n-    ...  css=#btn-properties\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-searchbox.png\n-    ...  css=#filter\n-\n-Show display menu\n-    Go to  ${PLONE_URL}\n-\n-    Click link  css=#plone-contentmenu-display a\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-display li.plone-toolbar-submenu-header\n-\n-\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/display-menu.png\n-            ...  css=#content-header\n-            ...  css=div.plone-toolbar-container\n-\n-Reordering\n-    Go to  ${PLONE_URL}\n-    Click element  css=#contentview-folderContents a\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-reorder.png\n-    ...  css=#content\n-\n-Create sample content for history\n-    Go to  ${PLONE_URL}\n-\n-    ${item} =  Create content  type=Document\n-    ...  id=samplepage  title=Sample Page\n-    ...  description=The long wait is now over\n-    ...  text=<p>Our new site is built with Plone.</p>\n-    Fire transition  ${item}  publish\n-\n-    Go to  ${PLONE_URL}/samplepage\n-    Click element  css=#contentview-edit a\n-    Click element  css=#form-widgets-IDublinCore-title\n-    Input text  css=#form-widgets-IDublinCore-title  Hurray\n-    Click element  css=#form-widgets-IVersionable-changeNote\n-    Input text  css=#form-widgets-IVersionable-changeNote  Title should be Hurray, not Sample Page.\n-    Click button  css=#form-buttons-save\n-\n-Show history\n-    Go to  ${PLONE_URL}/samplepage\n-    Click link  css=#contentview-history a\n-    Wait until element is visible\n-    ...  css=#history-list\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/content-history.png\n-            ...  css=#content-header\n-            ...  css=div.plone-toolbar-container\n-\n-Show portlet management\n-    Go to  ${PLONE_URL}\n-    Click link  css=#plone-contentmenu-portletmanager a\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-portletmanager li.plone-toolbar-submenu-header\n-\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/portlet-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#content-header\n-\n-Show right portlets\n-    Go to  ${PLONE_URL}/@@topbar-manage-portlets/plone.footerportlets\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/portlet-footer.png\n-    ...  css=#content\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/personalsettings.robot b/Products/CMFPlone/tests/robot/robodoc/personalsettings.robot\ndeleted file mode 100644\nindex 7c1edf71a8..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/personalsettings.robot\n+++ /dev/null\n@@ -1,45 +0,0 @@\n-*** Settings ***\n-\n-Resource  common.robot\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-*** Test Cases ***\n-\n-Show menubar\n-    Go to  ${PLONE_URL}\n-\n-    Click link  css=#portal-personaltools a\n-\n-    Wait until element is visible\n-    ...  css=#portal-personaltools li.plone-toolbar-submenu-header\n-\n-    Mouse over  personaltools-preferences\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/show-preferences.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=li.plone-toolbar-submenu-header\n-\n-Show personal preferences\n-    Go to  ${PLONE_URL}/@@personal-preferences\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/personal-preferences.png\n-    ...  css=#main-container\n-\n-Show personal information\n-    Go to  ${PLONE_URL}/@@personal-information\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/personal-information.png\n-    ...  css=#main-container\n-\n-Show changing password\n-    Go to  ${PLONE_URL}/@@change-password\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/change-password.png\n-    ...  css=#main-container\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/working_with_tinymce.robot b/Products/CMFPlone/tests/robot/robodoc/working_with_tinymce.robot\ndeleted file mode 100644\nindex 296ba742c0..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/working_with_tinymce.robot\n+++ /dev/null\n@@ -1,79 +0,0 @@\n-*** Settings ***\n-\n-Resource  common.robot\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-\n-*** Test Cases ***\n-\n-Create sample content\n-    Go to  ${PLONE_URL}\n-\n-    ${item} =  Create content  type=Document\n-    ...  id=samplepage  title=Sample Page\n-    ...  description=The long wait is now over\n-    ...  text=<p>Our new site is built with Plone.</p>\n-\n-\n-Show TinyMCE\n-    Go to  ${PLONE_URL}/samplepage\n-    Click element  css=#contentview-edit a\n-    Wait until element is visible\n-    ...  css=#mceu_16-body\n-    Click element  css=#mceu_2-open\n-    Click element  css=#mceu_2-open\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/tinymce.png\n-    ...  css=#mceu_16\n-\n-Show TinyMCE image\n-    Go to  ${PLONE_URL}/samplepage\n-    Click element  css=#contentview-edit a\n-    Wait until element is visible\n-    ...  css=#mceu_16-body\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/tinymce-imgbutton.png\n-    ...  css=#mceu_15\n-\n-    Click element  css=#mceu_15 button\n-    Wait until element is visible\n-    ...  css=h2.modal-title\n-    Wait until element is visible\n-    ...  css=div.common-controls\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/tinymce-imgdialog.png\n-    ...  css=div.outer-wrapper\n-    ...  css=div.modal-content\n-\n-Show TinyMCE insert links\n-    Go to  ${PLONE_URL}/samplepage\n-    Click element  css=#contentview-edit a\n-    Wait until element is visible\n-    ...  css=#mceu_16-body\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/tinymce-linkbutton.png\n-    ...  css=#mceu_14\n-\n-    Click element  css=#mceu_14 button\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/tinymce-linkdialog.png\n-    ...  css=div.outer-wrapper\n-    ...  css=div.modal-content\n-\n-Show TinyMCE insert tables\n-    Go to  ${PLONE_URL}/samplepage\n-    Click element  css=#contentview-edit a\n-    Wait until element is visible\n-    ...  css=#mceu_16-body\n-\n-    Click element  css=#mceu_22-open\n-    Click element  css=#mceu_42-text\n-    Wait until element is visible\n-    ...  css=#mceu_42-text\n-    Mouse over  css=#mceu_42-text\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/tinymce-table.png\n-    ...  css=div.outer-wrappper\n\\ No newline at end of file\n"

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T12:57:29+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/3eee6f60046345a5566a5ca55d6d65e5fc10dd78

delete obsolete common.robot keywords

Files changed:
D Products/CMFPlone/tests/robot/common.robot

b"diff --git a/Products/CMFPlone/tests/robot/common.robot b/Products/CMFPlone/tests/robot/common.robot\ndeleted file mode 100644\nindex 33791aa6dc..0000000000\n--- a/Products/CMFPlone/tests/robot/common.robot\n+++ /dev/null\n@@ -1,69 +0,0 @@\n-*** Settings ***\n-\n-Resource  plone/app/robotframework/variables.robot\n-\n-Library  Remote  ${PLONE_URL}/RobotRemote\n-\n-*** Variables ***\n-\n-${TEST_FOLDER}  test-folder\n-\n-*** Keywords ***\n-\n-a document\n-    [Arguments]  ${title}\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}/++add++Document\n-    Given patterns are loaded\n-    Execute Javascript  $('#form-widgets-IDublinCore-title').val('${title}'); return 0;\n-    Click Button  Save\n-\n-a folder\n-    [Arguments]  ${title}\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}/++add++Folder\n-    Given patterns are loaded\n-    Execute Javascript  $('#form-widgets-IDublinCore-title').val('${title}'); return 0;\n-    Click Button  Save\n-\n-a folder '${foldername}' with a document '${documentname}'\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}/++add++Folder\n-    Given patterns are loaded\n-    Execute Javascript  $('#form-widgets-IDublinCore-title').val('${foldername}'); return 0;\n-    Click Button  Save\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}/folder/edit\n-    Given patterns are loaded\n-    Execute Javascript  $('#form-widgets-IDublinCore-title').val('${documentname}'); return 0;\n-    Click Button  Save\n-\n-a collection\n-    [Arguments]  ${title}\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}/++add++Collection\n-    Given patterns are loaded\n-    Execute Javascript  $('#form-widgets-IDublinCore-title').val('${title}'); return 0;\n-    Click Button  Save\n-\n-a site owner\n-    Log in as site owner\n-\n-the site root\n-    Go to  ${PLONE_URL}\n-\n-a test folder\n-    Go to  ${PLONE_URL}/++add++Folder\n-    Given patterns are loaded\n-    Execute Javascript  $('#form-widgets-IDublinCore-title').val('Test Folder'); return 0;\n-    Click Button  Save\n-\n-the test folder\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}\n-\n-there should be '${count}' livesearch results\n-    Wait until keyword succeeds  5s  1s  Element Should Be Visible  css=div#LSResult\n-    Wait until keyword succeeds  5s  1s  Xpath Should Match X Times  //div[@id = 'LSResult']/descendant::li  ${count}\n-\n-patterns are loaded\n-    Wait For Condition  return !!document.querySelector('body.patterns-loaded')\n-\n-Refresh JS/CSS resources\n-    # Not needed anymore, and it is breaking the Plone Zope 4 tests.\n-    # Keep the keyword for backwards compatibility purposes.\n-    Sleep  0.0000001\n"

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-08T13:07:10+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/2fb10fd8b229dc5d1bb07ef6c176a6c429ce9212

add news

Files changed:
A news/3980.1.feature

b'diff --git a/news/3980.1.feature b/news/3980.1.feature\nnew file mode 100644\nindex 0000000000..5670be2202\n--- /dev/null\n+++ b/news/3980.1.feature\n@@ -0,0 +1,4 @@\n+Port robot tests to playwright based tests, use robotframework browser library\n+\n+Remove obsolete robodocs\n+[1letter, petschki]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-11T07:16:31+02:00
Author: Peter Mathis (petschki) <petschki@users.noreply.github.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/924837cf4cfa4053b6fa7a0e92efb19c95c91fc1

Merge branch 'master' into port-robot-tests

Files changed:
A Products/CMFPlone/tests/configure-distributions.zcml
A news/3961.breaking.1
A news/3961.breaking.2
A news/3961.breaking.3
A news/3961.feature.1
A news/4022.bugfix
M Products/CMFPlone/browser/admin.py
M Products/CMFPlone/browser/admin.zcml
M Products/CMFPlone/browser/templates/plone-addsite.pt
M Products/CMFPlone/browser/templates/plone-overview.pt
M Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_search.py
M Products/CMFPlone/factory.py
M Products/CMFPlone/patches/__init__.py
M Products/CMFPlone/resources/utils.py
M Products/CMFPlone/testing.py
M Products/CMFPlone/tests/configure.zcml
M Products/CMFPlone/tests/testPortalCreation.py
M Products/CMFPlone/tests/testResourceRegistries.py
M Products/CMFPlone/tests/test_factory.py
D Products/CMFPlone/patches/addzmiplonesite.py

b'diff --git a/Products/CMFPlone/browser/admin.py b/Products/CMFPlone/browser/admin.py\nindex 0e1df304b4..1c91c8e97d 100644\n--- a/Products/CMFPlone/browser/admin.py\n+++ b/Products/CMFPlone/browser/admin.py\n@@ -6,7 +6,6 @@\n from importlib.metadata import distribution\n from importlib.metadata import PackageNotFoundError\n from OFS.interfaces import IApplication\n-from plone.base.interfaces import INonInstallable\n from plone.base.interfaces import IPloneSiteRoot\n from plone.base.utils import get_installer\n from plone.i18n.locales.interfaces import IContentLanguageAvailability\n@@ -15,16 +14,13 @@\n from plone.protect.interfaces import IDisableCSRFProtection\n from Products.CMFCore.permissions import ManagePortal\n from Products.CMFPlone.factory import _DEFAULT_PROFILE\n+from Products.CMFPlone.factory import _TYPES_PROFILE\n from Products.CMFPlone.factory import addPloneSite\n from Products.Five.browser.pagetemplatefile import ViewPageTemplateFile\n-from Products.GenericSetup import BASE\n-from Products.GenericSetup import EXTENSION\n-from Products.GenericSetup import profile_registry\n from Products.GenericSetup.upgrade import normalize_version\n from urllib import parse\n from ZODB.broken import Broken\n from zope.component import adapter\n-from zope.component import getAllUtilitiesRegisteredFor\n from zope.component import getUtility\n from zope.component import queryMultiAdapter\n from zope.component import queryUtility\n@@ -46,6 +42,11 @@\n     HAS_VOLTO = True\n except PackageNotFoundError:\n     HAS_VOLTO = False\n+try:\n+    distribution("plone.app.caching")\n+    HAS_CACHING = True\n+except PackageNotFoundError:\n+    HAS_CACHING = False\n try:\n     distribution("plone.app.upgrade")\n     HAS_UPGRADE = True\n@@ -67,8 +68,6 @@ def publishTraverse(self, request, name):\n \n \n class Overview(BrowserView):\n-    has_volto = HAS_VOLTO\n-\n     def sites(self, root=None):\n         if root is None:\n             root = self.context\n@@ -155,67 +154,15 @@ class FrontPage(BrowserView):\n \n \n class AddPloneSite(BrowserView):\n-    # Profiles that are installed by default,\n-    # but can be removed later.\n-    default_extension_profiles = (\n-        "plone.app.caching:default",\n-        "plonetheme.barceloneta:default",\n-    )\n-    # Let\'s have a separate list for Volto.\n-    volto_default_extension_profiles = (\n-        "plone.app.caching:default",\n-        "plonetheme.barceloneta:default",\n-        "plone.volto:default",\n-    )\n-\n-    def profiles(self):\n-        base_profiles = []\n-        extension_profiles = []\n-        if HAS_VOLTO and not self.request.get("classic"):\n-            selected_extension_profiles = self.volto_default_extension_profiles\n-        else:\n-            selected_extension_profiles = self.default_extension_profiles\n-\n-        # profiles available for install/uninstall, but hidden at the time\n-        # the Plone site is created\n-        not_installable = [\n-            "Products.CMFPlacefulWorkflow:CMFPlacefulWorkflow",\n-        ]\n-        utils = getAllUtilitiesRegisteredFor(INonInstallable)\n-        for util in utils:\n-            not_installable.extend(\n-                util.getNonInstallableProfiles()\n-                if hasattr(util, "getNonInstallableProfiles")\n-                else []\n-            )\n-\n-        for info in profile_registry.listProfileInfo():\n-            if info.get("type") == EXTENSION and info.get("for") in (\n-                IPloneSiteRoot,\n-                None,\n-            ):\n-                profile_id = info.get("id")\n-                if profile_id not in not_installable:\n-                    if profile_id in selected_extension_profiles:\n-                        info["selected"] = "selected"\n-                    extension_profiles.append(info)\n-\n-        def _key(v):\n-            # Make sure implicitly selected items come first\n-            selected = v.get("selected") and "automatic" or "manual"\n-            return "{}-{}".format(selected, v.get("title", ""))\n-\n-        extension_profiles.sort(key=_key)\n-\n-        for info in profile_registry.listProfileInfo():\n-            if info.get("type") == BASE and info.get("for") in (IPloneSiteRoot, None):\n-                base_profiles.append(info)\n-\n-        return dict(\n-            base=tuple(base_profiles),\n-            default=_DEFAULT_PROFILE,\n-            extensions=tuple(extension_profiles),\n-        )\n+    @property\n+    def default_extension_profiles(self):\n+        # Profiles that are installed by default,\n+        # but can be removed later.\n+        profiles = [_TYPES_PROFILE]\n+        if HAS_CACHING:\n+            profiles.append("plone.app.caching:default")\n+        profiles.append("plonetheme.barceloneta:default")\n+        return profiles\n \n     def browser_language(self):\n         language = "en"\n@@ -308,9 +255,8 @@ def __call__(self):\n                 context,\n                 site_id,\n                 title=form.get("title", ""),\n-                profile_id=form.get("profile_id", _DEFAULT_PROFILE),\n-                extension_ids=form.get("extension_ids", ()),\n-                setup_content=form.get("setup_content", False),\n+                profile_id=_DEFAULT_PROFILE,\n+                extension_ids=self.default_extension_profiles,\n                 default_language=form.get("default_language", "en"),\n                 portal_timezone=form.get("portal_timezone", "UTC"),\n             )\ndiff --git a/Products/CMFPlone/browser/admin.zcml b/Products/CMFPlone/browser/admin.zcml\nindex 8d6696c408..04af682344 100644\n--- a/Products/CMFPlone/browser/admin.zcml\n+++ b/Products/CMFPlone/browser/admin.zcml\n@@ -1,6 +1,7 @@\n <configure\n     xmlns="http://namespaces.zope.org/zope"\n     xmlns:browser="http://namespaces.zope.org/browser"\n+    xmlns:zcml="http://namespaces.zope.org/zcml"\n     >\n \n   <browser:view\n@@ -10,21 +11,34 @@\n       permission="zope.Public"\n       />\n \n-  <browser:page\n-      name="plone-addsite"\n-      for="OFS.interfaces.IApplication"\n-      class=".admin.AddPloneSite"\n-      template="templates/plone-addsite.pt"\n-      permission="zope2.ViewManagementScreens"\n-      />\n+  <configure zcml:condition="not-installed plone.distribution">\n+    <adapter factory=".admin.AppTraverser" />\n \n-  <browser:page\n-      name="plone-addsite"\n-      for="OFS.Folder.Folder"\n-      class=".admin.AddPloneSite"\n-      template="templates/plone-addsite.pt"\n-      permission="zope2.ViewManagementScreens"\n-      />\n+    <browser:page\n+        name="plone-overview"\n+        for="OFS.interfaces.IApplication"\n+        class=".admin.Overview"\n+        template="templates/plone-overview.pt"\n+        permission="zope.Public"\n+        />\n+\n+    <browser:page\n+        name="plone-addsite"\n+        for="OFS.interfaces.IApplication"\n+        class=".admin.AddPloneSite"\n+        template="templates/plone-addsite.pt"\n+        permission="zope2.ViewManagementScreens"\n+        />\n+\n+    <browser:page\n+        name="plone-addsite"\n+        for="OFS.Folder.Folder"\n+        class=".admin.AddPloneSite"\n+        template="templates/plone-addsite.pt"\n+        permission="zope2.ViewManagementScreens"\n+        />\n+\n+  </configure>\n \n   <browser:page\n       name="plone-upgrade"\n@@ -34,14 +48,6 @@\n       permission="cmf.ManagePortal"\n       />\n \n-  <browser:page\n-      name="plone-overview"\n-      for="OFS.interfaces.IApplication"\n-      class=".admin.Overview"\n-      template="templates/plone-overview.pt"\n-      permission="zope.Public"\n-      />\n-\n   <browser:page\n       name="plone-root-login"\n       for="OFS.interfaces.IApplication"\n@@ -56,8 +62,6 @@\n       permission="zope.Public"\n       />\n \n-  <adapter factory=".admin.AppTraverser" />\n-\n   <browser:resource\n       name="plone-admin-ui.css"\n       file="static/plone-admin-ui.css"\ndiff --git a/Products/CMFPlone/browser/templates/plone-addsite.pt b/Products/CMFPlone/browser/templates/plone-addsite.pt\nindex c4ff0769e1..e3c10222e0 100644\n--- a/Products/CMFPlone/browser/templates/plone-addsite.pt\n+++ b/Products/CMFPlone/browser/templates/plone-addsite.pt\n@@ -31,12 +31,7 @@\n     </header>\n     <form action="#"\n     method="post"\n-    tal:attributes="action string:${context/absolute_url}/@@plone-addsite"\n-    tal:define="profiles view/profiles;\n-                base_profiles profiles/base;\n-                default_profile profiles/default;\n-                extension_profiles profiles/extensions;\n-                advanced request/advanced|nothing;">\n+    tal:attributes="action string:${context/absolute_url}/@@plone-addsite">\n       <article class="row">\n         <div class="col-md-12">\n           <h1><span i18n:translate="">Create a Plone site</span></h1>\n@@ -120,92 +115,6 @@\n             </div>\n           </div>\n \n-          <div class="col-md-12 mb-3"\n-               tal:condition="advanced">\n-            <div class="form-check">\n-              <input class="form-check-input"\n-                    id="example-content"\n-                    type="checkbox"\n-                    name="setup_content:boolean"\n-                    checked="checked" />\n-              <label class="form-check-label"\n-                    for="example-content"\n-                    i18n:translate="">Example content</label>\n-              <div class="form-text" i18n:translate="">\n-                Should the default example content be added to the site?\n-              </div>\n-            </div>\n-          </div>\n-\n-          <input tal:condition="not:advanced"\n-                  type="hidden" name="setup_content:boolean" value="true" />\n-\n-          <div class="col-md-12"\n-               tal:condition="python: len(base_profiles) > 1">\n-            <div class="mb-3">\n-              <p class="lead" i18n:translate="">Base configuration</p>\n-\n-              <div tal:repeat="info base_profiles"\n-                  class="form-check mb-3">\n-                <input type="radio"\n-                      name="profile_id:string"\n-                      value="profile"\n-                      class="form-check-input"\n-                      tal:attributes="id info/id;\n-                                      value info/id;\n-                                      checked python: default_profile==info[\'id\'] and \'checked\' or nothing" />\n-                <label class="form-check-label" tal:attributes="for info/id">${info/title}</label>\n-                <div class="form-text" tal:content="info/description">${info/description}</div>\n-              </div>\n-\n-              <div class="form-text" i18n:translate="">\n-                You normally don\'t need to change anything here unless you have specific reasons and know what you are doing.\n-              </div>\n-\n-            </div>\n-          </div>\n-\n-\n-          <div class="col-md-12 mt-3"\n-               tal:define="has_selected python:[p for p in extension_profiles if p.get(\'selected\', None)]"\n-               tal:condition="python: extension_profiles or advanced"\n-               tal:omit-tag="python: has_selected and not advanced">\n-            <tal:block condition="python: advanced">\n-              <h2 i18n:translate="">Add-ons</h2>\n-\n-              <div class="lead"\n-                   i18n:translate="" >\n-                Select any add-ons you want to activate immediately.\n-                You can also activate add-ons after the site has been created using the Add-ons control panel.\n-              </div>\n-            </tal:block>\n-\n-            <tal:loop tal:repeat="info extension_profiles">\n-              <tal:set tal:define="selected info/selected|nothing">\n-                <tal:normal tal:condition="python: not selected or advanced">\n-                  <div class="form-check mb-3"\n-                      tal:condition="python: advanced">\n-                    <input type="checkbox"\n-                          name="extension_ids:list"\n-                          value="${info/id}"\n-                          id="${info/id}"\n-                          class="form-check-input"\n-                          tal:attributes="checked info/selected|nothing;" />\n-                    <label class="form-check-label" for="${info/id}" >${info/title}</label>\n-                    <div class="form-text"\n-                        tal:condition="python: advanced and info[\'description\']">\n-                      ${info/description}\n-                    </div>\n-                  </div>\n-                </tal:normal>\n-                <tal:hidden tal:condition="python: selected and not advanced">\n-                  <input type="hidden"\n-                        name="extension_ids:list"\n-                        value="${info/id}" />\n-                </tal:hidden>\n-              </tal:set>\n-            </tal:loop>\n-          </div>\n           <div class="col-md-12 mt-3">\n             <input type="hidden" name="form.submitted:boolean" value="True" />\n             <button class="btn btn-success mt-3" type="submit" name="submit" i18n:translate="">Create Plone Site</button>\ndiff --git a/Products/CMFPlone/browser/templates/plone-overview.pt b/Products/CMFPlone/browser/templates/plone-overview.pt\nindex 035f0b4856..42217e8180 100644\n--- a/Products/CMFPlone/browser/templates/plone-overview.pt\n+++ b/Products/CMFPlone/browser/templates/plone-overview.pt\n@@ -87,24 +87,9 @@\n                 <input type="hidden" name="site_id" value="Plone${site_number}" />\n                 <button type="submit"\n                         class="btn btn-${python:\'success\' if sites else \'primary\'}"\n-                        i18n:translate="">Create a new Plone site</button>\n-                <a class="btn btn-info"\n-                    i18n:translate=""\n-                    tal:condition="view/has_volto"\n-                    href="${action}?site_id=Plone${site_number}&amp;classic=1"\n-                    >Create Classic UI Plone site</a>\n-                <a class="btn btn-secondary"\n-                    i18n:translate=""\n-                    href="${action}?site_id=Plone${site_number}&amp;advanced=1"\n-                    >Advanced</a>\n+                        i18n:translate="">Create Classic UI Plone site</button>\n             </form>\n             <br/>\n-            <p i18n:translate="help_create_plone_site_buttons_1">\n-                Starting with Plone 6, \'Create a new Plone site\' applies a\n-                profile and creates default content for the new React based\n-                default frontend Volto. You are however required to set up and run\n-                an additional frontend service to use this setup.\n-            </p>\n             <p i18n:translate="help_create_plone_site_buttons_2">\n                 The \'Create Classic UI Plone site\' button creates a Plone site configured\n                 for HTML based output, as was already supported by previous Plone versions.\n@@ -117,6 +102,11 @@\n                 these frontends and possible upgrade paths from older Plone versions\n                 to Plone 6.\n             </p>\n+            <p i18n:translate="help_create_plone_site_buttons_3">\n+                Starting with Plone 6.1, default content is not loaded into the site.\n+                If you want to load the default content, you should install the <code>plone.classicui</code> package.\n+                If you see this text, that means you have not installed that package yet.\n+            </p>\n         </div>\n     </article>\n \ndiff --git a/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_search.py b/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_search.py\nindex f0b6c31daa..8598ada339 100644\n--- a/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_search.py\n+++ b/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_search.py\n@@ -29,7 +29,9 @@ def setUp(self):\n \n     def test_search_control_panel_link(self):\n         self.browser.open("%s/@@overview-controlpanel" % self.portal_url)\n-        self.browser.getLink("Search").click()\n+        # The first "Search" link actually points to "Advanced Search"...\n+        # self.browser.getLink("Search").click()\n+        self.browser.getLink(url=f"{self.portal_url}/@@search-controlpanel").click()\n \n     def test_search_control_panel_backlink(self):\n         self.browser.open("%s/@@search-controlpanel" % self.portal_url)\ndiff --git a/Products/CMFPlone/factory.py b/Products/CMFPlone/factory.py\nindex 5506b7bb02..4b652b0e5c 100644\n--- a/Products/CMFPlone/factory.py\n+++ b/Products/CMFPlone/factory.py\n@@ -10,6 +10,8 @@\n from zope.interface import implementer\n from zope.lifecycleevent import ObjectCreatedEvent\n \n+import warnings\n+\n \n _TOOL_ID = "portal_setup"\n _DEFAULT_PROFILE = "Products.CMFPlone:plone"\n@@ -130,14 +132,53 @@ def addPloneSite(\n     title="Plone site",\n     description="",\n     profile_id=_DEFAULT_PROFILE,\n-    content_profile_id=None,\n     snapshot=False,\n+    content_profile_id=None,\n     extension_ids=(),\n-    setup_content=True,\n+    setup_content=None,\n     default_language="en",\n     portal_timezone="UTC",\n+    distribution_name=None,\n+    **kwargs,\n ):\n     """Add a PloneSite to the context."""\n+    if distribution_name:\n+        from plone.distribution.api import site as site_api\n+\n+        # Pass all arguments and keyword arguments in the answers,\n+        # But the \'distribution_name\' is not needed there.\n+        answers = {\n+            "site_id": site_id,\n+            "title": title,\n+            "description": description,\n+            "profile_id": profile_id,\n+            "snapshot": snapshot,\n+            "content_profile_id": content_profile_id,\n+            "extension_ids": extension_ids,\n+            "setup_content": setup_content,\n+            "default_language": default_language,\n+            "portal_timezone": portal_timezone,\n+        }\n+        answers.update(kwargs)\n+        site = site_api._create_site(\n+            context=context, distribution_name=distribution_name, answers=answers\n+        )\n+        setSite(site)\n+        return site\n+\n+    if content_profile_id is not None:\n+        warnings.warn(\n+            "addPloneSite ignores the content_profile_id keyword argument "\n+            "since Plone 6.1. In Plone 7 it will be removed.",\n+            DeprecationWarning,\n+        )\n+    if setup_content is not None:\n+        warnings.warn(\n+            "addPloneSite ignores the setup_content keyword argument "\n+            "since Plone 6.1, treating it as always False. "\n+            "In Plone 7 it will be removed.",\n+            DeprecationWarning,\n+        )\n \n     site = PloneSite(site_id)\n     notify(ObjectCreatedEvent(site))\n@@ -169,24 +210,6 @@ def addPloneSite(\n         reg["plone.available_languages"] = [default_language]\n         reg["plone.site_title"] = title\n \n-        # Install default content types profile if user do not select "example content"\n-        # during site creation.\n-        if setup_content:\n-            if content_profile_id:\n-                content_profiles = [content_profile_id]\n-            elif "plone.volto:default" in extension_ids:\n-                content_profiles = [\n-                    _TYPES_PROFILE,\n-                    "plone.volto:default-homepage",\n-                ]\n-            else:\n-                content_profiles = [_CONTENT_PROFILE]\n-        else:\n-            content_profiles = [_TYPES_PROFILE]\n-\n-        for profile_id in content_profiles:\n-            setup_tool.runAllImportStepsFromProfile(f"profile-{profile_id}")\n-\n         props = dict(\n             title=title,\n             description=description,\ndiff --git a/Products/CMFPlone/patches/__init__.py b/Products/CMFPlone/patches/__init__.py\nindex e8234dc395..a931d15b38 100644\n--- a/Products/CMFPlone/patches/__init__.py\n+++ b/Products/CMFPlone/patches/__init__.py\n@@ -1,7 +1,3 @@\n-# FIXME: This no longer works with the new ZMI\n-# from . import addzmiplonesite          # Add an explicit link to add a new Plone\n-# site to the ZMI for faster access\n-\n from . import addzmisecuritywarning  # Add a warning to the ZMI security tab\n from . import csrf  # Protects most important methods from\n from . import dateIndexPatch  # Avoid OverflowErrors in Date*Indexes\ndiff --git a/Products/CMFPlone/patches/addzmiplonesite.py b/Products/CMFPlone/patches/addzmiplonesite.py\ndeleted file mode 100644\nindex a772ab71cd..0000000000\n--- a/Products/CMFPlone/patches/addzmiplonesite.py\n+++ /dev/null\n@@ -1,42 +0,0 @@\n-from OFS.ObjectManager import ObjectManager\n-\n-\n-# FIXME: This no longer works with the new ZMI\n-\n-ADD_PLONE_SITE_HTML = """\n-<dtml-if "_.len(this().getPhysicalPath()) == 1 or this().meta_type == \'Folder\' and \'PloneSite\' not in [o.__class__.__name__ for o in this().aq_chain]">\n-  <!-- Add Plone site action-->\n-  <form method="get"\n-        action="&dtml-URL1;/@@plone-addsite"\n-        style="text-align: right; margin-top:0.5em; margin-bottom:0em;"\n-        target="_top">\n-    <input type="hidden" name="site_id" value="Plone" />\n-    <input type="submit" value="Add Plone Site" />\n-    <label><input type="checkbox" name="advanced">advanced</label>\n-  </form>\n-</dtml-if>\n-<dtml-if "this().meta_type == \'Plone Site\'">\n-  <!-- Warn if outdated -->\n-  <dtml-if "this().portal_migration.needUpgrading()">\n-    <div style="background: url(/misc_/PageTemplates/exclamation.gif) top left no-repeat;\n-                padding: 0 0 0 1.2em; font-weight: bold; font-size: 125%;\n-                margin-top: 1em;">\n-      The site configuration is outdated and needs to be upgraded.\n-      <a href="&dtml-URL1;/@@plone-upgrade" title="Go to the upgrade page">\n-        Please continue with the upgrade.\n-      </a>\n-    </div>\n-  </dtml-if>\n-</dtml-if>\n-"""\n-\n-main = ObjectManager.manage_main\n-orig = main.read()\n-pos = orig.find("<!-- Add object widget -->")\n-\n-# Add in our button html at the right position\n-new = orig[:pos] + ADD_PLONE_SITE_HTML + orig[pos:]\n-\n-# Modify the manage_main\n-main.edited_source = new\n-main._v_cooked = main.cook()\ndiff --git a/Products/CMFPlone/resources/utils.py b/Products/CMFPlone/resources/utils.py\nindex a0632ec8dc..4cbb8bbf67 100644\n--- a/Products/CMFPlone/resources/utils.py\n+++ b/Products/CMFPlone/resources/utils.py\n@@ -1,6 +1,7 @@\n from Acquisition import aq_base\n from Acquisition import aq_inner\n from Acquisition import aq_parent\n+from OFS.Image import File\n from plone.base.interfaces.resources import OVERRIDE_RESOURCE_DIRECTORY_NAME\n from plone.resource.file import FilesystemFile\n from plone.resource.interfaces import IResourceDirectory\n@@ -75,9 +76,15 @@ def get_resource(context, path):\n     if hasattr(aq_base(resource), "GET"):\n         # for FileResource\n         result = resource.GET()\n-    else:\n+    elif isinstance(resource, File):\n+        # An OFS.Image.File object\n+        result = resource.data\n+    elif callable(resource):\n         # any BrowserView\n         result = resource()\n+    else:\n+        logger.info("Cannot get data from resource %r", resource)\n+        result = b""\n     context.REQUEST.response = response_before\n     return result\n \ndiff --git a/Products/CMFPlone/testing.py b/Products/CMFPlone/testing.py\nindex 4b178f00b0..63f65ce3b9 100644\n--- a/Products/CMFPlone/testing.py\n+++ b/Products/CMFPlone/testing.py\n@@ -89,4 +89,29 @@ def tearDownPloneSite(self, portal):\n     name="CMFPloneLayer:Acceptance",\n )\n \n+\n+class ProductsCMFPloneDistributionsLayer(ProductsCMFPloneLayer):\n+    defaultBases = (PRODUCTS_CMFPLONE_FIXTURE,)\n+\n+    def setUpZope(self, app, configurationContext):\n+        import Products.CMFPlone\n+\n+        xmlconfig.file(\n+            "configure-distributions.zcml",\n+            Products.CMFPlone.tests,\n+            context=configurationContext,\n+        )\n+\n+    def setUpPloneSite(self, portal):\n+        # ProductsCMFPloneLayer already does enough setup.\n+        pass\n+\n+\n+PRODUCTS_CMFPLONE_DISTRIBUTIONS_FIXTURE = ProductsCMFPloneDistributionsLayer()\n+\n+PRODUCTS_CMFPLONE_DISTRIBUTIONS_INTEGRATION_TESTING = IntegrationTesting(\n+    bases=(PRODUCTS_CMFPLONE_DISTRIBUTIONS_FIXTURE,),\n+    name="CMFPloneLayer:DistributionsIntegration",\n+)\n+\n optionflags = doctest.ELLIPSIS | doctest.NORMALIZE_WHITESPACE\ndiff --git a/Products/CMFPlone/tests/configure-distributions.zcml b/Products/CMFPlone/tests/configure-distributions.zcml\nnew file mode 100644\nindex 0000000000..eb1428852e\n--- /dev/null\n+++ b/Products/CMFPlone/tests/configure-distributions.zcml\n@@ -0,0 +1,18 @@\n+<configure\n+    xmlns="http://namespaces.zope.org/zope"\n+    xmlns:plone="http://namespaces.plone.org/plone"\n+    xmlns:zcml="http://namespaces.zope.org/zcml"\n+    i18n_domain="plone"\n+    >\n+\n+  <configure zcml:condition="installed plone.distribution">\n+    <include package="plone.distribution" />\n+    <plone:distribution\n+        name="testdistro"\n+        title="Plone Site"\n+        headless="false"\n+        post_handler="plone.distribution.handler.post_handler"\n+        />\n+  </configure>\n+\n+</configure>\ndiff --git a/Products/CMFPlone/tests/configure.zcml b/Products/CMFPlone/tests/configure.zcml\nindex bd6ca7c2db..29f6057348 100644\n--- a/Products/CMFPlone/tests/configure.zcml\n+++ b/Products/CMFPlone/tests/configure.zcml\n@@ -1,6 +1,8 @@\n <configure\n     xmlns="http://namespaces.zope.org/zope"\n     xmlns:browser="http://namespaces.zope.org/browser"\n+    xmlns:plone="http://namespaces.plone.org/plone"\n+    xmlns:zcml="http://namespaces.zope.org/zcml"\n     i18n_domain="plone"\n     >\n \ndiff --git a/Products/CMFPlone/tests/testPortalCreation.py b/Products/CMFPlone/tests/testPortalCreation.py\nindex 57d7959e3c..200c18217c 100644\n--- a/Products/CMFPlone/tests/testPortalCreation.py\n+++ b/Products/CMFPlone/tests/testPortalCreation.py\n@@ -1,4 +1,6 @@\n from Acquisition import aq_base\n+from importlib.metadata import distribution\n+from importlib.metadata import PackageNotFoundError\n from plone.base.interfaces import IFilterSchema\n from plone.base.interfaces import INavigationSchema\n from plone.base.interfaces import ISearchSchema\n@@ -34,6 +36,15 @@\n from zope.interface.interfaces import IComponentRegistry\n from zope.location.interfaces import ISite\n \n+import unittest\n+\n+\n+try:\n+    distribution("plone.distribution")\n+    HAS_DISTRIBUTION = True\n+except PackageNotFoundError:\n+    HAS_DISTRIBUTION = False\n+\n \n class TestPortalCreation(PloneTestCase.PloneTestCase):\n     def afterSetUp(self):\n@@ -920,6 +931,10 @@ def testManagementPageCharset(self):\n         self.assertEqual(manage_charset, "utf-8")\n \n \n+@unittest.skipIf(\n+    HAS_DISTRIBUTION,\n+    "@@plone-addsite is not available because plone.distribution is used.",\n+)\n class TestAddPloneSite(PloneTestCase.PloneTestCase):\n     def afterSetUp(self):\n         self.request = self.app.REQUEST\n@@ -930,7 +945,6 @@ def addsite(self):\n         form = self.request.form\n         form["form.submitted"] = 1\n         form["site_id"] = "plonesite1"\n-        form["setup_content"] = 1\n         self.request["_authenticator"] = createToken()\n         addsite = self.app.restrictedTraverse("@@plone-addsite")\n         addsite()\n@@ -946,6 +960,6 @@ def test_addsite_en_as_nl(self):\n         # because translations are not available in the tests.\n         self.assertIn("Learn more about Plone", plonesite.text.raw)\n \n-        # XXX maybe it is better to reset the sire in the @@plone-addsite view\n+        # XXX maybe it is better to reset the site in the @@plone-addsite view\n         # or somewhere else?\n         setSite(None)\ndiff --git a/Products/CMFPlone/tests/testResourceRegistries.py b/Products/CMFPlone/tests/testResourceRegistries.py\nindex 12021ceb0a..235ba8cf87 100644\n--- a/Products/CMFPlone/tests/testResourceRegistries.py\n+++ b/Products/CMFPlone/tests/testResourceRegistries.py\n@@ -1,3 +1,4 @@\n+from OFS.Image import File\n from plone.app.testing import logout\n from plone.app.testing import setRoles\n from plone.app.testing import SITE_OWNER_NAME\n@@ -13,6 +14,7 @@\n from Products.CMFPlone.resources.browser.resource import REQUEST_CACHE_KEY\n from Products.CMFPlone.resources.browser.resource import ScriptsView\n from Products.CMFPlone.resources.browser.resource import StylesView\n+from Products.CMFPlone.resources.webresource import PloneScriptResource\n from Products.CMFPlone.tests import PloneTestCase\n from zope.component import getUtility\n \n@@ -180,6 +182,30 @@ def test_bundle_depends_on_missing(self):\n         # bundle should be skipped when rendering\n         self.assertNotIn("http://foo.bar/foobar.js", results)\n \n+    def test_resource_browser_static_resource(self):\n+        resource = PloneScriptResource(self.portal, resource="++resource++plone-admin-ui.js")\n+        self.assertIn(\n+            b"window.onload", resource.file_data,\n+        )\n+\n+    def test_resource_ofs_file(self):\n+        self.portal["foo.js"] = File("foo.js", "Title", b\'console.log()\')\n+        resource = PloneScriptResource(self.portal, resource="foo.js")\n+        self.assertEqual(\n+            resource.file_data, b\'console.log()\',\n+        )\n+\n+    def test_resource_view(self):\n+        resource = PloneScriptResource(self.portal, resource="@@ok")\n+        self.assertEqual(\n+            resource.file_data, b\'OK\',\n+        )\n+\n+    def test_resource_bogus(self):\n+        resource = PloneScriptResource(self.portal, resource="I_do_not_exist")\n+        self.assertEqual(\n+            resource.file_data, b\'I_do_not_exist\',\n+        )\n \n class TestStylesViewlet(PloneTestCase.PloneTestCase):\n     def test_styles_viewlet(self):\ndiff --git a/Products/CMFPlone/tests/test_factory.py b/Products/CMFPlone/tests/test_factory.py\nindex b876f730eb..ac7882e7a0 100644\n--- a/Products/CMFPlone/tests/test_factory.py\n+++ b/Products/CMFPlone/tests/test_factory.py\n@@ -1,7 +1,12 @@\n+from importlib.metadata import distribution\n+from importlib.metadata import PackageNotFoundError\n from plone.dexterity.interfaces import IDexterityFTI\n from plone.registry.interfaces import IRegistry\n from Products.CMFPlone.factory import addPloneSite\n from Products.CMFPlone.testing import PRODUCTS_CMFPLONE_INTEGRATION_TESTING\n+from Products.CMFPlone.testing import (\n+    PRODUCTS_CMFPLONE_DISTRIBUTIONS_INTEGRATION_TESTING,\n+)\n from Products.CMFPlone.utils import get_installer\n from zope.component import getUtility\n from zope.component import queryUtility\n@@ -9,6 +14,13 @@\n import unittest\n \n \n+try:\n+    distribution("plone.distribution")\n+    HAS_DISTRIBUTION = True\n+except PackageNotFoundError:\n+    HAS_DISTRIBUTION = False\n+\n+\n class TestFactoryPloneSite(unittest.TestCase):\n     layer = PRODUCTS_CMFPLONE_INTEGRATION_TESTING\n \n@@ -18,7 +30,7 @@ def setUp(self):\n \n     def testPlonesiteWithUnicodeTitle(self):\n         TITLE = "Plon\xc3\xa9"\n-        ploneSite = addPloneSite(self.app, "ploneFoo", title=TITLE, setup_content=False)\n+        ploneSite = addPloneSite(self.app, "ploneFoo", title=TITLE)\n         ploneSiteTitleProperty = ploneSite.getProperty("title")\n         # CMF stores title as string only so Plone should keep the same track\n         self.assertTrue(isinstance(ploneSiteTitleProperty, str))\n@@ -29,7 +41,7 @@ def testPlonesiteWithUnicodeTitle(self):\n \n     def testPlonesiteWithoutUnicodeTitle(self):\n         TITLE = "Plone"\n-        ploneSite = addPloneSite(self.app, "ploneFoo", title=TITLE, setup_content=False)\n+        ploneSite = addPloneSite(self.app, "ploneFoo", title=TITLE)\n         ploneSiteTitleProperty = ploneSite.getProperty("title")\n         # CMF stores title as string only so Plone should keep the same track\n         self.assertTrue(isinstance(ploneSiteTitleProperty, str))\n@@ -38,21 +50,57 @@ def testPlonesiteWithoutUnicodeTitle(self):\n         self.assertTrue(isinstance(ploneSiteTitle, str))\n         self.assertEqual(ploneSiteTitle, TITLE)\n \n-    def test_site_creation_without_content_but_with_dexterity(self):\n-        """Test site creation without example content have dexterity installed."""\n-        ploneSite = addPloneSite(self.app, "ploneFoo", title="Foo", setup_content=False)\n+    def test_site_creation_has_no_dexterity(self):\n+        """Test site creation does not even have dexterity installed.\n+\n+        If you want it, you need to pass more extension_ids,\n+        like the plone-addsite view does.\n+        """\n+        ploneSite = addPloneSite(self.app, "ploneFoo", title="Foo")\n         qi = get_installer(ploneSite, self.request)\n-        self.assertTrue(qi.is_product_installed("plone.app.dexterity"))\n+        self.assertFalse(qi.is_product_installed("plone.app.dexterity"))\n \n-    def test_site_creation_without_content_but_with_content_types(self):\n-        """Test site creation without example content have content types."""\n-        addPloneSite(self.app, "ploneFoo", title="Foo", setup_content=False)\n+    def test_site_creation_has_no_content_types(self):\n+        """Test site creation has no content types.\n+\n+        If you want them, you need to pass more extension_ids,\n+        like the plone-addsite view does.\n+        """\n+        addPloneSite(self.app, "ploneFoo", title="Foo")\n         # Folder\n         fti = queryUtility(IDexterityFTI, name="Folder")\n+        self.assertIsNone(fti)\n+        # For good measure we check that there is at least on FTI.\n+        fti = queryUtility(IDexterityFTI, name="Plone Site")\n         self.assertIsNotNone(fti)\n \n     def test_site_creation_title_is_set_in_registry(self):\n         """Plone site title should be stored in registry"""\n-        ploneSite = addPloneSite(self.app, "ploneFoo", title="Foo", setup_content=False)\n+        ploneSite = addPloneSite(self.app, "ploneFoo", title="Foo")\n         registry = getUtility(IRegistry, context=ploneSite)\n         self.assertEqual(registry["plone.site_title"], "Foo")\n+\n+\n+class TestFactoryDistributionPloneSite(unittest.TestCase):\n+    layer = PRODUCTS_CMFPLONE_DISTRIBUTIONS_INTEGRATION_TESTING\n+\n+    def setUp(self):\n+        self.app = self.layer["app"]\n+        self.request = self.layer["request"]\n+\n+    @unittest.skipIf(\n+        not HAS_DISTRIBUTION,\n+        "Passing a distribution_name needs plone.distribution.",\n+    )\n+    def test_site_creation_distribution(self):\n+        """Create a Plone Site using a distribution"""\n+        ploneSite = addPloneSite(\n+            self.app,\n+            "ploneFoo",\n+            title="Foo",\n+            distribution_name="testdistro",\n+            default_language="nl",\n+        )\n+        self.assertEqual(ploneSite.getId(), "ploneFoo")\n+        self.assertEqual(ploneSite.title, "Foo")\n+        self.assertEqual(ploneSite.Language(), "nl")\ndiff --git a/news/3961.breaking.1 b/news/3961.breaking.1\nnew file mode 100644\nindex 0000000000..0bd48e1547\n--- /dev/null\n+++ b/news/3961.breaking.1\n@@ -0,0 +1,2 @@\n+Only register the add site form and root Zope overview if `plone.distribution` is not available.\n+[maurits]\ndiff --git a/news/3961.breaking.2 b/news/3961.breaking.2\nnew file mode 100644\nindex 0000000000..6b21bc0d27\n--- /dev/null\n+++ b/news/3961.breaking.2\n@@ -0,0 +1,5 @@\n+Remove advanced options from Add Plone Site form.\n+If you need more options, you should add a Plone Distribution to your packages.\n+The main ones are `plone.volto` and `plone.classicui`.\n+We now only create a basic Plone site without default example content.\n+[maurits]\ndiff --git a/news/3961.breaking.3 b/news/3961.breaking.3\nnew file mode 100644\nindex 0000000000..38030bb3b4\n--- /dev/null\n+++ b/news/3961.breaking.3\n@@ -0,0 +1,4 @@\n+`factory.addPloneSite`: remove `setup_content` and `content_profile_id` keyword arguments.\n+We no longer load default content. Use a Plone Distribution if you need this.\n+Or pass an extra profile id in the `extension_ids` keyword argument.\n+[maurits]\ndiff --git a/news/3961.feature.1 b/news/3961.feature.1\nnew file mode 100644\nindex 0000000000..da7c79fa52\n--- /dev/null\n+++ b/news/3961.feature.1\n@@ -0,0 +1,3 @@\n+You can pass a `distribution_name` to `factory.addPloneSite`.\n+We then pass all other arguments and keyword arguments to the `plone.distribution` site api.\n+[maurits]\ndiff --git a/news/4022.bugfix b/news/4022.bugfix\nnew file mode 100644\nindex 0000000000..292aac9553\n--- /dev/null\n+++ b/news/4022.bugfix\n@@ -0,0 +1,2 @@\n+Resource registry: Support OFS.Image.File objects.\n+[ale-rt, thet]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-13T23:06:40+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/3840f8757669070b762e006b14b4c0ca4eab0706

fix Test

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_site.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_site.robot b/Products/CMFPlone/tests/robot/test_controlpanel_site.robot\nindex 451b7f9aee..5f4ded5213 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_site.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_site.robot\n@@ -94,8 +94,13 @@ then I can see a sitemap\n \n     Import library    OperatingSystem\n \n-    Download    ${PLONE_URL}/sitemap.xml.gz    saveAs=/tmp/sitemap.xml.gz\n-    File Should Exist    /tmp/sitemap.xml.gz\n+    # this is for robotframework browser > 17\n+    # Download    ${PLONE_URL}/sitemap.xml.gz    saveAs=/tmp/sitemap.xml.gz\n+    # File Should Exist    /tmp/sitemap.xml.gz\n+\n+    # this is for robotframework browser < 18.0\n+    ${file_object}=    Download    ${PLONE_URL}/sitemap.xml.gz\n+    File Should Exist    ${file_object.saveAs}\n \n the dublin core metadata shows up on the site\n     Go to    ${PLONE_URL}\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-13T23:06:50+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/e82b018361d72cef953a21573f219c424ad2ec55

fix test

Files changed:
M Products/CMFPlone/tests/robot/test_overlays.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_overlays.robot b/Products/CMFPlone/tests/robot/test_overlays.robot\nindex 4647d3f89c..5b96532721 100644\n--- a/Products/CMFPlone/tests/robot/test_overlays.robot\n+++ b/Products/CMFPlone/tests/robot/test_overlays.robot\n@@ -200,7 +200,7 @@ a document as the default view of the test folder\n     Click    //a[@id="contextSetDefaultPage"]\n     Click    //input[@id="doc"]\n     Click    //div[contains(@class,"modal-footer")]//button[@name="form.buttons.Save"]\n-    Get Text    //body//h1    contains    doc\n+    Wait For Condition    Text    //body//h1    contains    doc\n \n \n the users and groups configlet\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-14T00:35:40+02:00
Author: Peter Mathis (petschki) <petschki@users.noreply.github.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/a23c59674416182e5e1d8a0c20af93cb09ea294f

Merge branch 'master' into port-robot-tests

Files changed:
A news/4028.bugfix
M Products/CMFPlone/controlpanel/browser/configure.zcml
M Products/CMFPlone/controlpanel/permissions.zcml

b'diff --git a/Products/CMFPlone/controlpanel/browser/configure.zcml b/Products/CMFPlone/controlpanel/browser/configure.zcml\nindex 1a8231c590..7cca9f0b3a 100644\n--- a/Products/CMFPlone/controlpanel/browser/configure.zcml\n+++ b/Products/CMFPlone/controlpanel/browser/configure.zcml\n@@ -4,18 +4,6 @@\n     xmlns:zcml="http://namespaces.zope.org/zcml"\n     >\n \n-  <permission\n-      id="plone.app.controlpanel.Imaging"\n-      title="Plone Site Setup: Imaging"\n-      />\n-\n-  <permission\n-      id="plone.app.controlpanel.TinyMCE"\n-      title="Plone Site Setup: TinyMCE"\n-      >\n-    <role name="Manager" />\n-  </permission>\n-\n   <!-- Control Panel Main Template -->\n   <browser:page\n       name="prefs_main_template"\n@@ -325,16 +313,6 @@\n       permission="cmf.ManagePortal"\n       />\n \n-  <permission\n-      id="Products.CMFPlone.ManagePortalAliases"\n-      title="Manage Portal Aliases"\n-      />\n-\n-  <permission\n-      id="Products.CMFPlone.ManageContextAliases"\n-      title="Manage Context Aliases"\n-      />\n-\n   <browser:page\n       name="redirection-controlpanel"\n       for="plone.base.interfaces.IPloneSiteRoot"\ndiff --git a/Products/CMFPlone/controlpanel/permissions.zcml b/Products/CMFPlone/controlpanel/permissions.zcml\nindex be7eda7479..a701cf634b 100644\n--- a/Products/CMFPlone/controlpanel/permissions.zcml\n+++ b/Products/CMFPlone/controlpanel/permissions.zcml\n@@ -67,4 +67,26 @@\n     <role name="Manager" />\n   </permission>\n \n+  <permission\n+    id="plone.app.controlpanel.Imaging"\n+    title="Plone Site Setup: Imaging"\n+    />\n+\n+  <permission\n+      id="plone.app.controlpanel.TinyMCE"\n+      title="Plone Site Setup: TinyMCE"\n+      >\n+    <role name="Manager" />\n+  </permission>\n+\n+  <permission\n+    id="Products.CMFPlone.ManagePortalAliases"\n+    title="Manage Portal Aliases"\n+    />\n+\n+  <permission\n+      id="Products.CMFPlone.ManageContextAliases"\n+      title="Manage Context Aliases"\n+      />\n+\n </configure>\ndiff --git a/news/4028.bugfix b/news/4028.bugfix\nnew file mode 100644\nindex 0000000000..d0916ccdf0\n--- /dev/null\n+++ b/news/4028.bugfix\n@@ -0,0 +1,2 @@\n+move all permission definitions for controlpanels to unifed file from controlpanel directory\n+[jackahl]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-15T07:10:36+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/0d6ec2ece233392d9af7b83b295f8d8298e792e0

Fix Test

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_site.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_site.robot b/Products/CMFPlone/tests/robot/test_controlpanel_site.robot\nindex 5f4ded5213..1e02aa71e0 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_site.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_site.robot\n@@ -95,12 +95,12 @@ then I can see a sitemap\n     Import library    OperatingSystem\n \n     # this is for robotframework browser > 17\n-    # Download    ${PLONE_URL}/sitemap.xml.gz    saveAs=/tmp/sitemap.xml.gz\n-    # File Should Exist    /tmp/sitemap.xml.gz\n+    Download    ${PLONE_URL}/sitemap.xml.gz    saveAs=/tmp/sitemap.xml.gz\n+    File Should Exist    /tmp/sitemap.xml.gz\n \n     # this is for robotframework browser < 18.0\n-    ${file_object}=    Download    ${PLONE_URL}/sitemap.xml.gz\n-    File Should Exist    ${file_object.saveAs}\n+    # ${file_object}=    Download    ${PLONE_URL}/sitemap.xml.gz\n+    # File Should Exist    ${file_object.saveAs}\n \n the dublin core metadata shows up on the site\n     Go to    ${PLONE_URL}\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-16T16:30:47+02:00
Author: Peter Mathis (petschki) <petschki@users.noreply.github.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/c22725ad00bf624384d5ba3a3ec31b3513077cbf

Merge branch 'master' into port-robot-tests

Files changed:
A news/4020.bugfix
A news/4026.bugfix
M Products/CMFPlone/PloneTool.py
M Products/CMFPlone/Portal.py
M Products/CMFPlone/tests/testPloneTool.py

b'diff --git a/Products/CMFPlone/PloneTool.py b/Products/CMFPlone/PloneTool.py\nindex 0c549327a2..85f28e820e 100644\n--- a/Products/CMFPlone/PloneTool.py\n+++ b/Products/CMFPlone/PloneTool.py\n@@ -137,6 +137,12 @@ def validateSingleNormalizedEmailAddress(self, address):\n         if not isinstance(address, str):\n             return False\n \n+        address = address.strip()\n+\n+        # address can be empty if getaddresses has parsing errors (returns [("", "")])\n+        if address == "":\n+            return False\n+\n         sub = EMAIL_CUTOFF_RE.match(address)\n         if sub is not None:\n             # Address contains two newlines (possible spammer relay attack)\ndiff --git a/Products/CMFPlone/Portal.py b/Products/CMFPlone/Portal.py\nindex cbf4c91149..878872e666 100644\n--- a/Products/CMFPlone/Portal.py\n+++ b/Products/CMFPlone/Portal.py\n@@ -61,7 +61,7 @@ def __getattr__(self, name):\n \n     def __setattr__(self, name, obj):\n         # handle re setting an item as an attribute\n-        if self._tree is not None and name in self:\n+        if not name.startswith("_") and self._tree is not None and name in self:\n             del self[name]\n             self[name] = obj\n         else:\ndiff --git a/Products/CMFPlone/tests/testPloneTool.py b/Products/CMFPlone/tests/testPloneTool.py\nindex 3e3be2c3ea..23a9120794 100644\n--- a/Products/CMFPlone/tests/testPloneTool.py\n+++ b/Products/CMFPlone/tests/testPloneTool.py\n@@ -74,7 +74,6 @@ def testvalidateEmailAddresses(self):\n         validInputs = (\n             "user@example.org",\n             "user@example.org,\\n user2@example.org",\n-            "user@example.org\\n user2@example.org",  # omitting comma is ok\n             "USER@EXAMPLE.ORG,\\n User2@Example.Org",\n         )\n         invalidInputs = (\ndiff --git a/news/4020.bugfix b/news/4020.bugfix\nnew file mode 100644\nindex 0000000000..e9cc73c207\n--- /dev/null\n+++ b/news/4020.bugfix\n@@ -0,0 +1,2 @@\n+Update for strict parsing in `email.utils.getaddresses` newest versions.\n+[petschki]\ndiff --git a/news/4026.bugfix b/news/4026.bugfix\nnew file mode 100644\nindex 0000000000..a51ab29b2e\n--- /dev/null\n+++ b/news/4026.bugfix\n@@ -0,0 +1 @@\n+Avoid POSKeyError when commit occurs and we have savepoint that involves Plone Site. @wesleybl\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-18T08:44:32+02:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/85e2b7c4043f0f236166049e3a5dae314bd73c05

fix folder_contents tests

Files changed:
M Products/CMFPlone/tests/robot/test_folder_contents.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_folder_contents.robot b/Products/CMFPlone/tests/robot/test_folder_contents.robot\nindex b49619a551..0a9ddc5c3c 100644\n--- a/Products/CMFPlone/tests/robot/test_folder_contents.robot\n+++ b/Products/CMFPlone/tests/robot/test_folder_contents.robot\n@@ -17,8 +17,8 @@ Scenario: Select All items\n       and a folder with four pages\n       and the folder contents view\n      When I select all the elements\n-     Then the selection count appears\n       and the four elements got selected\n+     Then the selection count appears\n       and the clear selection link appears\n \n     When I clear the selection\n@@ -65,20 +65,15 @@ I click the \'${link_name}\' link\n \n I select all the elements\n     Wait For Condition    Classes    //body    contains    patterns-loaded\n-    Check Checkbox    //*[contains(@class,"pat-structure")]//input[contains(@class,"select-all")]\n-    Sleep    5s\n+    Check Checkbox    //input[@id="selectAllInputCheckbox"]\n \n the four elements got selected\n-    Get Checkbox State      //tr[@data-id="doc1"]//input    should be    True\n-    Get Checkbox State      //tr[@data-id="doc2"]//input    should be    True\n-    Get Checkbox State      //tr[@data-id="doc3"]//input    should be    True\n-    Get Checkbox State      //tr[@data-id="doc4"]//input    should be    True\n+    Wait For Elements State    //tr[@data-id="doc1"]//input    checked    timeout=20s\n+    Wait For Elements State    //tr[@data-id="doc2"]//input    checked    timeout=20s\n+    Wait For Elements State    //tr[@data-id="doc3"]//input    checked    timeout=20s\n+    Wait For Elements State    //tr[@data-id="doc4"]//input    checked    timeout=20s\n \n the selection count appears\n-    Wait For Condition    Checkbox State    //tr[@data-id="doc1"]//input    should be    True\n-    Wait For Condition    Checkbox State    //tr[@data-id="doc2"]//input    should be    True\n-    Wait For Condition    Checkbox State    //tr[@data-id="doc3"]//input    should be    True\n-    Wait For Condition    Checkbox State    //tr[@data-id="doc4"]//input    should be    True\n     Get Text    //*[@id="btn-selected-items"]//*[contains(@class,"label-success")]    should be    4\n \n the clear selection link appears\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-18T09:29:14+02:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/0103d2ec567606324a9c6b46bc84ac9c90e09678

fix for linkintegrity tests

Files changed:
M Products/CMFPlone/tests/robot/test_linkintegrity.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_linkintegrity.robot b/Products/CMFPlone/tests/robot/test_linkintegrity.robot\nindex d84decd51e..7a3db39c17 100644\n--- a/Products/CMFPlone/tests/robot/test_linkintegrity.robot\n+++ b/Products/CMFPlone/tests/robot/test_linkintegrity.robot\n@@ -57,7 +57,7 @@ a page to edit\n # When\n I add a link in rich text\n     Go To    ${PLONE_URL}/bar/edit\n-    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    foo\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <p>foo</p>\n     Mark text foo in tinymce editor\n     Click    //button[@aria-label="Insert/edit link"]\n     Click    //div[contains(@class,"linkModal")]//div[contains(@class,"content-browser-selected-items-wrapper")]//button[contains(@class,"btn-primary")]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-18T11:04:04+02:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/da64f665975c17dc2f058a27e7f407ee8fc68edc

refactor folder_contents test "select all the elements"

Files changed:
M Products/CMFPlone/tests/robot/test_folder_contents.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_folder_contents.robot b/Products/CMFPlone/tests/robot/test_folder_contents.robot\nindex 0a9ddc5c3c..dcf33269b6 100644\n--- a/Products/CMFPlone/tests/robot/test_folder_contents.robot\n+++ b/Products/CMFPlone/tests/robot/test_folder_contents.robot\n@@ -17,7 +17,6 @@ Scenario: Select All items\n       and a folder with four pages\n       and the folder contents view\n      When I select all the elements\n-      and the four elements got selected\n      Then the selection count appears\n       and the clear selection link appears\n \n@@ -65,13 +64,14 @@ I click the \'${link_name}\' link\n \n I select all the elements\n     Wait For Condition    Classes    //body    contains    patterns-loaded\n-    Check Checkbox    //input[@id="selectAllInputCheckbox"]\n-\n-the four elements got selected\n-    Wait For Elements State    //tr[@data-id="doc1"]//input    checked    timeout=20s\n-    Wait For Elements State    //tr[@data-id="doc2"]//input    checked    timeout=20s\n-    Wait For Elements State    //tr[@data-id="doc3"]//input    checked    timeout=20s\n-    Wait For Elements State    //tr[@data-id="doc4"]//input    checked    timeout=20s\n+    Check Checkbox    //tr[@data-id="doc1"]//input[@type="checkbox"]\n+    Wait For Elements State     //tr[@data-id="doc1"]//input[@type="checkbox"]    checked    timeout=10s\n+    Check Checkbox    //tr[@data-id="doc2"]//input[@type="checkbox"]\n+    Wait For Elements State     //tr[@data-id="doc2"]//input[@type="checkbox"]    checked    timeout=10s\n+    Check Checkbox    //tr[@data-id="doc3"]//input[@type="checkbox"]\n+    Wait For Elements State     //tr[@data-id="doc3"]//input[@type="checkbox"]    checked    timeout=10s\n+    Check Checkbox    //tr[@data-id="doc4"]//input[@type="checkbox"]\n+    Wait For Elements State     //tr[@data-id="doc4"]//input[@type="checkbox"]    checked    timeout=10s\n \n the selection count appears\n     Get Text    //*[@id="btn-selected-items"]//*[contains(@class,"label-success")]    should be    4\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-18T11:18:26+02:00
Author: Peter Mathis (petschki) <petschki@users.noreply.github.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/0160d899a85b1e22fc9ebd95c1ff8d5659b0c9e5

Merge branch 'master' into port-robot-tests

Files changed:
A news/4031.feature
M Products/CMFPlone/controlpanel/browser/redirects.py
M Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_redirection.py

b'diff --git a/Products/CMFPlone/controlpanel/browser/redirects.py b/Products/CMFPlone/controlpanel/browser/redirects.py\nindex 9ddd6a2f97..25e271028e 100644\n--- a/Products/CMFPlone/controlpanel/browser/redirects.py\n+++ b/Products/CMFPlone/controlpanel/browser/redirects.py\n@@ -164,6 +164,10 @@ def view_url(self):\n \n \n class RedirectionSet:\n+    # Marker so that plone.restapi can detect if this is\n+    # a version that supports the start and end parameters\n+    supports_date_range_filtering = True\n+\n     def __init__(self, query="", created="", manual="", start="", end=""):\n         self.storage = getUtility(IRedirectionStorage)\n \n@@ -172,7 +176,7 @@ def __init__(self, query="", created="", manual="", start="", end=""):\n         self.portal_path_len = len(self.portal_path)\n \n         # noinspection PyProtectedMember\n-        if query:\n+        if query and query.startswith("/"):\n             # with query path /Plone/news:\n             # min_k is /Plone/news and\n             # max_k is /Plone/newt\n@@ -180,6 +184,8 @@ def __init__(self, query="", created="", manual="", start="", end=""):\n             min_k = "{:s}/{:s}".format(self.portal_path, query.strip("/"))\n             max_k = min_k[:-1] + chr(ord(min_k[-1]) + 1)\n             self.data = self.storage._paths.keys(min=min_k, max=max_k, excludemax=True)\n+        elif query:\n+            self.data = [path for path in self.storage._paths.keys() if query in path]\n         else:\n             self.data = self.storage._paths.keys()\n         if manual:\ndiff --git a/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_redirection.py b/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_redirection.py\nindex 8e8d3057ab..51d2d7fb2d 100644\n--- a/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_redirection.py\n+++ b/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_redirection.py\n@@ -241,6 +241,9 @@ def test_redirection_controlpanel_filtering(self):\n         # this should return one and not two (we need excludemax=True)\n         redirects = RedirectionSet(query="/foo1/777")\n         self.assertEqual(len(redirects), 1)\n+        # query without an initial slash matches any substring\n+        redirects = RedirectionSet(query="999")\n+        self.assertEqual(len(redirects), 2)\n \n         request = self.layer["request"].clone()\n         request.form["q"] = "/foo"\ndiff --git a/news/4031.feature b/news/4031.feature\nnew file mode 100644\nindex 0000000000..767054e50c\n--- /dev/null\n+++ b/news/4031.feature\n@@ -0,0 +1 @@\n+URL Management control panel: Find substring matches when querying aliases. @davisagli\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-18T12:12:07+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/a6bc5eb0f889de4f45d61cb422c5ac1ed43d1fb9

add robot test select widget, migrated from plone.app.widgets

Files changed:
A Products/CMFPlone/tests/robot/test_select_widget.robot
M Products/CMFPlone/testing.py
M Products/CMFPlone/tests/configure.zcml

b'diff --git a/Products/CMFPlone/testing.py b/Products/CMFPlone/testing.py\nindex 63f65ce3b9..e65abac85a 100644\n--- a/Products/CMFPlone/testing.py\n+++ b/Products/CMFPlone/testing.py\n@@ -17,6 +17,13 @@\n from Products.MailHost.interfaces import IMailHost\n from zope.component import getSiteManager\n from zope.configuration import xmlconfig\n+from plone.autoform.form import AutoExtensibleForm\n+from plone.app.z3cform.widget import SelectWidget\n+from plone.autoform import directives\n+from z3c.form import form\n+from zope.schema import Choice\n+from zope.schema import List\n+from zope.interface import Interface\n \n import doctest\n \n@@ -115,3 +122,24 @@ def setUpPloneSite(self, portal):\n )\n \n optionflags = doctest.ELLIPSIS | doctest.NORMALIZE_WHITESPACE\n+\n+\n+class ITestSelectWidgetSchema(Interface):\n+\n+    directives.widget(\'select_field\', SelectWidget)\n+    select_field = Choice(\n+        title=u\'Select Widget\',\n+        values=[\'one\', \'two\', \'three\', ]\n+    )\n+\n+    directives.widget(\'list_field\', SelectWidget)\n+    list_field = List(\n+        title=u\'Select Multiple Widget\',\n+        value_type=Choice(values=[\'four\', \'five\', \'six\', ]),\n+    )\n+\n+\n+class TestSelectWidgetForm(AutoExtensibleForm, form.EditForm):\n+\n+    schema = ITestSelectWidgetSchema\n+    ignoreContext = True\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/configure.zcml b/Products/CMFPlone/tests/configure.zcml\nindex 29f6057348..1c0e6d0f69 100644\n--- a/Products/CMFPlone/tests/configure.zcml\n+++ b/Products/CMFPlone/tests/configure.zcml\n@@ -13,4 +13,11 @@\n       permission="zope2.View"\n       />\n \n+    <browser:page\n+    for="*"\n+    name="select-widget-view"\n+    class="..testing.TestSelectWidgetForm"\n+    permission="zope2.View"\n+    />\n+\n </configure>\ndiff --git a/Products/CMFPlone/tests/robot/test_select_widget.robot b/Products/CMFPlone/tests/robot/test_select_widget.robot\nnew file mode 100644\nindex 0000000000..1b00374205\n--- /dev/null\n+++ b/Products/CMFPlone/tests/robot/test_select_widget.robot\n@@ -0,0 +1,120 @@\n+*** Settings ***\n+\n+Resource  plone/app/robotframework/browser.robot\n+\n+Library  Remote  ${PLONE_URL}/RobotRemote\n+\n+Resource  keywords.robot\n+\n+Test Setup  Run keywords  Plone Test Setup\n+Test Teardown  Run keywords  Plone Test Teardown\n+\n+\n+*** Variables ***\n+\n+${mockup_bootstrap_class}    pat-select2\n+\n+${select_field_name}    form.widgets.select_field\n+${list_field_name}    form.widgets.list_field\n+\n+${input_search}    //div[@id="select2-drop"]//div[contains(@class,"select2-search")]//input\n+${dropdown_multiple}    css=.select2-choices\n+${dropdown_select}    //a[@class="select2-choice"]\n+${results_label}    css=.select2-result-label\n+\n+\n+*** Test Cases ***\n+\n+Scenario: The Select Widget has the class that bootstraps mockup JS\n+    Given a form\n+     Then the input fields have the mockup class\n+\n+Scenario: The Select Widget allows to select a single value\n+    Given a logged-in member\n+      and a form\n+     When I select the option  3\n+     Then the widget shows the element  three\n+\n+Scenario: The Select Widget autocomplete function works\n+    Given a logged-in member\n+      and a form\n+     When I type on the autocomplete field  wo\n+     Then the widget shows the element  two\n+\n+The Select Multiple Widget allows to select multiple values\n+    Given a logged-in member\n+      and a form\n+     When I click on the element  2\n+      And I click on the element  1\n+     Then the widget shows two elements    five    four\n+\n+Scenario: The Select Multiple Widget autocomplete function works\n+    Given a logged-in member\n+      and a form\n+     When I type on the multiple autocomplete field    s\n+     Then the widget shows one element    six\n+\n+\n+*** Keywords ***\n+\n+# Given\n+\n+a form\n+  Go to    ${PLONE_URL}/@@select-widget-view\n+\n+# When\n+\n+\n+I select the option\n+    [Arguments]  ${index}\n+    Wait For Elements State    ${dropdown_select}    visible    timeout=2 s\n+    Open Dropdown    ${dropdown_select}    ${input_search}\n+    Click    css=li.select2-results-dept-0:nth-child(${index})\n+\n+I type on the autocomplete field\n+    [Arguments]    ${text}\n+    Wait For Elements State    ${dropdown_select}    visible    timeout=2 s\n+    Open Dropdown    ${dropdown_select}    ${input_search}\n+    Type Text    ${input_search}    ${text}\n+    Click    ${results_label}\n+\n+I click on the element\n+    [Arguments]  ${index}\n+    Wait For Elements State    ${dropdown_multiple}    visible    timeout=2 s\n+    Open Dropdown    ${dropdown_multiple}    ${dropdown_multiple}\n+    Focus    css=li.select2-results-dept-0:nth-child(${index})\n+    Click    css=li.select2-results-dept-0:nth-child(${index})\n+\n+I type on the multiple autocomplete field\n+    [Arguments]    ${text}\n+    Wait For Elements State    ${dropdown_multiple}    visible    timeout=2 s\n+    Click    //ul[@class="select2-choices"]\n+    Type Text  css=.select2-input.select2-focused  ${text}\n+    Keyboard Key    press    Enter\n+\n+# Then\n+\n+the input fields have the mockup class\n+    Get Classes    //select[@name="${select_field_name}"]    contains    ${mockup_bootstrap_class}\n+    Get Classes    //select[@name="${list_field_name}"]    contains    ${mockup_bootstrap_class}\n+\n+the widget shows the element\n+    [Arguments]    ${text}\n+    Get Text    css=.select2-chosen    should be    ${text}    messsage=${text} seems to not be selected\n+\n+\n+the widget shows two elements\n+    [Arguments]  ${first_string}  ${second_string}\n+    Get Text    li.select2-search-choice:nth-child(1) > div:nth-child(1)    contains    ${first_string}\n+    Get Text    li.select2-search-choice:nth-child(2) > div:nth-child(1)    contains    ${second_string}\n+\n+the widget shows one element\n+    [Arguments]    ${string}\n+    Get Text    li.select2-search-choice:nth-child(1) > div:nth-child(1)    contains    ${string}\n+\n+# dry\n+\n+Open Dropdown\n+    [Arguments]    ${locator}    ${validaton}\n+    Click    ${locator}\n+    Wait For Elements State    ${validaton}    visible    timeout=2 s    message=The dropdown did not show up at location ${validaton}\n\\ No newline at end of file\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-18T12:26:49+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/9fc4c2fb80870c719884a8fa9d11030183fc6515

set download path in test to current directory, don't use global /tmp

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot b/Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot\nindex 0ab19f02de..037cea873f 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot\n@@ -97,7 +97,7 @@ I can download all redirects as CSV\n \n     Import library    OperatingSystem\n \n-    ${dl_promise}    Promise To Wait For Download    saveAs=/tmp/redirections.csv\n+    ${dl_promise}    Promise To Wait For Download    saveAs=redirections.csv\n     Click    //button[@name="form.button.Download"]\n     ${file_obj}=    Wait For    ${dl_promise}\n     File Should Exist    ${file_obj}[saveAs]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-18T16:05:23+02:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/f086f0d04b8959cfef52294e90ab87d99d7a37c7

wait for filled text in tinymce

Files changed:
M Products/CMFPlone/tests/robot/keywords.robot

b'diff --git a/Products/CMFPlone/tests/robot/keywords.robot b/Products/CMFPlone/tests/robot/keywords.robot\nindex fc83e57593..08d5f92bd7 100644\n--- a/Products/CMFPlone/tests/robot/keywords.robot\n+++ b/Products/CMFPlone/tests/robot/keywords.robot\n@@ -82,7 +82,7 @@ Fill text to tinymce editor\n     ...    }\n     ...    all_elements=False\n \n-    Sleep    0.5\n+    Sleep    2s\n \n     ${check}=    Evaluate JavaScript    //textarea[@name="${attr_name}"]\n     ...    (elem) => {\n@@ -95,4 +95,4 @@ Fill text to tinymce editor\n \n Pause\n    Import library    Dialogs\n-   Pause execution\n\\ No newline at end of file\n+   Pause execution\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-18T18:04:13+02:00
Author: 1letter (1letter) <1letter@gmx.de>
Commit: https://github.com/plone/Products.CMFPlone/commit/ee75f44c003e6931d8e92e8df8cc587eb6b63d05

fix text - wait for patterns loaded

Files changed:
M Products/CMFPlone/tests/robot/test_controlpanel_editing.robot

b'diff --git a/Products/CMFPlone/tests/robot/test_controlpanel_editing.robot b/Products/CMFPlone/tests/robot/test_controlpanel_editing.robot\nindex 132b75c494..66ac2ed25f 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_editing.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_editing.robot\n@@ -90,12 +90,14 @@ I edit the document\n \n I do not see the standard editor when I create a document\n     Go To  ${PLONE_URL}/++add++Document\n+    Wait For Condition    Classes    //body    contains    patterns-loaded\n     Get Element Count    //*[@id="formfield-form-widgets-IRichTextBehavior-text"]/div[@role="application"]    should be    0\n     Get Element States    //textarea[@name="form.widgets.IRichTextBehavior.text"]    contains    visible\n \n \n I see the standard editor when I create a document\n     Go To  ${PLONE_URL}/++add++Document\n+    Wait For Condition    Classes    //body    contains    patterns-loaded\n     Get Element Count    //*[@id="formfield-form-widgets-IRichTextBehavior-text"]/div[@role="application"]    should be    1\n     Get Element States    //textarea[@name="form.widgets.IRichTextBehavior.text"]    contains    hidden\n \n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-18T23:37:47+02:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/0c233728a05d202956f4b3df504df54d69464083

change tinymce text fill strategy

Files changed:
M Products/CMFPlone/tests/robot/keywords.robot
M Products/CMFPlone/tests/robot/test_controlpanel_filter.robot

b'diff --git a/Products/CMFPlone/tests/robot/keywords.robot b/Products/CMFPlone/tests/robot/keywords.robot\nindex 08d5f92bd7..2cb187d473 100644\n--- a/Products/CMFPlone/tests/robot/keywords.robot\n+++ b/Products/CMFPlone/tests/robot/keywords.robot\n@@ -76,17 +76,12 @@ Fill text to tinymce editor\n \n     Sleep    1\n \n-    Evaluate JavaScript    //textarea[@name="${attr_name}"]\n-    ...    (elem, text) => {\n-    ...        elem["pattern-tinymce"].instance.tiny.setContent(\'${input}\');\n-    ...    }\n-    ...    all_elements=False\n-\n-    Sleep    2s\n-\n     ${check}=    Evaluate JavaScript    //textarea[@name="${attr_name}"]\n-    ...    (elem) => {\n-    ...        return elem["pattern-tinymce"].instance.tiny.getContent();\n+    ...    (elem, text) => {\n+    ...        const tiny = window.tinymce.get(elem.getAttribute("id"));\n+    ...        let input_text = "";\n+    ...        tiny.setContent(\'${input}\');\n+    ...        return tiny.getContent();\n     ...    }\n     ...    all_elements=False\n \ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot b/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot\nindex aa5c60f1be..9d48ebb955 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot\n@@ -144,9 +144,9 @@ success message should contain information regarding caching\n Mark text heading as h1 in tinymce editor\n \n     # select the text `heading` via javascript\n-    Evaluate JavaScript    ${None}\n-    ...    () => {\n-    ...        let iframe_document = document.querySelector(".tox-edit-area iframe").contentDocument;\n+    Evaluate JavaScript    //div[contains(@class, \'tox-edit-area\')]//iframe\n+    ...    (elem, args) => {\n+    ...        let iframe_document = elem.contentDocument;\n     ...        let body = iframe_document.body;\n     ...        let p = body.firstChild;\n     ...        let range = new Range();\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-10-19T01:00:34+02:00
Author: Peter Mathis (petschki) <petschki@users.noreply.github.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/a840a70e46f8d217ba1fa2de818b463880a705c8

Merge pull request #4019 from plone/port-robot-tests

Port robot tests

Files changed:
A Products/CMFPlone/tests/robot/test_select_widget.robot
A news/3980.1.feature
M Products/CMFPlone/testing.py
M Products/CMFPlone/tests/configure.zcml
M Products/CMFPlone/tests/robot/keywords.robot
M Products/CMFPlone/tests/robot/test_actionmenu.robot
M Products/CMFPlone/tests/robot/test_contentbrowser.robot
M Products/CMFPlone/tests/robot/test_controlpanel_actions.robot
M Products/CMFPlone/tests/robot/test_controlpanel_editing.robot
M Products/CMFPlone/tests/robot/test_controlpanel_filter.robot
M Products/CMFPlone/tests/robot/test_controlpanel_language.robot
M Products/CMFPlone/tests/robot/test_controlpanel_markup.robot
M Products/CMFPlone/tests/robot/test_controlpanel_navigation.robot
M Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot
M Products/CMFPlone/tests/robot/test_controlpanel_search.robot
M Products/CMFPlone/tests/robot/test_controlpanel_security.robot
M Products/CMFPlone/tests/robot/test_controlpanel_site.robot
M Products/CMFPlone/tests/robot/test_controlpanel_social.robot
M Products/CMFPlone/tests/robot/test_controlpanel_types.robot
M Products/CMFPlone/tests/robot/test_controlpanel_usergroups.robot
M Products/CMFPlone/tests/robot/test_edit.robot
M Products/CMFPlone/tests/robot/test_edit_user_schema.robot
M Products/CMFPlone/tests/robot/test_folder_contents.robot
M Products/CMFPlone/tests/robot/test_linkintegrity.robot
M Products/CMFPlone/tests/robot/test_livesearch.robot
M Products/CMFPlone/tests/robot/test_overlays.robot
M Products/CMFPlone/tests/robot/test_portlets.robot
M Products/CMFPlone/tests/robot/test_querystring.robot
M Products/CMFPlone/tests/robot/test_tinymce.robot
D Products/CMFPlone/tests/robot/common.robot
D Products/CMFPlone/tests/robot/robodoc/README.rst
D Products/CMFPlone/tests/robot/robodoc/TODO.rst
D Products/CMFPlone/tests/robot/robodoc/anonymous.robot
D Products/CMFPlone/tests/robot/robodoc/collaboration-advanced_control.robot
D Products/CMFPlone/tests/robot/robodoc/collaboration.robot
D Products/CMFPlone/tests/robot/robodoc/common.robot
D Products/CMFPlone/tests/robot/robodoc/config-screens.robot
D Products/CMFPlone/tests/robot/robodoc/content.robot
D Products/CMFPlone/tests/robot/robodoc/managing-working_copy.robot
D Products/CMFPlone/tests/robot/robodoc/managing_content.robot
D Products/CMFPlone/tests/robot/robodoc/personalsettings.robot
D Products/CMFPlone/tests/robot/robodoc/working_with_tinymce.robot

b'diff --git a/Products/CMFPlone/testing.py b/Products/CMFPlone/testing.py\nindex 63f65ce3b9..e65abac85a 100644\n--- a/Products/CMFPlone/testing.py\n+++ b/Products/CMFPlone/testing.py\n@@ -17,6 +17,13 @@\n from Products.MailHost.interfaces import IMailHost\n from zope.component import getSiteManager\n from zope.configuration import xmlconfig\n+from plone.autoform.form import AutoExtensibleForm\n+from plone.app.z3cform.widget import SelectWidget\n+from plone.autoform import directives\n+from z3c.form import form\n+from zope.schema import Choice\n+from zope.schema import List\n+from zope.interface import Interface\n \n import doctest\n \n@@ -115,3 +122,24 @@ def setUpPloneSite(self, portal):\n )\n \n optionflags = doctest.ELLIPSIS | doctest.NORMALIZE_WHITESPACE\n+\n+\n+class ITestSelectWidgetSchema(Interface):\n+\n+    directives.widget(\'select_field\', SelectWidget)\n+    select_field = Choice(\n+        title=u\'Select Widget\',\n+        values=[\'one\', \'two\', \'three\', ]\n+    )\n+\n+    directives.widget(\'list_field\', SelectWidget)\n+    list_field = List(\n+        title=u\'Select Multiple Widget\',\n+        value_type=Choice(values=[\'four\', \'five\', \'six\', ]),\n+    )\n+\n+\n+class TestSelectWidgetForm(AutoExtensibleForm, form.EditForm):\n+\n+    schema = ITestSelectWidgetSchema\n+    ignoreContext = True\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/configure.zcml b/Products/CMFPlone/tests/configure.zcml\nindex 29f6057348..1c0e6d0f69 100644\n--- a/Products/CMFPlone/tests/configure.zcml\n+++ b/Products/CMFPlone/tests/configure.zcml\n@@ -13,4 +13,11 @@\n       permission="zope2.View"\n       />\n \n+    <browser:page\n+    for="*"\n+    name="select-widget-view"\n+    class="..testing.TestSelectWidgetForm"\n+    permission="zope2.View"\n+    />\n+\n </configure>\ndiff --git a/Products/CMFPlone/tests/robot/common.robot b/Products/CMFPlone/tests/robot/common.robot\ndeleted file mode 100644\nindex 33791aa6dc..0000000000\n--- a/Products/CMFPlone/tests/robot/common.robot\n+++ /dev/null\n@@ -1,69 +0,0 @@\n-*** Settings ***\n-\n-Resource  plone/app/robotframework/variables.robot\n-\n-Library  Remote  ${PLONE_URL}/RobotRemote\n-\n-*** Variables ***\n-\n-${TEST_FOLDER}  test-folder\n-\n-*** Keywords ***\n-\n-a document\n-    [Arguments]  ${title}\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}/++add++Document\n-    Given patterns are loaded\n-    Execute Javascript  $(\'#form-widgets-IDublinCore-title\').val(\'${title}\'); return 0;\n-    Click Button  Save\n-\n-a folder\n-    [Arguments]  ${title}\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}/++add++Folder\n-    Given patterns are loaded\n-    Execute Javascript  $(\'#form-widgets-IDublinCore-title\').val(\'${title}\'); return 0;\n-    Click Button  Save\n-\n-a folder \'${foldername}\' with a document \'${documentname}\'\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}/++add++Folder\n-    Given patterns are loaded\n-    Execute Javascript  $(\'#form-widgets-IDublinCore-title\').val(\'${foldername}\'); return 0;\n-    Click Button  Save\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}/folder/edit\n-    Given patterns are loaded\n-    Execute Javascript  $(\'#form-widgets-IDublinCore-title\').val(\'${documentname}\'); return 0;\n-    Click Button  Save\n-\n-a collection\n-    [Arguments]  ${title}\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}/++add++Collection\n-    Given patterns are loaded\n-    Execute Javascript  $(\'#form-widgets-IDublinCore-title\').val(\'${title}\'); return 0;\n-    Click Button  Save\n-\n-a site owner\n-    Log in as site owner\n-\n-the site root\n-    Go to  ${PLONE_URL}\n-\n-a test folder\n-    Go to  ${PLONE_URL}/++add++Folder\n-    Given patterns are loaded\n-    Execute Javascript  $(\'#form-widgets-IDublinCore-title\').val(\'Test Folder\'); return 0;\n-    Click Button  Save\n-\n-the test folder\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}\n-\n-there should be \'${count}\' livesearch results\n-    Wait until keyword succeeds  5s  1s  Element Should Be Visible  css=div#LSResult\n-    Wait until keyword succeeds  5s  1s  Xpath Should Match X Times  //div[@id = \'LSResult\']/descendant::li  ${count}\n-\n-patterns are loaded\n-    Wait For Condition  return !!document.querySelector(\'body.patterns-loaded\')\n-\n-Refresh JS/CSS resources\n-    # Not needed anymore, and it is breaking the Plone Zope 4 tests.\n-    # Keep the keyword for backwards compatibility purposes.\n-    Sleep  0.0000001\ndiff --git a/Products/CMFPlone/tests/robot/keywords.robot b/Products/CMFPlone/tests/robot/keywords.robot\nindex ca0c598c4b..2cb187d473 100644\n--- a/Products/CMFPlone/tests/robot/keywords.robot\n+++ b/Products/CMFPlone/tests/robot/keywords.robot\n@@ -1,39 +1,93 @@\n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n-# --- SETUP ------------------------------------------------------------------\n+# SETUP\n \n Refresh JS/CSS resources\n   # Not needed anymore, and it is breaking the Plone Zope 4 tests.\n   # Keep the keyword for backwards compatibility purposes.\n   Sleep  0.0000001\n \n-# --- GIVEN ------------------------------------------------------------------\n+# GIVEN\n+\n+a logged-in manager\n+    Enable autologin as\n+    ...    Manager\n+\n+a logged-in member\n+    Enable autologin as\n+    ...    Member\n \n a logged-in site administrator\n-  Enable autologin as  Site Administrator  Contributor  Reviewer\n+    Enable autologin as\n+    ...    Site Administrator\n+    ...    Contributor\n+    ...    Reviewer\n+\n \n a document \'${title}\'\n-  Create content  type=Document  id=doc  title=${title}\n+    Create content\n+    ...    type=Document\n+    ...    id=doc\n+    ...    title=${title}\n \n a file \'${title}\'\n-  Create content  type=File  id=file  title=${title}\n+    Create content\n+    ...    type=File\n+    ...    id=file\n+    ...    title=${title}\n \n a news item \'${title}\'\n-  Create content  type=News Item  id=doc  title=${title}\n+    Create content\n+    ...    type=News Item\n+    ...    id=doc\n+    ...    title=${title}\n \n an image \'${title}\'\n-  Create content  type=Image  id=doc  title=${title}\n+    Create content\n+    ...    type=Image\n+    ...    id=doc\n+    ...    title=${title}\n \n a folder \'${title}\'\n-  Create content  type=Folder  title=${title}\n-\n-patterns are loaded\n-  Wait For Condition  return !!document.querySelector(\'body.patterns-loaded\')\n+    Create content\n+    ...    type=Folder\n+    ...    title=${title}\n \n a folder with a document \'${title}\'\n-  ${folder_uid}=  Create content  type=Folder  title=folder\n-  Create content  type=Document  container=${folder_uid}  title=${title}\n+    ${folder_uid}=    Create content    type=Folder    title=folder\n+    Create content\n+    ...    type=Document\n+    ...    container=${folder_uid}\n+    ...    title=${title}\n+\n+Remove line from textarea\n+    [Arguments]    ${fieldName}    ${value}\n+\n+    Import library    String\n+    ${lines}=  Get Text    //textarea[@name="${fieldName}"]\n+    ${lines}=  Remove String    ${lines}    ${value}\\n\n+    Type Text    //textarea[@name="${fieldName}"]    ${lines}\n+\n+\n+Fill text to tinymce editor\n+    [Arguments]    ${attr_name}    ${input}\n+\n+    Wait For Condition    Attribute    //body    class    contains    patterns-loaded\n+\n+    Sleep    1\n+\n+    ${check}=    Evaluate JavaScript    //textarea[@name="${attr_name}"]\n+    ...    (elem, text) => {\n+    ...        const tiny = window.tinymce.get(elem.getAttribute("id"));\n+    ...        let input_text = "";\n+    ...        tiny.setContent(\'${input}\');\n+    ...        return tiny.getContent();\n+    ...    }\n+    ...    all_elements=False\n+\n+    Should not be empty    ${check}\n+\n \n-folder contents pattern loaded\n-    Page should contain element  css=.pat-structure\n-    Wait For Condition  return !!document.querySelector(\'.pat-structure div.navbar\')\n+Pause\n+   Import library    Dialogs\n+   Pause execution\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/README.rst b/Products/CMFPlone/tests/robot/robodoc/README.rst\ndeleted file mode 100644\nindex d25585bf30..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/README.rst\n+++ /dev/null\n@@ -1,85 +0,0 @@\n-==============\n-ROBODOC README\n-==============\n-\n-The ``robodoc`` folder contains Robot Framework tests moved from the Plone documentation project.\n-Because they are designed to be run as test suite level stories (sandbox is cleared only when changing a robot file),\n-they are not integrated with zope.testrunner (``./bin/test``), but are designed to be run with Robot Framework test runner (``pybot``).\n-\n-\n-Installing Robot Framework\n-==========================\n-\n-Most tools needed to run the tests and generate the screenshots are available from within a standard Plone buildout.coredev environment.\n-The only extra piece of software needed is `webdriver` for your operating system and browser of choice, and that browser.\n-\n-Minimal buildout to generate a good enough Robot Framework test runner would look like the following:\n-\n-.. code:: ini\n-\n-   [buildout]\n-   extends = https://dist.plone.org/release/5-latest/versions.cfg\n-   parts = robot\n-\n-   [robot]\n-   recipe = zc.recipe.egg\n-   eggs =\n-       Plone\n-       Pillow\n-       robotframework-selenium2screenshots\n-       plone.app.robotframework [debug]\n-\n-\n-Running the tests\n-=================\n-\n-There are two possible ways to run the tests.\n-\n-The first option is to run them with a single command:\n-\n-.. code:: bash\n-\n-   $ bin/pybot -v BROWSER:phantomjs src/Products.CMFPlone/Products/CMFPlone/tests/robot/robodoc/collaboration-advanced_control.robot\n-\n-This command will 1) start up a Plone site, 2) run the defined test suite and 3) shut down the Plone site. It will take some time.\n-``-v BROWSER:phantomjs`` is optional, and will define a Robot Framework variable named ``BROWSER`` with value ``phantomjs``, effectively running the test suite using headless PhantomJS browser.\n-\n-You can run multiple test suites in the same directory,\n-\n-.. code:: bash\n-\n-   $ bin/pybot -v BROWSER:phantomjs src/Products.CMFPlone/Products/CMFPlone/tests/robot/robodoc\n-\n-will run all tests and generate all screenshots.\n-\n-The second option is to first start a robot server and only then, in parallel, to execute the desired test suite:\n-\n-.. code:: bash\n-\n-   $\xc2\xa0APPLY_PROFILES=plone.app.contenttypes:plone-content bin/robot-server plone.app.robotframework.PLONE_ROBOT_TESTING\n-\n-or\n-\n-.. code:: bash\n-\n-   $\xc2\xa0CONFIGURE_PACKAGES=plone.app.iterate APPLY_PROFILES=plone.app.contenttypes:plone-content,plone.app.iterate:default bin/robot-server plone.app.robotframework.PLONE_ROBOT_TESTING\n-\n-and\n-\n-   $ bin/pybot -v ROBOT_SERVER:True -v BROWSER:phantomjs src/Products.CMFPlone/Products/CMFPlone/tests/robot/robodoc/screenshot-tall/collaboration-advanced_control.robot\n-\n-This option will be faster for subsequent runs.\n-\n-Environment variable ``APPLY_PROFILES`` can be set to a comma separated list of Generic Setup profiles and is used by the very special test fixture ``PLONE_ROBOT_TESTING`` to prepare a Plone site with those profiles installed. There\'s also an another special variable ``CONFIGURE_PACKAGES`` that can be set to a comma separated list of package names (e.g. to ``plone.app.iterate``) to configure more profiles to be available for ``APPLY_PROFILES``.\n-\n-A special variable ``ROBOT_SERVER:True`` must be set for Robot Framework test runner to fix the test suite to be aware of being executed against long-running robot server.\n-\n-Screenshots for documentation\n-=============================\n-\n-The screenshots are meant for the Plone documentation.\n-\n-As there are still browser bugs, it is good to visually inspect them before they are uploaded in the repository\n-https://github.com/plone/documentation-roboshots\n-\n-In there, the tagged releases should contain known-good-sets of screenshots for a particular Plone version.\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/TODO.rst b/Products/CMFPlone/tests/robot/robodoc/TODO.rst\ndeleted file mode 100644\nindex f6136f2724..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/TODO.rst\n+++ /dev/null\n@@ -1,10 +0,0 @@\n-Browser and webdriver support\n------------------------------\n-\n-2017-07-20:\n-\n-Ubuntu 16.04:\n-\n-- Phantomjs works well, but has issues with iframes. The `working_with_tinymce.robot` tests have visual errors in the screenshots.\n-- Chrome 59 with chromedriver has issues, reportedly Chrome 60 should be better, and be able to do headless screenshots.\n-- Firefox 54 does not work with the current geckodriver software for Linux.\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/anonymous.robot b/Products/CMFPlone/tests/robot/robodoc/anonymous.robot\ndeleted file mode 100644\nindex 89cb4c1c16..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/anonymous.robot\n+++ /dev/null\n@@ -1,96 +0,0 @@\n-*** Settings ***\n-\n-Resource  plone/app/robotframework/keywords.robot\n-Resource  Selenium2Screenshots/keywords.robot\n-\n-Library  plone.app.robotframework.Zope2Server\n-Library  OperatingSystem\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-*** Variables ***\n-\n-${FIXTURE}  plone.app.robotframework.PLONE_ROBOT_TESTING\n-@{CONFIGURE_PACKAGES}\n-@{APPLY_PROFILES}  plone.app.contenttypes:plone-content\n-@{DIMENSIONS}  1024  768\n-${ROBOT_SERVER}  False\n-\n-*** Keywords ***\n-\n-Common Suite Setup\n-    Run keyword if  ${ROBOT_SERVER}  Setup Plone keywords\n-    Run keyword if  ${ROBOT_SERVER}  Remote ZODB setup  ${FIXTURE}\n-    Run keyword if  not ${ROBOT_SERVER}  Setup Plone site  ${FIXTURE}\n-    Run keyword if  not ${ROBOT_SERVER}  ZODB setup  ${FIXTURE}\n-\n-    ${language} =  Get environment variable  LANGUAGE  \'en\'\n-    Set default language  ${language}\n-\n-    Open test browser\n-    Run keyword and ignore error  Set window size  @{DIMENSIONS}\n-\n-Common Suite Teardown\n-    Close all browsers\n-    Run keyword if  ${ROBOT_SERVER}  Remote ZODB TearDown  ${FIXTURE}\n-    Run keyword if  not ${ROBOT_SERVER}  ZODB TearDown  ${FIXTURE}\n-    Run keyword if  not ${ROBOT_SERVER}  Teardown Plone site\n-\n-Setup Plone site\n-    [Arguments]  ${zope_layer_dotted_name}\n-    Start Zope server  ${zope_layer_dotted_name}\n-    Wait until keyword succeeds  2min  0s  Setup Plone keywords\n-\n-Setup Plone keywords\n-    Import library  Remote  ${PLONE_URL}/RobotRemote\n-\n-Teardown Plone site\n-    Close all browsers\n-    Stop Zope server\n-\n-Highlight link\n-    [Arguments]  ${locator}\n-    Update element style  ${locator}  padding  0.5em\n-    Highlight  ${locator}\n-\n-\n-*** Test Cases ***\n-\n-Take login link screenshot\n-    Go to  ${PLONE_URL}\n-    Highlight link  css=#personaltools-login\n-    Capture and crop page screenshot\n-    ...    ${CURDIR}/_robot/login-link.png\n-    ...    css=#content-header\n-    ...    css=#above-content-wrapper\n-\n-\n-Take login screenshot\n-    Go to  ${PLONE_URL}/login\n-    Capture and crop page screenshot\n-    ...    ${CURDIR}/_robot/login-popup.png\n-    ...    css=#content-core\n-\n-Take annotated screenshot\n-    Go to  ${PLONE_URL}\n-    Highlight link  css=#personaltools-login\n-    Capture and crop page screenshot\n-    ...    ${CURDIR}/_robot/anonymous-surfing.png\n-    ...    css=#content-header\n-    ...    css=#above-content-wrapper\n-\n-    Enable autologin as  Manager\n-    ${user_id} =  Translate  user_id\n-    ...  default=jane-doe\n-    ${user_fullname} =  Translate  user_fullname\n-    ...  default=Jane Doe\n-    Create user  ${user_id}  Member  fullname=${user_fullname}\n-    Set autologin username  ${user_id}\n-\n-Take logged in screenshot\n-    Go to  ${PLONE_URL}\n-    Capture and crop page screenshot\n-    ...    ${CURDIR}/_robot/loggedin-surfing.png\n-    ...    css=#above-content-wrapper\n-    ...    css=div.plone-toolbar-container\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/collaboration-advanced_control.robot b/Products/CMFPlone/tests/robot/robodoc/collaboration-advanced_control.robot\ndeleted file mode 100644\nindex a81141374d..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/collaboration-advanced_control.robot\n+++ /dev/null\n@@ -1,44 +0,0 @@\n-*** Settings ***\n-\n-Resource  common.robot\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-*** Variables ***\n-\n-@{DIMENSIONS}  1024  1200\n-\n-*** Test Cases ***\n-\n-Create sample content\n-    Go to  ${PLONE_URL}\n-    Capture page screenshot\n-\n-    ${item} =  Create content  type=Folder\n-    ...  id=documentation  title=Documentation\n-    ...  description=Here you can find the documentation on our new product\n-\n-Show state menu\n-    Go to  ${PLONE_URL}/documentation\n-\n-    Click link  css=#plone-contentmenu-workflow a\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-workflow li.plone-toolbar-submenu-header\n-\n-    Mouse over  workflow-transition-advanced\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/workflow-advanced-menu.png\n-    ...  css=#content-header\n-    ...  css=div.plone-toolbar-container\n-\n-    Click link  workflow-transition-advanced\n-    Wait until element is visible\n-    ...   css=div.modal-content\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/workflow-advanced.png\n-    ...  css=div.modal-wrapper\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/collaboration.robot b/Products/CMFPlone/tests/robot/robodoc/collaboration.robot\ndeleted file mode 100644\nindex 32508a142a..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/collaboration.robot\n+++ /dev/null\n@@ -1,92 +0,0 @@\n-*** Settings ***\n-\n-Resource  common.robot\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-*** Variables ***\n-\n-@{DIMENSIONS}  1280  1600\n-\n-*** Test Cases ***\n-\n-Create sample content\n-    Go to  ${PLONE_URL}\n-\n-    ${item} =  Create content  type=Document\n-    ...  id=samplepage  title=Sample Page\n-    ...  description=The long wait is now over\n-    ...  text=<p>Our new site is built with Plone.</p>\n-\n-\n-Show state menu\n-    Go to  ${PLONE_URL}/samplepage\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-workflow\n-    Click element  css=span.icon-plone-contentmenu-workflow\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-workflow li.plone-toolbar-submenu-header\n-\n-    Mouse over  workflow-transition-publish\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/workflow-basic.png\n-            ...  css=#content-header\n-            ...  css=div.plone-toolbar-container\n-\n-Show sendback\n-    Go to  ${PLONE_URL}/samplepage\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-workflow\n-    Click element  css=span.icon-plone-contentmenu-workflow\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-workflow li.plone-toolbar-submenu-header\n-\n-    click link  workflow-transition-submit\n-\n-    Go to  ${PLONE_URL}/samplepage\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-workflow\n-    Click element  css=span.icon-plone-contentmenu-workflow\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-workflow li.plone-toolbar-submenu-header\n-\n-    Mouse over  workflow-transition-reject\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/workflow-reject.png\n-            ...  css=#content-header\n-            ...  css=div.plone-toolbar-container\n-\n-Create sample folder\n-    Go to  ${PLONE_URL}\n-\n-    ${item} =  Create content  type=Folder\n-    ...  id=documentation  title=Documentation\n-    ...  description=Here you can find the documentation on our new product\n-\n-Show sharing menu\n-\n-    Go to  ${PLONE_URL}/documentation\n-\n-    Click link  css=#contentview-local_roles a\n-\n-    Wait until element is visible\n-    ...  css=#user-group-sharing-container\n-\n-    Update element style  portal-footer  display  none\n-\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/sharing-menu.png\n-            ...  css=#content-header\n-            ...  css=div.plone-toolbar-container\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/common.robot b/Products/CMFPlone/tests/robot/robodoc/common.robot\ndeleted file mode 100644\nindex 7c2a33733b..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/common.robot\n+++ /dev/null\n@@ -1,55 +0,0 @@\n-*** Settings ***\n-\n-Resource  plone/app/robotframework/keywords.robot\n-Resource  Selenium2Screenshots/keywords.robot\n-\n-Library  plone.app.robotframework.Zope2Server\n-Library  OperatingSystem\n-\n-*** Variables ***\n-\n-${FIXTURE}  plone.app.robotframework.PLONE_ROBOT_TESTING\n-@{CONFIGURE_PACKAGES}\n-@{APPLY_PROFILES}  plone.app.contenttypes:plone-content\n-@{DIMENSIONS}  1024  768\n-${ROBOT_SERVER}  False\n-\n-*** Keywords ***\n-\n-Common Suite Setup\n-    Run keyword if  ${ROBOT_SERVER}  Setup Plone keywords\n-    Run keyword if  ${ROBOT_SERVER}  Remote ZODB setup  ${FIXTURE}\n-    Run keyword if  not ${ROBOT_SERVER}  Setup Plone site  ${FIXTURE}\n-    Run keyword if  not ${ROBOT_SERVER}  ZODB setup  ${FIXTURE}\n-\n-    ${language} =  Get environment variable  LANGUAGE  \'en\'\n-    Set default language  ${language}\n-\n-    Enable autologin as  Manager\n-    ${user_id} =  Translate  user_id\n-    ...  default=jane-doe\n-    ${user_fullname} =  Translate  user_fullname\n-    ...  default=Jane Doe\n-    Create user  ${user_id}  Member  fullname=${user_fullname}\n-    Set autologin username  ${user_id}\n-\n-    Open test browser\n-    Run keyword and ignore error  Set window size  @{DIMENSIONS}\n-\n-Common Suite Teardown\n-    Close all browsers\n-    Run keyword if  ${ROBOT_SERVER}  Remote ZODB TearDown  ${FIXTURE}\n-    Run keyword if  not ${ROBOT_SERVER}  ZODB TearDown  ${FIXTURE}\n-    Run keyword if  not ${ROBOT_SERVER}  Teardown Plone site\n-\n-Setup Plone site\n-    [Arguments]  ${zope_layer_dotted_name}\n-    Start Zope server  ${zope_layer_dotted_name}\n-    Wait until keyword succeeds  2min  0s  Setup Plone keywords\n-\n-Setup Plone keywords\n-    Import library  Remote  ${PLONE_URL}/RobotRemote\n-\n-Teardown Plone site\n-    Close all browsers\n-    Stop Zope server\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/config-screens.robot b/Products/CMFPlone/tests/robot/robodoc/config-screens.robot\ndeleted file mode 100644\nindex 8422f57999..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/config-screens.robot\n+++ /dev/null\n@@ -1,212 +0,0 @@\n-*** Settings ***\n-\n-Resource  common.robot\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-*** Variables ***\n-\n-@{DIMENSIONS}  1280  1600\n-@{CONFIGURE_PACKAGES}  plone.app.caching\n-@{APPLY_PROFILES}  plone.app.contenttypes:plone-content  plone.app.caching:default\n-\n-\n-*** Keywords ***\n-\n-Highlight field\n-    [Arguments]  ${locator}\n-    Update element style  ${locator}  padding  0.5em\n-    Highlight  ${locator}\n-\n-*** Test Cases ***\n-\n-Show Add-ons setup screen\n-    Go to  ${PLONE_URL}/prefs_install_products_form\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/addon-setup.png\n-    ...  css=#content\n-\n-Show caching setup screen\n-    Go to  ${PLONE_URL}/@@caching-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/caching-setup.png\n-    ...  css=#content\n-\n-Show Configuration Registry screen\n-    Go to  ${PLONE_URL}/portal_registry\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/configuration-registry.png\n-    ...  css=#content\n-\n-Show Content setup screen\n-    Go to  ${PLONE_URL}/@@content-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/content-setup.png\n-    ...  css=#content\n-\n-    Click element  type_id\n-\n-    Select From List By Label  name=type_id  Document\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/content-document.png\n-    ...  css=#content\n-\n-Show Date setup screen\n-    Go to  ${PLONE_URL}/@@dateandtime-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/date-setup.png\n-    ...  css=#content\n-\n-Show Dexterity setup screen\n-    Go to  ${PLONE_URL}/@@dexterity-types\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/dexterity-setup.png\n-    ...  css=#content\n-\n-Show Discussion setup screen\n-    Go to  ${PLONE_URL}/@@discussion-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/discussion-setup.png\n-    ...  css=#content\n-\n-Show Editing setup screen\n-    Go to  ${PLONE_URL}/@@editing-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/editing-setup.png\n-    ...  css=#content\n-\n-Show Error log setup screen\n-    Go to  ${PLONE_URL}/@@error-log-form\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/errorlog-setup.png\n-    ...  css=#content\n-\n-Show HTML filter setup screen\n-    Go to  ${PLONE_URL}/@@filter-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/filter-setup.png\n-    ...  css=#content\n-\n-Show Image handling setup screen\n-    Go to  ${PLONE_URL}/@@imaging-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/imaging-setup.png\n-    ...  css=#content\n-\n-Show Site setup overview screen\n-    Go to  ${PLONE_URL}/@@overview-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/site-overview.png\n-    ...  css=#content\n-\n-Show Language setup screen\n-    Go to  ${PLONE_URL}/@@language-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/language-setup.png\n-    ...  css=#content\n-\n-    Click link  autotoc-item-autotoc-1\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/language-negotiation.png\n-    ...  css=#content\n-\n-Show Mail setup screen\n-    Go to  ${PLONE_URL}/@@mail-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/mail-setup.png\n-    ...  css=#content\n-\n-Show ZODB maintenance setup screen\n-    Go to  ${PLONE_URL}/@@maintenance-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/zodb-setup.png\n-    ...  css=#content\n-\n-Show Markup setup screen\n-    Go to  ${PLONE_URL}/@@markup-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/markup-setup.png\n-    ...  css=#content\n-\n-Show Navigation setup screen\n-    Go to  ${PLONE_URL}/@@navigation-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/navigation-setup.png\n-    ...  css=#content\n-\n-Show Resource Registry screen\n-    Go to  ${PLONE_URL}/@@resourceregistry-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/resource-registry.png\n-    ...  css=#content\n-\n-Show Search setup screen\n-    Go to  ${PLONE_URL}/@@search-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/search-setup.png\n-    ...  css=#content\n-\n-Show Security setup screen\n-    Go to  ${PLONE_URL}/@@security-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/security-setup.png\n-    ...  css=#content\n-\n-Show Site setup screen\n-    Go to  ${PLONE_URL}/@@site-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/site-setup.png\n-    ...  css=#content\n-\n-Show socialmedia setup screen\n-    Go to  ${PLONE_URL}/@@social-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/social-setup.png\n-    ...  css=#content\n-\n-Show Syndication setup screen\n-    Go to  ${PLONE_URL}/@@syndication-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/syndication-setup.png\n-    ...  css=#content\n-\n-Show Theming setup screen\n-    Go to  ${PLONE_URL}/@@theming-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/theme-setup.png\n-    ...  css=#content\n-\n-Show Tinymce setup screen\n-    Go to  ${PLONE_URL}/@@tinymce-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/tinymce-setup.png\n-    ...  css=#content\n-\n-Show Users setup screen\n-    Go to  ${PLONE_URL}/@@usergroup-userprefs\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/users-setup.png\n-    ...  css=#content\n-\n-    Go to  ${PLONE_URL}/@@usergroup-groupprefs\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/groups-setup.png\n-    ...  css=#content\n-    Go to  ${PLONE_URL}/@@usergroup-controlpanel\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/users-settings.png\n-    ...  css=#content\n-    Go to  ${PLONE_URL}/@@member-fields\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/users-fields.png\n-    ...  css=#content\n-\n-Changing the logo\n-    Go to  ${PLONE_URL}/@@site-controlpanel\n-    Highlight field  css=#formfield-form-widgets-site_logo\n-    Capture and crop page screenshot\n-    ...    ${CURDIR}/_robot/change-logo-in-site-control-panel.png\n-    ...    css=#content\n-    ...    css=#formfield-form-widgets-site_logo\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/content.robot b/Products/CMFPlone/tests/robot/robodoc/content.robot\ndeleted file mode 100644\nindex 891622ab6a..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/content.robot\n+++ /dev/null\n@@ -1,334 +0,0 @@\n-*** Settings ***\n-\n-Resource  common.robot\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-\n-\n-*** Test Cases ***\n-\n-Show add collection menu\n-    Go to  ${PLONE_URL}\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  collection\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-collections_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-\n-Select collection criteria\n-    Go to  ${PLONE_URL}/++add++Collection\n-    Click element  css=div.querystring-criteria-index a\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/collection-criteria.png\n-    ...  css=div.select2-drop-active\n-\n-Show add new event menu\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  event\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-events_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-Show new event add form\n-    Page should contain element  event\n-    Click link  event\n-\n-    Wait until element is visible\n-    ...  css=#mceu_16-body\n-    Wait until element is visible\n-    ...  id=portal-footer\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-events_add-form.png\n-    ...  id=content\n-\n-Show add files menu\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  file\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-files_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-Show new file add form\n-    Page should contain element  file\n-    Click link  file\n-\n-    Wait until element is visible\n-    ...  css=#form-widgets-title\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-files_add-form.png\n-    ...  css=#content\n-\n-Show add new folder menu\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  folder\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-folders_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-Show new folder add form\n-    Page should contain element  folder\n-    Click link  folder\n-\n-    Wait until element is visible\n-    ...  css=#form-widgets-IDublinCore-title\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-folders_add-form.png\n-    ...  css=#content\n-\n-Show add new image menu\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  image\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-images_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-Show new image edit form\n-    Page should contain element  image\n-    Click link  image\n-\n-    Wait until element is visible\n-    ...  css=#form-widgets-title\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-images_add-form.png\n-    ...  css=#content\n-\n-*** Test Cases ***\n-\n-Show add new link menu\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  link\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-links_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-*** Test Cases ***\n-\n-Show new link add form\n-    Page should contain element  link\n-    Click link  link\n-\n-    Wait until element is visible\n-    ...  css=#form-widgets-IDublinCore-title\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-links_add-form.png\n-    ...  css=#content\n-\n-Show add new content menu\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  document\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-content_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-Show add new news-item menu\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  news-item\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-news-items_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-Show new news-item edit form\n-    Page should contain element  news-item\n-    Click link  news-item\n-\n-    Wait until element is visible\n-    ...  css=#mceu_16-body\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-news-items_add-form.png\n-    ...  css=#content\n-\n-Show add new page menu\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  document\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-pages_add-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-Show new page edit form\n-    Page should contain element  document\n-    Click link  document\n-\n-    Wait until element is visible\n-    ...  css=#mceu_16-body\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/adding-pages_add-form.png\n-    ...  css=#content\n-\n-Show Content restrictions\n-    Go to  ${PLONE_URL}/news\n-\n-    Click link  css=#plone-contentmenu-factories a\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Mouse over  plone-contentmenu-settings\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/show-restrictions.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#plone-contentmenu-factories ul\n-\n-Menu restrictions\n-    Go to  ${PLONE_URL}/news/folder_constraintypes_form\n-\n-    Click element  form-widgets-constrain_types_mode\n-\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/menu-restrictions.png\n-    ...  css=#main-container\n-\n-Show basic content properties tab\n-    Go to  ${PLONE_URL}\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-factories\n-    Click element  css=span.icon-plone-contentmenu-factories\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-factories li.plone-toolbar-submenu-header\n-\n-    Page should contain element  document\n-    Click link  document\n-    Update element style  portal-footer  display  none\n-\n-    Wait until element is visible\n-    ...  css=#form-widgets-IDublinCore-title\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/basicpropertiestabs.png\n-    ...  css=nav.autotoc-nav\n-\n-Show edit page categorization\n-    Click link  Categorization\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/editpagecategorization.png\n-    ...  css=#content-core\n-\n-Show content dates settings\n-    Click link  Dates\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/datessettings.png\n-    ...  css=#content-core\n-\n-Show content ownershippanel\n-    Click link  Ownership\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/ownershippanel.png\n-    ...  css=#content-core\n-\n-Show content settingspanel\n-    Click link  Settings\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/settingspanel.png\n-    ...  css=#content-core\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/managing-working_copy.robot b/Products/CMFPlone/tests/robot/robodoc/managing-working_copy.robot\ndeleted file mode 100644\nindex 6677e9cb83..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/managing-working_copy.robot\n+++ /dev/null\n@@ -1,114 +0,0 @@\n-*** Settings ***\n-\n-Resource  common.robot\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-*** Variables ***\n-\n-@{CONFIGURE_PACKAGES}  plone.app.iterate\n-@{APPLY_PROFILES}  plone.app.contenttypes:plone-content  plone.app.iterate:default\n-# ${REGISTER_TRANSLATIONS}  ${CURDIR}/../../_locales\n-\n-*** Test Cases ***\n-\n-Show how to checkout\n-    Go to  ${PLONE_URL}/front-page\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-actions\n-    Click element  css=span.icon-plone-contentmenu-actions\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-actions li.plone-toolbar-submenu-header\n-\n-    Mouse over  css=#plone-contentmenu-actions-iterate_checkout\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/working-copy_checkout.png\n-    ...  css=#content-header\n-    ...  css=div.plone-toolbar-container\n-\n-Show checkout notification\n-    Go to  ${PLONE_URL}/front-page\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-actions\n-    Click element  css=span.icon-plone-contentmenu-actions\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-actions li.plone-toolbar-submenu-header\n-    Click link  css=#plone-contentmenu-actions-iterate_checkout\n-    Wait until element is visible\n-    ...  name=form.button.Checkout\n-    Click button  name=form.button.Checkout\n-    Element should be visible  css=.portalMessage\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/working-copy_checkout-notification.png\n-    ...  css=#content-header\n-    ...  css=div.plone-toolbar-container\n-\n-Show locked original\n-    Go to  ${PLONE_URL}/front-page\n-\n-    Element should be visible  css=#plone-lock-status\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/working-copy_locked.png\n-    ...  css=#content-header\n-    ...  css=div.plone-toolbar-container\n-\n-Show check-in option\n-    Go to  ${PLONE_URL}/copy_of_front-page\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-actions\n-    Click element  css=span.icon-plone-contentmenu-actions\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-actions li.plone-toolbar-submenu-header\n-\n-    Mouse over  css=#plone-contentmenu-actions-iterate_checkin\n-    Update element style  portal-footer  display  none\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/working-copy_checkin.png\n-    ...  css=#content-header\n-    ...  css=div.plone-toolbar-container\n-\n-    Click link  css=#plone-contentmenu-actions-iterate_checkin\n-\n-    Element should be visible  css=#checkin_message\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/working-copy_checkin-form.png\n-    ...  css=#content-header\n-    ...  css=div.plone-toolbar-container\n-\n-Show cancel checkout\n-    Go to  ${PLONE_URL}/copy_of_front-page\n-\n-    Wait until element is visible\n-    ...  css=span.icon-plone-contentmenu-actions\n-    Click element  css=span.icon-plone-contentmenu-actions\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-actions li.plone-toolbar-submenu-header\n-\n-    Mouse over  css=#plone-contentmenu-actions-iterate_checkout_cancel\n-    Update element style  portal-footer  display  none\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/working-copy_cancel-checkout.png\n-    ...  css=#content-header\n-    ...  css=div.plone-toolbar-container\n-\n-    Click link  css=#plone-contentmenu-actions-iterate_checkout_cancel\n-\n-    Element should be visible  css=.destructive\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/working-copy_cancel-checkout-form.png\n-    ...  css=#content-header\n-    ...  css=div.plone-toolbar-container\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/managing_content.robot b/Products/CMFPlone/tests/robot/robodoc/managing_content.robot\ndeleted file mode 100644\nindex 1d5de8ccb7..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/managing_content.robot\n+++ /dev/null\n@@ -1,198 +0,0 @@\n-*** Settings ***\n-\n-Resource  common.robot\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-\n-\n-*** Test Cases ***\n-\n-Show contentrules\n-    Go to  ${PLONE_URL}/@@rules-controlpanel\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/contentrules-start.png\n-            ...  css=#content\n-            ...  css=div.plone-toolbar-container\n-\n-add rule\n-    Go to  ${PLONE_URL}/+rule/plone.ContentRule\n-    Wait until element is visible\n-    ...  css=#formfield-form-widgets-title\n-    Click element  css=#form-widgets-title\n-    Input text  css=#form-widgets-title  Send Email when any Page is Modified\n-\n-    Click element  css=#form-widgets-description\n-    Input text  css=#form-widgets-description  this rule is meant for folders where new staff is having a go\n-    Click element  css=#formfield-form-widgets-event\n-    Select From List By Label  id=form-widgets-event  Object modified\n-\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/contentrules-add.png\n-            ...  css=#content\n-    Click button  css=#form-buttons-save\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/contentrules-conditions.png\n-            ...  css=#content\n-    Wait until element is visible\n-    ...  name=form.button.Save\n-    Click button  name=form.button.Save\n-\n-\n-assign rule\n-    Go to  ${PLONE_URL}/news\n-    Click link  css=#contentview-contentrules a\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/contentrules-assign.png\n-            ...  css=#content\n-            ...  css=div.plone-toolbar-container\n-\n-Edit folder\n-    Go to  ${PLONE_URL}\n-    Click element  css=#contentview-folderContents a\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-cutpaste.png\n-    ...  css=#content\n-\n-Deleting content\n-    Go to  ${PLONE_URL}\n-    Click element  css=#contentview-folderContents a\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-delete.png\n-    ...  css=#content\n-\n-Edit Page\n-    Go to  ${PLONE_URL}\n-    Click element  css=#contentview-edit a\n-    Wait until element is visible\n-    ...  css=#mceu_16-body\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/edit-page.png\n-    ...  css=#content\n-\n-Foldercontents\n-    Go to  ${PLONE_URL}\n-    Click element  css=#contentview-folderContents a\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents.png\n-    ...  css=#content\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-columns.png\n-    ...  css=#btn-attribute-columns\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-selected.png\n-    ...  css=#btn-selected-items\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-rearrange.png\n-    ...  css=#btn-rearrange\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-rearrange.png\n-    ...  css=#btn-rearrange\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-upload.png\n-    ...  css=#btn-upload\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-cut.png\n-    ...  css=#btn-cut\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-copy.png\n-    ...  css=#btn-copy\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-paste.png\n-    ...  css=#btn-paste\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-delete.png\n-    ...  css=#btn-delete\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-rename.png\n-    ...  css=#btn-rename\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-tags.png\n-    ...  css=#btn-tags\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-state.png\n-    ...  css=#btn-workflow\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-properties.png\n-    ...  css=#btn-properties\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-searchbox.png\n-    ...  css=#filter\n-\n-Show display menu\n-    Go to  ${PLONE_URL}\n-\n-    Click link  css=#plone-contentmenu-display a\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-display li.plone-toolbar-submenu-header\n-\n-\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/display-menu.png\n-            ...  css=#content-header\n-            ...  css=div.plone-toolbar-container\n-\n-Reordering\n-    Go to  ${PLONE_URL}\n-    Click element  css=#contentview-folderContents a\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/foldercontents-reorder.png\n-    ...  css=#content\n-\n-Create sample content for history\n-    Go to  ${PLONE_URL}\n-\n-    ${item} =  Create content  type=Document\n-    ...  id=samplepage  title=Sample Page\n-    ...  description=The long wait is now over\n-    ...  text=<p>Our new site is built with Plone.</p>\n-    Fire transition  ${item}  publish\n-\n-    Go to  ${PLONE_URL}/samplepage\n-    Click element  css=#contentview-edit a\n-    Click element  css=#form-widgets-IDublinCore-title\n-    Input text  css=#form-widgets-IDublinCore-title  Hurray\n-    Click element  css=#form-widgets-IVersionable-changeNote\n-    Input text  css=#form-widgets-IVersionable-changeNote  Title should be Hurray, not Sample Page.\n-    Click button  css=#form-buttons-save\n-\n-Show history\n-    Go to  ${PLONE_URL}/samplepage\n-    Click link  css=#contentview-history a\n-    Wait until element is visible\n-    ...  css=#history-list\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/content-history.png\n-            ...  css=#content-header\n-            ...  css=div.plone-toolbar-container\n-\n-Show portlet management\n-    Go to  ${PLONE_URL}\n-    Click link  css=#plone-contentmenu-portletmanager a\n-\n-    Wait until element is visible\n-    ...  css=#plone-contentmenu-portletmanager li.plone-toolbar-submenu-header\n-\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/portlet-menu.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=#content-header\n-\n-Show right portlets\n-    Go to  ${PLONE_URL}/@@topbar-manage-portlets/plone.footerportlets\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/portlet-footer.png\n-    ...  css=#content\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/personalsettings.robot b/Products/CMFPlone/tests/robot/robodoc/personalsettings.robot\ndeleted file mode 100644\nindex 7c1edf71a8..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/personalsettings.robot\n+++ /dev/null\n@@ -1,45 +0,0 @@\n-*** Settings ***\n-\n-Resource  common.robot\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-*** Test Cases ***\n-\n-Show menubar\n-    Go to  ${PLONE_URL}\n-\n-    Click link  css=#portal-personaltools a\n-\n-    Wait until element is visible\n-    ...  css=#portal-personaltools li.plone-toolbar-submenu-header\n-\n-    Mouse over  personaltools-preferences\n-    Update element style  portal-footer  display  none\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/show-preferences.png\n-    ...  css=div.plone-toolbar-container\n-    ...  css=li.plone-toolbar-submenu-header\n-\n-Show personal preferences\n-    Go to  ${PLONE_URL}/@@personal-preferences\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/personal-preferences.png\n-    ...  css=#main-container\n-\n-Show personal information\n-    Go to  ${PLONE_URL}/@@personal-information\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/personal-information.png\n-    ...  css=#main-container\n-\n-Show changing password\n-    Go to  ${PLONE_URL}/@@change-password\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/change-password.png\n-    ...  css=#main-container\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/robot/robodoc/working_with_tinymce.robot b/Products/CMFPlone/tests/robot/robodoc/working_with_tinymce.robot\ndeleted file mode 100644\nindex 296ba742c0..0000000000\n--- a/Products/CMFPlone/tests/robot/robodoc/working_with_tinymce.robot\n+++ /dev/null\n@@ -1,79 +0,0 @@\n-*** Settings ***\n-\n-Resource  common.robot\n-\n-Suite Setup  Common Suite Setup\n-Suite Teardown  Common Suite Teardown\n-\n-\n-*** Test Cases ***\n-\n-Create sample content\n-    Go to  ${PLONE_URL}\n-\n-    ${item} =  Create content  type=Document\n-    ...  id=samplepage  title=Sample Page\n-    ...  description=The long wait is now over\n-    ...  text=<p>Our new site is built with Plone.</p>\n-\n-\n-Show TinyMCE\n-    Go to  ${PLONE_URL}/samplepage\n-    Click element  css=#contentview-edit a\n-    Wait until element is visible\n-    ...  css=#mceu_16-body\n-    Click element  css=#mceu_2-open\n-    Click element  css=#mceu_2-open\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/tinymce.png\n-    ...  css=#mceu_16\n-\n-Show TinyMCE image\n-    Go to  ${PLONE_URL}/samplepage\n-    Click element  css=#contentview-edit a\n-    Wait until element is visible\n-    ...  css=#mceu_16-body\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/tinymce-imgbutton.png\n-    ...  css=#mceu_15\n-\n-    Click element  css=#mceu_15 button\n-    Wait until element is visible\n-    ...  css=h2.modal-title\n-    Wait until element is visible\n-    ...  css=div.common-controls\n-\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/tinymce-imgdialog.png\n-    ...  css=div.outer-wrapper\n-    ...  css=div.modal-content\n-\n-Show TinyMCE insert links\n-    Go to  ${PLONE_URL}/samplepage\n-    Click element  css=#contentview-edit a\n-    Wait until element is visible\n-    ...  css=#mceu_16-body\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/tinymce-linkbutton.png\n-    ...  css=#mceu_14\n-\n-    Click element  css=#mceu_14 button\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/tinymce-linkdialog.png\n-    ...  css=div.outer-wrapper\n-    ...  css=div.modal-content\n-\n-Show TinyMCE insert tables\n-    Go to  ${PLONE_URL}/samplepage\n-    Click element  css=#contentview-edit a\n-    Wait until element is visible\n-    ...  css=#mceu_16-body\n-\n-    Click element  css=#mceu_22-open\n-    Click element  css=#mceu_42-text\n-    Wait until element is visible\n-    ...  css=#mceu_42-text\n-    Mouse over  css=#mceu_42-text\n-    Capture and crop page screenshot\n-    ...  ${CURDIR}/_robot/tinymce-table.png\n-    ...  css=div.outer-wrappper\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/robot/test_actionmenu.robot b/Products/CMFPlone/tests/robot/test_actionmenu.robot\nindex 58539cb3ec..27a4bd10c2 100644\n--- a/Products/CMFPlone/tests/robot/test_actionmenu.robot\n+++ b/Products/CMFPlone/tests/robot/test_actionmenu.robot\n@@ -1,24 +1,21 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n+*** Variables ***\n \n-*** Variables ****************************************************************\n+${TITLE}    An actionsmenu page\n+${PAGE_ID}    an-actionsmenu-page\n \n-${TITLE}  An actionsmenu page\n-${PAGE_ID}  an-actionsmenu-page\n \n-\n-*** Test cases ***************************************************************\n+*** Test Cases ***\n \n # ---\n # Basic Contentactions menu\n@@ -41,13 +38,13 @@ Scenario: Clicking again collapses action menu\n       and an actionsmenu page\n      When menu link is clicked\n       and menu link is clicked\n+     Then actions menu should not be visible\n \n # ---\n # Switching Contentactions menu by MouseOver\n # ---\n \n-Scenario: Hovering mouse from expanded menu on other menu shows that menu\n-    Pass Execution  This functionality needs to be fixed for Plone 5, but let\'s not make it break the build for now.\n+Scenario: Click from expanded menu on other menu shows that menu\n     Given a logged-in site administrator\n       and an actionsmenu page\n      When first menu link is clicked\n@@ -88,95 +85,78 @@ Scenario:\n      Then I should see \'Item(s) pasted.\' in the page\n \n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n-# --- GIVEN ------------------------------------------------------------------\n+# GIVEN\n \n an actionsmenu page\n-    Create content  type=Document  title=${TITLE}\n-    Go to  ${PLONE_URL}/${PAGE_ID}\n-    Wait until page contains  An actionsmenu page\n+    Create content    type=Document    title=${TITLE}\n+    Go To    ${PLONE_URL}/${PAGE_ID}\n+    Get Text    //body    contains    An actionsmenu page\n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n+\n+first menu link is clicked\n+    Click    xpath=//li[@id=\'plone-contentmenu-workflow\']/a\n \n mouse moves to second menu\n-    Click Link  xpath=(//div[@class="contentActions"]//a[contains(@class, \'actionMenuHeader\')])[2]\n+    Click    xpath=//li[@id=\'plone-contentmenu-actions\']/a\n \n I click outside of menu\n-    Click Element  xpath=//h1\n+    Click    xpath=//h1\n \n workflow link is clicked\n     # store current state\n-    ${OLD_STATE} =  Get Text  xpath=(//span[contains(@class,\'state-\')])\n-    Set Suite Variable  ${OLD_STATE}  ${OLD_STATE}\n-    Given patterns are loaded\n-    Click Link  xpath=//li[@id=\'plone-contentmenu-workflow\']/a\n-    Click Link  xpath=(//li[@id=\'plone-contentmenu-workflow\']/ul/li/a)[1]\n-    Page Should Contain  Item state changed.\n-\n-Open Menu\n-    [Arguments]  ${elementId}\n-    Element Should Not Be Visible  css=#${elementId} ul.actionMenuContent\n-    Click link  css=#${elementId} a.actionMenuHeader\n-    Wait until keyword succeeds  5  1  Element Should Be Visible  css=#${elementId} .actionMenuContent\n-\n-Open Action Menu\n-    Given patterns are loaded\n-    Click link  xpath=//li[@id=\'plone-contentmenu-actions\']/a\n-    Wait until keyword succeeds  5  1  Element Should Be Visible  css=#plone-contentmenu-actions .dropdown-menu\n+    ${OLD_STATE}=    Get Text    xpath=(//span[contains(@class,\'state-\')])\n+    Set Suite Variable    ${OLD_STATE}    ${OLD_STATE}\n+    Click    xpath=//li[@id=\'plone-contentmenu-workflow\']/a\n+    Click    xpath=(//li[@id=\'plone-contentmenu-workflow\']/ul/li/a)[1]\n+    Get Text    //body    contains    Item state changed.\n \n I copy the page\n     Open Action Menu\n-    Click Link  css=#plone-contentmenu-actions .actionicon-object_buttons-copy\n-    Page should contain  copied\n+    Click    xpath=//li[@id=\'plone-contentmenu-actions\']//a[contains(@class,\'actionicon-object_buttons-copy\')]\n+    Get Text    //body    contains    copied\n \n I paste\n     Go to  ${PLONE_URL}\n     Open Action Menu\n-    Click Link  css=#plone-contentmenu-actions .actionicon-object_buttons-paste\n+    Click    xpath=//li[@id=\'plone-contentmenu-actions\']//a[contains(@class,\'actionicon-object_buttons-paste\')]\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n delete link exists\n-     Page Should Contain Element  xpath=//a[@id=\'plone-contentmenu-actions-delete\']\n+    Get Element Count    xpath=//a[@id=\'plone-contentmenu-actions-delete\']    should be    1\n \n delete link should not be visible\n-     Element Should Not Be Visible  xpath=//div[@class=\'contentActions\']//a[@id=\'plone-contentmenu-actions-delete\']\n+    Wait For Elements State    xpath=//li[@id=\'plone-contentmenu-actions\']/a[@id=\'plone-contentmenu-actions-delete\']    hidden\n \n menu link is clicked\n-    Given patterns are loaded\n-    Click link  xpath=//li[@id=\'plone-contentmenu-actions\']/a\n+    Click    xpath=//li[@id=\'plone-contentmenu-actions\']/a\n \n-delete link should be visible\n-    Given patterns are loaded\n-    Element Should Be Visible  xpath=//div[@class=\'contentActions\']//a[@id=\'plone-contentmenu-actions-delete\']\n+second menu should be visible\n+    Get Element States    xpath=//li[@id=\'plone-contentmenu-actions\']/ul[contains(@class,\'dropdown-menu\')]    contains    visible\n \n-actions menu should be visible\n-    Given patterns are loaded\n-    Element Should Be Visible  xpath=//li[@id=\'plone-contentmenu-actions\']\n+first menu should not be visible\n+    Get Element States    xpath=//li[@id=\'plone-contentmenu-workflow\']/ul[contains(@class,\'dropdown-menu\')]    contains    hidden\n \n-first menu link is clicked\n-    Given patterns are loaded\n-    Click Link  xpath=(//div[@class="contentActions"]//a[contains(@class, \'actionMenuHeader\')])[1]\n+actions menu should not be visible\n+    Get Element States    xpath=//li[@id=\'plone-contentmenu-actions\']/ul[contains(@class,\'dropdown-menu\')]    contains    hidden\n \n-I should see \'${message}\' in the page\n-    Wait until page contains  ${message}\n-    Page should contain  ${message}\n+actions menu should be visible\n+    Get Element States    xpath=//li[@id=\'plone-contentmenu-actions\']/ul[contains(@class,\'dropdown-menu\')]    contains    visible\n \n state should have changed\n-    Wait until page contains  Item state changed\n-    ${NEW_STATE} =  Get Text  xpath=(//span[contains(@class,\'state-\')])\n-    # Should Not Be Equal  ${NEW_STATE}  ${OLD_STATE}\n+    ${NEW_STATE}=    Get Text    xpath=(//span[contains(@class,\'state-\')])\n+    Should Not Be Equal As Strings    ${NEW_STATE}    ${OLD_STATE}\n \n-second menu should be visible\n-    Element Should Be Visible  xpath=(//li[contains(@class, \'actionMenu\')])[2]\n+I should see \'${message}\' in the page\n+    Get Text    //body    contains    ${message}\n \n-first menu should not be visible\n-    Given patterns are loaded\n-    Wait until keyword succeeds  10s  1s  Element Should Not Be Visible  xpath=(//li[contains(@class, \'actionMenu\')])[1]//li\n \n-actions menu should not be visible\n-    Given patterns are loaded\n-    Wait until keyword succeeds  10s  1s  Element Should Not Be Visible  xpath=//li[@id=\'plone-contentmenu-actions-delete\']\n+# DRY\n \n+Open Action Menu\n+    Click    xpath=//li[@id=\'plone-contentmenu-actions\']/a\n+    actions menu should be visible\ndiff --git a/Products/CMFPlone/tests/robot/test_contentbrowser.robot b/Products/CMFPlone/tests/robot/test_contentbrowser.robot\nindex 577fbf2b32..2025e9af4f 100644\n--- a/Products/CMFPlone/tests/robot/test_contentbrowser.robot\n+++ b/Products/CMFPlone/tests/robot/test_contentbrowser.robot\n@@ -1,8 +1,6 @@\n *** Settings *****************************************************************\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource  plone/app/robotframework/browser.robot\n Resource  keywords.robot\n \n Library  Remote  ${PLONE_URL}/RobotRemote\n@@ -114,121 +112,112 @@ a document\n I select a related item image via contentbrowser\n    Go to  ${PLONE_URL}/${DOCUMENT_ID}/edit\n    # Click the Categorization Tab\n-   Wait For Then Click Element    //a[@id="autotoc-item-autotoc-2"]\n+   Click    //a[@id="autotoc-item-autotoc-2"]\n    # Click the select button\n-   Wait For Then Click Element    //div[@id="formfield-form-widgets-IRelatedItems-relatedItems"]//button\n+   Click    //div[@id="formfield-form-widgets-IRelatedItems-relatedItems"]//button\n    # Click third element in first column, that is the "Assets" folder\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[4]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[4]\n    # Click first element in second column, that is the "Mixed" folder\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[2]/div[contains(@class, "levelItems")]/div[1]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[2]/div[contains(@class, "levelItems")]/div[1]\n    # Click fifth element in third column, that is the "Files" folder\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[3]/div[contains(@class, "levelItems")]/div[5]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[3]/div[contains(@class, "levelItems")]/div[5]\n    # Click third element in fourth column, that is the "Images" folder\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[4]/div[contains(@class, "levelItems")]/div[3]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[4]/div[contains(@class, "levelItems")]/div[3]\n    # Click second element in fifth column, that is the "Image2" Object\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[5]/div[contains(@class, "levelItems")]/div[2]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[5]/div[contains(@class, "levelItems")]/div[2]\n    # Click the select Button in the Toolbar of column 6\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[6]/div[contains(@class, "levelToolbar")]/button\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[6]/div[contains(@class, "levelToolbar")]/button\n \n \n I select two related item images via contentbrowser\n    Go to  ${PLONE_URL}/${DOCUMENT_ID}/edit\n    # Click the Categorization Tab\n-   Wait For Then Click Element    //a[@id="autotoc-item-autotoc-2"]\n+   Click    //a[@id="autotoc-item-autotoc-2"]\n    # Click the select button\n-   Wait For Then Click Element    //div[@id="formfield-form-widgets-IRelatedItems-relatedItems"]//button\n+   Click    //div[@id="formfield-form-widgets-IRelatedItems-relatedItems"]//button\n    # Click third element in first column, that is the "Assets" folder\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[4]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[4]\n    # Click first element in second column, that is the "Mixed" folder\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[2]/div[contains(@class, "levelItems")]/div[1]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[2]/div[contains(@class, "levelItems")]/div[1]\n    # Click fifth element in third column, that is the "Files" folder\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[3]/div[contains(@class, "levelItems")]/div[5]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[3]/div[contains(@class, "levelItems")]/div[5]\n    # Click third element in fourth column, that is the "Images" folder\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[4]/div[contains(@class, "levelItems")]/div[3]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[4]/div[contains(@class, "levelItems")]/div[3]\n \n    # now we select two items in a colum via Shift+Click\n    # Click first element in fifth column, that is the "Image1" Object\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[5]/div[contains(@class, "levelItems")]/div[1]\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[5]/div[contains(@class, "levelItems")]/div[1]\n    # Click second element in fifth column with SHIFT, that is the "Image2" Object\n-   Wait For Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[5]/div[contains(@class, "levelItems")]/div[2]\n-   Click Element        //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[5]/div[contains(@class, "levelItems")]/div[2]    SHIFT\n+   Click With Options    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[5]/div[contains(@class, "levelItems")]/div[2]    left    Shift\n    # Click the select Button in the Toolbar of column 6\n-   Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[6]/div[contains(@class, "levelToolbar")]/button\n+   Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[6]/div[contains(@class, "levelToolbar")]/button\n \n \n I set an internal link via contentbrowser\n     Go to  ${PLONE_URL}/${DOCUMENT_ID}/edit\n-    Fill text to tinymce editor    Susi Sorglos and John Doe\n-    Execute Javascript    function selectText() {\n-    ...    var iframe_document = document.querySelector(".tox-edit-area iframe").contentDocument;\n-    ...    var body = iframe_document.body;\n-    ...    var p = body.firstChild;\n-    ...    var range = new Range();\n-    ...    range.setStart(p.firstChild, 5);\n-    ...    range.setEnd(p.firstChild, 12);\n-    ...    iframe_document.getSelection().removeAllRanges();\n-    ...    iframe_document.getSelection().addRange(range);\n-    ...    }; selectText();\n-    Click Button    //button[@aria-label=\'Insert/edit link\']\n-    Wait For Then Click Element  css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <p>Susi Sorglos and John Doe</p>\n+    Evaluate JavaScript   //div[contains(@class, \'tox-edit-area\')]//iframe\n+    ...    (elem, args) => {\n+    ...        const iframe_document = elem.contentDocument;\n+    ...        const body = iframe_document.body;\n+    ...        const p = body.firstChild;\n+    ...        const range = new Range();\n+    ...        range.setStart(p.firstChild, 5);\n+    ...        range.setEnd(p.firstChild, 12);\n+    ...        iframe_document.getSelection().removeAllRanges();\n+    ...        iframe_document.getSelection().addRange(range);\n+    ...    }\n+    ...    all_elements=False\n+    Click    //button[@aria-label=\'Insert/edit link\']\n+    Click    css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n     Click item in column    1    3\n-    Wait For Then Click Element  //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n-    Wait Until Element Is Not Visible    //div[contains(@class,"content-browser-position-wrapper")]\n-    Wait For Then Click Element    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n-    Wait Until Element Is Not Visible  css=.modal-footer input[name="insert"]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n+    Click    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n \n I set an image via contentbrowser\n     Go to  ${PLONE_URL}/${DOCUMENT_ID}/edit\n-    Fill text to tinymce editor    Susi Sorglos and John Doe\n-    Click Button    //button[@aria-label=\'Insert/edit image\']\n-    Wait For Then Click Element  css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <p>Susi Sorglos and John Doe</p>\n+    Click    //button[@aria-label=\'Insert/edit image\']\n+    Click    css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n     Click item in column    1    3\n     Click item in column    2    1\n     Click item in column    3    1\n-    Wait For Then Click Element  //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n-    Wait Until Element Is Not Visible    //div[contains(@class,"content-browser-position-wrapper")]\n-    Wait For Then Click Element    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n-    Wait Until Element Is Not Visible  css=.modal-footer input[name="insert"]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n+    Click    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n \n I upload an image via contentbrowser\n     Go to  ${PLONE_URL}/${DOCUMENT_ID}/edit\n-    Fill text to tinymce editor    Susi Sorglos and John Doe\n-    Click Button  //button[@aria-label="Insert/edit image"]\n-    Wait For Then Click Element  css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <p>Susi Sorglos and John Doe</p>\n+    Click    //button[@aria-label="Insert/edit image"]\n+    Click    css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n     Click item in column    1    3\n     Click item in column    2    1\n-    Wait For Then Click Element  //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "toolBar")]/button[contains(@class,"upload")]\n-    Choose File    //div[contains(@class,"pat-upload")]//input[@class="dz-hidden-input"]    ${PATH_TO_TEST_FILES}/plone-logo.png\n-    Wait For Then Click Element  //div[contains(@class,"pat-upload")]//button[contains(@class,"upload-all")]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "toolBar")]//button[contains(@class,"upload")]\n+    Upload File By Selector    //div[contains(@class,"pat-upload")]//input[@class="dz-hidden-input"]    ${PATH_TO_TEST_FILES}/plone-logo.png\n+    Click    //div[contains(@class,"pat-upload")]//button[contains(@class,"upload-all")]\n     Click item in column    3    3\n-    Wait For Then Click Element  //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n-    Wait Until Element Is Not Visible    //div[contains(@class,"content-browser-position-wrapper")]\n-    Wait For Then Click Element    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n-    Wait Until Element Is Not Visible  css=.modal-footer input[name="insert"]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n+    Click    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n \n I search and select an image via contentbrowser\n     Go to  ${PLONE_URL}/${DOCUMENT_ID}/edit\n-    Fill text to tinymce editor    Susi Sorglos and John Doe\n-    Click Button  //button[@aria-label="Insert/edit image"]\n-    Wait For Then Click Element  css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <p>Susi Sorglos and John Doe</p>\n+    Click    //button[@aria-label="Insert/edit image"]\n+    Click    css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n     Click item in column    1    3\n     Click item in column    2    1\n     Click item in column    3    2\n     Click item in column    4    1\n-    Wait For Then Click Element  //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "toolBar")]//input[contains(@name,"filter")]\n-    Press Keys    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "toolBar")]//input[contains(@name,"filter")]    Anot\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "toolBar")]//input[contains(@name,"filter")]\n+    Type Text    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "toolBar")]//input[contains(@name,"filter")]    Anot\n     # here we need a timeout, because the search filter is not so fast like the testbrowser, it looks like a asynch operation\n-    ${speed}    Get Selenium Speed\n-    Set Selenium Speed    1 seconds\n+    Sleep    1\n     Click item in column    5    1\n-    Set Selenium Speed    ${speed}\n-    Wait For Then Click Element  //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n-    Wait Until Element Is Not Visible    //div[contains(@class,"content-browser-position-wrapper")]\n-    Wait For Then Click Element    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n-    Wait Until Element Is Not Visible  css=.modal-footer input[name="insert"]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n+    Click    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n \n I save the document\n-    Click Button    //button[@id="form-buttons-save"]\n+    Click    //button[@id="form-buttons-save"]\n \n \n \n@@ -257,13 +246,6 @@ the document contain the uploaded image\n \n #--- Helper DRY -------------------------------------------------------------\n \n-Fill text to tinymce editor\n-    [arguments]    ${text}\n-    Wait Until Element Is Visible    css=.tox-edit-area iframe\n-    Select Frame    css=.tox-edit-area iframe\n-    Input Text    //body[@id="tinymce"]    ${text}\n-    UnSelect Frame\n-\n image is releated item\n     [arguments]    ${xpath}    ${imagepath}\n     Element exists    ${xpath}    src    ${imagepath}\n@@ -274,11 +256,8 @@ rendered textfield contain the image with title\n \n Element exists\n     [arguments]  ${xpath}    ${attr}    ${value}\n-    ${element}=    Set Variable    ${xpath}\n-    Element Should Be Visible    ${element}\n-    ${_attr}=  Get Element Attribute    ${element}    ${attr}\n-    Should End With    ${_attr}    ${value}\n+    Wait for condition    Attribute    ${xpath}    ${attr}    should end with    ${value}\n \n Click item in column\n     [arguments]  ${colnumber}    ${itemposition}\n-    Wait For Then Click Element  //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[${colnumber}]/div[contains(@class, "levelItems")]/div[${itemposition}]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[${colnumber}]/div[contains(@class, "levelItems")]/div[${itemposition}]\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot b/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot\nindex 8bb0a2513c..1574010f60 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_actions.robot\n@@ -1,137 +1,139 @@\n *** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run Keywords  Plone test setup\n-Test Teardown  Run keywords  Plone test teardown\n \n+*** Test Cases ***\n \n-*** Test Cases ***************************************************************\n+# hint: the `Sleep` Statement is needed for the `Disable autologin` and the commit in the DB, it takes a while\n \n Scenario: Modify an existing action in Actions Control Panel\n-  Given a logged-in administrator\n-    and the actions control panel\n-   When I modify an action title\n-   Sleep  1\n-   Then anonymous users can see the new action title\n+    Given a logged-in manager\n+      and the actions control panel\n+     When I modify an action title\n+      and Sleep    1\n+     Then anonymous users can see the new action title\n \n Scenario: Reorder in Actions Control Panel\n-  Given a logged-in administrator\n-    and the actions control panel\n-   When I change the actions order\n-   Sleep  1\n-   Then anonymous users can see the actions new ordering\n+    Given a logged-in manager\n+      and the actions control panel\n+     When I change the actions order\n+      and Sleep    1\n+     Then anonymous users can see the actions new ordering\n \n Scenario: Create a new action in Actions Control Panel\n-  Given a logged-in administrator\n-    and the actions control panel\n-   When I add a new action\n-   Sleep  1\n-   Then logged-in users can see the new action\n+    Given a logged-in manager\n+      and the actions control panel\n+     When I add a new action\n+      and Sleep    1\n+     Then logged-in users can see the new action\n \n Scenario: Hide/show an action in Actions Control Panel\n-  Given a logged-in administrator\n-    and the actions control panel\n-   When I hide an action\n-   Sleep  1\n-   Then anonymous users cannot see the action anymore\n-  Given a logged-in administrator\n-    and the actions control panel\n-   When I unhide the action\n-   Sleep  1\n-   Then anonymous users can see the action again\n+    Given a logged-in manager\n+      and the actions control panel\n+    When I hide an action\n+      and Sleep  1\n+    Then anonymous users cannot see the action anymore\n+    Given a logged-in manager\n+      and the actions control panel\n+    When I unhide the action\n+      and Sleep  1\n+    Then anonymous users can see the action again\n \n Scenario: Delete an action in Actions Control Panel\n-  Given a logged-in administrator\n-    and the actions control panel\n-   When I delete an action\n-   Sleep  1\n-   Then anonymous users cannot see the action anymore\n+    Given a logged-in manager\n+      and the actions control panel\n+     When I delete an action\n+      and Sleep  1\n+     Then anonymous users cannot see the action anymore\n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n-# --- GIVEN ------------------------------------------------------------------\n-\n-a logged-in administrator\n-  Enable autologin as  Manager\n+# GIVEN\n \n the actions control panel\n-  Go to  ${PLONE_URL}/@@actions-controlpanel\n-  Wait until page contains  Portal actions\n+    Go to    ${PLONE_URL}/@@actions-controlpanel\n+    Get Text    //body    contains    Portal actions\n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I modify an action title\n-  Click Link    css=section:nth-child(3) li:first-child a\n-  Wait until page contains  Action Settings\n-  Input Text for sure  form.widgets.title  A new site map\n-  Wait For Then Click Element  css=.pattern-modal-buttons > button\n+    Click    //*[@id="content-core"]/section[2]/section/ol/li[1]/form/a\n+    Get Text    //body    contains    Action Settings\n+    Type Text    //input[@name="form.widgets.title"]    A new site map\n+    Click    //div[contains(@class,\'pattern-modal-buttons\')]/button\n+\n \n I change the actions order\n-  Click Link    css=section:nth-child(3) li:first-child a\n-  Wait until page contains  Action Settings\n-  Input Text for sure  form.widgets.position  3\n-  Wait For Then Click Element  css=.pattern-modal-buttons > button\n+    Click    //*[@id="content-core"]/section[2]/section/ol/li[1]/form/a\n+    Get Text    //body    contains    Action Settings\n+    Type Text    //input[@name="form.widgets.position"]    3\n+    Click    //div[contains(@class,\'pattern-modal-buttons\')]/button\n+\n \n I add a new action\n-  Click Link  Add new action\n-  Wait until page contains  New action\n-  Select From List By Label   form.widgets.category:list   User actions\n-  Input Text for sure  form.widgets.id  favorites\n-  Wait For Then Click Element  css=.pattern-modal-buttons > button\n-  Wait until page contains  favorites\n-  Wait For Then Click Element  css=section.category:last-child li:last-child a\n-  Wait until page contains  Action Settings\n-  Input Text for sure  form.widgets.title  My favorites\n-  Input Text for sure  form.widgets.url_expr  string:\\${globals_view/navigationRootUrl}/favorites\n-  Wait For Then Click Element  css=.pattern-modal-buttons > button\n+    Click    //*[@id="content-core"]/p[@class="addAction"]/a\n+    Get Text    //body    contains    New action\n+    Select Options By    //select[@name="form.widgets.category:list"]    label    User actions\n+    Type Text    //input[@name="form.widgets.id"]    favorites\n+    Click    //div[contains(@class,\'pattern-modal-buttons\')]/button\n+    Get Text    //body    contains    favorites\n+    Click    //*[@id="content-core"]/section[6]/section/ol/li[8]/form/a\n+    Get Text    //body    contains    Action Settings\n+    Type Text    //input[@name="form.widgets.title"]    My favorites\n+    Type Text    //input[@name="form.widgets.url_expr"]    string:\\${globals_view/navigationRootUrl}/favorites\n+    Click    //div[contains(@class,\'pattern-modal-buttons\')]/button\n \n-I delete an action\n-  Click Button    css=section:nth-child(3) li:first-child button[name=delete]\n-  Handle alert\n \n I hide an action\n-  Click Button    css=section:nth-child(3) li:first-child button[name=hide]\n+    Click    //*[@id="content-core"]/section[2]/section/ol/li[1]/form/button[@name="hide"]\n+\n \n I unhide the action\n-  Click Button    css=section:nth-child(3) li:first-child button[name=show]\n+    Click    //*[@id="content-core"]/section[2]/section/ol/li[1]/form/button[@name="show"]\n+\n \n-# --- THEN -------------------------------------------------------------------\n+I delete an action\n+    Handle Future Dialogs    action=accept\n+    Click    //*[@id="content-core"]/section[2]/section/ol/li[1]/form/button[@name="delete"]\n+\n+\n+# THEN\n \n anonymous users can see the new action title\n-  Disable autologin\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Accessibility\n-  Page Should Contain  A new site map\n+    Disable autologin\n+    Go to    ${PLONE_URL}\n+    Get Text    //body    contains    A new site map\n+\n \n anonymous users can see the actions new ordering\n-  Disable autologin\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Accessibility\n-  Page Should Contain Element   xpath=//div[@id=\'portal-footer\']//ul/li[1]/a/span[contains(text(), \'Accessibility\')]\n-  Page Should Contain Element   xpath=//div[@id=\'portal-footer\']//ul/li[3]/a/span[contains(text(), \'Site Map\')]\n+    Disable autologin\n+    Go to  ${PLONE_URL}\n+    Get Element    //div[@id=\'portal-footer\']//ul/li[1]/a/span[contains(text(), \'Accessibility\')]\n+    Get Element    //div[@id=\'portal-footer\']//ul/li[3]/a/span[contains(text(), \'Site Map\')]\n+\n \n logged-in users can see the new action\n-  Disable autologin\n-  Enable autologin as   Contributor\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Accessibility\n-  Page Should Contain  My favorites\n+    Disable autologin\n+    Enable autologin as   Contributor\n+    Go to  ${PLONE_URL}\n+    Get Element Count    //*[@id="personaltools-favorites"]    should be    1\n+    Get Text    //*[@id="personaltools-favorites"]    contains    My favorites\n+\n \n anonymous users cannot see the action anymore\n-  Disable autologin\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Accessibility\n-  Page Should Not Contain  Site Map\n+    Disable autologin\n+    Go to  ${PLONE_URL}\n+    Get Text    //body    not contains    Site Map\n+\n \n anonymous users can see the action again\n-  Disable autologin\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Accessibility\n-  Page Should Contain  Site Map\n+    Disable autologin\n+    Go to  ${PLONE_URL}\n+    Get Text    //body    contains    Site Map\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_editing.robot b/Products/CMFPlone/tests/robot/test_controlpanel_editing.robot\nindex 3d997f0899..66ac2ed25f 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_editing.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_editing.robot\n@@ -1,105 +1,109 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n+*** Variables ***\n \n-*** Test Cases ***************************************************************\n+${PAGE_TITLE}    Doc\n+${PAGE_ID}    doc\n+\n+*** Test Cases ***\n \n Scenario: Disable Standard Editor in the Editing Control Panel\n-  Given a logged-in site administrator\n-    and the editing control panel\n-   When I disable the standard editor\n-# XXX: This test fails because the TinyMCE 4 widget ignores both the old and\n-# the new setting.\n-#   Then I do not see the standard editor when I create a document\n+    Given a logged-in site administrator\n+      and the editing control panel\n+     When I disable the standard editor\n+     Then I do not see the standard editor when I create a document\n+\n+     When I go to the editing control panel\n+      and I enable the standard editor\n+     Then I see the standard editor when I create a document\n+\n \n Scenario: Enable Link Integrity Check in the Editing Control Panel\n-  Given a logged-in site administrator\n-    and the editing control panel\n-   When I enable link integrity checks\n-# XXX: Enabling referencefield behaviour for Documents to make this test work makes other tests fail.\n-# See https://github.com/plone/Products.CMFPlone/issues/255 for details.\n-#   Then I will be warned if I remove a linked document\n+    Given a logged-in site administrator\n+      and the editing control panel\n+    When I enable link integrity checks\n+    # Linkintegrity checks are in `test_linkintegrity.robot`\n \n \n Scenario: Enable Lock on Through The Web in the Editing Control Panel\n-  Given a logged-in site administrator\n-    and the editing control panel\n-   When I enable lock on through the web\n-# XXX: This test is not finished yet.\n-#   Then I will see a warning if a document is edited by another user\n+    Given a logged-in site administrator\n+      and the editing control panel\n+      and a document \'${PAGE_TITLE}\'\n+     When I enable lock on through the web\n+      and I edit the document\n+     Then I will see a warning if a document is edited by another user\n \n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n-# --- GIVEN ------------------------------------------------------------------\n+# GIVEN\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+the editing control panel\n+    Go to    ${PLONE_URL}/@@editing-controlpanel\n \n-a logged-in manager\n-  Enable autologin as  Manager\n \n-a document \'${title}\'\n-  Create content  type=Document  id=doc  title=${title}\n+# WHEN\n \n-the editing control panel\n-  Go to  ${PLONE_URL}/@@editing-controlpanel\n-  Wait until page contains  Editing Settings\n+I disable the standard editor\n+    Select Options By    //select[@name="form.widgets.default_editor:list"]    label    None\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n-# --- WHEN -------------------------------------------------------------------\n \n-I disable the standard editor\n-  Select from list by label  name=form.widgets.default_editor:list  None\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+I enable the standard editor\n+    Select Options By    //select[@name="form.widgets.default_editor:list"]    label    TinyMCE\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n+\n+\n+I go to the editing control panel\n+    Go to    ${PLONE_URL}/@@editing-controlpanel\n+\n \n I enable link integrity checks\n-  Select Checkbox  name=form.widgets.enable_link_integrity_checks:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.enable_link_integrity_checks:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n+\n \n I enable lock on through the web\n-  Select Checkbox  name=form.widgets.lock_on_ttw_edit:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.lock_on_ttw_edit:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n+I edit the document\n+    Go to    ${PLONE_URL}/${PAGE_ID}\n+    Click    //li[@id="contentview-edit"]/a\n+    Get Text    //body    contains    Edit Page\n \n-# --- THEN -------------------------------------------------------------------\n \n-I can see an id field in the settings tab when I create a document\n-  Go To  ${PLONE_URL}/++add++Document\n-  Given patterns are loaded\n-  Execute Javascript  $(\'#form-widgets-IDublinCore-title\').val(\'My Document\'); return 0;\n-  Click Link  Settings\n-  Page should contain element  name=form.widgets.IShortName.id\n-  Input Text  name=form.widgets.IShortName.id  this-is-my-custom-short-name\n-  Click Button  Save\n-  Wait until page contains  Item created\n-  Location should be  ${PLONE_URL}/this-is-my-custom-short-name/view\n+# THEN\n \n I do not see the standard editor when I create a document\n-  Go To  ${PLONE_URL}/++add++Document\n-  Wait until page contains  Add Page\n-  Page should not contain element  css=.mce-tinymce\n-\n-I will be warned if I remove a linked document\n-  ${doc1_uid}=  Create content  id=doc1  type=Document\n-  ${doc2_uid}=  Create content  id=doc2  type=Document\n-  Set field value  uid=${doc1_uid}  field=text  field_type=text/html  value=<p><a href=\'resolveuid/${doc2_uid}\' data-val=\'${doc2_uid}\' data-linktype=\'internal\'>link</a></p>\n-  Go To  ${PLONE_URL}/doc2/delete_confirmation\n-  Wait until page contains  doc2\n-  Click Button  Delete\n-  Wait until page contains  Potential link breakage\n+    Go To  ${PLONE_URL}/++add++Document\n+    Wait For Condition    Classes    //body    contains    patterns-loaded\n+    Get Element Count    //*[@id="formfield-form-widgets-IRichTextBehavior-text"]/div[@role="application"]    should be    0\n+    Get Element States    //textarea[@name="form.widgets.IRichTextBehavior.text"]    contains    visible\n+\n+\n+I see the standard editor when I create a document\n+    Go To  ${PLONE_URL}/++add++Document\n+    Wait For Condition    Classes    //body    contains    patterns-loaded\n+    Get Element Count    //*[@id="formfield-form-widgets-IRichTextBehavior-text"]/div[@role="application"]    should be    1\n+    Get Element States    //textarea[@name="form.widgets.IRichTextBehavior.text"]    contains    hidden\n \n I will see a warning if a document is edited by another user\n-  ${doc1_uid}=  Create content  id=doc1  type=Document\n+    Disable autologin\n+    Enable autologin as   Contributor    Reviewer    Manager\n+    New Page    ${PLONE_URL}/${PAGE_ID}\n+    Get Text    //body    contains    Lock\n+    Get Element Count    //input[@value="Unlock"]    should be    1\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot b/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot\nindex bcdf3307aa..9d48ebb955 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot\n@@ -1,160 +1,162 @@\n-# ============================================================================\n-# Tests for the Plone Filter Control Panel\n-# ============================================================================\n-#\n-# $ bin/robot-server --reload-path src/Products.CMFPlone/Products/CMFPlone/ Products.CMFPlone.testing.PRODUCTS_CMFPLONE_ROBOT_TESTING\n-#\n-# $ bin/robot src/Products.CMFPlone/Products/CMFPlone/tests/robot/test_controlpanel_filter.robot\n-#\n-# ============================================================================\n-\n *** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n-\n-Library  Remote  ${PLONE_URL}/RobotRemote\n-Library  Collections\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Resource  keywords.robot\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n \n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Configure Filter Control Panel to filter out nasty tags\n-  Given a logged-in site administrator\n-    and the filter control panel\n-   When I add \'h1\' to the nasty tags list and remove it from the valid tags list\n-   Then the \'h1\' tag is filtered out when a document is saved\n+    Given a logged-in site administrator\n+      and the filter control panel\n+     When I add \'h1\' to the nasty tags list and remove it from the valid tags list\n+     Then the \'h1\' tag is filtered out when a document is saved\n \n Scenario: Configure Filter Control Panel to strip out tags\n-  Given a logged-in site administrator\n-    and the filter control panel\n-   When I remove \'h1\' from the valid tags list\n-   Then the \'h1\' tag is stripped when a document is saved\n+    Given a logged-in site administrator\n+      and the filter control panel\n+     When I remove \'h1\' from the valid tags list\n+     Then the \'h1\' tag is stripped when a document is saved\n \n Scenario: Configure Filter Control Panel to allow custom tags\n-  Given a logged-in site administrator\n-    and the filter control panel\n-   When I add \'foobar\' to the valid tags list\n-   Then the \'foobar\' tag is preserved when a document is saved\n+    Given a logged-in site administrator\n+      and the filter control panel\n+     When I add \'foobar\' to the valid tags list\n+     Then the \'foobar\' tag is preserved when a document is saved\n \n Scenario: Configure Filter Control Panel to allow custom attributes\n-  Given a logged-in site administrator\n-    and the filter control panel\n-   When I add \'foo-foo\' to the custom attributes list\n-   Then the \'foo-foo\' attribute is preserved when a document is saved\n+    Given a logged-in site administrator\n+      and the filter control panel\n+     When I add \'foo-foo\' to the custom attributes list\n+     Then the \'foo-foo\' attribute is preserved when a document is saved\n \n Scenario: Filter Control Panel displays information regarding caching when saved\n-  Given a logged-in site administrator\n-    and the filter control panel\n-   When I save the form\n-   Then success message should contain information regarding caching\n-\n+    Given a logged-in site administrator\n+      and the filter control panel\n+     When I save the form\n+     Then success message should contain information regarding caching\n \n-*** Keywords *****************************************************************\n \n-# --- GIVEN ------------------------------------------------------------------\n+*** Keywords ***\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+# GIVEN\n \n the filter control panel\n-  Go to  ${PLONE_URL}/@@filter-controlpanel\n-  Wait until page contains  HTML Filtering Settings\n-\n-Input RichText\n-  [Arguments]  ${input}\n-  # Sleep to avoid random failures where the text is not actually set.\n-  # This warning from the robotframework docs might be the cause:\n-  # "Starting from Robot Framework 2.5 errors caused by invalid syntax, timeouts,\n-  # or fatal exceptions are not caught by this keyword."\n-  # See https://robotframework.org/robotframework/2.6.1/libraries/BuiltIn.html#Wait%20Until%20Keyword%20Succeeds\n-  Sleep  1\n-  Wait until keyword succeeds  5s  1s  Set and Check TinyMCE Content  ${input}\n-\n-Set and Check TinyMCE Content\n-  [Arguments]  ${input}\n-  # Simply check if tinyMCE.getContent() isn\'t empty when we set an input\n-  Execute Javascript   tinyMCE.activeEditor.setContent(\'${input}\');\n-  Sleep  0.5\n-  ${check}=  Execute Javascript  return tinyMCE.activeEditor.getContent();\n-  Should not be empty  ${check}\n-\n-\n-# --- WHEN -------------------------------------------------------------------\n+    Go to    ${PLONE_URL}/@@filter-controlpanel\n+\n+# WHEN\n \n I add \'${tag}\' to the nasty tags list and remove it from the valid tags list\n-  Input Text  name=form.widgets.nasty_tags  ${tag}\n-  Remove line from textarea  form.widgets.valid_tags  ${tag}\n-  I save the form\n+    Type Text    //textarea[@name="form.widgets.nasty_tags"]    ${tag}\n+    Remove line from textarea    form.widgets.valid_tags    ${tag}\n+    I save the form\n+\n+\n+I save the form\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n+\n \n I remove \'${tag}\' from the valid tags list\n-  Remove line from textarea  form.widgets.valid_tags  ${tag}\n-  I save the form\n+    Remove line from textarea    form.widgets.valid_tags    ${tag}\n+    I save the form\n+\n \n I add \'${tag}\' to the valid tags list\n-  Input Text  name=form.widgets.valid_tags  ${tag}\n-  I save the form\n-  Page Should Contain  ${tag}\n+    Type Text    //textarea[@name="form.widgets.valid_tags"]    ${tag}\n+    I save the form\n+    Get Text    //textarea[@name="form.widgets.valid_tags"]    contains    ${tag}\n+\n \n I add \'${tag}\' to the custom attributes list\n-  Input Text  name=form.widgets.custom_attributes  ${tag}\n-  I save the form\n-  Page Should Contain  ${tag}\n+    Type Text    //textarea[@name="form.widgets.custom_attributes"]    ${tag}\n+    I save the form\n+    Get Text    //textarea[@name="form.widgets.custom_attributes"]    contains    ${tag}\n \n-I save the form\n-  Wait For Then Click Element  form.buttons.save\n-  Wait until page contains  Changes saved\n+# THEN\n \n+the \'h1\' tag is filtered out when a document is saved\n \n-# --- THEN -------------------------------------------------------------------\n+    ${doc1_uid}=    Create content\n+    ...    id=doc1\n+    ...    title=Document 1\n+    ...    type=Document\n+    Go To    ${PLONE_URL}/doc1/edit\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <p>heading</p><p>Spanish Inquisition</p>\n+    Mark text heading as h1 in tinymce editor\n+    I save the form\n+    Get Text    //body    contains    Spanish Inquisition\n+    Get Text    //body    not contains    heading\n \n-the \'h1\' tag is filtered out when a document is saved\n-  ${doc1_uid}=  Create content  id=doc1  title=Document 1  type=Document\n-  Go To  ${PLONE_URL}/doc1/edit\n-  patterns are loaded\n-  Input RichText  <h1>h1 heading</h1><p>Spanish Inquisition</p>\n-  I save the form\n-  # We check that some standard text is there, before checking the interesting part.\n-  # If the standard text is invisible, then something completely different is wrong.\n-  # I see tests randomly fail where the safe html transform is not even called.\n-  # In fact, no text is saved.  Maybe some timing problem.\n-  # I suspect the Input RichText keyword, which is why I added Sleep in there.\n-  Page should contain  Spanish Inquisition\n-  Page should not contain  heading\n \n the \'h1\' tag is stripped when a document is saved\n-  ${doc1_uid}=  Create content  id=doc1  title=Document 1  type=Document\n-  Go To  ${PLONE_URL}/doc1/edit\n-  patterns are loaded\n-  Input RichText  <h1>h1 heading</h1><p>Spanish Inquisition</p>\n-  I save the form\n-  Page should contain  Spanish Inquisition\n-  Page should contain  heading\n-  Page Should Contain Element  //div[@id=\'content-core\']//h1  limit=0  message=h1 should have been stripped out\n+\n+    ${doc1_uid}=    Create content\n+    ...    id=doc1\n+    ...    title=Document 1\n+    ...    type=Document\n+    Go To  ${PLONE_URL}/doc1/edit\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <p>heading</p><p>Spanish Inquisition</p>\n+    Mark text heading as h1 in tinymce editor\n+    I save the form\n+    Get Text    //body    contains    Spanish Inquisition\n+    Get Text    //body    contains    heading\n+    Get Element Count    //div[@id=\'content-core\']//h1    should be    0    message=h1 should have been stripped out\n+\n \n the \'${tag}\' tag is preserved when a document is saved\n-  ${doc1_uid}=  Create content  id=doc1  title=Document 1  type=Document\n-  Go To  ${PLONE_URL}/doc1/edit\n-  patterns are loaded\n-  Input RichText  <${tag}>lorem ipsum</${tag}><p>Spanish Inquisition</p>\n-  I save the form\n-  Page should contain  Spanish Inquisition\n-  Page Should Contain Element  //div[@id=\'content-core\']//${tag}  limit=1  message=the ${tag} tag should have been preserved\n+\n+    ${doc1_uid}=    Create content\n+    ...    id=doc1\n+    ...    title=Document 1\n+    ...    type=Document\n+    Go To    ${PLONE_URL}/doc1/edit\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <${tag}>lorem ipsum</${tag}><p>Spanish Inquisition</p>\n+    I save the form\n+    Get Text    //body    contains    Spanish Inquisition\n+    Get Element Count    //div[@id=\'content-core\']//${tag}    should be    1    message=the ${tag} tag should have been preserved\n+\n \n the \'${attribute}\' attribute is preserved when a document is saved\n-  ${doc1_uid}=  Create content  id=doc1  title=Document 1  type=Document\n-  Go To  ${PLONE_URL}/doc1/edit\n-  patterns are loaded\n-  Input RichText  <span ${attribute}="foo">lorem ipsum</span><p>Spanish Inquisition</p>\n-  I save the form\n-  Page should contain  Spanish Inquisition\n-  Page Should Contain Element  //span[@${attribute}]  limit=1  message=the ${attribute} tag should have been preserved\n+\n+    ${doc1_uid}=  Create content\n+    ...    id=doc1\n+    ...    title=Document 1\n+    ...    type=Document\n+    Go To    ${PLONE_URL}/doc1/edit\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <span ${attribute}="foo">lorem ipsum</span><p>Spanish Inquisition</p>\n+    I save the form\n+    Get Text    //body    contains    Spanish Inquisition\n+    Get Element Count    //span[@${attribute}]    should be    1    message=the ${attribute} tag should have been preserved\n+\n \n success message should contain information regarding caching\n-  Element Should Contain  css=.alert-warning  HTML generation is heavily cached across Plone. You may have to edit existing content or restart your server to see the changes.\n+    Get Text    //*[contains(@class,"alert-warning")]    contains    HTML generation is heavily cached across Plone. You may have to edit existing content or restart your server to see the changes.\n+\n+\n+# DRY\n+\n+Mark text heading as h1 in tinymce editor\n+\n+    # select the text `heading` via javascript\n+    Evaluate JavaScript    //div[contains(@class, \'tox-edit-area\')]//iframe\n+    ...    (elem, args) => {\n+    ...        let iframe_document = elem.contentDocument;\n+    ...        let body = iframe_document.body;\n+    ...        let p = body.firstChild;\n+    ...        let range = new Range();\n+    ...        range.setStart(p.firstChild, 0);\n+    ...        range.setEnd(p.firstChild, 7);\n+    ...        iframe_document.getSelection().removeAllRanges();\n+    ...        iframe_document.getSelection().addRange(range);\n+    ...    }\n+    ...    all_elements=False\n+    # here we use the editor to format the text `heading` with h1\n+    Click    //button[@aria-label="Format Paragraph"]\n+    Hover    //div[@aria-label="Headers"]\n+    Click    //h1[contains(text(), "Header 1")]\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_language.robot b/Products/CMFPlone/tests/robot/test_controlpanel_language.robot\nindex 163081cffa..f7f9c265ad 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_language.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_language.robot\n@@ -1,51 +1,43 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n-\n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Set Site Language in the Language Control Panel\n-  Given a logged-in site administrator\n-    and the language control panel\n-   When I set the site language to German\n-   Then the Plone user interface is in German\n-\n+    Given a logged-in site administrator\n+      and the language control panel\n+     When I set the site language to German\n+     Then the Plone user interface is in German\n \n-*** Keywords *****************************************************************\n \n-# --- GIVEN ------------------------------------------------------------------\n+*** Keywords ***\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+# GIVEN\n \n the language control panel\n-  Go to  ${PLONE_URL}/@@language-controlpanel\n-  Wait until page contains  Language Settings\n+    Go to  ${PLONE_URL}/@@language-controlpanel\n+    Get Text    //body    contains    Language Settings\n \n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I set the site language to German\n-  Select From List By Label  form.widgets.default_language:list  Deutsch\n-  Select From List By Label  form.widgets.available_languages.from  Deutsch\n-  Click Button  \xe2\x86\x92\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Select Options By    //select[@name="form.widgets.default_language:list"]    label    Deutsch\n+    Select Options By    //select[@name="form.widgets.available_languages.from"]    label    Deutsch\n+    Click    //button[@value="\xe2\x86\x92"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n the Plone user interface is in German\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Lizensiert unter der\n-  Page should contain  Lizensiert unter der\n+    Go to    ${PLONE_URL}\n+    Get Text    //body    contains    Lizensiert unter der\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot b/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot\nindex d629df48a9..9b43a45cec 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_markup.robot\n@@ -1,70 +1,67 @@\n-Documentation\n-...            $ bin/robot-server Products.CMFPlone.testing.PRODUCTS_CMFPLONE_ROBOT_TESTING\n-...            $ bin/robot test_controlpanel_markup.robot\n+*** Settings ***\n \n-*** Settings *****************************************************************\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Resource  keywords.robot\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n-\n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Change Default Markup Types in the Markup Control Panel\n-  Given a logged-in site administrator\n-    and the markup control panel\n-   When I set allowed types to "text/restructured"\n-#TODO: Waiting on richtext pattern to support this\n-#   Then I do not see the standard editor when I create a document\n+    Given a logged-in site administrator\n+      and the markup control panel\n+     When I set allowed types to    text/restructured\n+\n+    #TODO: Waiting on richtext pattern to support this\n+    #Then I do not see the standard editor when I create a document\n \n Scenario: Set Default Markup to be Restructured Text\n-  Given a logged-in site administrator\n-    and the markup control panel\n-   When I set the default type to "text/restructured"\n-#TODO: Waiting on richtext pattern to support this\n-#   Then I do not see the standard editor when I create a document\n+    Given a logged-in manager\n+      and the markup control panel\n+     When I set the default type to    text/restructured\n \n-*** Keywords *****************************************************************\n+    #TODO: Waiting on richtext pattern to support this\n+    #Then I do not see the standard editor when I create a document\n \n-# --- GIVEN ------------------------------------------------------------------\n+*** Keywords ***\n \n-a document \'${title}\'\n-  Create content  type=Document  id=doc  title=${title}\n+# GIVEN\n \n the markup control panel\n-  Go to  ${PLONE_URL}/@@markup-controlpanel\n-  Wait until page contains  Markup Settings\n+    Go to    ${PLONE_URL}/@@markup-controlpanel\n+    Get Text    //body    contains    Markup Settings\n \n \n # --- WHEN -------------------------------------------------------------------\n \n-I set allowed types to "${type}"\n-  with the label  ${type}   Select Checkbox\n-  with the label  text/html  UnSelect Checkbox\n-  with the label  text/x-web-textile  UnSelect Checkbox\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n-  Checkbox Should Be Selected  ${type}\n-  Checkbox Should Not Be Selected  text/html\n-  Checkbox Should Not Be Selected  text/x-web-textile\n+I set allowed types to\n+    [Arguments]    ${type}\n \n-I set the default type to "${type}"\n-  Select from list by label  name=form.widgets.default_type:list  ${type}\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.allowed_types:list" and @value="${type}"]\n+    Uncheck Checkbox    //input[@name="form.widgets.allowed_types:list" and @value="text/html"]\n+    Uncheck Checkbox    //input[@name="form.widgets.allowed_types:list" and @value="text/x-web-textile"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n-I disable the standard editor\n-  Select from list by label  name=form.widgets.default_editor:list  None\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Get Element States    //input[@name="form.widgets.allowed_types:list" and @value="${type}"]    contains    checked\n+    Get Element States    //input[@name="form.widgets.allowed_types:list" and @value="text/html"]    not contains    checked\n+    Get Element States    //input[@name="form.widgets.allowed_types:list" and @value="text/x-web-textile"]    not contains    checked\n+\n+I set the default type to\n+    [Arguments]    ${type}\n+\n+    Select Options By    //select[@name="form.widgets.default_type:list"]    value    ${type}\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n+\n+# I disable the standard editor\n+#   Select from list by label  name=form.widgets.default_editor:list  None\n+#   Click Button  Save\n+#   Wait until page contains  Changes saved\n \n \n # --- THEN -------------------------------------------------------------------\n@@ -80,22 +77,7 @@ Then I can see only "${type}" when creating a document\n   Wait until page contains  Item created\n   Location should be  ${PLONE_URL}/this-is-my-custom-short-name/view\n \n-I do not see the standard editor when I create a document\n-  Go To  ${PLONE_URL}/++add++Document\n-  Wait until page contains  Add Page\n-  Page should not contain element  css=.mce-tinymce\n-\n-# --- Helpers -----------------------------------------------------------------\n-\n-With the label\n-    [arguments]  ${title}    ${extra_keyword}   @{list}\n-    ${for}=  label "${title}"\n-    Run Keyword     ${extra_keyword}  id=${for}   @{list}\n-\n-label "${title}"\n-    [Return]  ${for}\n-    ${for}=  Get Element Attribute  xpath=//label[contains(., "${title}")]  for\n-\n-label2 "${title}"\n-    [Return]  ${for}\n-    ${for}=  Get Element Attribute  xpath=//label[contains(., "${title}")]//input\n+# I do not see the standard editor when I create a document\n+#     Go To  ${PLONE_URL}/++add++Document\n+#     Pause\n+#     Page should not contain element  css=.mce-tinymce\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_navigation.robot b/Products/CMFPlone/tests/robot/test_controlpanel_navigation.robot\nindex c277aedf52..f40e8b751c 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_navigation.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_navigation.robot\n@@ -1,115 +1,115 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n \n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Disable Generate Tabs in the Navigation Control Panel\n-  Given a logged-in site administrator\n-    and a document \'My Document\'\n-    and the navigation control panel\n-   When I disable generate tabs\n-   Then the document \'My Document\' does not show up in the navigation\n+    Given a logged-in site administrator\n+      and a document \'My Document\'\n+      and the navigation control panel\n+     When I disable generate tabs\n+     Then the document \'My Document\' does not show up in the navigation\n \n Scenario: Enable Folderish Tabs in the Navigation Control Panel\n-  Given a logged-in site administrator\n-    and a document \'My Document\'\n-    and the navigation control panel\n-   When I disable non-folderish tabs\n-   Then the document \'My Document\' does not show up in the navigation\n+    Given a logged-in site administrator\n+      and a document \'My Document\'\n+      and the navigation control panel\n+     When I disable non-folderish tabs\n+     Then the document \'My Document\' does not show up in the navigation\n \n Scenario: Filter Navigation By Displayed Types in the Navigation Control Panel\n-  Given a logged-in site administrator\n-    and a document \'My Document\'\n-    and the navigation control panel\n-   When I remove \'Document\' from the displayed types list\n-   Then the document \'My Document\' does not show up in the navigation\n-    and the document \'My Document\' does not show up in the sitemap\n+    Given a logged-in site administrator\n+      and a document \'My Document\'\n+      and the navigation control panel\n+     When I remove \'Document\' from the displayed types list\n+     Then the document \'My Document\' does not show up in the navigation\n+      and the document \'My Document\' does not show up in the sitemap\n \n-#Scenario: Filter Navigation By Workflow States in the Navigation Control Panel\n-#  Given a logged-in site administrator\n-#    and a published document \'My Document\'\n-#    and a private document \'My Internal Document\'\n-#    and the navigation control panel\n-#   When I enable filtering by workflow states\n-#    and I choose to show \'published\' items\n-#    and I choose to not show \'private\' items\n-#   Then the document \'My Document\' shows up in the navigation\n-#    and the document \'My Internal Document\' does not show up in the navigation\n+Scenario: Filter Navigation By Workflow States in the Navigation Control Panel\n+    Given a logged-in site administrator\n+      and a published document \'My Document\'\n+      and a private document \'My Internal Document\'\n+      and the navigation control panel\n+     When I enable filtering by workflow states\n+      and I choose to show \'published\' items\n+      and I choose to not show \'private\' items\n+     Then the document \'My Document\' shows up in the navigation\n+      and the document \'My Internal Document\' does not show up in the navigation\n \n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n-# --- GIVEN ------------------------------------------------------------------\n+# GIVEN\n \n the navigation control panel\n-  Go to  ${PLONE_URL}/@@navigation-controlpanel\n-  Wait until page contains  Navigation Settings\n+    Go to  ${PLONE_URL}/@@navigation-controlpanel\n+    Get Text    //body    contains    Navigation Settings\n \n a published document \'${title}\'\n-  ${uid}=  a document \'${title}\'\n-  Fire transition  ${uid}  publish\n+    ${uid}=    Create content\n+    ...    type=Document\n+    ...    id=doc\n+    ...    title=${title}\n+    Fire transition    ${uid}    publish\n \n a private document \'${title}\'\n-  a document \'${title}\'\n+    Create content\n+    ...    type=Document\n+    ...    id=doc1\n+    ...    title=${title}\n \n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I disable generate tabs\n-  Unselect Checkbox  form.widgets.generate_tabs:list\n-  Wait For Then Click Element  form.buttons.save\n-  Wait until page contains  Changes saved\n+    Uncheck Checkbox    //input[@name="form.widgets.generate_tabs:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n I disable non-folderish tabs\n-  Unselect Checkbox  xpath=//input[@value=\'Document\']\n-  Wait For Then Click Element  form.buttons.save\n-  Wait until page contains  Changes saved\n+    Uncheck Checkbox  //input[@value=\'Document\']\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n I remove \'${portal_type}\' from the displayed types list\n-  Unselect Checkbox  xpath=//input[@value=\'Document\']\n-  Wait For Then Click Element  form.buttons.save\n-  Wait until page contains  Changes saved\n+    Uncheck Checkbox  //input[@value=\'Document\']\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n I enable filtering by workflow states\n-  Select Checkbox  name=form.widgets.filter_on_workflow:list\n-  Wait For Then Click Element  form.buttons.save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.filter_on_workflow:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n I choose to show \'${workflow_state}\' items\n-  Select Checkbox  xpath=//input[@value=\'${workflow_state}\']\n-  Wait For Then Click Element  form.buttons.save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@value=\'${workflow_state}\']\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n I choose to not show \'${workflow_state}\' items\n-  Unselect Checkbox  xpath=//input[@value=\'${workflow_state}\']\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Uncheck Checkbox    //input[@value=\'${workflow_state}\']\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n the document \'${title}\' shows up in the navigation\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Powered by Plone\n-  Page Should Contain Element  //ul[@id=\'portal-globalnav\']/li/a[contains(text(), \'${title}\')]  limit=1  message=The global navigation should have contained the item \'${title}\'\n+    Go to    ${PLONE_URL}\n+    Get Element Count    //ul[@id=\'portal-globalnav\']/li/a[contains(text(), \'${title}\')]    should be    1    message=The global navigation should have contained the item \'${title}\'\n \n the document \'${title}\' does not show up in the navigation\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Powered by Plone\n-  Page Should Contain Element  //ul[@id=\'portal-globalnav\']/li/a[contains(text(), \'${title}\')]  limit=0  message=The global navigation should not have contained the item \'${title}\'\n+    Go to    ${PLONE_URL}\n+    Get Element Count    //ul[@id=\'portal-globalnav\']/li/a[contains(text(), \'${title}\')]    should be    0    message=The global navigation should not have contained the item \'${title}\'\n \n the document \'${title}\' does not show up in the sitemap\n-  Go to  ${PLONE_URL}/sitemap\n-  Wait until page contains  Powered by Plone\n-  Page Should Contain Element  //ul[@id=\'portal-sitemap\']/li/a/span[contains(text(), \'${title}\')]  limit=0  message=The sitemap should not have contained the item \'${title}\'\n+    Go to    ${PLONE_URL}/sitemap\n+    Get Element Count    //ul[@id=\'portal-sitemap\']/li/a/span[contains(text(), \'${title}\')]    should be    0    message=The sitemap should not have contained the item \'${title}\'\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot b/Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot\nindex 6c2f6673c5..037cea873f 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_redirection.robot\n@@ -1,43 +1,40 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n \n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Add redirect in the URL Management Control Panel\n-  Given a logged-in site administrator\n-    and the URL Management control panel\n-  When I add a redirect to the test folder from alternative url  /old\n-  Then I get redirected to the test folder when visiting  /old\n+    Given a logged-in site administrator\n+      and the URL Management control panel\n+     When I add a redirect to the test folder from alternative url  /old\n+     Then I get redirected to the test folder when visiting  /old\n \n \n Scenario: Remove redirect in the URL Management Control Panel\n-  Given a logged-in site administrator\n-    and the URL Management control panel\n-  When I add a redirect to the test folder from alternative url  /old\n-   and I remove the redirect from alternative url  /old\n-  Then I do not get redirected when visiting  /old\n+    Given a logged-in site administrator\n+      and the URL Management control panel\n+     When I add a redirect to the test folder from alternative url  /old\n+      and I remove the redirect from alternative url  /old\n+     Then I do not get redirected when visiting  /old\n \n \n Scenario: Remove filtered redirects in the URL Management Control Panel\n-  Given a logged-in site administrator\n-    and the URL Management control panel\n-  When I add a redirect to the test folder from alternative url  /a\n-   and I add a redirect to the test folder from alternative url  /b\n-   and I filter the redirects with path  /a\n-   and I remove the matching redirects\n-  Then I do not get redirected when visiting  /a\n-   and I get redirected to the test folder when visiting  /b\n+    Given a logged-in site administrator\n+      and the URL Management control panel\n+     When I add a redirect to the test folder from alternative url  /a\n+      and I add a redirect to the test folder from alternative url  /b\n+      and I filter the redirects with path  /a\n+      and I remove the matching redirects\n+     Then I do not get redirected when visiting  /a\n+      and I get redirected to the test folder when visiting  /b\n \n \n Scenario: Download all redirects in the URL Management Control Panel\n@@ -48,58 +45,59 @@ Scenario: Download all redirects in the URL Management Control Panel\n   Then I can download all redirects as CSV\n \n \n-*** Keywords *****************************************************************\n-\n-# --- GIVEN ------------------------------------------------------------------\n+*** Keywords ***\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+# GIVEN\n \n the URL Management control panel\n-  Go to  ${PLONE_URL}/@@redirection-controlpanel\n+    Go to  ${PLONE_URL}/@@redirection-controlpanel\n \n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I add a redirect to the test folder from alternative url\n-  [Documentation]  target path must exist in the site\n-  [Arguments]  ${old}\n-  Input Text  name=redirection  ${old}\n-  Input Text  name=target_path  /test-folder\n-  Click Button  Add\n+    [Documentation]  target path must exist in the site\n+    [Arguments]    ${old}\n+    Type Text    //input[@name="redirection"]    ${old}\n+    Type Text    //input[@name="target_path"]    /test-folder\n+    Click    //button[@name="form.button.Add"]\n \n \n I remove the redirect from alternative url\n-  [Arguments]  ${old}\n-  Select Checkbox  xpath=//input[@value=\'/plone${old}\']\n-  Click Button  Remove selected\n-\n+    [Arguments]  ${old}\n+    Check Checkbox    //input[@value="/plone${old}"]\n+    Click    //button[@name="form.button.Remove"]\n \n I filter the redirects with path\n-  [Arguments]  ${old}\n-  Input Text  name=q  ${old}\n-  Click Button  Filter\n+    [Arguments]    ${old}\n+    Type Text    //input[@name="q"]    ${old}\n+    Click    //button[@name="form.button.filter"]\n \n I remove the matching redirects\n-  Click Button  Remove all that match filter\n+    Click    //button[@name="form.button.MatchRemove"]\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n I get redirected to the test folder when visiting\n-  [Arguments]  ${old}\n-  Go to  ${PLONE_URL}/${old}\n-  Location Should Be  ${PLONE_URL}/test-folder\n+    [Arguments]    ${old}\n+    Go to    ${PLONE_URL}/${old}\n+    Get Url    should be    ${PLONE_URL}/test-folder\n \n \n I do not get redirected when visiting\n-  [Arguments]  ${old}\n-  Go to  ${PLONE_URL}/${old}\n-  Location Should Be  ${PLONE_URL}/${old}\n-  Wait Until Page Contains  This page does not seem to exist\n+    [Arguments]    ${old}\n+    Go to    ${PLONE_URL}/${old}\n+    Get Url    should be    ${PLONE_URL}/${old}\n+    Get Text    //body    contains    This page does not seem to exist\n \n \n I can download all redirects as CSV\n-  [Documentation]  I don\'t know how to get the contents of the downloaded file\n-  Click Button  Download all as CSV\n-  Page Should Not Contain  there seems to be an error\n+    [Documentation]  Test the download of CSV file\n+\n+    Import library    OperatingSystem\n+\n+    ${dl_promise}    Promise To Wait For Download    saveAs=redirections.csv\n+    Click    //button[@name="form.button.Download"]\n+    ${file_obj}=    Wait For    ${dl_promise}\n+    File Should Exist    ${file_obj}[saveAs]\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_search.robot b/Products/CMFPlone/tests/robot/test_controlpanel_search.robot\nindex de9c3b5cfe..8bc821890b 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_search.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_search.robot\n@@ -1,81 +1,65 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n \n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Enable Livesearch in the Search Control Panel\n-  Given a logged-in site administrator\n-    and a document \'My Document\'\n-    and the search control panel\n-   When I enable livesearch\n-#   Then then searching for \'My Document\' will show a live search\n-# XXX: Not implemented yet. See https://github.com/plone/Products.CMFPlone/issues/176 for details\n+    Given a logged-in site administrator\n+      and a document \'My Document\'\n+      and the search control panel\n+     When I enable livesearch\n+     Then then searching for \'My Document\' will show a live search\n \n Scenario: Exclude Content Types from Search\n-  Given a logged-in site administrator\n-    and a document \'My Document\'\n-    and the search control panel\n-   When I exclude the \'Document\' type from search\n-   Then searching for \'My Document\' will not return any results\n-\n-\n-*** Keywords *****************************************************************\n+    Given a logged-in site administrator\n+      and a document \'My Document\'\n+      and the search control panel\n+     When I exclude the \'Document\' type from search\n+     Then searching for \'My Document\' will not return any results\n \n-# --- GIVEN ------------------------------------------------------------------\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+*** Keywords ***\n \n-a document \'${title}\'\n-  Create content  type=Document  id=doc  title=${title}\n+# GIVEN\n \n the search control panel\n-  Go to  ${PLONE_URL}/@@search-controlpanel\n-  Wait until page contains  Search Settings\n+    Go to    ${PLONE_URL}/@@search-controlpanel\n+    Get Text    //body    contains    Search Settings\n \n-\n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I enable livesearch\n-  Select Checkbox  form.widgets.enable_livesearch:list\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    Check Checkbox  //input[@name="form.widgets.enable_livesearch:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I exclude the \'${portal_type}\' type from search\n-  # Make sure we see the checkbox, in expanded in jenkins it gets a bit under the toolbar\n-  ${element}  Set Variable  xpath=//input[@name=\'form.widgets.types_not_searched:list\' and @value=\'${portal_type}\']\n-  Wait For Element  ${element}\n-  Unselect Checkbox  ${element}\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    # Make sure we see the checkbox, in expanded in jenkins it gets a bit under the toolbar\n+    Check Checkbox  //input[@name=\'form.widgets.types_not_searched:list\' and @value=\'${portal_type}\']\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n then searching for \'My Document\' will show a live search\n-  # XXX: Not implemented yet.\n-  Go to  ${PLONE_URL}\n-  Wait until page contains element  xpath=//input[@name=\'SearchableText\']\n-  Input Text  name=SearchableText  My\n+    Go to    ${PLONE_URL}\n+    Type Text    //input[@name="SearchableText"]    My D\n+    Get Element States    //ul[contains(@class,"livesearch-results")]    contains    visible\n+    Get Text    //ul[contains(@class,"livesearch-results")]    contains    My Document\n \n searching for \'${search_term}\' will not return any results\n-  Go to  ${PLONE_URL}/@@search\n-  Given patterns are loaded\n-  Wait until page contains  No results were found\n-  Input Text  xpath=//form[@id=\'searchform\']//input[@name=\'SearchableText\']  ${search_term}\n-  Submit Form  name=searchform\n-  Wait until page contains  items matching your search terms\n-  Page Should Contain Element  //span[@id=\'search-results-number\' and contains(.,\'0\')]  1\n-\n-\n+    Go to    ${PLONE_URL}/@@search\n+    Get Text    //body    contains    No results were found\n+    Type Text    //form[@id=\'searchform\']//input[@name=\'SearchableText\']    ${search_term}\n+    Click    //input[@type="submit" and @value="Search"]\n+    Get Text    //body    contains    items matching your search terms\n+    Get Text    //span[@id=\'search-results-number\']    should be    0\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_security.robot b/Products/CMFPlone/tests/robot/test_controlpanel_security.robot\nindex 535f96945e..f7dd470b21 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_security.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_security.robot\n@@ -1,190 +1,172 @@\n *** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Enable self registration in the Security Control Panel\n-  Given a logged-in site administrator\n-    and the security control panel\n-   When I enable self registration\n-   Then anonymous users can register to the site\n+    Given a logged-in site administrator\n+      and the security control panel\n+     When I enable self registration\n+     Then anonymous users can register to the site\n \n Scenario: Enable users to select their own passwords in the Security Control Panel\n-  Given a logged-in site administrator\n-    and the security control panel\n-   When I enable users to select their own passwords\n-   Then users can select their own passwords when registering\n+    Given a logged-in site administrator\n+      and the security control panel\n+     When I enable users to select their own passwords\n+     Then users can select their own passwords when registering\n \n Scenario: Enable user folders in the Security Control Panel\n-  Given a logged-in site administrator\n-    and the security control panel\n-   When I enable user folders\n-   Then a user folder should be created when a user registers and logs in to the site\n+    Given a logged-in site administrator\n+      and the security control panel\n+     When I enable user folders\n+     Then a user folder should be created when a user registers and logs in to the site\n \n Scenario: Enable anyone to view \'about\' information in the Security Control Panel\n-  Given a logged-in site administrator\n-    and a published test folder\n-    and the security control panel\n-   When I enable anyone to view \'about\' information\n-   Then anonymous users can view \'about\' information\n+    Given a logged-in site administrator\n+      and a published test folder\n+      and the security control panel\n+     When I enable anyone to view \'about\' information\n+     Then anonymous users can view \'about\' information\n \n Scenario: Enable use email as login in the Security Control Panel\n-  Given a logged-in site administrator\n-    and the security control panel\n-   When I enable email to be used as a login name\n-   Then users can use email as their login name\n+    Given a logged-in site administrator\n+      and the security control panel\n+     When I enable email to be used as a login name\n+     Then users can use email as their login name\n \n Scenario: Enable use uuid as uid in the Security Control Panel\n-  Given a logged-in site administrator\n-    and the security control panel\n-   When I enable UUID to be used as a user id\n-   Then UUID should be used for the user id\n-\n+    Given a logged-in site administrator\n+      and the security control panel\n+     When I enable UUID to be used as a user id\n+     Then UUID should be used for the user id\n \n-*** Keywords *****************************************************************\n \n-# --- GIVEN ------------------------------------------------------------------\n+*** Keywords ***\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+# GIVEN\n \n the security control panel\n-  Go to  ${PLONE_URL}/@@security-controlpanel\n-  Wait until page contains  Security Settings\n+    Go to    ${PLONE_URL}/@@security-controlpanel\n+    Get Text    //body    contains    Security Settings\n \n a published test folder\n-  Go to  ${PLONE_URL}/test-folder\n-  Wait For Element  css=#plone-contentmenu-workflow\n-  Click link  xpath=//li[@id=\'plone-contentmenu-workflow\']/a\n-  Wait For Element  id=workflow-transition-publish\n-  Click link  id=workflow-transition-publish\n-  Wait until page contains  Item state changed\n+    Go to    ${PLONE_URL}/test-folder\n+    Click    //li[@id="plone-contentmenu-workflow"]/a\n+    Click    //*[@id="workflow-transition-publish"]\n+    Get Text    //body    contains    Item state changed\n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I enable self registration\n-  Select Checkbox  form.widgets.enable_self_reg:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox  //input[@name="form.widgets.enable_self_reg:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I enable users to select their own passwords\n-  Select Checkbox  form.widgets.enable_self_reg:list\n-  Select Checkbox  form.widgets.enable_user_pwd_choice:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.enable_self_reg:list"]\n+    Check Checkbox    //input[@name="form.widgets.enable_user_pwd_choice:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I enable user folders\n-  Select Checkbox  form.widgets.enable_self_reg:list\n-  Select Checkbox  form.widgets.enable_user_pwd_choice:list\n-  Select Checkbox  form.widgets.enable_user_folders:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.enable_self_reg:list"]\n+    Check Checkbox    //input[@name="form.widgets.enable_user_pwd_choice:list"]\n+    Check Checkbox    //input[@name="form.widgets.enable_user_folders:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I enable anyone to view \'about\' information\n-  Select Checkbox  form.widgets.allow_anon_views_about:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.allow_anon_views_about:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I enable email to be used as a login name\n-  Select Checkbox  form.widgets.enable_self_reg:list\n-  Select Checkbox  form.widgets.enable_user_pwd_choice:list\n-  Select Checkbox  form.widgets.use_email_as_login:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.enable_self_reg:list"]\n+    Check Checkbox    //input[@name="form.widgets.enable_user_pwd_choice:list"]\n+    Check Checkbox    //input[@name="form.widgets.use_email_as_login:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I enable UUID to be used as a user id\n-  Select Checkbox  form.widgets.enable_self_reg:list\n-  Select Checkbox  form.widgets.enable_user_pwd_choice:list\n-  Select Checkbox  form.widgets.use_uuid_as_userid:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.enable_self_reg:list"]\n+    Check Checkbox    //input[@name="form.widgets.enable_user_pwd_choice:list"]\n+    Check Checkbox    //input[@name="form.widgets.use_uuid_as_userid:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n Anonymous users can register to the site\n-  Disable autologin\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Plone site\n-  Element Should Be Visible  xpath=//a[@id=\'personaltools-join\']\n+    Disable autologin\n+    Go to    ${PLONE_URL}\n+    Get Text    //body    contains    Plone site\n+    Get Element States    //a[@id="personaltools-join"]    contains    visible\n \n Users can select their own passwords when registering\n-  Disable autologin\n-  Go to  ${PLONE_URL}/@@register\n-  Wait until page contains  Registration form\n-  Element Should Be Visible  xpath=//input[@id=\'form-widgets-password\']\n+    Disable autologin\n+    Go to    ${PLONE_URL}/@@register\n+    Get Text    //body    contains    Registration form\n+    Get Element States    //input[@id="form-widgets-password"]    contains    visible\n \n Users can use email as their login name\n-  Disable autologin\n-  Go to  ${PLONE_URL}/@@register\n-  Wait until page contains  Registration form\n-  Element Should Be Visible  xpath=//input[@id=\'form-widgets-email\']\n-  Element Should Not Be Visible  xpath=//input[@id=\'form-widgets-username\']\n+    Disable autologin\n+    Go to    ${PLONE_URL}/@@register\n+    Get Text    //body    contains    Registration form\n+    Get Element States    //input[@id="form-widgets-email"]    contains    visible\n+    Get Element States    //input[@id="form-widgets-username"]    not contains    visible\n \n A user folder should be created when a user registers and logs in to the site\n \n-  Disable autologin\n-\n-  # I register to the site\n-  Go to  ${PLONE_URL}/@@register\n-  Wait until page contains  Registration form\n-  Input Text for sure  form.widgets.username  joe\n-  Input Text for sure  form.widgets.email  joe@test.com\n-  Input Text for sure  form.widgets.password  supersecret\n-  Input Text for sure  form.widgets.password_ctl  supersecret\n-  Wait For Then Click Element  css=#form-buttons-register\n-\n-  # I login to the site\n-  Go to  ${PLONE_URL}/login\n-  Wait until page contains  Login Name\n-  Input text for sure  __ac_name  joe\n-  Input text for sure  __ac_password  supersecret\n-  Click Button  Log in\n-  Wait until page contains  You are now logged in\n-\n-  # The user folder should be created\n-  Go to  ${PLONE_URL}/Members/joe\n-  Wait until element contains  css=h1  joe\n-  Page should Not contain  This page does not seem to exist\n+    Disable autologin\n+    I register to the site\n+    I login to the site\n+    # The user folder should be created\n+    Go to    ${PLONE_URL}/Members/joe\n+    Get Element Count    //h1[contains(text(),\'joe doe\')]    should be    1\n+    Get Text    //body    not contains    This page does not seem to exist\n \n Anonymous users can view \'about\' information\n-  Disable autologin\n-  Go to  ${PLONE_URL}/@@search?SearchableText=test\n-  Wait until page contains  Search results\n-  Element Should Be Visible  xpath=//span[contains(@class, \'documentAuthor\')]\n+    Disable autologin\n+    Go to    ${PLONE_URL}/@@search?SearchableText=test\n+    Get Text    //body    contains    Search results\n+    Get Element States    //span[contains(@class, \'documentAuthor\')]    contains    visible\n \n UUID should be used for the user id\n \n-  Disable autologin\n-\n-  # I register to the site\n-  Go to  ${PLONE_URL}/@@register\n-  Wait until page contains  Registration form\n-  Input Text for sure  form.widgets.username  joe\n-  Input Text for sure  form.widgets.email  joe@test.com\n-  Input Text for sure  form.widgets.password  supersecret\n-  Input Text for sure  form.widgets.password_ctl  supersecret\n-  Wait For Then Click Element  css=#form-buttons-register\n-\n-  # I login to the site\n-  Go to  ${PLONE_URL}/login\n-  Wait until page contains  Login Name\n-  Input text for sure  __ac_name  joe\n-  Input text for sure  __ac_password  supersecret\n-  Click Button  Log in\n-  Wait until page contains  You are now logged in\n-  # XXX: Here we can\'t really test that this is a uuid, since it\'s random, so\n-  # we just check that user id is not equal to username or email\n-  ${userid}=  Get Text  xpath=//a[@id=\'personaltools-menulink\']\n-  Should Not Be Equal As Strings  ${userid}  joe\n-  Should Not Be Equal As Strings  ${userid}  joe@test.com\n+    Disable autologin\n+    I register to the site\n+    I login to the site\n+    # XXX: Here we can\'t really test that this is a uuid, since it\'s random, so\n+    # we just check that user id is not equal to username or email\n+    ${userid}=  Get Text    //a[@id=\'personaltools-menulink\']\n+    Should Not Be Equal As Strings    ${userid}    joe\n+    Should Not Be Equal As Strings    ${userid}    joe@test.com\n+\n+\n+# DRY\n+\n+I register to the site\n+    Go to  ${PLONE_URL}/@@register\n+    Get Text    //body    contains    Registration form\n+    Type Text    //input[@name="form.widgets.fullname"]    joe doe\n+    Type Text    //input[@name="form.widgets.username"]    joe\n+    Type Text    //input[@name="form.widgets.email"]    joe@test.com\n+    Type Text    //input[@name="form.widgets.password"]    supersecret\n+    Type Text    //input[@name="form.widgets.password_ctl"]    supersecret\n+    Click    //button[@name="form.buttons.register"]\n+\n+I login to the site\n+    Go to    ${PLONE_URL}/login\n+    Get Text    //body    contains    Login Name\n+    Type Text    //input[@name="__ac_name"]    joe\n+    Type Text    //input[@name="__ac_password"]    supersecret\n+    Click    //button[@name="buttons.login"]\n+    Get Text    //body    contains    You are now logged in\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_site.robot b/Products/CMFPlone/tests/robot/test_controlpanel_site.robot\nindex 1844ac2d65..1e02aa71e0 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_site.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_site.robot\n@@ -1,125 +1,115 @@\n-Documentation\n-...            $ bin/robot-server Products.CMFPlone.testing.PRODUCTS_CMFPLONE_ROBOT_TESTING\n-...            $ bin/robot test_controlpanel_site.robot\n+*** Settings ***\n \n-*** Settings *****************************************************************\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n-Variables  Products/CMFPlone/tests/robot/variables.py\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Resource  keywords.robot\n+Variables    variables.py\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n-\n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Set Site Title in the Site Control Panel\n-  Given a logged-in site administrator\n-    and the site control panel\n-   When I set the site title to \'My Site\'\n-   Then the site title should be set to \'My Site\'\n+    Given a logged-in site administrator\n+      and the site control panel\n+     When I set the site title to \'My Site\'\n+     Then the site title should be set to \'My Site\'\n \n Scenario: Set Site Logo in the Site Control Panel\n-  Given a logged-in site administrator\n-    and the site control panel\n-   When I set a custom logo\n-   Then the site logo should be set to the custom logo\n+    Given a logged-in site administrator\n+      and the site control panel\n+     When I set a custom logo\n+     Then the site logo should be set to the custom logo\n \n Scenario: Enable Dublin Core Metadata in the Site Control Panel\n-  Given a logged-in site administrator\n-    and the site control panel\n-   When I enable dublin core metadata\n-   Then the dublin core metadata shows up on the site\n+    Given a logged-in site administrator\n+      and the site control panel\n+     When I enable dublin core metadata\n+     Then the dublin core metadata shows up on the site\n \n Scenario: Enable Sitemap in the Site Control Panel\n-  Given a logged-in site administrator\n-    and the site control panel\n-   When I enable the sitemap\n-   Then then I can see a sitemap\n+    Given a logged-in site administrator\n+      and the site control panel\n+     When I enable the sitemap\n+     Then then I can see a sitemap\n \n Scenario: Add Webstats Javascript in the Site Control Panel\n-  Given a logged-in site administrator\n-    and the site control panel\n-   When I add a Javascript snippet to the webstats javascript\n-   Then the Javascript snippet shows up on the site\n+    Given a logged-in site administrator\n+      and the site control panel\n+     When I add a Javascript snippet to the webstats javascript\n+     Then the Javascript snippet shows up on the site\n \n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n-# --- GIVEN ------------------------------------------------------------------\n+# GIVEN\n \n the site control panel\n-  Go to  ${PLONE_URL}/@@site-controlpanel\n-  Wait until page contains  Site Settings\n+    Go to    ${PLONE_URL}/@@site-controlpanel\n+    Get Text    //body    contains    Site Settings\n \n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I enable the sitemap\n-  Given patterns are loaded\n-  Wait For Element  css=#formfield-form-widgets-enable_sitemap\n-  Select Checkbox  form.widgets.enable_sitemap:list\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.enable_sitemap:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I set the site title to \'${site_title}\'\n-  Given patterns are loaded\n-  Input Text  name=form.widgets.site_title  ${site_title}\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    Type Text    //input[@name="form.widgets.site_title"]    ${site_title}\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I set a custom logo\n-  Given patterns are loaded\n-  Choose File  name=form.widgets.site_logo  ${PATH_TO_TEST_FILES}/pixel.png\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    Upload File By Selector    //input[@name="form.widgets.site_logo"]    ${PATH_TO_TEST_FILES}/pixel.png\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I enable dublin core metadata\n-  Given patterns are loaded\n-  Select Checkbox  form.widgets.exposeDCMetaTags:list\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    Check Checkbox    //input[@name="form.widgets.exposeDCMetaTags:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I add a Javascript snippet to the webstats javascript\n-  Given patterns are loaded\n-  Input Text  name=form.widgets.webstats_js  <script id="webstats_snippet"></script>\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    Type Text    //textarea[@name="form.widgets.webstats_js"]    <script id="webstats_snippet"></script>\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n the site title should be set to \'${expected_site_title}\'\n-  Go To  ${PLONE_URL}\n-  ${actual_site_title}=  Get title\n-  Should be equal  ${actual_site_title}  ${expected_site_title}\n+    Go To    ${PLONE_URL}\n+    Get Text    //head/title    should be    ${expected_site_title}\n \n the site logo should be set to the custom logo\n-  Go To  ${PLONE_URL}\n-  Wait Until Element Is Visible  css=#portal-logo\n-  Page should contain element  //*[@id="portal-logo"]/img[contains(@src,\'@@site-logo/pixel.png\')]\n+    Go To    ${PLONE_URL}\n+    Get Element Count    //*[@id="portal-logo"]/img[contains(@src,\'@@site-logo/pixel.png\')]    should be    1\n \n then I can see a sitemap\n-  Go to  ${PLONE_URL}/sitemap.xml.gz\n-  # We need a \'Download file\' selenium2library keyword to test this:\n-  # https://github.com/rtomac/robotframework-selenium2library/issues/24\n+\n+    Import library    OperatingSystem\n+\n+    # this is for robotframework browser > 17\n+    Download    ${PLONE_URL}/sitemap.xml.gz    saveAs=/tmp/sitemap.xml.gz\n+    File Should Exist    /tmp/sitemap.xml.gz\n+\n+    # this is for robotframework browser < 18.0\n+    # ${file_object}=    Download    ${PLONE_URL}/sitemap.xml.gz\n+    # File Should Exist    ${file_object.saveAs}\n \n the dublin core metadata shows up on the site\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Powered by Plone\n-  Page should contain element  xpath=//html/head/meta[@name=\'DC.date.modified\']\n-  Page should contain element  xpath=//html/head/meta[@name=\'DC.format\']\n-  Page should contain element  xpath=//html/head/meta[@name=\'DC.type\']\n-  Page should contain element  xpath=//html/head/meta[@name=\'DC.date.created\']\n-  Page should contain element  xpath=//html/head/meta[@name=\'DC.language\']\n+    Go to    ${PLONE_URL}\n+    Get Element Count    //html/head/meta[@name="DC.date.modified"]    should be    1\n+    Get Element Count    //html/head/meta[@name="DC.format"]    should be    1\n+    Get Element Count    //html/head/meta[@name="DC.type"]    should be    1\n+    Get Element Count    //html/head/meta[@name="DC.date.created"]    should be    1\n+    Get Element Count    //html/head/meta[@name="DC.language"]    should be    1\n \n the Javascript snippet shows up on the site\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Powered by Plone\n-  Page should contain element  id=webstats_snippet\n+    Go to  ${PLONE_URL}\n+    Get Element Count    //*[@id="webstats_snippet"]    should be    1\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_social.robot b/Products/CMFPlone/tests/robot/test_controlpanel_social.robot\nindex 2fae936771..01239426e3 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_social.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_social.robot\n@@ -1,78 +1,69 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n \n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Social settings are provided\n-  Given a logged-in site administrator\n-    and the social control panel\n-   When I provide social settings\n-   Then social tags should exist for anonymous\n+    Given a logged-in site administrator\n+      and the social control panel\n+     When I provide social settings\n+     Then social tags should exist for anonymous\n \n Scenario: Social tags are disabled\n-  Given a logged-in site administrator\n-    and the social control panel\n-   When I provide social settings\n-   When I disable social\n-   Then social tags should not exist\n-\n+    Given a logged-in site administrator\n+      and the social control panel\n+     When I provide social settings\n+     When I disable social\n+     Then social tags should not exist\n \n-*** Keywords *****************************************************************\n \n-# --- GIVEN ------------------------------------------------------------------\n+*** Keywords ***\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+# GIVEN\n \n the social control panel\n-  Go to  ${PLONE_URL}/@@social-controlpanel\n-  Wait until page contains  Social Media Settings\n+    Go to  ${PLONE_URL}/@@social-controlpanel\n+    Get Text    //body    contains    Social Media Settings\n \n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I disable social\n-  UnSelect Checkbox  form.widgets.share_social_data:list\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    Uncheck Checkbox    //input[@name="form.widgets.share_social_data:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n I provide social settings\n-  Input Text  name=form.widgets.twitter_username  plonecms\n-  Input Text  name=form.widgets.facebook_app_id  123456\n-  Input Text  name=form.widgets.facebook_username  plonecms\n-  Wait For Then Click Element  css=#form-buttons-save\n-  Wait until page contains  Changes saved\n+    Type Text    //input[@name="form.widgets.twitter_username"]    plonecms\n+    Type Text    //input[@name="form.widgets.facebook_app_id"]    123456\n+    Type Text    //input[@name="form.widgets.facebook_username"]    plonecms\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n social tags should exist for anonymous\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Plone site\n-  Page should not contain element  css=meta[name="twitter:site"]\n-  Page should not contain element  css=meta[property="og:article:publisher"]\n-  Page should not contain element  css=meta[property="fb:app_id"]\n-  Disable autologin\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Plone site\n-  Page should contain element  css=meta[name="twitter:site"]\n-  Page should contain element  css=meta[property="og:article:publisher"]\n-  Page should contain element  css=meta[property="fb:app_id"]\n+    Go to    ${PLONE_URL}\n+    Get Element Count    //meta[@name="twitter:site"]    should be    0\n+    Get Element Count    //meta[@property="og:article:publisher"]    should be    0\n+    Get Element Count    //meta[@property="fb:app_id"]    should be    0\n+    Disable autologin\n+    Go to     ${PLONE_URL}\n+    Get Element Count    //meta[@name="twitter:site"]    should be    1\n+    Get Element Count    //meta[@property="og:article:publisher"]    should be    1\n+    Get Element Count    //meta[@property="fb:app_id"]    should be    1\n \n social tags should not exist\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Plone site\n-  Page should not contain element  css=meta[name="twitter:site"]\n-  Page should not contain element  css=meta[property="og:article:publisher"]\n-  Page should not contain element  css=meta[property="fb:app_id"]\n+    Go to    ${PLONE_URL}\n+    Get Element Count    //meta[@name="twitter:site"]    should be    0\n+    Get Element Count    //meta[@property="og:article:publisher"]    should be    0\n+    Get Element Count    //meta[@property="fb:app_id"]    should be    0\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_types.robot b/Products/CMFPlone/tests/robot/test_controlpanel_types.robot\nindex b611a93109..4413ba0437 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_types.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_types.robot\n@@ -1,50 +1,50 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n \n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n Scenario: Change default workflow\n-  Given a logged-in site administrator\n-    and the types control panel\n-   When I select \'Single State Workflow\' workflow\n-   Then Wait until page contains  Content Settings\n-   When I add new Link \'my_link\'\n-    Then Link \'my_link\' should have Single State Workflow enabled\n+    Given a logged-in site administrator\n+      and the types control panel\n+     When I select \'Single State Workflow\' workflow\n+      and I add new Link \'my_link\'\n+     Then Link \'my_link\' should have Single State Workflow enabled\n \n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n-# --- GIVEN ------------------------------------------------------------------\n+# GIVEN\n the types control panel\n-  Go to  ${PLONE_URL}/@@content-controlpanel\n-  Wait until page contains  Content Settings\n+    Go to    ${PLONE_URL}/@@content-controlpanel\n+    Get Text    //body    contains    Content Settings\n \n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n I select \'${workflow}\' workflow\n-  Select from list by label  name=new_workflow  ${workflow}\n-  Click Button  Save\n+    Select Options By    //select[@name="new_workflow"]    label    ${workflow}\n+    Click    //button[@name="form.button.Save"]\n+    Wait For Condition    Text    //body    contains   Content Settings\n+\n \n I add new Link \'${id}\'\n-  Go to  ${PLONE_URL}\n-  Wait until page contains  Plone site\n-  Create content  type=Link  id=${id}  title=${id}  remoteUrl=http://www.starzel.de\n+    Go to    ${PLONE_URL}\n+    Create content\n+    ...    type=Link\n+    ...    id=${id}\n+    ...    title=${id}\n+    ...    remoteUrl=https://www.plone.org\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n Link \'${id}\' should have Single State Workflow enabled\n-  Go to  ${PLONE_URL}/${id}\n-  Wait until page contains  ${id}\n-  # We check that single state worklow is used, publish button is not present\n-  Page should not contain element  xpath=//a[@id="workflow-transition-publish"]\n+    Go to    ${PLONE_URL}/${id}\n+    # We check that single state worklow is used, publish button is not present\n+    Get Element Count    //a[@id="workflow-transition-publish"]    should be    0\ndiff --git a/Products/CMFPlone/tests/robot/test_controlpanel_usergroups.robot b/Products/CMFPlone/tests/robot/test_controlpanel_usergroups.robot\nindex 0a4a2a9e1c..1b041b035e 100644\n--- a/Products/CMFPlone/tests/robot/test_controlpanel_usergroups.robot\n+++ b/Products/CMFPlone/tests/robot/test_controlpanel_usergroups.robot\n@@ -1,123 +1,103 @@\n-# ============================================================================\n-# Tests for the Plone Usergroups Control Panel\n-# ============================================================================\n-#\n-# $ bin/robot-server --reload-path src/Products.CMFPlone/Products/CMFPlone/ Products.CMFPlone.testing.PRODUCTS_CMFPLONE_ROBOT_TESTING\n-#\n-# $ bin/robot src/Products.CMFPlone/Products/CMFPlone/tests/robot/test_controlpanel_usergroups.robot\n-#\n-# ============================================================================\n+*** Settings ***\n \n-*** Settings *****************************************************************\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Resource  keywords.robot\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n-\n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: Show all users in users control panel\n-  Given a logged-in site administrator\n-    and the users control panel\n-   When I click show all users\n-   Then all users should be shown\n+    Given a logged-in site administrator\n+      and the users control panel\n+     When I click show all users\n+     Then all users should be shown\n \n Scenario: Show all groups in groups control panel\n-  Given a logged-in site administrator\n-    and the groups control panel\n-   When I click show all groups\n-   Then all groups should be shown\n+    Given a logged-in site administrator\n+      and the groups control panel\n+     When I click show all groups\n+     Then all groups should be shown\n \n Scenario: Create new group\n-  Given a logged-in site administrator\n-    and the groups control panel\n-   When I create new group\n-   Then new group should show under all groups\n+    Given a logged-in site administrator\n+      and the groups control panel\n+     When I create new group\n+      and I click show all groups\n+     Then new group should show under all groups\n \n Scenario: Enable many groups and many users settings in usergroups control panel\n-  Given a logged-in site administrator\n-    and the user group settings control panel\n-   When I enable many groups and many users settings\n-   Then showing all users is disabled\n-    and showing all groups is disabled\n-\n+    Given a logged-in site administrator\n+      and the user group settings control panel\n+     When I enable many groups and many users settings\n+     Then showing all users is disabled\n+      and showing all groups is disabled\n \n-*** Keywords *****************************************************************\n \n-# --- GIVEN ------------------------------------------------------------------\n+*** Keywords ***\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+# GIVEN\n \n the users control panel\n-  Go to  ${PLONE_URL}/@@usergroup-userprefs\n-  Wait until page contains  User Search\n+    Go to    ${PLONE_URL}/@@usergroup-userprefs\n+    Get Text    //body    contains    User Search\n \n the groups control panel\n-  Go to  ${PLONE_URL}/@@usergroup-groupprefs\n-  Wait until page contains  Group Search\n+    Go to    ${PLONE_URL}/@@usergroup-groupprefs\n+    Get Text    //body    contains    Group Search\n \n the user group settings control panel\n-  Go to  ${PLONE_URL}/@@usergroup-controlpanel\n-  Wait until page contains  User and Groups Settings\n+    Go to    ${PLONE_URL}/@@usergroup-controlpanel\n+    Get Text    //body    contains    User and Groups Settings\n \n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I click show all users\n-  Click button  Show all\n-  Wait until page contains  User Search\n+    Click    //button[@name="form.button.FindAll"]\n+    Get Text    //body    contains    User Search\n \n I click show all groups\n-  Click button  Show all\n-  Wait until page contains  Group Search\n+    Click    //button[@name="form.button.FindAll"]\n+    Get Text    //body    contains    Group Search\n \n I create new group\n-  Click link  Add New Group\n-  Wait until page contains element  name=addname\n-  patterns are loaded\n-  Input Text  name=addname  my-new-group\n-  Input Text  name=title:string  My New Group\n-  Input Text  name=description:text  This is my new group\n-  Input Text  name=email:string  my-group@plone.org\n-  Submit Form  id=createGroup\n-#  "Click button  Save" does not work for modals. See https://stackoverflow.com/questions/17602334/element-is-not-currently-visible-and-so-may-not-be-interacted-with-but-another for details.\n-  I click show all groups\n-  Page should contain  my-new-group\n+    Click    //a[@id="add-group"]\n+    Type Text    //input[@name="addname"]    my-new-group\n+    Type Text    //input[@name="title:string"]    My New Group\n+    Type Text    //textarea[@name="description:text"]    This is my new group\n+    Type Text    //input[@name="email:string"]    my-group@plone.org\n+    Click    //form[@id="createGroup"]//button[@name="form.button.Save"]\n \n I enable many groups and many users settings\n-  Select Checkbox  name=form.widgets.many_groups:list\n-  Select Checkbox  name=form.widgets.many_users:list\n-  Click button  Save\n-  Wait until page contains  Data successfully updated.\n+    Check Checkbox    //input[@name="form.widgets.many_groups:list"]\n+    Check Checkbox    //input[@name="form.widgets.many_users:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Data successfully updated.\n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n all users should be shown\n-  Page should contain  test-user\n-  Page should contain  admin\n+    Get Text    //body    contains    test-user\n+    Get Text    //body    contains    admin\n \n all groups should be shown\n-  Page should contain  Administrators\n-  Page should contain  Authenticated Users (Virtual Group) (AuthenticatedUsers)\n-  Page should contain  Reviewers\n-  Page should contain  Site Administrators\n+    Get Text    //body    contains    Administrators\n+    Get Text    //body    contains    Authenticated Users (Virtual Group) (AuthenticatedUsers)\n+    Get Text    //body    contains    Reviewers\n+    Get Text    //body    contains    Site Administrators\n \n showing all users is disabled\n-  the users control panel\n-  Page should not contain  Show all\n+    the users control panel\n+    Get Text    //body    not contains    Show all\n \n showing all groups is disabled\n-  the users control panel\n-  Page should not contain  Show all\n+    the groups control panel\n+    Get Text    //body    not contains    Show all\n \n new group should show under all groups\n-  Page should contain  my-new-group\n+    Get Text    //body    contains    my-new-group\ndiff --git a/Products/CMFPlone/tests/robot/test_edit.robot b/Products/CMFPlone/tests/robot/test_edit.robot\nindex 169b44418d..aede766e59 100644\n--- a/Products/CMFPlone/tests/robot/test_edit.robot\n+++ b/Products/CMFPlone/tests/robot/test_edit.robot\n@@ -1,26 +1,23 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n \n-\n-*** Variables ****************************************************************\n+*** Variables ***\n \n ${TITLE}  An edited page\n ${LINK_TITLE}  An edited link item\n ${PAGE_ID}  an-edited-page\n ${LINK_ID}  an-edited-link-item\n-${SELENIUM_RUN_ON_FAILURE}  Capture Page Screenshot and log source\n \n-*** Test cases ***************************************************************\n+\n+*** Test cases ***\n \n Scenario: A page is opened to edit\n     Given a logged-in site administrator\n@@ -31,7 +28,7 @@ Scenario: A page is opened to edit\n Scenario: Switch tabs\n     Given a logged-in site administrator\n       and an edited page\n-     When i click the Categorization tab\n+     When i click the \'Categorization\' tab\n      Then the Categorization tab is shown\n       and no other tab is shown\n \n@@ -41,7 +38,7 @@ Scenario: Adding a related item\n     Given a logged-in site administrator\n       and at least one other item\n       and an edited page\n-     When i click the Categorization tab\n+     When i click the \'Categorization\' tab\n       and i select a related item\n       and i save the page\n      Then the related item is shown in the page\n@@ -79,68 +76,70 @@ Scenario: Add an internal link to linked item\n      Then the linked item is shown in the page\n       and Capture page screenshot and log source\n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n-# --- GIVEN ------------------------------------------------------------------\n+# GIVEN\n \n an edited page\n-    Create content  type=Document  title=${TITLE}\n-    Go to  ${PLONE_URL}/${PAGE_ID}/edit\n-    Wait until page contains  Edit Page\n+    Create content\n+    ...    type=Document\n+    ...    title=${TITLE}\n+    Go to    ${PLONE_URL}/${PAGE_ID}/edit\n+    Get Text    //body    contains    Edit Page\n \n an edited link item\n-    Create content  type=Link  title=${LINK_TITLE}\n-    Go to  ${PLONE_URL}/${LINK_ID}/edit\n-    Wait until page contains  Edit Link\n+    Create content\n+    ...    type=Link\n+    ...    title=${LINK_TITLE}\n+    Go to    ${PLONE_URL}/${LINK_ID}/edit\n+    Get Text    //body    contains    Edit Link\n \n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I have the title input field\n-    Element Should Be Visible  xpath=//fieldset[@id=\'fieldset-default\']\n+    Get Element States    //fieldset[@id=\'fieldset-default\']    contains    visible\n \n I can only see the default tab\n-    Wait For Condition  return window.jQuery(\'.autotoc-nav .active:visible\').length > 0\n-    Element Should Not Be Visible  xpath=//fieldset[@id=\'fieldset-settings\']\n-    Element Should Not Be Visible  xpath=//fieldset[@id=\'fieldset-dates\']\n-    Element Should Not Be Visible  xpath=//fieldset[@id=\'fieldset-categorization\']\n+    Get Element States    //fieldset[@id=\'fieldset-default\']    contains    visible\n+    Get Element States    //fieldset[@id=\'fieldset-dates\']    not contains    visible\n+    Get Element States    //fieldset[@id=\'fieldset-categorization\']   not contains    visible\n \n I click the ${tab} tab\n-    Given patterns are loaded\n-    Click link  ${tab}\n+    Click    //a[contains(text(),${tab})]\n \n I select a related item\n     # Click the select button\n-    Wait For Then Click Element  //div[@id="formfield-form-widgets-IRelatedItems-relatedItems"]//button\n+    Click    //div[@id="formfield-form-widgets-IRelatedItems-relatedItems"]//button\n     # Click first element in first column\n-    Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[1]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[1]\n     # Click the select Button in the Toolbar of column 2\n-    Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[2]/div[contains(@class, "levelToolbar")]/button\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[2]/div[contains(@class, "levelToolbar")]/button\n \n I select a linked item\n     # Click the select button\n-    Wait For Then Click Element  //div[@id="formfield-form-widgets-remoteUrl"]//button\n+    Click  //div[@id="formfield-form-widgets-remoteUrl"]//button\n     # Click first element in first column\n-    Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[1]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[1]\n     # Click the select Button in the Toolbar of column 2\n     # This selects the "test-folder"\n-    Wait For Then Click Element    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[2]/div[contains(@class, "levelToolbar")]/button\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[2]/div[contains(@class, "levelToolbar")]/button\n \n I save the page\n-   Click Button  Save\n+    Click    //button[@name="form.buttons.save"]\n \n I click the calendar icon\n-    Click Element  xpath=//span[@id=\'edit_form_effectiveDate_0_popup\']\n-    Element Should Be Visible  xpath=//div[@class=\'calendar\']\n+    Click    //span[@id=\'edit_form_effectiveDate_0_popup\']\n+    Get Element States    //div[@class=\'calendar\']   contains    visible\n \n I select a date using the widget\n-    Click Element  xpath=//div[@class=\'calendar\']/table/thead/tr[2]/td[4]/div\n+    Click    //div[@class=\'calendar\']/table/thead/tr[2]/td[4]/div\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n popup calendar should have the same date\n-    Element Text Should Be  xpath=//div[@class=\'calendar\']//thead//td[@class=\'title\']  January, 2001\n+    Get Text    //div[@class=\'calendar\']//thead//td[@class=\'title\']    should be    January, 2001\n \n form dropdowns should not have the default values anymore\n     ${yearLabel} =  Get Selected List Label  xpath=//select[@id=\'edit_form_effectiveDate_0_year\']\n@@ -151,25 +150,26 @@ form dropdowns should not have the default values anymore\n     Should Not Be Equal  ${dayLabel}  --\n \n the related item is shown in the page\n-    Page should contain element  css=#section-related\n+    Get Element Count    //*[@id="section-related"]    should be    1\n \n the linked item is shown in the page\n     # check if the selected testfolder is linked\n-    Page should contain element  xpath=//a[@href=\'${PLONE_URL}/test-folder\']\n+    Get Element Count    //a[@href=\'${PLONE_URL}/test-folder\']    greater than    0\n+\n \n an overlay pops up\n-    Wait Until Page Contains Element  xpath=//div[contains(@class, \'overlay\')]//input[@class=\'insertreference\']\n+    Get Element Count    //div[contains(@class, \'overlay\')]//input[@class=\'insertreference\']    should be    1\n \n the categorization tab is shown\n-    Element Should Be Visible  xpath=//fieldset[@id=\'fieldset-categorization\']\n+    Get Element States    //fieldset[@id=\'fieldset-categorization\']    contains    visible\n \n no other tab is shown\n-    Element Should Not Be Visible  xpath=//fieldset[@id=\'fieldset-dates\']\n-    Element Should Not Be Visible  xpath=//fieldset[@id=\'fieldset-default\']\n-    Element Should Not Be Visible  xpath=//fieldset[@id=\'fieldset-settings\']\n+    Get Element States    //fieldset[@id=\'fieldset-dates\']    not contains    visible\n+    Get Element States    //fieldset[@id=\'fieldset-default\']    not contains    visible\n+    Get Element States    //fieldset[@id=\'fieldset-settings\']    not contains    visible\n \n at least one other item\n-    Go to  ${PLONE_URL}/++add++Document\n-    Given patterns are loaded\n-    Execute Javascript  $(\'#form-widgets-IDublinCore-title\').val(\'${TITLE}\'); return 0;\n-    Click Button  Save\n+    Go to    ${PLONE_URL}/++add++Document\n+    Type Text    //input[@id="form-widgets-IDublinCore-title"]    ${TITLE}\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Item created\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/robot/test_edit_user_schema.robot b/Products/CMFPlone/tests/robot/test_edit_user_schema.robot\nindex 439bb5b074..60e1a0a691 100644\n--- a/Products/CMFPlone/tests/robot/test_edit_user_schema.robot\n+++ b/Products/CMFPlone/tests/robot/test_edit_user_schema.robot\n@@ -1,36 +1,23 @@\n-# ============================================================================\n-# Tests Editing the User Schema\n-# ============================================================================\n-#\n-# $ bin/robot-server --reload-path src/Products.CMFPlone/Products/CMFPlone/ Products.CMFPlone.testing.PRODUCTS_CMFPLONE_ROBOT_TESTING\n-#\n-# $ bin/robot src/Products.CMFPlone/Products/CMFPlone/tests/robot/test_edit_user_schema.robot\n-#\n-# ============================================================================\n-\n *** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n-\n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Resource  keywords.robot\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n \n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: As a manager I can add a field to the registration form\n-  Given a logged-in manager\n-    and the mail setup configured\n-    and site registration enabled\n-   When I add a new text field to the member fields\n-    and choose to show the field on registration\n-   Then an anonymous user will see the field in the registration form\n+    Given a logged-in manager\n+      and the mail setup configured\n+      and site registration enabled\n+     When I add a new text field to the member fields\n+      and choose to show the field on registration\n+     Then an anonymous user will see the field in the registration form\n \n Scenario: As a manager I can add a field to the user form\n   Given a logged-in manager\n@@ -41,12 +28,12 @@ Scenario: As a manager I can add a field to the user form\n    Then a logged-in user will see the field in the user profile\n \n Scenario: As a manager I can add a required field to the user form\n-  Given a logged-in manager\n-    and the mail setup configured\n-    and site registration enabled\n-   When I add a new required text field to the member fields\n-    and choose to show the field in the user profile\n-   Then a logged-in user will see the required field in the user profile\n+    Given a logged-in manager\n+      and the mail setup configured\n+      and site registration enabled\n+     When I add a new required text field to the member fields\n+      and choose to show the field in the user profile\n+     Then a logged-in user will see the required field in the user profile\n \n Scenario: As a manager I can move user form fields\n   Pass Execution  Drag and drop in schemaeditor does not work\n@@ -69,111 +56,92 @@ Scenario: As a manager I can add a field with constraints to the registration fo\n \n \n \n-*** Keywords *****************************************************************\n-\n-# --- GIVEN ------------------------------------------------------------------\n+*** Keywords ***\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n-\n-a logged-in manager\n-  Enable autologin as  Manager\n+# GIVEN\n \n site registration enabled\n-  Go To  ${PLONE_URL}/@@security-controlpanel\n-  Wait until page contains  Security Settings\n-  Wait until page contains element  form.widgets.enable_self_reg:list\n-  Select Checkbox  form.widgets.enable_self_reg:list\n-  Click Button  Save\n-  Wait until page contains  Changes saved.\n-\n+    Go To  ${PLONE_URL}/@@security-controlpanel\n+    Get Text    //body    contains    Security Settings\n+    Check Checkbox    //input[@name="form.widgets.enable_self_reg:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved.\n \n-# --- WHEN -------------------------------------------------------------------\n+# WHEN\n \n I add a new text field to the member fields\n-  Go to  ${PLONE_URL}/@@member-fields\n-  Wait until page contains element  css=#add-field\n-  Click Link  Add new field\xe2\x80\xa6\n-  Wait Until Element Is visible  css=#add-field-form #form-widgets-title\n-  Input Text  css=#add-field-form #form-widgets-title  Test Field\n-  Press Keys  css=#add-field-form #form-widgets-title  TAB\n-  Select From List By Label  css=#form-widgets-factory  Text line (String)\n-  Click button  css=.pattern-modal-buttons button#form-buttons-add\n-  Wait until page contains  Field added successfully.\n+    Go to    ${PLONE_URL}/@@member-fields\n+    Click    //a[@id="add-field"]\n+    Type Text    //form[@id="add-field-form"]//input[@name="form.widgets.title"]    Test Field\n+    Press Keys  //form[@id="add-field-form"]//input[@name="form.widgets.title"]    Tab\n+    Select Options By    //form[@id="add-field-form"]//select[@name="form.widgets.factory:list"]    label    Text line (String)\n+    Click    //div[@class="modal-footer"]//button[@name="form.buttons.add"]\n+    Get Text    //body    contains    Field added successfully.\n \n I Open the test_field Settings\n-  Go to  ${PLONE_URL}/@@member-fields\n-  Wait For Element  css=div[data-field_id=\'test_field\']\n-  Wait For Then Click Element  css=div[data-field_id=\'test_field\'] a.fieldSettings\n+    Go to    ${PLONE_URL}/@@member-fields\n+    Click    //div[@data-field_id="test_field"]//a[contains(@class,"fieldSettings")]\n \n I add a new required text field to the member fields\n-  Go to  ${PLONE_URL}/@@member-fields\n-  Wait until page contains element  css=#add-field\n-  Click Link  Add new field\xe2\x80\xa6\n-  Wait Until Element Is visible  css=#add-field-form #form-widgets-title\n-  Input Text  css=#add-field-form #form-widgets-title  Test Field\n-  Press Keys  css=#add-field-form #form-widgets-title  TAB\n-  Select From List By Label  css=#form-widgets-factory  Text line (String)\n-  Select Checkbox  form.widgets.required:list\n-  Click button  css=.pattern-modal-buttons button#form-buttons-add\n-  Wait until page contains  Field added successfully.\n+    Go to  ${PLONE_URL}/@@member-fields\n+    Click    //a[@id="add-field"]\n+    Type Text    //form[@id="add-field-form"]//input[@name="form.widgets.title"]    Test Field\n+    Press Keys  //form[@id="add-field-form"]//input[@name="form.widgets.title"]    Tab\n+    Select Options By    //form[@id="add-field-form"]//select[@name="form.widgets.factory:list"]    label    Text line (String)\n+    Check Checkbox    //input[@name="form.widgets.required:list"]\n+    Click    //div[@class="modal-footer"]//button[@name="form.buttons.add"]\n+    Get Text    //body    contains    Field added successfully.\n \n choose to show the field on registration\n-  I Open the test_field Settings\n-  Wait Until Element Is visible  form.widgets.IUserFormSelection.forms:list\n-  Select Checkbox  css=#form-widgets-IUserFormSelection-forms-0\n-  Click button  css=.pattern-modal-buttons button#form-buttons-save\n-  Wait until page contains  Data successfully updated.\n+    I Open the test_field Settings\n+    Check Checkbox  //input[@name="form.widgets.IUserFormSelection.forms:list" and @value="On Registration"]\n+    Click    //div[@class="modal-footer"]//button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Data successfully updated.\n \n choose to show the field in the user profile\n-  I Open the test_field Settings\n-  Wait Until Element Is visible  form.widgets.IUserFormSelection.forms:list\n-  Select Checkbox  css=#form-widgets-IUserFormSelection-forms-1\n-  Click button  css=.pattern-modal-buttons button#form-buttons-save\n-  Wait until page contains  Data successfully updated.\n+    I Open the test_field Settings\n+    Check Checkbox  //input[@name="form.widgets.IUserFormSelection.forms:list" and @value="In User Profile"]\n+    Click    //div[@class="modal-footer"]//button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Data successfully updated.\n \n I move the new field to the top\n-  # XXX: Drag and drop is not working!!!\n-  Drag And Drop  xpath=//div[@data-field_id="test_field"]//span[contains(@class, "draghandle")]  xpath=//div[@data-field_id="home_page"]\n+    Drag And Drop    //div[@data-field_id="test_field"]//span[contains(@class, "draghandle")]    //div[@data-field_id="home_page"]\n+\n \n add a min/max constraint to the field\n-  I Open the test_field Settings\n-  Wait until page contains element  form.widgets.min_length\n-  Input Text  form.widgets.min_length  4\n-  Input Text  form.widgets.max_length  6\n-  Wait Until Element Is visible  css=.pattern-modal-buttons button#form-buttons-save\n-  Click Button  css=.pattern-modal-buttons button#form-buttons-save\n-  Sleep  1\n+    I Open the test_field Settings\n+    Type Text    //input[@name="form.widgets.min_length"]    4\n+    Type Text    //input[@name="form.widgets.max_length"]    6\n+    Click    //div[@class="modal-footer"]//button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Data successfully updated.\n \n \n-# --- THEN -------------------------------------------------------------------\n+# THEN\n \n an anonymous user will see the field in the registration form\n-  Disable Autologin\n-  Go to  ${PLONE_URL}/@@register\n-  Wait until page contains  Register\n-  Page should contain element  form.widgets.test_field\n+    Disable Autologin\n+    Go to    ${PLONE_URL}/@@register\n+    Get Text    //body    contains    Register\n+    Get Element Count    //input[@name="form.widgets.test_field"]    should be    1\n \n a logged-in user will see the field in the user profile\n-  Disable Autologin\n-  Enable autologin as  Member\n-  Go to  ${PLONE_URL}/@@personal-information\n-  Wait until page contains  Change your personal information\n-  Page should contain element  form.widgets.test_field\n+    Disable Autologin\n+    a logged-in member\n+    Go to    ${PLONE_URL}/@@personal-information\n+    Get Element Count    //input[@name="form.widgets.test_field"]    should be    1\n \n a logged-in user will see the required field in the user profile\n-  a logged-in user will see the field in the user profile\n-  Page Should Contain Element  //div[@id=\'formfield-form-widgets-test_field\']//span[contains(@class, \'required\')]  limit=1  message=test_field should be required\n+    a logged-in user will see the field in the user profile\n+    Get Element Count    //div[@id=\'formfield-form-widgets-test_field\']//span[contains(@class, \'required\')]    should be    1    message=test_field should be required\n \n a logged-in user will see the field on top of the user profile\n-  a logged-in user will see the field in the user profile\n-  Page Should Contain Element  //form[@id=\'form\']/div[1]//input[@id=\'form-widgets-test_field\']  limit=1  message=test_field should be on top\n+    a logged-in user will see the field in the user profile\n+    Get Element Count    //form[@id=\'form\']/div[1]//input[@id=\'form-widgets-test_field\']    should be    1    message=test_field should be on top\n \n a logged-in user will see a field with min/max constraints\n-  a logged-in user will see the field in the user profile\n-  Input Text  form.widgets.email  test@plone.org\n-  Wait For Element  css=#form-widgets-test_field\n-  Input Text  form.widgets.test_field  1\n-  Wait For Then Click Element  css=.formControls button#form-buttons-save\n-  Wait until page contains  There were some errors.\n-  Page should contain  Value is too short\n+    a logged-in user will see the field in the user profile\n+    Type Text    //input[@name="form.widgets.email"]    test@plone.org\n+    Type Text    //input[@name="form.widgets.test_field"]    1\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    There were some errors.\n+    Get Text    //body    contains    Value is too short\ndiff --git a/Products/CMFPlone/tests/robot/test_folder_contents.robot b/Products/CMFPlone/tests/robot/test_folder_contents.robot\nindex 1406b233e7..dcf33269b6 100644\n--- a/Products/CMFPlone/tests/robot/test_folder_contents.robot\n+++ b/Products/CMFPlone/tests/robot/test_folder_contents.robot\n@@ -1,18 +1,15 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n \n-\n-*** Test cases ***************************************************************\n+*** Test cases ***\n \n \n Scenario: Select All items\n@@ -21,14 +18,8 @@ Scenario: Select All items\n       and the folder contents view\n      When I select all the elements\n      Then the selection count appears\n-      and the four elements got selected\n       and the clear selection link appears\n \n-Scenario: Clear selection\n-   Given a logged-in site administrator\n-     and a folder with four pages\n-     and the folder contents view\n-     And I select all the elements\n     When I clear the selection\n     Then no elements should be selected\n \n@@ -36,77 +27,88 @@ Scenario: Reorder Folder Contents\n    Given a logged-in site administrator\n      and a folder with four pages\n      and the folder contents view\n-    Then The Order Should Be  1   2   3   4\n+    Then The Order Should Be    1    2    3    4\n     When I reorder the elements\n-    Then The Order Should Be  4   3   2   1\n+    Then The Order Should Be    4    3    2    1\n \n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n \n a folder with four pages\n-    ${folder_uid}=  Create content  type=Folder  title=My Folder\n-    Create content  type=Document  title=Doc1  container=${folder_uid}\n-    Create content  type=Document  title=Doc2  container=${folder_uid}\n-    Create content  type=Document  title=Doc3  container=${folder_uid}\n-    Create content  type=Document  title=Doc4  container=${folder_uid}\n+    ${folder_uid}=    Create content\n+    ...    type=Folder\n+    ...    title=My Folder\n+    Create content\n+    ...    type=Document\n+    ...    title=Doc1\n+    ...    container=${folder_uid}\n+    Create content\n+    ...    type=Document\n+    ...    title=Doc2\n+    ...    container=${folder_uid}\n+    Create content\n+    ...    type=Document\n+    ...    title=Doc3\n+    ...    container=${folder_uid}\n+    Create content\n+    ...    type=Document\n+    ...    title=Doc4\n+    ...    container=${folder_uid}\n \n the folder contents view\n-    Go to  ${PLONE_URL}/my-folder/folder_contents\n-    Given folder contents pattern loaded\n+    Go to    ${PLONE_URL}/my-folder/folder_contents\n \n I click the \'${link_name}\' link\n-    Click Link  ${link_name}\n+    Click    //a[contains(text(),${link_name})]\n \n I select all the elements\n-    Wait until page contains element  css=.pat-structure .select-all\n-    Sleep  1s\n-    ${select_all_selector}  Set Variable  .pat-structure .select-all\n-    Wait Until Element Is Visible  css=${select_all_selector}\n-    Click Element  css=${select_all_selector}\n-\n-the four elements got selected\n-    Checkbox Should Be Selected  css=tr[data-id="doc1"] input\n-    Checkbox Should Be Selected  css=tr[data-id="doc2"] input\n-    Checkbox Should Be Selected  css=tr[data-id="doc3"] input\n-    Checkbox Should Be Selected  css=tr[data-id="doc4"] input\n+    Wait For Condition    Classes    //body    contains    patterns-loaded\n+    Check Checkbox    //tr[@data-id="doc1"]//input[@type="checkbox"]\n+    Wait For Elements State     //tr[@data-id="doc1"]//input[@type="checkbox"]    checked    timeout=10s\n+    Check Checkbox    //tr[@data-id="doc2"]//input[@type="checkbox"]\n+    Wait For Elements State     //tr[@data-id="doc2"]//input[@type="checkbox"]    checked    timeout=10s\n+    Check Checkbox    //tr[@data-id="doc3"]//input[@type="checkbox"]\n+    Wait For Elements State     //tr[@data-id="doc3"]//input[@type="checkbox"]    checked    timeout=10s\n+    Check Checkbox    //tr[@data-id="doc4"]//input[@type="checkbox"]\n+    Wait For Elements State     //tr[@data-id="doc4"]//input[@type="checkbox"]    checked    timeout=10s\n \n the selection count appears\n-    Wait until page contains element  css=#btn-selected-items .label-success\n-    Element Should Contain  css=#btn-selected-items .label-success  4\n+    Get Text    //*[@id="btn-selected-items"]//*[contains(@class,"label-success")]    should be    4\n \n the clear selection link appears\n-    Page Should Contain Element  css=a.remove-all\n+    Get Element Count    //a[contains(@class,"remove-all")]    greater than    0\n \n I clear the selection\n-    Click link  id=btn-selected-items\n-    Click link  css=a.remove-all\n+    Wait For Condition    Classes    //body    contains    patterns-loaded\n+    Sleep    2s\n+    Check Checkbox    //*[contains(@class,"pat-structure")]//input[contains(@class,"select-all")]\n+    Click    //a[@id="btn-selected-items"]\n+    Click    //a[contains(@class,"remove-all")]\n+\n \n no elements should be selected\n-    Checkbox Should Not Be Selected  css=tr[data-id="doc1"] input\n-    Checkbox Should Not Be Selected  css=tr[data-id="doc2"] input\n-    Checkbox Should Not Be Selected  css=tr[data-id="doc3"] input\n-    Checkbox Should Not Be Selected  css=tr[data-id="doc4"] input\n+    Get Checkbox State      //tr[@data-id="doc1"]//input    ==    unchecked\n+    Get Checkbox State      //tr[@data-id="doc2"]//input    ==    unchecked\n+    Get Checkbox State      //tr[@data-id="doc3"]//input    ==    unchecked\n+    Get Checkbox State      //tr[@data-id="doc4"]//input    ==    unchecked\n \n I reorder the elements\n-    Click link  css=#btn-structure-rearrange\n-    Click element  name=reversed\n-    Click button  css=#popover-structure-rearrange .btn-primary\n-    Wait until page contains  Successfully rearranged folder\n+    Click    //a[@id="btn-structure-rearrange"]\n+    Check Checkbox    //*[@id="popover-structure-rearrange"]//input[@name="reversed"]\n+    Click    //*[@id="popover-structure-rearrange"]//button[contains(text(),"Rearrange")]\n+    Wait For Condition    Text    //body    contains    Successfully rearranged folder\n \n The Order Should Be\n-    [Arguments]  ${first}  ${second}  ${third}  ${fourth}\n-    Wait Until Element Is Visible  css=#doc${first}\n-    Wait Until Element Is Visible  css=#doc${second}\n-    Wait Until Element Is Visible  css=#doc${third}\n-    Wait Until Element Is Visible  css=#doc${fourth}\n-    Should be above  css=tr[data-id="doc${first}"]   css=tr[data-id="doc${second}"]\n-    Should be above  css=tr[data-id="doc${second}"]  css=tr[data-id="doc${third}"]\n-    Should be above  css=tr[data-id="doc${third}"]   css=tr[data-id="doc${fourth}"]\n+    [Arguments]    ${first}    ${second}    ${third}    ${fourth}\n+    Should be above    //tr[@data-id="doc${first}"]    //tr[@data-id="doc${second}"]\n+    Should be above    //tr[@data-id="doc${second}"]    //tr[@data-id="doc${third}"]\n+    Should be above    //tr[@data-id="doc${third}"]    //tr[@data-id="doc${fourth}"]\n \n Should be above\n-    [Arguments]  ${locator1}  ${locator2}\n+    [Arguments]    ${locator1}    ${locator2}\n+\n+    ${locator1-position}=    Get BoundingBox    ${locator1}    y\n+    ${locator2-position}=    Get BoundingBox    ${locator2}    y\n \n-    ${locator1-position} =  Get vertical position  ${locator1}\n-    ${locator2-position} =  Get vertical position  ${locator2}\n-    Should be true  ${locator1-position} < ${locator2-position}\n+    Should be true    ${locator1-position} < ${locator2-position}\ndiff --git a/Products/CMFPlone/tests/robot/test_linkintegrity.robot b/Products/CMFPlone/tests/robot/test_linkintegrity.robot\nindex b45dc121ac..7a3db39c17 100644\n--- a/Products/CMFPlone/tests/robot/test_linkintegrity.robot\n+++ b/Products/CMFPlone/tests/robot/test_linkintegrity.robot\n@@ -1,147 +1,132 @@\n-# ============================================================================\n-# Tests for the Plone Link Integrity Support\n-# ============================================================================\n-#\n-# $ bin/robot-server --reload-path src/Products.CMFPlone/Products/CMFPlone/ Products.CMFPlone.testing.PRODUCTS_CMFPLONE_ROBOT_TESTING\n-#\n-# $ bin/robot src/Products.CMFPlone/Products/CMFPlone/tests/robot/test_linkintegrity.robot\n-#\n-# ============================================================================\n+*** Settings ***\n \n-*** Settings *****************************************************************\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Resource  keywords.robot\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n-\n-*** Variables ****************************************************************\n-\n-${SELENIUM_RUN_ON_FAILURE}  Capture page screenshot and log source\n-\n-\n-*** Test Cases ***************************************************************\n+*** Test Cases ***\n \n Scenario: When page is linked show warning\n   Given a logged-in site administrator\n     and a page to link to\n     and a page to edit\n-    and a link in rich text\n-    should show warning when deleting page\n-\n+   When I add a link in rich text\n+   Then I should see a warning when deleting page\n \n Scenario: After you fix linked page no longer show warning\n   Given a logged-in site administrator\n-  a page to link to\n+    and a page to link to\n     and a page to edit\n-    and a link in rich text\n-  should show warning when deleting page\n-    remove link to page\n-  should not show warning when deleting page\n+   When I add a link in rich text\n+   Then I should see a warning when deleting page\n \n+   When I remove link to page\n+   Then I should not see a warning when deleting page\n \n Scenario: Show warning when deleting linked item from folder_contents\n-  Given a logged-in site administrator\n-  a page to link to\n-    and a page to edit\n-    and a link in rich text\n-  should show warning when deleting page from folder_contents\n-    remove link to page\n-  should not show warning when deleting page from folder_contents\n-\n-\n-*** Keywords *****************************************************************\n+    Given a logged-in site administrator\n+      and a page to link to\n+      and a page to edit\n+     When I add a link in rich text\n+     Then I should see a warning when deleting page from folder_contents\n \n-# --- GIVEN ------------------------------------------------------------------\n+     When I remove link to page\n+     Then I should not see a warning when deleting page from folder_contents\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n+*** Keywords ***\n \n+# GIVEN\n \n a page to link to\n-  Create content  type=Document  id=foo  title=Foo\n+    Create content\n+    ...    type=Document\n+    ...    id=foo\n+    ...    title=Foo\n \n a page to edit\n-  Create content  type=Document  id=bar  title=Bar\n-\n-\n-a link in rich text\n-  Go To  ${PLONE_URL}/bar/edit\n-  Wait until element is visible  css=.tox-edit-area iframe\n-  Select Frame  css=.tox-edit-area iframe\n-  Input text  css=.mce-content-body  foo\n-  Execute Javascript    function selectElementContents(el) {var range = document.createRange(); range.selectNodeContents(el); var sel = window.getSelection(); sel.removeAllRanges(); sel.addRange(range);} var el = document.getElementById("tinymce"); selectElementContents(el);\n-  UnSelect Frame\n-\n-  Click Button  css=button[aria-label="Insert/edit link"]\n-  Wait For Then Click Element  css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n-  Wait For Then Click Element  xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[3]\n-  Wait For Then Click Element  xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n-  Wait Until Element Is Not Visible    xpath=//div[contains(@class,"content-browser-position-wrapper")]\n-  Wait For Then Click Element  css=.modal-footer input[name="insert"]\n-  Select Frame  css=.tox-edit-area iframe\n-  Execute Javascript  window.getSelection().removeAllRanges()\n-  UnSelect Frame\n-  Wait Until Element Is Not Visible  css=.modal-footer input[name="insert"]\n-  Wait For Then Click Element  css=#form-buttons-save\n-\n-\n-should show warning when deleting page\n-\n-  Go To  ${PLONE_URL}/foo\n-  Wait For Then Click Element  css=#plone-contentmenu-actions > a\n-  Wait For Then Click Element  css=#plone-contentmenu-actions-delete\n-  Wait until page contains element  css=.breach-container .breach-item\n-\n-\n-should show warning when deleting page from folder_contents\n-  Go To  ${PLONE_URL}/folder_contents\n-  Given folder contents pattern loaded\n-  Wait For Then Click Element  css=tr[data-id="foo"] input\n-  Checkbox Should Be Selected  css=tr[data-id="foo"] input\n-  Wait until keyword succeeds  30  1  Page should not contain element  css=#btn-delete.disabled\n-\n-  Wait For Then Click Element  css=#btngroup-mainbuttons #btn-delete\n-  Wait until page contains element  css=.popover-content .btn-danger\n-  Page should contain element  css=.breach-container .breach-item\n-  Wait For Then Click Element  css=#popover-delete .closeBtn\n-  Checkbox Should Be Selected  css=tr[data-id="foo"] input\n-\n-\n-should not show warning when deleting page from folder_contents\n-  Go To  ${PLONE_URL}/folder_contents\n-  Given folder contents pattern loaded\n-  Wait For Then Click Element  css=tr[data-id="foo"] input\n-  Checkbox Should Be Selected  css=tr[data-id="foo"] input\n-  Wait until keyword succeeds  30  1  Page should not contain element  css=#btn-delete.disabled\n-  Wait For Then Click Element  css=#btngroup-mainbuttons #btn-delete\n-  Wait until page contains element  css=.popover-content .btn-danger\n-  Page should not contain element  css=.breach-container .breach-item\n-  Wait For Then Click Element  css=#popover-delete .applyBtn\n-  Wait until page contains  Successfully delete items\n-  Wait until keyword succeeds  30  1  Page should not contain Element  css=tr[data-id="foo"] input\n-\n-\n-should not show warning when deleting page\n-  Go To  ${PLONE_URL}/foo\n-  Wait For Then Click Element  css=#plone-contentmenu-actions > a\n-  Wait For Then Click Element  css=#plone-contentmenu-actions-delete\n-  Page should not contain element  css=.breach-container .breach-item\n-\n-\n-remove link to page\n-  Go To  ${PLONE_URL}/bar\n-  Wait For Then Click Element  css=#contentview-edit a\n-  Wait For Element  css=.tox-edit-area iframe\n-  Select Frame  css=.tox-edit-area iframe\n-  Input text  css=.mce-content-body  foo\n-  Execute Javascript    function selectElementContents(el) {var range = document.createRange(); range.selectNodeContents(el); var sel = window.getSelection(); sel.removeAllRanges(); sel.addRange(range);} var el = document.getElementById("tinymce"); selectElementContents(el);\n-  UnSelect Frame\n-  Click Button  css=button[aria-label="Remove link"]\n-  Wait For Then Click Element  css=#form-buttons-save\n+    Create content\n+    ...    type=Document\n+    ...    id=bar\n+    ...    title=Bar\n+\n+# When\n+I add a link in rich text\n+    Go To    ${PLONE_URL}/bar/edit\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <p>foo</p>\n+    Mark text foo in tinymce editor\n+    Click    //button[@aria-label="Insert/edit link"]\n+    Click    //div[contains(@class,"linkModal")]//div[contains(@class,"content-browser-selected-items-wrapper")]//button[contains(@class,"btn-primary")]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[3]\n+    Click    //div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n+    Click    //div[contains(@class,"modal-footer")]//input[@name="insert"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n+\n+I remove link to page\n+    Go To    ${PLONE_URL}/bar\n+    Click    //*[@id="contentview-edit"]//a\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    foo\n+    Mark text foo in tinymce editor\n+    Click    //button[@aria-label="Remove link"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\n+\n+# Then\n+\n+I should see a warning when deleting page\n+    Go To  ${PLONE_URL}/foo\n+    Click    //*[@id="plone-contentmenu-actions"]/a\n+    Click    //*[@id="plone-contentmenu-actions-delete"]\n+    Get Element Count    //*[contains(@class,"breach-container")]//*[contains(@class,"breach-item")]    greater than    0\n+\n+I should not see a warning when deleting page\n+    Go To  ${PLONE_URL}/foo\n+    Click    //*[@id="plone-contentmenu-actions"]/a\n+    Click    //*[@id="plone-contentmenu-actions-delete"]\n+    Get Element Count    //*[contains(@class,"breach-container")]//*[contains(@class,"breach-item")]    should be    0\n+\n+\n+I should see a warning when deleting page from folder_contents\n+    Go To  ${PLONE_URL}/folder_contents\n+    Check Checkbox    //tr[@data-id="foo"]//input\n+    Get Checkbox State      //tr[@data-id="foo"]//input    ==    checked\n+    Get Element Count    //*[@id="btngroup-mainbuttons"]//a[@id="btn-delete" and contains(@class,"disabled")]    should be    0\n+    Click    //*[@id="btngroup-mainbuttons"]//a[@id="btn-delete"]\n+    Get Element Count    //*[contains(@class,"breach-container")]//*[contains(@class,"breach-item")]    greater than    0\n+    Get Checkbox State      //tr[@data-id="foo"]//input    ==    checked\n+\n+\n+I should not see a warning when deleting page from folder_contents\n+    Go To  ${PLONE_URL}/folder_contents\n+    Check Checkbox    //tr[@data-id="foo"]//input\n+    Get Checkbox State      //tr[@data-id="foo"]//input    ==    checked\n+    Get Element Count    //*[@id="btngroup-mainbuttons"]//a[@id="btn-delete" and contains(@class,"disabled")]    should be    0\n+    Click    //*[@id="btngroup-mainbuttons"]//a[@id="btn-delete"]\n+    Get Element States    //*[@id="popover-delete"]//*[contains(@class,"popover-content")]    contains    visible\n+    Get Element Count    //*[contains(@class,"breach-container")]//*[contains(@class,"breach-item")]    should be    0\n+    Click    //*[contains(@class,"popover-content")]//button[contains(@class,"applyBtn")]\n+    Get Text    //body    contains    Successfully delete items\n+    Get Element Count      //tr[@data-id="foo"]//input    should be    0\n+\n+# DRY\n+\n+Mark text foo in tinymce editor\n+\n+    # select the text `heading` via javascript\n+    Evaluate JavaScript    ${None}\n+    ...    () => {\n+    ...        let iframe_document = document.querySelector(".tox-edit-area iframe").contentDocument;\n+    ...        let body = iframe_document.body;\n+    ...        let p = body.firstChild;\n+    ...        let range = new Range();\n+    ...        range.setStart(p.firstChild, 0);\n+    ...        range.setEnd(p.firstChild, 3);\n+    ...        iframe_document.getSelection().removeAllRanges();\n+    ...        iframe_document.getSelection().addRange(range);\n+    ...    }\n+    ...    all_elements=False\ndiff --git a/Products/CMFPlone/tests/robot/test_livesearch.robot b/Products/CMFPlone/tests/robot/test_livesearch.robot\nindex 8bed725311..a8a2c33ee5 100644\n--- a/Products/CMFPlone/tests/robot/test_livesearch.robot\n+++ b/Products/CMFPlone/tests/robot/test_livesearch.robot\n@@ -1,84 +1,82 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Variables  Products/CMFPlone/tests/robot/variables.py\n+Variables    variables.py\n \n-Resource  keywords.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n \n-\n-*** Test cases ***************************************************************\n+*** Test cases ***\n \n \n Scenario: Simple Livesearch\n     Given a logged-in site administrator\n-      and a document  Welcome to Plone\n-     When I search for  Welcome\n-     Then the livesearch results should contain  Welcome to Plone\n-      and expected livesearch results  1\n+      and a document    Welcome to Plone\n+     When I search for    Welcome\n+     Then the livesearch results should contain    Welcome to Plone\n+      and expected livesearch results    1\n \n Scenario: Livesearch with image results\n     Given a logged-in site administrator\n-      and a news item  My News with Image\n-     When I search for  My News\n-     Then the livesearch results should contain  My News with Image\n-      and expected livesearch results  1\n-      and Page should contain image  css=.livesearch-results li.search-result .col.img img\n+      and a news item    My News with Image\n+     When I search for    My News\n+     Then the livesearch results should contain    My News with Image\n+      and expected livesearch results    1\n+      and Get Element Count    //*[contains(@class,"livesearch-results")]//li[contains(@class,"search-result")]//*[contains(@class,"col") and contains(@class,"img")]//img    greater than    0\n \n      When I disable images in results in search controlpanel\n       and I search for  My News\n-     Then Page should not contain image  css=.livesearch-results li.search-result .col.img img\n+     and Get Element Count    //*[contains(@class,"livesearch-results")]//li[contains(@class,"search-result")]//*[contains(@class,"col") and contains(@class,"img")]//img    should be    0\n \n \n-*** Keywords *****************************************************************\n+*** Keywords ***\n \n a document\n-    [Arguments]  ${title}\n-    Create content  type=Document  id=doc  title=${title}\n+    [Arguments]    ${title}\n+    Create content\n+    ...    type=Document\n+    ...    id=doc\n+    ...    title=${title}\n \n a news item\n-    [Arguments]  ${title}\n-    Go to  ${PLONE_URL}/++add++News Item\n-    Wait until page contains  Add News Item\n-    Input text  name=form.widgets.IDublinCore.title  ${title}\n-    Choose File  name=form.widgets.ILeadImageBehavior.image  ${PATH_TO_TEST_FILES}/plone-logo.png\n-    Click Button  Save\n-    Wait until page contains  Item created  error=Image could not be created.\n+    [Arguments]    ${title}\n+    Go to    ${PLONE_URL}/++add++News Item\n+    Type text    //input[@name="form.widgets.IDublinCore.title"]    ${title}\n+    Upload File By Selector    //input[@name="form.widgets.ILeadImageBehavior.image"]    ${PATH_TO_TEST_FILES}/pixel.png\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Item created    message=Image could not be created.\n \n I search for\n-    [Arguments]  ${searchtext}\n-    Input text  css=input#searchGadget  ${searchtext}\n-    Wait For Element  css=input#searchGadget\n+    [Arguments]    ${searchtext}\n+    Type Text    //input[@id="searchGadget"]    ${searchtext}\n \n I search the currentfolder only for\n-    [Arguments]  ${searchtext}\n-    Select checkbox  id=searchbox_currentfolder_only\n-    Input text  css=input#searchGadget  ${searchtext}\n-    Wait For Element  css=input#searchGadget\n+    [Arguments]    ${searchtext}\n+    Check Checkbox    //*[@id="searchbox_currentfolder_only"]\n+    Type Text    //input[@id="searchGadget"]    ${searchtext}\n \n the livesearch results should contain\n-    [Arguments]  ${text}\n-    Wait until keyword succeeds  5s  1s  Element should contain  css=.livesearch-results li a .heading  ${text}\n+    [Arguments]    ${text}\n+    Get Element States    //ul[contains(@class,"livesearch-results")]    contains    visible\n+    Get Text    //ul[contains(@class,"livesearch-results")]    contains    ${text}\n \n the livesearch results should not contain\n-    [Arguments]  ${text}\n-    Wait until keyword succeeds  5s  1s  Page should not contain  css=.livesearch-results li a .heading  ${text}\n+    [Arguments]    ${text}\n+    Get Element States    //ul[contains(@class,"livesearch-results")]    contains    visible\n+    Get Text    //ul[contains(@class,"livesearch-results")]    not contains    ${text}\n \n expected livesearch results\n-    [Arguments]  ${num}\n-    ${count} =  Get Element Count  css=.livesearch-results li.search-result\n-    Should Be Equal as Numbers  ${count}  ${num}\n+    [Arguments]    ${num}\n+    Get Element Count    //*[contains(@class,"livesearch-results")]//li[contains(@class,"search-result")]    should be    ${num}\n+\n \n I disable images in results in search controlpanel\n-    Go to  ${PLONE_URL}/@@search-controlpanel\n-    Wait until page contains  Search Settings\n-    Unselect Checkbox  form.widgets.search_show_images:list\n-    Click Button  Save\n-    Wait until page contains  Changes saved\n+    Go to    ${PLONE_URL}/@@search-controlpanel\n+    Uncheck Checkbox    //input[@name="form.widgets.search_show_images:list"]\n+    Click    //button[@name="form.buttons.save"]\n+    Get Text    //body    contains    Changes saved\ndiff --git a/Products/CMFPlone/tests/robot/test_overlays.robot b/Products/CMFPlone/tests/robot/test_overlays.robot\nindex b8fca6d3d9..5b96532721 100644\n--- a/Products/CMFPlone/tests/robot/test_overlays.robot\n+++ b/Products/CMFPlone/tests/robot/test_overlays.robot\n@@ -1,22 +1,18 @@\n *** Settings ***\n \n-Documentation  These tests are just testing the overlay behavior not the\n-...            functionality of each form. This is supposed to be tested in\n-...            functional tests somewhere. At some point in the future the\n-...            functional tests can be transferred to robot tests into each\n-...            scenario test case.\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Variables    variables.py\n \n-Resource  common.robot\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-Test Setup  Run Keywords  Plone test setup\n-Test Teardown  Run keywords  Plone test teardown\n+*** Variables ***\n \n+${TEST_FOLDER}  test-folder\n \n *** Test cases ***\n \n@@ -25,78 +21,65 @@ Scenario: Contact form overlay opens\n      When I click the \'Contact\' link\n      Then overlay should open\n \n+\n Scenario: Contact form overlay closes\n-    Go to  ${PLONE_URL}/logout\n-    Given the \'Contact\' overlay\n+    Given the site root logged out\n+      and the \'Contact\' overlay\n      When I close the overlay\n      Then overlay should close\n \n Scenario: Log in form overlay opens\n-    Go to  ${PLONE_URL}/logout\n-    Given the site root\n+    Given the site root logged out\n+      and the site root\n      When I click the \'Log in\' link\n      Then overlay should open\n \n Scenario: Log in form overlay closes\n-    Go to  ${PLONE_URL}/logout\n-    Given the site root\n-    Given the \'Log in\' overlay\n+    Given the site root logged out\n+      and the site root\n+      and the \'Log in\' overlay\n      When I close the overlay\n      Then overlay should close\n \n Scenario: Log in form overlay remains on wrong credentials\n-    Go to  ${PLONE_URL}/logout\n-    Given the site root\n-    Given the \'Log in\' overlay\n+    Given the site root logged out\n+      and the site root\n+      and the \'Log in\' overlay\n      When I enter wrong credentials\n      Then overlay should remain open\n-      And login overlay shows an error\n+      and login overlay shows an error\n \n Scenario: Log in form overlay closes on valid credentials\n-    Go to  ${PLONE_URL}/logout\n-    Given the site root\n-    Given the \'Log in\' overlay\n+    Given the site root logged out\n+      and the site root\n+      and the \'Log in\' overlay\n      When I enter valid credentials\n      Then overlay should close\n \n Scenario: Set default content item of a folder overlay opens\n     Given a logged-in site administrator\n-      And a document \'doc\' in the test folder\n+      and a document \'doc\' in the test folder\n      When I set the default content view of the test folder\n      Then overlay should open\n \n-# XXX Next 2 tests are commented out. After hours of messing around,\n-# I still can not pinpoint why this is happening.\n-# The error originates from this change https://github.com/plone/mockup/commit/ccec87028bc22e082d6d9a95874d8a961f91b707\n-# which provides at least some error reporting(window.alert) to users when modals\n-# experience issues. We need this change in modals...\n-#\n-# However, in these 2 cases, it is triggering the window.alert\n-# and causing the tests to fail in certain cases.\n-# It ONLY happens when running automatically by the robot framework\n-# runner. If you try to use Import library  DebugLibrary and\n-# run the commands manually, of course it works fine. So yes,\n-# there is no way to really figure out this AFAIK.\n-# Also, of course, this doesn\'t happen in real user testing.\n-#\n-#Scenario: Change default content item of a folder overlay opens\n-#    Given a logged-in site administrator\n-#      And a document as the default view of the test folder\n-#     When I change the default content view of the test folder\n-#     Then overlay should open\n-\n-#Scenario: Change default content item of a folder overlay closes\n-#    Given a logged-in site administrator\n-#      And a document as the default view of the test folder\n-#     When I change the default content view of the test folder\n-#      And I \'Cancel\' the form\n-#     Then overlay should close\n-#     When I change the default content view of the test folder\n-#      And I \'Save\' the form\n-#     Then overlay should close\n-#     When I change the default content view of the test folder\n-#      And I close the overlay\n-#     Then overlay should close\n+Scenario: Change default content item of a folder overlay opens\n+   Given a logged-in site administrator\n+     and a document as the default view of the test folder\n+    When I change the default content view of the test folder\n+    Then overlay should open\n+\n+Scenario: Change default content item of a folder overlay closes\n+   Given a logged-in site administrator\n+     And a document as the default view of the test folder\n+    When I change the default content view of the test folder\n+     And I \'Cancel\' the form\n+    Then overlay should close\n+    When I change the default content view of the test folder\n+     And I \'Save\' the form\n+    Then overlay should close\n+    When I change the default content view of the test folder\n+     And I close the overlay\n+    Then overlay should close\n \n Scenario: Delete content action overlay opens\n     Given a logged-in site administrator\n@@ -132,7 +115,7 @@ Scenario: Rename content action overlay closes\n Scenario: Register user overlay opens\n     Given the mail setup configured\n       And the self registration enabled\n-      Go to  ${PLONE_URL}/logout\n+      and the site root logged out\n       And the site root\n      When I click the \'Register\' link\n      Then overlay should open\n@@ -140,7 +123,7 @@ Scenario: Register user overlay opens\n Scenario: Register user overlay closes\n     Given the mail setup configured\n       And the self registration enabled\n-      Go to  ${PLONE_URL}/logout\n+      and the site root logged out\n       And the site root\n       And the \'Register\' overlay\n      When I close the overlay\n@@ -149,24 +132,22 @@ Scenario: Register user overlay closes\n Scenario: Register user overlay remains on wrong data\n     Given the mail setup configured\n       And the self registration enabled\n-      Go to  ${PLONE_URL}/logout\n+      and the site root logged out\n       And the site root\n       And the \'Register\' overlay\n      When I send the register form\n      Then overlay should remain open\n       And overlay shows an error\n \n-# Note: For this one we need to fake the mail server, as it tries to send the\n-# mail right away. Or change the somehow confusing message that shows when this\n-# happens.\n-#Scenario: Register user overlay closes on valid data\n-#    Given the mail setup configured\n-#      And the self registration enabled\n-#      And the site root\n-#      And the \'Register\' overlay\n-#     When I enter valid register user data\n-#      And I send the register form\n-#     Then overlay should close\n+# Tests based on MockupMailServer, this should be a valid tests\n+Scenario: Register user overlay closes on valid data\n+   Given the mail setup configured\n+     And the self registration enabled\n+     And the site root\n+     And the \'Register\' overlay\n+    When I enter valid register user data\n+     And I send the register form\n+    Then overlay should close\n \n Scenario: New user overlay opens\n     Given a logged-in site administrator\n@@ -190,144 +171,137 @@ Scenario: New user overlay closes on valid data\n       And I send the register form\n      Then overlay should close\n \n-# There is no more history overlay\n-# Scenario: History overlay opens\n-#     Given a logged-in site administrator\n-#       And the test folder\n-#      When I click the \'Content Info\' link\n-#       And I click the \'History\' link\n-#      Then overlay should open\n-#\n-# Scenario: History overlay closes\n-#     Given a logged-in site administrator\n-#       And the test folder\n-#       When I click the \'Content Info\' link\n-#       And I click the \'History\' link\n-#      When I close the overlay\n-#      Then overlay should close\n-#\n+\n *** Keywords ***\n \n-Background\n-    Given a logged-in site administrator\n-      and a test folder\n-    Disable autologin\n-    Go to homepage\n+# GIVEN\n+the site root logged out\n+    Go to    ${PLONE_URL}/logout\n+\n+the site root\n+    Go to    ${PLONE_URL}\n+\n+\n+the \'${link_name}\' overlay\n+    Click    //a[descendant-or-self::*[contains(text(), "${link_name}")]]\n+    Get Element Count    //div[contains(@class,"modal-dialog")]    greater than    0\n+\n+\n+a document \'${title}\' in the test folder\n+    Go to    ${PLONE_URL}/${TEST_FOLDER}/++add++Document\n+    Type Text    //input[@id="form-widgets-IDublinCore-title"]    ${title}\n+    Click    //button[@name="form.buttons.save"]\n+\n+\n+a document as the default view of the test folder\n+    a document \'doc\' in the test folder\n+    Go to    ${PLONE_URL}/${TEST_FOLDER}\n+    Click    //li[@id=\'plone-contentmenu-display\']/a\n+    Click    //a[@id="contextSetDefaultPage"]\n+    Click    //input[@id="doc"]\n+    Click    //div[contains(@class,"modal-footer")]//button[@name="form.buttons.Save"]\n+    Wait For Condition    Text    //body//h1    contains    doc\n \n-a logged-in site administrator\n-  Enable autologin as  Site Administrator\n \n the users and groups configlet\n-    Go to  ${PLONE_URL}/@@usergroup-userprefs\n-    Wait until page contains  User Search\n+    Go to    ${PLONE_URL}/@@usergroup-userprefs\n+    Get Text    //body    contains    User Search\n+\n+# WHEN\n \n I click the \'${link_name}\' link\n-    Wait until page contains  ${link_name}\n-    Element should be visible  xpath=//a[descendant-or-self::*[contains(text(), \'${link_name}\')]]\n-    Click Link  xpath=//a[descendant-or-self::*[contains(text(), \'${link_name}\')]]\n+    Get Element Count    //a[descendant-or-self::*[contains(text(), "${link_name}")]]    greater than    0\n+    Click    //a[descendant-or-self::*[contains(text(), "${link_name}")]]\n \n-the \'${link_name}\' overlay\n-    Wait until page contains  ${link_name}\n-    Click Link  xpath=//a[descendant-or-self::*[contains(text(), \'${link_name}\')]]\n-    Wait until keyword succeeds  30  1  Page should contain element  css=div.modal-dialog\n \n-overlay should open\n-    Wait until keyword succeeds  30  1  Element Should Be Visible  css=div.modal-dialog\n+I close the overlay\n+    Click    //div[contains(@class,"modal-header")]//button[contains(@class,"modal-close")]\n \n-overlay should remain open\n-    Wait until page contains element  css=div.modal-wrapper\n-    Wait until element is visible  css=div.modal-wrapper\n \n-I close the overlay\n-    Click Element  css=div.modal-header button.modal-close\n+I enter wrong credentials\n+    I enter credentials    wrong    user\n \n-overlay should close\n-    Wait until keyword succeeds  40  1  Page should not contain element  css=div.modal-dialog\n \n-login overlay shows an error\n-    Wait Until Page Contains  Error\n+I enter valid credentials\n+    I enter credentials    ${SITE_OWNER_NAME}    ${SITE_OWNER_PASSWORD}\n \n-overlay shows an error\n-    Wait Until Page Contains  There were errors\n \n-overlay requires to compile a field\n-    Wait Until Page Contains  Required input is missing\n+I set the default content view of the test folder\n+    Go to    ${PLONE_URL}/${TEST_FOLDER}\n+    Click    //li[@id=\'plone-contentmenu-display\']/a\n+    Click    //a[@id="contextSetDefaultPage"]\n+\n+\n+I change the default content view of the test folder\n+    Go to    ${PLONE_URL}/${TEST_FOLDER}\n+    Click    //li[@id=\'plone-contentmenu-display\']/a\n+    Click    //a[@id="folderChangeDefaultPage"]\n+\n \n I \'${action}\' the form\n-    Wait until keyword succeeds  30  1  Element Should Be Visible  css=div.modal-footer button[name="form.buttons.${action}"]\n-    Click Element  css=div.modal-footer button[name="form.buttons.${action}"]\n+    Click    //div[contains(@class,"modal-footer")]//button[@name="form.buttons.${action}"]\n \n-I enter wrong credentials\n-    Input text  __ac_name  wrong\n-    Input text  __ac_password  user\n-    Wait For Then Click Element  css=div.modal-footer button\n \n-I enter valid credentials\n-    Wait until page contains element  name=__ac_name\n-    Input text for sure  __ac_name  ${SITE_OWNER_NAME}\n-    Input text for sure  __ac_password  ${SITE_OWNER_PASSWORD}\n-    Wait For Then Click Element  css=div.modal-footer button\n+I trigger the \'${action}\' action menu item of the test folder\n+    Go to    ${PLONE_URL}/${TEST_FOLDER}\n+    Click    //li[@id="plone-contentmenu-actions"]/a\n+    Click    //a[@id="plone-contentmenu-actions-${action}"]\n \n-I enter valid user data\n-    Wait until page contains element  name=form.widgets.password_ctl\n-    Input text for sure  form.widgets.username       myuser\n-    Input text for sure  form.widgets.email          my@email.eu\n-    Input text for sure  form.widgets.password       newpassword\n-    Input text for sure  form.widgets.password_ctl   newpassword\n \n-I enter valid register user data\n-    Wait until page contains element  name=form.widgets.username\n-    Input text  form.widgets.username       myuser\n-    Input text  form.widgets.email          my@email.eu\n+I confirm deletion of the content\n+    Click    //div[contains(@class,"modal-footer")]//button[@name="form.buttons.Delete"]\n+\n \n I send the register form\n-    Wait until page contains element  css=div.modal-footer #form-buttons-register\n-    Click Element  css=div.modal-footer #form-buttons-register\n+    Click    //div[contains(@class,"modal-footer")]//button[@name="form.buttons.register"]\n+\n+\n+I enter valid register user data\n+    Type Text    //input[@name="form.widgets.username"]    myuser\n+    Type Text    //input[@name="form.widgets.email"]    myuser@plone.org\n+\n \n I trigger the add a new user action\n-    Click Element  id=add-user\n+    Click    //a[@id="add-user"]\n \n-a document \'${title}\' in the test folder\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}/++add++Document\n-    Wait For Condition  return window.jQuery(\'.autotoc-nav .active:visible\').length > 0\n-    Execute Javascript  $(\'#form-widgets-IDublinCore-title\').val(\'${title}\'); return 0;\n-    Click Button  Save\n \n-I set the default content view of the test folder\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}\n-    Given patterns are loaded\n-    Click link  xpath=//li[@id=\'plone-contentmenu-display\']/a\n-    Click link  id=contextSetDefaultPage\n+I enter valid user data\n+    Type Text    //input[@name="form.widgets.username"]    myuser\n+    Type Text    //input[@name="form.widgets.email"]    myuser@plone.org\n+    Type Text    //input[@name="form.widgets.password"]    newpassword\n+    Type Text    //input[@name="form.widgets.password_ctl"]    newpassword\n \n-a document as the default view of the test folder\n-    a document \'doc\' in the test folder\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}\n-    Given patterns are loaded\n-    Click link  xpath=//li[@id=\'plone-contentmenu-display\']/a\n-    Wait until element is visible  id=contextSetDefaultPage\n-    Click link  id=contextSetDefaultPage\n-    Click element  id=doc\n-    Click element  css=div.modal-footer button[name="form.buttons.Save"]\n \n-I change the default content view of the test folder\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}\n-    Given patterns are loaded\n-    Click link  xpath=//li[@id=\'plone-contentmenu-display\']/a\n-    Wait until element is visible  id=folderChangeDefaultPage\n-    Click link  id=folderChangeDefaultPage\n \n-I trigger the \'${action}\' action menu item of the test folder\n-    Go to  ${PLONE_URL}/${TEST_FOLDER}\n-    Given patterns are loaded\n-    Element should be visible  xpath=//li[@id=\'plone-contentmenu-actions\']/a\n-    Click link  xpath=//li[@id=\'plone-contentmenu-actions\']/a\n-    Wait until element is visible  id=plone-contentmenu-actions-${action}\n-    Click link  id=plone-contentmenu-actions-${action}\n-    Wait until page contains Element  css=div.modal-dialog\n+# THEN\n+\n+overlay should open\n+    Get Element States    //div[contains(@class,"modal-dialog")]    contains    visible\n+\n+\n+overlay should close\n+    Get Element Count    //div[contains(@class,"modal-dialog")]    should be    0\n+\n+\n+overlay should remain open\n+    Get Element States    //div[contains(@class,"modal-wrapper")]    contains    visible\n+\n+\n+login overlay shows an error\n+    Get Text    //div[contains(@class,"modal-wrapper")]    contains    Error\n+\n+\n+overlay shows an error\n+    Get Text    //div[contains(@class,"modal-wrapper")]    contains    There were errors\n+\n+\n+overlay requires to compile a field\n+    Get Text    //div[contains(@class,"modal-wrapper")]    contains    Required input is missing\n \n-I confirm deletion of the content\n-    # Note: The \'delete\' button has no standard z3c.form name attribute\n-    Wait until keyword succeeds  2  2  Click Element  css=div.modal-footer button#form-buttons-Delete\n \n-modals loaded\n-    Wait For Condition  return window.jQuery(\'.modal-wrapper\').size() > 0\n+# DRY\n+I enter credentials\n+    [Arguments]    ${username}    ${password}\n+    Type Text    //input[@name="__ac_name"]    ${username}\n+    Type Text    //input[@name="__ac_password"]    ${password}\n+    Click    //div[contains(@class,"modal-footer")]//button\ndiff --git a/Products/CMFPlone/tests/robot/test_portlets.robot b/Products/CMFPlone/tests/robot/test_portlets.robot\nindex 6167adc91b..5641220fab 100644\n--- a/Products/CMFPlone/tests/robot/test_portlets.robot\n+++ b/Products/CMFPlone/tests/robot/test_portlets.robot\n@@ -1,56 +1,89 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Variables    variables.py\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n \n-*** Test cases ***************************************************************\n+*** Test cases ***\n \n-Scenario: Add Login Portlet\n+Scenario: Add Login Portlet to left column\n     Given a logged-in site administrator\n       and a manage portlets view\n      When I add a \'Login\' portlet to the left column\n+      and I go to portal root\n      Then I should see a \'Login\' portlet in the left column\n \n+Scenario: Add Login Portlet to right column\n+    Given a logged-in site administrator\n+      and a manage portlets view\n+     When I add a \'Login\' portlet to the right column\n+      and I go to portal root\n+     Then I should see a \'Login\' portlet in the right column\n \n-*** Keywords *****************************************************************\n+Scenario: Delete Login Portlet from left column\n+    Given a logged-in site administrator\n+      and a manage portlets view\n+     When I add a \'Login\' portlet to the left column\n+      and I delete a \'Login\' portlet from the left column\n+      and I go to portal root\n+     Then I should not see a \'Login\' portlet in the left column\n+\n+Scenario: Delete Login Portlet from right column\n+    Given a logged-in site administrator\n+      and a manage portlets view\n+     When I add a \'Login\' portlet to the right column\n+      and I delete a \'Login\' portlet from the right column\n+      and I go to portal root\n+     Then I should not see a \'Login\' portlet in the right column\n+\n+# TODO: Move Portlets Up and Down\n+*** Keywords ***\n+\n+# Given\n \n a manage portlets view\n-    Go to   ${PLONE_URL}/@@manage-portlets\n-    Wait until page contains  Manage portlets\n+    Go to    ${PLONE_URL}/@@manage-portlets\n+    Get Text    //body    contains    Manage portlets\n+\n+# When\n \n I add a \'${portletname}\' portlet to the left column\n-    Select from list by label  xpath=//div[@id="portletmanager-plone-leftcolumn"]//select  ${portletname}\n+    Select Options By    //div[@id="portletmanager-plone-leftcolumn"]//select[contains(@class,"add-portlet")]    label    ${portletname}\n+    Get Text    //body    contains    Portlet added\n \n I add a \'${portletname}\' portlet to the right column\n-    Select from list by label  xpath=//div[@id="portletmanager-plone-rightcolumn"]//select  ${portletname}\n+    Select Options By    //div[@id="portletmanager-plone-rightcolumn"]//select[contains(@class,"add-portlet")]    label    ${portletname}\n+    Get Text    //body    contains    Portlet added\n+\n+I go to portal root\n+    Disable autologin\n+    Go to    ${PLONE_URL}\n+\n+I delete a \'${portlet}\' portlet from the left column\n+    Click    //*[@id="portletmanager-plone-leftcolumn"]/div[2]/div[2]/div[2]/form[3]/button\n+    Get Element Count    //*[@id="portletmanager-plone-leftcolumn"]//div[@class="portletAssignment"]    <=    1\n \n-I delete a \'${portlet}\'\' portlet from the left column\n-    Click Link  xpath=//div[@id="portal-column-one"]//div[@class="portletHeader" and contains(.,"${portlet}")]//a[@class="delete"]  don\'t wait\n-    Wait until keyword succeeds  1s  10s  Flex Element Should not exist  xpath=//div[@id="portal-column-one"]//div[@class="portletHeader" and contains(.,"${portlet}")]\n+I delete a \'${portlet}\' portlet from the right column\n+    Click    //*[@id="portletmanager-plone-rightcolumn"]/div[2]/div[2]/div[2]/form[3]/button\n+    Get Element Count    //*[@id="portletmanager-plone-rightcolumn"]//div[@class="portletAssignment"]    <=    1\n \n-when I delete the \'${portlet}\' portlet from the right column\n-    Click Link  xpath=//div[@id="portal-column-two"]//div[@class="portletHeader" and contains(.,"${portlet}")]//a[@class="delete"]  don\'t wait\n-    Wait until keyword succeeds  1s  10s  Flex Element Should not exist  xpath=//div[@id="portal-column-two"]//div[@class="portletHeader" and contains(.,"${portlet}")]\n \n+# Then\n I should see a \'${portletname}\' portlet in the left column\n-    Wait until page contains  ${portletname}\n-    Element should contain  portal-column-one  ${portletname}\n+    Get Element Count    //*[@id="portal-column-one"]//div[contains(@class,"portlet${portletname}")]    should be    1\n \n I should see a \'${portletname}\' portlet in the right column\n-    Wait until page contains  ${portletname}\n-    Element should contain  portal-column-two  ${portletname}\n+    Get Element Count    //*[@id="portal-column-two"]//div[contains(@class,"portlet${portletname}")]    should be    1\n \n-I should not see \'${text}\' in the left column\n-    Flex Element should not exist  xpath=//div[@id="portal-column-one" and contains(.,"${text}")]\n+I should not see a \'${text}\' portlet in the left column\n+    Get Element Count    //*[@id="portal-column-one"]//div[contains(@class,"portlet${text}")]    should be    0\n \n-I should not see \'${text}\' in the right column\n-    Flex Element should not exist  xpath=//div[@id="portal-column-two" and contains(.,"${text}")]\n+I should not see a \'${text}\' portlet in the right column\n+    Get Element Count    //*[@id="portal-column-two"]//div[contains(@class,"portlet${text}")]    should be    0\ndiff --git a/Products/CMFPlone/tests/robot/test_querystring.robot b/Products/CMFPlone/tests/robot/test_querystring.robot\nindex 5a5e66fbf7..ae0a1a3bf4 100644\n--- a/Products/CMFPlone/tests/robot/test_querystring.robot\n+++ b/Products/CMFPlone/tests/robot/test_querystring.robot\n@@ -1,246 +1,346 @@\n-*** Settings *****************************************************************\n+*** Settings ***\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource    plone/app/robotframework/browser.robot\n+Resource    keywords.robot\n \n-Library  Remote  ${PLONE_URL}/RobotRemote\n+Library    Remote    ${PLONE_URL}/RobotRemote\n \n-Resource  keywords.robot\n+Variables    variables.py\n \n-Test Setup  Run keywords  Plone Test Setup\n-Test Teardown  Run keywords  Plone Test Teardown\n+Test Setup    Run Keywords    Plone test setup\n+Test Teardown    Run keywords     Plone test teardown\n \n-*** Test Cases **************************************************************\n+\n+*** Test Cases ***\n \n Scenario: Location query Current\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I activate the operator Current in the criteria Location\n-    Then we expect 1 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I activate the operator Current in the criteria Location\n+     Then we expect 1 hits\n \n Scenario: Location query Parent\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I activate the operator Parent in the criteria Location\n-    Then we expect 3 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I activate the operator Parent in the criteria Location\n+     Then we expect 3 hits\n \n Scenario: Location query Custom\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I activate the operator Custom in the criteria Location\n-    and I search in B subfolder in the related items widget\n-    Then we expect 5 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I activate the operator Custom in the criteria Location\n+      and I search in B subfolder in the related items widget\n+     Then we expect 5 hits\n \n Scenario: Location query Advanced\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I activate the operator Advanced in the criteria Location\n-    Then I expect to be in Advanced mode\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I activate the operator Advanced in the criteria Location\n+     Then I expect to be in Advanced mode\n \n Scenario: Location query Simple\n+    # this fails simple is not available, first select \'Advanced Mode\' then you can select \'Simple Mode\'\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I activate the operator Simple in the criteria Location\n-    Then I expect to be in Simple mode\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I activate the operator Advanced in the criteria Location\n+      and I open the select box titled operator\n+      and I select index Simple\n+     Then I expect to be in Simple mode\n \n Scenario: Title query\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I open the criteria Title\n-    and I search for A\n-    Then we expect 1 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I open the criteria Title\n+      and I search for A\n+     Then we expect 1 hits\n \n Scenario: Description query\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I open the criteria Description\n-    and I search for a\n-    Then we expect 1 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I open the criteria Description\n+      and I search for a\n+     Then we expect 1 hits\n \n Scenario: Searchable text query\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I open the criteria Searchable text\n-    and I search for a\n-    and Sleep  0.2\n-    and Wait For Then Click Element  css=div.querystring-preview\n-    Then we expect 2 hits\n-    When I open the criteria Searchable text\n-    and I search for d\n-    Then we expect 1 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I open the criteria Searchable text\n+      and I search for a\n+      and Sleep  0.2\n+     Then we expect 2 hits\n+\n+     When I open the criteria Searchable text\n+      and I search for d\n+     Then we expect 1 hits\n \n Scenario: Tag query one\n+\n+    ${base_option_selector}=    Set Variable    select2-results-dept-0 select2-result select2-result-selectable select2-option\n+    ${base_option_selector_o}=    Set Variable    ${base_option_selector}-o\n+    ${base_option_selector_n}=    Set Variable    ${base_option_selector}-n\n+    ${base_option_selector_p}=    Set Variable    ${base_option_selector}-p\n+    ${base_option_selector_e}=    Set Variable    ${base_option_selector}-e\n     # tests the "Matches any of" option\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I activate the default operator in the criteria Tag\n-    and I open the Selection Widget\n-    ${base_option_selector}  Set Variable  li.select2-results-dept-0.select2-result.select2-result-selectable.select2-option\n-    and Wait For Then Click Element  css=${base_option_selector}-o\n-    Then we expect 4 hits\n-    When I open the Selection Widget\n-    and Wait For Then Click Element  css=${base_option_selector}-n\n-    Then we expect 4 hits\n-    When I delete my selection\n-    and I open the Selection Widget\n-    and Wait For Then Click Element  css=${base_option_selector}-p\n-    Then we expect 1 hits\n-    When I open the Selection Widget\n-    and Wait For Then Click Element  css=${base_option_selector}-e\n-    Then we expect 2 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I activate the default operator in the criteria Tag\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"${base_option_selector_o}")]\n+     Then we expect 4 hits\n+\n+     When I open the Selection Widget\n+      and Click    //li[contains(@class,"${base_option_selector_n}")]\n+     Then we expect 4 hits\n+\n+     When I delete my selection\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"${base_option_selector_p}")]\n+     Then we expect 1 hits\n+\n+     When I open the Selection Widget\n+      and Click    //li[contains(@class,"${base_option_selector_e}")]\n+     Then we expect 2 hits\n \n Scenario Tag query two\n+    ${base_option_selector}=    Set Variable    select2-results-dept-0 select2-result select2-result-selectable select2-option\n+    ${base_option_selector_o}=    Set Variable    ${base_option_selector}-o\n+    ${base_option_selector_n}=    Set Variable    ${base_option_selector}-n\n+    ${base_option_selector_p}=    Set Variable    ${base_option_selector}-p\n+    ${base_option_selector_e}=    Set Variable    ${base_option_selector}-e\n     # tests the "Matches all of" option\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I expect an empty result after open the operator Matches all of in the criteria Tag\n-    and I open the Selection Widget\n-    ${base_option_selector}  Set Variable  li.select2-results-dept-0.select2-result.select2-result-selectable.select2-option\n-    and Wait For Then Click Element  css=${base_option_selector}-o\n-    Then we expect 4 hits\n-    When and I open the Selection Widget\n-    and Wait For Then Click Element  css=${base_option_selector}-n\n-    Then we expect 3 hits\n-    When I delete my selection\n-    and and I open the Selection Widget\n-    and Wait For Then Click Element  css=${base_option_selector}-p\n-    Then we expect 1 hits\n-    When and I open the Selection Widget\n-    and Wait For Then Click Element  css=${base_option_selector}-e\n-    Then we expect 1 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I expect an empty result after open the operator Matches all of in the criteria Tag\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"${base_option_selector_o}")]\n+     Then we expect 4 hits\n+\n+     When I open the Selection Widget\n+      and Click    //li[contains(@class,"${base_option_selector_n}")]\n+     Then we expect 3 hits\n+\n+     When I delete my selection\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"${base_option_selector_p}")]\n+     Then we expect 1 hits\n+\n+     When I open the Selection Widget\n+      and Click    //li[contains(@class,"${base_option_selector_e}")]\n+     Then we expect 1 hits\n \n \n Scenario Event end date query\n     Given a logged-in manager\n-    and a bunch of events\n-    and the querystring pattern\n+      and a bunch of events\n+      and the querystring pattern\n     # Before date\n-    When I activate the default operator in the criteria Event end date\n-    and Execute Javascript  $(\'.querystring-criteria-value input[type="date"]\').val(\'2018-07-01\')\n-    Then we do not expect any hits\n+     When I activate the default operator in the criteria Event end date\n+      and Evaluate Javascript    //div[contains(@class,"querystring-criteria-value")]//input[@type="date"]\n+ ...    (element) => {\n+ ...        # fire the event for the browser build-in date input field\n+ ...        element.value="2018-07-01";\n+ ...        element.dispatchEvent(new Event("change", { bubbles: true }));\n+ ...    }\n+ ...    all_elements=False\n+\n+     Then we do not expect any hits\n \n     # When Execute Javascript  $(\'.querystring-criteria-value input[type="date"]\').val(\'2018-07-06\')\n \n-    # !!! BUG in plone.app.robotframework?\n+    # !!! BUG in plone.app.robotframework ?\n     # File "~/.buildout/shared-eggs/plone.app.event-3.2.1-py3.6.egg/plone/app/event/recurrence.py", line 77, in occurrences\n     #     duration = event_end - event_start\n     # TypeError: can\'t subtract offset-naive and offset-aware datetimes\n \n-    # for some reason the timezone is not applied correctly here. this is\n-    # probably a problem with plone.app.robotframework.content creation mechanism.\n-    # actually we got 3 hits, but right would be:\n-    # Then we expect 2 hits\n-    # Between dates\n-    # When I activate the operator Between dates in the criteria Event end date\n-    # and Execute Javascript  $($(\'.querystring-criteria-value .pattern-pickadate-date-wrapper > input[type="text"]\')[0]).pickadate(\'picker\').set(\'select\', new Date(2018, 7, 1))\n-    # and Execute Javascript  $($(\'.querystring-criteria-value .pattern-pickadate-date-wrapper > input[type="text"]\')[1]).pickadate(\'picker\').set(\'select\', new Date(2018, 7, 7))\n-    # Then we expect 3 hits\n-    # When Execute Javascript  $($(\'.querystring-criteria-value .pattern-pickadate-date-wrapper > input[type="text"]\')[0]).pickadate(\'picker\').set(\'select\', new Date(2018, 7, 6))\n-    # and Execute Javascript  $($(\'.querystring-criteria-value .pattern-pickadate-date-wrapper > input[type="text"]\')[1]).pickadate(\'picker\').set(\'select\', new Date(2018, 7, 8))\n-    # Then we expect 2 hits\n+    #      When Evaluate Javascript    //div[contains(@class,"querystring-criteria-value")]//input[@type="date"]\n+    #  ...    (element) => {\n+    #  ...        # fire the event for the browser build-in date input field\n+    #  ...        element.value="2018-08-06";\n+    #  ...        element.dispatchEvent(new Event("change", { bubbles: true }));\n+    #  ...    }\n+    #  ...    all_elements=False\n+    #      Then we expect 2 hits\n+\n+    #     # Between dates\n+    #      When I activate the operator Between dates in the criteria Event end date\n+    #       and Evaluate Javascript    //div[contains(@class,"querystring-criteria-value")]//input[@type="date" and contains(@class,"querystring-criteria-value-DateRangeWidget-start")]\n+    #  ...    (element) => {\n+    #  ...        # fire the event for the browser build-in date input field\n+    #  ...        element.value="2018-08-01";\n+    #  ...        element.dispatchEvent(new Event("change", { bubbles: true }));\n+    #  ...    }\n+    #  ...    all_elements=False\n+    #       and Evaluate Javascript    //div[contains(@class,"querystring-criteria-value")]//input[@type="date" and contains(@class,"querystring-criteria-value-DateRangeWidget-end")]\n+    #  ...    (element) => {\n+    #  ...        # fire the event for the browser build-in date input field\n+    #  ...        element.value="2018-08-07";\n+    #  ...        element.dispatchEvent(new Event("change", { bubbles: true }));\n+    #  ...    }\n+    #  ...    all_elements=False\n+    #      Then we expect 3 hits\n+\n+    #     # Between dates\n+    #      When I activate the operator Between dates in the criteria Event end date\n+    #       and Evaluate Javascript    //div[contains(@class,"querystring-criteria-value")]//input[@type="date" and contains(@class,"querystring-criteria-value-DateRangeWidget-start")]\n+    #  ...    (element) => {\n+    #  ...        # fire the event for the browser build-in date input field\n+    #  ...        element.value="2018-08-06";\n+    #  ...        element.dispatchEvent(new Event("change", { bubbles: true }));\n+    #  ...    }\n+    #  ...    all_elements=False\n+    #       and Evaluate Javascript    //div[contains(@class,"querystring-criteria-value")]//input[@type="date" and contains(@class,"querystring-criteria-value-DateRangeWidget-end")]\n+    #  ...    (element) => {\n+    #  ...        # fire the event for the browser build-in date input field\n+    #  ...        element.value="2018-08-06";\n+    #  ...        element.dispatchEvent(new Event("change", { bubbles: true }));\n+    #  ...    }\n+    #  ...    all_elements=False\n+    #      Then we expect 2 hits\n+\n+\n \n Scenario Short name (id) query\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I open the criteria Short name (id)\n-    And I search for a\n-    Then Page Should Contain  A\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I open the criteria Short name (id)\n+      and I search for a\n+     Then I see A in Preview\n \n Scenario Review state query\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I open the criteria Review State\n-    and I open the Selection Widget\n-    and Wait For Then Click Element  css=li.select2-option-private\n-    Then we expect 7 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I open the criteria Review State\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"select2-option-private")]\n+     Then we expect 7 hits\n \n Scenario Type query\n     Given a logged-in site administrator\n-    and a bunch of events\n-    and the querystring pattern\n-    When I open the criteria Type\n-    and I open the Selection Widget\n-    and Wait For Then Click Element  css=li.select2-option-event\n-    Then we expect 4 hits\n-    When I delete one selection\n-    and I open the Selection Widget\n-    and Wait For Then Click Element  css=li.select2-option-file\n-    Then we do not expect any hits\n-    When I delete one selection\n-    and I open the Selection Widget\n-    and Wait For Then Click Element  css=li.select2-option-folder\n-    Then we expect 5 hits\n-    When I delete one selection\n-    and I open the Selection Widget\n-    and Wait For Then Click Element  css=li.select2-option-link\n-    Then we expect 1 hits\n-    When I delete one selection\n-    and I open the Selection Widget\n-    and Wait For Then Click Element  css=li.select2-option-document\n-    Then we expect 2 hits\n-    When I open the Selection Widget\n-    and Wait For Then Click Element  css=li.select2-option-link\n-    Then we expect 3 hits\n+      and a bunch of events\n+      and the querystring pattern\n+     When I open the criteria Type\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"select2-option-event")]\n+     Then we expect 4 hits\n+\n+     When I delete one selection\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"select2-option-file")]\n+     Then we do not expect any hits\n+\n+     When I delete one selection\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"select2-option-folder")]\n+     Then we expect 5 hits\n+\n+     When I delete one selection\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"select2-option-link")]\n+     Then we expect 1 hits\n+\n+     When I delete one selection\n+      and I open the Selection Widget\n+      and Click    //li[contains(@class,"select2-option-document")]\n+     Then we expect 2 hits\n+\n+     When I open the Selection Widget\n+      and Click    //li[contains(@class,"select2-option-link")]\n+     Then we expect 3 hits\n \n Scenario Creator query\n     Given a logged-in site administrator\n-    and a bunch of folders\n-    and the querystring pattern\n-    When I activate the default operator in the criteria Creator\n-    Then we expect 6 hits\n+      and a bunch of folders\n+      and the querystring pattern\n+     When I activate the default operator in the criteria Creator\n+     Then we expect 6 hits\n \n \n-*** Keywords ****************************************************************\n+*** Keywords ***\n \n-save\n-    Click Link  css=input#form-buttons-save\n-\n-the querystring pattern\n-    #We go the /a to give more useful query results\n-    Go to  ${PLONE_URL}/a/++add++Collection\n-    Wait until page contains element  css=.pat-querystring\n-    Given querystring pattern loaded\n-    # Set a title, otherwise you see \'Please fill out this field\'\n-    Execute Javascript  $(\'#form-widgets-IDublinCore-title\').val(\'A Collection\'); return 0;\n-    # for some unknown reason unload protection pops up, but only in robot tests\n-    Execute Javascript  $(window).unbind(\'beforeunload\')\n-\n-querystring pattern loaded\n-    Wait For Condition  return !!document.querySelector(\'.querystring-criteria-remove\')\n+# GIVEN\n \n a bunch of folders\n     #We create enough items to give meaningful test results\n-    ${F1}=  Create content  type=Folder  title=A  description=a  subject=onep\n-    ${F2}=  Create content  type=Folder  title=B  description=b  subject=one  container=${F1}\n-    ${F3}=  Create content  type=Folder  title=C  description=and  subject=on  container=${F2}\n-    Create content  type=Document  title=D  subject=o  container=${F3}\n-    Create content  type=Document  title=E  container=${F3}\n-    Create content  type=Link  title=Link  remoteUrl=/front-page  container=${F3}\n+    ${F1}=    Create content\n+    ...    type=Folder\n+    ...    title=A\n+    ...    description=a\n+    ...    subject=onep\n+    ${F2}=    Create content\n+    ...    type=Folder\n+    ...    title=B\n+    ...    description=b\n+    ...    subject=one\n+    ...    container=${F1}\n+    ${F3}=    Create content\n+    ...    type=Folder\n+    ...    title=C\n+    ...    description=and\n+    ...    subject=on\n+    ...    container=${F2}\n+    Create content\n+    ...    type=Document\n+    ...    title=D\n+    ...    subject=o\n+    ...    container=${F3}\n+    Create content\n+    ...    type=Document\n+    ...    title=E\n+    ...    container=${F3}\n+    Create content\n+    ...    type=Link\n+    ...    title=Link\n+    ...    remoteUrl=/front-page\n+    ...    container=${F3}\n     [Return]  ${F1}\n \n+\n a bunch of events\n     ${F1}=  a bunch of folders\n-    Create content  type=Event  title=Event1  start=2018-08-01T15:00  end=2018-08-01T17:00  container=${F1}\n-    Create content  type=Event  title=Event2  start=2018-08-05T16:00  end=2018-08-07T11:00  container=${F1}\n-    Create content  type=Event  title=Event3  start=2018-08-05T16:30  open_end-empty-marker=1  container=${F1}\n-    Create content  type=Event  title=Event4  start=2018-08-06  end=2018-08-06  whole_day-empty-marker=1  container=${F1}\n+    Create content\n+    ...    type=Event\n+    ...    title=Event1\n+    ...    start=2018-08-01T15:00\n+    ...    end=2018-08-01T17:00\n+    ...    container=${F1}\n+    Create content\n+    ...    type=Event\n+    ...    title=Event2\n+    ...    start=2018-08-05T16:00\n+    ...    end=2018-08-07T11:00\n+    ...    container=${F1}\n+    Create content\n+    ...    type=Event\n+    ...    title=Event3\n+    ...    start=2018-08-05T16:30\n+    ...    open_end-empty-marker=1\n+    ...    container=${F1}\n+    Create content\n+    ...    type=Event\n+    ...    title=Event4\n+    ...    start=2018-08-06\n+    ...    end=2018-08-06\n+    ...    whole_day-empty-marker=1\n+    ...    container=${F1}\n \n-I activate the default operator in the criteria ${CRITERIA}\n-    open the select box titled index\n-    select index type ${CRITERIA}\n+the querystring pattern\n+    #We go the /a to give more useful query results\n+    Go to    ${PLONE_URL}/a/++add++Collection\n+    Type Text    //input[@id="form-widgets-IDublinCore-title"]    A Collection\n+\n+# WHEN\n \n I activate the operator ${OPERATOR} in the criteria ${CRITERIA}\n     open the select box titled index\n@@ -249,98 +349,129 @@ I activate the operator ${OPERATOR} in the criteria ${CRITERIA}\n     open the select box titled operator\n     select index type ${OPERATOR}\n \n-I expect an empty result after open the operator ${OPERATOR} in the criteria ${CRITERIA}\n-    open the select box titled index\n-    select index type ${CRITERIA}\n-    Wait for condition  return $("dl.searchResults").length == 0\n+\n+I search in ${NAME} subfolder in the related items widget\n+    mark results\n+    Click    //div[@class="pat-relateditems-container"]//ul[@class="select2-choices"]\n+    # I have seen this fail sometimes, where the screen shot showed the NAME just fine.\n+    Sleep    0.1\n+    Click    //a[contains(concat(\' \', normalize-space(@class), \' \'), \' pat-relateditems-result-select \')]//span[contains(text(),\'${NAME}\')]\n+\n+\n+I open the select box titled operator\n     open the select box titled operator\n-    select index type ${OPERATOR}\n+\n+\n+I select index Simple\n+    select index type Simple\n+\n \n I open the criteria ${CRITERIA}\n     open the select box titled index\n     select index type ${CRITERIA}\n \n+\n I search for ${KEYWORD}\n-    ${keyword_selector}  Set Variable  input.querystring-criteria-value-StringWidget\n-    Wait For Then Click Element  css=${keyword_selector}\n-    Input Text  css=${keyword_selector}  ${KEYWORD}\n-    Click Element  css=div#content-core\n+    ${element}    Get Element    //input[contains(@class,"querystring-criteria-value-StringWidget")]\n+    Click    ${element}\n+    Type Text    ${element}    ${KEYWORD}\n+    Click    //div[@id="content-core"]\n+\n+\n+I activate the default operator in the criteria ${CRITERIA}\n+    open the select box titled index\n+    select index type ${CRITERIA}\n+\n \n I open the Selection Widget\n-    Wait For Then Click Element  css=div.select2-container-multi.querystring-criteria-value-MultipleSelectionWidget\n+    Click    //div[contains(@class,"select2-container-multi") and contains(@class,"querystring-criteria-value-MultipleSelectionWidget")]\n \n-I delete one selection\n-    #deletes one element\n-    Wait For Then Click Element  jquery=a.select2-search-choice-close:visible\n \n I delete my selection\n     #deletes two elements\n-    Wait For Then Click Element  jquery=a.select2-search-choice-close:visible:first\n+    Click    (//div[contains(@class,"querystring-criteria-value-MultipleSelectionWidget")]//a[contains(@class,"select2-search-choice-close")])[1]\n     Sleep  0.1\n-    Wait For Then Click Element  jquery=a.select2-search-choice-close:visible\n+    Click    //div[contains(@class,"querystring-criteria-value-MultipleSelectionWidget")]//a[contains(@class,"select2-search-choice-close")]\n \n-I search in ${NAME} subfolder in the related items widget\n-    mark results\n-    Wait For Then Click Element  jquery=.pat-relateditems-container ul.select2-choices:visible\n-    Wait Until Page Contains  ${NAME}\n-    # I have seen this fail sometimes, where the screen shot showed the NAME just fine.\n-    Sleep  0.1\n-    Click Element  //a[contains(concat(\' \', normalize-space(@class), \' \'), \' pat-relateditems-result-select \')]//span[contains(text(),\'${NAME}\')]\n \n-I expect to be in Advanced mode\n-    open the select box titled operator\n-    ${selector}  Set Variable  .select2-drop-active[style*="display: block;"]\n-    Element Should Contain  jquery=${selector}   Navigation Path\n-    Element Should Contain  jquery=${selector}   Absolute Path\n-    Element Should Contain  jquery=${selector}   Relative Path\n-    Element Should Contain  jquery=${selector}   Simple Mode\n-    ${selector}  Set Variable  div#select2-drop-mask\n-    Wait For Then Click Invisible Element  css=${selector}\n-    Wait Until Element Is Not Visible  css=${selector}\n+I delete one selection\n+    # :visible -  should this be checked?\n+    Click    //div[contains(@class,"querystring-criteria-value-MultipleSelectionWidget")]//a[contains(@class,"select2-search-choice-close")]\n \n-I expect to be in Simple mode\n+\n+I expect an empty result after open the operator ${OPERATOR} in the criteria ${CRITERIA}\n+    open the select box titled index\n+    select index type ${CRITERIA}\n+    Wait For Condition    Element Count    //dl[@class="searchResults"]    should be    0\n     open the select box titled operator\n-    ${selector}  Set Variable  .select2-drop-active[style*="display: block;"]\n-    Element Should Contain  jquery=${selector}   Custom\n-    Element Should Contain  jquery=${selector}   Parent (../)\n-    Element Should Contain  jquery=${selector}   Current (./)\n-    Element Should Contain  jquery=${selector}   Advanced Mode\n-    ${selector}  Set Variable  div#select2-drop-mask\n-    Wait For Then Click Invisible Element  css=${selector}\n-    Wait Until Element Is Not Visible  css=${selector}\n+    select index type ${OPERATOR}\n \n-open the select box titled ${NAME}\n-    Click Element  css=body\n-    Wait For Then Click Element  jquery=.querystring-criteria-${NAME} .select2-container:first\n \n-select index type ${INDEX}\n-    ${input_selector}  Set Variable  .select2-drop-active[style*="display: block;"] input\n-    Wait For Element  css=${input_selector}\n-    Input Text  css=${input_selector}   text=${INDEX}\n-    Press Keys  jquery=:focus  RETURN\n+# THEN\n \n we expect ${NUM} hits\n     #This assumes we have the 2 "Test document" and "Test folder" items from the\n     #robot setup, as well as the 4 additional items from the "a bunch of folders" macro\n     #works only for ${NUM} > 0\n-    Sleep  0.5s\n+    # we need as `Sleep`, the select2 js is very slow\n+    Sleep    0.5s\n     Wait until result is no longer marked\n-    ${hits}=  Execute Javascript  return $(\'.searchResults > dd\').length\n-    Should Be Equal As Integers  ${hits}  ${NUM}\n+    ${hits}=    Evaluate Javascript    //dl[@class="searchResults"]\n+ ...    (element) => {\n+ ...        return document.querySelectorAll(".searchResults > dd").length\n+ ...    }\n+ ...    all_elements=False\n+    Should Be Equal As Integers    ${hits}    ${NUM}\n     mark results\n \n we do not expect any hits\n     [Documentation]  The search results may be the previous results that are still visible for a short time, so sleep a bit.  Alternatively look at http://www.obeythetestinggoat.com/how-to-get-selenium-to-wait-for-page-load-after-a-click.html\n-    Sleep  0.2\n-    Wait Until Element Is Visible  css=div#search-results\n-    Wait Until Element Contains  css=div#search-results  No results were found.\n+    Sleep    0.2\n+    Get Text    //div[@id="search-results"]    contains    No results were found.\n+\n+I expect to be in Advanced mode\n+    open the select box titled operator\n+    ${element}=    Get Element    //div[contains(@class,"select2-drop-active") and contains(@style,"display: block;")]\n+    Get Text    ${element}    contains    Navigation Path\n+    Get Text    ${element}    contains    Absolute Path\n+    Get Text    ${element}    contains    Relative Path\n+    Get Text    ${element}    contains    Simple Mode\n+    Click    //div[@id="select2-drop-mask"]\n+    Get Element States    //div[@id="select2-drop-mask"]    contains    hidden\n+\n+I expect to be in Simple mode\n+    open the select box titled operator\n+    ${element}=    Get Element    //div[contains(@class,"select2-drop-active") and contains(@style,"display: block;")]\n+    Get Text    ${element}    contains    Custom\n+    Get Text    ${element}    contains    Parent (../)\n+    Get Text    ${element}    contains    Current (./)\n+    Get Text    ${element}    contains    Advanced Mode\n+    Click    //div[@id="select2-drop-mask"]\n+    Get Element States    //div[@id="select2-drop-mask"]    contains    hidden\n+\n+I see ${TEXT} in Preview\n+    Sleep    0.2\n+    Get Text    //div[@id="search-results"]    contains    ${TEXT}\n+# Helper\n+\n+open the select box titled ${NAME}\n+    Click    //body\n+    Click    (//div[@class="querystring-criteria-${NAME}"])[1]//div[contains(@class,"select2-container")]\n \n-a logged-in manager\n-    Enable autologin as  Manager  Site Administrator  Contributor  Reviewer\n+select index type ${INDEX}\n+    Type Text    //div[contains(@class,"select2-drop-active") and contains(@style, "display: block;")]//input    ${INDEX}\n+    Click    //*[contains(@class,"select2-match")]\n \n mark results\n-    Wait for condition  return $("dl.searchResults").length > 0\n-    Execute Javascript  $("dl.searchResults").attr("marker", "marked")\n+    Evaluate Javascript    //dl[@class="searchResults"]\n+ ...    (element) => {\n+ ...        element.setAttribute("marker", "marked")\n+ ...    }\n+ ...    all_elements=False\n \n wait until result is no longer marked\n-    Wait for condition  return $("dl.searchResults").length > 0 && $("dl.searchResults").attr("marker") != "marked"\n+    Evaluate Javascript    //dl[@class="searchResults"]\n+ ...    (element) => {\n+ ...        return element && element.getAttribute("marker") != "marked"\n+ ...    }\n+ ...    all_elements=False\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/robot/test_select_widget.robot b/Products/CMFPlone/tests/robot/test_select_widget.robot\nnew file mode 100644\nindex 0000000000..1b00374205\n--- /dev/null\n+++ b/Products/CMFPlone/tests/robot/test_select_widget.robot\n@@ -0,0 +1,120 @@\n+*** Settings ***\n+\n+Resource  plone/app/robotframework/browser.robot\n+\n+Library  Remote  ${PLONE_URL}/RobotRemote\n+\n+Resource  keywords.robot\n+\n+Test Setup  Run keywords  Plone Test Setup\n+Test Teardown  Run keywords  Plone Test Teardown\n+\n+\n+*** Variables ***\n+\n+${mockup_bootstrap_class}    pat-select2\n+\n+${select_field_name}    form.widgets.select_field\n+${list_field_name}    form.widgets.list_field\n+\n+${input_search}    //div[@id="select2-drop"]//div[contains(@class,"select2-search")]//input\n+${dropdown_multiple}    css=.select2-choices\n+${dropdown_select}    //a[@class="select2-choice"]\n+${results_label}    css=.select2-result-label\n+\n+\n+*** Test Cases ***\n+\n+Scenario: The Select Widget has the class that bootstraps mockup JS\n+    Given a form\n+     Then the input fields have the mockup class\n+\n+Scenario: The Select Widget allows to select a single value\n+    Given a logged-in member\n+      and a form\n+     When I select the option  3\n+     Then the widget shows the element  three\n+\n+Scenario: The Select Widget autocomplete function works\n+    Given a logged-in member\n+      and a form\n+     When I type on the autocomplete field  wo\n+     Then the widget shows the element  two\n+\n+The Select Multiple Widget allows to select multiple values\n+    Given a logged-in member\n+      and a form\n+     When I click on the element  2\n+      And I click on the element  1\n+     Then the widget shows two elements    five    four\n+\n+Scenario: The Select Multiple Widget autocomplete function works\n+    Given a logged-in member\n+      and a form\n+     When I type on the multiple autocomplete field    s\n+     Then the widget shows one element    six\n+\n+\n+*** Keywords ***\n+\n+# Given\n+\n+a form\n+  Go to    ${PLONE_URL}/@@select-widget-view\n+\n+# When\n+\n+\n+I select the option\n+    [Arguments]  ${index}\n+    Wait For Elements State    ${dropdown_select}    visible    timeout=2 s\n+    Open Dropdown    ${dropdown_select}    ${input_search}\n+    Click    css=li.select2-results-dept-0:nth-child(${index})\n+\n+I type on the autocomplete field\n+    [Arguments]    ${text}\n+    Wait For Elements State    ${dropdown_select}    visible    timeout=2 s\n+    Open Dropdown    ${dropdown_select}    ${input_search}\n+    Type Text    ${input_search}    ${text}\n+    Click    ${results_label}\n+\n+I click on the element\n+    [Arguments]  ${index}\n+    Wait For Elements State    ${dropdown_multiple}    visible    timeout=2 s\n+    Open Dropdown    ${dropdown_multiple}    ${dropdown_multiple}\n+    Focus    css=li.select2-results-dept-0:nth-child(${index})\n+    Click    css=li.select2-results-dept-0:nth-child(${index})\n+\n+I type on the multiple autocomplete field\n+    [Arguments]    ${text}\n+    Wait For Elements State    ${dropdown_multiple}    visible    timeout=2 s\n+    Click    //ul[@class="select2-choices"]\n+    Type Text  css=.select2-input.select2-focused  ${text}\n+    Keyboard Key    press    Enter\n+\n+# Then\n+\n+the input fields have the mockup class\n+    Get Classes    //select[@name="${select_field_name}"]    contains    ${mockup_bootstrap_class}\n+    Get Classes    //select[@name="${list_field_name}"]    contains    ${mockup_bootstrap_class}\n+\n+the widget shows the element\n+    [Arguments]    ${text}\n+    Get Text    css=.select2-chosen    should be    ${text}    messsage=${text} seems to not be selected\n+\n+\n+the widget shows two elements\n+    [Arguments]  ${first_string}  ${second_string}\n+    Get Text    li.select2-search-choice:nth-child(1) > div:nth-child(1)    contains    ${first_string}\n+    Get Text    li.select2-search-choice:nth-child(2) > div:nth-child(1)    contains    ${second_string}\n+\n+the widget shows one element\n+    [Arguments]    ${string}\n+    Get Text    li.select2-search-choice:nth-child(1) > div:nth-child(1)    contains    ${string}\n+\n+# dry\n+\n+Open Dropdown\n+    [Arguments]    ${locator}    ${validaton}\n+    Click    ${locator}\n+    Wait For Elements State    ${validaton}    visible    timeout=2 s    message=The dropdown did not show up at location ${validaton}\n\\ No newline at end of file\ndiff --git a/Products/CMFPlone/tests/robot/test_tinymce.robot b/Products/CMFPlone/tests/robot/test_tinymce.robot\nindex 69eb813598..5a126857d6 100644\n--- a/Products/CMFPlone/tests/robot/test_tinymce.robot\n+++ b/Products/CMFPlone/tests/robot/test_tinymce.robot\n@@ -1,8 +1,6 @@\n *** Settings *****************************************************************\n \n-Resource  plone/app/robotframework/keywords.robot\n-Resource  plone/app/robotframework/saucelabs.robot\n-Resource  plone/app/robotframework/selenium.robot\n+Resource  plone/app/robotframework/browser.robot\n \n Library  Remote  ${PLONE_URL}/RobotRemote\n \n@@ -28,8 +26,8 @@ Scenario: A page is opened to edit in TinyMCE\n       and insert link\n       and insert image\n \n-    Wait For Then Click Element  css=#form-buttons-save\n-    Wait until page contains  Changes saved\n+    Click    //*[@id="form-buttons-save"]\n+    Get Text    //body    contains    Changes saved\n \n \n *** Keywords *****************************************************************\n@@ -39,47 +37,38 @@ Scenario: A page is opened to edit in TinyMCE\n an edited page\n     Create content  type=Document  title=${TITLE}\n     Go to  ${PLONE_URL}/${PAGE_ID}/edit\n-    Wait until page contains  Edit Page\n+    Get Text    //body    contains    Edit Page\n \n an uploaded image\n     Create content  type=Image  title=an-image\n \n text inserted into wysiwyg\n-    Wait Until Element Is Visible  css=.tox-edit-area iframe\n-    Select Frame  css=.tox-edit-area iframe\n-    Press Keys    //body[@id="tinymce"]    Susi Sorglos and John Doe\n-    UnSelect Frame\n+    Fill text to tinymce editor    form.widgets.IRichTextBehavior.text    <p>Susi Sorglos and John Doe</p>\n \n insert link\n-    Execute Javascript    function selectText() {\n-    ...    var iframe_document = document.querySelector(".tox-edit-area iframe").contentDocument;\n-    ...    var body = iframe_document.body;\n-    ...    var p = body.firstChild;\n-    ...    var range = new Range();\n-    ...    range.setStart(p.firstChild, 5);\n-    ...    range.setEnd(p.firstChild, 12);\n-    ...    iframe_document.getSelection().removeAllRanges();\n-    ...    iframe_document.getSelection().addRange(range);\n-    ...    }; selectText();\n-    Click Button  css=button[aria-label="Insert/edit link"]\n-    Wait For Then Click Element  css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n-    Wait For Then Click Element  xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[3]\n-    Wait For Then Click Element  xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n-    Wait Until Element Is Not Visible    xpath=//div[contains(@class,"content-browser-position-wrapper")]\n-    Wait For Then Click Element  css=.modal-footer input[name="insert"]\n-    Select Frame  css=.tox-edit-area iframe\n-    Execute Javascript  window.getSelection().removeAllRanges()\n-    UnSelect Frame\n-    Wait Until Element Is Not Visible  css=.modal-footer input[name="insert"]\n+    Evaluate JavaScript   //div[contains(@class, \'tox-edit-area\')]//iframe\n+    ...    (elem, args) => {\n+    ...        const iframe_document = elem.contentDocument;\n+    ...        const body = iframe_document.body;\n+    ...        const p = body.firstChild;\n+    ...        const range = new Range();\n+    ...        range.setStart(p.firstChild, 5);\n+    ...        range.setEnd(p.firstChild, 12);\n+    ...        iframe_document.getSelection().removeAllRanges();\n+    ...        iframe_document.getSelection().addRange(range);\n+    ...    }\n+    ...    all_elements=False\n+    Click    //button[@aria-label=\'Insert/edit link\']\n+    Click    css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n+    Click    xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[3]\n+    Click    xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n+    Click    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\n \n insert image\n-    Click Button  css=button[aria-label="Insert/edit image"]\n-    Wait For Then Click Element  css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n-    Wait For Then Click Element  xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[3]\n-    Capture Page Screenshot\n-    Wait For Then Click Element  xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n-    Wait Until Element Is Not Visible    xpath=//div[contains(@class,"content-browser-position-wrapper")]\n-    Input Text  css=.modal-body [name="title"]  SomeTitle\n-    Input Text  css=.modal-body [name="alt"]  SomeAlt\n-    Click Button  css=.modal-footer input[name="insert"]\n-    Wait Until Element Is Not Visible  css=.modal-footer input[name="insert"]\n\\ No newline at end of file\n+    Click    //button[@aria-label="Insert/edit image"]\n+    Click    css=.linkModal .content-browser-selected-items-wrapper button.btn-primary\n+    Click    xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[1]/div[contains(@class, "levelItems")]/div[3]\n+    Click    xpath=//div[contains(@class, "content-browser-wrapper")]//div[contains(@class, "levelColumns")]/div[contains(@class, "preview")]/div[contains(@class, "levelToolbar")]/button\n+    Type Text    //div[contains(@class, \'modal-body\')]//input[@name="title"]    SomeTitle\n+    Type Text    //div[contains(@class, \'modal-body\')]//input[@name="alt"]    SomeAlt\n+    Click    //div[contains(@class, \'modal-footer\')]//input[contains(@name, \'insert\')]\ndiff --git a/news/3980.1.feature b/news/3980.1.feature\nnew file mode 100644\nindex 0000000000..5670be2202\n--- /dev/null\n+++ b/news/3980.1.feature\n@@ -0,0 +1,4 @@\n+Port robot tests to playwright based tests, use robotframework browser library\n+\n+Remove obsolete robodocs\n+[1letter, petschki]\n'

