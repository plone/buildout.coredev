Repository: plonetheme.barceloneta


Branch: refs/heads/2.x
Date: 2023-03-04T15:12:22+01:00
Author: SÃ©bastien Verbois (sverbois) <sebastien.verbois@gmail.com>
Commit: https://github.com/plone/plonetheme.barceloneta/commit/d7ad565dee528e8707ab18b92b9f105a42dfb0d6

Fix Diazo rule problem with undefined footer_portlets and footer_portlets_count variables.

See: https://community.plone.org/t/error-theme-inherited-from-barceloneta-footer-portlets-count/8455

Files changed:
M plonetheme/barceloneta/theme/rules.xml

b'diff --git a/plonetheme/barceloneta/theme/rules.xml b/plonetheme/barceloneta/theme/rules.xml\nindex df9f8381..28dd1533 100644\n--- a/plonetheme/barceloneta/theme/rules.xml\n+++ b/plonetheme/barceloneta/theme/rules.xml\n@@ -101,11 +101,6 @@\n   <!-- Content header -->\n   <replace css:theme="#portal-top" css:content-children="#portal-top" />\n \n-  <!-- Footer -->\n-  <xsl:variable name="footer_portlets" select="//footer[@id=\'portal-footer-wrapper\']//div[@class=\'portletWrapper\']/*[not(contains(@id,\'portal-colophon\')) and not(contains(@id,\'portal-footer-signature\')) and not(contains(@class,\'portletActions\'))]"></xsl:variable>\n-  <xsl:variable name="footer_portlets_count" select="count($footer_portlets)"></xsl:variable>\n-\n-\n   <!-- Replace footer information with Plone version. -->\n   <replace\n       css:theme-children="#portal-footer .copyright > div"\n@@ -129,6 +124,8 @@\n \n   <!-- Move all other footer portlets into doormat area. -->\n   <replace css:theme-children="#portal-footer .doormat">\n+    <xsl:variable name="footer_portlets" select="//footer[@id=\'portal-footer-wrapper\']//div[@class=\'portletWrapper\']/*[not(contains(@id,\'portal-colophon\')) and not(contains(@id,\'portal-footer-signature\')) and not(contains(@class,\'portletActions\'))]"></xsl:variable>\n+    <xsl:variable name="footer_portlets_count" select="count($footer_portlets)"></xsl:variable>\n     <xsl:variable name="columns">\n       <xsl:if test="$footer_portlets_count=1">col-md-12</xsl:if>\n       <xsl:if test="$footer_portlets_count=2">col-md-6</xsl:if>\n'

Repository: plonetheme.barceloneta


Branch: refs/heads/2.x
Date: 2023-03-04T15:12:58+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plonetheme.barceloneta/commit/d82db1fddbb952780375dbb6d32545a8939dd596

Merge pull request #239 from plone/sverbois-patch-1

Move 'footer_portlets' and 'footer_portlets_count' variables

Files changed:
M plonetheme/barceloneta/theme/rules.xml

b'diff --git a/plonetheme/barceloneta/theme/rules.xml b/plonetheme/barceloneta/theme/rules.xml\nindex df9f8381..28dd1533 100644\n--- a/plonetheme/barceloneta/theme/rules.xml\n+++ b/plonetheme/barceloneta/theme/rules.xml\n@@ -101,11 +101,6 @@\n   <!-- Content header -->\n   <replace css:theme="#portal-top" css:content-children="#portal-top" />\n \n-  <!-- Footer -->\n-  <xsl:variable name="footer_portlets" select="//footer[@id=\'portal-footer-wrapper\']//div[@class=\'portletWrapper\']/*[not(contains(@id,\'portal-colophon\')) and not(contains(@id,\'portal-footer-signature\')) and not(contains(@class,\'portletActions\'))]"></xsl:variable>\n-  <xsl:variable name="footer_portlets_count" select="count($footer_portlets)"></xsl:variable>\n-\n-\n   <!-- Replace footer information with Plone version. -->\n   <replace\n       css:theme-children="#portal-footer .copyright > div"\n@@ -129,6 +124,8 @@\n \n   <!-- Move all other footer portlets into doormat area. -->\n   <replace css:theme-children="#portal-footer .doormat">\n+    <xsl:variable name="footer_portlets" select="//footer[@id=\'portal-footer-wrapper\']//div[@class=\'portletWrapper\']/*[not(contains(@id,\'portal-colophon\')) and not(contains(@id,\'portal-footer-signature\')) and not(contains(@class,\'portletActions\'))]"></xsl:variable>\n+    <xsl:variable name="footer_portlets_count" select="count($footer_portlets)"></xsl:variable>\n     <xsl:variable name="columns">\n       <xsl:if test="$footer_portlets_count=1">col-md-12</xsl:if>\n       <xsl:if test="$footer_portlets_count=2">col-md-6</xsl:if>\n'

