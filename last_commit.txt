Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2020-06-05T16:23:09+02:00
Author: ale-rt (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.app.contenttypes/commit/a325fe670d13baba490ded960eb34bcc680712de

Display the image size rounded with 1 decimal digit

Fixes #554

Files changed:
A news/554.bugfix
M plone/app/contenttypes/browser/templates/image.pt

b'diff --git a/news/554.bugfix b/news/554.bugfix\nnew file mode 100644\nindex 00000000..d1e26445\n--- /dev/null\n+++ b/news/554.bugfix\n@@ -0,0 +1 @@\n+Display the image size rounded with 1 decimal digit [ale-rt]\ndiff --git a/plone/app/contenttypes/browser/templates/image.pt b/plone/app/contenttypes/browser/templates/image.pt\nindex dcebeb9f..2a1d0779 100644\n--- a/plone/app/contenttypes/browser/templates/image.pt\n+++ b/plone/app/contenttypes/browser/templates/image.pt\n@@ -8,7 +8,9 @@\n <body>\n \n <metal:content-core fill-slot="content-core">\n-<metal:block define-macro="content-core" tal:define="size context/image/getSize">\n+<metal:block define-macro="content-core" tal:define="size context/image/getSize;\n+                                                     use_MB python: size > 1024*1024;\n+                                                     ">\n   <figure class="image-product">\n     <a class="discreet"\n         tal:attributes="href string:${context/@@plone_context_state/object_url}/image_view_fullscreen"\n@@ -18,7 +20,11 @@\n     <img tal:replace="structure img_tag" />\n     <figcaption class="discreet">\n       <strong class="sr-only" i18n:translate="label_click_to_view_full_image">Click to view full-size image&hellip;</strong>\n-      <span><tal:span i18n:translate="label_size">Size</tal:span>: <tal:span tal:replace="python:size/1024"> File size </tal:span>KB</span>\n+      <span>\n+        <tal:span i18n:translate="label_size">Size</tal:span>:\n+        <tal:MB condition="use_MB">${python:round(size/1024/1024, 1)} MB</tal:MB>\n+        <tal:KB condition="not: use_MB">${python:round(size/1024, 1)} KB</tal:KB>\n+      </span>\n     </figcaption>\n     </a>\n   </figure>\n'

Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2020-07-07T19:14:28+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.contenttypes/commit/afd2d69e607256da23994e873f4890c213308954

Merge pull request #555 from plone/554-fix-image-template-displayed-size

Display the image size rounded with 1 decimal digit

Files changed:
A news/554.bugfix
M plone/app/contenttypes/browser/templates/image.pt

b'diff --git a/news/554.bugfix b/news/554.bugfix\nnew file mode 100644\nindex 00000000..d1e26445\n--- /dev/null\n+++ b/news/554.bugfix\n@@ -0,0 +1 @@\n+Display the image size rounded with 1 decimal digit [ale-rt]\ndiff --git a/plone/app/contenttypes/browser/templates/image.pt b/plone/app/contenttypes/browser/templates/image.pt\nindex dcebeb9f..2a1d0779 100644\n--- a/plone/app/contenttypes/browser/templates/image.pt\n+++ b/plone/app/contenttypes/browser/templates/image.pt\n@@ -8,7 +8,9 @@\n <body>\n \n <metal:content-core fill-slot="content-core">\n-<metal:block define-macro="content-core" tal:define="size context/image/getSize">\n+<metal:block define-macro="content-core" tal:define="size context/image/getSize;\n+                                                     use_MB python: size > 1024*1024;\n+                                                     ">\n   <figure class="image-product">\n     <a class="discreet"\n         tal:attributes="href string:${context/@@plone_context_state/object_url}/image_view_fullscreen"\n@@ -18,7 +20,11 @@\n     <img tal:replace="structure img_tag" />\n     <figcaption class="discreet">\n       <strong class="sr-only" i18n:translate="label_click_to_view_full_image">Click to view full-size image&hellip;</strong>\n-      <span><tal:span i18n:translate="label_size">Size</tal:span>: <tal:span tal:replace="python:size/1024"> File size </tal:span>KB</span>\n+      <span>\n+        <tal:span i18n:translate="label_size">Size</tal:span>:\n+        <tal:MB condition="use_MB">${python:round(size/1024/1024, 1)} MB</tal:MB>\n+        <tal:KB condition="not: use_MB">${python:round(size/1024, 1)} KB</tal:KB>\n+      </span>\n     </figcaption>\n     </a>\n   </figure>\n'

