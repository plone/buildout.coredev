Repository: plone.recipe.zope2instance


Branch: refs/heads/master
Date: 2020-09-29T16:37:48+02:00
Author: Thomas Schorr (tschorr) <t_schorr@gmx.de>
Commit: https://github.com/plone/plone.recipe.zope2instance/commit/f5fe059c67b88bc86e65afe9bf22526f04058458

use NullHandler when access-log = 'disable'

Files changed:
M src/plone/recipe/zope2instance/recipe.py

b'diff --git a/src/plone/recipe/zope2instance/recipe.py b/src/plone/recipe/zope2instance/recipe.py\nindex 2eb83ac..035318f 100644\n--- a/src/plone/recipe/zope2instance/recipe.py\n+++ b/src/plone/recipe/zope2instance/recipe.py\n@@ -778,6 +778,8 @@ def build_wsgi_ini(self):\n         if accesslog_name.lower() == \'disable\':\n             pipeline = [\'egg:Zope#httpexceptions\']\n             event_handlers = \'\'\n+            accesslog_handler = \'NullHandler\'\n+            accesslog_args = "()"\n         else:\n             pipeline = [\n                 \'translogger\', \'egg:Zope#httpexceptions\']\n'

Repository: plone.recipe.zope2instance


Branch: refs/heads/master
Date: 2020-09-29T16:46:41+02:00
Author: Thomas Schorr (tschorr) <t_schorr@gmx.de>
Commit: https://github.com/plone/plone.recipe.zope2instance/commit/bd2c844f5459ff07db60e4120a77ded6f425c468

changelog entry

Files changed:
A news/159.bugfix

b'diff --git a/news/159.bugfix b/news/159.bugfix\nnew file mode 100644\nindex 0000000..0c42555\n--- /dev/null\n+++ b/news/159.bugfix\n@@ -0,0 +1,2 @@\n+Properly disable access-log for WSGI.\n+[tschorr]\n'

Repository: plone.recipe.zope2instance


Branch: refs/heads/master
Date: 2020-09-30T08:46:34+02:00
Author: Thomas Schorr (tschorr) <t_schorr@gmx.de>
Commit: https://github.com/plone/plone.recipe.zope2instance/commit/8df448da1604b31cd260259bbd08c407fb9cd9a9

update readme

Files changed:
M README.rst

b"diff --git a/README.rst b/README.rst\nindex dec801b..6597ce9 100644\n--- a/README.rst\n+++ b/README.rst\n@@ -304,8 +304,9 @@ mailinglogger\n access-log, z2-log\n   The filename for the Z2 access log. Defaults to var/log/${partname}-Z2.log\n   (var/log/${partname}-access.log) for WSGI).\n-  Setting this value to 'disable' will make the <logger access> section to be omitted,\n-  disabling logging access events to a .log file.\n+  You can disable access logging by setting this value to 'disable'.\n+  For ZServer this will omit the `<logger access>` section in `zope.conf`.\n+  For WSGI, the logging handler will be a `NullHandler <https://docs.python.org/3/library/logging.handlers.html#nullhandler>`_.\n \n access-log-level, z2-log-level\n   Set the log level for the access log. Level may be any of CRITICAL, ERROR,\n"

Repository: plone.recipe.zope2instance


Branch: refs/heads/master
Date: 2020-10-29T16:31:00+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.recipe.zope2instance/commit/a87f42d41c716eef96496ec8ca4e06ff21072529

Merge pull request #159 from plone/null_handler_disable_access_log_wsgi

WSGI: use NullHandler when access-log = 'disable'

Files changed:
A news/159.bugfix
M README.rst
M src/plone/recipe/zope2instance/recipe.py

b'diff --git a/README.rst b/README.rst\nindex dec801b..6597ce9 100644\n--- a/README.rst\n+++ b/README.rst\n@@ -304,8 +304,9 @@ mailinglogger\n access-log, z2-log\n   The filename for the Z2 access log. Defaults to var/log/${partname}-Z2.log\n   (var/log/${partname}-access.log) for WSGI).\n-  Setting this value to \'disable\' will make the <logger access> section to be omitted,\n-  disabling logging access events to a .log file.\n+  You can disable access logging by setting this value to \'disable\'.\n+  For ZServer this will omit the `<logger access>` section in `zope.conf`.\n+  For WSGI, the logging handler will be a `NullHandler <https://docs.python.org/3/library/logging.handlers.html#nullhandler>`_.\n \n access-log-level, z2-log-level\n   Set the log level for the access log. Level may be any of CRITICAL, ERROR,\ndiff --git a/news/159.bugfix b/news/159.bugfix\nnew file mode 100644\nindex 0000000..0c42555\n--- /dev/null\n+++ b/news/159.bugfix\n@@ -0,0 +1,2 @@\n+Properly disable access-log for WSGI.\n+[tschorr]\ndiff --git a/src/plone/recipe/zope2instance/recipe.py b/src/plone/recipe/zope2instance/recipe.py\nindex 2eb83ac..035318f 100644\n--- a/src/plone/recipe/zope2instance/recipe.py\n+++ b/src/plone/recipe/zope2instance/recipe.py\n@@ -778,6 +778,8 @@ def build_wsgi_ini(self):\n         if accesslog_name.lower() == \'disable\':\n             pipeline = [\'egg:Zope#httpexceptions\']\n             event_handlers = \'\'\n+            accesslog_handler = \'NullHandler\'\n+            accesslog_args = "()"\n         else:\n             pipeline = [\n                 \'translogger\', \'egg:Zope#httpexceptions\']\n'

