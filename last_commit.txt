Repository: plone.restapi


Branch: refs/heads/master
Date: 2020-06-15T10:46:42+02:00
Author: Gauthier Bastien (gbastien) <gauthier@imio.be>
Commit: https://github.com/plone/plone.restapi/commit/18cc9a9d3870c476fcafc57caee43ce5493673f3

Include plone.app.controlpanel permissions.zcml in database service to avoid ConfigurationExecutionError regarding 'plone.app.controlpanel.Overview' permission while starting Plone 4.3.x, see #956 (#960)

Files changed:
A news/956.bugfix
M src/plone/restapi/services/database/configure.zcml

b'diff --git a/news/956.bugfix b/news/956.bugfix\nnew file mode 100644\nindex 000000000..ca9ee7f98\n--- /dev/null\n+++ b/news/956.bugfix\n@@ -0,0 +1 @@\n+- Include plone.app.controlpanel permissions.zcml in database service to avoid ConfigurationExecutionError regarding \'plone.app.controlpanel.Overview\' permission while starting Plone 4.3.x [gbastien]\ndiff --git a/src/plone/restapi/services/database/configure.zcml b/src/plone/restapi/services/database/configure.zcml\nindex 972d22c55..26ecf5619 100644\n--- a/src/plone/restapi/services/database/configure.zcml\n+++ b/src/plone/restapi/services/database/configure.zcml\n@@ -1,6 +1,17 @@\n <configure\n     xmlns="http://namespaces.zope.org/zope"\n-    xmlns:plone="http://namespaces.plone.org/plone">\n+    xmlns:plone="http://namespaces.plone.org/plone"\n+    xmlns:zcml="http://namespaces.zope.org/zcml">\n+\n+  <include\n+    zcml:condition="not-installed plone.app.controlpanel"\n+    package="Products.CMFPlone.controlpanel"\n+    file="permissions.zcml" />\n+\n+  <include\n+    zcml:condition="installed plone.app.controlpanel"\n+    package="plone.app.controlpanel"\n+    file="permissions.zcml" />\n \n   <plone:service\n     method="GET"\n'

