Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2020-06-18T11:51:09+02:00
Author: Vincent Fretin (vincentfretin) <vincent.fretin@gmail.com>
Commit: https://github.com/plone/plone.app.discussion/commit/ab99c5d015b595eb928736d5bf4c70d3576f05e3

Reuse existing translation for the "Save" button in the Edit comment form.

Files changed:
A news/170.bugfix
M plone/app/discussion/browser/comment.py

b'diff --git a/news/170.bugfix b/news/170.bugfix\nnew file mode 100644\nindex 00000000..c3d9f14e\n--- /dev/null\n+++ b/news/170.bugfix\n@@ -0,0 +1,2 @@\n+Reuse existing translation for the "Save" button in the Edit comment form.\n+[vincentfretin]\ndiff --git a/plone/app/discussion/browser/comment.py b/plone/app/discussion/browser/comment.py\nindex ef750831..41beecc6 100644\n--- a/plone/app/discussion/browser/comment.py\n+++ b/plone/app/discussion/browser/comment.py\n@@ -75,7 +75,7 @@ def _redirect(self, target=\'\'):\n             target = portal_state.portal_url()\n         self.request.response.redirect(target)\n \n-    @button.buttonAndHandler(_(u\'edit_comment_form_button\',\n+    @button.buttonAndHandler(_(u\'label_save\',\n                                default=u\'Save\'), name=\'comment\')\n     def handleComment(self, action):\n \n'

Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2020-06-18T11:58:24+02:00
Author: Vincent Fretin (vincentfretin) <vincent.fretin@gmail.com>
Commit: https://github.com/plone/plone.app.discussion/commit/eb8b473610b19e9f052257aaf3169aecadcc4140

use PMF instead of _ so i18ndude doesn't extract comment_

Files changed:
M plone/app/discussion/browser/moderation.py

b'diff --git a/plone/app/discussion/browser/moderation.py b/plone/app/discussion/browser/moderation.py\nindex 05c0236c..03540b2d 100644\n--- a/plone/app/discussion/browser/moderation.py\n+++ b/plone/app/discussion/browser/moderation.py\n@@ -29,6 +29,7 @@\n _(\'Approve\')\n _(\'Reject\')\n _(\'Spam\')\n+PMF = _\n \n \n class TranslationHelper(BrowserView):\n@@ -37,7 +38,8 @@ def translate(self, text=""):\n         return _(text)\n \n     def translate_comment_review_state(self, rs):\n-        return _("comment_" + rs, default=rs)\n+        # use PMF instead of _ here so i18ndude doesn\'t extract "comment_"\n+        return PMF("comment_" + rs, default=rs)\n \n \n class View(BrowserView):\n'

Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2020-06-18T13:05:32+02:00
Author: Vincent Fretin (vincentfretin) <vincent.fretin@gmail.com>
Commit: https://github.com/plone/plone.app.discussion/commit/e1a433956ea0377af9535d14eae07f646528b982

Merge pull request #170 from plone/i18n-reuse-existing-translation

Reuse existing translation for the "Save" button in the Edit comment form.

Files changed:
A news/170.bugfix
M plone/app/discussion/browser/comment.py
M plone/app/discussion/browser/moderation.py

b'diff --git a/news/170.bugfix b/news/170.bugfix\nnew file mode 100644\nindex 00000000..c3d9f14e\n--- /dev/null\n+++ b/news/170.bugfix\n@@ -0,0 +1,2 @@\n+Reuse existing translation for the "Save" button in the Edit comment form.\n+[vincentfretin]\ndiff --git a/plone/app/discussion/browser/comment.py b/plone/app/discussion/browser/comment.py\nindex ef750831..41beecc6 100644\n--- a/plone/app/discussion/browser/comment.py\n+++ b/plone/app/discussion/browser/comment.py\n@@ -75,7 +75,7 @@ def _redirect(self, target=\'\'):\n             target = portal_state.portal_url()\n         self.request.response.redirect(target)\n \n-    @button.buttonAndHandler(_(u\'edit_comment_form_button\',\n+    @button.buttonAndHandler(_(u\'label_save\',\n                                default=u\'Save\'), name=\'comment\')\n     def handleComment(self, action):\n \ndiff --git a/plone/app/discussion/browser/moderation.py b/plone/app/discussion/browser/moderation.py\nindex 05c0236c..03540b2d 100644\n--- a/plone/app/discussion/browser/moderation.py\n+++ b/plone/app/discussion/browser/moderation.py\n@@ -29,6 +29,7 @@\n _(\'Approve\')\n _(\'Reject\')\n _(\'Spam\')\n+PMF = _\n \n \n class TranslationHelper(BrowserView):\n@@ -37,7 +38,8 @@ def translate(self, text=""):\n         return _(text)\n \n     def translate_comment_review_state(self, rs):\n-        return _("comment_" + rs, default=rs)\n+        # use PMF instead of _ here so i18ndude doesn\'t extract "comment_"\n+        return PMF("comment_" + rs, default=rs)\n \n \n class View(BrowserView):\n'

