Repository: mockup


Branch: refs/heads/master
Date: 2020-06-24T11:43:43+02:00
Author: Vincent Fretin (vincentfretin) <vincent.fretin@gmail.com>
Commit: https://github.com/plone/mockup/commit/420c8f7d0a19a75d61def784c608604405401c8c

Describe how to test changes in Plone and handle translations

Files changed:
M README.rst

b'diff --git a/README.rst b/README.rst\nindex a7d54f9ae..33bd65c77 100644\n--- a/README.rst\n+++ b/README.rst\n@@ -42,10 +42,47 @@ Run tests with Chrome::\n \n     $ make test-dev\n \n-Generate widgets pot file for plone translations::\n+Generate widgets.pot file in the working directory for Plone translations::\n \n     $ make i18n-dump\n \n+If you are currently in the buildout.coredev/src/mockup folder and want to update\n+the translations in plone.app.locales, first go back in the buildout.coredev\n+folder, copy widgets.pot in the plone.app.locales package and resync the po files like\n+this::\n+\n+    $ cd ../..\n+    $ cp src/mockup/widgets.pot src/plone.app.locales/plone/app/locales/locales/widgets.pot\n+    $ bin/buildout -c experimental/i18n.cfg  # to have the bin/i18n command\n+    $ bin/i18n widgets\n+\n+If you did some changes in the js files and want to test them live in Plone:\n+\n+- go to Site Setup -> Resource Registries\n+- click on the "Development Mode (only logged in users)" checkbox\n+- click on the "Develop Javascript" button for the plone-editor-tools bundle\n+  (for folder contents changes, may be another bundle for an other pattern)\n+- click the "Save" button\n+- refresh your page (folder contents for example)\n+\n+To have the js changes in the next Plone release, you need to build the\n+bundles, see `README of plone.staticresources <https://github.com/plone/plone.staticresources>`_\n+You may be interested reading `JavaScript For Plone Developers <https://training.plone.org/5/javascript/index.html>`_ and\n+`Resource Registry <https://docs.plone.org/adapt-and-extend/theming/resourceregistry.html>`_ documentation too.\n+\n+To test a translation, for example French:\n+\n+- edit the po file src/plone.app.locales/plone/app/locales/locales/fr/LC_MESSAGES/widgets.po\n+- restart your instance to rebuild the mo file from the po file\n+- purge your localStorage and refresh the page to trigger a new download of the translations\n+\n+The translations are handled by mockup/js/i18n.js that calls the plonejsi18n view defined\n+in plone.app.content to generate a json of the translations from the mo file.\n+The plonejsi18n view is called one time for a given domain and language and the result\n+is cached in localStorage for 24 hours.\n+The only way to test the new translations is to restart the instance to update the mo file\n+from the po file, and then to purge the localStorage to trigger a new download of the translations.\n+\n \n License\n =======\n'

Repository: mockup


Branch: refs/heads/master
Date: 2020-06-24T12:04:54+02:00
Author: Vincent Fretin (vincentfretin) <vincent.fretin@gmail.com>
Commit: https://github.com/plone/mockup/commit/09524732e07bdae6d8fbb96557ee25ea4afc439e

Merge pull request #985 from plone/doc-how-to-make-changes

Describe how to test changes in Plone and handle translations

Files changed:
M README.rst

b'diff --git a/README.rst b/README.rst\nindex a7d54f9ae..33bd65c77 100644\n--- a/README.rst\n+++ b/README.rst\n@@ -42,10 +42,47 @@ Run tests with Chrome::\n \n     $ make test-dev\n \n-Generate widgets pot file for plone translations::\n+Generate widgets.pot file in the working directory for Plone translations::\n \n     $ make i18n-dump\n \n+If you are currently in the buildout.coredev/src/mockup folder and want to update\n+the translations in plone.app.locales, first go back in the buildout.coredev\n+folder, copy widgets.pot in the plone.app.locales package and resync the po files like\n+this::\n+\n+    $ cd ../..\n+    $ cp src/mockup/widgets.pot src/plone.app.locales/plone/app/locales/locales/widgets.pot\n+    $ bin/buildout -c experimental/i18n.cfg  # to have the bin/i18n command\n+    $ bin/i18n widgets\n+\n+If you did some changes in the js files and want to test them live in Plone:\n+\n+- go to Site Setup -> Resource Registries\n+- click on the "Development Mode (only logged in users)" checkbox\n+- click on the "Develop Javascript" button for the plone-editor-tools bundle\n+  (for folder contents changes, may be another bundle for an other pattern)\n+- click the "Save" button\n+- refresh your page (folder contents for example)\n+\n+To have the js changes in the next Plone release, you need to build the\n+bundles, see `README of plone.staticresources <https://github.com/plone/plone.staticresources>`_\n+You may be interested reading `JavaScript For Plone Developers <https://training.plone.org/5/javascript/index.html>`_ and\n+`Resource Registry <https://docs.plone.org/adapt-and-extend/theming/resourceregistry.html>`_ documentation too.\n+\n+To test a translation, for example French:\n+\n+- edit the po file src/plone.app.locales/plone/app/locales/locales/fr/LC_MESSAGES/widgets.po\n+- restart your instance to rebuild the mo file from the po file\n+- purge your localStorage and refresh the page to trigger a new download of the translations\n+\n+The translations are handled by mockup/js/i18n.js that calls the plonejsi18n view defined\n+in plone.app.content to generate a json of the translations from the mo file.\n+The plonejsi18n view is called one time for a given domain and language and the result\n+is cached in localStorage for 24 hours.\n+The only way to test the new translations is to restart the instance to update the mo file\n+from the po file, and then to purge the localStorage to trigger a new download of the translations.\n+\n \n License\n =======\n'

