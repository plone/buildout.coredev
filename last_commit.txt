Repository: Products.CMFPlone


Branch: refs/heads/5.2.x
Date: 2023-10-19T16:04:55+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/c86a5f594fc75f4c91060d8894147e58c966637a

Fix problem when adding a Plone site with a custom INonInstallable utility without a getNonInstallableProfiles method.

Fixes: #3862.

Files changed:
A news/3862.bugfix
M Products/CMFPlone/browser/admin.py

b'diff --git a/Products/CMFPlone/browser/admin.py b/Products/CMFPlone/browser/admin.py\nindex 7b1c1b502c..b1034309b1 100644\n--- a/Products/CMFPlone/browser/admin.py\n+++ b/Products/CMFPlone/browser/admin.py\n@@ -150,7 +150,11 @@ def profiles(self):\n         ]\n         utils = getAllUtilitiesRegisteredFor(INonInstallable)\n         for util in utils:\n-            not_installable.extend(util.getNonInstallableProfiles())\n+            not_installable.extend(\n+                util.getNonInstallableProfiles()\n+                if hasattr(util, "getNonInstallableProfiles")\n+                else []\n+            )\n \n         for info in profile_registry.listProfileInfo():\n             if info.get(\'type\') == EXTENSION and \\\ndiff --git a/news/3862.bugfix b/news/3862.bugfix\nnew file mode 100644\nindex 0000000000..a9e0e6be6d\n--- /dev/null\n+++ b/news/3862.bugfix\n@@ -0,0 +1,3 @@\n+Fix problem when adding a Plone site with a custom INonInstallable utility without a getNonInstallableProfiles method.\n+\n+Fixes: #3862.\n'

Repository: Products.CMFPlone


Branch: refs/heads/5.2.x
Date: 2023-10-25T17:15:28+02:00
Author: Maurits van Rees (mauritsvanrees) <m.van.rees@zestsoftware.nl>
Commit: https://github.com/plone/Products.CMFPlone/commit/daa4f0215393cfc71fae28be50feb371cccab8f4

Merge pull request #3863 from plone/fix-addsite-no-getnoninstallableproducts

Fix problem when adding a Plone site with a custom INonInstallable utâ€¦

Files changed:
A news/3862.bugfix
M Products/CMFPlone/browser/admin.py

b'diff --git a/Products/CMFPlone/browser/admin.py b/Products/CMFPlone/browser/admin.py\nindex 7b1c1b502c..b1034309b1 100644\n--- a/Products/CMFPlone/browser/admin.py\n+++ b/Products/CMFPlone/browser/admin.py\n@@ -150,7 +150,11 @@ def profiles(self):\n         ]\n         utils = getAllUtilitiesRegisteredFor(INonInstallable)\n         for util in utils:\n-            not_installable.extend(util.getNonInstallableProfiles())\n+            not_installable.extend(\n+                util.getNonInstallableProfiles()\n+                if hasattr(util, "getNonInstallableProfiles")\n+                else []\n+            )\n \n         for info in profile_registry.listProfileInfo():\n             if info.get(\'type\') == EXTENSION and \\\ndiff --git a/news/3862.bugfix b/news/3862.bugfix\nnew file mode 100644\nindex 0000000000..a9e0e6be6d\n--- /dev/null\n+++ b/news/3862.bugfix\n@@ -0,0 +1,3 @@\n+Fix problem when adding a Plone site with a custom INonInstallable utility without a getNonInstallableProfiles method.\n+\n+Fixes: #3862.\n'

