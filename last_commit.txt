Repository: plone.app.portlets


Branch: refs/heads/4.4.x
Date: 2022-07-19T16:19:19+02:00
Author: Mikel Larreategi (erral) <mlarreategi@codesyntax.com>
Commit: https://github.com/plone/plone.app.portlets/commit/df8cfa004a6975b5b419096c52f958277c4a47c7

use the portal url to build the icon url

Files changed:
M plone/app/portlets/portlets/navigation.py

b"diff --git a/plone/app/portlets/portlets/navigation.py b/plone/app/portlets/portlets/navigation.py\nindex b1fe8b89..19ab124e 100644\n--- a/plone/app/portlets/portlets/navigation.py\n+++ b/plone/app/portlets/portlets/navigation.py\n@@ -352,7 +352,7 @@ def getMimeTypeIcon(self, node):\n             if not node['normalized_portal_type'] == 'file':\n                 return None\n             fileo = node['item'].getObject().file\n-            portal_url = getNavigationRoot(self.context)\n+            portal_url = self.urltool()\n             mtt = getToolByName(self.context, 'mimetypes_registry')\n             if fileo.contentType:\n                 ctype = mtt.lookup(fileo.contentType)\n"

Repository: plone.app.portlets


Branch: refs/heads/4.4.x
Date: 2022-07-19T16:19:39+02:00
Author: Mikel Larreategi (erral) <mlarreategi@codesyntax.com>
Commit: https://github.com/plone/plone.app.portlets/commit/652407e5ea90f93dcb037cf47d7fe603a70ef8de

changelog

Files changed:
A news/168.bugfix

b'diff --git a/news/168.bugfix b/news/168.bugfix\nnew file mode 100644\nindex 00000000..b9085096\n--- /dev/null\n+++ b/news/168.bugfix\n@@ -0,0 +1,2 @@\n+Use the portal url to build the mimetype icon url\n+[erral]\n'

Repository: plone.app.portlets


Branch: refs/heads/4.4.x
Date: 2022-08-07T11:39:27+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.portlets/commit/eefae10c69e0035220101f85bb5189913efc930c

Merge pull request #169 from plone/erral-issue-168

Use portal URL to build the mimetype icon url

Files changed:
A news/168.bugfix
M plone/app/portlets/portlets/navigation.py

b"diff --git a/news/168.bugfix b/news/168.bugfix\nnew file mode 100644\nindex 00000000..b9085096\n--- /dev/null\n+++ b/news/168.bugfix\n@@ -0,0 +1,2 @@\n+Use the portal url to build the mimetype icon url\n+[erral]\ndiff --git a/plone/app/portlets/portlets/navigation.py b/plone/app/portlets/portlets/navigation.py\nindex b1fe8b89..19ab124e 100644\n--- a/plone/app/portlets/portlets/navigation.py\n+++ b/plone/app/portlets/portlets/navigation.py\n@@ -352,7 +352,7 @@ def getMimeTypeIcon(self, node):\n             if not node['normalized_portal_type'] == 'file':\n                 return None\n             fileo = node['item'].getObject().file\n-            portal_url = getNavigationRoot(self.context)\n+            portal_url = self.urltool()\n             mtt = getToolByName(self.context, 'mimetypes_registry')\n             if fileo.contentType:\n                 ctype = mtt.lookup(fileo.contentType)\n"

