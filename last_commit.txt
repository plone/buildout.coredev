Repository: plone.stringinterp


Branch: refs/heads/master
Date: 2020-08-10T21:22:44+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.stringinterp/commit/c75a0cf98dbf4df8da642b00d181227e214f9d8b

Avoid a deprecation warning

To keep zope 4 and earlier compatibility, a try/except is used.

Files changed:
M plone/stringinterp/adapters.py

b'diff --git a/plone/stringinterp/adapters.py b/plone/stringinterp/adapters.py\nindex 6cb7018..db55e43 100644\n--- a/plone/stringinterp/adapters.py\n+++ b/plone/stringinterp/adapters.py\n@@ -10,7 +10,6 @@\n from zope.interface import implementer, Interface, alsoProvides\n from zope.component import adapter\n from zope.i18n import translate\n-from zope.site.hooks import getSite\n \n from AccessControl import Unauthorized\n from Acquisition import aq_inner, aq_parent, aq_get, Implicit\n@@ -31,6 +30,15 @@\n from plone.stringinterp.interfaces import IStringSubstitution\n from plone.stringinterp.interfaces import IContextWrapper\n \n+# BBB: on Zope 5 the fallback will not work anymore,\n+# as long as we want compatibility with Zope 4 and earlier\n+# we need to keep the fallback\n+try:\n+    from zope.component.hooks import getSite\n+except:\n+    from zope.site.hooks import getSite\n+\n+\n \n @implementer(IContextWrapper)\n class ContextWrapper(Implicit):\n'

Repository: plone.stringinterp


Branch: refs/heads/master
Date: 2020-09-02T18:20:24+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.stringinterp/commit/00ddce0c6a24bcc660772539f09e6d60aea7ff86

Create 14.misc

Files changed:
A news/14.misc

b'diff --git a/news/14.misc b/news/14.misc\nnew file mode 100644\nindex 0000000..9914dd3\n--- /dev/null\n+++ b/news/14.misc\n@@ -0,0 +1 @@\n+Resolve deprecation warning [gforcada]\n'

Repository: plone.stringinterp


Branch: refs/heads/master
Date: 2020-09-02T18:20:38+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.stringinterp/commit/2c710490985e1d0978809f5d52f26afd0314c3a7

Merge pull request #14 from plone/gforcada-patch-1

Avoid a deprecation warning

Files changed:
A news/14.misc
M plone/stringinterp/adapters.py

b'diff --git a/news/14.misc b/news/14.misc\nnew file mode 100644\nindex 0000000..9914dd3\n--- /dev/null\n+++ b/news/14.misc\n@@ -0,0 +1 @@\n+Resolve deprecation warning [gforcada]\ndiff --git a/plone/stringinterp/adapters.py b/plone/stringinterp/adapters.py\nindex 6cb7018..db55e43 100644\n--- a/plone/stringinterp/adapters.py\n+++ b/plone/stringinterp/adapters.py\n@@ -10,7 +10,6 @@\n from zope.interface import implementer, Interface, alsoProvides\n from zope.component import adapter\n from zope.i18n import translate\n-from zope.site.hooks import getSite\n \n from AccessControl import Unauthorized\n from Acquisition import aq_inner, aq_parent, aq_get, Implicit\n@@ -31,6 +30,15 @@\n from plone.stringinterp.interfaces import IStringSubstitution\n from plone.stringinterp.interfaces import IContextWrapper\n \n+# BBB: on Zope 5 the fallback will not work anymore,\n+# as long as we want compatibility with Zope 4 and earlier\n+# we need to keep the fallback\n+try:\n+    from zope.component.hooks import getSite\n+except:\n+    from zope.site.hooks import getSite\n+\n+\n \n @implementer(IContextWrapper)\n class ContextWrapper(Implicit):\n'

