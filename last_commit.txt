Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2021-07-01T15:20:55+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.Archetypes/commit/4b64d01792023ceb6ad094f440a3a96e3e137130

Fixed incompatibility with zope.component 5.

`zope.component.interfaces` has long been a backwards compatibility import for `zope.interface.interfaces`, but not anymore.
We need this change, to be able to use Zope 4.6.2 in Plone 5.2,
unless we decide to keep the old zope.component 4.
This change works in both cases.

Files changed:
A news/462.bugfix
M Products/Archetypes/event.py
M Products/Archetypes/interfaces/event.py
M Products/Archetypes/mimetype_utils.py
M Products/Archetypes/tests/events.txt

b'diff --git a/Products/Archetypes/event.py b/Products/Archetypes/event.py\nindex 1c051053..cec658e8 100644\n--- a/Products/Archetypes/event.py\n+++ b/Products/Archetypes/event.py\n@@ -3,7 +3,7 @@\n \n from zope.interface import implementer\n \n-from zope.component.interfaces import ObjectEvent\n+from zope.interface.interfaces import ObjectEvent\n from zope.lifecycleevent import ObjectModifiedEvent\n \n from Products.Archetypes.interfaces import IObjectInitializedEvent\ndiff --git a/Products/Archetypes/interfaces/event.py b/Products/Archetypes/interfaces/event.py\nindex d0b9e1bb..2efa5e90 100644\n--- a/Products/Archetypes/interfaces/event.py\n+++ b/Products/Archetypes/interfaces/event.py\n@@ -1,7 +1,7 @@\n """Event-related interfaces\n """\n \n-from zope.component.interfaces import IObjectEvent\n+from zope.interface.interfaces import IObjectEvent\n from zope.lifecycleevent.interfaces import IObjectModifiedEvent\n \n # Modification\ndiff --git a/Products/Archetypes/mimetype_utils.py b/Products/Archetypes/mimetype_utils.py\nindex 9d08d3f0..8566b8d1 100644\n--- a/Products/Archetypes/mimetype_utils.py\n+++ b/Products/Archetypes/mimetype_utils.py\n@@ -6,7 +6,7 @@\n     from Products.CMFPlone.interfaces import IMarkupSchema\n     from plone.registry.interfaces import IRegistry\n     from zope.component import getUtility\n-    from zope.component.interfaces import ComponentLookupError\n+    from zope.interface.interfaces import ComponentLookupError\n except ImportError:\n     IMarkupSchema = None\n \ndiff --git a/Products/Archetypes/tests/events.txt b/Products/Archetypes/tests/events.txt\nindex cea000c5..52031842 100644\n--- a/Products/Archetypes/tests/events.txt\n+++ b/Products/Archetypes/tests/events.txt\n@@ -9,7 +9,7 @@ that listens for object events for `IBaseObject`:\n   >>> from StringIO import StringIO\n   >>> from Products.Archetypes.tests.utils import makeContent, aputrequest\n   >>> from Products.Archetypes.interfaces import IBaseObject\n-  >>> from zope.component.interfaces import IObjectEvent\n+  >>> from zope.interface.interfaces import IObjectEvent\n \n   >>> class Handler:\n   ...     def __init__(self):\ndiff --git a/news/462.bugfix b/news/462.bugfix\nnew file mode 100644\nindex 00000000..5973a0fc\n--- /dev/null\n+++ b/news/462.bugfix\n@@ -0,0 +1,3 @@\n+Fixed incompatibility with ``zope.component`` 5.\n+``zope.component.interfaces`` has long been a backwards compatibility import for ``zope.interface.interfaces``, but not anymore.\n+[maurits]\n'

Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2021-07-02T08:56:25+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.Archetypes/commit/935e6c196082952014756acfe35b037d70b3c591

Merge pull request #137 from plone/maurits/zope-component-5

Fixed incompatibility with zope.component 5.

Files changed:
A news/462.bugfix
M Products/Archetypes/event.py
M Products/Archetypes/interfaces/event.py
M Products/Archetypes/mimetype_utils.py
M Products/Archetypes/tests/events.txt

b'diff --git a/Products/Archetypes/event.py b/Products/Archetypes/event.py\nindex 1c051053..cec658e8 100644\n--- a/Products/Archetypes/event.py\n+++ b/Products/Archetypes/event.py\n@@ -3,7 +3,7 @@\n \n from zope.interface import implementer\n \n-from zope.component.interfaces import ObjectEvent\n+from zope.interface.interfaces import ObjectEvent\n from zope.lifecycleevent import ObjectModifiedEvent\n \n from Products.Archetypes.interfaces import IObjectInitializedEvent\ndiff --git a/Products/Archetypes/interfaces/event.py b/Products/Archetypes/interfaces/event.py\nindex d0b9e1bb..2efa5e90 100644\n--- a/Products/Archetypes/interfaces/event.py\n+++ b/Products/Archetypes/interfaces/event.py\n@@ -1,7 +1,7 @@\n """Event-related interfaces\n """\n \n-from zope.component.interfaces import IObjectEvent\n+from zope.interface.interfaces import IObjectEvent\n from zope.lifecycleevent.interfaces import IObjectModifiedEvent\n \n # Modification\ndiff --git a/Products/Archetypes/mimetype_utils.py b/Products/Archetypes/mimetype_utils.py\nindex 9d08d3f0..8566b8d1 100644\n--- a/Products/Archetypes/mimetype_utils.py\n+++ b/Products/Archetypes/mimetype_utils.py\n@@ -6,7 +6,7 @@\n     from Products.CMFPlone.interfaces import IMarkupSchema\n     from plone.registry.interfaces import IRegistry\n     from zope.component import getUtility\n-    from zope.component.interfaces import ComponentLookupError\n+    from zope.interface.interfaces import ComponentLookupError\n except ImportError:\n     IMarkupSchema = None\n \ndiff --git a/Products/Archetypes/tests/events.txt b/Products/Archetypes/tests/events.txt\nindex cea000c5..52031842 100644\n--- a/Products/Archetypes/tests/events.txt\n+++ b/Products/Archetypes/tests/events.txt\n@@ -9,7 +9,7 @@ that listens for object events for `IBaseObject`:\n   >>> from StringIO import StringIO\n   >>> from Products.Archetypes.tests.utils import makeContent, aputrequest\n   >>> from Products.Archetypes.interfaces import IBaseObject\n-  >>> from zope.component.interfaces import IObjectEvent\n+  >>> from zope.interface.interfaces import IObjectEvent\n \n   >>> class Handler:\n   ...     def __init__(self):\ndiff --git a/news/462.bugfix b/news/462.bugfix\nnew file mode 100644\nindex 00000000..5973a0fc\n--- /dev/null\n+++ b/news/462.bugfix\n@@ -0,0 +1,3 @@\n+Fixed incompatibility with ``zope.component`` 5.\n+``zope.component.interfaces`` has long been a backwards compatibility import for ``zope.interface.interfaces``, but not anymore.\n+[maurits]\n'

