Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-07-31T19:17:50+03:00
Author: Alin Voinea (avoinea) <contact@avoinea.com>
Commit: https://github.com/plone/Products.CMFEditions/commit/c80bc31af46bff45fee2908878b1f01190fda8d8

Allow principal in sys_metadata with ArchivistTool init

Files changed:
M Products/CMFEditions/ArchivistTool.py

b'diff --git a/Products/CMFEditions/ArchivistTool.py b/Products/CMFEditions/ArchivistTool.py\nindex 3725cd7..30bd7ba 100644\n--- a/Products/CMFEditions/ArchivistTool.py\n+++ b/Products/CMFEditions/ArchivistTool.py\n@@ -455,7 +455,7 @@ def __init__(\n         sys_metadata["comment"] = sys_metadata.get("comment", "")\n         sys_metadata["timestamp"] = sys_metadata.get("timestamp", int(time.time()))\n         sys_metadata["originator"] = sys_metadata.get("originator", None)\n-        sys_metadata["principal"] = getUserId()\n+        sys_metadata["principal"] = sys_metadata.get("principal", getUserId())\n         sys_metadata["approxSize"] = approxSize\n         sys_metadata["parent"] = {\n             "history_id": portal_uidhandler.register(parent),\n'

Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-07-31T19:20:04+03:00
Author: Alin Voinea (avoinea) <contact@avoinea.com>
Commit: https://github.com/plone/Products.CMFEditions/commit/5d0fe680f05ece30c4a0c940bf4aa99704c28a6e

Update CHANGELOG

Files changed:
A news/101.bugfix

b'diff --git a/news/101.bugfix b/news/101.bugfix\nnew file mode 100644\nindex 00000000..b797257f\n--- /dev/null\n+++ b/news/101.bugfix\n@@ -0,0 +1 @@\n+Allow principal in sys_metadata with ArchivistTool init\n'

Repository: Products.CMFEditions


Branch: refs/heads/master
Date: 2023-10-04T15:34:51+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFEditions/commit/6e4cade848fabc2c304a742628b86dcda9b2f9ed

Merge pull request #101 from plone/principal-fix

Allow principal in sys_metadata with ArchivistTool init

Files changed:
A news/101.bugfix
M Products/CMFEditions/ArchivistTool.py

b'diff --git a/Products/CMFEditions/ArchivistTool.py b/Products/CMFEditions/ArchivistTool.py\nindex 3725cd70..30bd7ba5 100644\n--- a/Products/CMFEditions/ArchivistTool.py\n+++ b/Products/CMFEditions/ArchivistTool.py\n@@ -455,7 +455,7 @@ def __init__(\n         sys_metadata["comment"] = sys_metadata.get("comment", "")\n         sys_metadata["timestamp"] = sys_metadata.get("timestamp", int(time.time()))\n         sys_metadata["originator"] = sys_metadata.get("originator", None)\n-        sys_metadata["principal"] = getUserId()\n+        sys_metadata["principal"] = sys_metadata.get("principal", getUserId())\n         sys_metadata["approxSize"] = approxSize\n         sys_metadata["parent"] = {\n             "history_id": portal_uidhandler.register(parent),\ndiff --git a/news/101.bugfix b/news/101.bugfix\nnew file mode 100644\nindex 00000000..b797257f\n--- /dev/null\n+++ b/news/101.bugfix\n@@ -0,0 +1 @@\n+Allow principal in sys_metadata with ArchivistTool init\n'

