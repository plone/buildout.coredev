Repository: plone.restapi


Branch: refs/heads/main
Date: 2023-11-07T10:42:55-08:00
Author: Wesley Barroso Lopes (wesleybl) <wesleybl@gmail.com>
Commit: https://github.com/plone/plone.restapi/commit/30102e8c50d2829472ba5fba837362c7073b97f4

Use plone.recipe.precompiler to generate mo files to test (#1733)

There are tests that need translation. If we started the instance for
testing, the translation files were generated, causing the documentation
tests to give a different result locally, since in CI the mo files did
not exist.

Files changed:
A news/1733.internal
M base.cfg
M src/plone/restapi/tests/http-examples/translated_messages_addons.resp

b'diff --git a/base.cfg b/base.cfg\nindex 371b9fa4a..dc9af763a 100644\n--- a/base.cfg\n+++ b/base.cfg\n@@ -14,6 +14,7 @@ parts =\n     deploy-to-heroku\n     omelette\n     zpretty\n+    precompile\n develop = .\n sources-dir = extras\n auto-checkout =\n@@ -170,6 +171,11 @@ input = inline:\n output = ${buildout:directory}/bin/zpretty-run\n mode = 755\n \n+[precompile]\n+recipe = plone.recipe.precompiler\n+eggs = plone.restapi\n+compile-mo-files = true\n+\n [sources]\n plone.rest = git git://github.com/plone/plone.rest.git pushurl=git@github.com:plone/plone.rest.git branch=master\n plone.schema = git git://github.com/plone/plone.schema.git pushurl=git@github.com:plone/plone.schema.git branch=master\ndiff --git a/news/1733.internal b/news/1733.internal\nnew file mode 100644\nindex 000000000..747c61c06\n--- /dev/null\n+++ b/news/1733.internal\n@@ -0,0 +1 @@\n+Use plone.recipe.precompiler to generate mo files to test. @wesleybl\ndiff --git a/src/plone/restapi/tests/http-examples/translated_messages_addons.resp b/src/plone/restapi/tests/http-examples/translated_messages_addons.resp\nindex ab08dab00..28fbcebaa 100644\n--- a/src/plone/restapi/tests/http-examples/translated_messages_addons.resp\n+++ b/src/plone/restapi/tests/http-examples/translated_messages_addons.resp\n@@ -59,7 +59,7 @@ Content-Type: application/json\n         },\n         {\n             "@id": "http://localhost:55001/plone/@addons/plone.restapi",\n-            "description": "RESTful hypermedia API for Plone.",\n+            "description": "API hipermedia RESTful para Plone.",\n             "id": "plone.restapi",\n             "install_profile_id": "plone.restapi:default",\n             "is_installed": true,\n'

