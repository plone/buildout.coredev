Repository: plone.app.users


Branch: refs/heads/2.6.x
Date: 2022-08-27T08:49:07+02:00
Author: ale-rt (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.app.users/commit/bee91521783a862969e4a6421d855da1aa2e6567

Added a timezone setter

Add a timezone setter that prevents `None` to be stored as a timezone.
Save it as an empty string instead.

Backports #110 to the 2.6 branch to support Plone 5.2

Files changed:
A news/109.bugfix
M plone/app/users/browser/account.py

b"diff --git a/news/109.bugfix b/news/109.bugfix\nnew file mode 100644\nindex 00000000..a7f6796f\n--- /dev/null\n+++ b/news/109.bugfix\n@@ -0,0 +1 @@\n+Ensure that, when no timezone is selected, the value of the stored timezone is an empty string\ndiff --git a/plone/app/users/browser/account.py b/plone/app/users/browser/account.py\nindex 91c0e6c1..b6242ece 100644\n--- a/plone/app/users/browser/account.py\n+++ b/plone/app/users/browser/account.py\n@@ -138,6 +138,16 @@ def wysiwyg_editor(self, value):\n             value = ''\n         return self._setProperty('wysiwyg_editor', value)\n \n+    @property\n+    def timezone(self):\n+        return self._getProperty('timezone')\n+\n+    @timezone.setter\n+    def timezone(self, value):\n+        if value is None:\n+            value = ''\n+        return self._setProperty('timezone', value)\n+\n \n @implementer(IAccountPanelForm)\n class AccountPanelForm(AutoExtensibleForm, form.Form):\n"

Repository: plone.app.users


Branch: refs/heads/2.6.x
Date: 2022-08-29T10:37:02+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.users/commit/2e63ec3aa7b4ff51641e4f108db521872cd9de77

Merge pull request #111 from plone/109-backport

Add a timezone setter

Files changed:
A news/109.bugfix
M plone/app/users/browser/account.py

b"diff --git a/news/109.bugfix b/news/109.bugfix\nnew file mode 100644\nindex 00000000..a7f6796f\n--- /dev/null\n+++ b/news/109.bugfix\n@@ -0,0 +1 @@\n+Ensure that, when no timezone is selected, the value of the stored timezone is an empty string\ndiff --git a/plone/app/users/browser/account.py b/plone/app/users/browser/account.py\nindex 91c0e6c1..b6242ece 100644\n--- a/plone/app/users/browser/account.py\n+++ b/plone/app/users/browser/account.py\n@@ -138,6 +138,16 @@ def wysiwyg_editor(self, value):\n             value = ''\n         return self._setProperty('wysiwyg_editor', value)\n \n+    @property\n+    def timezone(self):\n+        return self._getProperty('timezone')\n+\n+    @timezone.setter\n+    def timezone(self, value):\n+        if value is None:\n+            value = ''\n+        return self._setProperty('timezone', value)\n+\n \n @implementer(IAccountPanelForm)\n class AccountPanelForm(AutoExtensibleForm, form.Form):\n"

