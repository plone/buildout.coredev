Repository: plone.app.content


Branch: refs/heads/3.5.x
Date: 2020-08-06T09:37:01+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.content/commit/a3121bbd5b1740d5352d3bdbbcccb3dd9ded42d2

backport https://github.com/plone/plone.app.content/pull/208

Files changed:
M plone/app/content/browser/contents/__init__.py

b"diff --git a/plone/app/content/browser/contents/__init__.py b/plone/app/content/browser/contents/__init__.py\nindex 4633a11..3aabbf2 100644\n--- a/plone/app/content/browser/contents/__init__.py\n+++ b/plone/app/content/browser/contents/__init__.py\n@@ -244,6 +244,10 @@ def get_thumb_scale(self):\n         thumb_scale_table = settings.thumb_scale_table\n         return thumb_scale_table\n \n+    def default_page_types(self):\n+        registry = getUtility(IRegistry)\n+        return registry.get('plone.default_page_types', [])\n+\n     @property\n     def ignored_indexes(self):\n         ignored = [\n@@ -316,6 +320,7 @@ def get_options(self):\n             'indexOptionsUrl': '%s/@@qsOptions' % base_url,\n             'contextInfoUrl': '%s{path}/@@fc-contextInfo' % base_url,\n             'setDefaultPageUrl': '%s{path}/@@fc-setDefaultPage' % base_url,\n+            'defaultPageTypes': self.default_page_types(),\n             'availableColumns': columns,\n             'attributes': ['Title', 'path', 'getURL', 'getIcon', 'getMimeIcon', 'portal_type'] + list(columns.keys()),  # noqa\n             'buttons': self.get_actions(),\n"

Repository: plone.app.content


Branch: refs/heads/3.5.x
Date: 2020-08-06T09:49:54+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.content/commit/68a4ffcd6c1781aef6ffcfefcecd195923dc9aba

add changenote

Files changed:
A news/209.bugfix

b'diff --git a/news/209.bugfix b/news/209.bugfix\nnew file mode 100644\nindex 0000000..db2aae9\n--- /dev/null\n+++ b/news/209.bugfix\n@@ -0,0 +1,2 @@\n+Pass default_page_types to allow respecting default_pages_types. (backport #208 to Plone 5.1.x)\n+[pbauer]\n\\ No newline at end of file\n'

Repository: plone.app.content


Branch: refs/heads/3.5.x
Date: 2020-08-06T09:50:41+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.content/commit/cb922211ddeea64dc619001e48e49175d1337241

Merge branch '3.5.x' into backport_208

Files changed:


b''

Repository: plone.app.content


Branch: refs/heads/3.5.x
Date: 2020-08-06T13:44:49+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.content/commit/feaac342134555c9119a02440e1ea64f1ebce3f0

Merge pull request #209 from plone/backport_208

backport https://github.com/plone/plone.app.content/pull/208

Files changed:
M news/209.bugfix
M plone/app/content/browser/contents/__init__.py

b"diff --git a/news/209.bugfix b/news/209.bugfix\nindex 6cc1736..db2aae9 100644\n--- a/news/209.bugfix\n+++ b/news/209.bugfix\n@@ -1,2 +1,2 @@\n-Pass default_page_types to allow respecting default_pages_types.\n+Pass default_page_types to allow respecting default_pages_types. (backport #208 to Plone 5.1.x)\n [pbauer]\n\\ No newline at end of file\ndiff --git a/plone/app/content/browser/contents/__init__.py b/plone/app/content/browser/contents/__init__.py\nindex 4633a11..3aabbf2 100644\n--- a/plone/app/content/browser/contents/__init__.py\n+++ b/plone/app/content/browser/contents/__init__.py\n@@ -244,6 +244,10 @@ def get_thumb_scale(self):\n         thumb_scale_table = settings.thumb_scale_table\n         return thumb_scale_table\n \n+    def default_page_types(self):\n+        registry = getUtility(IRegistry)\n+        return registry.get('plone.default_page_types', [])\n+\n     @property\n     def ignored_indexes(self):\n         ignored = [\n@@ -316,6 +320,7 @@ def get_options(self):\n             'indexOptionsUrl': '%s/@@qsOptions' % base_url,\n             'contextInfoUrl': '%s{path}/@@fc-contextInfo' % base_url,\n             'setDefaultPageUrl': '%s{path}/@@fc-setDefaultPage' % base_url,\n+            'defaultPageTypes': self.default_page_types(),\n             'availableColumns': columns,\n             'attributes': ['Title', 'path', 'getURL', 'getIcon', 'getMimeIcon', 'portal_type'] + list(columns.keys()),  # noqa\n             'buttons': self.get_actions(),\n"

