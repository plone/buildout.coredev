Repository: plone.restapi


Branch: refs/heads/master
Date: 2021-03-27T00:50:04+01:00
Author: Víctor Fernández de Alba (sneridagh) <sneridagh@gmail.com>
Commit: https://github.com/plone/plone.restapi/commit/cd34077eefc87885317d12ac509bed5ccd4952a8

Fixes if old p.schema is used (#1104)

* Fixes if old p.schema is used

* black

Files changed:
A news/1103.bugfix
M src/plone/restapi/types/adapters.py

b'diff --git a/news/1103.bugfix b/news/1103.bugfix\nnew file mode 100644\nindex 000000000..a12da2ea2\n--- /dev/null\n+++ b/news/1103.bugfix\n@@ -0,0 +1,2 @@\n+Fixes if old p.schema is used\n+[sneridagh]\ndiff --git a/src/plone/restapi/types/adapters.py b/src/plone/restapi/types/adapters.py\nindex 7cba81c1e..2352e12e2 100644\n--- a/src/plone/restapi/types/adapters.py\n+++ b/src/plone/restapi/types/adapters.py\n@@ -503,7 +503,7 @@ def get_type(self):\n         return "dict"\n \n     def get_widget(self):\n-        return self.field.widget or "json"\n+        return getattr(self.field, "widget", False) or "json"\n \n     def get_factory(self):\n         return "JSONField"\n'

