Repository: plone.app.relationfield


Branch: refs/heads/master
Date: 2020-10-07T23:28:16+03:00
Author: Alin Voinea (avoinea) <contact@avoinea.com>
Commit: https://github.com/plone/plone.app.relationfield/commit/635524f242b02232c0acc652182e2636930632c6

Refs #30 - Fix tests to match plone.dexterity dynamic schema name

Files changed:
A news/30.bugfix
M plone/app/relationfield/tests/test_schemaeditor.py

b'diff --git a/news/30.bugfix b/news/30.bugfix\nnew file mode 100644\nindex 0000000..bbbe493\n--- /dev/null\n+++ b/news/30.bugfix\n@@ -0,0 +1,2 @@\n+- Update tests to fix https://github.com/plone/plone.dexterity/pull/137\n+[@avoinea]\ndiff --git a/plone/app/relationfield/tests/test_schemaeditor.py b/plone/app/relationfield/tests/test_schemaeditor.py\nindex 1d9892e..2da2132 100644\n--- a/plone/app/relationfield/tests/test_schemaeditor.py\n+++ b/plone/app/relationfield/tests/test_schemaeditor.py\n@@ -4,12 +4,21 @@\n \n import doctest\n import os\n+import six\n+import re\n import unittest\n \n \n optionflags = doctest.ELLIPSIS | doctest.NORMALIZE_WHITESPACE\n \n \n+class Py23DocChecker(doctest.OutputChecker):\n+    def check_output(self, want, got, optionflags):\n+        if six.PY2:\n+            got = re.sub("u\'(.*?)\'", "\'\\\\1\'", got)\n+        return doctest.OutputChecker.check_output(self, want, got, optionflags)\n+\n+\n def test_suite():\n     suite = unittest.TestSuite()\n     suite.addTests(\n@@ -18,6 +27,7 @@ def test_suite():\n                 doctest.DocFileSuite(\n                     os.path.join(os.path.pardir, \'schemaeditor.txt\'),\n                     optionflags=optionflags,\n+                    checker=Py23DocChecker(),\n                 ),\n                 FUNCTIONAL_WIDGETS_TESTING,\n             )\n'

Repository: plone.app.relationfield


Branch: refs/heads/master
Date: 2020-10-08T11:40:40+02:00
Author: Alessandro Pisa (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.app.relationfield/commit/d817430a346c05230673247fa102327bfe4ad3fa

Merge pull request #31 from plone/sync-schema-on-zeo-clients

Refs #30 - Fix tests to match plone.dexterity dynamic schema name

Files changed:
A news/30.bugfix
M plone/app/relationfield/tests/test_schemaeditor.py

b'diff --git a/news/30.bugfix b/news/30.bugfix\nnew file mode 100644\nindex 0000000..bbbe493\n--- /dev/null\n+++ b/news/30.bugfix\n@@ -0,0 +1,2 @@\n+- Update tests to fix https://github.com/plone/plone.dexterity/pull/137\n+[@avoinea]\ndiff --git a/plone/app/relationfield/tests/test_schemaeditor.py b/plone/app/relationfield/tests/test_schemaeditor.py\nindex 1d9892e..2da2132 100644\n--- a/plone/app/relationfield/tests/test_schemaeditor.py\n+++ b/plone/app/relationfield/tests/test_schemaeditor.py\n@@ -4,12 +4,21 @@\n \n import doctest\n import os\n+import six\n+import re\n import unittest\n \n \n optionflags = doctest.ELLIPSIS | doctest.NORMALIZE_WHITESPACE\n \n \n+class Py23DocChecker(doctest.OutputChecker):\n+    def check_output(self, want, got, optionflags):\n+        if six.PY2:\n+            got = re.sub("u\'(.*?)\'", "\'\\\\1\'", got)\n+        return doctest.OutputChecker.check_output(self, want, got, optionflags)\n+\n+\n def test_suite():\n     suite = unittest.TestSuite()\n     suite.addTests(\n@@ -18,6 +27,7 @@ def test_suite():\n                 doctest.DocFileSuite(\n                     os.path.join(os.path.pardir, \'schemaeditor.txt\'),\n                     optionflags=optionflags,\n+                    checker=Py23DocChecker(),\n                 ),\n                 FUNCTIONAL_WIDGETS_TESTING,\n             )\n'

