Repository: plone.app.discussion


Branch: refs/heads/3.4.x
Date: 2022-05-10T21:46:35+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.discussion/commit/4acadac5f3403ccf09997cebd9bebc8b9e58a270

Grant Site Administrators the same workflow permissions as Managers.

They were missing permissions on pending comments.
Fixes https://github.com/plone/plone.app.discussion/issues/199

Files changed:
A news/199.bugfix
M plone/app/discussion/profiles/default/metadata.xml
M plone/app/discussion/profiles/default/workflows/comment_review_workflow/definition.xml
M plone/app/discussion/upgrades.zcml

b'diff --git a/news/199.bugfix b/news/199.bugfix\nnew file mode 100644\nindex 00000000..4d0dd3ef\n--- /dev/null\n+++ b/news/199.bugfix\n@@ -0,0 +1,3 @@\n+Grant Site Administrators the same workflow permissions as Managers.\n+They were missing permissions on pending comments.\n+[maurits]\ndiff --git a/plone/app/discussion/profiles/default/metadata.xml b/plone/app/discussion/profiles/default/metadata.xml\nindex 49f2d5ec..727c28c5 100644\n--- a/plone/app/discussion/profiles/default/metadata.xml\n+++ b/plone/app/discussion/profiles/default/metadata.xml\n@@ -1,5 +1,5 @@\n <metadata>\n- <version>1002</version>\n+ <version>1003</version>\n  <dependencies>\n   <dependency>profile-plone.resource:default</dependency>\n   <dependency>profile-plone.app.registry:default</dependency>\ndiff --git a/plone/app/discussion/profiles/default/workflows/comment_review_workflow/definition.xml b/plone/app/discussion/profiles/default/workflows/comment_review_workflow/definition.xml\nindex af19e9e3..439fdb60 100644\n--- a/plone/app/discussion/profiles/default/workflows/comment_review_workflow/definition.xml\n+++ b/plone/app/discussion/profiles/default/workflows/comment_review_workflow/definition.xml\n@@ -20,11 +20,13 @@\n                      <permission-role>Manager</permission-role>\n                      <permission-role>Owner</permission-role>\n                      <permission-role>Reviewer</permission-role>\n+                     <permission-role>Site Administrator</permission-role>\n                  </permission-map>\n                  <permission-map name="Modify portal content" acquired="False">\n                      <permission-role>Manager</permission-role>\n                      <permission-role>Owner</permission-role>\n                      <permission-role>Reviewer</permission-role>\n+                     <permission-role>Site Administrator</permission-role>\n                  </permission-map>\n                  <permission-map name="Reply to item" acquired="False">\n                  </permission-map>\n@@ -32,6 +34,7 @@\n                      <permission-role>Manager</permission-role>\n                      <permission-role>Owner</permission-role>\n                      <permission-role>Reviewer</permission-role>\n+                     <permission-role>Site Administrator</permission-role>\n                  </permission-map>\n              </state>\n              <state state_id="published" title="Published">\n@@ -43,6 +46,7 @@\n                  </permission-map>\n                  <permission-map name="Modify portal content" acquired="False">\n                      <permission-role>Manager</permission-role>\n+                     <permission-role>Site Administrator</permission-role>\n                  </permission-map>\n                  <permission-map name="Reply to item" acquired="True">\n                  </permission-map>\ndiff --git a/plone/app/discussion/upgrades.zcml b/plone/app/discussion/upgrades.zcml\nindex ae72b6ee..ce523f3b 100644\n--- a/plone/app/discussion/upgrades.zcml\n+++ b/plone/app/discussion/upgrades.zcml\n@@ -71,6 +71,14 @@\n         description="Additional states allows moderator to review history of publishing and rejection"\n         handler=".upgrades.extend_review_workflow"\n         />\n-</genericsetup:upgradeSteps>\n+  </genericsetup:upgradeSteps>\n+\n+  <genericsetup:upgradeStep\n+      source="1002"\n+      destination="1003"\n+      profile="plone.app.discussion:default"\n+      title="Grant Site Administrator permissions on pending comments"\n+      handler=".upgrades.upgrade_comment_workflows"\n+      />\n \n </configure>\n'

Repository: plone.app.discussion


Branch: refs/heads/3.4.x
Date: 2022-05-10T23:00:32+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.discussion/commit/2c450becef8378e534743ebd07f96b6d7834202b

Merge pull request #201 from plone/maurits-site-administrators-52

Grant Site Administrators same workflow permissions as Managers [5.2]

Files changed:
A news/199.bugfix
M plone/app/discussion/profiles/default/metadata.xml
M plone/app/discussion/profiles/default/workflows/comment_review_workflow/definition.xml
M plone/app/discussion/upgrades.zcml

b'diff --git a/news/199.bugfix b/news/199.bugfix\nnew file mode 100644\nindex 00000000..4d0dd3ef\n--- /dev/null\n+++ b/news/199.bugfix\n@@ -0,0 +1,3 @@\n+Grant Site Administrators the same workflow permissions as Managers.\n+They were missing permissions on pending comments.\n+[maurits]\ndiff --git a/plone/app/discussion/profiles/default/metadata.xml b/plone/app/discussion/profiles/default/metadata.xml\nindex 49f2d5ec..727c28c5 100644\n--- a/plone/app/discussion/profiles/default/metadata.xml\n+++ b/plone/app/discussion/profiles/default/metadata.xml\n@@ -1,5 +1,5 @@\n <metadata>\n- <version>1002</version>\n+ <version>1003</version>\n  <dependencies>\n   <dependency>profile-plone.resource:default</dependency>\n   <dependency>profile-plone.app.registry:default</dependency>\ndiff --git a/plone/app/discussion/profiles/default/workflows/comment_review_workflow/definition.xml b/plone/app/discussion/profiles/default/workflows/comment_review_workflow/definition.xml\nindex af19e9e3..439fdb60 100644\n--- a/plone/app/discussion/profiles/default/workflows/comment_review_workflow/definition.xml\n+++ b/plone/app/discussion/profiles/default/workflows/comment_review_workflow/definition.xml\n@@ -20,11 +20,13 @@\n                      <permission-role>Manager</permission-role>\n                      <permission-role>Owner</permission-role>\n                      <permission-role>Reviewer</permission-role>\n+                     <permission-role>Site Administrator</permission-role>\n                  </permission-map>\n                  <permission-map name="Modify portal content" acquired="False">\n                      <permission-role>Manager</permission-role>\n                      <permission-role>Owner</permission-role>\n                      <permission-role>Reviewer</permission-role>\n+                     <permission-role>Site Administrator</permission-role>\n                  </permission-map>\n                  <permission-map name="Reply to item" acquired="False">\n                  </permission-map>\n@@ -32,6 +34,7 @@\n                      <permission-role>Manager</permission-role>\n                      <permission-role>Owner</permission-role>\n                      <permission-role>Reviewer</permission-role>\n+                     <permission-role>Site Administrator</permission-role>\n                  </permission-map>\n              </state>\n              <state state_id="published" title="Published">\n@@ -43,6 +46,7 @@\n                  </permission-map>\n                  <permission-map name="Modify portal content" acquired="False">\n                      <permission-role>Manager</permission-role>\n+                     <permission-role>Site Administrator</permission-role>\n                  </permission-map>\n                  <permission-map name="Reply to item" acquired="True">\n                  </permission-map>\ndiff --git a/plone/app/discussion/upgrades.zcml b/plone/app/discussion/upgrades.zcml\nindex ae72b6ee..ce523f3b 100644\n--- a/plone/app/discussion/upgrades.zcml\n+++ b/plone/app/discussion/upgrades.zcml\n@@ -71,6 +71,14 @@\n         description="Additional states allows moderator to review history of publishing and rejection"\n         handler=".upgrades.extend_review_workflow"\n         />\n-</genericsetup:upgradeSteps>\n+  </genericsetup:upgradeSteps>\n+\n+  <genericsetup:upgradeStep\n+      source="1002"\n+      destination="1003"\n+      profile="plone.app.discussion:default"\n+      title="Grant Site Administrator permissions on pending comments"\n+      handler=".upgrades.upgrade_comment_workflows"\n+      />\n \n </configure>\n'

