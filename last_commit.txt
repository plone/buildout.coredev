Repository: plone.restapi


Branch: refs/heads/7.x.x
Date: 2021-05-14T13:49:47+02:00
Author: Alessandro Pisa (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.restapi/commit/4247201374cc1f6bfc20bd7c88b538a378b05bcf

Update import to fix a deprecation warning (#1131)

Fixes #1129

Files changed:
A news/1129.bugfix
M src/plone/restapi/services/workflow/utils.py

b'diff --git a/news/1129.bugfix b/news/1129.bugfix\nnew file mode 100644\nindex 000000000..159facc75\n--- /dev/null\n+++ b/news/1129.bugfix\n@@ -0,0 +1 @@\n+Fixed a deprecation warning when importing UnrestrictedUser from AccessControl\ndiff --git a/src/plone/restapi/services/workflow/utils.py b/src/plone/restapi/services/workflow/utils.py\nindex b9bebcbab..afe8efb45 100644\n--- a/src/plone/restapi/services/workflow/utils.py\n+++ b/src/plone/restapi/services/workflow/utils.py\n@@ -3,11 +3,16 @@\n from AccessControl.SecurityManagement import getSecurityManager\n from AccessControl.SecurityManagement import newSecurityManager\n from AccessControl.SecurityManagement import setSecurityManager\n-from AccessControl.User import UnrestrictedUser as BaseUnrestrictedUser\n from contextlib import contextmanager\n from zope.component import getMultiAdapter\n \n \n+try:\n+    from AccessControl.users import UnrestrictedUser as BaseUnrestrictedUser\n+except ImportError:\n+    from AccessControl.User import UnrestrictedUser as BaseUnrestrictedUser\n+\n+\n class UnrestrictedUser(BaseUnrestrictedUser):\n     """Unrestricted user that still has an id."""\n \n'

