Repository: plone.app.robotframework


Branch: refs/heads/master
Date: 2020-10-02T16:30:48+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.robotframework/commit/65d586141ad6cc79219848d9aad431fa01d1106c

Removed backwards compatibility code for old quickinstaller.

Current plone.app.robotframework is only for Plone 5.2+, so this code was no longer used.
See also PLIP 1775: https://github.com/plone/Products.CMFPlone/issues/1775.

Files changed:
A news/1775.feature
M src/plone/app/robotframework/quickinstaller.py

b'diff --git a/news/1775.feature b/news/1775.feature\nnew file mode 100644\nindex 0000000..96b6e26\n--- /dev/null\n+++ b/news/1775.feature\n@@ -0,0 +1,4 @@\n+Removed backwards compatibility code for old quickinstaller.\n+Current plone.app.robotframework is only for Plone 5.2+, so this code was no longer used.\n+See also `PLIP 1775 <https://github.com/plone/Products.CMFPlone/issues/1775>`_.\n+[maurits]\ndiff --git a/src/plone/app/robotframework/quickinstaller.py b/src/plone/app/robotframework/quickinstaller.py\nindex 56a34ba..ce96b30 100644\n--- a/src/plone/app/robotframework/quickinstaller.py\n+++ b/src/plone/app/robotframework/quickinstaller.py\n@@ -2,11 +2,7 @@\n from zope.component.hooks import getSite\n from Products.CMFCore.utils import getToolByName\n from plone.app.robotframework.remote import RemoteLibrary\n-try:\n-    from Products.CMFPlone.utils import get_installer\n-except ImportError:\n-    # BBB for Plone 5.0 and lower.\n-    get_installer = None\n+from Products.CMFPlone.utils import get_installer\n \n \n class QuickInstaller(RemoteLibrary):\n@@ -16,12 +12,8 @@ def product_is_activated(self, product_name):\n         the add-ons control panel.\n         """\n         portal = getSite()\n-        if get_installer is None:\n-            qi = getToolByName(portal, \'portal_quickinstaller\')\n-            installed = qi.isProductInstalled(product_name)\n-        else:\n-            qi = get_installer(portal)\n-            installed = qi.is_product_installed(product_name)\n+        qi = get_installer(portal)\n+        installed = qi.is_product_installed(product_name)\n         portal_setup = getToolByName(portal, \'portal_setup\')\n         imported = portal_setup.getProfileImportDate(\n             \'profile-{0}:default\'.format(product_name))\n'

Repository: plone.app.robotframework


Branch: refs/heads/master
Date: 2020-10-02T22:09:45+02:00
Author: Maurits van Rees (mauritsvanrees) <m.van.rees@zestsoftware.nl>
Commit: https://github.com/plone/plone.app.robotframework/commit/1e4bd0e6bf722f98b574f7cadd4c23abfc3077e4

Merge pull request #122 from plone/maurits/no-qi

Removed backwards compatibility code for old quickinstaller.

Files changed:
A news/1775.feature
M src/plone/app/robotframework/quickinstaller.py

b'diff --git a/news/1775.feature b/news/1775.feature\nnew file mode 100644\nindex 0000000..96b6e26\n--- /dev/null\n+++ b/news/1775.feature\n@@ -0,0 +1,4 @@\n+Removed backwards compatibility code for old quickinstaller.\n+Current plone.app.robotframework is only for Plone 5.2+, so this code was no longer used.\n+See also `PLIP 1775 <https://github.com/plone/Products.CMFPlone/issues/1775>`_.\n+[maurits]\ndiff --git a/src/plone/app/robotframework/quickinstaller.py b/src/plone/app/robotframework/quickinstaller.py\nindex 56a34ba..ce96b30 100644\n--- a/src/plone/app/robotframework/quickinstaller.py\n+++ b/src/plone/app/robotframework/quickinstaller.py\n@@ -2,11 +2,7 @@\n from zope.component.hooks import getSite\n from Products.CMFCore.utils import getToolByName\n from plone.app.robotframework.remote import RemoteLibrary\n-try:\n-    from Products.CMFPlone.utils import get_installer\n-except ImportError:\n-    # BBB for Plone 5.0 and lower.\n-    get_installer = None\n+from Products.CMFPlone.utils import get_installer\n \n \n class QuickInstaller(RemoteLibrary):\n@@ -16,12 +12,8 @@ def product_is_activated(self, product_name):\n         the add-ons control panel.\n         """\n         portal = getSite()\n-        if get_installer is None:\n-            qi = getToolByName(portal, \'portal_quickinstaller\')\n-            installed = qi.isProductInstalled(product_name)\n-        else:\n-            qi = get_installer(portal)\n-            installed = qi.is_product_installed(product_name)\n+        qi = get_installer(portal)\n+        installed = qi.is_product_installed(product_name)\n         portal_setup = getToolByName(portal, \'portal_setup\')\n         imported = portal_setup.getProfileImportDate(\n             \'profile-{0}:default\'.format(product_name))\n'

