Repository: plone.restapi


Branch: refs/heads/master
Date: 2023-07-14T16:52:42-04:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.restapi/commit/24f25d7632ed23ffd0087ba810657250242ddccb

Fix timezone handling in history endpoint and tests (#1647)

* Fix timezone handling in history endpoint and tests

* changelog

* lint

* Update times in test responses

---------

Co-authored-by: Jens W. Klein &lt;jk@kleinundpartner.at&gt;

Files changed:
A news/1647.bugfix
M src/plone/restapi/services/history/get.py
M src/plone/restapi/services/locking/__init__.py
M src/plone/restapi/tests/http-examples/collection.resp
M src/plone/restapi/tests/http-examples/collection_fullobjects.resp
M src/plone/restapi/tests/http-examples/content_get.resp
M src/plone/restapi/tests/http-examples/content_get_folder.resp
M src/plone/restapi/tests/http-examples/content_patch_representation.resp
M src/plone/restapi/tests/http-examples/content_post.resp
M src/plone/restapi/tests/http-examples/document.resp
M src/plone/restapi/tests/http-examples/event.resp
M src/plone/restapi/tests/http-examples/expansion.resp
M src/plone/restapi/tests/http-examples/expansion_expanded.resp
M src/plone/restapi/tests/http-examples/expansion_expanded_full.resp
M src/plone/restapi/tests/http-examples/file.resp
M src/plone/restapi/tests/http-examples/folder.resp
M src/plone/restapi/tests/http-examples/history_get.resp
M src/plone/restapi/tests/http-examples/image.resp
M src/plone/restapi/tests/http-examples/link.resp
M src/plone/restapi/tests/http-examples/lock.resp
M src/plone/restapi/tests/http-examples/lock_nonstealable_timeout.resp
M src/plone/restapi/tests/http-examples/navroot_lang_content_get.resp
M src/plone/restapi/tests/http-examples/navroot_lang_folder_get.resp
M src/plone/restapi/tests/http-examples/navroot_standard_site_content_get_expansion.resp
M src/plone/restapi/tests/http-examples/newsitem.resp
M src/plone/restapi/tests/http-examples/refresh_lock.resp
M src/plone/restapi/tests/http-examples/search_fullobjects.resp
M src/plone/restapi/tests/http-examples/search_metadata_fields.resp
M src/plone/restapi/tests/http-examples/site_get_expand_lang_folder.resp
M src/plone/restapi/tests/http-examples/site_get_expand_lang_folder_content.resp
M src/plone/restapi/tests/http-examples/translated_messages_object_history.resp
M src/plone/restapi/tests/http-examples/translated_messages_object_workflow.resp
M src/plone/restapi/tests/http-examples/translations_link_on_post.resp
M src/plone/restapi/tests/http-examples/workflow_get.resp
M src/plone/restapi/tests/http-examples/workflow_post.resp
M src/plone/restapi/tests/http-examples/workflow_post_with_body.resp
M src/plone/restapi/tests/http-examples/workingcopy_baseline_get.resp
M src/plone/restapi/tests/http-examples/workingcopy_get.resp
M src/plone/restapi/tests/http-examples/workingcopy_wc_get.resp
M src/plone/restapi/tests/statictime.py

b'diff --git a/news/1647.bugfix b/news/1647.bugfix\nnew file mode 100644\nindex 000000000..8c3ba08da\n--- /dev/null\n+++ b/news/1647.bugfix\n@@ -0,0 +1 @@\n+Fix timezone of dates for revisions in the `@history` service. @davisagli\ndiff --git a/src/plone/restapi/services/history/get.py b/src/plone/restapi/services/history/get.py\nindex 18b71c1f0..842785f84 100644\n--- a/src/plone/restapi/services/history/get.py\n+++ b/src/plone/restapi/services/history/get.py\n@@ -1,4 +1,5 @@\n from datetime import datetime as dt\n+from datetime import timezone\n from plone.app.layout.viewlets.content import ContentHistoryViewlet\n from plone.restapi.bbb import safe_text\n from plone.restapi.interfaces import ISerializeToJson\n@@ -71,13 +72,9 @@ def reply(self):\n             # Versioning entries use a timestamp,\n             # workflow ISO formatted string\n             if not isinstance(item["time"], str):\n-                # Note that isoformat does not add the Z at the end of the string, The lack of the\n-                # timezone specifier causes Intl (and derivative libraries) in the browser not to\n-                # use local time, which is considered a bug in applications. Therefore we add the Z\n-                # to the end to make sure that the date will be interpreted properly by the client.\n-                item["time"] = dt.fromtimestamp(int(item["time"])).strftime(\n-                    "%Y-%m-%dT%H:%M:%SZ"\n-                )\n+                item["time"] = dt.fromtimestamp(\n+                    int(item["time"]), tz=timezone.utc\n+                ).isoformat(timespec="seconds")\n \n             # The create event has an empty \'action\', but we like it to say\n             # \'Create\', alike the transition_title\ndiff --git a/src/plone/restapi/services/locking/__init__.py b/src/plone/restapi/services/locking/__init__.py\nindex a2529d824..53fce1b03 100644\n--- a/src/plone/restapi/services/locking/__init__.py\n+++ b/src/plone/restapi/services/locking/__init__.py\n@@ -1,6 +1,7 @@\n """ Locking\n """\n from datetime import datetime\n+from datetime import timezone\n from plone import api\n from plone.locking.interfaces import ILockable\n \n@@ -20,7 +21,9 @@ def creation_date(timestamp):\n     # timezone specifier causes Intl (and derivative libraries) in the browser not to\n     # use local time, which is considered a bug in applications. Therefore we add the Z\n     # to the end to make sure that the date will be interpreted properly by the client.\n-    return datetime.utcfromtimestamp(timestamp).strftime("%Y-%m-%dT%H:%M:%SZ")\n+    return datetime.fromtimestamp(timestamp, tz=timezone.utc).isoformat(\n+        timespec="seconds"\n+    )\n \n \n def lock_info(obj):\ndiff --git a/src/plone/restapi/tests/http-examples/collection.resp b/src/plone/restapi/tests/http-examples/collection.resp\nindex 740fc4bc7..036a0bfd2 100644\n--- a/src/plone/restapi/tests/http-examples/collection.resp\n+++ b/src/plone/restapi/tests/http-examples/collection.resp\n@@ -33,7 +33,7 @@ Content-Type: application/json\n     "UID": "SomeUUID000000000000000000000002",\n     "allow_discussion": false,\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -96,7 +96,7 @@ Content-Type: application/json\n         "locked": false,\n         "stealable": true\n     },\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {\n         "@id": "http://localhost:55001/plone/doc1",\n         "@type": "Document",\ndiff --git a/src/plone/restapi/tests/http-examples/collection_fullobjects.resp b/src/plone/restapi/tests/http-examples/collection_fullobjects.resp\nindex b6c5da9d1..04b573bff 100644\n--- a/src/plone/restapi/tests/http-examples/collection_fullobjects.resp\n+++ b/src/plone/restapi/tests/http-examples/collection_fullobjects.resp\n@@ -33,7 +33,7 @@ Content-Type: application/json\n     "UID": "SomeUUID000000000000000000000002",\n     "allow_discussion": false,\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -96,7 +96,7 @@ Content-Type: application/json\n             "allow_discussion": false,\n             "changeNote": "",\n             "contributors": [],\n-            "created": "1995-07-31T13:45:00",\n+            "created": "1995-07-31T13:45:00+00:00",\n             "creators": [\n                 "test_user_1_"\n             ],\n@@ -112,7 +112,7 @@ Content-Type: application/json\n                 "locked": false,\n                 "stealable": true\n             },\n-            "modified": "1995-07-31T17:30:00",\n+            "modified": "1995-07-31T17:30:00+00:00",\n             "next_item": {\n                 "@id": "http://localhost:55001/plone/collection",\n                 "@type": "Collection",\n@@ -178,7 +178,7 @@ Content-Type: application/json\n             "allow_discussion": false,\n             "changeNote": "",\n             "contributors": [],\n-            "created": "1995-07-31T13:45:00",\n+            "created": "1995-07-31T13:45:00+00:00",\n             "creators": [\n                 "test_user_1_"\n             ],\n@@ -194,7 +194,7 @@ Content-Type: application/json\n                 "locked": false,\n                 "stealable": true\n             },\n-            "modified": "1995-07-31T17:30:00",\n+            "modified": "1995-07-31T17:30:00+00:00",\n             "next_item": {\n                 "@id": "http://localhost:55001/plone/doc2",\n                 "@type": "Document",\n@@ -262,7 +262,7 @@ Content-Type: application/json\n             "allow_discussion": false,\n             "changeNote": "",\n             "contributors": [],\n-            "created": "1995-07-31T13:45:00",\n+            "created": "1995-07-31T13:45:00+00:00",\n             "creators": [\n                 "test_user_1_"\n             ],\n@@ -278,7 +278,7 @@ Content-Type: application/json\n                 "locked": false,\n                 "stealable": true\n             },\n-            "modified": "1995-07-31T17:30:00",\n+            "modified": "1995-07-31T17:30:00+00:00",\n             "next_item": {},\n             "parent": {\n                 "@id": "http://localhost:55001/plone",\n@@ -316,7 +316,7 @@ Content-Type: application/json\n         "locked": false,\n         "stealable": true\n     },\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {\n         "@id": "http://localhost:55001/plone/doc1",\n         "@type": "Document",\ndiff --git a/src/plone/restapi/tests/http-examples/content_get.resp b/src/plone/restapi/tests/http-examples/content_get.resp\nindex c2ce31688..9d876dccf 100644\n--- a/src/plone/restapi/tests/http-examples/content_get.resp\n+++ b/src/plone/restapi/tests/http-examples/content_get.resp\n@@ -34,7 +34,7 @@ Content-Type: application/json\n     "allow_discussion": false,\n     "changeNote": "",\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "admin"\n     ],\n@@ -50,7 +50,7 @@ Content-Type: application/json\n         "locked": false,\n         "stealable": true\n     },\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {},\n     "parent": {\n         "@id": "http://localhost:55001/plone/folder",\ndiff --git a/src/plone/restapi/tests/http-examples/content_get_folder.resp b/src/plone/restapi/tests/http-examples/content_get_folder.resp\nindex a1ab52dc2..c7e9f35e7 100644\n--- a/src/plone/restapi/tests/http-examples/content_get_folder.resp\n+++ b/src/plone/restapi/tests/http-examples/content_get_folder.resp\n@@ -33,7 +33,7 @@ Content-Type: application/json\n     "UID": "SomeUUID000000000000000000000002",\n     "allow_discussion": false,\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -79,7 +79,7 @@ Content-Type: application/json\n     "language": "",\n     "layout": "listing_view",\n     "lock": {},\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "nextPreviousEnabled": false,\n     "next_item": {},\n     "parent": {\ndiff --git a/src/plone/restapi/tests/http-examples/content_patch_representation.resp b/src/plone/restapi/tests/http-examples/content_patch_representation.resp\nindex 9f26814f2..0003cae47 100644\n--- a/src/plone/restapi/tests/http-examples/content_patch_representation.resp\n+++ b/src/plone/restapi/tests/http-examples/content_patch_representation.resp\n@@ -34,7 +34,7 @@ Content-Type: application/json\n     "allow_discussion": false,\n     "changeNote": "",\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "admin"\n     ],\n@@ -50,7 +50,7 @@ Content-Type: application/json\n         "locked": false,\n         "stealable": true\n     },\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {},\n     "parent": {\n         "@id": "http://localhost:55001/plone/folder",\ndiff --git a/src/plone/restapi/tests/http-examples/content_post.resp b/src/plone/restapi/tests/http-examples/content_post.resp\nindex d9930ffcf..9cd542a49 100644\n--- a/src/plone/restapi/tests/http-examples/content_post.resp\n+++ b/src/plone/restapi/tests/http-examples/content_post.resp\n@@ -35,7 +35,7 @@ Location: http://localhost:55001/plone/folder/my-document\n     "allow_discussion": false,\n     "changeNote": "",\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "admin"\n     ],\n@@ -51,7 +51,7 @@ Location: http://localhost:55001/plone/folder/my-document\n         "locked": false,\n         "stealable": true\n     },\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {},\n     "parent": {\n         "@id": "http://localhost:55001/plone/folder",\ndiff --git a/src/plone/restapi/tests/http-examples/document.resp b/src/plone/restapi/tests/http-examples/document.resp\nindex 46a8f7d79..c9347e6aa 100644\n--- a/src/plone/restapi/tests/http-examples/document.resp\n+++ b/src/plone/restapi/tests/http-examples/document.resp\n@@ -34,7 +34,7 @@ Content-Type: application/json\n     "allow_discussion": false,\n     "changeNote": "",\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -50,7 +50,7 @@ Content-Type: application/json\n         "locked": false,\n         "stealable": true\n     },\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {},\n     "parent": {\n         "@id": "http://localhost:55001/plone",\ndiff --git a/src/plone/restapi/tests/http-examples/event.resp b/src/plone/restapi/tests/http-examples/event.resp\nindex d66635ce2..a8538c9fc 100644\n--- a/src/plone/restapi/tests/http-examples/event.resp\n+++ b/src/plone/restapi/tests/http-examples/event.resp\n@@ -38,7 +38,7 @@ Content-Type: application/json\n     "contact_name": null,\n     "contact_phone": null,\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -57,7 +57,7 @@ Content-Type: application/json\n         "locked": false,\n         "stealable": true\n     },\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {},\n     "open_end": false,\n     "parent": {\ndiff --git a/src/plone/restapi/tests/http-examples/expansion.resp b/src/plone/restapi/tests/http-examples/expansion.resp\nindex 46a8f7d79..c9347e6aa 100644\n--- a/src/plone/restapi/tests/http-examples/expansion.resp\n+++ b/src/plone/restapi/tests/http-examples/expansion.resp\n@@ -34,7 +34,7 @@ Content-Type: application/json\n     "allow_discussion": false,\n     "changeNote": "",\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -50,7 +50,7 @@ Content-Type: application/json\n         "locked": false,\n         "stealable": true\n     },\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {},\n     "parent": {\n         "@id": "http://localhost:55001/plone",\ndiff --git a/src/plone/restapi/tests/http-examples/expansion_expanded.resp b/src/plone/restapi/tests/http-examples/expansion_expanded.resp\nindex c12bb5121..f83d9dd69 100644\n--- a/src/plone/restapi/tests/http-examples/expansion_expanded.resp\n+++ b/src/plone/restapi/tests/http-examples/expansion_expanded.resp\n@@ -41,7 +41,7 @@ Content-Type: application/json\n     "allow_discussion": false,\n     "changeNote": "",\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -57,7 +57,7 @@ Content-Type: application/json\n         "locked": false,\n         "stealable": true\n     },\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {},\n     "parent": {\n         "@id": "http://localhost:55001/plone",\ndiff --git a/src/plone/restapi/tests/http-examples/expansion_expanded_full.resp b/src/plone/restapi/tests/http-examples/expansion_expanded_full.resp\nindex e504dae3b..2de0d7745 100644\n--- a/src/plone/restapi/tests/http-examples/expansion_expanded_full.resp\n+++ b/src/plone/restapi/tests/http-examples/expansion_expanded_full.resp\n@@ -235,7 +235,7 @@ Content-Type: application/json\n                     "actor": "test_user_1_",\n                     "comments": "",\n                     "review_state": "private",\n-                    "time": "1995-07-31T17:30:00",\n+                    "time": "1995-07-31T17:30:00+00:00",\n                     "title": "Private"\n                 }\n             ],\n@@ -261,7 +261,7 @@ Content-Type: application/json\n     "allow_discussion": false,\n     "changeNote": "",\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -277,7 +277,7 @@ Content-Type: application/json\n         "locked": false,\n         "stealable": true\n     },\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {},\n     "parent": {\n         "@id": "http://localhost:55001/plone",\ndiff --git a/src/plone/restapi/tests/http-examples/file.resp b/src/plone/restapi/tests/http-examples/file.resp\nindex efc75551c..4b463c60f 100644\n--- a/src/plone/restapi/tests/http-examples/file.resp\n+++ b/src/plone/restapi/tests/http-examples/file.resp\n@@ -33,7 +33,7 @@ Content-Type: application/json\n     "UID": "SomeUUID000000000000000000000002",\n     "allow_discussion": false,\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -52,7 +52,7 @@ Content-Type: application/json\n     "language": "",\n     "layout": "file_view",\n     "lock": {},\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {},\n     "parent": {\n         "@id": "http://localhost:55001/plone",\ndiff --git a/src/plone/restapi/tests/http-examples/folder.resp b/src/plone/restapi/tests/http-examples/folder.resp\nindex b2aac1e5d..7a41f8227 100644\n--- a/src/plone/restapi/tests/http-examples/folder.resp\n+++ b/src/plone/restapi/tests/http-examples/folder.resp\n@@ -33,7 +33,7 @@ Content-Type: application/json\n     "UID": "SomeUUID000000000000000000000002",\n     "allow_discussion": false,\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -65,7 +65,7 @@ Content-Type: application/json\n     "language": "",\n     "layout": "listing_view",\n     "lock": {},\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "nextPreviousEnabled": false,\n     "next_item": {},\n     "parent": {\ndiff --git a/src/plone/restapi/tests/http-examples/history_get.resp b/src/plone/restapi/tests/http-examples/history_get.resp\nindex 7819c1085..9b3aae1c1 100644\n--- a/src/plone/restapi/tests/http-examples/history_get.resp\n+++ b/src/plone/restapi/tests/http-examples/history_get.resp\n@@ -13,7 +13,7 @@ Content-Type: application/json\n         },\n         "comments": "Initial version",\n         "may_revert": true,\n-        "time": "1995-07-31T17:30:00Z",\n+        "time": "1995-07-31T17:30:00+00:00",\n         "transition_title": "Edited",\n         "type": "versioning",\n         "version": 0\n@@ -29,7 +29,7 @@ Content-Type: application/json\n         "comments": "",\n         "review_state": "private",\n         "state_title": "Private",\n-        "time": "1995-07-31T18:30:00Z",\n+        "time": "1995-07-31T18:30:00+00:00",\n         "transition_title": "Create",\n         "type": "workflow"\n     }\ndiff --git a/src/plone/restapi/tests/http-examples/image.resp b/src/plone/restapi/tests/http-examples/image.resp\nindex 4dfb1ad45..c2e13cbd1 100644\n--- a/src/plone/restapi/tests/http-examples/image.resp\n+++ b/src/plone/restapi/tests/http-examples/image.resp\n@@ -33,7 +33,7 @@ Content-Type: application/json\n     "UID": "SomeUUID000000000000000000000002",\n     "allow_discussion": false,\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -111,7 +111,7 @@ Content-Type: application/json\n     "language": "",\n     "layout": "image_view",\n     "lock": {},\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {},\n     "parent": {\n         "@id": "http://localhost:55001/plone",\ndiff --git a/src/plone/restapi/tests/http-examples/link.resp b/src/plone/restapi/tests/http-examples/link.resp\nindex 7f6165b77..76d990359 100644\n--- a/src/plone/restapi/tests/http-examples/link.resp\n+++ b/src/plone/restapi/tests/http-examples/link.resp\n@@ -34,7 +34,7 @@ Content-Type: application/json\n     "allow_discussion": false,\n     "changeNote": "",\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -47,7 +47,7 @@ Content-Type: application/json\n     "language": "",\n     "layout": "link_redirect_view",\n     "lock": {},\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {},\n     "parent": {\n         "@id": "http://localhost:55001/plone",\ndiff --git a/src/plone/restapi/tests/http-examples/lock.resp b/src/plone/restapi/tests/http-examples/lock.resp\nindex 28cdc4d5a..bd896add6 100644\n--- a/src/plone/restapi/tests/http-examples/lock.resp\n+++ b/src/plone/restapi/tests/http-examples/lock.resp\n@@ -2,7 +2,7 @@ HTTP/1.1 200 OK\n Content-Type: application/json\n \n {\n-    "created": "1995-07-31T17:30:00Z",\n+    "created": "1995-07-31T17:30:00+00:00",\n     "creator": "admin",\n     "creator_name": "admin",\n     "creator_url": "http://localhost:55001/plone/author/admin",\ndiff --git a/src/plone/restapi/tests/http-examples/lock_nonstealable_timeout.resp b/src/plone/restapi/tests/http-examples/lock_nonstealable_timeout.resp\nindex 61c7ecd9a..04bc7b80f 100644\n--- a/src/plone/restapi/tests/http-examples/lock_nonstealable_timeout.resp\n+++ b/src/plone/restapi/tests/http-examples/lock_nonstealable_timeout.resp\n@@ -2,7 +2,7 @@ HTTP/1.1 200 OK\n Content-Type: application/json\n \n {\n-    "created": "1995-07-31T17:30:00Z",\n+    "created": "1995-07-31T17:30:00+00:00",\n     "creator": "admin",\n     "creator_name": "admin",\n     "creator_url": "http://localhost:55001/plone/author/admin",\ndiff --git a/src/plone/restapi/tests/http-examples/navroot_lang_content_get.resp b/src/plone/restapi/tests/http-examples/navroot_lang_content_get.resp\nindex a6ff5e542..d537815af 100644\n--- a/src/plone/restapi/tests/http-examples/navroot_lang_content_get.resp\n+++ b/src/plone/restapi/tests/http-examples/navroot_lang_content_get.resp\n@@ -38,7 +38,7 @@ Content-Type: application/json\n         "UID": "00000000000000000000000000000001",\n         "allow_discussion": false,\n         "contributors": [],\n-        "created": "1995-07-31T13:45:00",\n+        "created": "1995-07-31T13:45:00+00:00",\n         "creators": [\n             "admin"\n         ],\n@@ -73,7 +73,7 @@ Content-Type: application/json\n         },\n         "layout": "folder_listing",\n         "lock": {},\n-        "modified": "1995-07-31T17:30:00",\n+        "modified": "1995-07-31T17:30:00+00:00",\n         "next_item": {\n             "@id": "http://localhost:55001/plone/de",\n             "@type": "LRF",\ndiff --git a/src/plone/restapi/tests/http-examples/navroot_lang_folder_get.resp b/src/plone/restapi/tests/http-examples/navroot_lang_folder_get.resp\nindex 0b506e7ac..801625f6d 100644\n--- a/src/plone/restapi/tests/http-examples/navroot_lang_folder_get.resp\n+++ b/src/plone/restapi/tests/http-examples/navroot_lang_folder_get.resp\n@@ -38,7 +38,7 @@ Content-Type: application/json\n         "UID": "00000000000000000000000000000001",\n         "allow_discussion": false,\n         "contributors": [],\n-        "created": "1995-07-31T13:45:00",\n+        "created": "1995-07-31T13:45:00+00:00",\n         "creators": [\n             "admin"\n         ],\n@@ -73,7 +73,7 @@ Content-Type: application/json\n         },\n         "layout": "folder_listing",\n         "lock": {},\n-        "modified": "1995-07-31T17:30:00",\n+        "modified": "1995-07-31T17:30:00+00:00",\n         "next_item": {\n             "@id": "http://localhost:55001/plone/de",\n             "@type": "LRF",\ndiff --git a/src/plone/restapi/tests/http-examples/navroot_standard_site_content_get_expansion.resp b/src/plone/restapi/tests/http-examples/navroot_standard_site_content_get_expansion.resp\nindex abfbe7e93..a421c0b00 100644\n--- a/src/plone/restapi/tests/http-examples/navroot_standard_site_content_get_expansion.resp\n+++ b/src/plone/restapi/tests/http-examples/navroot_standard_site_content_get_expansion.resp\n@@ -104,7 +104,7 @@ Content-Type: application/json\n     "allow_discussion": false,\n     "changeNote": "",\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -120,7 +120,7 @@ Content-Type: application/json\n         "locked": false,\n         "stealable": true\n     },\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {},\n     "parent": {\n         "@id": "http://localhost:55001/plone",\ndiff --git a/src/plone/restapi/tests/http-examples/newsitem.resp b/src/plone/restapi/tests/http-examples/newsitem.resp\nindex 061808823..e1dab847d 100644\n--- a/src/plone/restapi/tests/http-examples/newsitem.resp\n+++ b/src/plone/restapi/tests/http-examples/newsitem.resp\n@@ -34,7 +34,7 @@ Content-Type: application/json\n     "allow_discussion": false,\n     "changeNote": "",\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -116,7 +116,7 @@ Content-Type: application/json\n         "locked": false,\n         "stealable": true\n     },\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {},\n     "parent": {\n         "@id": "http://localhost:55001/plone",\ndiff --git a/src/plone/restapi/tests/http-examples/refresh_lock.resp b/src/plone/restapi/tests/http-examples/refresh_lock.resp\nindex 28cdc4d5a..bd896add6 100644\n--- a/src/plone/restapi/tests/http-examples/refresh_lock.resp\n+++ b/src/plone/restapi/tests/http-examples/refresh_lock.resp\n@@ -2,7 +2,7 @@ HTTP/1.1 200 OK\n Content-Type: application/json\n \n {\n-    "created": "1995-07-31T17:30:00Z",\n+    "created": "1995-07-31T17:30:00+00:00",\n     "creator": "admin",\n     "creator_name": "admin",\n     "creator_url": "http://localhost:55001/plone/author/admin",\ndiff --git a/src/plone/restapi/tests/http-examples/search_fullobjects.resp b/src/plone/restapi/tests/http-examples/search_fullobjects.resp\nindex 12674a345..5c9fe7ebf 100644\n--- a/src/plone/restapi/tests/http-examples/search_fullobjects.resp\n+++ b/src/plone/restapi/tests/http-examples/search_fullobjects.resp\n@@ -37,7 +37,7 @@ Content-Type: application/json\n             "allow_discussion": false,\n             "changeNote": "",\n             "contributors": [],\n-            "created": "1995-07-31T13:45:00",\n+            "created": "1995-07-31T13:45:00+00:00",\n             "creators": [\n                 "test_user_1_"\n             ],\n@@ -53,7 +53,7 @@ Content-Type: application/json\n                 "locked": false,\n                 "stealable": true\n             },\n-            "modified": "1995-07-31T17:30:00",\n+            "modified": "1995-07-31T17:30:00+00:00",\n             "next_item": {},\n             "parent": {\n                 "@id": "http://localhost:55001/plone",\ndiff --git a/src/plone/restapi/tests/http-examples/search_metadata_fields.resp b/src/plone/restapi/tests/http-examples/search_metadata_fields.resp\nindex f53b26707..b0a99393b 100644\n--- a/src/plone/restapi/tests/http-examples/search_metadata_fields.resp\n+++ b/src/plone/restapi/tests/http-examples/search_metadata_fields.resp\n@@ -7,9 +7,9 @@ Content-Type: application/json\n         {\n             "@id": "http://localhost:55001/plone/doc1",\n             "@type": "Document",\n-            "created": "1995-07-31T13:45:00",\n+            "created": "1995-07-31T13:45:00+00:00",\n             "description": "",\n-            "modified": "1995-07-31T17:30:00",\n+            "modified": "1995-07-31T17:30:00+00:00",\n             "review_state": "private",\n             "title": "Lorem Ipsum",\n             "type_title": "Page"\ndiff --git a/src/plone/restapi/tests/http-examples/site_get_expand_lang_folder.resp b/src/plone/restapi/tests/http-examples/site_get_expand_lang_folder.resp\nindex cbdda29f6..4d636bc25 100644\n--- a/src/plone/restapi/tests/http-examples/site_get_expand_lang_folder.resp\n+++ b/src/plone/restapi/tests/http-examples/site_get_expand_lang_folder.resp\n@@ -55,7 +55,7 @@ Content-Type: application/json\n                 "UID": "00000000000000000000000000000001",\n                 "allow_discussion": false,\n                 "contributors": [],\n-                "created": "1995-07-31T13:45:00",\n+                "created": "1995-07-31T13:45:00+00:00",\n                 "creators": [\n                     "admin"\n                 ],\n@@ -90,7 +90,7 @@ Content-Type: application/json\n                 },\n                 "layout": "folder_listing",\n                 "lock": {},\n-                "modified": "1995-07-31T17:30:00",\n+                "modified": "1995-07-31T17:30:00+00:00",\n                 "next_item": {\n                     "@id": "http://localhost:55001/plone/de",\n                     "@type": "LRF",\n@@ -131,7 +131,7 @@ Content-Type: application/json\n     "UID": "00000000000000000000000000000001",\n     "allow_discussion": false,\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "admin"\n     ],\n@@ -166,7 +166,7 @@ Content-Type: application/json\n     },\n     "layout": "folder_listing",\n     "lock": {},\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {\n         "@id": "http://localhost:55001/plone/de",\n         "@type": "LRF",\ndiff --git a/src/plone/restapi/tests/http-examples/site_get_expand_lang_folder_content.resp b/src/plone/restapi/tests/http-examples/site_get_expand_lang_folder_content.resp\nindex fdd9f28b6..9d4058231 100644\n--- a/src/plone/restapi/tests/http-examples/site_get_expand_lang_folder_content.resp\n+++ b/src/plone/restapi/tests/http-examples/site_get_expand_lang_folder_content.resp\n@@ -55,7 +55,7 @@ Content-Type: application/json\n                 "UID": "00000000000000000000000000000001",\n                 "allow_discussion": false,\n                 "contributors": [],\n-                "created": "1995-07-31T13:45:00",\n+                "created": "1995-07-31T13:45:00+00:00",\n                 "creators": [\n                     "admin"\n                 ],\n@@ -90,7 +90,7 @@ Content-Type: application/json\n                 },\n                 "layout": "folder_listing",\n                 "lock": {},\n-                "modified": "1995-07-31T17:30:00",\n+                "modified": "1995-07-31T17:30:00+00:00",\n                 "next_item": {\n                     "@id": "http://localhost:55001/plone/de",\n                     "@type": "LRF",\n@@ -132,7 +132,7 @@ Content-Type: application/json\n     "allow_discussion": false,\n     "changeNote": "",\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -151,7 +151,7 @@ Content-Type: application/json\n         "locked": false,\n         "stealable": true\n     },\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {},\n     "parent": {\n         "@id": "http://localhost:55001/plone/en",\ndiff --git a/src/plone/restapi/tests/http-examples/translated_messages_object_history.resp b/src/plone/restapi/tests/http-examples/translated_messages_object_history.resp\nindex d691c98e3..af91bed83 100644\n--- a/src/plone/restapi/tests/http-examples/translated_messages_object_history.resp\n+++ b/src/plone/restapi/tests/http-examples/translated_messages_object_history.resp\n@@ -13,7 +13,7 @@ Content-Type: application/json\n         },\n         "comments": "Versi\\u00f3n inicial",\n         "may_revert": true,\n-        "time": "1995-07-31T17:30:00Z",\n+        "time": "1995-07-31T17:30:00+00:00",\n         "transition_title": "Editado",\n         "type": "versioning",\n         "version": 0\n@@ -29,7 +29,7 @@ Content-Type: application/json\n         "comments": "",\n         "review_state": "private",\n         "state_title": "Privado",\n-        "time": "1995-07-31T18:30:00Z",\n+        "time": "1995-07-31T18:30:00+00:00",\n         "transition_title": "Crear",\n         "type": "workflow"\n     }\ndiff --git a/src/plone/restapi/tests/http-examples/translated_messages_object_workflow.resp b/src/plone/restapi/tests/http-examples/translated_messages_object_workflow.resp\nindex 4d4b4fdda..f910df32b 100644\n--- a/src/plone/restapi/tests/http-examples/translated_messages_object_workflow.resp\n+++ b/src/plone/restapi/tests/http-examples/translated_messages_object_workflow.resp\n@@ -9,7 +9,7 @@ Content-Type: application/json\n             "actor": "test_user_1_",\n             "comments": "",\n             "review_state": "private",\n-            "time": "1995-07-31T17:30:00",\n+            "time": "1995-07-31T17:30:00+00:00",\n             "title": "Privado"\n         }\n     ],\ndiff --git a/src/plone/restapi/tests/http-examples/translations_link_on_post.resp b/src/plone/restapi/tests/http-examples/translations_link_on_post.resp\nindex 1a7755fb8..798d35219 100644\n--- a/src/plone/restapi/tests/http-examples/translations_link_on_post.resp\n+++ b/src/plone/restapi/tests/http-examples/translations_link_on_post.resp\n@@ -38,7 +38,7 @@ Location: http://localhost:55001/plone/de/mydocument\n     "allow_discussion": false,\n     "changeNote": "",\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "admin"\n     ],\n@@ -57,7 +57,7 @@ Location: http://localhost:55001/plone/de/mydocument\n         "locked": false,\n         "stealable": true\n     },\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {},\n     "parent": {\n         "@id": "http://localhost:55001/plone/de",\ndiff --git a/src/plone/restapi/tests/http-examples/workflow_get.resp b/src/plone/restapi/tests/http-examples/workflow_get.resp\nindex 0236890e4..40627dcc2 100644\n--- a/src/plone/restapi/tests/http-examples/workflow_get.resp\n+++ b/src/plone/restapi/tests/http-examples/workflow_get.resp\n@@ -9,7 +9,7 @@ Content-Type: application/json\n             "actor": "test_user_1_",\n             "comments": "",\n             "review_state": "private",\n-            "time": "1995-07-31T17:30:00",\n+            "time": "1995-07-31T17:30:00+00:00",\n             "title": "Private"\n         }\n     ],\ndiff --git a/src/plone/restapi/tests/http-examples/workflow_post.resp b/src/plone/restapi/tests/http-examples/workflow_post.resp\nindex 2d41b826c..a637868bc 100644\n--- a/src/plone/restapi/tests/http-examples/workflow_post.resp\n+++ b/src/plone/restapi/tests/http-examples/workflow_post.resp\n@@ -6,6 +6,6 @@ Content-Type: application/json\n     "actor": "admin",\n     "comments": "",\n     "review_state": "published",\n-    "time": "1995-07-31T18:30:00",\n+    "time": "1995-07-31T18:30:00+00:00",\n     "title": "Published with accent \\u00e9"\n }\ndiff --git a/src/plone/restapi/tests/http-examples/workflow_post_with_body.resp b/src/plone/restapi/tests/http-examples/workflow_post_with_body.resp\nindex 480352c9a..02e08a0ec 100644\n--- a/src/plone/restapi/tests/http-examples/workflow_post_with_body.resp\n+++ b/src/plone/restapi/tests/http-examples/workflow_post_with_body.resp\n@@ -6,6 +6,6 @@ Content-Type: application/json\n     "actor": "admin",\n     "comments": "Publishing my folder...",\n     "review_state": "published",\n-    "time": "1995-07-31T18:30:00",\n+    "time": "1995-07-31T18:30:00+00:00",\n     "title": "Published with accent \\u00e9"\n }\ndiff --git a/src/plone/restapi/tests/http-examples/workingcopy_baseline_get.resp b/src/plone/restapi/tests/http-examples/workingcopy_baseline_get.resp\nindex 632f563ad..32a97febf 100644\n--- a/src/plone/restapi/tests/http-examples/workingcopy_baseline_get.resp\n+++ b/src/plone/restapi/tests/http-examples/workingcopy_baseline_get.resp\n@@ -33,7 +33,7 @@ Content-Type: application/json\n     "UID": "SomeUUID000000000000000000000001",\n     "allow_discussion": false,\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -46,7 +46,7 @@ Content-Type: application/json\n     "language": "",\n     "layout": "document_view",\n     "lock": {\n-        "created": "1995-07-31T17:30:00Z",\n+        "created": "1995-07-31T17:30:00+00:00",\n         "creator": "admin",\n         "creator_name": "admin",\n         "creator_url": "http://localhost:55001/plone/author/admin",\n@@ -57,7 +57,7 @@ Content-Type: application/json\n         "timeout": 4294967280,\n         "token": "0.12345678901234567-0.98765432109876543-00105A989226:1630609830.249"\n     },\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {\n         "@id": "http://localhost:55001/plone/copy_of_document",\n         "@type": "Document",\n@@ -84,7 +84,7 @@ Content-Type: application/json\n     "version": "current",\n     "working_copy": {\n         "@id": "http://localhost:55001/plone/copy_of_document",\n-        "created": "1995-07-31T13:45:00",\n+        "created": "1995-07-31T13:45:00+00:00",\n         "creator_name": "admin",\n         "creator_url": "http://localhost:55001/plone/author/admin",\n         "title": "Test document"\ndiff --git a/src/plone/restapi/tests/http-examples/workingcopy_get.resp b/src/plone/restapi/tests/http-examples/workingcopy_get.resp\nindex 27b37f44b..b41b07c4d 100644\n--- a/src/plone/restapi/tests/http-examples/workingcopy_get.resp\n+++ b/src/plone/restapi/tests/http-examples/workingcopy_get.resp\n@@ -4,7 +4,7 @@ Content-Type: application/json\n {\n     "working_copy": {\n         "@id": "http://localhost:55001/plone/copy_of_document",\n-        "created": "1995-07-31T13:45:00",\n+        "created": "1995-07-31T13:45:00+00:00",\n         "creator_name": "admin",\n         "creator_url": "http://localhost:55001/plone/author/admin",\n         "title": "Test document"\ndiff --git a/src/plone/restapi/tests/http-examples/workingcopy_wc_get.resp b/src/plone/restapi/tests/http-examples/workingcopy_wc_get.resp\nindex aa76ec7ac..08598e4e2 100644\n--- a/src/plone/restapi/tests/http-examples/workingcopy_wc_get.resp\n+++ b/src/plone/restapi/tests/http-examples/workingcopy_wc_get.resp\n@@ -33,7 +33,7 @@ Content-Type: application/json\n     "UID": "SomeUUID000000000000000000000002",\n     "allow_discussion": false,\n     "contributors": [],\n-    "created": "1995-07-31T13:45:00",\n+    "created": "1995-07-31T13:45:00+00:00",\n     "creators": [\n         "test_user_1_"\n     ],\n@@ -49,7 +49,7 @@ Content-Type: application/json\n         "locked": false,\n         "stealable": true\n     },\n-    "modified": "1995-07-31T17:30:00",\n+    "modified": "1995-07-31T17:30:00+00:00",\n     "next_item": {},\n     "parent": {\n         "@id": "http://localhost:55001/plone",\n@@ -76,7 +76,7 @@ Content-Type: application/json\n     "version": "current",\n     "working_copy": {\n         "@id": "http://localhost:55001/plone/copy_of_document",\n-        "created": "1995-07-31T13:45:00",\n+        "created": "1995-07-31T13:45:00+00:00",\n         "creator_name": "admin",\n         "creator_url": "http://localhost:55001/plone/author/admin",\n         "title": "Test document"\ndiff --git a/src/plone/restapi/tests/statictime.py b/src/plone/restapi/tests/statictime.py\nindex 55fddc6e7..6357c1966 100644\n--- a/src/plone/restapi/tests/statictime.py\n+++ b/src/plone/restapi/tests/statictime.py\n@@ -1,4 +1,5 @@\n from datetime import datetime\n+from datetime import timezone\n from DateTime import DateTime\n from plone.app.discussion.comment import Comment\n from plone.app.layout.viewlets.content import ContentHistoryViewlet\n@@ -70,8 +71,8 @@ def __exit__(self, _type, exc, _traceback):\n \n     def __init__(\n         self,\n-        created=datetime(1995, 7, 31, 13, 45),\n-        modified=datetime(1995, 7, 31, 17, 30),\n+        created=datetime(1995, 7, 31, 13, 45, tzinfo=timezone.utc),\n+        modified=datetime(1995, 7, 31, 17, 30, tzinfo=timezone.utc),\n     ):\n         self.static_created = created\n         self.static_modified = modified\n'

