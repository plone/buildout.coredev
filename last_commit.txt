Repository: Products.CMFPlone


Branch: refs/heads/5.2.x
Date: 2020-07-02T14:26:25+02:00
Author: Vincent Fretin (vincentfretin) <vincent.fretin@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/a436a8b80e69ce75bed825a7ab0b1453e58b2fbe

Fix an issue in mail_password_template.pt in the message showing the ip to really try the request.REMOTE_ADDR variable if request.HTTP_X_FORWARDED_FOR is empty (when you're not behind apache or nginx).

Files changed:
A news/2949.bugfix
M Products/CMFPlone/browser/login/templates/mail_password_template.pt

b'diff --git a/Products/CMFPlone/browser/login/templates/mail_password_template.pt b/Products/CMFPlone/browser/login/templates/mail_password_template.pt\nindex 646740709b..d5e7ecfd9e 100644\n--- a/Products/CMFPlone/browser/login/templates/mail_password_template.pt\n+++ b/Products/CMFPlone/browser/login/templates/mail_password_template.pt\n@@ -33,7 +33,7 @@ The following link will take you to a page where you can reset your password for\n      i18n:translate="mailtemplate_tracking_information"\n      tal:condition="isAnon">\n If you didn\'t expect to receive this email, please ignore it. Your password has not been changed.\n-Request made from IP address <tal:i18n tal:define="host request/HTTP_X_FORWARDED_FOR|request/REMOTE_ADDR"\n+Request made from IP address <tal:i18n tal:define="host python:request.HTTP_X_FORWARDED_FOR or request.REMOTE_ADDR"\n           tal:content="host"\n           i18n:name="ipaddress" />\n </tal:i18n>\ndiff --git a/news/2949.bugfix b/news/2949.bugfix\nnew file mode 100644\nindex 0000000000..4793471c35\n--- /dev/null\n+++ b/news/2949.bugfix\n@@ -0,0 +1,2 @@\n+Fix an issue in mail_password_template.pt in the message showing the ip to really try the request.REMOTE_ADDR variable if request.HTTP_X_FORWARDED_FOR is empty (when you\'re not behind apache or nginx).\n+[vincentfretin]\n'

Repository: Products.CMFPlone


Branch: refs/heads/5.2.x
Date: 2020-07-02T21:35:11+02:00
Author: Maurits van Rees (mauritsvanrees) <m.van.rees@zestsoftware.nl>
Commit: https://github.com/plone/Products.CMFPlone/commit/55736352def6b0d585d2fdf2d4e8b0f8d0099ece

Merge pull request #3140 from plone/fix-remote-addr

Fix tal expression to get the ip in mail_password_template.pt

Files changed:
A news/2949.bugfix
M Products/CMFPlone/browser/login/templates/mail_password_template.pt

b'diff --git a/Products/CMFPlone/browser/login/templates/mail_password_template.pt b/Products/CMFPlone/browser/login/templates/mail_password_template.pt\nindex 646740709b..d5e7ecfd9e 100644\n--- a/Products/CMFPlone/browser/login/templates/mail_password_template.pt\n+++ b/Products/CMFPlone/browser/login/templates/mail_password_template.pt\n@@ -33,7 +33,7 @@ The following link will take you to a page where you can reset your password for\n      i18n:translate="mailtemplate_tracking_information"\n      tal:condition="isAnon">\n If you didn\'t expect to receive this email, please ignore it. Your password has not been changed.\n-Request made from IP address <tal:i18n tal:define="host request/HTTP_X_FORWARDED_FOR|request/REMOTE_ADDR"\n+Request made from IP address <tal:i18n tal:define="host python:request.HTTP_X_FORWARDED_FOR or request.REMOTE_ADDR"\n           tal:content="host"\n           i18n:name="ipaddress" />\n </tal:i18n>\ndiff --git a/news/2949.bugfix b/news/2949.bugfix\nnew file mode 100644\nindex 0000000000..4793471c35\n--- /dev/null\n+++ b/news/2949.bugfix\n@@ -0,0 +1,2 @@\n+Fix an issue in mail_password_template.pt in the message showing the ip to really try the request.REMOTE_ADDR variable if request.HTTP_X_FORWARDED_FOR is empty (when you\'re not behind apache or nginx).\n+[vincentfretin]\n'

