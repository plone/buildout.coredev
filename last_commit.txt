Repository: plone.restapi


Branch: refs/heads/main
Date: 2023-09-21T20:24:27+02:00
Author: Timo Stollenwerk (tisto) <tisto@users.noreply.github.com>
Commit: https://github.com/plone/plone.restapi/commit/4398aad066be2ad1b076466004f4be974351d79f

Plone 6.0.7 (#1706)

* Upgrade to Plone 6.0.7

* Update documentation tests after upgrade to Plone 6.0.7

* Upgrade requirements to Plone 6.0.7 as well

* Add towncrier entry

* comment out sphinxbuilder and sphinx-python on base.cfg to debug GHA

* Upgrade from Plone 5.2.12 to 5.2.14

* No need to pin plone.rest to 3.0.0 for Plone 5.2 any longer

* Re-add plone.rest pin to version 3.

* Pass content_type when updating portrait

---------

Co-authored-by: David Glick &lt;david@glicksoftware.com&gt;

Files changed:
A news/1706.internal
M base.cfg
M plone-5.2.x.cfg
M plone-6.0.x.cfg
M requirements-5.2.txt
M requirements-6.0.txt
M src/plone/restapi/services/users/update.py
M src/plone/restapi/tests/http-examples/registry_get_list.resp

b'diff --git a/base.cfg b/base.cfg\nindex c34253a09..a1b05f41b 100644\n--- a/base.cfg\n+++ b/base.cfg\n@@ -9,8 +9,8 @@ parts =\n     dependencies\n     update-translations\n     find-untranslated\n-    sphinxbuilder\n-    sphinx-python\n+#    sphinxbuilder\n+#    sphinx-python\n     deploy-to-heroku\n     omelette\n     zpretty\ndiff --git a/news/1706.internal b/news/1706.internal\nnew file mode 100644\nindex 000000000..28ce56820\n--- /dev/null\n+++ b/news/1706.internal\n@@ -0,0 +1 @@\n+- Upgrade buildout: Plone 6.0.6 -> 6.0.7 and Plone 5.2.12 -> 5.2.14 @tisto\n\\ No newline at end of file\ndiff --git a/plone-5.2.x.cfg b/plone-5.2.x.cfg\nindex 4c0929114..158b669f2 100644\n--- a/plone-5.2.x.cfg\n+++ b/plone-5.2.x.cfg\n@@ -1,10 +1,10 @@\n [buildout]\n extends =\n-    https://dist.plone.org/release/5.2.12/versions.cfg\n+    https://dist.plone.org/release/5.2.14/versions.cfg\n     base.cfg\n \n [versions]\n black = 22.3.0\n \n-# Use the newest plone.rest\n-plone.rest = 3.0.0\n+# we need the newest plone.rest release\n+plone.rest = 3.0.1\n\\ No newline at end of file\ndiff --git a/plone-6.0.x.cfg b/plone-6.0.x.cfg\nindex 9f51f9e92..b29740736 100644\n--- a/plone-6.0.x.cfg\n+++ b/plone-6.0.x.cfg\n@@ -1,6 +1,6 @@\n [buildout]\n extends =\n-    https://dist.plone.org/release/6.0.6/versions.cfg\n+    https://dist.plone.org/release/6.0.7/versions.cfg\n     base.cfg\n \n [buildout:python37]\ndiff --git a/requirements-5.2.txt b/requirements-5.2.txt\nindex f2e443e3f..fccf56f7a 100644\n--- a/requirements-5.2.txt\n+++ b/requirements-5.2.txt\n@@ -1,2 +1,2 @@\n--r https://dist.plone.org/release/5.2.12/requirements.txt\n+-r https://dist.plone.org/release/5.2.14/requirements.txt\n zpretty\ndiff --git a/requirements-6.0.txt b/requirements-6.0.txt\nindex 7d4750742..dcd3abcf1 100644\n--- a/requirements-6.0.txt\n+++ b/requirements-6.0.txt\n@@ -1 +1 @@\n--r https://dist.plone.org/release/6.0.6/requirements.txt\n+-r https://dist.plone.org/release/6.0.7/requirements.txt\ndiff --git a/src/plone/restapi/services/users/update.py b/src/plone/restapi/services/users/update.py\nindex c89dd0b03..0e07d69d0 100644\n--- a/src/plone/restapi/services/users/update.py\n+++ b/src/plone/restapi/services/users/update.py\n@@ -185,6 +185,6 @@ def set_member_portrait(self, user, portrait):\n             # frontend\n             scaled = data\n \n-        portrait = Image(id=safe_id, file=scaled, title="")\n+        portrait = Image(id=safe_id, file=scaled, title="", content_type=content_type)\n         membertool = getToolByName(self, "portal_memberdata")\n         membertool._setPortrait(portrait, safe_id)\ndiff --git a/src/plone/restapi/tests/http-examples/registry_get_list.resp b/src/plone/restapi/tests/http-examples/registry_get_list.resp\nindex dbc4259ef..daaee85fa 100644\n--- a/src/plone/restapi/tests/http-examples/registry_get_list.resp\n+++ b/src/plone/restapi/tests/http-examples/registry_get_list.resp\n@@ -6,7 +6,7 @@ Content-Type: application/json\n     "batching": {\n         "@id": "http://localhost:55001/plone/@registry",\n         "first": "http://localhost:55001/plone/@registry?b_start=0",\n-        "last": "http://localhost:55001/plone/@registry?b_start=2850",\n+        "last": "http://localhost:55001/plone/@registry?b_start=2950",\n         "next": "http://localhost:55001/plone/@registry?b_start=25"\n     },\n     "items": [\n@@ -423,5 +423,5 @@ Content-Type: application/json\n             "value": "The person that created an item"\n         }\n     ],\n-    "items_total": 2875\n+    "items_total": 2972\n }\n'

