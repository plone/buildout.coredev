Repository: plone.releaser


Branch: refs/heads/master
Date: 2024-05-07T12:14:17+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.releaser/commit/0c6aa2a88ae4e506acd5337ab5a27c88cd02233a

Catch error when trying to change coredev branches.

Not everyone may have the branches available, or there may be some problem with it.
Fixes https://github.com/plone/plone.releaser/issues/67

Files changed:
A news/67.bugfix
M plone/releaser/release.py

b'diff --git a/news/67.bugfix b/news/67.bugfix\nnew file mode 100644\nindex 0000000..7e586dc\n--- /dev/null\n+++ b/news/67.bugfix\n@@ -0,0 +1,2 @@\n+Catch error when trying to change coredev branches.\n+Not everyone may have the branches available, or there may be some problem with it.\ndiff --git a/plone/releaser/release.py b/plone/releaser/release.py\nindex 3027a6f..6d90a40 100644\n--- a/plone/releaser/release.py\n+++ b/plone/releaser/release.py\n@@ -271,7 +271,15 @@ def _get_package_branch(package_name):\n \n     g = git.Git(root_path)\n     for branch_name in CORE_BRANCHES:\n-        g.checkout(branch_name)\n+        try:\n+            g.checkout(branch_name)\n+        except git.exc.GitCommandError:\n+            print(\n+                f"WARNING: There was an error checking out coredev branch "\n+                f"{branch_name}. This means we cannot check if this branch needs an "\n+                f"update for {package_name}. Please check manually."\n+            )\n+            continue\n \n         package_branch = _get_package_branch(package_name=package_name)\n         if package_branch == reference_package_branch:\n'

Repository: plone.releaser


Branch: refs/heads/master
Date: 2024-05-09T11:19:25+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.releaser/commit/2568b397dad87ba40a1e34016d80473b6aafff17

Merge pull request #68 from plone/maurits-issue-67

Catch error when trying to change coredev branches.

Files changed:
A news/67.bugfix
M plone/releaser/release.py

b'diff --git a/news/67.bugfix b/news/67.bugfix\nnew file mode 100644\nindex 0000000..7e586dc\n--- /dev/null\n+++ b/news/67.bugfix\n@@ -0,0 +1,2 @@\n+Catch error when trying to change coredev branches.\n+Not everyone may have the branches available, or there may be some problem with it.\ndiff --git a/plone/releaser/release.py b/plone/releaser/release.py\nindex 01767b6..2a92c2b 100644\n--- a/plone/releaser/release.py\n+++ b/plone/releaser/release.py\n@@ -255,7 +255,15 @@ def _get_package_branch(package_name):\n \n     g = git.Git(root_path)\n     for branch_name in CORE_BRANCHES:\n-        g.checkout(branch_name)\n+        try:\n+            g.checkout(branch_name)\n+        except git.exc.GitCommandError:\n+            print(\n+                f"WARNING: There was an error checking out coredev branch "\n+                f"{branch_name}. This means we cannot check if this branch needs an "\n+                f"update for {package_name}. Please check manually."\n+            )\n+            continue\n \n         package_branch = _get_package_branch(package_name=package_name)\n         if package_branch == reference_package_branch:\n'

