Repository: Products.CMFPlone


Branch: refs/heads/5.2.x
Date: 2020-06-29T11:56:41-03:00
Author: Franco Pellegrini (frapell) <frapell@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/429269a450cfe4e6e4c2e4e4b7336ec871b4a389

mail_password form: Do not crash if the userid is not provided or the user doesn't have an email configured

Files changed:
A news/3008.bugfix
M Products/CMFPlone/browser/login/mail_password.py

b"diff --git a/Products/CMFPlone/browser/login/mail_password.py b/Products/CMFPlone/browser/login/mail_password.py\nindex 63dda4b135..670eacff48 100644\n--- a/Products/CMFPlone/browser/login/mail_password.py\n+++ b/Products/CMFPlone/browser/login/mail_password.py\n@@ -8,6 +8,7 @@\n class MailPasswordView(BrowserView):\n \n     def __call__(self):\n+        response = None\n         try:\n             response = self.context.portal_registration.mailPassword(\n                 self.request.form.get('userid', ''),\n@@ -22,6 +23,6 @@ def __call__(self):\n                 raise e\n             IStatusMessage(self.request).add(msg)\n             self.request.response.redirect(\n-                self.context.absolute_url() + 'mail_password_form'\n+                self.context.absolute_url() + '/mail_password_form'\n             )\n         return response\ndiff --git a/news/3008.bugfix b/news/3008.bugfix\nnew file mode 100644\nindex 0000000000..fced4379fc\n--- /dev/null\n+++ b/news/3008.bugfix\n@@ -0,0 +1,2 @@\n+mail_password form: Do not crash if the userid is not provided or the user doesn't have an email configured\n+[frapell]\n"

Repository: Products.CMFPlone


Branch: refs/heads/5.2.x
Date: 2020-07-02T14:16:41+02:00
Author: Vincent Fretin (vincentfretin) <vincent.fretin@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/b7f0e80529b3e1c21185e18e1f471f81317253cd

Merge pull request #3133 from plone/frapell-mail_password_form

Fix crash on the mail_password_form page when no userid is given

Files changed:
A news/3008.bugfix
M Products/CMFPlone/browser/login/mail_password.py

b"diff --git a/Products/CMFPlone/browser/login/mail_password.py b/Products/CMFPlone/browser/login/mail_password.py\nindex 63dda4b135..670eacff48 100644\n--- a/Products/CMFPlone/browser/login/mail_password.py\n+++ b/Products/CMFPlone/browser/login/mail_password.py\n@@ -8,6 +8,7 @@\n class MailPasswordView(BrowserView):\n \n     def __call__(self):\n+        response = None\n         try:\n             response = self.context.portal_registration.mailPassword(\n                 self.request.form.get('userid', ''),\n@@ -22,6 +23,6 @@ def __call__(self):\n                 raise e\n             IStatusMessage(self.request).add(msg)\n             self.request.response.redirect(\n-                self.context.absolute_url() + 'mail_password_form'\n+                self.context.absolute_url() + '/mail_password_form'\n             )\n         return response\ndiff --git a/news/3008.bugfix b/news/3008.bugfix\nnew file mode 100644\nindex 0000000000..fced4379fc\n--- /dev/null\n+++ b/news/3008.bugfix\n@@ -0,0 +1,2 @@\n+mail_password form: Do not crash if the userid is not provided or the user doesn't have an email configured\n+[frapell]\n"

