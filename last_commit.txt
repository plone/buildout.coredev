Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2024-03-05T11:19:01+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.contenttypes/commit/c26b396ce0dee31c11abab244a7762d2b02865fa

Fix ILeadImageBehavior and IRichTextBehavior interfaces were the name change was forgotten.

Files changed:
A news/681.bugfix
M CHANGES.rst
M docs/README.rst
M plone/app/contenttypes/behaviors/viewlets.py
M plone/app/contenttypes/indexers.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 5156f68e..2d016261 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -456,7 +456,7 @@ Bug fixes:\n New features:\n \n \n-- Support ILeadImage behavior when display collection album view.\n+- Support ILeadImageBehavior when display collection album view.\n   [rodfersou] (#524)\n - Add more log-messages during migration from AT to DX.\n   [pbauer] (#526)\n@@ -535,7 +535,7 @@ Bug fixes:\n \n Breaking changes:\n \n-- ILeadImage and IRichText behaviors now have proper "Marker"-Interfaces.\n+- ILeadImageBehavior and IRichTextBehavior behaviors now have proper "Marker"-Interfaces.\n   As this was only possible by renaming the schema adapter to *Behavior* to\n   not break with implementations inside the collective, the FTI-behavior-definition\n   has changed:\ndiff --git a/docs/README.rst b/docs/README.rst\nindex b3af8b62..84ad8b02 100644\n--- a/docs/README.rst\n+++ b/docs/README.rst\n@@ -79,7 +79,7 @@ You have several options:\n     <?xml version="1.0"?>\n     <object name="Folder" meta_type="Dexterity FTI">\n      <property name="behaviors" purge="False">\n-      <element value="plone.app.contenttypes.behaviors.leadimage.ILeadImage"/>\n+      <element value="plone.leadimage"/>\n      </property>\n     </object>\n \n@@ -91,7 +91,7 @@ You have several options:\n     <object name="Folder" meta_type="Dexterity FTI">\n      <property name="model_file">your.package.content:folder.xml</property>\n      <property name="behaviors" purge="False">\n-      <element value="plone.app.contenttypes.behaviors.leadimage.ILeadImage"/>\n+      <element value="plone.leadimage"/>\n      </property>\n     </object>\n \ndiff --git a/news/681.bugfix b/news/681.bugfix\nnew file mode 100644\nindex 00000000..31d52626\n--- /dev/null\n+++ b/news/681.bugfix\n@@ -0,0 +1,2 @@\n+Fix ILeadImageBehavior and IRichTextBehavior interfaces were the name change was forgotten.\n+[thet]\ndiff --git a/plone/app/contenttypes/behaviors/viewlets.py b/plone/app/contenttypes/behaviors/viewlets.py\nindex eb38dbb2..8fe6a8de 100644\n--- a/plone/app/contenttypes/behaviors/viewlets.py\n+++ b/plone/app/contenttypes/behaviors/viewlets.py\n@@ -1,4 +1,4 @@\n-from plone.app.contenttypes.behaviors.leadimage import ILeadImage\n+from plone.app.contenttypes.behaviors.leadimage import ILeadImageBehavior\n from plone.app.layout.viewlets import ViewletBase\n \n \n@@ -6,5 +6,5 @@ class LeadImageViewlet(ViewletBase):\n     """A simple viewlet which renders leadimage"""\n \n     def update(self):\n-        self.context = ILeadImage(self.context)\n-        self.available = True if self.context.image else False\n+        behavior = ILeadImageBehavior(self.context)\n+        self.available = True if behavior.image else False\ndiff --git a/plone/app/contenttypes/indexers.py b/plone/app/contenttypes/indexers.py\nindex a4e49517..973dfe83 100644\n--- a/plone/app/contenttypes/indexers.py\n+++ b/plone/app/contenttypes/indexers.py\n@@ -1,6 +1,6 @@\n from Acquisition import aq_base\n from logging import getLogger\n-from plone.app.contenttypes.behaviors.richtext import IRichText\n+from plone.app.contenttypes.behaviors.richtext import IRichTextBehavior\n from plone.app.contenttypes.interfaces import ICollection\n from plone.app.contenttypes.interfaces import IDocument\n from plone.app.contenttypes.interfaces import IFile\n@@ -40,7 +40,7 @@ def _unicode_save_string_concat(*args):\n \n def SearchableText(obj):\n     text = ""\n-    richtext = IRichText(obj, None)\n+    richtext = IRichTextBehavior(obj, None)\n     if richtext:\n         textvalue = richtext.text\n         if IRichTextValue.providedBy(textvalue):\n'

Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2024-04-24T01:01:43+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.contenttypes/commit/4d0a239ff4aa28bf104ac2234ee8d0b9ac5b934e

Merge pull request #681 from plone/fix-behavior-interfaces

Fix ILeadImageBehavior and IRichTextBehavior interfaces were the name change was forgotten.

Files changed:
A news/681.bugfix
M CHANGES.rst
M docs/README.rst
M plone/app/contenttypes/behaviors/viewlets.py
M plone/app/contenttypes/indexers.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex bf7fc568c..b637b7362 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -473,7 +473,7 @@ Bug fixes:\n New features:\n \n \n-- Support ILeadImage behavior when display collection album view.\n+- Support ILeadImageBehavior when display collection album view.\n   [rodfersou] (#524)\n - Add more log-messages during migration from AT to DX.\n   [pbauer] (#526)\n@@ -552,7 +552,7 @@ Bug fixes:\n \n Breaking changes:\n \n-- ILeadImage and IRichText behaviors now have proper "Marker"-Interfaces.\n+- ILeadImageBehavior and IRichTextBehavior behaviors now have proper "Marker"-Interfaces.\n   As this was only possible by renaming the schema adapter to *Behavior* to\n   not break with implementations inside the collective, the FTI-behavior-definition\n   has changed:\ndiff --git a/docs/README.rst b/docs/README.rst\nindex b3af8b623..84ad8b02a 100644\n--- a/docs/README.rst\n+++ b/docs/README.rst\n@@ -79,7 +79,7 @@ You have several options:\n     <?xml version="1.0"?>\n     <object name="Folder" meta_type="Dexterity FTI">\n      <property name="behaviors" purge="False">\n-      <element value="plone.app.contenttypes.behaviors.leadimage.ILeadImage"/>\n+      <element value="plone.leadimage"/>\n      </property>\n     </object>\n \n@@ -91,7 +91,7 @@ You have several options:\n     <object name="Folder" meta_type="Dexterity FTI">\n      <property name="model_file">your.package.content:folder.xml</property>\n      <property name="behaviors" purge="False">\n-      <element value="plone.app.contenttypes.behaviors.leadimage.ILeadImage"/>\n+      <element value="plone.leadimage"/>\n      </property>\n     </object>\n \ndiff --git a/news/681.bugfix b/news/681.bugfix\nnew file mode 100644\nindex 000000000..31d526267\n--- /dev/null\n+++ b/news/681.bugfix\n@@ -0,0 +1,2 @@\n+Fix ILeadImageBehavior and IRichTextBehavior interfaces were the name change was forgotten.\n+[thet]\ndiff --git a/plone/app/contenttypes/behaviors/viewlets.py b/plone/app/contenttypes/behaviors/viewlets.py\nindex eb38dbb25..8fe6a8def 100644\n--- a/plone/app/contenttypes/behaviors/viewlets.py\n+++ b/plone/app/contenttypes/behaviors/viewlets.py\n@@ -1,4 +1,4 @@\n-from plone.app.contenttypes.behaviors.leadimage import ILeadImage\n+from plone.app.contenttypes.behaviors.leadimage import ILeadImageBehavior\n from plone.app.layout.viewlets import ViewletBase\n \n \n@@ -6,5 +6,5 @@ class LeadImageViewlet(ViewletBase):\n     """A simple viewlet which renders leadimage"""\n \n     def update(self):\n-        self.context = ILeadImage(self.context)\n-        self.available = True if self.context.image else False\n+        behavior = ILeadImageBehavior(self.context)\n+        self.available = True if behavior.image else False\ndiff --git a/plone/app/contenttypes/indexers.py b/plone/app/contenttypes/indexers.py\nindex a4e495178..973dfe83b 100644\n--- a/plone/app/contenttypes/indexers.py\n+++ b/plone/app/contenttypes/indexers.py\n@@ -1,6 +1,6 @@\n from Acquisition import aq_base\n from logging import getLogger\n-from plone.app.contenttypes.behaviors.richtext import IRichText\n+from plone.app.contenttypes.behaviors.richtext import IRichTextBehavior\n from plone.app.contenttypes.interfaces import ICollection\n from plone.app.contenttypes.interfaces import IDocument\n from plone.app.contenttypes.interfaces import IFile\n@@ -40,7 +40,7 @@ def _unicode_save_string_concat(*args):\n \n def SearchableText(obj):\n     text = ""\n-    richtext = IRichText(obj, None)\n+    richtext = IRichTextBehavior(obj, None)\n     if richtext:\n         textvalue = richtext.text\n         if IRichTextValue.providedBy(textvalue):\n'

