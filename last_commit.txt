Repository: Products.MimetypesRegistry


Branch: refs/heads/master
Date: 2023-10-14T13:26:56+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.MimetypesRegistry/commit/1ba089f76f224cc412999cb4b2192cf5d862ee46

Configuring with plone/meta

Files changed:
A .flake8
A .github/workflows/meta.yml
A news/cfffba8c.internal
M .editorconfig
M .gitignore
M .meta.toml
M .pre-commit-config.yaml
M pyproject.toml
M tox.ini

b'diff --git a/.editorconfig b/.editorconfig\nindex b4158b8..919b411 100644\n--- a/.editorconfig\n+++ b/.editorconfig\n@@ -1,5 +1,6 @@\n # Generated from:\n # https://github.com/plone/meta/tree/master/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n #\n # EditorConfig Configuration file, for more details see:\n # http://EditorConfig.org\n@@ -32,8 +33,21 @@ indent_size = 4\n # 2 space indentation\n indent_size = 2\n \n+[*.{json,jsonl,js,jsx,ts,tsx,css,less,scss,html}]  # Frontend development\n+# 2 space indentation\n+indent_size = 2\n+\n [{Makefile,.gitmodules}]\n # Tab indentation (no size specified, but view as 4 spaces)\n indent_style = tab\n indent_size = unset\n tab_width = unset\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [editorconfig]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/.flake8 b/.flake8\nnew file mode 100644\nindex 0000000..7ef4f64\n--- /dev/null\n+++ b/.flake8\n@@ -0,0 +1,22 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+[flake8]\n+doctests = 1\n+ignore =\n+    # black takes care of line length\n+    E501,\n+    # black takes care of where to break lines\n+    W503,\n+    # black takes care of spaces within slicing (list[:])\n+    E203,\n+    # black takes care of spaces after commas\n+    E231,\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [flake8]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/.github/workflows/meta.yml b/.github/workflows/meta.yml\nnew file mode 100644\nindex 0000000..a7f25e0\n--- /dev/null\n+++ b/.github/workflows/meta.yml\n@@ -0,0 +1,28 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+name: Meta\n+on:\n+  push:\n+    branches:\n+      - master\n+      - main\n+  pull_request:\n+    branches:\n+      - master\n+      - main\n+  workflow_dispatch:\n+\n+jobs:\n+  qa:\n+    uses: plone/meta/.github/workflows/qa.yml@main\n+  test:\n+    uses: plone/meta/.github/workflows/test.yml@main\n+  coverage:\n+    uses: plone/meta/.github/workflows/coverage.yml@main\n+  dependencies:\n+    uses: plone/meta/.github/workflows/dependencies.yml@main\n+  release-ready:\n+    uses: plone/meta/.github/workflows/release_ready.yml@main\n+  circular:\n+    uses: plone/meta/.github/workflows/circular.yml@main\ndiff --git a/.gitignore b/.gitignore\nindex 18f4ad7..81594fd 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -1,13 +1,51 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+# python related\n *.egg-info\n-*.mo\n *.pyc\n *.pyo\n-dist\n-Products/MimetypesRegistry/mime_types/freedesktop.org.xml.bin\n+\n+# tools related\n+build/\n+.coverage\n+coverage.xml\n+dist/\n+docs/_build\n+__pycache__/\n+.tox\n+.vscode/\n+node_modules/\n+\n+# venv / buildout related\n bin/\n-lib/\n-include/\n-parts\n-develop-eggs\n+develop-eggs/\n+eggs/\n+.eggs/\n+etc/\n .installed.cfg\n+include/\n+lib/\n+lib64\n+.mr.developer.cfg\n+parts/\n+pyvenv.cfg\n+var/\n+\n+# mxdev\n+/instance/\n+/.make-sentinels/\n+/*-mxdev.txt\n+/reports/\n+/sources/\n+/venv/\n+.installed.txt\n+\n \n+##\n+# Add extra configuration options in .meta.toml:\n+#  [gitignore]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/.meta.toml b/.meta.toml\nindex 1b2346d..f6d3f7d 100644\n--- a/.meta.toml\n+++ b/.meta.toml\n@@ -1,5 +1,20 @@\n # Generated from:\n # https://github.com/plone/meta/tree/master/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n [meta]\n template = "default"\n-commit-id = "5cc689e5"\n+commit-id = "cfffba8c"\n+\n+[pre_commit]\n+zpretty_extra_lines = """\n+        exclude: Products/MimetypesRegistry/mime_types/freedesktop.org.xml\n+"""\n+codespell_extra_lines = """\n+        exclude: (freedesktop.org.xml|mime.types)\n+"""\n+\n+[pyproject]\n+dependencies_mappings = [\n+    "\'pywin32\' = [\'win32api\', \'win32con\']",\n+    ]\n+dependencies_ignores = "[\'pywin32\', \'win32api\', \'win32con\']"\ndiff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nindex 4615486..8e80f60 100644\n--- a/.pre-commit-config.yaml\n+++ b/.pre-commit-config.yaml\n@@ -1,5 +1,6 @@\n # Generated from:\n # https://github.com/plone/meta/tree/master/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n ci:\n     autofix_prs: false\n     autoupdate_schedule: monthly\n@@ -23,10 +24,26 @@ repos:\n     hooks:\n     -   id: zpretty\n         exclude: Products/MimetypesRegistry/mime_types/freedesktop.org.xml\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  zpretty_extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n -   repo: https://github.com/PyCQA/flake8\n     rev: 6.1.0\n     hooks:\n     -   id: flake8\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  flake8_extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n -   repo: https://github.com/codespell-project/codespell\n     rev: v2.2.6\n     hooks:\n@@ -34,6 +51,14 @@ repos:\n         additional_dependencies:\n           - tomli\n         exclude: (freedesktop.org.xml|mime.types)\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  codespell_extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n -   repo: https://github.com/mgedmin/check-manifest\n     rev: "0.49"\n     hooks:\n@@ -42,3 +67,20 @@ repos:\n     rev: "4.2"\n     hooks:\n     -   id: pyroma\n+-   repo: https://github.com/mgedmin/check-python-versions\n+    rev: "0.21.2"\n+    hooks:\n+    -   id: check-python-versions\n+        args: [\'--only\', \'setup.py,pyproject.toml\']\n+-   repo: https://github.com/collective/i18ndude\n+    rev: "6.0.0"\n+    hooks:\n+    -   id: i18ndude\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/news/cfffba8c.internal b/news/cfffba8c.internal\nnew file mode 100644\nindex 0000000..c08f539\n--- /dev/null\n+++ b/news/cfffba8c.internal\n@@ -0,0 +1,2 @@\n+Update configuration files.\n+[plone devs]\ndiff --git a/pyproject.toml b/pyproject.toml\nindex e4eafcf..245076d 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -1,8 +1,9 @@\n # Generated from:\n # https://github.com/plone/meta/tree/master/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n [tool.towncrier]\n-filename = "CHANGES.rst"\n directory = "news/"\n+filename = "CHANGES.rst"\n title_format = "{version} ({project_date})"\n underlines = ["-", ""]\n \n@@ -36,12 +37,46 @@ directory = "tests"\n name = "Tests"\n showcontent = true\n \n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  towncrier_extra_lines = """\n+#  extra_configuration\n+#  """\n+##\n+\n [tool.isort]\n profile = "plone"\n \n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  isort_extra_lines = """\n+#  extra_configuration\n+#  """\n+##\n+\n [tool.black]\n target-version = ["py38"]\n \n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  black_extra_lines = """\n+#  extra_configuration\n+#  """\n+##\n+\n+[tool.codespell]\n+ignore-words-list = "discreet,"\n+skip = "*.po,"\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  codespell_ignores = "foo,bar"\n+#  codespell_skip = "*.po,*.map,package-lock.json"\n+##\n+\n [tool.dependencychecker]\n Zope = [\n   # Zope own provided namespaces\n@@ -54,7 +89,7 @@ Zope = [\n   \'AccessControl\', \'Acquisition\', \'AuthEncoding\', \'beautifulsoup4\', \'BTrees\',\n   \'cffi\', \'Chameleon\', \'DateTime\', \'DocumentTemplate\',\n   \'MultiMapping\', \'multipart\', \'PasteDeploy\', \'Persistence\', \'persistent\',\n-  \'pycparser\', \'python-gettext\', \'pytz\', \'RestrictedPython\', \'roman\', \'six\',\n+  \'pycparser\', \'python-gettext\', \'pytz\', \'RestrictedPython\', \'roman\',\n   \'soupsieve\', \'transaction\', \'waitress\', \'WebOb\', \'WebTest\', \'WSGIProxy2\',\n   \'z3c.pt\', \'zc.lockfile\', \'ZConfig\', \'zExceptions\', \'ZODB\', \'zodbpickle\',\n   \'zope.annotation\', \'zope.browser\', \'zope.browsermenu\', \'zope.browserpage\',\n@@ -81,4 +116,44 @@ Zope = [\n   \'Products.CMFCore\', \'Products.CMFDynamicViewFTI\',\n ]\n python-dateutil = [\'dateutil\']\n-pywin32 = [\'win32api\', \'win32con\']\n+ignore-packages = [\'pywin32\', \'win32api\', \'win32con\']\n+\'pywin32\' = [\'win32api\', \'win32con\']\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  dependencies_ignores = "[\'zestreleaser.towncrier\']"\n+#  dependencies_mappings = [\n+#    "gitpython = [\'git\']",\n+#    "pygithub = [\'github\']",\n+#  ]\n+#  """\n+##\n+\n+[tool.check-manifest]\n+ignore = [\n+    ".editorconfig",\n+    ".meta.toml",\n+    ".pre-commit-config.yaml",\n+    "tox.ini",\n+    ".flake8",\n+    "mx.ini",\n+\n+]\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  check_manifest_ignores = """\n+#      "*.map.js",\n+#      "*.pyc",\n+#  """\n+##\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/tox.ini b/tox.ini\nindex 1dde591..22dc436 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -1,16 +1,36 @@\n # Generated from:\n # https://github.com/plone/meta/tree/master/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n [tox]\n # We need 4.4.0 for constrain_package_deps.\n min_version = 4.4.0\n envlist =\n-    format\n     lint\n     test\n+    dependencies\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [tox]\n+#  envlist_lines = """\n+#      my_other_environment\n+#  """\n+#  config_lines = """\n+#  my_extra_top_level_tox_configuration_lines\n+#  """\n+##\n \n [testenv]\n+skip_install = true\n allowlist_externals =\n-    sh\n+    echo\n+    false\n+# Make sure typos like `tox -e formaat` are caught instead of silently doing nothing.\n+# See https://github.com/tox-dev/tox/issues/2858.\n+commands =\n+    echo "Unrecognized environment name {envname}"\n+    false\n \n [testenv:format]\n description = automatically reformat code\n@@ -32,37 +52,138 @@ commands =\n     pre-commit run -a\n \n [testenv:dependencies]\n-description = check if the package defines all its dependencies and generate a graph out of them\n+description = check if the package defines all its dependencies\n+skip_install = true\n deps =\n+    build\n     z3c.dependencychecker==2.11\n+commands =\n+    python -m build --sdist --no-isolation\n+    dependencychecker\n+\n+[testenv:dependencies-graph]\n+description = generate a graph out of the dependencies of the package\n+skip_install = false\n+allowlist_externals =\n+    sh\n+deps =\n     pipdeptree==2.5.1\n     graphviz  # optional dependency of pipdeptree\n commands =\n-    dependencychecker\n-    sh -c \'pipdeptree --exclude setuptools,wheel,pipdeptree,z3c.dependencychecker,zope.interface,zope.component --graph-output svg > dependencies.svg\'\n+    sh -c \'pipdeptree --exclude setuptools,wheel,pipdeptree,zope.interface,zope.component --graph-output svg > dependencies.svg\'\n \n [testenv:test]\n-usedevelop = true\n+description = run the distribution tests\n+use_develop = true\n+skip_install = false\n constrain_package_deps = true\n-set_env = ROBOT_BROWSER=headlesschrome\n+set_env =\n+    ROBOT_BROWSER=headlesschrome\n+\n+##\n+# Specify extra test environment variables in .meta.toml:\n+#  [tox]\n+#  test_environment_variables = """\n+#      PIP_EXTRA_INDEX_URL=https://my-pypi.my-server.com/\n+#  """\n+##\n deps =\n     zope.testrunner\n     -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+##\n+# Specify a custom constraints file in .meta.toml:\n+#  [tox]\n+#  constraints_file = "https://my-server.com/constraints.txt"\n+##\n commands =\n     zope-testrunner --all --test-path={toxinidir} -s Products.MimetypesRegistry {posargs}\n extras =\n     test\n \n+##\n+# Add extra configuration options in .meta.toml:\n+#  [tox]\n+#  test_extras = """\n+#      tests\n+#      widgets\n+#  """\n+##\n+\n [testenv:coverage]\n-usedevelop = true\n+description = get a test coverage report\n+use_develop = true\n+skip_install = false\n constrain_package_deps = true\n-set_env = ROBOT_BROWSER=headlesschrome\n+set_env =\n+    ROBOT_BROWSER=headlesschrome\n+\n+##\n+# Specify extra test environment variables in .meta.toml:\n+#  [tox]\n+#  test_environment_variables = """\n+#      PIP_EXTRA_INDEX_URL=https://my-pypi.my-server.com/\n+#  """\n+##\n deps =\n     coverage\n     zope.testrunner\n     -c https://dist.plone.org/release/6.0-dev/constraints.txt\n commands =\n-    coverage run {envbindir}/zope-testrunner --all --test-path={toxinidir} -s Products.MimetypesRegistry {posargs}\n+    coverage run --branch --source Products.MimetypesRegistry {envbindir}/zope-testrunner --quiet --all --test-path={toxinidir} -s Products.MimetypesRegistry {posargs}\n     coverage report -m --format markdown\n+    coverage xml\n extras =\n     test\n+\n+\n+[testenv:release-check]\n+description = ensure that the distribution is ready to release\n+skip_install = true\n+deps =\n+    twine\n+    build\n+    towncrier\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    # fake version to not have to install the package\n+    # we build the change log as news entries might break\n+    # the README that is displayed on PyPI\n+    towncrier build --version=100.0.0 --yes\n+    python -m build --sdist --no-isolation\n+    twine check dist/*\n+\n+[testenv:circular]\n+description = ensure there are no cyclic dependencies\n+use_develop = true\n+skip_install = false\n+set_env =\n+\n+##\n+# Specify extra test environment variables in .meta.toml:\n+#  [tox]\n+#  test_environment_variables = """\n+#      PIP_EXTRA_INDEX_URL=https://my-pypi.my-server.com/\n+#  """\n+##\n+allowlist_externals =\n+    sh\n+deps =\n+    pipdeptree\n+    pipforester\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    # Generate the full dependency tree\n+    sh -c \'pipdeptree -j > forest.json\'\n+    # Generate a DOT graph with the circular dependencies, if any\n+    pipforester -i forest.json -o forest.dot --cycles\n+    # Report if there are any circular dependencies, i.e. error if there are any\n+    pipforester -i forest.json --check-cycles -o /dev/null\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [tox]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n'

Repository: Products.MimetypesRegistry


Branch: refs/heads/master
Date: 2023-10-14T13:57:01+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.MimetypesRegistry/commit/6a87b818ef6e12fd311bb35baa919fb36e8d5964

cleanup: remove unused file

Files changed:
D setup.cfg

b'diff --git a/setup.cfg b/setup.cfg\ndeleted file mode 100644\nindex 0da8f8f..0000000\n--- a/setup.cfg\n+++ /dev/null\n@@ -1,23 +0,0 @@\n-# Generated from:\n-# https://github.com/plone/meta/tree/master/config/default\n-[bdist_wheel]\n-universal = 0\n-\n-[flake8]\n-doctests = 1\n-ignore =\n-    # black takes care of line length\n-    E501,\n-    # black takes care of where to break lines\n-    W503,\n-    # black takes care of spaces within slicing (list[:])\n-    E203,\n-    # black takes care of spaces after commas\n-    E231,\n-\n-[check-manifest]\n-ignore =\n-    .editorconfig\n-    .meta.toml\n-    .pre-commit-config.yaml\n-    tox.ini\n'

Repository: Products.MimetypesRegistry


Branch: refs/heads/master
Date: 2023-10-14T13:57:01+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.MimetypesRegistry/commit/a5853089cb0100e2d311fe51552913476d6bcbcd

fix: adjust setup.py

Files changed:
M setup.py

b'diff --git a/setup.py b/setup.py\nindex 6ab8ba3..8985bd8 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -1,14 +1,22 @@\n+from pathlib import Path\n from setuptools import find_packages\n from setuptools import setup\n \n \n version = "3.0.1.dev0"\n \n+long_description = (\n+    f"{Path(\'README.rst\').read_text()}\\n{Path(\'CHANGES.rst\').read_text()}"\n+)\n+\n setup(\n     name="Products.MimetypesRegistry",\n     version=version,\n     description="MIME type handling for Zope",\n-    long_description=open("README.rst").read() + "\\n" + open("CHANGES.rst").read(),\n+    long_description=long_description,\n+    long_description_content_type="text/x-rst",\n+    # Get more strings from\n+    # https://pypi.org/classifiers/\n     classifiers=[\n         "Development Status :: 5 - Production/Stable",\n         "Framework :: Zope :: 5",\n'

Repository: Products.MimetypesRegistry


Branch: refs/heads/master
Date: 2023-10-14T13:57:01+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.MimetypesRegistry/commit/5d0eb5a651aecdf81f5e100fd5b918daf460bd7f

fix: mark strings for translation

Files changed:
M Products/MimetypesRegistry/www/addMimeType.zpt
M Products/MimetypesRegistry/www/editMimeType.zpt
M Products/MimetypesRegistry/www/listMimeTypes.zpt

b'diff --git a/Products/MimetypesRegistry/www/addMimeType.zpt b/Products/MimetypesRegistry/www/addMimeType.zpt\nindex 5d6a9b3..300d1a3 100644\n--- a/Products/MimetypesRegistry/www/addMimeType.zpt\n+++ b/Products/MimetypesRegistry/www/addMimeType.zpt\n@@ -12,7 +12,9 @@\n         action string:${here/absolute_url}/manage_addMimeType;\n       "\n >\n-  <div class="form-title">\n+  <div class="form-title"\n+       i18n:translate=""\n+  >\n     Add a new mime type\n   </div>\n \n@@ -26,7 +28,9 @@\n \n   <table width="50%">\n     <tr>\n-      <td class="form-label">Name</td>\n+      <td class="form-label"\n+          i18n:translate=""\n+      >Name</td>\n       <td class="form-element">\n         <input name="id"\n                tal:attributes="\n@@ -35,7 +39,9 @@\n         />\n       </td>\n     </tr><tr>\n-      <td class="form-label">Icon path</td>\n+      <td class="form-label"\n+          i18n:translate=""\n+      >Icon path</td>\n       <td class="form-element">\n         <input name="icon_path"\n                tal:attributes="\n@@ -44,7 +50,9 @@\n         />\n       </td>\n     </tr><tr>\n-      <td class="form-label">Binary?\n+      <td class="form-label"\n+          i18n:translate=""\n+      >Binary?\n       </td>\n       <td class="form-element">\n         <input name="binary"\n@@ -55,7 +63,9 @@\n         />\n       </td>\n     </tr><tr>\n-      <td class="form-label">Mime-types\n+      <td class="form-label"\n+          i18n:translate=""\n+      >Mime-types\n       </td>\n       <td class="form-element">\n         <textarea name="mimetypes:list"\n@@ -63,7 +73,9 @@\n         ></textarea>\n       </td>\n     </tr><tr>\n-      <td class="form-label">Extensions\n+      <td class="form-label"\n+          i18n:translate=""\n+      >Extensions\n       </td>\n       <td class="form-element">\n         <textarea name="extensions:list"\n@@ -71,7 +83,9 @@\n         ></textarea>\n       </td>\n     </tr><tr>\n-      <td class="form-label">Globs\n+      <td class="form-label"\n+          i18n:translate=""\n+      >Globs\n       </td>\n       <td class="form-element">\n         <textarea name="globs:list"\ndiff --git a/Products/MimetypesRegistry/www/editMimeType.zpt b/Products/MimetypesRegistry/www/editMimeType.zpt\nindex 4893251..48f5c47 100644\n--- a/Products/MimetypesRegistry/www/editMimeType.zpt\n+++ b/Products/MimetypesRegistry/www/editMimeType.zpt\n@@ -16,7 +16,9 @@\n       "\n >\n \n-  <div class="form-title">\n+  <div class="form-title"\n+       i18n:translate=""\n+  >\n     Edit mime type\n     <b tal:content="mt/name"></b>.\n   </div>\n@@ -38,7 +40,7 @@\n \n   <table width="50%">\n     <tr>\n-      <td>Name</td>\n+      <td i18n:translate="">Name</td>\n       <td>\n         <input name="new_name"\n                tal:attributes="\n@@ -47,7 +49,7 @@\n         />\n       </td>\n     </tr><tr>\n-      <td>Icon path</td>\n+      <td i18n:translate="">Icon path</td>\n       <td>\n         <input name="icon_path"\n                tal:attributes="\n@@ -56,7 +58,7 @@\n         />\n       </td>\n     </tr><tr>\n-      <td>Binary?\n+      <td i18n:translate="">Binary?\n       </td>\n       <td>\n         <input name="binary"\n@@ -67,7 +69,7 @@\n         />\n       </td>\n     </tr><tr>\n-      <td>Mime-types\n+      <td i18n:translate="">Mime-types\n       </td>\n       <td>\n         <textarea name="mimetypes"\n@@ -75,7 +77,7 @@\n         ></textarea>\n       </td>\n     </tr><tr>\n-      <td>Extensions\n+      <td i18n:translate="">Extensions\n       </td>\n       <td>\n         <textarea name="extensions"\n@@ -83,7 +85,7 @@\n         ></textarea>\n       </td>\n     </tr><tr>\n-      <td>Globs\n+      <td i18n:translate="">Globs\n       </td>\n       <td>\n         <textarea name="globs"\ndiff --git a/Products/MimetypesRegistry/www/listMimeTypes.zpt b/Products/MimetypesRegistry/www/listMimeTypes.zpt\nindex c09c66a..725dc06 100644\n--- a/Products/MimetypesRegistry/www/listMimeTypes.zpt\n+++ b/Products/MimetypesRegistry/www/listMimeTypes.zpt\n@@ -9,7 +9,9 @@\n              mimetypes here/list_mimetypes;\n            ">\n \n-  <div class="form-title">\n+  <div class="form-title"\n+       i18n:translate=""\n+  >\n     Registered MIME types (<span tal:replace="python:len(mimetypes)"></span>).\n   </div>\n \n@@ -19,6 +21,7 @@\n     >\n       <input type="submit"\n              value="Add a new MIME type"\n+             i18n:attributes="value"\n       />\n     </form>\n   </div>\n@@ -40,11 +43,13 @@\n \n     <table width="90%">\n       <tr class="form-label">\n-        <th colspan="3">Name</th>\n-        <th>Mime-types</th>\n-        <th>Extensions</th>\n-        <th>Globs</th>\n-        <th>Binary?</th>\n+        <th colspan="3"\n+            i18n:translate=""\n+        >Name</th>\n+        <th i18n:translate="">Mime-types</th>\n+        <th i18n:translate="">Extensions</th>\n+        <th i18n:translate="">Globs</th>\n+        <th i18n:translate="">Binary?</th>\n       </tr>\n \n       <tr class="form-element"\n@@ -83,6 +88,7 @@\n \n     <input type="submit"\n            value="Delete Selected Items"\n+           i18n:attributes="value"\n     />\n \n   </form>\n'

Repository: Products.MimetypesRegistry


Branch: refs/heads/master
Date: 2023-10-14T15:48:48+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.MimetypesRegistry/commit/a27d3d5f264e07dd95b22514470cd30acc9ac6df

Merge pull request #25 from plone/config-with-default-template-d5ff29ac

Config with default template

Files changed:
A .flake8
A .github/workflows/meta.yml
A news/cfffba8c.internal
M .editorconfig
M .gitignore
M .meta.toml
M .pre-commit-config.yaml
M Products/MimetypesRegistry/www/addMimeType.zpt
M Products/MimetypesRegistry/www/editMimeType.zpt
M Products/MimetypesRegistry/www/listMimeTypes.zpt
M pyproject.toml
M setup.py
M tox.ini
D setup.cfg

b'diff --git a/.editorconfig b/.editorconfig\nindex b4158b8..919b411 100644\n--- a/.editorconfig\n+++ b/.editorconfig\n@@ -1,5 +1,6 @@\n # Generated from:\n # https://github.com/plone/meta/tree/master/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n #\n # EditorConfig Configuration file, for more details see:\n # http://EditorConfig.org\n@@ -32,8 +33,21 @@ indent_size = 4\n # 2 space indentation\n indent_size = 2\n \n+[*.{json,jsonl,js,jsx,ts,tsx,css,less,scss,html}]  # Frontend development\n+# 2 space indentation\n+indent_size = 2\n+\n [{Makefile,.gitmodules}]\n # Tab indentation (no size specified, but view as 4 spaces)\n indent_style = tab\n indent_size = unset\n tab_width = unset\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [editorconfig]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/setup.cfg b/.flake8\nsimilarity index 62%\nrename from setup.cfg\nrename to .flake8\nindex 0da8f8f..7ef4f64 100644\n--- a/setup.cfg\n+++ b/.flake8\n@@ -1,8 +1,6 @@\n # Generated from:\n # https://github.com/plone/meta/tree/master/config/default\n-[bdist_wheel]\n-universal = 0\n-\n+# See the inline comments on how to expand/tweak this configuration file\n [flake8]\n doctests = 1\n ignore =\n@@ -15,9 +13,10 @@ ignore =\n     # black takes care of spaces after commas\n     E231,\n \n-[check-manifest]\n-ignore =\n-    .editorconfig\n-    .meta.toml\n-    .pre-commit-config.yaml\n-    tox.ini\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [flake8]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/.github/workflows/meta.yml b/.github/workflows/meta.yml\nnew file mode 100644\nindex 0000000..a7f25e0\n--- /dev/null\n+++ b/.github/workflows/meta.yml\n@@ -0,0 +1,28 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+name: Meta\n+on:\n+  push:\n+    branches:\n+      - master\n+      - main\n+  pull_request:\n+    branches:\n+      - master\n+      - main\n+  workflow_dispatch:\n+\n+jobs:\n+  qa:\n+    uses: plone/meta/.github/workflows/qa.yml@main\n+  test:\n+    uses: plone/meta/.github/workflows/test.yml@main\n+  coverage:\n+    uses: plone/meta/.github/workflows/coverage.yml@main\n+  dependencies:\n+    uses: plone/meta/.github/workflows/dependencies.yml@main\n+  release-ready:\n+    uses: plone/meta/.github/workflows/release_ready.yml@main\n+  circular:\n+    uses: plone/meta/.github/workflows/circular.yml@main\ndiff --git a/.gitignore b/.gitignore\nindex 18f4ad7..81594fd 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -1,13 +1,51 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/master/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+# python related\n *.egg-info\n-*.mo\n *.pyc\n *.pyo\n-dist\n-Products/MimetypesRegistry/mime_types/freedesktop.org.xml.bin\n+\n+# tools related\n+build/\n+.coverage\n+coverage.xml\n+dist/\n+docs/_build\n+__pycache__/\n+.tox\n+.vscode/\n+node_modules/\n+\n+# venv / buildout related\n bin/\n-lib/\n-include/\n-parts\n-develop-eggs\n+develop-eggs/\n+eggs/\n+.eggs/\n+etc/\n .installed.cfg\n+include/\n+lib/\n+lib64\n+.mr.developer.cfg\n+parts/\n+pyvenv.cfg\n+var/\n+\n+# mxdev\n+/instance/\n+/.make-sentinels/\n+/*-mxdev.txt\n+/reports/\n+/sources/\n+/venv/\n+.installed.txt\n+\n \n+##\n+# Add extra configuration options in .meta.toml:\n+#  [gitignore]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/.meta.toml b/.meta.toml\nindex 1b2346d..f6d3f7d 100644\n--- a/.meta.toml\n+++ b/.meta.toml\n@@ -1,5 +1,20 @@\n # Generated from:\n # https://github.com/plone/meta/tree/master/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n [meta]\n template = "default"\n-commit-id = "5cc689e5"\n+commit-id = "cfffba8c"\n+\n+[pre_commit]\n+zpretty_extra_lines = """\n+        exclude: Products/MimetypesRegistry/mime_types/freedesktop.org.xml\n+"""\n+codespell_extra_lines = """\n+        exclude: (freedesktop.org.xml|mime.types)\n+"""\n+\n+[pyproject]\n+dependencies_mappings = [\n+    "\'pywin32\' = [\'win32api\', \'win32con\']",\n+    ]\n+dependencies_ignores = "[\'pywin32\', \'win32api\', \'win32con\']"\ndiff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nindex 4615486..8e80f60 100644\n--- a/.pre-commit-config.yaml\n+++ b/.pre-commit-config.yaml\n@@ -1,5 +1,6 @@\n # Generated from:\n # https://github.com/plone/meta/tree/master/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n ci:\n     autofix_prs: false\n     autoupdate_schedule: monthly\n@@ -23,10 +24,26 @@ repos:\n     hooks:\n     -   id: zpretty\n         exclude: Products/MimetypesRegistry/mime_types/freedesktop.org.xml\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  zpretty_extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n -   repo: https://github.com/PyCQA/flake8\n     rev: 6.1.0\n     hooks:\n     -   id: flake8\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  flake8_extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n -   repo: https://github.com/codespell-project/codespell\n     rev: v2.2.6\n     hooks:\n@@ -34,6 +51,14 @@ repos:\n         additional_dependencies:\n           - tomli\n         exclude: (freedesktop.org.xml|mime.types)\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  codespell_extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n -   repo: https://github.com/mgedmin/check-manifest\n     rev: "0.49"\n     hooks:\n@@ -42,3 +67,20 @@ repos:\n     rev: "4.2"\n     hooks:\n     -   id: pyroma\n+-   repo: https://github.com/mgedmin/check-python-versions\n+    rev: "0.21.2"\n+    hooks:\n+    -   id: check-python-versions\n+        args: [\'--only\', \'setup.py,pyproject.toml\']\n+-   repo: https://github.com/collective/i18ndude\n+    rev: "6.0.0"\n+    hooks:\n+    -   id: i18ndude\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/Products/MimetypesRegistry/www/addMimeType.zpt b/Products/MimetypesRegistry/www/addMimeType.zpt\nindex 5d6a9b3..300d1a3 100644\n--- a/Products/MimetypesRegistry/www/addMimeType.zpt\n+++ b/Products/MimetypesRegistry/www/addMimeType.zpt\n@@ -12,7 +12,9 @@\n         action string:${here/absolute_url}/manage_addMimeType;\n       "\n >\n-  <div class="form-title">\n+  <div class="form-title"\n+       i18n:translate=""\n+  >\n     Add a new mime type\n   </div>\n \n@@ -26,7 +28,9 @@\n \n   <table width="50%">\n     <tr>\n-      <td class="form-label">Name</td>\n+      <td class="form-label"\n+          i18n:translate=""\n+      >Name</td>\n       <td class="form-element">\n         <input name="id"\n                tal:attributes="\n@@ -35,7 +39,9 @@\n         />\n       </td>\n     </tr><tr>\n-      <td class="form-label">Icon path</td>\n+      <td class="form-label"\n+          i18n:translate=""\n+      >Icon path</td>\n       <td class="form-element">\n         <input name="icon_path"\n                tal:attributes="\n@@ -44,7 +50,9 @@\n         />\n       </td>\n     </tr><tr>\n-      <td class="form-label">Binary?\n+      <td class="form-label"\n+          i18n:translate=""\n+      >Binary?\n       </td>\n       <td class="form-element">\n         <input name="binary"\n@@ -55,7 +63,9 @@\n         />\n       </td>\n     </tr><tr>\n-      <td class="form-label">Mime-types\n+      <td class="form-label"\n+          i18n:translate=""\n+      >Mime-types\n       </td>\n       <td class="form-element">\n         <textarea name="mimetypes:list"\n@@ -63,7 +73,9 @@\n         ></textarea>\n       </td>\n     </tr><tr>\n-      <td class="form-label">Extensions\n+      <td class="form-label"\n+          i18n:translate=""\n+      >Extensions\n       </td>\n       <td class="form-element">\n         <textarea name="extensions:list"\n@@ -71,7 +83,9 @@\n         ></textarea>\n       </td>\n     </tr><tr>\n-      <td class="form-label">Globs\n+      <td class="form-label"\n+          i18n:translate=""\n+      >Globs\n       </td>\n       <td class="form-element">\n         <textarea name="globs:list"\ndiff --git a/Products/MimetypesRegistry/www/editMimeType.zpt b/Products/MimetypesRegistry/www/editMimeType.zpt\nindex 4893251..48f5c47 100644\n--- a/Products/MimetypesRegistry/www/editMimeType.zpt\n+++ b/Products/MimetypesRegistry/www/editMimeType.zpt\n@@ -16,7 +16,9 @@\n       "\n >\n \n-  <div class="form-title">\n+  <div class="form-title"\n+       i18n:translate=""\n+  >\n     Edit mime type\n     <b tal:content="mt/name"></b>.\n   </div>\n@@ -38,7 +40,7 @@\n \n   <table width="50%">\n     <tr>\n-      <td>Name</td>\n+      <td i18n:translate="">Name</td>\n       <td>\n         <input name="new_name"\n                tal:attributes="\n@@ -47,7 +49,7 @@\n         />\n       </td>\n     </tr><tr>\n-      <td>Icon path</td>\n+      <td i18n:translate="">Icon path</td>\n       <td>\n         <input name="icon_path"\n                tal:attributes="\n@@ -56,7 +58,7 @@\n         />\n       </td>\n     </tr><tr>\n-      <td>Binary?\n+      <td i18n:translate="">Binary?\n       </td>\n       <td>\n         <input name="binary"\n@@ -67,7 +69,7 @@\n         />\n       </td>\n     </tr><tr>\n-      <td>Mime-types\n+      <td i18n:translate="">Mime-types\n       </td>\n       <td>\n         <textarea name="mimetypes"\n@@ -75,7 +77,7 @@\n         ></textarea>\n       </td>\n     </tr><tr>\n-      <td>Extensions\n+      <td i18n:translate="">Extensions\n       </td>\n       <td>\n         <textarea name="extensions"\n@@ -83,7 +85,7 @@\n         ></textarea>\n       </td>\n     </tr><tr>\n-      <td>Globs\n+      <td i18n:translate="">Globs\n       </td>\n       <td>\n         <textarea name="globs"\ndiff --git a/Products/MimetypesRegistry/www/listMimeTypes.zpt b/Products/MimetypesRegistry/www/listMimeTypes.zpt\nindex c09c66a..725dc06 100644\n--- a/Products/MimetypesRegistry/www/listMimeTypes.zpt\n+++ b/Products/MimetypesRegistry/www/listMimeTypes.zpt\n@@ -9,7 +9,9 @@\n              mimetypes here/list_mimetypes;\n            ">\n \n-  <div class="form-title">\n+  <div class="form-title"\n+       i18n:translate=""\n+  >\n     Registered MIME types (<span tal:replace="python:len(mimetypes)"></span>).\n   </div>\n \n@@ -19,6 +21,7 @@\n     >\n       <input type="submit"\n              value="Add a new MIME type"\n+             i18n:attributes="value"\n       />\n     </form>\n   </div>\n@@ -40,11 +43,13 @@\n \n     <table width="90%">\n       <tr class="form-label">\n-        <th colspan="3">Name</th>\n-        <th>Mime-types</th>\n-        <th>Extensions</th>\n-        <th>Globs</th>\n-        <th>Binary?</th>\n+        <th colspan="3"\n+            i18n:translate=""\n+        >Name</th>\n+        <th i18n:translate="">Mime-types</th>\n+        <th i18n:translate="">Extensions</th>\n+        <th i18n:translate="">Globs</th>\n+        <th i18n:translate="">Binary?</th>\n       </tr>\n \n       <tr class="form-element"\n@@ -83,6 +88,7 @@\n \n     <input type="submit"\n            value="Delete Selected Items"\n+           i18n:attributes="value"\n     />\n \n   </form>\ndiff --git a/news/cfffba8c.internal b/news/cfffba8c.internal\nnew file mode 100644\nindex 0000000..c08f539\n--- /dev/null\n+++ b/news/cfffba8c.internal\n@@ -0,0 +1,2 @@\n+Update configuration files.\n+[plone devs]\ndiff --git a/pyproject.toml b/pyproject.toml\nindex e4eafcf..245076d 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -1,8 +1,9 @@\n # Generated from:\n # https://github.com/plone/meta/tree/master/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n [tool.towncrier]\n-filename = "CHANGES.rst"\n directory = "news/"\n+filename = "CHANGES.rst"\n title_format = "{version} ({project_date})"\n underlines = ["-", ""]\n \n@@ -36,12 +37,46 @@ directory = "tests"\n name = "Tests"\n showcontent = true\n \n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  towncrier_extra_lines = """\n+#  extra_configuration\n+#  """\n+##\n+\n [tool.isort]\n profile = "plone"\n \n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  isort_extra_lines = """\n+#  extra_configuration\n+#  """\n+##\n+\n [tool.black]\n target-version = ["py38"]\n \n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  black_extra_lines = """\n+#  extra_configuration\n+#  """\n+##\n+\n+[tool.codespell]\n+ignore-words-list = "discreet,"\n+skip = "*.po,"\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  codespell_ignores = "foo,bar"\n+#  codespell_skip = "*.po,*.map,package-lock.json"\n+##\n+\n [tool.dependencychecker]\n Zope = [\n   # Zope own provided namespaces\n@@ -54,7 +89,7 @@ Zope = [\n   \'AccessControl\', \'Acquisition\', \'AuthEncoding\', \'beautifulsoup4\', \'BTrees\',\n   \'cffi\', \'Chameleon\', \'DateTime\', \'DocumentTemplate\',\n   \'MultiMapping\', \'multipart\', \'PasteDeploy\', \'Persistence\', \'persistent\',\n-  \'pycparser\', \'python-gettext\', \'pytz\', \'RestrictedPython\', \'roman\', \'six\',\n+  \'pycparser\', \'python-gettext\', \'pytz\', \'RestrictedPython\', \'roman\',\n   \'soupsieve\', \'transaction\', \'waitress\', \'WebOb\', \'WebTest\', \'WSGIProxy2\',\n   \'z3c.pt\', \'zc.lockfile\', \'ZConfig\', \'zExceptions\', \'ZODB\', \'zodbpickle\',\n   \'zope.annotation\', \'zope.browser\', \'zope.browsermenu\', \'zope.browserpage\',\n@@ -81,4 +116,44 @@ Zope = [\n   \'Products.CMFCore\', \'Products.CMFDynamicViewFTI\',\n ]\n python-dateutil = [\'dateutil\']\n-pywin32 = [\'win32api\', \'win32con\']\n+ignore-packages = [\'pywin32\', \'win32api\', \'win32con\']\n+\'pywin32\' = [\'win32api\', \'win32con\']\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  dependencies_ignores = "[\'zestreleaser.towncrier\']"\n+#  dependencies_mappings = [\n+#    "gitpython = [\'git\']",\n+#    "pygithub = [\'github\']",\n+#  ]\n+#  """\n+##\n+\n+[tool.check-manifest]\n+ignore = [\n+    ".editorconfig",\n+    ".meta.toml",\n+    ".pre-commit-config.yaml",\n+    "tox.ini",\n+    ".flake8",\n+    "mx.ini",\n+\n+]\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  check_manifest_ignores = """\n+#      "*.map.js",\n+#      "*.pyc",\n+#  """\n+##\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/setup.py b/setup.py\nindex 6ab8ba3..8985bd8 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -1,14 +1,22 @@\n+from pathlib import Path\n from setuptools import find_packages\n from setuptools import setup\n \n \n version = "3.0.1.dev0"\n \n+long_description = (\n+    f"{Path(\'README.rst\').read_text()}\\n{Path(\'CHANGES.rst\').read_text()}"\n+)\n+\n setup(\n     name="Products.MimetypesRegistry",\n     version=version,\n     description="MIME type handling for Zope",\n-    long_description=open("README.rst").read() + "\\n" + open("CHANGES.rst").read(),\n+    long_description=long_description,\n+    long_description_content_type="text/x-rst",\n+    # Get more strings from\n+    # https://pypi.org/classifiers/\n     classifiers=[\n         "Development Status :: 5 - Production/Stable",\n         "Framework :: Zope :: 5",\ndiff --git a/tox.ini b/tox.ini\nindex 1dde591..22dc436 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -1,16 +1,36 @@\n # Generated from:\n # https://github.com/plone/meta/tree/master/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n [tox]\n # We need 4.4.0 for constrain_package_deps.\n min_version = 4.4.0\n envlist =\n-    format\n     lint\n     test\n+    dependencies\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [tox]\n+#  envlist_lines = """\n+#      my_other_environment\n+#  """\n+#  config_lines = """\n+#  my_extra_top_level_tox_configuration_lines\n+#  """\n+##\n \n [testenv]\n+skip_install = true\n allowlist_externals =\n-    sh\n+    echo\n+    false\n+# Make sure typos like `tox -e formaat` are caught instead of silently doing nothing.\n+# See https://github.com/tox-dev/tox/issues/2858.\n+commands =\n+    echo "Unrecognized environment name {envname}"\n+    false\n \n [testenv:format]\n description = automatically reformat code\n@@ -32,37 +52,138 @@ commands =\n     pre-commit run -a\n \n [testenv:dependencies]\n-description = check if the package defines all its dependencies and generate a graph out of them\n+description = check if the package defines all its dependencies\n+skip_install = true\n deps =\n+    build\n     z3c.dependencychecker==2.11\n+commands =\n+    python -m build --sdist --no-isolation\n+    dependencychecker\n+\n+[testenv:dependencies-graph]\n+description = generate a graph out of the dependencies of the package\n+skip_install = false\n+allowlist_externals =\n+    sh\n+deps =\n     pipdeptree==2.5.1\n     graphviz  # optional dependency of pipdeptree\n commands =\n-    dependencychecker\n-    sh -c \'pipdeptree --exclude setuptools,wheel,pipdeptree,z3c.dependencychecker,zope.interface,zope.component --graph-output svg > dependencies.svg\'\n+    sh -c \'pipdeptree --exclude setuptools,wheel,pipdeptree,zope.interface,zope.component --graph-output svg > dependencies.svg\'\n \n [testenv:test]\n-usedevelop = true\n+description = run the distribution tests\n+use_develop = true\n+skip_install = false\n constrain_package_deps = true\n-set_env = ROBOT_BROWSER=headlesschrome\n+set_env =\n+    ROBOT_BROWSER=headlesschrome\n+\n+##\n+# Specify extra test environment variables in .meta.toml:\n+#  [tox]\n+#  test_environment_variables = """\n+#      PIP_EXTRA_INDEX_URL=https://my-pypi.my-server.com/\n+#  """\n+##\n deps =\n     zope.testrunner\n     -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+##\n+# Specify a custom constraints file in .meta.toml:\n+#  [tox]\n+#  constraints_file = "https://my-server.com/constraints.txt"\n+##\n commands =\n     zope-testrunner --all --test-path={toxinidir} -s Products.MimetypesRegistry {posargs}\n extras =\n     test\n \n+##\n+# Add extra configuration options in .meta.toml:\n+#  [tox]\n+#  test_extras = """\n+#      tests\n+#      widgets\n+#  """\n+##\n+\n [testenv:coverage]\n-usedevelop = true\n+description = get a test coverage report\n+use_develop = true\n+skip_install = false\n constrain_package_deps = true\n-set_env = ROBOT_BROWSER=headlesschrome\n+set_env =\n+    ROBOT_BROWSER=headlesschrome\n+\n+##\n+# Specify extra test environment variables in .meta.toml:\n+#  [tox]\n+#  test_environment_variables = """\n+#      PIP_EXTRA_INDEX_URL=https://my-pypi.my-server.com/\n+#  """\n+##\n deps =\n     coverage\n     zope.testrunner\n     -c https://dist.plone.org/release/6.0-dev/constraints.txt\n commands =\n-    coverage run {envbindir}/zope-testrunner --all --test-path={toxinidir} -s Products.MimetypesRegistry {posargs}\n+    coverage run --branch --source Products.MimetypesRegistry {envbindir}/zope-testrunner --quiet --all --test-path={toxinidir} -s Products.MimetypesRegistry {posargs}\n     coverage report -m --format markdown\n+    coverage xml\n extras =\n     test\n+\n+\n+[testenv:release-check]\n+description = ensure that the distribution is ready to release\n+skip_install = true\n+deps =\n+    twine\n+    build\n+    towncrier\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    # fake version to not have to install the package\n+    # we build the change log as news entries might break\n+    # the README that is displayed on PyPI\n+    towncrier build --version=100.0.0 --yes\n+    python -m build --sdist --no-isolation\n+    twine check dist/*\n+\n+[testenv:circular]\n+description = ensure there are no cyclic dependencies\n+use_develop = true\n+skip_install = false\n+set_env =\n+\n+##\n+# Specify extra test environment variables in .meta.toml:\n+#  [tox]\n+#  test_environment_variables = """\n+#      PIP_EXTRA_INDEX_URL=https://my-pypi.my-server.com/\n+#  """\n+##\n+allowlist_externals =\n+    sh\n+deps =\n+    pipdeptree\n+    pipforester\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+commands =\n+    # Generate the full dependency tree\n+    sh -c \'pipdeptree -j > forest.json\'\n+    # Generate a DOT graph with the circular dependencies, if any\n+    pipforester -i forest.json -o forest.dot --cycles\n+    # Report if there are any circular dependencies, i.e. error if there are any\n+    pipforester -i forest.json --check-cycles -o /dev/null\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [tox]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n'

