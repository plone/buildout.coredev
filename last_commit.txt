Repository: plone.app.theming


Branch: refs/heads/master
Date: 2020-04-22T16:28:18+02:00
Author: Stefan Antonelli (santonelli) <stefan.antonelli@operun.de>
Commit: https://github.com/plone/plone.app.theming/commit/42a571612acd5379c1e61fac153276ae57ac0fb4

move checks to allow diazo bundle without rules

Files changed:
A news/176.feature
M src/plone/app/theming/policy.py
M src/plone/app/theming/transform.py

b'diff --git a/news/176.feature b/news/176.feature\nnew file mode 100644\nindex 0000000..2545a40\n--- /dev/null\n+++ b/news/176.feature\n@@ -0,0 +1,2 @@\n+- Insert diazo bundle without rules.\n+  [santonelli] (#176)\n\\ No newline at end of file\ndiff --git a/src/plone/app/theming/policy.py b/src/plone/app/theming/policy.py\nindex d9db052..37c983b 100644\n--- a/src/plone/app/theming/policy.py\n+++ b/src/plone/app/theming/policy.py\n@@ -55,8 +55,6 @@ def getSettings(self):\n     def getCurrentTheme(self):\n         """The name of the current theme."""\n         settings = self.getSettings()\n-        if not settings.rules:\n-            return None\n         if settings.currentTheme:\n             return settings.currentTheme\n \n@@ -87,7 +85,7 @@ def isThemeEnabled(self, settings=None):\n \n         if not settings:\n             settings = self.getSettings()\n-        if settings is None or not settings.enabled or not settings.rules:\n+        if settings is None or not settings.enabled:\n             return False\n \n         server_url = self.request.get(\'SERVER_URL\')\ndiff --git a/src/plone/app/theming/transform.py b/src/plone/app/theming/transform.py\nindex 49996ba..9a09dd4 100644\n--- a/src/plone/app/theming/transform.py\n+++ b/src/plone/app/theming/transform.py\n@@ -69,6 +69,9 @@ def setupTransform(self, runtrace=False):\n         if settings is None:\n             return None\n \n+        if not settings.rules:\n+            return None\n+\n         if not policy.isThemeEnabled():\n             return None\n \n'

Repository: plone.app.theming


Branch: refs/heads/master
Date: 2020-04-23T10:45:07+03:00
Author: Maik Derstappen (MrTango) <md@derico.de>
Commit: https://github.com/plone/plone.app.theming/commit/7c4e35081dd4af1514c2bf3c3b0e427abb2aa9cd

Merge pull request #177 from plone/issue_176_bundle_without_rules

Allow diazo bundle without rules

Files changed:
A news/176.feature
M src/plone/app/theming/policy.py
M src/plone/app/theming/transform.py

b'diff --git a/news/176.feature b/news/176.feature\nnew file mode 100644\nindex 0000000..2545a40\n--- /dev/null\n+++ b/news/176.feature\n@@ -0,0 +1,2 @@\n+- Insert diazo bundle without rules.\n+  [santonelli] (#176)\n\\ No newline at end of file\ndiff --git a/src/plone/app/theming/policy.py b/src/plone/app/theming/policy.py\nindex d9db052..37c983b 100644\n--- a/src/plone/app/theming/policy.py\n+++ b/src/plone/app/theming/policy.py\n@@ -55,8 +55,6 @@ def getSettings(self):\n     def getCurrentTheme(self):\n         """The name of the current theme."""\n         settings = self.getSettings()\n-        if not settings.rules:\n-            return None\n         if settings.currentTheme:\n             return settings.currentTheme\n \n@@ -87,7 +85,7 @@ def isThemeEnabled(self, settings=None):\n \n         if not settings:\n             settings = self.getSettings()\n-        if settings is None or not settings.enabled or not settings.rules:\n+        if settings is None or not settings.enabled:\n             return False\n \n         server_url = self.request.get(\'SERVER_URL\')\ndiff --git a/src/plone/app/theming/transform.py b/src/plone/app/theming/transform.py\nindex 49996ba..9a09dd4 100644\n--- a/src/plone/app/theming/transform.py\n+++ b/src/plone/app/theming/transform.py\n@@ -69,6 +69,9 @@ def setupTransform(self, runtrace=False):\n         if settings is None:\n             return None\n \n+        if not settings.rules:\n+            return None\n+\n         if not policy.isThemeEnabled():\n             return None\n \n'

