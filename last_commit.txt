Repository: Products.contentmigration


Branch: refs/heads/master
Date: 2021-10-05T21:01:05+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.contentmigration/commit/d8632da394db8fd036fc15f0b2d158506e379ed8

Prevent installation on Py 3, where Archetypes does not work.

See https://github.com/plone/Products.CMFPlone/issues/3330

Files changed:
A news/3330.bugfix
M setup.cfg
M setup.py

b'diff --git a/news/3330.bugfix b/news/3330.bugfix\nnew file mode 100644\nindex 0000000..a23a636\n--- /dev/null\n+++ b/news/3330.bugfix\n@@ -0,0 +1,2 @@\n+Prevent installation on Python 3, as we know Archetypes does not work there.\n+[maurits]\ndiff --git a/setup.cfg b/setup.cfg\nindex aecfa92..7bf855e 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -3,7 +3,6 @@ ignore =\n     *.cfg\n     bootstrap.py\n \n-\n-\n [bdist_wheel]\n-universal = 1\n+# Py2 only\n+universal = 0\ndiff --git a/setup.py b/setup.py\nindex 3efe62b..cefd1e8 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -1,5 +1,12 @@\n from setuptools import setup, find_packages\n \n+import sys\n+\n+\n+if sys.version_info[0] != 2:\n+    # Prevent creating or installing a distribution with Python 3.\n+    raise ValueError("Products.contentmigration is based on Archetypes, which is Python 2 only.")\n+\n version = \'2.2.2.dev0\'\n \n setup(\n@@ -12,14 +19,10 @@\n         "Development Status :: 5 - Production/Stable",\n         "Framework :: Plone",\n         "Framework :: Plone :: 5.2",\n-        "Framework :: Plone :: 6.0",\n         "Framework :: Plone :: Core",\n         "License :: OSI Approved :: GNU Library or Lesser General Public License (LGPL)",\n         "Programming Language :: Python",\n         "Programming Language :: Python :: 2.7",\n-        "Programming Language :: Python :: 3.6",\n-        "Programming Language :: Python :: 3.7",\n-        "Programming Language :: Python :: 3.8",\n     ],\n     keywords=\'Plone Archetypes ATContentTypes\',\n     author=\'Martin Aspeli (and others)\',\n@@ -30,6 +33,7 @@\n     namespace_packages=[\'Products\'],\n     include_package_data=True,\n     zip_safe=False,\n+    python_requires=\'==2.7.*\',\n     extras_require=dict(\n         test=[\n             \'archetypes.schemaextender\',\n'

Repository: Products.contentmigration


Branch: refs/heads/master
Date: 2021-10-07T12:26:32+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.contentmigration/commit/621910374a454c0820c3ef0199ffc34dbd1d6173

Merge pull request #26 from plone/prevent-installation-on-py3

Prevent installation on Py 3, where Archetypes does not work.

Files changed:
A news/3330.bugfix
M setup.cfg
M setup.py

b'diff --git a/news/3330.bugfix b/news/3330.bugfix\nnew file mode 100644\nindex 0000000..a23a636\n--- /dev/null\n+++ b/news/3330.bugfix\n@@ -0,0 +1,2 @@\n+Prevent installation on Python 3, as we know Archetypes does not work there.\n+[maurits]\ndiff --git a/setup.cfg b/setup.cfg\nindex aecfa92..7bf855e 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -3,7 +3,6 @@ ignore =\n     *.cfg\n     bootstrap.py\n \n-\n-\n [bdist_wheel]\n-universal = 1\n+# Py2 only\n+universal = 0\ndiff --git a/setup.py b/setup.py\nindex 3efe62b..cefd1e8 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -1,5 +1,12 @@\n from setuptools import setup, find_packages\n \n+import sys\n+\n+\n+if sys.version_info[0] != 2:\n+    # Prevent creating or installing a distribution with Python 3.\n+    raise ValueError("Products.contentmigration is based on Archetypes, which is Python 2 only.")\n+\n version = \'2.2.2.dev0\'\n \n setup(\n@@ -12,14 +19,10 @@\n         "Development Status :: 5 - Production/Stable",\n         "Framework :: Plone",\n         "Framework :: Plone :: 5.2",\n-        "Framework :: Plone :: 6.0",\n         "Framework :: Plone :: Core",\n         "License :: OSI Approved :: GNU Library or Lesser General Public License (LGPL)",\n         "Programming Language :: Python",\n         "Programming Language :: Python :: 2.7",\n-        "Programming Language :: Python :: 3.6",\n-        "Programming Language :: Python :: 3.7",\n-        "Programming Language :: Python :: 3.8",\n     ],\n     keywords=\'Plone Archetypes ATContentTypes\',\n     author=\'Martin Aspeli (and others)\',\n@@ -30,6 +33,7 @@\n     namespace_packages=[\'Products\'],\n     include_package_data=True,\n     zip_safe=False,\n+    python_requires=\'==2.7.*\',\n     extras_require=dict(\n         test=[\n             \'archetypes.schemaextender\',\n'

