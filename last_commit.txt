Repository: plone.app.widgets


Branch: refs/heads/master
Date: 2020-10-17T18:12:21+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.widgets/commit/0ae34e96db0e0bd51d4bf9fd05d741560fd6c8bf

Robot tests: Fix deprecated jQuery.size.

Files changed:
A news/207.bugfix
M plone/app/widgets/tests/robot/common.robot
M plone/app/widgets/tests/robot/test_datetime_widget.robot
M plone/app/widgets/tests/robot/test_querystring_widget.robot
M plone/app/widgets/tests/robot/test_select_widget.robot

b"diff --git a/news/207.bugfix b/news/207.bugfix\nnew file mode 100644\nindex 00000000..7f6f198b\n--- /dev/null\n+++ b/news/207.bugfix\n@@ -0,0 +1,2 @@\n+Robot tests: Fix deprecated jQuery.size.\n+[thet]\ndiff --git a/plone/app/widgets/tests/robot/common.robot b/plone/app/widgets/tests/robot/common.robot\nindex 68c4bffc..3a4a3e1c 100644\n--- a/plone/app/widgets/tests/robot/common.robot\n+++ b/plone/app/widgets/tests/robot/common.robot\n@@ -38,11 +38,11 @@ I edit\n I create a collection\n   [Arguments]  ${title}\n   Go to  ${PLONE_URL}/++add++Collection\n-  Wait For Condition  return $('body.patterns-loaded').size() > 0\n+  Wait For Condition  return !!document.querySelector('body.patterns-loaded')\n   Execute Javascript  $('#form-widgets-IDublinCore-title').val('${title}'); return 0;\n \n I create a folder\n   [Arguments]  ${title}\n   Go to  ${PLONE_URL}/++add++Folder\n-  Wait For Condition  return $('body.patterns-loaded').size() > 0\n+  Wait For Condition  return !!document.querySelector('body.patterns-loaded')\n   Execute Javascript  $('#form-widgets-IDublinCore-title').val('${title}'); return 0;\ndiff --git a/plone/app/widgets/tests/robot/test_datetime_widget.robot b/plone/app/widgets/tests/robot/test_datetime_widget.robot\nindex 93bac91d..a3c0ff26 100644\n--- a/plone/app/widgets/tests/robot/test_datetime_widget.robot\n+++ b/plone/app/widgets/tests/robot/test_datetime_widget.robot\n@@ -31,7 +31,7 @@ As a contributor I can enter the date and time\n    When I fill datetime field  Publishing Date  2010  1  30  4:00 a.m.\n     And When I save\n     And When I edit\n-    Wait For Condition  return $('.autotoc-nav .active:visible').size() > 0\n+    Wait For Condition  return $('.autotoc-nav .active:visible').length > 0\n     And When I open tab  Dates\n    Then Page should contain datetime  Publishing Date  2010  1  30  4:00 a.m.\n \ndiff --git a/plone/app/widgets/tests/robot/test_querystring_widget.robot b/plone/app/widgets/tests/robot/test_querystring_widget.robot\nindex 85572484..0042129c 100644\n--- a/plone/app/widgets/tests/robot/test_querystring_widget.robot\n+++ b/plone/app/widgets/tests/robot/test_querystring_widget.robot\n@@ -15,7 +15,7 @@ ${querywidget_selector}  \\#formfield-form-widgets-ICollection-query\n Querystring Widget rows appear and disappear correctly\n   Given I'm logged in as a 'Site Administrator'\n     And I create a collection  My Collection\n-        Wait For Condition  return $('body.patterns-loaded').size() > 0\n+        Wait For Condition  return !!document.querySelector('body.patterns-loaded')\n         Wait until page contains Element  css=${querywidget_selector} .querystring-criteria-wrapper:nth-child(1)\n         Wait Until Page Does Not Contain Element  css=${querywidget_selector} .querystring-criteria-wrapper:nth-child(2)\n    When I select criteria index in row  1  Expiration date\ndiff --git a/plone/app/widgets/tests/robot/test_select_widget.robot b/plone/app/widgets/tests/robot/test_select_widget.robot\nindex ac850e47..c2bd50f0 100644\n--- a/plone/app/widgets/tests/robot/test_select_widget.robot\n+++ b/plone/app/widgets/tests/robot/test_select_widget.robot\n@@ -71,26 +71,26 @@ a logged-in member\n \n I type on the autocomplete field\n   [Arguments]  ${text}\n-  Wait For Condition  return $('.select2-choices:visible').size() > 0\n+  Wait For Condition  return $('.select2-choices:visible').length > 0\n   Open Dropdown  ${dropdown_select}  ${input_search}\n   Input Text  ${input_search}  ${text}\n   Click Element  ${results_label}\n \n I type on the multiple autocomplete field\n   [Arguments]  ${text}\n-  Wait For Condition  return $('.select2-choices:visible').size() > 0\n+  Wait For Condition  return $('.select2-choices:visible').length > 0\n   Execute Javascript  var $input = $('.select2-input'); $input.click().val('${text}'); var keyup = $.Event('keyup-change'); $input.trigger(keyup); return 0\n   Click Element  ${results_label}\n \n I select the option\n   [Arguments]  ${index}\n-  Wait For Condition  return $('.select2-choices:visible').size() > 0\n+  Wait For Condition  return $('.select2-choices:visible').length > 0\n   Open Dropdown  ${dropdown_select}  ${input_search}\n   Click Element  css=li.select2-results-dept-0:nth-child(${index})\n \n I click on the element\n   [Arguments]  ${index}\n-  Wait For Condition  return $('.select2-choices:visible').size() > 0\n+  Wait For Condition  return $('.select2-choices:visible').length > 0\n   Open Dropdown  css=#formfield-form-widgets-list_field input.select2-input  ${dropdown_multiple}\n   Click Element  css=li.select2-results-dept-0:nth-child(${index})\n \n"

Repository: plone.app.widgets


Branch: refs/heads/master
Date: 2020-10-17T21:09:27+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.widgets/commit/d09082461d3ab22a1f83ebb8bf72a736ce4ee05f

Merge pull request #207 from plone/thet-jqsize

Robot tests: Replace deprecated jQuery.size with generic JavaScript.

Files changed:
A news/207.bugfix
M plone/app/widgets/tests/robot/common.robot
M plone/app/widgets/tests/robot/test_datetime_widget.robot
M plone/app/widgets/tests/robot/test_querystring_widget.robot
M plone/app/widgets/tests/robot/test_select_widget.robot

b"diff --git a/news/207.bugfix b/news/207.bugfix\nnew file mode 100644\nindex 00000000..7f6f198b\n--- /dev/null\n+++ b/news/207.bugfix\n@@ -0,0 +1,2 @@\n+Robot tests: Fix deprecated jQuery.size.\n+[thet]\ndiff --git a/plone/app/widgets/tests/robot/common.robot b/plone/app/widgets/tests/robot/common.robot\nindex 68c4bffc..3a4a3e1c 100644\n--- a/plone/app/widgets/tests/robot/common.robot\n+++ b/plone/app/widgets/tests/robot/common.robot\n@@ -38,11 +38,11 @@ I edit\n I create a collection\n   [Arguments]  ${title}\n   Go to  ${PLONE_URL}/++add++Collection\n-  Wait For Condition  return $('body.patterns-loaded').size() > 0\n+  Wait For Condition  return !!document.querySelector('body.patterns-loaded')\n   Execute Javascript  $('#form-widgets-IDublinCore-title').val('${title}'); return 0;\n \n I create a folder\n   [Arguments]  ${title}\n   Go to  ${PLONE_URL}/++add++Folder\n-  Wait For Condition  return $('body.patterns-loaded').size() > 0\n+  Wait For Condition  return !!document.querySelector('body.patterns-loaded')\n   Execute Javascript  $('#form-widgets-IDublinCore-title').val('${title}'); return 0;\ndiff --git a/plone/app/widgets/tests/robot/test_datetime_widget.robot b/plone/app/widgets/tests/robot/test_datetime_widget.robot\nindex 93bac91d..a3c0ff26 100644\n--- a/plone/app/widgets/tests/robot/test_datetime_widget.robot\n+++ b/plone/app/widgets/tests/robot/test_datetime_widget.robot\n@@ -31,7 +31,7 @@ As a contributor I can enter the date and time\n    When I fill datetime field  Publishing Date  2010  1  30  4:00 a.m.\n     And When I save\n     And When I edit\n-    Wait For Condition  return $('.autotoc-nav .active:visible').size() > 0\n+    Wait For Condition  return $('.autotoc-nav .active:visible').length > 0\n     And When I open tab  Dates\n    Then Page should contain datetime  Publishing Date  2010  1  30  4:00 a.m.\n \ndiff --git a/plone/app/widgets/tests/robot/test_querystring_widget.robot b/plone/app/widgets/tests/robot/test_querystring_widget.robot\nindex 85572484..0042129c 100644\n--- a/plone/app/widgets/tests/robot/test_querystring_widget.robot\n+++ b/plone/app/widgets/tests/robot/test_querystring_widget.robot\n@@ -15,7 +15,7 @@ ${querywidget_selector}  \\#formfield-form-widgets-ICollection-query\n Querystring Widget rows appear and disappear correctly\n   Given I'm logged in as a 'Site Administrator'\n     And I create a collection  My Collection\n-        Wait For Condition  return $('body.patterns-loaded').size() > 0\n+        Wait For Condition  return !!document.querySelector('body.patterns-loaded')\n         Wait until page contains Element  css=${querywidget_selector} .querystring-criteria-wrapper:nth-child(1)\n         Wait Until Page Does Not Contain Element  css=${querywidget_selector} .querystring-criteria-wrapper:nth-child(2)\n    When I select criteria index in row  1  Expiration date\ndiff --git a/plone/app/widgets/tests/robot/test_select_widget.robot b/plone/app/widgets/tests/robot/test_select_widget.robot\nindex ac850e47..c2bd50f0 100644\n--- a/plone/app/widgets/tests/robot/test_select_widget.robot\n+++ b/plone/app/widgets/tests/robot/test_select_widget.robot\n@@ -71,26 +71,26 @@ a logged-in member\n \n I type on the autocomplete field\n   [Arguments]  ${text}\n-  Wait For Condition  return $('.select2-choices:visible').size() > 0\n+  Wait For Condition  return $('.select2-choices:visible').length > 0\n   Open Dropdown  ${dropdown_select}  ${input_search}\n   Input Text  ${input_search}  ${text}\n   Click Element  ${results_label}\n \n I type on the multiple autocomplete field\n   [Arguments]  ${text}\n-  Wait For Condition  return $('.select2-choices:visible').size() > 0\n+  Wait For Condition  return $('.select2-choices:visible').length > 0\n   Execute Javascript  var $input = $('.select2-input'); $input.click().val('${text}'); var keyup = $.Event('keyup-change'); $input.trigger(keyup); return 0\n   Click Element  ${results_label}\n \n I select the option\n   [Arguments]  ${index}\n-  Wait For Condition  return $('.select2-choices:visible').size() > 0\n+  Wait For Condition  return $('.select2-choices:visible').length > 0\n   Open Dropdown  ${dropdown_select}  ${input_search}\n   Click Element  css=li.select2-results-dept-0:nth-child(${index})\n \n I click on the element\n   [Arguments]  ${index}\n-  Wait For Condition  return $('.select2-choices:visible').size() > 0\n+  Wait For Condition  return $('.select2-choices:visible').length > 0\n   Open Dropdown  css=#formfield-form-widgets-list_field input.select2-input  ${dropdown_multiple}\n   Click Element  css=li.select2-results-dept-0:nth-child(${index})\n \n"

