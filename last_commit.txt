Repository: plone.restapi


Branch: refs/heads/7.x.x
Date: 2023-03-31T11:39:17+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.restapi/commit/07e35e9c2a92a3ad0d6c3cdbdac1664e1527fd6c

CI: run the tests on Ubuntu 20.04, instead of latest. [7.x.x] (#1610)

* CI: run the tests on Ubuntu 20.04, instead of latest.

Python 2.7 and 3.6 are not available on latest.
See broken runs on this PR job:
https://github.com/plone/plone.restapi/actions/runs/4565635527?pr=1608

BTW, for me it would be fine to stop testing with Python 3.6: it is no longer supported by Plone 5.2.
But if this PR gets it going for a few more months, then all is well.

* Pin more packages to the latest version compatible with Python 2.

* Pin attrs, like we already say in the readme.

* See if pinning both flake8-print and flake8_print helps on 5.2.

* Pin flake8-print in plone-5.2.x.cfg as well.

This file does not extend versions.cfg.

Files changed:
A news/2004.internal
M .github/workflows/ci.yml
M plone-5.2.x.cfg
M versions.cfg

b"diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml\nindex 617db8467..6ecb653d1 100644\n--- a/.github/workflows/ci.yml\n+++ b/.github/workflows/ci.yml\n@@ -2,7 +2,7 @@ name: Plone RESTAPI CI\n on: [push]\n jobs:\n   build:\n-    runs-on: ubuntu-latest\n+    runs-on: ubuntu-20.04\n     strategy:\n       fail-fast: false\n       matrix:\ndiff --git a/news/2004.internal b/news/2004.internal\nnew file mode 100644\nindex 000000000..4ad88a9f0\n--- /dev/null\n+++ b/news/2004.internal\n@@ -0,0 +1,3 @@\n+CI: run the tests on Ubuntu 20.04, instead of latest.\n+Python 2.7 and 3.6 are not available on latest.\n+[maurits]\n\\ No newline at end of file\ndiff --git a/plone-5.2.x.cfg b/plone-5.2.x.cfg\nindex 644185fb5..cbd437406 100644\n--- a/plone-5.2.x.cfg\n+++ b/plone-5.2.x.cfg\n@@ -16,3 +16,6 @@ virtualenv = 20.0.35\n \n # Error: The requirement ('importlib-metadata>=1') is not allowed by your [versions] constraint (0.23)\n importlib-metadata = 2.0.0\n+\n+# latest version compatible with Python 2\n+flake8-print = 4.0.1\ndiff --git a/versions.cfg b/versions.cfg\nindex 104f34066..d2a2a181d 100644\n--- a/versions.cfg\n+++ b/versions.cfg\n@@ -60,3 +60,24 @@ cffi = 1.14.4\n \n # latest version compatible with Python 2\n bleach = 3.3.1 \n+\n+# latest version compatible with Python 2\n+pep517 = 0.12\n+\n+# latest version compatible with Python 2\n+alabaster = 0.7.12\n+\n+# latest version compatible with Python 2\n+z3c.dependencychecker = 2.7\n+\n+# latest version compatible with Python 2\n+readme-renderer = 28.0\n+\n+# latest version compatible with Python 2\n+packaging = 20.9\n+\n+# latest version compatible with Python 2\n+flake8-print = 4.0.1\n+\n+# latest version compatible with Python 2\n+attrs = 21.2.0\n\\ No newline at end of file\n"

