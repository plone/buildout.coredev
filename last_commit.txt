Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2020-04-23T13:39:24+03:00
Author: MrTango (MrTango) <md@derico.de>
Commit: https://github.com/plone/plone.app.upgrade/commit/0e02af7222445ac2ee3ef3cebfbf4f720f599d61

Add upgrade profiles for v60, including a upgrade step for #3086

Files changed:
A news/3086.feature
A plone/app/upgrade/v60/__init__.py
A plone/app/upgrade/v60/alphas.py
A plone/app/upgrade/v60/configure.zcml
A plone/app/upgrade/v60/profiles.zcml
A plone/app/upgrade/v60/profiles/to_alpha1/registry.xml
M plone/app/upgrade/configure.zcml

b'diff --git a/news/3086.feature b/news/3086.feature\nnew file mode 100644\nindex 00000000..cc81c7b6\n--- /dev/null\n+++ b/news/3086.feature\n@@ -0,0 +1,2 @@\n+Add upgrade profiles for v60, including a upgrade step for #3086 (custom.css view)\n+[MrTango]\ndiff --git a/plone/app/upgrade/configure.zcml b/plone/app/upgrade/configure.zcml\nindex 296b6c4d..9a4e5088 100644\n--- a/plone/app/upgrade/configure.zcml\n+++ b/plone/app/upgrade/configure.zcml\n@@ -11,6 +11,7 @@\n     <include package=".v50" zcml:condition="have plone-5" />\n     <include package=".v51" zcml:condition="have plone-51" />\n     <include package=".v52" zcml:condition="have plone-52" />\n+    <include package=".v60" zcml:condition="have plone-60" />\n \n     <utility\n         zcml:condition="have plone-51"\ndiff --git a/plone/app/upgrade/v60/__init__.py b/plone/app/upgrade/v60/__init__.py\nnew file mode 100644\nindex 00000000..40a96afc\n--- /dev/null\n+++ b/plone/app/upgrade/v60/__init__.py\n@@ -0,0 +1 @@\n+# -*- coding: utf-8 -*-\ndiff --git a/plone/app/upgrade/v60/alphas.py b/plone/app/upgrade/v60/alphas.py\nnew file mode 100644\nindex 00000000..36b5b051\n--- /dev/null\n+++ b/plone/app/upgrade/v60/alphas.py\n@@ -0,0 +1,21 @@\n+# -*- coding: utf-8 -*-\n+from BTrees.OOBTree import OOBTree\n+from plone.app.upgrade.utils import cleanUpSkinsTool\n+from plone.app.upgrade.utils import loadMigrationProfile\n+from plone.dexterity.interfaces import IDexterityFTI\n+from plone.folder.nogopip import manage_addGopipIndex\n+from plone.registry.interfaces import IRegistry\n+from Products.CMFCore.utils import getToolByName\n+from Products.PlonePAS.tools.memberdata import MemberData\n+from zope.component import getUtility\n+\n+import logging\n+\n+\n+logger = logging.getLogger(\'plone.app.upgrade\')\n+\n+\n+def to60alpha1(context):\n+    loadMigrationProfile(context, \'profile-plone.app.upgrade.v60:to60alpha1\')\n+    # portal = getToolByName(context, \'portal_url\').getPortalObject()\n+\ndiff --git a/plone/app/upgrade/v60/configure.zcml b/plone/app/upgrade/v60/configure.zcml\nnew file mode 100644\nindex 00000000..e25ee8c3\n--- /dev/null\n+++ b/plone/app/upgrade/v60/configure.zcml\n@@ -0,0 +1,23 @@\n+<configure\n+    xmlns="http://namespaces.zope.org/zope"\n+    xmlns:gs="http://namespaces.zope.org/genericsetup"\n+    xmlns:zcml="http://namespaces.zope.org/zcml"\n+    i18n_domain="plone">\n+\n+    <include file="profiles.zcml" />\n+\n+    <gs:upgradeSteps\n+        source="5299"\n+        destination="6000"\n+        profile="Products.CMFPlone:plone">\n+\n+      <gs:upgradeStep\n+           title="Run to60alpha1 upgrade profile."\n+           description=""\n+           handler=".alphas.to60alpha1"\n+           />\n+\n+    </gs:upgradeSteps>\n+\n+\n+</configure>\ndiff --git a/plone/app/upgrade/v60/profiles.zcml b/plone/app/upgrade/v60/profiles.zcml\nnew file mode 100644\nindex 00000000..5a890640\n--- /dev/null\n+++ b/plone/app/upgrade/v60/profiles.zcml\n@@ -0,0 +1,15 @@\n+<configure\n+    xmlns="http://namespaces.zope.org/zope"\n+    xmlns:genericsetup="http://namespaces.zope.org/genericsetup"\n+    i18n_domain="plone">\n+\n+  <genericsetup:registerProfile\n+      name="to60alpha1"\n+      title="Upgrade profile for Plone 5.2.x to Plone 6.0alpha1"\n+      description=""\n+      directory="profiles/to_alpha1"\n+      for="Products.CMFPlone.interfaces.IMigratingPloneSiteRoot"\n+      provides="Products.GenericSetup.interfaces.EXTENSION"\n+      />\n+\n+</configure>\ndiff --git a/plone/app/upgrade/v60/profiles/to_alpha1/registry.xml b/plone/app/upgrade/v60/profiles/to_alpha1/registry.xml\nnew file mode 100644\nindex 00000000..a9dd5cff\n--- /dev/null\n+++ b/plone/app/upgrade/v60/profiles/to_alpha1/registry.xml\n@@ -0,0 +1,4 @@\n+<?xml version="1.0"?>\n+<registry>\n+    <records interface="plone.app.theming.interfaces.IThemeSettings" />\n+</registry>\n'

Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2020-04-23T18:39:00+03:00
Author: Maik Derstappen (MrTango) <md@derico.de>
Commit: https://github.com/plone/plone.app.upgrade/commit/b57278dbc91cec5b701c09bac46031c8a5d0dde5

Merge pull request #230 from plone/custom_css_view

Add upgrade profiles for v60, including a upgrade step for #3086

Files changed:
A news/3086.feature
A plone/app/upgrade/v60/__init__.py
A plone/app/upgrade/v60/alphas.py
A plone/app/upgrade/v60/configure.zcml
A plone/app/upgrade/v60/profiles.zcml
A plone/app/upgrade/v60/profiles/to_alpha1/registry.xml
M plone/app/upgrade/configure.zcml

b'diff --git a/news/3086.feature b/news/3086.feature\nnew file mode 100644\nindex 00000000..cc81c7b6\n--- /dev/null\n+++ b/news/3086.feature\n@@ -0,0 +1,2 @@\n+Add upgrade profiles for v60, including a upgrade step for #3086 (custom.css view)\n+[MrTango]\ndiff --git a/plone/app/upgrade/configure.zcml b/plone/app/upgrade/configure.zcml\nindex 296b6c4d..9a4e5088 100644\n--- a/plone/app/upgrade/configure.zcml\n+++ b/plone/app/upgrade/configure.zcml\n@@ -11,6 +11,7 @@\n     <include package=".v50" zcml:condition="have plone-5" />\n     <include package=".v51" zcml:condition="have plone-51" />\n     <include package=".v52" zcml:condition="have plone-52" />\n+    <include package=".v60" zcml:condition="have plone-60" />\n \n     <utility\n         zcml:condition="have plone-51"\ndiff --git a/plone/app/upgrade/v60/__init__.py b/plone/app/upgrade/v60/__init__.py\nnew file mode 100644\nindex 00000000..40a96afc\n--- /dev/null\n+++ b/plone/app/upgrade/v60/__init__.py\n@@ -0,0 +1 @@\n+# -*- coding: utf-8 -*-\ndiff --git a/plone/app/upgrade/v60/alphas.py b/plone/app/upgrade/v60/alphas.py\nnew file mode 100644\nindex 00000000..36b5b051\n--- /dev/null\n+++ b/plone/app/upgrade/v60/alphas.py\n@@ -0,0 +1,21 @@\n+# -*- coding: utf-8 -*-\n+from BTrees.OOBTree import OOBTree\n+from plone.app.upgrade.utils import cleanUpSkinsTool\n+from plone.app.upgrade.utils import loadMigrationProfile\n+from plone.dexterity.interfaces import IDexterityFTI\n+from plone.folder.nogopip import manage_addGopipIndex\n+from plone.registry.interfaces import IRegistry\n+from Products.CMFCore.utils import getToolByName\n+from Products.PlonePAS.tools.memberdata import MemberData\n+from zope.component import getUtility\n+\n+import logging\n+\n+\n+logger = logging.getLogger(\'plone.app.upgrade\')\n+\n+\n+def to60alpha1(context):\n+    loadMigrationProfile(context, \'profile-plone.app.upgrade.v60:to60alpha1\')\n+    # portal = getToolByName(context, \'portal_url\').getPortalObject()\n+\ndiff --git a/plone/app/upgrade/v60/configure.zcml b/plone/app/upgrade/v60/configure.zcml\nnew file mode 100644\nindex 00000000..e25ee8c3\n--- /dev/null\n+++ b/plone/app/upgrade/v60/configure.zcml\n@@ -0,0 +1,23 @@\n+<configure\n+    xmlns="http://namespaces.zope.org/zope"\n+    xmlns:gs="http://namespaces.zope.org/genericsetup"\n+    xmlns:zcml="http://namespaces.zope.org/zcml"\n+    i18n_domain="plone">\n+\n+    <include file="profiles.zcml" />\n+\n+    <gs:upgradeSteps\n+        source="5299"\n+        destination="6000"\n+        profile="Products.CMFPlone:plone">\n+\n+      <gs:upgradeStep\n+           title="Run to60alpha1 upgrade profile."\n+           description=""\n+           handler=".alphas.to60alpha1"\n+           />\n+\n+    </gs:upgradeSteps>\n+\n+\n+</configure>\ndiff --git a/plone/app/upgrade/v60/profiles.zcml b/plone/app/upgrade/v60/profiles.zcml\nnew file mode 100644\nindex 00000000..5a890640\n--- /dev/null\n+++ b/plone/app/upgrade/v60/profiles.zcml\n@@ -0,0 +1,15 @@\n+<configure\n+    xmlns="http://namespaces.zope.org/zope"\n+    xmlns:genericsetup="http://namespaces.zope.org/genericsetup"\n+    i18n_domain="plone">\n+\n+  <genericsetup:registerProfile\n+      name="to60alpha1"\n+      title="Upgrade profile for Plone 5.2.x to Plone 6.0alpha1"\n+      description=""\n+      directory="profiles/to_alpha1"\n+      for="Products.CMFPlone.interfaces.IMigratingPloneSiteRoot"\n+      provides="Products.GenericSetup.interfaces.EXTENSION"\n+      />\n+\n+</configure>\ndiff --git a/plone/app/upgrade/v60/profiles/to_alpha1/registry.xml b/plone/app/upgrade/v60/profiles/to_alpha1/registry.xml\nnew file mode 100644\nindex 00000000..a9dd5cff\n--- /dev/null\n+++ b/plone/app/upgrade/v60/profiles/to_alpha1/registry.xml\n@@ -0,0 +1,4 @@\n+<?xml version="1.0"?>\n+<registry>\n+    <records interface="plone.app.theming.interfaces.IThemeSettings" />\n+</registry>\n'

