Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-05-30T22:55:05+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/98dbada60e5d28e40fd43166e19068073cb2c051

Remove Zope2 leftover in test

Files changed:
A news/3966.bugfix
M Products/CMFPlone/controlpanel/browser/maintenance.py
M Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_maintenance.py

b'diff --git a/Products/CMFPlone/controlpanel/browser/maintenance.py b/Products/CMFPlone/controlpanel/browser/maintenance.py\nindex 9d64f2f6a3..2d8c2603de 100644\n--- a/Products/CMFPlone/controlpanel/browser/maintenance.py\n+++ b/Products/CMFPlone/controlpanel/browser/maintenance.py\n@@ -2,6 +2,7 @@\n from AccessControl.Permissions import view_management_screens\n from Acquisition import aq_inner\n from App.config import getConfiguration\n+from html import escape\n from plone.autoform.form import AutoExtensibleForm\n from plone.base import PloneMessageFactory as _\n from plone.base.interfaces import IMaintenanceSchema\n@@ -24,12 +25,6 @@\n except ImportError:\n     LIFETIME = False\n \n-try:\n-    from html import escape\n-except ImportError:\n-    from cgi import escape\n-\n-\n logger = logging.getLogger(__file__)\n \n \ndiff --git a/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_maintenance.py b/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_maintenance.py\nindex 0216c1077c..d77160ce90 100644\n--- a/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_maintenance.py\n+++ b/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_maintenance.py\n@@ -1,4 +1,3 @@\n-from pkg_resources import get_distribution\n from plone.app.testing import TEST_USER_NAME\n from plone.app.testing import TEST_USER_PASSWORD\n from plone.testing.zope import Browser\n@@ -8,9 +7,6 @@\n import unittest\n \n \n-has_zope4 = get_distribution("Zope2").version.startswith("4")\n-\n-\n class MaintenanceControlPanelFunctionalTest(unittest.TestCase):\n     """Test that changes in the maintenance control panel are actually\n     stored in the registry.\ndiff --git a/news/3966.bugfix b/news/3966.bugfix\nnew file mode 100644\nindex 0000000000..1c962a9e34\n--- /dev/null\n+++ b/news/3966.bugfix\n@@ -0,0 +1 @@\n+Remove unused leftover reference to the Zope2 package from test. [@jensens]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-05-30T23:46:00+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/518b6b92b9340fd3927e208be914055dc8b0a168

Merge branch 'master' into rm-Zope2-leftover

Files changed:
A news/3965.bugfix
M Products/CMFPlone/tests/testPortalCreation.py

b'diff --git a/Products/CMFPlone/tests/testPortalCreation.py b/Products/CMFPlone/tests/testPortalCreation.py\nindex ea0e56fc1e..080d3c6beb 100644\n--- a/Products/CMFPlone/tests/testPortalCreation.py\n+++ b/Products/CMFPlone/tests/testPortalCreation.py\n@@ -198,7 +198,6 @@ def testUnfriendlyTypesProperty(self):\n         registry = getUtility(IRegistry)\n         settings = registry.forInterface(ISearchSchema, prefix="plone")\n         self.assertTrue("plone.types_not_searched" in registry)\n-        self.assertTrue("Plone Site" in settings.types_not_searched)\n \n     def testDefaultSortOrderProperty(self):\n         # We should have an sort_on property\ndiff --git a/news/3965.bugfix b/news/3965.bugfix\nnew file mode 100644\nindex 0000000000..de4d0d6091\n--- /dev/null\n+++ b/news/3965.bugfix\n@@ -0,0 +1,2 @@\n+Do not test types_not_searched for a element that is not part of the underlying vocabulary.\n+[@jensens]\n'

Repository: Products.CMFPlone


Branch: refs/heads/master
Date: 2024-05-31T01:08:30+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/6e2796e0c394a51433001f690dcf183f9af99825

Merge pull request #3966 from plone/rm-Zope2-leftover

Remove Zope2 leftover in test

Files changed:
A news/3966.bugfix
M Products/CMFPlone/controlpanel/browser/maintenance.py
M Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_maintenance.py

b'diff --git a/Products/CMFPlone/controlpanel/browser/maintenance.py b/Products/CMFPlone/controlpanel/browser/maintenance.py\nindex 9d64f2f6a3..2d8c2603de 100644\n--- a/Products/CMFPlone/controlpanel/browser/maintenance.py\n+++ b/Products/CMFPlone/controlpanel/browser/maintenance.py\n@@ -2,6 +2,7 @@\n from AccessControl.Permissions import view_management_screens\n from Acquisition import aq_inner\n from App.config import getConfiguration\n+from html import escape\n from plone.autoform.form import AutoExtensibleForm\n from plone.base import PloneMessageFactory as _\n from plone.base.interfaces import IMaintenanceSchema\n@@ -24,12 +25,6 @@\n except ImportError:\n     LIFETIME = False\n \n-try:\n-    from html import escape\n-except ImportError:\n-    from cgi import escape\n-\n-\n logger = logging.getLogger(__file__)\n \n \ndiff --git a/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_maintenance.py b/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_maintenance.py\nindex 0216c1077c..d77160ce90 100644\n--- a/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_maintenance.py\n+++ b/Products/CMFPlone/controlpanel/tests/test_controlpanel_browser_maintenance.py\n@@ -1,4 +1,3 @@\n-from pkg_resources import get_distribution\n from plone.app.testing import TEST_USER_NAME\n from plone.app.testing import TEST_USER_PASSWORD\n from plone.testing.zope import Browser\n@@ -8,9 +7,6 @@\n import unittest\n \n \n-has_zope4 = get_distribution("Zope2").version.startswith("4")\n-\n-\n class MaintenanceControlPanelFunctionalTest(unittest.TestCase):\n     """Test that changes in the maintenance control panel are actually\n     stored in the registry.\ndiff --git a/news/3966.bugfix b/news/3966.bugfix\nnew file mode 100644\nindex 0000000000..1c962a9e34\n--- /dev/null\n+++ b/news/3966.bugfix\n@@ -0,0 +1 @@\n+Remove unused leftover reference to the Zope2 package from test. [@jensens]\n'

