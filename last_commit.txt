Repository: plone.app.debugtoolbar


Branch: refs/heads/master
Date: 2021-12-19T16:51:18+01:00
Author: ale-rt (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.app.debugtoolbar/commit/c1a66f4f872db6bcd7a15418b00daf99b6c8cfcd

Fix a compatibility issue with Python 3.8

Fixes #27

Files changed:
A news/27.bugfix
M src/plone/app/debugtoolbar/browser/interactive.py

b'diff --git a/news/27.bugfix b/news/27.bugfix\nnew file mode 100644\nindex 0000000..3c93a73\n--- /dev/null\n+++ b/news/27.bugfix\n@@ -0,0 +1 @@\n+Fix a compatibility issue with Python 3.8\ndiff --git a/src/plone/app/debugtoolbar/browser/interactive.py b/src/plone/app/debugtoolbar/browser/interactive.py\nindex 05d7605..7ec35a7 100644\n--- a/src/plone/app/debugtoolbar/browser/interactive.py\n+++ b/src/plone/app/debugtoolbar/browser/interactive.py\n@@ -1,6 +1,5 @@\n # -*- coding: utf-8 -*-\n import re\n-import cgi\n import threading\n import traceback\n import six\n@@ -18,6 +17,13 @@\n from Products.PageTemplates.Expressions import getEngine\n from Products.CMFPlone.PloneBaseTool import createExprContext\n \n+\n+try:\n+    from html import escape\n+except ImportError:\n+    from cgi import escape\n+\n+\n class Variables(object):\n     """Store local variables. Allow one set of variables per user id, and\n     invalidate if the path of the context changes.\n@@ -58,7 +64,8 @@ def htmlQuote(v):\n     # Borrowed from Paste\n     if v is None:\n         return \'\'\n-    return cgi.escape(str(v), 1)\n+    return escape(str(v), 1)\n+\n \n def preserveWhitespace(v, quote=True):\n     # Borrowed from Paste\n'

Repository: plone.app.debugtoolbar


Branch: refs/heads/master
Date: 2021-12-20T11:46:18+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.debugtoolbar/commit/57a8b1eed9db3501c6fc565c04b5c642d95e18d9

Merge pull request #28 from plone/27.bugfix

Fix a compatibility issue with Python 3.8

Files changed:
A news/27.bugfix
M src/plone/app/debugtoolbar/browser/interactive.py

b'diff --git a/news/27.bugfix b/news/27.bugfix\nnew file mode 100644\nindex 0000000..3c93a73\n--- /dev/null\n+++ b/news/27.bugfix\n@@ -0,0 +1 @@\n+Fix a compatibility issue with Python 3.8\ndiff --git a/src/plone/app/debugtoolbar/browser/interactive.py b/src/plone/app/debugtoolbar/browser/interactive.py\nindex 05d7605..7ec35a7 100644\n--- a/src/plone/app/debugtoolbar/browser/interactive.py\n+++ b/src/plone/app/debugtoolbar/browser/interactive.py\n@@ -1,6 +1,5 @@\n # -*- coding: utf-8 -*-\n import re\n-import cgi\n import threading\n import traceback\n import six\n@@ -18,6 +17,13 @@\n from Products.PageTemplates.Expressions import getEngine\n from Products.CMFPlone.PloneBaseTool import createExprContext\n \n+\n+try:\n+    from html import escape\n+except ImportError:\n+    from cgi import escape\n+\n+\n class Variables(object):\n     """Store local variables. Allow one set of variables per user id, and\n     invalidate if the path of the context changes.\n@@ -58,7 +64,8 @@ def htmlQuote(v):\n     # Borrowed from Paste\n     if v is None:\n         return \'\'\n-    return cgi.escape(str(v), 1)\n+    return escape(str(v), 1)\n+\n \n def preserveWhitespace(v, quote=True):\n     # Borrowed from Paste\n'

