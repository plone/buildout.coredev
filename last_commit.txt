Repository: plone.app.linkintegrity


Branch: refs/heads/master
Date: 2021-02-25T21:52:03+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.linkintegrity/commit/5a36a7455db64635b97ebc91a4a9e8cbe4ebfb3a

Use base64.decodebytes instead of decodestring when possible.

Fixes Python 3.9 compatibility in the tests.

Files changed:
A news/81.bugfix
M plone/app/linkintegrity/testing.py

b"diff --git a/news/81.bugfix b/news/81.bugfix\nnew file mode 100644\nindex 0000000..b218d1d\n--- /dev/null\n+++ b/news/81.bugfix\n@@ -0,0 +1,3 @@\n+Use base64.decodebytes instead of decodestring when possible.\n+Fixes Python 3.9 compatibility in the tests.\n+[maurits]\ndiff --git a/plone/app/linkintegrity/testing.py b/plone/app/linkintegrity/testing.py\nindex bd1cd96..bc7ae30 100644\n--- a/plone/app/linkintegrity/testing.py\n+++ b/plone/app/linkintegrity/testing.py\n@@ -1,5 +1,4 @@\n # -*- coding: utf-8 -*-\n-from base64 import decodestring\n from plone.app.contenttypes.testing import PLONE_APP_CONTENTTYPES_FIXTURE\n from plone.app.contenttypes.testing import PLONE_APP_CONTENTTYPES_MIGRATION_FIXTURE  # noqa\n from plone.app.testing import layers\n@@ -17,9 +16,15 @@\n \n import six\n \n+try:\n+    from base64 import decodebytes\n+except ImportError:\n+    # BBB for Python 2\n+    from base64 import decodestring as decodebytes\n+\n \n B64_DATA = b'R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs='\n-GIF = six.BytesIO(decodestring(B64_DATA))\n+GIF = six.BytesIO(decodebytes(B64_DATA))\n GIF.filename = 'sample.gif'\n GIF.contentType = 'image/gif'\n GIF._width = 1\n"

Repository: plone.app.linkintegrity


Branch: refs/heads/master
Date: 2021-02-26T16:49:55+01:00
Author: Maurits van Rees (mauritsvanrees) <m.van.rees@zestsoftware.nl>
Commit: https://github.com/plone/plone.app.linkintegrity/commit/f2a20152e11583f72a6aa9caea6d3824b0db4c0b

Merge pull request #82 from plone/maurits/decodestring-decodebytes

Use base64.decodebytes instead of decodestring when possible.

Files changed:
A news/81.bugfix
M plone/app/linkintegrity/testing.py

b"diff --git a/news/81.bugfix b/news/81.bugfix\nnew file mode 100644\nindex 0000000..b218d1d\n--- /dev/null\n+++ b/news/81.bugfix\n@@ -0,0 +1,3 @@\n+Use base64.decodebytes instead of decodestring when possible.\n+Fixes Python 3.9 compatibility in the tests.\n+[maurits]\ndiff --git a/plone/app/linkintegrity/testing.py b/plone/app/linkintegrity/testing.py\nindex bd1cd96..bc7ae30 100644\n--- a/plone/app/linkintegrity/testing.py\n+++ b/plone/app/linkintegrity/testing.py\n@@ -1,5 +1,4 @@\n # -*- coding: utf-8 -*-\n-from base64 import decodestring\n from plone.app.contenttypes.testing import PLONE_APP_CONTENTTYPES_FIXTURE\n from plone.app.contenttypes.testing import PLONE_APP_CONTENTTYPES_MIGRATION_FIXTURE  # noqa\n from plone.app.testing import layers\n@@ -17,9 +16,15 @@\n \n import six\n \n+try:\n+    from base64 import decodebytes\n+except ImportError:\n+    # BBB for Python 2\n+    from base64 import decodestring as decodebytes\n+\n \n B64_DATA = b'R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs='\n-GIF = six.BytesIO(decodestring(B64_DATA))\n+GIF = six.BytesIO(decodebytes(B64_DATA))\n GIF.filename = 'sample.gif'\n GIF.contentType = 'image/gif'\n GIF._width = 1\n"

