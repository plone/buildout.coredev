Repository: plone.staticresources


Branch: refs/heads/1.x
Date: 2022-03-23T16:02:35+01:00
Author: Paul Grunewald (pgrunewald) <paul.grunewald@tu-dresden.de>
Commit: https://github.com/plone/plone.staticresources/commit/bc348ff6948328340cb45b29f8d336202462ea08

Omit system paths in compiled js files

Files changed:
A news/195.bugfix
M src/plone/staticresources/_scripts/_generate_gruntfile.py

b'diff --git a/news/195.bugfix b/news/195.bugfix\nnew file mode 100644\nindex 000000000..35bc87800\n--- /dev/null\n+++ b/news/195.bugfix\n@@ -0,0 +1,2 @@\n+Omit system paths in compiled js files.\n+[pgrunewald]\ndiff --git a/src/plone/staticresources/_scripts/_generate_gruntfile.py b/src/plone/staticresources/_scripts/_generate_gruntfile.py\nindex 133f7951e..048ff4913 100644\n--- a/src/plone/staticresources/_scripts/_generate_gruntfile.py\n+++ b/src/plone/staticresources/_scripts/_generate_gruntfile.py\n@@ -527,6 +527,17 @@ def resource_to_dir(resource, file_type=".js"):\n                     "in {}".format(bundle.__prefix__)\n                 )\n \n+            for js_file in js_files:\n+                sed_id = "sed" + str(sed_count)\n+                sed_task_ids.append("sed:{0}".format(sed_id))\n+                sed_cfg_final += SED_CONFIG_TEMPLATE.format(\n+                    path=js_file,\n+                    name=sed_id,\n+                    pattern=os.getcwd(),\n+                    destination="",\n+                )\n+                sed_count += 1\n+\n             uc = UGLIFY_CONFIG_TEMPLATE.format(\n                 bkey=bkey,\n                 destination=js_target_path + "/" + js_target_name,\n'

Repository: plone.staticresources


Branch: refs/heads/1.x
Date: 2022-06-02T18:05:21+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.staticresources/commit/0dc8f0b9e9bc025f87c387df0860a68938366347

Merge pull request #197 from plone/pgrunewald-cwd-fix-1.x

Omit system paths in compiled js files

Files changed:
A news/195.bugfix
M src/plone/staticresources/_scripts/_generate_gruntfile.py

b'diff --git a/news/195.bugfix b/news/195.bugfix\nnew file mode 100644\nindex 000000000..35bc87800\n--- /dev/null\n+++ b/news/195.bugfix\n@@ -0,0 +1,2 @@\n+Omit system paths in compiled js files.\n+[pgrunewald]\ndiff --git a/src/plone/staticresources/_scripts/_generate_gruntfile.py b/src/plone/staticresources/_scripts/_generate_gruntfile.py\nindex 133f7951e..048ff4913 100644\n--- a/src/plone/staticresources/_scripts/_generate_gruntfile.py\n+++ b/src/plone/staticresources/_scripts/_generate_gruntfile.py\n@@ -527,6 +527,17 @@ def resource_to_dir(resource, file_type=".js"):\n                     "in {}".format(bundle.__prefix__)\n                 )\n \n+            for js_file in js_files:\n+                sed_id = "sed" + str(sed_count)\n+                sed_task_ids.append("sed:{0}".format(sed_id))\n+                sed_cfg_final += SED_CONFIG_TEMPLATE.format(\n+                    path=js_file,\n+                    name=sed_id,\n+                    pattern=os.getcwd(),\n+                    destination="",\n+                )\n+                sed_count += 1\n+\n             uc = UGLIFY_CONFIG_TEMPLATE.format(\n                 bkey=bkey,\n                 destination=js_target_path + "/" + js_target_name,\n'

