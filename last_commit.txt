Repository: plone.app.multilingual


Branch: refs/heads/master
Date: 2020-09-03T16:02:55+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.multilingual/commit/3428824e00e6a4745859f890817bc7e2507686f2

Fixed deprecation warning for ILanguageSchema, depend on plone.i18n 4.0.4.

We were already depending on Products.CMFPlone&gt;=5.2rc4, which by default uses plone.i18n 4.0.4.
Now we unconditionally import ILanguageSchema from plone.i18n.
Should be fine, because the master branch of plone.app.multilingual is for Plone 5.2+.

Files changed:
M news/3130.bugfix
M setup.py
M src/plone/app/multilingual/interfaces.py
M src/plone/app/multilingual/tests/test_helper_views.py

b"diff --git a/news/3130.bugfix b/news/3130.bugfix\nindex 4e024b60..d68761ca 100644\n--- a/news/3130.bugfix\n+++ b/news/3130.bugfix\n@@ -1,2 +1,3 @@\n Fixed deprecation warning for ComponentLookupError.\n+Fixed deprecation warning for ILanguageSchema, depend on ``plone.i18n`` 4.0.4.\n [maurits]\ndiff --git a/setup.py b/setup.py\nindex 3848b984..0dd19a15 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -11,6 +11,7 @@\n     include_package_data=True,\n     zip_safe=False,\n     install_requires=[\n+        'plone.i18n>=4.0.4',\n         'Products.CMFPlone>=5.2rc4',\n         'setuptools',\n         'six',\ndiff --git a/src/plone/app/multilingual/interfaces.py b/src/plone/app/multilingual/interfaces.py\nindex aa1e83d3..cde3ca5a 100644\n--- a/src/plone/app/multilingual/interfaces.py\n+++ b/src/plone/app/multilingual/interfaces.py\n@@ -1,6 +1,7 @@\n # -*- coding: utf-8 -*-\n from plone.app.multilingual import _\n from plone.app.z3cform.interfaces import IPloneFormLayer\n+from plone.i18n.interfaces import ILanguageSchema\n from plone.supermodel import model\n from zope import schema\n from zope.interface import Attribute\n@@ -8,12 +9,6 @@\n from zope.schema.vocabulary import SimpleTerm\n from zope.schema.vocabulary import SimpleVocabulary\n \n-try:\n-    from plone.i18n.interfaces import ILanguageSchema\n-except ImportError:\n-    # BBB for Plone 5.1, remove with Plone 6\n-    from Products.CMFPlone.interfaces import ILanguageSchema\n-\n \n # CONSTANTS\n SHARED_NAME = 'shared'\ndiff --git a/src/plone/app/multilingual/tests/test_helper_views.py b/src/plone/app/multilingual/tests/test_helper_views.py\nindex cad7464b..9f3f07ff 100644\n--- a/src/plone/app/multilingual/tests/test_helper_views.py\n+++ b/src/plone/app/multilingual/tests/test_helper_views.py\n@@ -7,10 +7,10 @@\n from plone.app.testing import TEST_USER_NAME\n from plone.app.testing import TEST_USER_PASSWORD\n from plone.dexterity.utils import createContentInContainer\n+from plone.i18n.interfaces import ILanguageSchema\n from plone.registry.interfaces import IRegistry\n from plone.testing.z2 import Browser\n from Products.CMFPlone.interfaces import ILanguage\n-from Products.CMFPlone.interfaces import ILanguageSchema\n from zope.component import getUtility\n from zope.interface import alsoProvides\n \n"

Repository: plone.app.multilingual


Branch: refs/heads/master
Date: 2020-09-03T16:06:20+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.multilingual/commit/95f51a371ad708b6e1b7acf574185330c427fed9

Fixed deprecation warning for IObjectEvent from zope.component.

Files changed:
M news/3130.bugfix
M src/plone/app/multilingual/events.py

b'diff --git a/news/3130.bugfix b/news/3130.bugfix\nindex d68761ca..0919be68 100644\n--- a/news/3130.bugfix\n+++ b/news/3130.bugfix\n@@ -1,3 +1,4 @@\n Fixed deprecation warning for ComponentLookupError.\n Fixed deprecation warning for ILanguageSchema, depend on ``plone.i18n`` 4.0.4.\n+Fixed deprecation warning for IObjectEvent from zope.component.\n [maurits]\ndiff --git a/src/plone/app/multilingual/events.py b/src/plone/app/multilingual/events.py\nindex b51ce8c0..f7ec2b70 100644\n--- a/src/plone/app/multilingual/events.py\n+++ b/src/plone/app/multilingual/events.py\n@@ -1,7 +1,7 @@\n # -*- coding: utf-8 -*-\n-from zope.component.interfaces import IObjectEvent\n from zope.interface import Attribute\n from zope.interface import implementer\n+from zope.interface.interfaces import IObjectEvent\n \n \n class IObjectWillBeTranslatedEvent(IObjectEvent):\n'

Repository: plone.app.multilingual


Branch: refs/heads/master
Date: 2020-09-03T16:07:35+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.multilingual/commit/4b2d4299ce1ed775ae630f93573132714ed91331

Fixed deprecation warning for zope.site.hooks.

Files changed:
M news/3130.bugfix
M src/plone/app/multilingual/manager.py

b'diff --git a/news/3130.bugfix b/news/3130.bugfix\nindex 0919be68..3bd256f1 100644\n--- a/news/3130.bugfix\n+++ b/news/3130.bugfix\n@@ -1,4 +1,5 @@\n Fixed deprecation warning for ComponentLookupError.\n Fixed deprecation warning for ILanguageSchema, depend on ``plone.i18n`` 4.0.4.\n Fixed deprecation warning for IObjectEvent from zope.component.\n+Fixed deprecation warning for zope.site.hooks.\n [maurits]\ndiff --git a/src/plone/app/multilingual/manager.py b/src/plone/app/multilingual/manager.py\nindex aa541e94..8981e66b 100644\n--- a/src/plone/app/multilingual/manager.py\n+++ b/src/plone/app/multilingual/manager.py\n@@ -16,9 +16,9 @@\n from plone.uuid.interfaces import IUUID\n from Products.CMFCore.utils import getToolByName\n from Products.CMFPlone.interfaces import ILanguage\n+from zope.component.hooks import getSite\n from zope.event import notify\n from zope.interface import implementer\n-from zope.site.hooks import getSite\n \n \n @implementer(ITranslationManager)\n'

Repository: plone.app.multilingual


Branch: refs/heads/master
Date: 2020-09-03T18:26:39+02:00
Author: Maurits van Rees (mauritsvanrees) <m.van.rees@zestsoftware.nl>
Commit: https://github.com/plone/plone.app.multilingual/commit/2bc08b022dd973a3261d3d5e68a49d862615c880

Merge pull request #381 from plone/maurits/fix-warnings-2

Fix three deprecation warnings.

Files changed:
M news/3130.bugfix
M setup.py
M src/plone/app/multilingual/events.py
M src/plone/app/multilingual/interfaces.py
M src/plone/app/multilingual/manager.py
M src/plone/app/multilingual/tests/test_helper_views.py

b"diff --git a/news/3130.bugfix b/news/3130.bugfix\nindex 4e024b60..3bd256f1 100644\n--- a/news/3130.bugfix\n+++ b/news/3130.bugfix\n@@ -1,2 +1,5 @@\n Fixed deprecation warning for ComponentLookupError.\n+Fixed deprecation warning for ILanguageSchema, depend on ``plone.i18n`` 4.0.4.\n+Fixed deprecation warning for IObjectEvent from zope.component.\n+Fixed deprecation warning for zope.site.hooks.\n [maurits]\ndiff --git a/setup.py b/setup.py\nindex 3848b984..0dd19a15 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -11,6 +11,7 @@\n     include_package_data=True,\n     zip_safe=False,\n     install_requires=[\n+        'plone.i18n>=4.0.4',\n         'Products.CMFPlone>=5.2rc4',\n         'setuptools',\n         'six',\ndiff --git a/src/plone/app/multilingual/events.py b/src/plone/app/multilingual/events.py\nindex b51ce8c0..f7ec2b70 100644\n--- a/src/plone/app/multilingual/events.py\n+++ b/src/plone/app/multilingual/events.py\n@@ -1,7 +1,7 @@\n # -*- coding: utf-8 -*-\n-from zope.component.interfaces import IObjectEvent\n from zope.interface import Attribute\n from zope.interface import implementer\n+from zope.interface.interfaces import IObjectEvent\n \n \n class IObjectWillBeTranslatedEvent(IObjectEvent):\ndiff --git a/src/plone/app/multilingual/interfaces.py b/src/plone/app/multilingual/interfaces.py\nindex aa1e83d3..cde3ca5a 100644\n--- a/src/plone/app/multilingual/interfaces.py\n+++ b/src/plone/app/multilingual/interfaces.py\n@@ -1,6 +1,7 @@\n # -*- coding: utf-8 -*-\n from plone.app.multilingual import _\n from plone.app.z3cform.interfaces import IPloneFormLayer\n+from plone.i18n.interfaces import ILanguageSchema\n from plone.supermodel import model\n from zope import schema\n from zope.interface import Attribute\n@@ -8,12 +9,6 @@\n from zope.schema.vocabulary import SimpleTerm\n from zope.schema.vocabulary import SimpleVocabulary\n \n-try:\n-    from plone.i18n.interfaces import ILanguageSchema\n-except ImportError:\n-    # BBB for Plone 5.1, remove with Plone 6\n-    from Products.CMFPlone.interfaces import ILanguageSchema\n-\n \n # CONSTANTS\n SHARED_NAME = 'shared'\ndiff --git a/src/plone/app/multilingual/manager.py b/src/plone/app/multilingual/manager.py\nindex aa541e94..8981e66b 100644\n--- a/src/plone/app/multilingual/manager.py\n+++ b/src/plone/app/multilingual/manager.py\n@@ -16,9 +16,9 @@\n from plone.uuid.interfaces import IUUID\n from Products.CMFCore.utils import getToolByName\n from Products.CMFPlone.interfaces import ILanguage\n+from zope.component.hooks import getSite\n from zope.event import notify\n from zope.interface import implementer\n-from zope.site.hooks import getSite\n \n \n @implementer(ITranslationManager)\ndiff --git a/src/plone/app/multilingual/tests/test_helper_views.py b/src/plone/app/multilingual/tests/test_helper_views.py\nindex cad7464b..9f3f07ff 100644\n--- a/src/plone/app/multilingual/tests/test_helper_views.py\n+++ b/src/plone/app/multilingual/tests/test_helper_views.py\n@@ -7,10 +7,10 @@\n from plone.app.testing import TEST_USER_NAME\n from plone.app.testing import TEST_USER_PASSWORD\n from plone.dexterity.utils import createContentInContainer\n+from plone.i18n.interfaces import ILanguageSchema\n from plone.registry.interfaces import IRegistry\n from plone.testing.z2 import Browser\n from Products.CMFPlone.interfaces import ILanguage\n-from Products.CMFPlone.interfaces import ILanguageSchema\n from zope.component import getUtility\n from zope.interface import alsoProvides\n \n"

