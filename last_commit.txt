Repository: mockup


Branch: refs/heads/master
Date: 2020-04-02T15:49:03+02:00
Author: Mikel Larreategi (erral) <mlarreategi@codesyntax.com>
Commit: https://github.com/plone/mockup/commit/519c995b7622dcd93a8c03c3432eb08c39751433

add popover after each button

Files changed:
A news/963.bugfix
M mockup/patterns/structure/js/views/app.js

b'diff --git a/mockup/patterns/structure/js/views/app.js b/mockup/patterns/structure/js/views/app.js\nindex dc44ffad4..e87d8ff74 100644\n--- a/mockup/patterns/structure/js/views/app.js\n+++ b/mockup/patterns/structure/js/views/app.js\n@@ -41,6 +41,7 @@ define([\n \n     buttons: null,\n     textfilter: null,\n+    forms: [],\n \n     pasteAllowed: function () {\n         return !!$.cookie(\'__cp\');\n@@ -93,7 +94,7 @@ define([\n         collection: self.selectedCollection,\n         triggerView: self.toolbar.get(\'selected-items\'),\n         app: self,\n-        id: \'structure-well\'\n+        id: \'selected-items\'\n       });\n \n       self.toolbar.get(\'selected-items\').disable();\n@@ -358,7 +359,7 @@ define([\n       var items = [];\n \n       var columnsBtn = new ButtonView({\n-        id: \'attribute-columns\',\n+        id: \'structure-columns\',\n         tooltip: _t(\'Configure displayed columns\'),\n         icon: \'th\'\n       });\n@@ -379,7 +380,7 @@ define([\n \n       if (self.options.rearrange) {\n         var rearrangeButton = new ButtonView({\n-          id: \'rearrange\',\n+          id: \'structure-rearrange\',\n           title: _t(\'Rearrange\'),\n           icon: \'sort-by-attributes\',\n           tooltip: _t(\'Rearrange folder contents\'),\n@@ -401,7 +402,8 @@ define([\n         });\n         self.uploadView = new UploadView({\n           triggerView: uploadButton,\n-          app: self\n+          app: self,\n+          id: \'upload\'\n         });\n         items.push(uploadButton);\n       }\n@@ -416,7 +418,7 @@ define([\n             buttonOptions.triggerView = button;\n             buttonOptions.app = self;\n             var view = new GenericPopover(buttonOptions);\n-            self.$el.append(view.el);\n+            self.forms.push(view.el);\n           } else {\n             button.on(\'button:click\', self.buttonClickEvent, self);\n           }\n@@ -541,14 +543,23 @@ define([\n       var self = this;\n \n       self.$el.append(self.toolbar.render().el);\n-      self.$el.append(self.wellView.render().el);\n+      if (self.wellView) {\n+        self.$el.find(\'#btn-\' + self.wellView.id).after(self.wellView.render().el)\n+      }\n+      self.forms.forEach(function(element) {\n+        var id = $(element).attr(\'id\')\n+        self.$el.find(\'#btn-\'+id).after(element)\n+      });\n+\n       self.$el.append(utils.createElementFromHTML(\'<div class="fc-status-container"></div>\'));\n-      self.$el.append(self.columnsView.render().el);\n+      if (self.columnsView) {\n+        self.$el.find(\'#btn-\' + self.columnsView.id).after(self.columnsView.render().el)\n+      }\n       if (self.rearrangeView) {\n-        self.$el.append(self.rearrangeView.render().el);\n+        self.$el.find(\'#btn-\' + self.rearrangeView.id).after(self.rearrangeView.render().el)\n       }\n       if (self.uploadView) {\n-        self.$el.append(self.uploadView.render().el);\n+        self.$el.find(\'#btn-\' + self.uploadView.id).after(self.uploadView.render().el)\n       }\n \n       self.$el.append(self.tableView.render().el);\ndiff --git a/news/963.bugfix b/news/963.bugfix\nnew file mode 100644\nindex 000000000..8c923a088\n--- /dev/null\n+++ b/news/963.bugfix\n@@ -0,0 +1,2 @@\n+Reorder items to show popover just after their corresponding button to be able to tab-navigate to them\n+[erral & ionlizarazu]\n'

Repository: mockup


Branch: refs/heads/master
Date: 2020-04-09T13:21:02+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/mockup/commit/6174648b8c19e7886fdd53aa564e1b4f5beea534

Merge pull request #964 from plone/erral-a11y-structure-item-order

add popover after each button

Files changed:
A news/963.bugfix
M mockup/patterns/structure/js/views/app.js

b'diff --git a/mockup/patterns/structure/js/views/app.js b/mockup/patterns/structure/js/views/app.js\nindex dc44ffad4..e87d8ff74 100644\n--- a/mockup/patterns/structure/js/views/app.js\n+++ b/mockup/patterns/structure/js/views/app.js\n@@ -41,6 +41,7 @@ define([\n \n     buttons: null,\n     textfilter: null,\n+    forms: [],\n \n     pasteAllowed: function () {\n         return !!$.cookie(\'__cp\');\n@@ -93,7 +94,7 @@ define([\n         collection: self.selectedCollection,\n         triggerView: self.toolbar.get(\'selected-items\'),\n         app: self,\n-        id: \'structure-well\'\n+        id: \'selected-items\'\n       });\n \n       self.toolbar.get(\'selected-items\').disable();\n@@ -358,7 +359,7 @@ define([\n       var items = [];\n \n       var columnsBtn = new ButtonView({\n-        id: \'attribute-columns\',\n+        id: \'structure-columns\',\n         tooltip: _t(\'Configure displayed columns\'),\n         icon: \'th\'\n       });\n@@ -379,7 +380,7 @@ define([\n \n       if (self.options.rearrange) {\n         var rearrangeButton = new ButtonView({\n-          id: \'rearrange\',\n+          id: \'structure-rearrange\',\n           title: _t(\'Rearrange\'),\n           icon: \'sort-by-attributes\',\n           tooltip: _t(\'Rearrange folder contents\'),\n@@ -401,7 +402,8 @@ define([\n         });\n         self.uploadView = new UploadView({\n           triggerView: uploadButton,\n-          app: self\n+          app: self,\n+          id: \'upload\'\n         });\n         items.push(uploadButton);\n       }\n@@ -416,7 +418,7 @@ define([\n             buttonOptions.triggerView = button;\n             buttonOptions.app = self;\n             var view = new GenericPopover(buttonOptions);\n-            self.$el.append(view.el);\n+            self.forms.push(view.el);\n           } else {\n             button.on(\'button:click\', self.buttonClickEvent, self);\n           }\n@@ -541,14 +543,23 @@ define([\n       var self = this;\n \n       self.$el.append(self.toolbar.render().el);\n-      self.$el.append(self.wellView.render().el);\n+      if (self.wellView) {\n+        self.$el.find(\'#btn-\' + self.wellView.id).after(self.wellView.render().el)\n+      }\n+      self.forms.forEach(function(element) {\n+        var id = $(element).attr(\'id\')\n+        self.$el.find(\'#btn-\'+id).after(element)\n+      });\n+\n       self.$el.append(utils.createElementFromHTML(\'<div class="fc-status-container"></div>\'));\n-      self.$el.append(self.columnsView.render().el);\n+      if (self.columnsView) {\n+        self.$el.find(\'#btn-\' + self.columnsView.id).after(self.columnsView.render().el)\n+      }\n       if (self.rearrangeView) {\n-        self.$el.append(self.rearrangeView.render().el);\n+        self.$el.find(\'#btn-\' + self.rearrangeView.id).after(self.rearrangeView.render().el)\n       }\n       if (self.uploadView) {\n-        self.$el.append(self.uploadView.render().el);\n+        self.$el.find(\'#btn-\' + self.uploadView.id).after(self.uploadView.render().el)\n       }\n \n       self.$el.append(self.tableView.render().el);\ndiff --git a/news/963.bugfix b/news/963.bugfix\nnew file mode 100644\nindex 000000000..8c923a088\n--- /dev/null\n+++ b/news/963.bugfix\n@@ -0,0 +1,2 @@\n+Reorder items to show popover just after their corresponding button to be able to tab-navigate to them\n+[erral & ionlizarazu]\n'

