Repository: plone.app.content


Branch: refs/heads/master
Date: 2023-05-18T10:46:48+02:00
Author: Roel Bruggink (jaroel) <roel@jaroel.nl>
Commit: https://github.com/plone/plone.app.content/commit/67764fe3304cd4d761c0025501de6160f268bc64

Fixup test_delete_wrong_object_by_acquisition_with_action.

We won't publish acquired content items anymore.

Files changed:
A news/explicitacquisition.bugfix
M plone/app/content/tests/test_actions.py

b'diff --git a/news/explicitacquisition.bugfix b/news/explicitacquisition.bugfix\nnew file mode 100644\nindex 00000000..4c04dddb\n--- /dev/null\n+++ b/news/explicitacquisition.bugfix\n@@ -0,0 +1 @@\n+- Fixup test_delete_wrong_object_by_acquisition_with_action. We don\'t publish acquired content items anymore.  [jaroel]\ndiff --git a/plone/app/content/tests/test_actions.py b/plone/app/content/tests/test_actions.py\nindex 7b5f7279..62108fda 100644\n--- a/plone/app/content/tests/test_actions.py\n+++ b/plone/app/content/tests/test_actions.py\n@@ -8,7 +8,7 @@\n from plone.locking.interfaces import ILockable\n from plone.testing.zope import Browser\n from z3c.form.interfaces import IFormLayer\n-from zExceptions import Unauthorized\n+from zExceptions import Unauthorized, NotFound\n from zope.component import getMultiAdapter\n from zope.interface import alsoProvides\n \n@@ -17,14 +17,15 @@\n \n \n class ActionsDXTestCase(unittest.TestCase):\n-\n     layer = PLONE_APP_CONTENT_DX_FUNCTIONAL_TESTING\n \n     def setUp(self):\n         self.portal = self.layer["portal"]\n         self.request = self.layer["request"]\n \n-        self.portal.acl_users.userFolderAddUser("editor", TEST_USER_PASSWORD, ["Editor"], [])\n+        self.portal.acl_users.userFolderAddUser(\n+            "editor", TEST_USER_PASSWORD, ["Editor"], []\n+        )\n \n         # For z3c.forms request must provide IFormLayer\n         alsoProvides(self.request, IFormLayer)\n@@ -142,8 +143,13 @@ def test_delete_wrong_object_by_acquisition_with_action(self):\n         self.browser.open(delete_url)\n         browser_2.open(delete_url)\n         self.assertTrue(p1_id in self.portal)\n-        for browser in [self.browser, browser_2]:\n-            browser.getControl(name="form.buttons.Delete").click()\n+\n+        # Try to delete in both browsers\n+        self.browser.getControl(name="form.buttons.Delete").click()\n+        try:\n+            browser_2.getControl(name="form.buttons.Delete").click()\n+        except NotFound:\n+            pass\n \n         # the nested folder should be gone, but the one at the root should\n         # remain.\n'

Repository: plone.app.content


Branch: refs/heads/master
Date: 2023-05-19T09:06:09+02:00
Author: Roel Bruggink (jaroel) <roel@jaroel.nl>
Commit: https://github.com/plone/plone.app.content/commit/6246dd8bd3e60119c7a305b8c2eda09ea0a73218

whitespace

Files changed:
M plone/app/content/tests/profiles/non-ascii-workflow.zcml

b'diff --git a/plone/app/content/tests/profiles/non-ascii-workflow.zcml b/plone/app/content/tests/profiles/non-ascii-workflow.zcml\nindex 2f4ff415..1f2ac79a 100644\n--- a/plone/app/content/tests/profiles/non-ascii-workflow.zcml\n+++ b/plone/app/content/tests/profiles/non-ascii-workflow.zcml\n@@ -12,4 +12,3 @@\n         />\n \n </configure>\n-\n'

Repository: plone.app.content


Branch: refs/heads/master
Date: 2023-06-14T11:14:44+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.content/commit/1d62ccb39ef01cef426d4ab504219b0d13c866bf

Merge pull request #263 from plone/explicitacquisition

Fixup test_delete_wrong_object_by_acquisition_with_action.

Files changed:
A news/explicitacquisition.bugfix
M plone/app/content/tests/profiles/non-ascii-workflow.zcml
M plone/app/content/tests/test_actions.py

b'diff --git a/news/explicitacquisition.bugfix b/news/explicitacquisition.bugfix\nnew file mode 100644\nindex 00000000..4c04dddb\n--- /dev/null\n+++ b/news/explicitacquisition.bugfix\n@@ -0,0 +1 @@\n+- Fixup test_delete_wrong_object_by_acquisition_with_action. We don\'t publish acquired content items anymore.  [jaroel]\ndiff --git a/plone/app/content/tests/profiles/non-ascii-workflow.zcml b/plone/app/content/tests/profiles/non-ascii-workflow.zcml\nindex 2f4ff415..1f2ac79a 100644\n--- a/plone/app/content/tests/profiles/non-ascii-workflow.zcml\n+++ b/plone/app/content/tests/profiles/non-ascii-workflow.zcml\n@@ -12,4 +12,3 @@\n         />\n \n </configure>\n-\ndiff --git a/plone/app/content/tests/test_actions.py b/plone/app/content/tests/test_actions.py\nindex 7b5f7279..62108fda 100644\n--- a/plone/app/content/tests/test_actions.py\n+++ b/plone/app/content/tests/test_actions.py\n@@ -8,7 +8,7 @@\n from plone.locking.interfaces import ILockable\n from plone.testing.zope import Browser\n from z3c.form.interfaces import IFormLayer\n-from zExceptions import Unauthorized\n+from zExceptions import Unauthorized, NotFound\n from zope.component import getMultiAdapter\n from zope.interface import alsoProvides\n \n@@ -17,14 +17,15 @@\n \n \n class ActionsDXTestCase(unittest.TestCase):\n-\n     layer = PLONE_APP_CONTENT_DX_FUNCTIONAL_TESTING\n \n     def setUp(self):\n         self.portal = self.layer["portal"]\n         self.request = self.layer["request"]\n \n-        self.portal.acl_users.userFolderAddUser("editor", TEST_USER_PASSWORD, ["Editor"], [])\n+        self.portal.acl_users.userFolderAddUser(\n+            "editor", TEST_USER_PASSWORD, ["Editor"], []\n+        )\n \n         # For z3c.forms request must provide IFormLayer\n         alsoProvides(self.request, IFormLayer)\n@@ -142,8 +143,13 @@ def test_delete_wrong_object_by_acquisition_with_action(self):\n         self.browser.open(delete_url)\n         browser_2.open(delete_url)\n         self.assertTrue(p1_id in self.portal)\n-        for browser in [self.browser, browser_2]:\n-            browser.getControl(name="form.buttons.Delete").click()\n+\n+        # Try to delete in both browsers\n+        self.browser.getControl(name="form.buttons.Delete").click()\n+        try:\n+            browser_2.getControl(name="form.buttons.Delete").click()\n+        except NotFound:\n+            pass\n \n         # the nested folder should be gone, but the one at the root should\n         # remain.\n'

