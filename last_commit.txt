Repository: plone.app.testing


Branch: refs/heads/master
Date: 2020-09-18T14:04:14+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.testing/commit/527a3a347466481e9c5d1d3b92c2ffacf1e06c08

Fixed test failure on Python 3 with Products.MailHost 4.10.

Files changed:
A news/3178.bugfix
M src/plone/app/testing/layers.rst

b'diff --git a/news/3178.bugfix b/news/3178.bugfix\nnew file mode 100644\nindex 0000000..0418895\n--- /dev/null\n+++ b/news/3178.bugfix\n@@ -0,0 +1,2 @@\n+Fixed test failure on Python 3 with Products.MailHost 4.10.\n+[maurits]\ndiff --git a/src/plone/app/testing/layers.rst b/src/plone/app/testing/layers.rst\nindex 3989062..89656f1 100644\n--- a/src/plone/app/testing/layers.rst\n+++ b/src/plone/app/testing/layers.rst\n@@ -440,7 +440,7 @@ If we send a message, we can check it in the list:\n     ...     )\n     >>> with helpers.ploneSite() as portal:\n     ...     for message in portal.MailHost.messages:\n-    ...         print(message)\n+    ...         print(message.decode("utf-8"))\n     MIME-Version: 1.0\n     Content-Type: text/plain\n     Subject: Test\n'

Repository: plone.app.testing


Branch: refs/heads/master
Date: 2020-09-25T12:59:11+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.testing/commit/09097ea5b58f16d4756e10c2310fc574cb29a45b

tox.ini: use isort 4, fix wrong tests argument for flake8.

isort 5 requires changes, either in our code or in our config.
We could do that some other time.  Now I just want these lint jobs to be green.

`flake8` failed with:

```
lint-py27 run-test: commands[2] | flake8 --doctests src tests setup.py
tests:0:1: E902 IOError: [Errno 2] No such file or directory: 'tests'
```

So I removed the `tests` argument.
Everything is in `src` and I don't know how this passed before.
I guess a newer flake8 version is more strict.

Files changed:
M tox.ini

b'diff --git a/tox.ini b/tox.ini\nindex 0817a80..514dfb1 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -59,7 +59,7 @@ commands =\n skip_install = true\n \n deps =\n-    isort\n+    isort < 5\n     flake8\n     # helper to generate HTML reports:\n     flake8-html\n@@ -87,7 +87,7 @@ deps =\n commands =\n     mkdir -p {toxinidir}/_build/reports/flake8\n     - flake8 --format=html --htmldir={toxinidir}/_build/reports/flake8 --doctests src setup.py\n-    flake8 --doctests src tests setup.py\n+    flake8 --doctests src setup.py\n     isort --check-only --recursive {toxinidir}/src\n \n whitelist_externals =\n'

Repository: plone.app.testing


Branch: refs/heads/master
Date: 2020-09-25T16:41:02+02:00
Author: Maurits van Rees (mauritsvanrees) <m.van.rees@zestsoftware.nl>
Commit: https://github.com/plone/plone.app.testing/commit/a7e7b39663f76203ff66b6a84f64aa05e937a436

Merge pull request #70 from plone/mailhost-410

Fixed test failure on Python 3 with Products.MailHost 4.10.

Files changed:
A news/3178.bugfix
M src/plone/app/testing/layers.rst
M tox.ini

b'diff --git a/news/3178.bugfix b/news/3178.bugfix\nnew file mode 100644\nindex 0000000..0418895\n--- /dev/null\n+++ b/news/3178.bugfix\n@@ -0,0 +1,2 @@\n+Fixed test failure on Python 3 with Products.MailHost 4.10.\n+[maurits]\ndiff --git a/src/plone/app/testing/layers.rst b/src/plone/app/testing/layers.rst\nindex 3989062..89656f1 100644\n--- a/src/plone/app/testing/layers.rst\n+++ b/src/plone/app/testing/layers.rst\n@@ -440,7 +440,7 @@ If we send a message, we can check it in the list:\n     ...     )\n     >>> with helpers.ploneSite() as portal:\n     ...     for message in portal.MailHost.messages:\n-    ...         print(message)\n+    ...         print(message.decode("utf-8"))\n     MIME-Version: 1.0\n     Content-Type: text/plain\n     Subject: Test\ndiff --git a/tox.ini b/tox.ini\nindex 0817a80..514dfb1 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -59,7 +59,7 @@ commands =\n skip_install = true\n \n deps =\n-    isort\n+    isort < 5\n     flake8\n     # helper to generate HTML reports:\n     flake8-html\n@@ -87,7 +87,7 @@ deps =\n commands =\n     mkdir -p {toxinidir}/_build/reports/flake8\n     - flake8 --format=html --htmldir={toxinidir}/_build/reports/flake8 --doctests src setup.py\n-    flake8 --doctests src tests setup.py\n+    flake8 --doctests src setup.py\n     isort --check-only --recursive {toxinidir}/src\n \n whitelist_externals =\n'

