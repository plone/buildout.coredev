Repository: plone.formwidget.recurrence


Branch: refs/heads/master
Date: 2021-09-02T12:23:41-03:00
Author: Franco Pellegrini (frapell) <frapell@gmail.com>
Commit: https://github.com/plone/plone.formwidget.recurrence/commit/5c9320a17bf7706d01beb742a9ca41c8dffd4b37

Fix batch numbers computation. fixes gh-25

Files changed:
A news/25.bugfix
M plone/formwidget/recurrence/browser/json_recurrence.py

b"diff --git a/news/25.bugfix b/news/25.bugfix\nnew file mode 100644\nindex 0000000..cdab54d\n--- /dev/null\n+++ b/news/25.bugfix\n@@ -0,0 +1,2 @@\n+Fix batch numbers computation\n+[frapell]\ndiff --git a/plone/formwidget/recurrence/browser/json_recurrence.py b/plone/formwidget/recurrence/browser/json_recurrence.py\nindex cd2a79c..bd2ce30 100644\n--- a/plone/formwidget/recurrence/browser/json_recurrence.py\n+++ b/plone/formwidget/recurrence/browser/json_recurrence.py\n@@ -177,14 +177,14 @@ def json_string(self):\n         cur_batch = cur_batch - first_batch\n         # correct number of occurrences in current batch\n         (cur_batch_start, cur_batch_end) = batches[cur_batch]\n-        if cur_batch_end > len(occurrences):\n-            batches[cur_batch] = (cur_batch_start, len(occurrences))\n+        if cur_batch_end > num_occurrences:\n+            batches[cur_batch] = (cur_batch_start, num_occurrences)\n \n         batch_data = {'start': start,\n                       'end': num_occurrences,\n                       'batch_size': batch_size,\n                       'batches': batches,\n-                      'currentBatch': cur_batch - first_batch,\n+                      'currentBatch': cur_batch,\n                       }\n \n         result = {'occurrences': occurrences, 'batch': batch_data}\n"

Repository: plone.formwidget.recurrence


Branch: refs/heads/master
Date: 2021-10-14T12:42:39+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.formwidget.recurrence/commit/276130072daf94f078cd2a1d338cde79ee947c3e

Merge pull request #27 from plone/frapell-batch-compute-master

Fix batch numbers computation (Master)

Files changed:
A news/25.bugfix
M plone/formwidget/recurrence/browser/json_recurrence.py

b"diff --git a/news/25.bugfix b/news/25.bugfix\nnew file mode 100644\nindex 0000000..cdab54d\n--- /dev/null\n+++ b/news/25.bugfix\n@@ -0,0 +1,2 @@\n+Fix batch numbers computation\n+[frapell]\ndiff --git a/plone/formwidget/recurrence/browser/json_recurrence.py b/plone/formwidget/recurrence/browser/json_recurrence.py\nindex cd2a79c..bd2ce30 100644\n--- a/plone/formwidget/recurrence/browser/json_recurrence.py\n+++ b/plone/formwidget/recurrence/browser/json_recurrence.py\n@@ -177,14 +177,14 @@ def json_string(self):\n         cur_batch = cur_batch - first_batch\n         # correct number of occurrences in current batch\n         (cur_batch_start, cur_batch_end) = batches[cur_batch]\n-        if cur_batch_end > len(occurrences):\n-            batches[cur_batch] = (cur_batch_start, len(occurrences))\n+        if cur_batch_end > num_occurrences:\n+            batches[cur_batch] = (cur_batch_start, num_occurrences)\n \n         batch_data = {'start': start,\n                       'end': num_occurrences,\n                       'batch_size': batch_size,\n                       'batches': batches,\n-                      'currentBatch': cur_batch - first_batch,\n+                      'currentBatch': cur_batch,\n                       }\n \n         result = {'occurrences': occurrences, 'batch': batch_data}\n"

