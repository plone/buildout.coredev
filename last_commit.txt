Repository: archetypes.querywidget


Branch: refs/heads/master
Date: 2020-09-04T17:51:22+02:00
Author: Andreas Zeidler (witsch) <witsch@plone.org>
Commit: https://github.com/plone/archetypes.querywidget/commit/9325315fe657d53970eec9542ec055b5c16eda1f

Also strip `/base_edit` or `/atct_edit`

Otherwise the loaded results will be the edit view itself, which is
then injected and starts loading more results, which will be the edit
view again and so on and so onâ€¦ a.k.a. edit view inception! :)

Files changed:
M archetypes/querywidget/querywidget.js

b'diff --git a/archetypes/querywidget/querywidget.js b/archetypes/querywidget/querywidget.js\nindex 1bb6940..b8c3975 100644\n--- a/archetypes/querywidget/querywidget.js\n+++ b/archetypes/querywidget/querywidget.js\n@@ -157,7 +157,7 @@\n \n     $.querywidget.updateSearch = function () {\n         var base_url = $("base").attr("href");\n-        base_url = base_url.replace(/\\/edit$/, \'\');\n+        base_url = base_url.replace(/\\/[a-z_]*edit$/, \'\');\n         if (base_url.indexOf("portal_factory") !== -1) {\n             base_url = base_url.split("/").slice(0, -2).join("/");\n         }\n'

Repository: archetypes.querywidget


Branch: refs/heads/master
Date: 2020-09-04T17:57:03+02:00
Author: Andreas Zeidler (witsch) <witsch@plone.org>
Commit: https://github.com/plone/archetypes.querywidget/commit/901e3b3349ffa70601b12fe861adc9f95b325c57

Add change log entry for 9325315f

Files changed:
M CHANGES.rst

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex ea7bed4..2ce10ec 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,7 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- Also strip `/base_edit` or `/atct_edit` when fetching query results\n \n \n 1.1.3 (2016-08-12)\n'

Repository: archetypes.querywidget


Branch: refs/heads/master
Date: 2020-09-07T12:34:07+02:00
Author: Maurits van Rees (mauritsvanrees) <m.van.rees@zestsoftware.nl>
Commit: https://github.com/plone/archetypes.querywidget/commit/c25b729392088d5aefc24b0a903217b33c3908de

Merge pull request #16 from witsch/edit-urls

Also strip `/base_edit` or `/atct_edit` when fetching query results

Files changed:
M CHANGES.rst
M archetypes/querywidget/querywidget.js

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex ea7bed4..2ce10ec 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -14,7 +14,7 @@ New features:\n \n Bug fixes:\n \n-- *add item here*\n+- Also strip `/base_edit` or `/atct_edit` when fetching query results\n \n \n 1.1.3 (2016-08-12)\ndiff --git a/archetypes/querywidget/querywidget.js b/archetypes/querywidget/querywidget.js\nindex 1bb6940..b8c3975 100644\n--- a/archetypes/querywidget/querywidget.js\n+++ b/archetypes/querywidget/querywidget.js\n@@ -157,7 +157,7 @@\n \n     $.querywidget.updateSearch = function () {\n         var base_url = $("base").attr("href");\n-        base_url = base_url.replace(/\\/edit$/, \'\');\n+        base_url = base_url.replace(/\\/[a-z_]*edit$/, \'\');\n         if (base_url.indexOf("portal_factory") !== -1) {\n             base_url = base_url.split("/").slice(0, -2).join("/");\n         }\n'

