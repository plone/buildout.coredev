Repository: plone.memoize


Branch: refs/heads/master
Date: 2022-10-25T16:10:33-07:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.memoize/commit/95d915249976285bfb37b4a801b9ff1f317abab9

Work on supporting Python 3.11

Files changed:
A .github/workflows/tests.yml
A news/27.breaking
M plone/memoize/request.py
M setup.py
M tox.ini
D .travis.yml

b'diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\nnew file mode 100644\nindex 0000000..ed29615\n--- /dev/null\n+++ b/.github/workflows/tests.yml\n@@ -0,0 +1,28 @@\n+name: tests\n+\n+on:\n+  push:\n+    branches: [ master ]\n+  pull_request:\n+  # Allow to run this workflow manually from the Actions tab\n+  workflow_dispatch:\n+jobs:\n+  build:\n+    strategy:\n+      matrix:\n+        python_version: ["2.7", "3.7", "3.8", "3.9", "3.10", "3.11", "pypy3"]\n+    runs-on: ubuntu-latest\n+    name: ${{ matrix.python_version }}\n+    steps:\n+    - uses: actions/checkout@v3\n+    - name: Set up Python\n+      uses: actions/setup-python@v4\n+      with:\n+        python-version: ${{ matrix.python_version }}\n+        cache: pip\n+    - name: Install dependencies\n+      run: |\n+        python -m pip install --upgrade pip\n+        pip install tox\n+    - name: Test\n+      run: tox -e ${{ matrix.python_version }}\ndiff --git a/.travis.yml b/.travis.yml\ndeleted file mode 100644\nindex 8bae40c..0000000\n--- a/.travis.yml\n+++ /dev/null\n@@ -1,24 +0,0 @@\n-language: python\n-python:\n-    - 2.7\n-    - 3.5\n-    - 3.6\n-    - 3.7\n-    - 3.8\n-    - pypy\n-    - pypy3\n-install:\n-    - pip install zc.buildout\n-    - pip install coveralls coverage\n-    - buildout bootstrap\n-    - buildout install test\n-script:\n-    - coverage run bin/test -v\n-after_success:\n-    - coveralls\n-notifications:\n-    email: false\n-cache:\n-  pip: true\n-  directories:\n-    - eggs/\ndiff --git a/news/27.breaking b/news/27.breaking\nnew file mode 100644\nindex 0000000..d09a6bd\n--- /dev/null\n+++ b/news/27.breaking\n@@ -0,0 +1,2 @@\n+Drop support for Python 3.5 and 3.6.\n+Add support for Python 3.9, 3.10, and 3.11. [davisagli]\ndiff --git a/plone/memoize/request.py b/plone/memoize/request.py\nindex 29b320b..d554627 100644\n--- a/plone/memoize/request.py\n+++ b/plone/memoize/request.py\n@@ -9,6 +9,12 @@\n \n import inspect\n \n+try:\n+    getargspec = inspect.getfullargspec\n+except AttributeError:\n+    # for Python 2\n+    getargspec = inspect.getargspec\n+\n \n _marker = object()\n \n@@ -53,7 +59,7 @@ def store_in_annotation_of(expr):\n     def _store_in_annotation(fun, *args, **kwargs):\n         # Use expr to find out the name of the request variable\n         vars = {}\n-        spec = inspect.getargspec(fun)\n+        spec = getargspec(fun)\n         num_args = len(args)\n         expected_num_args = num_args\n \ndiff --git a/setup.py b/setup.py\nindex 58a775e..bf3b893 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -9,7 +9,7 @@ def read(*rnames):\n     return open(os.path.join(os.path.dirname(__file__), *rnames)).read()\n \n \n-version = "2.1.2.dev0"\n+version = "3.0.0.dev0"\n \n long_description = u"\\n".join(\n     [read("README.rst"), read("plone", "memoize", "README.rst"), read("CHANGES.rst"),]\n@@ -25,20 +25,19 @@ def read(*rnames):\n         "Development Status :: 5 - Production/Stable",\n         "Environment :: Web Environment",\n         "Framework :: Plone",\n-        "Framework :: Plone :: 5.0",\n-        "Framework :: Plone :: 5.1",\n         "Framework :: Plone :: 5.2",\n         "Framework :: Plone :: Core",\n-        "Framework :: Zope :: 2",\n         "Framework :: Zope :: 4",\n+        "Framework :: Zope :: 5",\n         "License :: OSI Approved :: BSD License",\n         "Operating System :: OS Independent",\n         "Programming Language :: Python",\n         "Programming Language :: Python :: 2.7",\n-        "Programming Language :: Python :: 3.5",\n-        "Programming Language :: Python :: 3.6",\n         "Programming Language :: Python :: 3.7",\n         "Programming Language :: Python :: 3.8",\n+        "Programming Language :: Python :: 3.9",\n+        "Programming Language :: Python :: 3.10",\n+        "Programming Language :: Python :: 3.11",\n         "Programming Language :: Python :: Implementation :: CPython",\n         "Programming Language :: Python :: Implementation :: PyPy",\n     ],\ndiff --git a/tox.ini b/tox.ini\nindex f5d10f0..a113003 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -1,9 +1,10 @@\n [tox]\n envlist = py27,\n-          py35,\n-          py36,\n           py37,\n           py38,\n+          py39,\n+          py310,\n+          py311,\n           pypy,\n           pypy3,\n           coverage-report\n@@ -21,7 +22,7 @@ setenv =\n     COVERAGE_FILE=.coverage.{envname}\n \n [testenv:coverage-report]\n-basepython = python3.6\n+basepython = python3.7\n deps = coverage\n setenv =\n     COVERAGE_FILE=.coverage\n'

Repository: plone.memoize


Branch: refs/heads/master
Date: 2022-10-25T16:12:30-07:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.memoize/commit/58cfdb7a6d58982977c4b568a2c6a1c50bab123e

Don't fail fast

Files changed:
M .github/workflows/tests.yml

b'diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\nindex ed29615..105837c 100644\n--- a/.github/workflows/tests.yml\n+++ b/.github/workflows/tests.yml\n@@ -9,6 +9,7 @@ on:\n jobs:\n   build:\n     strategy:\n+      fail-fast: false\n       matrix:\n         python_version: ["2.7", "3.7", "3.8", "3.9", "3.10", "3.11", "pypy3"]\n     runs-on: ubuntu-latest\n'

Repository: plone.memoize


Branch: refs/heads/master
Date: 2022-10-25T16:13:38-07:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.memoize/commit/f0273503f98b22016851ae4d86d9c3bc5abd536e

Remove pip cache

Files changed:
M .github/workflows/tests.yml

b'diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\nindex 105837c..c3ef30a 100644\n--- a/.github/workflows/tests.yml\n+++ b/.github/workflows/tests.yml\n@@ -20,7 +20,6 @@ jobs:\n       uses: actions/setup-python@v4\n       with:\n         python-version: ${{ matrix.python_version }}\n-        cache: pip\n     - name: Install dependencies\n       run: |\n         python -m pip install --upgrade pip\n'

Repository: plone.memoize


Branch: refs/heads/master
Date: 2022-10-25T16:38:53-07:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.memoize/commit/05320db82fccb899ad23e191680730fbb3bd4887

Remove buildout

Files changed:
M .github/workflows/tests.yml
M setup.py
M tox.ini
D buildout.cfg

b'diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\nindex c3ef30a..366c960 100644\n--- a/.github/workflows/tests.yml\n+++ b/.github/workflows/tests.yml\n@@ -11,7 +11,7 @@ jobs:\n     strategy:\n       fail-fast: false\n       matrix:\n-        python_version: ["2.7", "3.7", "3.8", "3.9", "3.10", "3.11", "pypy3"]\n+        python_version: ["2.7", "3.7", "3.8", "3.9", "3.10", "3.11", "pypy3.9"]\n     runs-on: ubuntu-latest\n     name: ${{ matrix.python_version }}\n     steps:\ndiff --git a/buildout.cfg b/buildout.cfg\ndeleted file mode 100644\nindex ab90dbd..0000000\n--- a/buildout.cfg\n+++ /dev/null\n@@ -1,37 +0,0 @@\n-[buildout]\n-extends = http://dist.plone.org/release/5-latest/versions.cfg\n-develop = .\n-parts = test\n-\n-[versions]\n-persistent = >= 4\n-python-gettext = >= 3\n-zc.recipe.testrunner = >= 2\n-zope.annotation = >= 4\n-zope.browser = >= 2\n-zope.component = >= 4\n-zope.hookable = >= 4\n-zope.deferredimport = >= 4\n-zope.configuration = >= 4\n-zope.contenttype = >= 4\n-zope.deprecation = >= 4\n-zope.event = >= 4\n-zope.exceptions = >= 4\n-zope.i18n = >= 4\n-zope.i18nmessageid = >= 4\n-zope.interface = >= 4\n-zope.location = >= 4\n-zope.proxy = >= 4\n-zope.publisher = >= 4\n-zope.ramcache = >= 2\n-zope.schema = >= 4\n-zope.security = >= 4\n-zope.testing = >= 4\n-zope.testrunner = >= 4\n-plone.memoize =\n-\n-[test]\n-recipe = zc.recipe.testrunner\n-eggs =\n-   plone.memoize [test]\n-   zope.testing\ndiff --git a/setup.py b/setup.py\nindex bf3b893..89cf3cb 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -52,7 +52,13 @@ def read(*rnames):\n     zip_safe=False,\n     test_suite="plone.memoize.tests.test_suite",\n     extras_require=dict(\n-        test=["zope.configuration", "zope.globalrequest", "zope.publisher",]\n+        test=[\n+            "zope.configuration",\n+            "zope.globalrequest",\n+            "zope.publisher",\n+            "zope.testrunner",\n+            "zope.testing",\n+        ],\n     ),\n     install_requires=[\n         "setuptools",\ndiff --git a/tox.ini b/tox.ini\nindex a113003..6dab6e9 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -6,30 +6,8 @@ envlist = py27,\n           py310,\n           py311,\n           pypy,\n-          pypy3,\n-          coverage-report\n+          pypy3.9,\n \n [testenv]\n-commands =\n-    {envbindir}/buildout -c {toxinidir}/buildout.cfg buildout:directory={envdir} buildout:develop={toxinidir} bootstrap\n-    {envbindir}/buildout -c {toxinidir}/buildout.cfg buildout:directory={envdir} buildout:develop={toxinidir} install test\n-    coverage run {envbindir}/test {posargs:-vc}\n-skip_install = true\n-deps =\n-    coverage\n-    zc.buildout\n-setenv =\n-    COVERAGE_FILE=.coverage.{envname}\n-\n-[testenv:coverage-report]\n-basepython = python3.7\n-deps = coverage\n-setenv =\n-    COVERAGE_FILE=.coverage\n-skip_install = true\n-commands =\n-    coverage erase\n-    coverage combine\n-    coverage html -i\n-    coverage xml -i\n-    coverage report -i --fail-under=79\n+commands = zope-testrunner --test-path=. {posargs:-vc}\n+extras = test\n'

Repository: plone.memoize


Branch: refs/heads/master
Date: 2022-10-25T16:43:30-07:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.memoize/commit/5e3a6844bf6d35fff8722739a02291ef974cd495

use tox-gh-actions

Files changed:
M .github/workflows/tests.yml
M tox.ini

b'diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\nindex 366c960..487e8de 100644\n--- a/.github/workflows/tests.yml\n+++ b/.github/workflows/tests.yml\n@@ -11,7 +11,7 @@ jobs:\n     strategy:\n       fail-fast: false\n       matrix:\n-        python_version: ["2.7", "3.7", "3.8", "3.9", "3.10", "3.11", "pypy3.9"]\n+        python_version: ["2.7", "3.7", "3.8", "3.9", "3.10", "3.11", "pypy3"]\n     runs-on: ubuntu-latest\n     name: ${{ matrix.python_version }}\n     steps:\n@@ -23,6 +23,6 @@ jobs:\n     - name: Install dependencies\n       run: |\n         python -m pip install --upgrade pip\n-        pip install tox\n+        pip install tox tox-gh-actions\n     - name: Test\n-      run: tox -e ${{ matrix.python_version }}\n+      run: python -m tox\ndiff --git a/tox.ini b/tox.ini\nindex 6dab6e9..19cc80a 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -6,7 +6,17 @@ envlist = py27,\n           py310,\n           py311,\n           pypy,\n-          pypy3.9,\n+          pypy3,\n+\n+[gh-actions]\n+python =\n+    2.7: py27\n+    3.7: py37\n+    3.8: py38\n+    3.9: py39\n+    3.10: py310\n+    3.11: py311\n+    pypy3: pypy3\n \n [testenv]\n commands = zope-testrunner --test-path=. {posargs:-vc}\n'

Repository: plone.memoize


Branch: refs/heads/master
Date: 2022-10-25T16:45:10-07:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.memoize/commit/6928c5195dbee549e93b57bf6e587b7963992dd6

Fix pypy

Files changed:
M .github/workflows/tests.yml
M tox.ini

b'diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\nindex 487e8de..dbcfe34 100644\n--- a/.github/workflows/tests.yml\n+++ b/.github/workflows/tests.yml\n@@ -11,7 +11,7 @@ jobs:\n     strategy:\n       fail-fast: false\n       matrix:\n-        python_version: ["2.7", "3.7", "3.8", "3.9", "3.10", "3.11", "pypy3"]\n+        python_version: ["2.7", "3.7", "3.8", "3.9", "3.10", "3.11", "pypy3.9"]\n     runs-on: ubuntu-latest\n     name: ${{ matrix.python_version }}\n     steps:\ndiff --git a/tox.ini b/tox.ini\nindex 19cc80a..e769b8f 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -16,7 +16,7 @@ python =\n     3.9: py39\n     3.10: py310\n     3.11: py311\n-    pypy3: pypy3\n+    pypy3.9: pypy3\n \n [testenv]\n commands = zope-testrunner --test-path=. {posargs:-vc}\n'

Repository: plone.memoize


Branch: refs/heads/master
Date: 2022-10-26T13:17:28+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.memoize/commit/d888001435ae5780ee102b8b284673f0b8213ed4

Merge pull request #28 from plone/py-3.11

Work on supporting Python 3.11

Files changed:
A .github/workflows/tests.yml
A news/27.breaking
M plone/memoize/request.py
M setup.py
M tox.ini
D .travis.yml
D buildout.cfg

b'diff --git a/.github/workflows/tests.yml b/.github/workflows/tests.yml\nnew file mode 100644\nindex 0000000..dbcfe34\n--- /dev/null\n+++ b/.github/workflows/tests.yml\n@@ -0,0 +1,28 @@\n+name: tests\n+\n+on:\n+  push:\n+    branches: [ master ]\n+  pull_request:\n+  # Allow to run this workflow manually from the Actions tab\n+  workflow_dispatch:\n+jobs:\n+  build:\n+    strategy:\n+      fail-fast: false\n+      matrix:\n+        python_version: ["2.7", "3.7", "3.8", "3.9", "3.10", "3.11", "pypy3.9"]\n+    runs-on: ubuntu-latest\n+    name: ${{ matrix.python_version }}\n+    steps:\n+    - uses: actions/checkout@v3\n+    - name: Set up Python\n+      uses: actions/setup-python@v4\n+      with:\n+        python-version: ${{ matrix.python_version }}\n+    - name: Install dependencies\n+      run: |\n+        python -m pip install --upgrade pip\n+        pip install tox tox-gh-actions\n+    - name: Test\n+      run: python -m tox\ndiff --git a/.travis.yml b/.travis.yml\ndeleted file mode 100644\nindex 8bae40c..0000000\n--- a/.travis.yml\n+++ /dev/null\n@@ -1,24 +0,0 @@\n-language: python\n-python:\n-    - 2.7\n-    - 3.5\n-    - 3.6\n-    - 3.7\n-    - 3.8\n-    - pypy\n-    - pypy3\n-install:\n-    - pip install zc.buildout\n-    - pip install coveralls coverage\n-    - buildout bootstrap\n-    - buildout install test\n-script:\n-    - coverage run bin/test -v\n-after_success:\n-    - coveralls\n-notifications:\n-    email: false\n-cache:\n-  pip: true\n-  directories:\n-    - eggs/\ndiff --git a/buildout.cfg b/buildout.cfg\ndeleted file mode 100644\nindex ab90dbd..0000000\n--- a/buildout.cfg\n+++ /dev/null\n@@ -1,37 +0,0 @@\n-[buildout]\n-extends = http://dist.plone.org/release/5-latest/versions.cfg\n-develop = .\n-parts = test\n-\n-[versions]\n-persistent = >= 4\n-python-gettext = >= 3\n-zc.recipe.testrunner = >= 2\n-zope.annotation = >= 4\n-zope.browser = >= 2\n-zope.component = >= 4\n-zope.hookable = >= 4\n-zope.deferredimport = >= 4\n-zope.configuration = >= 4\n-zope.contenttype = >= 4\n-zope.deprecation = >= 4\n-zope.event = >= 4\n-zope.exceptions = >= 4\n-zope.i18n = >= 4\n-zope.i18nmessageid = >= 4\n-zope.interface = >= 4\n-zope.location = >= 4\n-zope.proxy = >= 4\n-zope.publisher = >= 4\n-zope.ramcache = >= 2\n-zope.schema = >= 4\n-zope.security = >= 4\n-zope.testing = >= 4\n-zope.testrunner = >= 4\n-plone.memoize =\n-\n-[test]\n-recipe = zc.recipe.testrunner\n-eggs =\n-   plone.memoize [test]\n-   zope.testing\ndiff --git a/news/27.breaking b/news/27.breaking\nnew file mode 100644\nindex 0000000..d09a6bd\n--- /dev/null\n+++ b/news/27.breaking\n@@ -0,0 +1,2 @@\n+Drop support for Python 3.5 and 3.6.\n+Add support for Python 3.9, 3.10, and 3.11. [davisagli]\ndiff --git a/plone/memoize/request.py b/plone/memoize/request.py\nindex 29b320b..d554627 100644\n--- a/plone/memoize/request.py\n+++ b/plone/memoize/request.py\n@@ -9,6 +9,12 @@\n \n import inspect\n \n+try:\n+    getargspec = inspect.getfullargspec\n+except AttributeError:\n+    # for Python 2\n+    getargspec = inspect.getargspec\n+\n \n _marker = object()\n \n@@ -53,7 +59,7 @@ def store_in_annotation_of(expr):\n     def _store_in_annotation(fun, *args, **kwargs):\n         # Use expr to find out the name of the request variable\n         vars = {}\n-        spec = inspect.getargspec(fun)\n+        spec = getargspec(fun)\n         num_args = len(args)\n         expected_num_args = num_args\n \ndiff --git a/setup.py b/setup.py\nindex 58a775e..89cf3cb 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -9,7 +9,7 @@ def read(*rnames):\n     return open(os.path.join(os.path.dirname(__file__), *rnames)).read()\n \n \n-version = "2.1.2.dev0"\n+version = "3.0.0.dev0"\n \n long_description = u"\\n".join(\n     [read("README.rst"), read("plone", "memoize", "README.rst"), read("CHANGES.rst"),]\n@@ -25,20 +25,19 @@ def read(*rnames):\n         "Development Status :: 5 - Production/Stable",\n         "Environment :: Web Environment",\n         "Framework :: Plone",\n-        "Framework :: Plone :: 5.0",\n-        "Framework :: Plone :: 5.1",\n         "Framework :: Plone :: 5.2",\n         "Framework :: Plone :: Core",\n-        "Framework :: Zope :: 2",\n         "Framework :: Zope :: 4",\n+        "Framework :: Zope :: 5",\n         "License :: OSI Approved :: BSD License",\n         "Operating System :: OS Independent",\n         "Programming Language :: Python",\n         "Programming Language :: Python :: 2.7",\n-        "Programming Language :: Python :: 3.5",\n-        "Programming Language :: Python :: 3.6",\n         "Programming Language :: Python :: 3.7",\n         "Programming Language :: Python :: 3.8",\n+        "Programming Language :: Python :: 3.9",\n+        "Programming Language :: Python :: 3.10",\n+        "Programming Language :: Python :: 3.11",\n         "Programming Language :: Python :: Implementation :: CPython",\n         "Programming Language :: Python :: Implementation :: PyPy",\n     ],\n@@ -53,7 +52,13 @@ def read(*rnames):\n     zip_safe=False,\n     test_suite="plone.memoize.tests.test_suite",\n     extras_require=dict(\n-        test=["zope.configuration", "zope.globalrequest", "zope.publisher",]\n+        test=[\n+            "zope.configuration",\n+            "zope.globalrequest",\n+            "zope.publisher",\n+            "zope.testrunner",\n+            "zope.testing",\n+        ],\n     ),\n     install_requires=[\n         "setuptools",\ndiff --git a/tox.ini b/tox.ini\nindex f5d10f0..e769b8f 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -1,34 +1,23 @@\n [tox]\n envlist = py27,\n-          py35,\n-          py36,\n           py37,\n           py38,\n+          py39,\n+          py310,\n+          py311,\n           pypy,\n           pypy3,\n-          coverage-report\n \n-[testenv]\n-commands =\n-    {envbindir}/buildout -c {toxinidir}/buildout.cfg buildout:directory={envdir} buildout:develop={toxinidir} bootstrap\n-    {envbindir}/buildout -c {toxinidir}/buildout.cfg buildout:directory={envdir} buildout:develop={toxinidir} install test\n-    coverage run {envbindir}/test {posargs:-vc}\n-skip_install = true\n-deps =\n-    coverage\n-    zc.buildout\n-setenv =\n-    COVERAGE_FILE=.coverage.{envname}\n+[gh-actions]\n+python =\n+    2.7: py27\n+    3.7: py37\n+    3.8: py38\n+    3.9: py39\n+    3.10: py310\n+    3.11: py311\n+    pypy3.9: pypy3\n \n-[testenv:coverage-report]\n-basepython = python3.6\n-deps = coverage\n-setenv =\n-    COVERAGE_FILE=.coverage\n-skip_install = true\n-commands =\n-    coverage erase\n-    coverage combine\n-    coverage html -i\n-    coverage xml -i\n-    coverage report -i --fail-under=79\n+[testenv]\n+commands = zope-testrunner --test-path=. {posargs:-vc}\n+extras = test\n'

