Repository: Products.CMFPlone


Branch: refs/heads/5.2.x
Date: 2021-09-14T08:46:02+02:00
Author: ale-rt (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/ff4327173e296d2c75cc502930a9f5f12c265591

The portal catalog will not try to index itself anymore

Refs. #3312

Files changed:
A news/3312.bugfix
M Products/CMFPlone/CatalogTool.py

b"diff --git a/Products/CMFPlone/CatalogTool.py b/Products/CMFPlone/CatalogTool.py\nindex 9ff9ce4f20..c85c0a8a1f 100644\n--- a/Products/CMFPlone/CatalogTool.py\n+++ b/Products/CMFPlone/CatalogTool.py\n@@ -488,8 +488,11 @@ def clearFindAndRebuild(self):\n         idxs = list(self.indexes())\n \n         def indexObject(obj, path):\n-            if (base_hasattr(obj, 'reindexObject') and\n-                    safe_callable(obj.reindexObject)):\n+            if (\n+                obj != self\n+                and base_hasattr(obj, 'reindexObject')\n+                and safe_callable(obj.reindexObject)\n+            ):\n                 try:\n                     self.reindexObject(obj, idxs=idxs)\n                     # index conversions from plone.app.discussion\ndiff --git a/news/3312.bugfix b/news/3312.bugfix\nnew file mode 100644\nindex 0000000000..056cdf5453\n--- /dev/null\n+++ b/news/3312.bugfix\n@@ -0,0 +1 @@\n+The portal catalog will not try to index itself anymore [ale-rt]\n"

Repository: Products.CMFPlone


Branch: refs/heads/5.2.x
Date: 2021-10-31T16:23:52+01:00
Author: Alessandro Pisa (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/0f781c29f04fff5cb7c607e04032b7cb85030ea2

Merge branch '5.2.x' into do-not-catalog-the-catalog-52

Files changed:
M CHANGES.rst
M Products/CMFPlone/profiles/default/metadata.xml
M setup.py

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex 50aeae8396..429822127f 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -12,6 +12,26 @@ Changelog\n \n .. towncrier release notes start\n \n+5.2.6 (2021-10-22)\n+------------------\n+\n+Bug fixes:\n+\n+\n+- Release Plone 5.2.6 final.\n+  No changes compared to last release candidate. (#3336)\n+\n+\n+5.2.6rc1 (2021-10-16)\n+---------------------\n+\n+Bug fixes:\n+\n+\n+- Update metadata version to 5214, Plone 5.2.6.\n+  [maurits] (#5214)\n+\n+\n 5.2.5 (2021-08-06)\n ------------------\n \ndiff --git a/Products/CMFPlone/profiles/default/metadata.xml b/Products/CMFPlone/profiles/default/metadata.xml\nindex 8c1ce5815d..b90b690a50 100644\n--- a/Products/CMFPlone/profiles/default/metadata.xml\n+++ b/Products/CMFPlone/profiles/default/metadata.xml\n@@ -1,4 +1,4 @@\n <?xml version="1.0"?>\n <metadata>\n-  <version>5213</version>\n+  <version>5214</version>\n </metadata>\ndiff --git a/setup.py b/setup.py\nindex d0523bd8b4..a6ba27564c 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -2,7 +2,7 @@\n from setuptools import setup\n from setuptools import find_packages\n \n-version = \'5.2.6.dev0\'\n+version = \'5.2.7.dev0\'\n \n \n setup(\n'

Repository: Products.CMFPlone


Branch: refs/heads/5.2.x
Date: 2021-11-05T14:15:58+01:00
Author: Maurits van Rees (mauritsvanrees) <m.van.rees@zestsoftware.nl>
Commit: https://github.com/plone/Products.CMFPlone/commit/ba898b1fd5a242bb50b90f960f7f64eed0f53715

Merge pull request #3316 from plone/do-not-catalog-the-catalog-52

[5.2] The portal catalog will not try to index itself anymore

Files changed:
A news/3312.bugfix
M Products/CMFPlone/CatalogTool.py

b"diff --git a/Products/CMFPlone/CatalogTool.py b/Products/CMFPlone/CatalogTool.py\nindex 9ff9ce4f20..c85c0a8a1f 100644\n--- a/Products/CMFPlone/CatalogTool.py\n+++ b/Products/CMFPlone/CatalogTool.py\n@@ -488,8 +488,11 @@ def clearFindAndRebuild(self):\n         idxs = list(self.indexes())\n \n         def indexObject(obj, path):\n-            if (base_hasattr(obj, 'reindexObject') and\n-                    safe_callable(obj.reindexObject)):\n+            if (\n+                obj != self\n+                and base_hasattr(obj, 'reindexObject')\n+                and safe_callable(obj.reindexObject)\n+            ):\n                 try:\n                     self.reindexObject(obj, idxs=idxs)\n                     # index conversions from plone.app.discussion\ndiff --git a/news/3312.bugfix b/news/3312.bugfix\nnew file mode 100644\nindex 0000000000..056cdf5453\n--- /dev/null\n+++ b/news/3312.bugfix\n@@ -0,0 +1 @@\n+The portal catalog will not try to index itself anymore [ale-rt]\n"

