Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2024-03-15T11:48:27-03:00
Author: wesleybl (wesleybl) <wesleybl@gmail.com>
Commit: https://github.com/plone/plone.app.discussion/commit/153f24a5408938a68ceb0d7180efd2e811db9646

Fix test "Add a Comment to a Document and bulk delete it"

Fix test robot. Waiting for the select option to be enabled does not
guarantee that the selection will occur. Maybe because it is a modal
loaded by ajax. Then we try to select the value 5x.

Files changed:
A news/228.internal
M plone/app/discussion/tests/robot/test_moderation.robot

b'diff --git a/news/228.internal b/news/228.internal\nnew file mode 100644\nindex 00000000..49e8a7b6\n--- /dev/null\n+++ b/news/228.internal\n@@ -0,0 +1 @@\n+Fix test "Add a Comment to a Document and bulk delete it". @wesleybl\ndiff --git a/plone/app/discussion/tests/robot/test_moderation.robot b/plone/app/discussion/tests/robot/test_moderation.robot\nindex 81018d72..bacdc1ca 100644\n--- a/plone/app/discussion/tests/robot/test_moderation.robot\n+++ b/plone/app/discussion/tests/robot/test_moderation.robot\n@@ -28,6 +28,12 @@ Last history entry is shown\n \n *** Keywords ***\n \n+Select And Check\n+  [Arguments]  ${selector}  ${value}\n+  Select From List by Value  ${selector}  ${value}\n+  ${selected_value} =  Get Selected List Value  ${selector}\n+  Should Be Equal As Strings  ${selected_value}  ${value}\n+\n # Given\n \n a logged-in Site Administrator\n@@ -62,7 +68,7 @@ I add a comment and delete it\n   Click Button  Comment\n   Go To  ${PLONE_URL}/@@moderate-comments?review_state=all\n   Wait Until Element Is Enabled  css=option[value=delete]\n-  Select from list by value   xpath://select[@name=\'form.select.BulkAction\']  delete\n+  Wait Until Keyword Succeeds  5x  1s  Select And Check  xpath://select[@name=\'form.select.BulkAction\']  delete\n   Select Checkbox  name=check_all\n   Sleep  1s\n   Wait For Then Click Element  css=button[name="form.button.BulkAction"]\n'

Repository: plone.app.discussion


Branch: refs/heads/master
Date: 2024-03-15T17:22:04+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@py76.be>
Commit: https://github.com/plone/plone.app.discussion/commit/3e8801e50c0d26052bcde1022cd94e9bd6c34951

Merge pull request #228 from plone/fix_robot

Fix test "Add a Comment to a Document and bulk delete it"

Files changed:
A news/228.internal
M plone/app/discussion/tests/robot/test_moderation.robot

b'diff --git a/news/228.internal b/news/228.internal\nnew file mode 100644\nindex 00000000..49e8a7b6\n--- /dev/null\n+++ b/news/228.internal\n@@ -0,0 +1 @@\n+Fix test "Add a Comment to a Document and bulk delete it". @wesleybl\ndiff --git a/plone/app/discussion/tests/robot/test_moderation.robot b/plone/app/discussion/tests/robot/test_moderation.robot\nindex 81018d72..bacdc1ca 100644\n--- a/plone/app/discussion/tests/robot/test_moderation.robot\n+++ b/plone/app/discussion/tests/robot/test_moderation.robot\n@@ -28,6 +28,12 @@ Last history entry is shown\n \n *** Keywords ***\n \n+Select And Check\n+  [Arguments]  ${selector}  ${value}\n+  Select From List by Value  ${selector}  ${value}\n+  ${selected_value} =  Get Selected List Value  ${selector}\n+  Should Be Equal As Strings  ${selected_value}  ${value}\n+\n # Given\n \n a logged-in Site Administrator\n@@ -62,7 +68,7 @@ I add a comment and delete it\n   Click Button  Comment\n   Go To  ${PLONE_URL}/@@moderate-comments?review_state=all\n   Wait Until Element Is Enabled  css=option[value=delete]\n-  Select from list by value   xpath://select[@name=\'form.select.BulkAction\']  delete\n+  Wait Until Keyword Succeeds  5x  1s  Select And Check  xpath://select[@name=\'form.select.BulkAction\']  delete\n   Select Checkbox  name=check_all\n   Sleep  1s\n   Wait For Then Click Element  css=button[name="form.button.BulkAction"]\n'

