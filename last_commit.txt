Repository: plone.restapi


Branch: refs/heads/master
Date: 2020-04-24T00:23:56+02:00
Author: Timo Stollenwerk (tisto) <stollenwerk@kitconcept.com>
Commit: https://github.com/plone/plone.restapi/commit/e7e457d73ad990ebca497acbed117859560e7a9c

Add images via performance.py

Files changed:
M src/plone/restapi/tests/performance.py

b'diff --git a/src/plone/restapi/tests/performance.py b/src/plone/restapi/tests/performance.py\nindex cc9513f7..81ae1225 100644\n--- a/src/plone/restapi/tests/performance.py\n+++ b/src/plone/restapi/tests/performance.py\n@@ -2,6 +2,7 @@\n from datetime import datetime\n from plone.app.textfield.value import RichTextValue\n from plone.dexterity.interfaces import IDexterityContent\n+from plone.namedfile.file import NamedBlobImage\n from Products.CMFCore.utils import getToolByName\n from six.moves import range\n from zope.component.hooks import getSite\n@@ -36,8 +37,7 @@ def set_image(obj):\n         from plone.namedfile.file import NamedBlobImage\n \n         filename = os.path.join(os.path.dirname(__file__), u"image.png")\n-        obj.image = NamedBlobImage(\n-            data=open(filename, "rb").read(), filename=filename)\n+        obj.image = NamedBlobImage(data=open(filename, "rb").read(), filename=filename)\n     else:\n         filename = os.path.join(os.path.dirname(__file__), u"image.png")\n         obj.setImage(open(filename, "rb").read())\n@@ -74,13 +74,11 @@ def step_setup_content(context):\n     portal = getSite()\n \n     # Testfolder WRITE\n-    portal.invokeFactory("Folder", id="testfolder-write",\n-                         title="Testfolder Write")\n+    portal.invokeFactory("Folder", id="testfolder-write", title="Testfolder Write")\n     publish(portal["testfolder-write"])\n \n     # Testfolder READ\n-    portal.invokeFactory("Folder", id="testfolder-read",\n-                         title="Testfolder Read")\n+    portal.invokeFactory("Folder", id="testfolder-read", title="Testfolder Read")\n     publish(portal["testfolder-read"])\n     portal = portal["testfolder-read"]\n \n@@ -105,8 +103,7 @@ def step_setup_content(context):\n     publish(portal.folder)\n \n     # Folder with 10 Items\n-    portal.invokeFactory(\n-        "Folder", id="folder-with-10-items", title="Folder 10")\n+    portal.invokeFactory("Folder", id="folder-with-10-items", title="Folder 10")\n     folder10 = portal["folder-with-10-items"]\n     set_description(folder10)\n     publish(folder10)\n@@ -117,8 +114,7 @@ def step_setup_content(context):\n         publish(folder10["doc{}".format(i)])\n \n     # Folder with 100 Items\n-    portal.invokeFactory(\n-        "Folder", id="folder-with-100-items", title="Folder 100")\n+    portal.invokeFactory("Folder", id="folder-with-100-items", title="Folder 100")\n     folder100 = portal["folder-with-100-items"]\n     set_description(folder100)\n     publish(folder100)\n@@ -129,8 +125,7 @@ def step_setup_content(context):\n         publish(folder100["doc{}".format(i)])\n \n     # Folder with 1000 Items\n-    portal.invokeFactory(\n-        "Folder", id="folder-with-1000-items", title="Folder 1000")\n+    portal.invokeFactory("Folder", id="folder-with-1000-items", title="Folder 1000")\n     folder1000 = portal["folder-with-1000-items"]\n     set_description(folder1000)\n     publish(folder1000)\n@@ -141,8 +136,11 @@ def step_setup_content(context):\n         publish(folder1000["doc{}".format(i)])\n \n     # Folder with 10 Items and next/previous enabled\n-    portal.invokeFactory("Folder", id="folder-with-10-items-next-prev-enabled",\n-                         title="Folder 10 (next/prev enabled)")\n+    portal.invokeFactory(\n+        "Folder",\n+        id="folder-with-10-items-next-prev-enabled",\n+        title="Folder 10 (next/prev enabled)",\n+    )\n     folder10np = portal["folder-with-10-items-next-prev-enabled"]\n     folder10np.nextPreviousEnabled = True\n     set_description(folder10np)\n@@ -202,3 +200,31 @@ def step_setup_content(context):\n     portal.invokeFactory("File", id="file", title="File")\n     set_description(portal.file)\n     set_file(portal.file)\n+\n+    # Image 1 MB\n+    portal.invokeFactory("Image", id="image-1mb", title="Image 1 MB")\n+    filename = os.path.join(os.path.dirname(__file__), "images", u"image-1mb.jpg")\n+    portal.get("image-1mb").image = NamedBlobImage(\n+        data=open(filename, "rb").read(), filename=filename\n+    )\n+\n+    # Image 2 MB\n+    portal.invokeFactory("Image", id="image-2mb", title="Image 2 MB")\n+    filename = os.path.join(os.path.dirname(__file__), "images", u"image-2mb.jpg")\n+    portal.get("image-2mb").image = NamedBlobImage(\n+        data=open(filename, "rb").read(), filename=filename\n+    )\n+\n+    # Image 3 MB\n+    portal.invokeFactory("Image", id="image-3mb", title="Image 3 MB")\n+    filename = os.path.join(os.path.dirname(__file__), "images", u"image-3mb.jpg")\n+    portal.get("image-3mb").image = NamedBlobImage(\n+        data=open(filename, "rb").read(), filename=filename\n+    )\n+\n+    # Image 10 MB\n+    portal.invokeFactory("Image", id="image-10mb", title="Image 10 MB")\n+    filename = os.path.join(os.path.dirname(__file__), "images", u"image-10mb.jpg")\n+    portal.get("image-10mb").image = NamedBlobImage(\n+        data=open(filename, "rb").read(), filename=filename\n+    )\n'

