Repository: plone.volto


Branch: refs/heads/main
Date: 2023-06-04T12:55:43+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.volto/commit/0effb2a8991a5a679b094a6b4faef168bbaebb0c

Fix unchecked checkboxes in migrate_to_volto (#124)

Files changed:
M src/plone/volto/browser/migrate_to_volto.pt

b'diff --git a/src/plone/volto/browser/migrate_to_volto.pt b/src/plone/volto/browser/migrate_to_volto.pt\nindex fe14a21..684298b 100644\n--- a/src/plone/volto/browser/migrate_to_volto.pt\n+++ b/src/plone/volto/browser/migrate_to_volto.pt\n@@ -55,6 +55,7 @@\n         </p>\n \n         <div class="form-check mb-3">\n+            <input name="migrate_folders:boolean:default" type="hidden" value="" />\n             <input\n                 class="form-check-input"\n                 type="checkbox"\n@@ -68,6 +69,7 @@\n         </div>\n \n         <div class="form-check mb-3 ms-4">\n+            <input name="migrate_default_pages:boolean:default" type="hidden" value="" />\n             <input\n                 class="form-check-input"\n                 type="checkbox"\n@@ -86,6 +88,7 @@\n         </div>\n \n         <div class="form-check mb-3">\n+            <input name="purge_richtext:boolean:default" type="hidden" value="" />\n             <input\n                 class="form-check-input"\n                 type="checkbox"\n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2023-06-04T12:57:07+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.volto/commit/c93f85ffe5b2244cc02965b13e754ee62fb2676b

add changenote

Files changed:
A news/124.bugfix

b'diff --git a/news/124.bugfix b/news/124.bugfix\nnew file mode 100644\nindex 0000000..57ad10a\n--- /dev/null\n+++ b/news/124.bugfix\n@@ -0,0 +1,2 @@\n+Fix value of unchecked checkboxes in migrate_to_volto.\n+[pbauer]\n\\ No newline at end of file\n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2023-06-07T07:26:47+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.volto/commit/fd6d6401ea10f63565cab3127b617aff3b956ca6

Change default values

Files changed:
M src/plone/volto/browser/migrate_to_volto.py

b'diff --git a/src/plone/volto/browser/migrate_to_volto.py b/src/plone/volto/browser/migrate_to_volto.py\nindex 8eba43b..4a7c110 100644\n--- a/src/plone/volto/browser/migrate_to_volto.py\n+++ b/src/plone/volto/browser/migrate_to_volto.py\n@@ -37,9 +37,9 @@ class MigrateToVolto(BrowserView):\n     def __call__(self):\n         request = self.request\n         self.service_url = request.get("service_url", "http://localhost:5000/html")\n-        self.migrate_folders = request.get("migrate_folders", True)\n-        self.migrate_default_pages = request.get("migrate_default_pages", True)\n-        self.purge_richtext = request.get("purge_richtext", True)\n+        self.migrate_folders = request.get("migrate_folders", False)\n+        self.migrate_default_pages = request.get("migrate_default_pages", False)\n+        self.purge_richtext = request.get("purge_richtext", False)\n         # We can still use outdated draftjs by setting slate to False on the request\n         self.slate = request.get("slate", True)\n \n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2023-06-07T08:50:07+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.volto/commit/341a7b85974a461d24523085343c5f6b357055f6

check checkboxes in tests

Files changed:
M src/plone/volto/tests/test_migrate_to_volto.py

b'diff --git a/src/plone/volto/tests/test_migrate_to_volto.py b/src/plone/volto/tests/test_migrate_to_volto.py\nindex 0fe7fe5..3739a03 100644\n--- a/src/plone/volto/tests/test_migrate_to_volto.py\n+++ b/src/plone/volto/tests/test_migrate_to_volto.py\n@@ -40,6 +40,10 @@ def test_plonevolto_is_installed(self):\n         self.assertFalse(installer.is_product_installed("plone.volto"))\n \n         view = self.portal.restrictedTraverse("@@migrate_to_volto")\n+        # check checkboxes\n+        self.request.form["migrate_folders"] = True\n+        self.request.form["migrate_default_pages"] = True\n+        self.request.form["purge_richtext"] = True\n         self.request.form["form.submitted"] = True\n         view()\n \n@@ -66,6 +70,10 @@ def test_items_are_migrated_to_folderish(self):\n         )\n \n         view = self.portal.restrictedTraverse("@@migrate_to_volto")\n+        # check checkboxes\n+        self.request.form["migrate_folders"] = True\n+        self.request.form["migrate_default_pages"] = True\n+        self.request.form["purge_richtext"] = True\n         self.request.form["form.submitted"] = True\n         view()\n \n@@ -105,6 +113,9 @@ def test_folders_are_migrated(self):\n         self.assertEqual(self.portal["folder1"].portal_type, "Folder")\n \n         view = self.portal.restrictedTraverse("@@migrate_to_volto")\n+        self.request.form["migrate_folders"] = True\n+        self.request.form["migrate_default_pages"] = True\n+        self.request.form["purge_richtext"] = True\n         self.request.form["form.submitted"] = True\n         view()\n \n@@ -134,6 +145,10 @@ def test_collections_are_migrated(self):\n         self.assertEqual(self.portal["collection"].portal_type, "Collection")\n \n         view = self.portal.restrictedTraverse("@@migrate_to_volto")\n+        # check checkboxes\n+        self.request.form["migrate_folders"] = True\n+        self.request.form["migrate_default_pages"] = True\n+        self.request.form["purge_richtext"] = True\n         self.request.form["form.submitted"] = True\n         view()\n \n@@ -180,6 +195,10 @@ def test_default_pages_are_migrated(self):\n         folder.setDefaultPage("doc")\n \n         view = self.portal.restrictedTraverse("@@migrate_to_volto")\n+        # check checkboxes\n+        self.request.form["migrate_folders"] = True\n+        self.request.form["migrate_default_pages"] = True\n+        self.request.form["purge_richtext"] = True\n         self.request.form["form.submitted"] = True\n         view()\n \n@@ -238,6 +257,10 @@ def test_default_page_collections_are_migrated(self):\n         self.assertEqual(len(collection.results()), 2)\n \n         view = self.portal.restrictedTraverse("@@migrate_to_volto")\n+        # check checkboxes\n+        self.request.form["migrate_folders"] = True\n+        self.request.form["migrate_default_pages"] = True\n+        self.request.form["purge_richtext"] = True\n         self.request.form["form.submitted"] = True\n         view()\n \n@@ -291,6 +314,10 @@ def test_default_page_news_are_not_migrated(self):\n         self.assertIn("news", folder.keys())\n \n         view = self.portal.restrictedTraverse("@@migrate_to_volto")\n+        # check checkboxes\n+        self.request.form["migrate_folders"] = True\n+        self.request.form["migrate_default_pages"] = True\n+        self.request.form["purge_richtext"] = True\n         self.request.form["form.submitted"] = True\n         view()\n \n@@ -329,6 +356,9 @@ def test_richtext_is_migrated(self):\n         self.assertTrue(isinstance(doc.text, RichTextValue))\n \n         view = self.portal.restrictedTraverse("@@migrate_to_volto")\n+        self.request.form["migrate_folders"] = True\n+        self.request.form["migrate_default_pages"] = True\n+        self.request.form["purge_richtext"] = True\n         self.request.form["form.submitted"] = True\n         view()\n \n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2023-06-08T06:32:01+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.volto/commit/1299639b30df8132075de062e6e3c2cd8e22e19a

revert fd6d640 and 341a7b8

Files changed:
M src/plone/volto/browser/migrate_to_volto.py
M src/plone/volto/tests/test_migrate_to_volto.py

b'diff --git a/src/plone/volto/browser/migrate_to_volto.py b/src/plone/volto/browser/migrate_to_volto.py\nindex 4a7c110..8eba43b 100644\n--- a/src/plone/volto/browser/migrate_to_volto.py\n+++ b/src/plone/volto/browser/migrate_to_volto.py\n@@ -37,9 +37,9 @@ class MigrateToVolto(BrowserView):\n     def __call__(self):\n         request = self.request\n         self.service_url = request.get("service_url", "http://localhost:5000/html")\n-        self.migrate_folders = request.get("migrate_folders", False)\n-        self.migrate_default_pages = request.get("migrate_default_pages", False)\n-        self.purge_richtext = request.get("purge_richtext", False)\n+        self.migrate_folders = request.get("migrate_folders", True)\n+        self.migrate_default_pages = request.get("migrate_default_pages", True)\n+        self.purge_richtext = request.get("purge_richtext", True)\n         # We can still use outdated draftjs by setting slate to False on the request\n         self.slate = request.get("slate", True)\n \ndiff --git a/src/plone/volto/tests/test_migrate_to_volto.py b/src/plone/volto/tests/test_migrate_to_volto.py\nindex 3739a03..0fe7fe5 100644\n--- a/src/plone/volto/tests/test_migrate_to_volto.py\n+++ b/src/plone/volto/tests/test_migrate_to_volto.py\n@@ -40,10 +40,6 @@ def test_plonevolto_is_installed(self):\n         self.assertFalse(installer.is_product_installed("plone.volto"))\n \n         view = self.portal.restrictedTraverse("@@migrate_to_volto")\n-        # check checkboxes\n-        self.request.form["migrate_folders"] = True\n-        self.request.form["migrate_default_pages"] = True\n-        self.request.form["purge_richtext"] = True\n         self.request.form["form.submitted"] = True\n         view()\n \n@@ -70,10 +66,6 @@ def test_items_are_migrated_to_folderish(self):\n         )\n \n         view = self.portal.restrictedTraverse("@@migrate_to_volto")\n-        # check checkboxes\n-        self.request.form["migrate_folders"] = True\n-        self.request.form["migrate_default_pages"] = True\n-        self.request.form["purge_richtext"] = True\n         self.request.form["form.submitted"] = True\n         view()\n \n@@ -113,9 +105,6 @@ def test_folders_are_migrated(self):\n         self.assertEqual(self.portal["folder1"].portal_type, "Folder")\n \n         view = self.portal.restrictedTraverse("@@migrate_to_volto")\n-        self.request.form["migrate_folders"] = True\n-        self.request.form["migrate_default_pages"] = True\n-        self.request.form["purge_richtext"] = True\n         self.request.form["form.submitted"] = True\n         view()\n \n@@ -145,10 +134,6 @@ def test_collections_are_migrated(self):\n         self.assertEqual(self.portal["collection"].portal_type, "Collection")\n \n         view = self.portal.restrictedTraverse("@@migrate_to_volto")\n-        # check checkboxes\n-        self.request.form["migrate_folders"] = True\n-        self.request.form["migrate_default_pages"] = True\n-        self.request.form["purge_richtext"] = True\n         self.request.form["form.submitted"] = True\n         view()\n \n@@ -195,10 +180,6 @@ def test_default_pages_are_migrated(self):\n         folder.setDefaultPage("doc")\n \n         view = self.portal.restrictedTraverse("@@migrate_to_volto")\n-        # check checkboxes\n-        self.request.form["migrate_folders"] = True\n-        self.request.form["migrate_default_pages"] = True\n-        self.request.form["purge_richtext"] = True\n         self.request.form["form.submitted"] = True\n         view()\n \n@@ -257,10 +238,6 @@ def test_default_page_collections_are_migrated(self):\n         self.assertEqual(len(collection.results()), 2)\n \n         view = self.portal.restrictedTraverse("@@migrate_to_volto")\n-        # check checkboxes\n-        self.request.form["migrate_folders"] = True\n-        self.request.form["migrate_default_pages"] = True\n-        self.request.form["purge_richtext"] = True\n         self.request.form["form.submitted"] = True\n         view()\n \n@@ -314,10 +291,6 @@ def test_default_page_news_are_not_migrated(self):\n         self.assertIn("news", folder.keys())\n \n         view = self.portal.restrictedTraverse("@@migrate_to_volto")\n-        # check checkboxes\n-        self.request.form["migrate_folders"] = True\n-        self.request.form["migrate_default_pages"] = True\n-        self.request.form["purge_richtext"] = True\n         self.request.form["form.submitted"] = True\n         view()\n \n@@ -356,9 +329,6 @@ def test_richtext_is_migrated(self):\n         self.assertTrue(isinstance(doc.text, RichTextValue))\n \n         view = self.portal.restrictedTraverse("@@migrate_to_volto")\n-        self.request.form["migrate_folders"] = True\n-        self.request.form["migrate_default_pages"] = True\n-        self.request.form["purge_richtext"] = True\n         self.request.form["form.submitted"] = True\n         view()\n \n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2023-06-07T23:27:41-07:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.volto/commit/2b0920da4dbe9e3940714581116972d2e074fe5e

Merge pull request #125 from plone/fix_checkboxes_in_migrate_to_volto

Fix unchecked checkboxes in migrate_to_volto

Files changed:
A news/124.bugfix
M src/plone/volto/browser/migrate_to_volto.pt

b'diff --git a/news/124.bugfix b/news/124.bugfix\nnew file mode 100644\nindex 0000000..57ad10a\n--- /dev/null\n+++ b/news/124.bugfix\n@@ -0,0 +1,2 @@\n+Fix value of unchecked checkboxes in migrate_to_volto.\n+[pbauer]\n\\ No newline at end of file\ndiff --git a/src/plone/volto/browser/migrate_to_volto.pt b/src/plone/volto/browser/migrate_to_volto.pt\nindex fe14a21..684298b 100644\n--- a/src/plone/volto/browser/migrate_to_volto.pt\n+++ b/src/plone/volto/browser/migrate_to_volto.pt\n@@ -55,6 +55,7 @@\n         </p>\n \n         <div class="form-check mb-3">\n+            <input name="migrate_folders:boolean:default" type="hidden" value="" />\n             <input\n                 class="form-check-input"\n                 type="checkbox"\n@@ -68,6 +69,7 @@\n         </div>\n \n         <div class="form-check mb-3 ms-4">\n+            <input name="migrate_default_pages:boolean:default" type="hidden" value="" />\n             <input\n                 class="form-check-input"\n                 type="checkbox"\n@@ -86,6 +88,7 @@\n         </div>\n \n         <div class="form-check mb-3">\n+            <input name="purge_richtext:boolean:default" type="hidden" value="" />\n             <input\n                 class="form-check-input"\n                 type="checkbox"\n'

