Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2019-06-09T08:55:37+02:00
Author: Andreas Jung (zopyx) <info@zopyx.com>
Commit: https://github.com/plone/plone.app.portlets/commit/bc0e3041f296263085805335a903848067b94f55

fix for https://github.com/plone/Products.CMFPlone/issues/2882

Files changed:
M plone/app/portlets/portlets/navigation.py

b"diff --git a/plone/app/portlets/portlets/navigation.py b/plone/app/portlets/portlets/navigation.py\nindex e29816a..b1fe8b8 100644\n--- a/plone/app/portlets/portlets/navigation.py\n+++ b/plone/app/portlets/portlets/navigation.py\n@@ -356,6 +356,8 @@ def getMimeTypeIcon(self, node):\n             mtt = getToolByName(self.context, 'mimetypes_registry')\n             if fileo.contentType:\n                 ctype = mtt.lookup(fileo.contentType)\n+                if not ctype:\n+                    return None\n                 return os.path.join(\n                     portal_url,\n                     guess_icon_path(ctype[0])\n"

Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2019-06-09T09:01:46+02:00
Author: Andreas Jung (zopyx) <info@zopyx.com>
Commit: https://github.com/plone/plone.app.portlets/commit/effba1a78528b7a62cd45bd5de285d266bb0ab6d

added

Files changed:
A news/cmfplone-2882.bugfix

b'diff --git a/news/cmfplone-2882.bugfix b/news/cmfplone-2882.bugfix\nnew file mode 100644\nindex 0000000..2024f71\n--- /dev/null\n+++ b/news/cmfplone-2882.bugfix\n@@ -0,0 +1,4 @@\n+fixes  index error in navigation portlet caused by unknown mimetypes without\n+entry in mimetype registry\n+https://github.com/plone/Products.CMFPlone/issues/2882)\n+\n'

Repository: plone.app.portlets


Branch: refs/heads/master
Date: 2020-09-15T15:52:45+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.portlets/commit/cbc4f34c93e97311e6d1fb9166cf5572718762ed

Merge pull request #129 from plone/issuse-cmfplone-2882

Fixes for exception raised in navigation portlet by File with unknown content-type in mime registry

Files changed:
A news/cmfplone-2882.bugfix
M plone/app/portlets/portlets/navigation.py

b"diff --git a/news/cmfplone-2882.bugfix b/news/cmfplone-2882.bugfix\nnew file mode 100644\nindex 0000000..2024f71\n--- /dev/null\n+++ b/news/cmfplone-2882.bugfix\n@@ -0,0 +1,4 @@\n+fixes  index error in navigation portlet caused by unknown mimetypes without\n+entry in mimetype registry\n+https://github.com/plone/Products.CMFPlone/issues/2882)\n+\ndiff --git a/plone/app/portlets/portlets/navigation.py b/plone/app/portlets/portlets/navigation.py\nindex e29816a..b1fe8b8 100644\n--- a/plone/app/portlets/portlets/navigation.py\n+++ b/plone/app/portlets/portlets/navigation.py\n@@ -356,6 +356,8 @@ def getMimeTypeIcon(self, node):\n             mtt = getToolByName(self.context, 'mimetypes_registry')\n             if fileo.contentType:\n                 ctype = mtt.lookup(fileo.contentType)\n+                if not ctype:\n+                    return None\n                 return os.path.join(\n                     portal_url,\n                     guess_icon_path(ctype[0])\n"

