Repository: plone.testing


Branch: refs/heads/master
Date: 2023-09-20T21:24:17+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.testing/commit/786074e81efb0c2c2f9f489191f6de1629ff4fd4

Fix tests when run with ZODB 5.8.1+.

Test failures:
```
Failure in test /Users/maurits/community/plone-coredev/6.0/src/plone.testing/src/plone/testing/zodb.rst
Failed doctest test for zodb.rst
  File "/Users/maurits/community/plone-coredev/6.0/src/plone.testing/src/plone/testing/zodb.rst", line 0

----------------------------------------------------------------------
File "/Users/maurits/community/plone-coredev/6.0/src/plone.testing/src/plone/testing/zodb.rst", line 55, in zodb.rst
Failed example:
    zodb.EMPTY_ZODB['zodbConnection']
Expected:
    &lt;Connection at ...&gt;
Got:
    &lt;ZODB.Connection.Connection object at 0x1071e7f10&gt;
----------------------------------------------------------------------
File "/Users/maurits/community/plone-coredev/6.0/src/plone.testing/src/plone/testing/zodb.rst", line 138, in zodb.rst
Failed example:
    POPULATED_ZODB['zodbConnection']
Expected:
    &lt;Connection at ...&gt;
Got:
    &lt;ZODB.Connection.Connection object at 0x107256a10&gt;
----------------------------------------------------------------------
File "/Users/maurits/community/plone-coredev/6.0/src/plone.testing/src/plone/testing/zodb.rst", line 233, in zodb.rst
Failed example:
    EXPANDED_ZODB['zodbConnection']
Expected:
    &lt;Connection at ...&gt;
Got:
    &lt;ZODB.Connection.Connection object at 0x107268550&gt;
```

Files changed:
A news/581.bugfix
M pyproject.toml
M src/plone/testing/zodb.rst

b'diff --git a/news/581.bugfix b/news/581.bugfix\nnew file mode 100644\nindex 0000000..69f5d06\n--- /dev/null\n+++ b/news/581.bugfix\n@@ -0,0 +1,2 @@\n+Fix tests when run with ZODB 5.8.1+.\n+[maurits]\ndiff --git a/pyproject.toml b/pyproject.toml\nindex 05b615d..12c6bc8 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -1,6 +1,6 @@\n [tool.towncrier]\n-filename = "CHANGES.rst"\n directory = "news/"\n+filename = "CHANGES.rst"\n title_format = "{version} ({project_date})"\n underlines = ["-", ""]\n \n@@ -18,3 +18,21 @@ showcontent = true\n directory = "bugfix"\n name = "Bug fixes:"\n showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "internal"\n+name = "Internal:"\n+showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "documentation"\n+name = "Documentation:"\n+showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "tests"\n+name = "Tests"\n+showcontent = true\n+\n+[tool.isort]\n+profile = "plone"\ndiff --git a/src/plone/testing/zodb.rst b/src/plone/testing/zodb.rst\nindex 6a9cf73..a18c473 100644\n--- a/src/plone/testing/zodb.rst\n+++ b/src/plone/testing/zodb.rst\n@@ -53,7 +53,7 @@ Let\'s now simulate a test.::\n The test would then execute. It may use the ZODB root.::\n \n     >>> zodb.EMPTY_ZODB[\'zodbConnection\']\n-    <Connection at ...>\n+    <...Connection...at ...>\n \n     >>> zodb.EMPTY_ZODB[\'zodbRoot\']\n     {}\n@@ -136,7 +136,7 @@ Let\'s now simulate a test.::\n The test would then execute. It may use the ZODB root.::\n \n     >>> POPULATED_ZODB[\'zodbConnection\']\n-    <Connection at ...>\n+    <...Connection...at ...>\n \n     >>> POPULATED_ZODB[\'zodbRoot\']\n     {\'someData\': \'a string\'}\n@@ -231,7 +231,7 @@ Let\'s now simulate a test.::\n The test would then execute. It may use the ZODB root.::\n \n     >>> EXPANDED_ZODB[\'zodbConnection\']\n-    <Connection at ...>\n+    <...Connection...at ...>\n \n     >>> EXPANDED_ZODB[\'zodbRoot\'] == dict(someData=\'a string\', additionalData=\'Some new data\')\n     True\n'

Repository: plone.testing


Branch: refs/heads/master
Date: 2023-09-20T22:17:18+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.testing/commit/5cbdff3fa9d1a7b1102d6807db73a059203af475

Merge pull request #84 from plone/maurits-fix-zodb-581-tests

Fix tests when run with ZODB 5.8.1+.

Files changed:
A news/581.bugfix
M pyproject.toml
M src/plone/testing/zodb.rst

b'diff --git a/news/581.bugfix b/news/581.bugfix\nnew file mode 100644\nindex 0000000..69f5d06\n--- /dev/null\n+++ b/news/581.bugfix\n@@ -0,0 +1,2 @@\n+Fix tests when run with ZODB 5.8.1+.\n+[maurits]\ndiff --git a/pyproject.toml b/pyproject.toml\nindex 05b615d..12c6bc8 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -1,6 +1,6 @@\n [tool.towncrier]\n-filename = "CHANGES.rst"\n directory = "news/"\n+filename = "CHANGES.rst"\n title_format = "{version} ({project_date})"\n underlines = ["-", ""]\n \n@@ -18,3 +18,21 @@ showcontent = true\n directory = "bugfix"\n name = "Bug fixes:"\n showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "internal"\n+name = "Internal:"\n+showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "documentation"\n+name = "Documentation:"\n+showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "tests"\n+name = "Tests"\n+showcontent = true\n+\n+[tool.isort]\n+profile = "plone"\ndiff --git a/src/plone/testing/zodb.rst b/src/plone/testing/zodb.rst\nindex 6a9cf73..a18c473 100644\n--- a/src/plone/testing/zodb.rst\n+++ b/src/plone/testing/zodb.rst\n@@ -53,7 +53,7 @@ Let\'s now simulate a test.::\n The test would then execute. It may use the ZODB root.::\n \n     >>> zodb.EMPTY_ZODB[\'zodbConnection\']\n-    <Connection at ...>\n+    <...Connection...at ...>\n \n     >>> zodb.EMPTY_ZODB[\'zodbRoot\']\n     {}\n@@ -136,7 +136,7 @@ Let\'s now simulate a test.::\n The test would then execute. It may use the ZODB root.::\n \n     >>> POPULATED_ZODB[\'zodbConnection\']\n-    <Connection at ...>\n+    <...Connection...at ...>\n \n     >>> POPULATED_ZODB[\'zodbRoot\']\n     {\'someData\': \'a string\'}\n@@ -231,7 +231,7 @@ Let\'s now simulate a test.::\n The test would then execute. It may use the ZODB root.::\n \n     >>> EXPANDED_ZODB[\'zodbConnection\']\n-    <Connection at ...>\n+    <...Connection...at ...>\n \n     >>> EXPANDED_ZODB[\'zodbRoot\'] == dict(someData=\'a string\', additionalData=\'Some new data\')\n     True\n'

