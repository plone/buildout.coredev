Repository: plone.base


Branch: refs/heads/main
Date: 2024-05-30T17:01:19+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.base/commit/f3f45a987709df6974ab98f5e3770105576cbc0a

pa.discussion as core-addon

remove impossible values, since there never is the construction allowed of these two
see vocabulary plone.app.vocabularies.PortalTypes and https://github.com/zopefoundation/Products.CMFCore/blob/8d765b8ce7ec4e053e58f5c8dc45d08db01ce3e0/src/Products/CMFCore/TypesTool.py#L768

Files changed:
A news/65.bugfix
M src/plone/base/interfaces/controlpanel.py

b'diff --git a/news/65.bugfix b/news/65.bugfix\nnew file mode 100644\nindex 0000000..6080d70\n--- /dev/null\n+++ b/news/65.bugfix\n@@ -0,0 +1,4 @@\n+Remove ISearchSchemas types_not_searched "Discussion Item" value from plone.app.discussion and other impossible values too.\n+Default is empty now, since there will never the construction allowed of these three.\n+See https://github.com/zopefoundation/Products.CMFCore/blob/8d765b8ce7ec4e053e58f5c8dc45d08db01ce3e0/src/Products/CMFCore/TypesTool.py#L768\n+[@jensens]\ndiff --git a/src/plone/base/interfaces/controlpanel.py b/src/plone/base/interfaces/controlpanel.py\nindex 73941ce..ee5e5fc 100644\n--- a/src/plone/base/interfaces/controlpanel.py\n+++ b/src/plone/base/interfaces/controlpanel.py\n@@ -1015,11 +1015,7 @@ class ISearchSchema(Interface):\n             "off here or by the relevant installer."\n         ),\n         required=False,\n-        default=(\n-            "Discussion Item",\n-            "Plone Site",\n-            "TempFolder",\n-        ),\n+        default=(),\n         missing_value=(),\n         value_type=schema.Choice(source="plone.app.vocabularies.PortalTypes"),\n     )\n'

Repository: plone.base


Branch: refs/heads/main
Date: 2024-05-30T17:58:40+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.base/commit/510e50ec7e4dd19d4ea79b142020d6b7e8f7e9c7

Merge branch 'main' into pa-discussion-core-addon

Files changed:
M setup.cfg

b'diff --git a/setup.cfg b/setup.cfg\nindex 1b227df..66ea4ee 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -1,5 +1,5 @@\n [metadata]\n-version = 1.4.1.dev0\n+version = 2.0.0.dev0\n name = plone.base\n description = Plone Interface contracts, plus basic features and utilities\n long_description = file: README.rst, CHANGES.rst\n@@ -13,20 +13,19 @@ license = GPLv2\n classifiers =\n     Development Status :: 5 - Production/Stable\n     Environment :: Web Environment\n-    Framework :: Plone :: 6.0\n+    Framework :: Plone :: 6.1\n     Framework :: Plone :: Core\n     Framework :: Zope :: 5\n     License :: OSI Approved :: GNU General Public License v2 (GPLv2)\n     Operating System :: OS Independent\n     Programming Language :: Python\n-    Programming Language :: Python :: 3.8\n-    Programming Language :: Python :: 3.9\n     Programming Language :: Python :: 3.10\n     Programming Language :: Python :: 3.11\n+    Programming Language :: Python :: 3.12\n \n [options]\n include_package_data = True\n-python_requires = >=3.8\n+python_requires = >=3.10\n install_requires =\n     setuptools\n     # be aware to _not_ add dependencies to plone.app.* or Plones Products.* packages!\n'

Repository: plone.base


Branch: refs/heads/main
Date: 2024-05-30T22:02:34+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.base/commit/a9ed0877aaa283ce02af224178a4cadeb0139672

Restore Plone Site default in ISearchSchema

Files changed:
M news/65.bugfix
M src/plone/base/interfaces/controlpanel.py

b'diff --git a/news/65.bugfix b/news/65.bugfix\nindex 6080d70..5230a5e 100644\n--- a/news/65.bugfix\n+++ b/news/65.bugfix\n@@ -1,4 +1,4 @@\n-Remove ISearchSchemas types_not_searched "Discussion Item" value from plone.app.discussion and other impossible values too.\n-Default is empty now, since there will never the construction allowed of these three.\n+Remove ISearchSchemas types_not_searched "Discussion Item" value to make plone.app.discussion a core addon.\n+It is actually not needed anyway, also not part of the underlying vocabulary and would be lost on first save in control-panel.\n See https://github.com/zopefoundation/Products.CMFCore/blob/8d765b8ce7ec4e053e58f5c8dc45d08db01ce3e0/src/Products/CMFCore/TypesTool.py#L768\n [@jensens]\ndiff --git a/src/plone/base/interfaces/controlpanel.py b/src/plone/base/interfaces/controlpanel.py\nindex ee5e5fc..7f57588 100644\n--- a/src/plone/base/interfaces/controlpanel.py\n+++ b/src/plone/base/interfaces/controlpanel.py\n@@ -1015,7 +1015,13 @@ class ISearchSchema(Interface):\n             "off here or by the relevant installer."\n         ),\n         required=False,\n-        default=(),\n+        # XXX: Actually, the Plone Site and TempFolder are not part of the vocabulary\n+        # and would be removed from the list of types not searched on first save in ControlPanel!\n+        # Both are used in many tests and kept for now.\n+        default=(\n+            "Plone Site",\n+            "TempFolder",\n+        ),\n         missing_value=(),\n         value_type=schema.Choice(source="plone.app.vocabularies.PortalTypes"),\n     )\n'

Repository: plone.base


Branch: refs/heads/main
Date: 2024-05-30T23:37:57+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.base/commit/53723bb80c51b945c0aef5c5076d2933c7237ef0

Merge pull request #65 from plone/pa-discussion-core-addon

Remove 'Discussion Item' from SearchSchema (helps also to turn pa.discussion into a core addon)

Files changed:
A news/65.bugfix
M src/plone/base/interfaces/controlpanel.py

b'diff --git a/news/65.bugfix b/news/65.bugfix\nnew file mode 100644\nindex 0000000..5230a5e\n--- /dev/null\n+++ b/news/65.bugfix\n@@ -0,0 +1,4 @@\n+Remove ISearchSchemas types_not_searched "Discussion Item" value to make plone.app.discussion a core addon.\n+It is actually not needed anyway, also not part of the underlying vocabulary and would be lost on first save in control-panel.\n+See https://github.com/zopefoundation/Products.CMFCore/blob/8d765b8ce7ec4e053e58f5c8dc45d08db01ce3e0/src/Products/CMFCore/TypesTool.py#L768\n+[@jensens]\ndiff --git a/src/plone/base/interfaces/controlpanel.py b/src/plone/base/interfaces/controlpanel.py\nindex 73941ce..7f57588 100644\n--- a/src/plone/base/interfaces/controlpanel.py\n+++ b/src/plone/base/interfaces/controlpanel.py\n@@ -1015,8 +1015,10 @@ class ISearchSchema(Interface):\n             "off here or by the relevant installer."\n         ),\n         required=False,\n+        # XXX: Actually, the Plone Site and TempFolder are not part of the vocabulary\n+        # and would be removed from the list of types not searched on first save in ControlPanel!\n+        # Both are used in many tests and kept for now.\n         default=(\n-            "Discussion Item",\n             "Plone Site",\n             "TempFolder",\n         ),\n'

