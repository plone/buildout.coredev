Repository: plone.app.layout


Branch: refs/heads/master
Date: 2024-05-13T17:31:16+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.app.layout/commit/12d9c143ca6c849fc3142f63684c3c218fc1444c

fix: `DefaultBodyClasses` is a multi adapter

And it needs to be registered in ZCML to get a name.

Files changed:
M plone/app/layout/globals/configure.zcml
M plone/app/layout/globals/layout.py

b'diff --git a/plone/app/layout/globals/configure.zcml b/plone/app/layout/globals/configure.zcml\nindex 5582d28e..3d1ae904 100644\n--- a/plone/app/layout/globals/configure.zcml\n+++ b/plone/app/layout/globals/configure.zcml\n@@ -51,4 +51,9 @@\n     <implements interface="zope.annotation.interfaces.IAttributeAnnotatable" />\n   </class>\n \n+  <adapter\n+      factory=".layout.DefaultBodyClasses"\n+      name="default-classes"\n+      />\n+\n </configure>\ndiff --git a/plone/app/layout/globals/layout.py b/plone/app/layout/globals/layout.py\nindex a122b5ca..f70395af 100644\n--- a/plone/app/layout/globals/layout.py\n+++ b/plone/app/layout/globals/layout.py\n@@ -296,7 +296,7 @@ def bodyClass(self, template, view):\n         return " ".join(sorted(body_classes))\n \n \n-@adapter(Interface)\n+@adapter(Interface, Interface)\n @implementer(IBodyClassAdapter)\n class DefaultBodyClasses:\n     def __init__(self, context, request):\n'

Repository: plone.app.layout


Branch: refs/heads/master
Date: 2024-05-13T17:33:51+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.app.layout/commit/6e9258ada0bd806c6109faec698bf28fa3cf0c4c

Add news entry

Files changed:
A news/+fix-adapter.bugfix

b'diff --git a/news/+fix-adapter.bugfix b/news/+fix-adapter.bugfix\nnew file mode 100644\nindex 00000000..8839ec19\n--- /dev/null\n+++ b/news/+fix-adapter.bugfix\n@@ -0,0 +1,2 @@\n+Fix `DefaultBodyClasses` adapter registration.\n+[gforcada]\n'

Repository: plone.app.layout


Branch: refs/heads/master
Date: 2024-06-16T12:12:27+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@py76.be>
Commit: https://github.com/plone/plone.app.layout/commit/52e228e167e9b2190c1c412f6fa59a7bfae5ec4b

Merge pull request #368 from plone/fix-adapter-registration

Fix adapter registration

Files changed:
A news/+fix-adapter.bugfix
M plone/app/layout/globals/configure.zcml
M plone/app/layout/globals/layout.py

b'diff --git a/news/+fix-adapter.bugfix b/news/+fix-adapter.bugfix\nnew file mode 100644\nindex 00000000..8839ec19\n--- /dev/null\n+++ b/news/+fix-adapter.bugfix\n@@ -0,0 +1,2 @@\n+Fix `DefaultBodyClasses` adapter registration.\n+[gforcada]\ndiff --git a/plone/app/layout/globals/configure.zcml b/plone/app/layout/globals/configure.zcml\nindex 5582d28e..3d1ae904 100644\n--- a/plone/app/layout/globals/configure.zcml\n+++ b/plone/app/layout/globals/configure.zcml\n@@ -51,4 +51,9 @@\n     <implements interface="zope.annotation.interfaces.IAttributeAnnotatable" />\n   </class>\n \n+  <adapter\n+      factory=".layout.DefaultBodyClasses"\n+      name="default-classes"\n+      />\n+\n </configure>\ndiff --git a/plone/app/layout/globals/layout.py b/plone/app/layout/globals/layout.py\nindex a122b5ca..f70395af 100644\n--- a/plone/app/layout/globals/layout.py\n+++ b/plone/app/layout/globals/layout.py\n@@ -296,7 +296,7 @@ def bodyClass(self, template, view):\n         return " ".join(sorted(body_classes))\n \n \n-@adapter(Interface)\n+@adapter(Interface, Interface)\n @implementer(IBodyClassAdapter)\n class DefaultBodyClasses:\n     def __init__(self, context, request):\n'

