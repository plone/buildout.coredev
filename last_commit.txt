Repository: plone.testing


Branch: refs/heads/master
Date: 2021-05-20T20:26:33+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.testing/commit/42837a9941e2e242ccb97398686c4030e9d5273d

Catch FileNotFound error in test teardown when removing a temporary directory.

Fixes https://github.com/plone/plone.testing/issues/79.

Files changed:
A news/79.bugfix
M src/plone/testing/zope.py

b'diff --git a/news/79.bugfix b/news/79.bugfix\nnew file mode 100644\nindex 0000000..f9c5f9e\n--- /dev/null\n+++ b/news/79.bugfix\n@@ -0,0 +1,3 @@\n+Catch FileNotFound error in test teardown when removing a temporary directory.\n+Fixes `issue 79 <https://github.com/plone/plone.testing/issues/79>`_.\n+[maurits]\ndiff --git a/src/plone/testing/zope.py b/src/plone/testing/zope.py\nindex f59a53d..cee9aff 100644\n--- a/src/plone/testing/zope.py\n+++ b/src/plone/testing/zope.py\n@@ -935,7 +935,10 @@ def tearDownServer(self):\n         """Close the server socket and clean up.\n         """\n         self.server.shutdown()\n-        shutil.rmtree(self._wsgi_conf_dir)\n+        try:\n+            shutil.rmtree(self._wsgi_conf_dir)\n+        except FileNotFoundError:\n+            pass\n \n     def make_wsgi_app(self):\n         self._wsgi_conf_dir = tempfile.mkdtemp()\n'

Repository: plone.testing


Branch: refs/heads/master
Date: 2021-05-20T22:14:32+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.testing/commit/48834a14bacd2e1fdd242b59103d1cb10e23d0b4

Use OSError instead of FileNotFoundError.

The last one does not exist on Python 2.

Files changed:
M news/79.bugfix
M src/plone/testing/zope.py

b'diff --git a/news/79.bugfix b/news/79.bugfix\nindex f9c5f9e..7119b97 100644\n--- a/news/79.bugfix\n+++ b/news/79.bugfix\n@@ -1,3 +1,3 @@\n-Catch FileNotFound error in test teardown when removing a temporary directory.\n+Catch OSError in test teardown when removing a temporary directory.\n Fixes `issue 79 <https://github.com/plone/plone.testing/issues/79>`_.\n [maurits]\ndiff --git a/src/plone/testing/zope.py b/src/plone/testing/zope.py\nindex cee9aff..040d4cc 100644\n--- a/src/plone/testing/zope.py\n+++ b/src/plone/testing/zope.py\n@@ -937,7 +937,7 @@ def tearDownServer(self):\n         self.server.shutdown()\n         try:\n             shutil.rmtree(self._wsgi_conf_dir)\n-        except FileNotFoundError:\n+        except OSError:\n             pass\n \n     def make_wsgi_app(self):\n'

Repository: plone.testing


Branch: refs/heads/master
Date: 2021-05-26T16:04:35+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.testing/commit/f85d2d5562418f4e36f7bc7888c5d356e084ad32

Merge pull request #80 from plone/maurits/fix-failure-in-teardown

Catch FileNotFound error in teardown when removing temporary directory

Files changed:
A news/79.bugfix
M src/plone/testing/zope.py

b'diff --git a/news/79.bugfix b/news/79.bugfix\nnew file mode 100644\nindex 0000000..7119b97\n--- /dev/null\n+++ b/news/79.bugfix\n@@ -0,0 +1,3 @@\n+Catch OSError in test teardown when removing a temporary directory.\n+Fixes `issue 79 <https://github.com/plone/plone.testing/issues/79>`_.\n+[maurits]\ndiff --git a/src/plone/testing/zope.py b/src/plone/testing/zope.py\nindex f59a53d..040d4cc 100644\n--- a/src/plone/testing/zope.py\n+++ b/src/plone/testing/zope.py\n@@ -935,7 +935,10 @@ def tearDownServer(self):\n         """Close the server socket and clean up.\n         """\n         self.server.shutdown()\n-        shutil.rmtree(self._wsgi_conf_dir)\n+        try:\n+            shutil.rmtree(self._wsgi_conf_dir)\n+        except OSError:\n+            pass\n \n     def make_wsgi_app(self):\n         self._wsgi_conf_dir = tempfile.mkdtemp()\n'

