Repository: plone.rest


Branch: refs/heads/main
Date: 2023-10-20T15:28:41+02:00
Author: Roel Bruggink (jaroel) <roel@jaroel.nl>
Commit: https://github.com/plone/plone.rest/commit/1bd2477b94a5e25a2fe28f46e6aecef0c781341a

Reset SKIP_PTA to whatever it was.

Before it would leak into other tests, enabling the publication check when it shouldn't be active.

Files changed:
M src/plone/rest/tests/test_explicitacquisition.py

b'diff --git a/src/plone/rest/tests/test_explicitacquisition.py b/src/plone/rest/tests/test_explicitacquisition.py\nindex beee007..7c5d8cc 100644\n--- a/src/plone/rest/tests/test_explicitacquisition.py\n+++ b/src/plone/rest/tests/test_explicitacquisition.py\n@@ -68,10 +68,18 @@ class TestExplicitAcquisitionAvailable(unittest.TestCase):\n     layer = PLONE_REST_INTEGRATION_TESTING\n \n     def setUp(self):\n+        import Products.CMFCore.explicitacquisition\n+\n         self.portal = self.layer["portal"]\n         self.request = self.layer["request"]\n         setRoles(self.portal, TEST_USER_ID, ["Manager"])\n         self.portal.invokeFactory("Document", id="foo")\n+        self.PREVIOUS_SKIP_PTA = Products.CMFCore.explicitacquisition.SKIP_PTA\n+\n+    def tearDown(self):\n+        import Products.CMFCore.explicitacquisition\n+\n+        Products.CMFCore.explicitacquisition.SKIP_PTA = self.PREVIOUS_SKIP_PTA\n \n     def traverse(self, path="/plone", accept="application/json", method="GET"):\n         request = self.layer["request"]\n'

Repository: plone.rest


Branch: refs/heads/main
Date: 2023-10-20T16:18:35+02:00
Author: Roel Bruggink (jaroel) <roel@jaroel.nl>
Commit: https://github.com/plone/plone.rest/commit/d83b13b6f3393453a9c7001a8549914f54a83393

changelog

Files changed:
A news/168.bugfix

b"diff --git a/news/168.bugfix b/news/168.bugfix\nnew file mode 100644\nindex 0000000..5b362b6\n--- /dev/null\n+++ b/news/168.bugfix\n@@ -0,0 +1 @@\n+Fix test leakage, enabling the publication check when it shouldn't be active. @jaroel\n\\ No newline at end of file\n"

Repository: plone.rest


Branch: refs/heads/main
Date: 2023-10-20T16:23:13+02:00
Author: Roel Bruggink (jaroel) <roel@jaroel.nl>
Commit: https://github.com/plone/plone.rest/commit/65a53943d56710353ac0fac24e2bd715bb0d78c4

Rename 168.bugfix to 168.internal

Files changed:
A news/168.internal
D news/168.bugfix

b"diff --git a/news/168.bugfix b/news/168.internal\nsimilarity index 74%\nrename from news/168.bugfix\nrename to news/168.internal\nindex 5b362b6..b4bdf12 100644\n--- a/news/168.bugfix\n+++ b/news/168.internal\n@@ -1 +1 @@\n-Fix test leakage, enabling the publication check when it shouldn't be active. @jaroel\n\\ No newline at end of file\n+Fix test leakage, enabling the publication check when it shouldn't be active. @jaroel\n"

Repository: plone.rest


Branch: refs/heads/main
Date: 2023-10-20T08:35:06-07:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.rest/commit/772e5b6eded46fb5a0d6a6ceaae123f0b9ebdfd4

Merge pull request #168 from plone/explicitacquisition-fixup-2

Fixup tests: reset SKIP_PTA to whatever it was

Files changed:
A news/168.internal
M src/plone/rest/tests/test_explicitacquisition.py

b'diff --git a/news/168.internal b/news/168.internal\nnew file mode 100644\nindex 0000000..b4bdf12\n--- /dev/null\n+++ b/news/168.internal\n@@ -0,0 +1 @@\n+Fix test leakage, enabling the publication check when it shouldn\'t be active. @jaroel\ndiff --git a/src/plone/rest/tests/test_explicitacquisition.py b/src/plone/rest/tests/test_explicitacquisition.py\nindex beee007..7c5d8cc 100644\n--- a/src/plone/rest/tests/test_explicitacquisition.py\n+++ b/src/plone/rest/tests/test_explicitacquisition.py\n@@ -68,10 +68,18 @@ class TestExplicitAcquisitionAvailable(unittest.TestCase):\n     layer = PLONE_REST_INTEGRATION_TESTING\n \n     def setUp(self):\n+        import Products.CMFCore.explicitacquisition\n+\n         self.portal = self.layer["portal"]\n         self.request = self.layer["request"]\n         setRoles(self.portal, TEST_USER_ID, ["Manager"])\n         self.portal.invokeFactory("Document", id="foo")\n+        self.PREVIOUS_SKIP_PTA = Products.CMFCore.explicitacquisition.SKIP_PTA\n+\n+    def tearDown(self):\n+        import Products.CMFCore.explicitacquisition\n+\n+        Products.CMFCore.explicitacquisition.SKIP_PTA = self.PREVIOUS_SKIP_PTA\n \n     def traverse(self, path="/plone", accept="application/json", method="GET"):\n         request = self.layer["request"]\n'

