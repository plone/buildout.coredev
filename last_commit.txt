Repository: plone.restapi


Branch: refs/heads/master
Date: 2023-08-24T08:02:06+02:00
Author: Timo Stollenwerk (tisto) <tisto@users.noreply.github.com>
Commit: https://github.com/plone/plone.restapi/commit/d3ab72bef8b4e51e3eae5ec54efefbee48d79dc1

Docs: add section to upgrade guide for p.restapi 8 (#1689)

* Docs: add section to upgrade guide for p.restapi 8

* Update docs/source/upgrade-guide.md

Co-authored-by: David Glick &lt;david@glicksoftware.com&gt;

---------

Co-authored-by: David Glick &lt;david@glicksoftware.com&gt;

Files changed:
M docs/source/upgrade-guide.md

b'diff --git a/docs/source/upgrade-guide.md b/docs/source/upgrade-guide.md\nindex c83935514..484760793 100644\n--- a/docs/source/upgrade-guide.md\n+++ b/docs/source/upgrade-guide.md\n@@ -12,6 +12,12 @@ myst:\n This upgrade guide lists all breaking changes in `plone.restapi`.\n It explains the steps that are needed to upgrade to the latest version.\n \n+## Upgrading to `plone.restapi` 8.x\n+\n+plone.restapi 8.x dropped support for Python 2 and Plone 5.1 and 4.3.\n+Upgrading to plone.restapi 8.x does not require any changes to your code base if you use Python 3 and Plone 5.2 or newer.\n+\n+If you use Python 2 and a Plone version older than 5.2, stick with plone.restapi 7.x.\n \n ## Upgrading to `plone.restapi` 7.x\n \n@@ -20,7 +26,6 @@ Now its behavior is consistent regarding the `items` attribute.\n Now the `items` attribute is present, even if the element of the tree does not have child elements, in which case it will be an empty array.\n This might affect some logins via JavaScript, specifically if the condition is checking for the existence of the `items` attribute and expects it to be `undefined`.\n \n-\n ## Upgrading to `plone.restapi` 6.x\n \n `plone.restapi` 6.0.0 removes the `IAPIRequest` marker interface (<https://github.com/plone/plone.restapi/pull/819>).\n@@ -44,7 +49,6 @@ If you need to fix object IDs, you can do one of the following:\n We expect that most content actually will not be affected.\n See <https://github.com/plone/plone.restapi/issues/827> for more details.\n \n-\n ## Upgrading to `plone.restapi` 5.x\n \n `plone.restapi` 5.0.0 introduces the following breaking change:\n@@ -88,7 +92,6 @@ to:\n This change affects the `GET`, `PATCH`, and `POST` formats.\n It should only affect you if you use Volto.\n \n-\n ## Upgrading to `plone.restapi` 4.x\n \n `plone.restapi` 4.0.0 introduces the following breaking changes:\n@@ -98,7 +101,6 @@ It should only affect you if you use Volto.\n 3.  Serialize widget parameters into a `widgetOptions` object instead of adding them to the top level of the schema property.\n 4.  The vocabularies endpoint does no longer returns an `@id` for terms, the results are batched, and terms are now listed as `items` instead of `terms` to match other batched responses.\n \n-\n ### Serialization and Deserialization of fields with vocabularies\n \n The serialization of fields with vocabularies, such as `Choice`, now return the `token` and the `title` of the vocabulary term instead of the stored value.\n@@ -140,7 +142,6 @@ Deserialization accepts objects that contain a token, but also just the token or\n \n However, it is highly recommended to always use the token, as vocabulary terms may contain values that are not JSON serializable.\n \n-\n ### Choice and List fields return link to vocabulary instead of the values\n \n Choice and List fields using named vocabularies are now serialized with a `vocabulary` property, giving the URL of the `@vocabularies` endpoint for the vocabulary instead of including `choices`,\n@@ -177,7 +178,6 @@ New response:\n },\n ```\n \n-\n ### Serialize widget parameters into a `widgetOptions` object\n \n Serialize widget parameters into a `widgetOptions` object instead of adding them to the top level of the schema property.\n@@ -199,7 +199,6 @@ New response:\n }\n ```\n \n-\n ### Example: Vocabularies Subjects Field\n \n The `subjects` field is now serialized as an `array` of `string` items using the `plone.app.vocabularies.Keywords` vocabulary.\n@@ -233,7 +232,6 @@ New response:\n }\n ```\n \n-\n ### Example: Available Time Zones Field (vocabulary in `items`)\n \n Old response:\n@@ -289,7 +287,6 @@ New response:\n },\n ```\n \n-\n ### Example: Weekday Field (vocabulary in main property)\n \n Old response:\n@@ -363,7 +360,6 @@ New response:\n },\n ```\n \n-\n ### Vocabularies Endpoint\n \n The vocabularies endpoint no longer returns an `@id` for terms.\n@@ -394,20 +390,18 @@ New response:\n {\n   "@id": "http://localhost:55001/plone/@vocabularies/plone.app.vocabularies.ReallyUserFriendlyTypes",\n   "items": [\n-      {\n-        "title": "Collection",\n-        "token": "Collection"\n-      },\n-      "\xe2\x80\xa6"\n+    {\n+      "title": "Collection",\n+      "token": "Collection"\n+    },\n+    "\xe2\x80\xa6"\n   ],\n   "items_total": 12\n }\n ```\n \n-\n ## Upgrading to `plone.restapi` 3.x\n \n-\n ### Image scales\n \n Image download URLs and image scale URLs are created using the UID-based URL formats.\n@@ -449,7 +443,6 @@ New Response:\n }\n ```\n \n-\n ### `@sharing` endpoint\n \n The `available_roles` property in the response to a `GET` request to the `@sharing` endpoint has changed.\n@@ -507,7 +500,6 @@ Content-Type: application/json\n }\n ```\n \n-\n ### Custom Content Deserializers\n \n If you have implemented custom content deserializers, you have to handle the new `create` keyword in the `__call__` method, which determines if deserialization is performed during object creation or while updating an object.\n@@ -516,13 +508,11 @@ Deserializers should only fire an `IObjectModifiedEvent` event if an object has\n \n See [Dexterity content deserializer](https://github.com/plone/plone.restapi/blob/master/src/plone/restapi/deserializer/dxcontent.py) for an example.\n \n-\n ## Upgrading to `plone.restapi` 2.x\n \n `plone.restapi` 2.0.0 converts all datetime, DateTime and time objects to UTC before serializing.\n The translations endpoint becomes "expandable", which introduces the following breaking changes.\n \n-\n ### Translations\n \n Previously when using the `@translations` endpoint in `plone.restapi` 1.x, the endpoint returned a `language` key with the content object\'s language and a `translations` key with all its translations.\n@@ -567,7 +557,6 @@ Content-Type: application/json\n }\n ```\n \n-\n ## Upgrading to `plone.restapi` 1.0b1\n \n In `plone.restapi` 1.0b1 the `url` attribute on the {ref}`navigation` and {ref}`breadcrumbs` endpoint was renamed to `@id` to be consistent with other links/URLs used in `plone.restapi`.\n@@ -720,7 +709,6 @@ Pull Request:\n \n - <https://github.com/plone/plone.restapi/pull/459>\n \n-\n ## Upgrading to `plone.restapi` 1.0a25\n \n `plone.restapi` 1.0a25 introduced three breaking changes:\n@@ -729,8 +717,7 @@ Pull Request:\n   Use top level `@navigation` and `@breadcrumb` endpoints instead. [timo]\n - Remove `sharing` attributes from `GET` response. [timo, jaroel]\n - Convert `richtext` using `.output_relative_to`.\n-  Direct conversion from `RichText` is no longer supported as we *always* need a context for the `ITransformer`. [jaroel]\n-\n+  Direct conversion from `RichText` is no longer supported as we _always_ need a context for the `ITransformer`. [jaroel]\n \n ### Remove @components endpoint\n \n@@ -769,7 +756,6 @@ Pull Request:\n \n - <https://github.com/plone/plone.restapi/pull/425>\n \n-\n ### Remove `sharing` attribute\n \n The `sharing` attribute was removed from all content `GET` responses:\n@@ -791,7 +777,6 @@ Pull Request:\n \n - <https://github.com/plone/plone.restapi/commit/1b5e9e3a74df22e53b674849e27fa4b39b792b8c>\n \n-\n ### Convert `richtext` using `.output_relative_to`\n \n Use `.output_relative_to` to convert `richtext`.\n@@ -799,13 +784,12 @@ Use `.output_relative_to` to convert `richtext`.\n Changelog:\n \n - Convert `richtext` using `.output_relative_to.`\n-  Direct conversion from `RichText` is no longer supported as we *always* need a context for the `ITransformer`. [jaroel]\n+  Direct conversion from `RichText` is no longer supported as we _always_ need a context for the `ITransformer`. [jaroel]\n \n Pull Request:\n \n - <https://github.com/plone/plone.restapi/pull/428>\n \n-\n ## Upgrading to `plone.restapi` 1.0a17\n \n `plone.restapi` 1.0a17 changed the serialization of the `richtext` "text" field for content objects from using `raw` (a Unicode string with the original input markup):\n'

