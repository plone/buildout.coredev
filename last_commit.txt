Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2020-09-11T14:47:17+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.upgrade/commit/358e5e861fd7fa84b2180116f536652bf4acb339

Replaced import of plone.api, which should not be used by core.

Fixes https://github.com/plone/plone.app.upgrade/issues/241

Files changed:
A news/241.bugfix
M plone/app/upgrade/v52/final.py

b'diff --git a/news/241.bugfix b/news/241.bugfix\nnew file mode 100644\nindex 00000000..5ed2fa92\n--- /dev/null\n+++ b/news/241.bugfix\n@@ -0,0 +1,2 @@\n+Replaced import of plone.api, which should not be used by core.\n+[maurits]\ndiff --git a/plone/app/upgrade/v52/final.py b/plone/app/upgrade/v52/final.py\nindex c5bbf979..a923b131 100644\n--- a/plone/app/upgrade/v52/final.py\n+++ b/plone/app/upgrade/v52/final.py\n@@ -36,11 +36,10 @@ def rebuild_redirections(context):\n \n def move_dotted_to_named_behaviors(context):\n     """named behaviors are better then dotted behaviors > let\'s move them."""\n-    from plone import api\n     from plone.behavior.registration import lookup_behavior_registration\n     from plone.dexterity.interfaces import IDexterityFTI\n \n-    ptt = api.portal.get_tool(\'portal_types\')\n+    ptt = getToolByName(context, \'portal_types\')\n \n     ftis = [fti for fti in ptt.objectValues() if IDexterityFTI.providedBy(fti)]\n \n'

Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2020-09-12T20:01:20+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.app.upgrade/commit/a867e20ba2ecc574116accc589a22706f6fd7d94

Merge pull request #242 from plone/maurits/no-plone-api

Replaced import of plone.api, which should not be used by core.

Files changed:
A news/241.bugfix
M plone/app/upgrade/v52/final.py

b'diff --git a/news/241.bugfix b/news/241.bugfix\nnew file mode 100644\nindex 00000000..5ed2fa92\n--- /dev/null\n+++ b/news/241.bugfix\n@@ -0,0 +1,2 @@\n+Replaced import of plone.api, which should not be used by core.\n+[maurits]\ndiff --git a/plone/app/upgrade/v52/final.py b/plone/app/upgrade/v52/final.py\nindex 76f64fc8..c9da7075 100644\n--- a/plone/app/upgrade/v52/final.py\n+++ b/plone/app/upgrade/v52/final.py\n@@ -39,11 +39,10 @@ def rebuild_redirections(context):\n \n def move_dotted_to_named_behaviors(context):\n     """named behaviors are better then dotted behaviors > let\'s move them."""\n-    from plone import api\n     from plone.behavior.registration import lookup_behavior_registration\n     from plone.dexterity.interfaces import IDexterityFTI\n \n-    ptt = api.portal.get_tool(\'portal_types\')\n+    ptt = getToolByName(context, \'portal_types\')\n \n     ftis = [fti for fti in ptt.objectValues() if IDexterityFTI.providedBy(fti)]\n \n'

