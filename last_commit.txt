Repository: plone.recipe.zope2instance


Branch: refs/heads/master
Date: 2020-07-31T16:53:37+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.recipe.zope2instance/commit/1c69983a9abb83bcb85d46ecc325936bf84cdb65

Generate raw strings in order to allow windows backslashes in paths

Files changed:
A news/145.bugfix
M README.rst
M src/plone/recipe/zope2instance/recipe.py
M src/plone/recipe/zope2instance/tests/wsgi.txt

b'diff --git a/README.rst b/README.rst\nindex 607770f..e7432e5 100644\n--- a/README.rst\n+++ b/README.rst\n@@ -361,7 +361,7 @@ access-log-args\n   `("access.log", )` The `access-log-args` is used to specify the positional\n   parameters for the logging handler configured through `access-log-handler`.\n \n-  Default: `("access.log", "a")`\n+  Default: `(r"access.log", "a")`\n \n access-log-kwargs\n   A python dictionary used for passing keyword argument for the logging handler\n@@ -385,7 +385,7 @@ This example uses a `RotatingFileHandler` https://docs.python.org/3/library/logg\n which rotates the access log when it becomes larger than 10 MB while keeping seven copies::\n \n     access-log-handler = logging.handlers.RotatingFileHandler\n-    access-log-args  = ("access.log", "a")\n+    access-log-args  = (r"access.log", "a")\n     access-log-kwargs = {"maxBytes": 10000000, "maxCount": 7}\n \n Example (rotating of event log after each day)\n@@ -395,7 +395,7 @@ This example uses a `TimedRotatingFileHandler` https://docs.python.org/3/library\n for rotating the event log every 24 hours or one day::\n \n     event-log-handler = logging.handlers.TimedRotatingFileHandler\n-    event-log-args = ("event.log", )\n+    event-log-args = (r"event.log", )\n     event-log-kwargs = {"when": "D", "interval": 1}\n \n Load non-setuptools compatible Python libraries\ndiff --git a/news/145.bugfix b/news/145.bugfix\nnew file mode 100644\nindex 0000000..094e2f3\n--- /dev/null\n+++ b/news/145.bugfix\n@@ -0,0 +1,2 @@\n+Fix "SyntaxError" on windows: Generate raw strings in order to allow backslashes in log file paths.\n+[jensens]\ndiff --git a/src/plone/recipe/zope2instance/recipe.py b/src/plone/recipe/zope2instance/recipe.py\nindex 487aeaf..2dcdee9 100644\n--- a/src/plone/recipe/zope2instance/recipe.py\n+++ b/src/plone/recipe/zope2instance/recipe.py\n@@ -743,7 +743,7 @@ def build_wsgi_ini(self):\n         eventlog_kwargs = options.get(\'event-log-kwargs\', \'{}\')\n         eventlog_args = options.get(\'event-log-args\')\n         if not eventlog_args:\n-            eventlog_args = "(\'{}\', \'a\')".format(eventlog_name)\n+            eventlog_args = "(r\'{}\', \'a\')".format(eventlog_name)\n         else:\n             eventlog_args = eventlog_args.format(eventlog_name)\n \n@@ -767,7 +767,7 @@ def build_wsgi_ini(self):\n         accesslog_kwargs = options.get(\'access-log-kwargs\', \'{}\')\n         accesslog_args = options.get(\'access-log-args\')\n         if not accesslog_args:\n-            accesslog_args = "(\'{}\', \'a\')".format(accesslog_name)\n+            accesslog_args = "(r\'{}\', \'a\')".format(accesslog_name)\n         else:\n             accesslog_args = accesslog_args.format(accesslog_name)\n \ndiff --git a/src/plone/recipe/zope2instance/tests/wsgi.txt b/src/plone/recipe/zope2instance/tests/wsgi.txt\nindex 19de33a..59bdd7b 100644\n--- a/src/plone/recipe/zope2instance/tests/wsgi.txt\n+++ b/src/plone/recipe/zope2instance/tests/wsgi.txt\n@@ -140,14 +140,14 @@ The buildout has also created an INI file containing the waitress configuration:\n     <BLANKLINE>\n     [handler_accesslog]\n     class = FileHandler\n-    args = (\'.../sample-buildout/var/log/instance-access.log\', \'a\')\n+    args = (r\'.../sample-buildout/var/log/instance-access.log\', \'a\')\n     kwargs = {}\n     level = INFO\n     formatter = message\n     <BLANKLINE>\n     [handler_eventlog]\n     class = FileHandler\n-    args = (\'.../sample-buildout/var/log/instance.log\', \'a\')\n+    args = (r\'.../sample-buildout/var/log/instance.log\', \'a\')\n     kwargs = {}\n     level = NOTSET\n     formatter = generic\n@@ -267,14 +267,14 @@ The buildout has updated our INI file:\n     ...\n     [handler_accesslog]\n     class = FileHandler\n-    args = (\'var/log/foo.log\', \'a\')\n+    args = (r\'var/log/foo.log\', \'a\')\n     kwargs = {}\n     level = DEBUG\n     formatter = message\n     <BLANKLINE>\n     [handler_eventlog]\n     class = FileHandler\n-    args = (\'var/log/bar.log\', \'a\')\n+    args = (r\'var/log/bar.log\', \'a\')\n     kwargs = {}\n     level = NOTSET\n     formatter = generic\n'

Repository: plone.recipe.zope2instance


Branch: refs/heads/master
Date: 2020-07-31T20:55:24+02:00
Author: Maurits van Rees (mauritsvanrees) <m.van.rees@zestsoftware.nl>
Commit: https://github.com/plone/plone.recipe.zope2instance/commit/090ca4f6d54b3611777869a8b1550879ff9832cd

Merge pull request #145 from plone/generate-raw-strings

Generate raw strings in order to allow windows backslashes in paths

Files changed:
A news/145.bugfix
M README.rst
M src/plone/recipe/zope2instance/recipe.py
M src/plone/recipe/zope2instance/tests/wsgi.txt

b'diff --git a/README.rst b/README.rst\nindex 607770f..e7432e5 100644\n--- a/README.rst\n+++ b/README.rst\n@@ -361,7 +361,7 @@ access-log-args\n   `("access.log", )` The `access-log-args` is used to specify the positional\n   parameters for the logging handler configured through `access-log-handler`.\n \n-  Default: `("access.log", "a")`\n+  Default: `(r"access.log", "a")`\n \n access-log-kwargs\n   A python dictionary used for passing keyword argument for the logging handler\n@@ -385,7 +385,7 @@ This example uses a `RotatingFileHandler` https://docs.python.org/3/library/logg\n which rotates the access log when it becomes larger than 10 MB while keeping seven copies::\n \n     access-log-handler = logging.handlers.RotatingFileHandler\n-    access-log-args  = ("access.log", "a")\n+    access-log-args  = (r"access.log", "a")\n     access-log-kwargs = {"maxBytes": 10000000, "maxCount": 7}\n \n Example (rotating of event log after each day)\n@@ -395,7 +395,7 @@ This example uses a `TimedRotatingFileHandler` https://docs.python.org/3/library\n for rotating the event log every 24 hours or one day::\n \n     event-log-handler = logging.handlers.TimedRotatingFileHandler\n-    event-log-args = ("event.log", )\n+    event-log-args = (r"event.log", )\n     event-log-kwargs = {"when": "D", "interval": 1}\n \n Load non-setuptools compatible Python libraries\ndiff --git a/news/145.bugfix b/news/145.bugfix\nnew file mode 100644\nindex 0000000..094e2f3\n--- /dev/null\n+++ b/news/145.bugfix\n@@ -0,0 +1,2 @@\n+Fix "SyntaxError" on windows: Generate raw strings in order to allow backslashes in log file paths.\n+[jensens]\ndiff --git a/src/plone/recipe/zope2instance/recipe.py b/src/plone/recipe/zope2instance/recipe.py\nindex 487aeaf..2dcdee9 100644\n--- a/src/plone/recipe/zope2instance/recipe.py\n+++ b/src/plone/recipe/zope2instance/recipe.py\n@@ -743,7 +743,7 @@ def build_wsgi_ini(self):\n         eventlog_kwargs = options.get(\'event-log-kwargs\', \'{}\')\n         eventlog_args = options.get(\'event-log-args\')\n         if not eventlog_args:\n-            eventlog_args = "(\'{}\', \'a\')".format(eventlog_name)\n+            eventlog_args = "(r\'{}\', \'a\')".format(eventlog_name)\n         else:\n             eventlog_args = eventlog_args.format(eventlog_name)\n \n@@ -767,7 +767,7 @@ def build_wsgi_ini(self):\n         accesslog_kwargs = options.get(\'access-log-kwargs\', \'{}\')\n         accesslog_args = options.get(\'access-log-args\')\n         if not accesslog_args:\n-            accesslog_args = "(\'{}\', \'a\')".format(accesslog_name)\n+            accesslog_args = "(r\'{}\', \'a\')".format(accesslog_name)\n         else:\n             accesslog_args = accesslog_args.format(accesslog_name)\n \ndiff --git a/src/plone/recipe/zope2instance/tests/wsgi.txt b/src/plone/recipe/zope2instance/tests/wsgi.txt\nindex 19de33a..59bdd7b 100644\n--- a/src/plone/recipe/zope2instance/tests/wsgi.txt\n+++ b/src/plone/recipe/zope2instance/tests/wsgi.txt\n@@ -140,14 +140,14 @@ The buildout has also created an INI file containing the waitress configuration:\n     <BLANKLINE>\n     [handler_accesslog]\n     class = FileHandler\n-    args = (\'.../sample-buildout/var/log/instance-access.log\', \'a\')\n+    args = (r\'.../sample-buildout/var/log/instance-access.log\', \'a\')\n     kwargs = {}\n     level = INFO\n     formatter = message\n     <BLANKLINE>\n     [handler_eventlog]\n     class = FileHandler\n-    args = (\'.../sample-buildout/var/log/instance.log\', \'a\')\n+    args = (r\'.../sample-buildout/var/log/instance.log\', \'a\')\n     kwargs = {}\n     level = NOTSET\n     formatter = generic\n@@ -267,14 +267,14 @@ The buildout has updated our INI file:\n     ...\n     [handler_accesslog]\n     class = FileHandler\n-    args = (\'var/log/foo.log\', \'a\')\n+    args = (r\'var/log/foo.log\', \'a\')\n     kwargs = {}\n     level = DEBUG\n     formatter = message\n     <BLANKLINE>\n     [handler_eventlog]\n     class = FileHandler\n-    args = (\'var/log/bar.log\', \'a\')\n+    args = (r\'var/log/bar.log\', \'a\')\n     kwargs = {}\n     level = NOTSET\n     formatter = generic\n'

