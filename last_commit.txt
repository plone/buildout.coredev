Repository: mockup
Branch: refs/heads/master
Date: 2015-01-19T10:24:04+01:00
Author: Julien Marinescu (davisp1) <jma@makina-corpus.com>
Commit: https://github.com/plone/mockup/commit/66bec839a3d639f7b41243f28e824e23e518d4b7

first try to init language

Files changed:
M mockup/patterns/tinymce/pattern.js

diff --git a/mockup/patterns/tinymce/pattern.js b/mockup/patterns/tinymce/pattern.js
index 74ac881..d4a2493 100644
--- a/mockup/patterns/tinymce/pattern.js
+++ b/mockup/patterns/tinymce/pattern.js
@@ -58,6 +58,7 @@ define([
   'text!mockup-patterns-tinymce-url/templates/selection.xml',
   'mockup-utils',
   'mockup-patterns-tinymce-url/js/links',
+  "mockup-i18n",
   'translate',
   'tinymce-modern-theme', 'tinymce-advlist', 'tinymce-anchor', 'tinymce-autolink',
   'tinymce-autoresize', 'tinymce-autosave', 'tinymce-bbcode', 'tinymce-charmap',
@@ -73,7 +74,7 @@ define([
 ], function($, _,
             Base, RelatedItems, Modal, tinymce,
             AutoTOC, ResultTemplate, SelectionTemplate,
-            utils, LinkModal, _t) {
+            utils, LinkModal, i18n, _t) {
   'use strict';
 
   var TinyMCE = Base.extend({
@@ -242,6 +243,29 @@ define([
       }
       return url;
     },
+    initLanguage: function(call_back){
+      var self = this;
+      var ploneLanguage = i18n.currentLanguage;
+      var languages = [ploneLanguage];
+      if (ploneLanguage.split("_") > 1){
+        languages.push(ploneLanguage.split("_")[0]);
+      }
+      else{
+        languages.push(ploneLanguage + "_" + ploneLanguage.toUpperCase());
+      }
+
+      for (var i = 0; i < languages.length; i++) {
+        var language_tmp = languages[i];
+        $.ajax({
+            url: tinymce.baseURL + "/langs/" + language_tmp + ".js",
+            type:'HEAD',
+            success: function()
+            {
+                call_back(language_tmp);
+            }
+        });
+      };
+    },
     init: function() {
       var self = this;
       self.linkModal = self.imageModal = self.uploadModal = null;
@@ -258,7 +282,6 @@ define([
       // XXX: disabled skin means it wont load css files which we already
       // include in widgets.min.css
       tinyOptions.skin = false;
-
       self.options.relatedItems.generateImageUrl = function(data, scale) {
         // this is so, in our result and selection template, we can
         // access getting actual urls from related items
@@ -270,13 +293,19 @@ define([
           self.tiny = editor;
         }
       };
-      if (tinyOptions.language !== 'en') {
+
+      if (i18n.currentLanguage != 'en' && tinyOptions.language !== 'en') {
         tinymce.baseURL = self.options.loadingBaseUrl;
+        self.initLanguage(function(lang) {
+          tinyOptions.language = lang;
+          tinymce.init(tinyOptions);
+          self.tiny = tinymce.get(id);
+        });
+      }
+      else{
+        tinymce.init(tinyOptions);
+        self.tiny = tinymce.get(id);
       }
-
-      tinymce.init(tinyOptions);
-      self.tiny = tinymce.get(id);
-
       /* tiny really should be doing this by default
        * but this fixes overlays not saving data */
       var $form = self.$el.parents('form');


Repository: mockup
Branch: refs/heads/master
Date: 2015-02-06T10:38:30+01:00
Author: Eric BREHAULT (ebrehault) <ebrehault@gmail.com>
Commit: https://github.com/plone/mockup/commit/67f2c83497c91089d4daeb932a022d14b590e3b6

merge master

Files changed:
M .gitignore
M .travis.yml
M CHANGES.rst
M mockup/GETTING_STARTED.md
M mockup/LEARN.md
M mockup/Makefile
M mockup/bower.json
M mockup/js/bundles/filemanager.js
M mockup/js/bundles/plone.js
M mockup/js/bundles/resourceregistry.js
M mockup/js/bundles/structure.js
M mockup/js/bundles/widgets.js
M mockup/js/config.js
M mockup/js/i18n-wrapper.js
M mockup/js/i18n.js
M mockup/package.json
M mockup/patterns/accessibility/pattern.js
M mockup/patterns/autotoc/pattern.js
M mockup/patterns/backdrop/pattern.js
M mockup/patterns/cookietrigger/pattern.js
M mockup/patterns/eventedit/pattern.js
M mockup/patterns/filemanager/pattern.js
M mockup/patterns/formautofocus/pattern.js
M mockup/patterns/formunloadalert/pattern.js
M mockup/patterns/inlinevalidation/pattern.js
M mockup/patterns/markspeciallinks/pattern.js
M mockup/patterns/modal/pattern.js
M mockup/patterns/moment/pattern.js
M mockup/patterns/passwordstrength/pattern.js
M mockup/patterns/pickadate/pattern.js
M mockup/patterns/preventdoublesubmit/pattern.js
M mockup/patterns/querystring/pattern.js
M mockup/patterns/relateditems/pattern.js
M mockup/patterns/resourceregistry/js/registry.js
M mockup/patterns/resourceregistry/pattern.js
M mockup/patterns/select2/pattern.js
M mockup/patterns/sortable/pattern.js
M mockup/patterns/structure/js/views/app.js
M mockup/patterns/structure/js/views/properties.js
M mockup/patterns/structure/js/views/table.js
M mockup/patterns/structure/js/views/upload.js
M mockup/patterns/structure/pattern.js
M mockup/patterns/structure/templates/tablerow.xml
M mockup/patterns/tablesorter/pattern.js
M mockup/patterns/textareamimetypeselector/pattern.js
M mockup/patterns/texteditor/pattern.js
M mockup/patterns/thememapper/pattern.js
M mockup/patterns/tinymce/js/links.js
M mockup/patterns/tinymce/pattern.js
M mockup/patterns/toggle/pattern.js
M mockup/patterns/tooltip/pattern.js
M mockup/patterns/tree/pattern.js
M mockup/patterns/upload/less/pattern.upload.less
M mockup/patterns/upload/pattern.js
M mockup/tests/fakeserver.js
M mockup/tests/i18n-test.js
M mockup/tests/pattern-accessibility-test.js
M mockup/tests/pattern-autotoc-test.js
M mockup/tests/pattern-backdrop-test.js
M mockup/tests/pattern-cookietrigger-test.js
M mockup/tests/pattern-eventedit-test.js
M mockup/tests/pattern-filemanager-test.js
M mockup/tests/pattern-formautofocus-test.js
M mockup/tests/pattern-formunloadalert-test.js
M mockup/tests/pattern-inlinevalidation-test.js
M mockup/tests/pattern-markspeciallinks-test.js
M mockup/tests/pattern-modal-test.js
M mockup/tests/pattern-moment-test.js
M mockup/tests/pattern-passwordstrength-test.js
M mockup/tests/pattern-pickadate-test.js
M mockup/tests/pattern-preventdoublesubmit-test.js
M mockup/tests/pattern-relateditems-test.js
M mockup/tests/pattern-resourceregistry-test.js
M mockup/tests/pattern-select2-test.js
M mockup/tests/pattern-sortable-test.js
M mockup/tests/pattern-structure-test.js
M mockup/tests/pattern-tablesorter-test.js
M mockup/tests/pattern-textareamimetypeselector-test.js
M mockup/tests/pattern-tinymce-test.js
M mockup/tests/pattern-toggle-test.js
M mockup/tests/pattern-tooltip-test.js
M mockup/tests/pattern-tree-test.js
M mockup/tests/pattern-upload-test.js
M mockup/tests/utils-test.js

diff --git a/.gitignore b/.gitignore
index 3489b3d..7e4e7ad 100644
--- a/.gitignore
+++ b/.gitignore
@@ -9,3 +9,5 @@ nixenv/
 node_modules/
 sauce_connect.log*
 test-results.xml
+stamp-bower
+stamp-npm
diff --git a/.travis.yml b/.travis.yml
index 25c3b51..f085097 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -8,8 +8,9 @@ env:
     - secure: lLMAD0VmG1/SpfuJKwOT9xn4lV1pUq71WszWjpF8TgxJfIgRBYLp9QkRTXQ6pfTwXTL22YSsc8N5yhJsALKV2V57Og6Pfta6jQqRIzJU6maIZBBLqW6LQThuazF6tmEcTpty1j1LdFf3tuNVchsbsii2eRhXNdIPXLjBliMJkuo=
     - SAUCE_CONNECT_READY_FILE=/tmp/sauce-connect-ready
   matrix:
-    - BROWSERS="SL_Chrome,SL_Firefox"
-    - BROWSERS="SL_IE_8,SL_IE_9"
+    - BROWSERS="SL_Chrome"
+    - BROWSERS="SL_Firefox"
+    - BROWSERS="SL_IE_9"
     - BROWSERS="SL_IE_10,SL_IE_11"
     - BROWSERS="SL_Opera,SL_Safari"
     - BROWSERS="SL_IPhone"
@@ -28,11 +29,11 @@ script:
   - if [ "$TRAVIS_BRANCH" == "master" ]; then make test-ci; fi
   - make docs
 after_success:
-  - if [ "$BROWSERS" == "SL_Chrome,SL_Firefox" ]; then ./node_modules/.bin/lcov-result-merger "coverage/**/lcov.info" | ./node_modules/.bin/coveralls; fi
+  - if [ "$BROWSERS" == "SL_Chrome" ]; then ./node_modules/.bin/lcov-result-merger "coverage/**/lcov.info" | ./node_modules/.bin/coveralls; fi
 matrix:
   fast_finish: true
   allow_failures:
-    - env: BROWSERS="SL_IE_8,SL_IE_9"
+    - env: BROWSERS="SL_IE_9"
     - env: BROWSERS="SL_IE_10,SL_IE_11"
     - env: BROWSERS="SL_Opera,SL_Safari"
     - env: BROWSERS="SL_IPhone"
diff --git a/CHANGES.rst b/CHANGES.rst
index ed528de..23f197c 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -1,7 +1,17 @@
 Changelog
 =========
 
-1.8.3 (unreleased)
+2.0.0 (unreleased)
+------------------
+
+- Patternslib merge: Use Patternslib's scanner and registry.  This allows us
+  to: Use Patternslib patterns with Mockup/Plone and use Mockup patterns with
+  Patternslib outside of Plone. For changes required to patterns, see:
+  mockup/GETTING_STARTED.md . Refs: #460.
+  [jcbrand]
+
+
+1.8.3 (2015-01-26)
 ------------------
 
 New patterns:
@@ -26,6 +36,22 @@ New patterns:
 
 Fixes and enhancements:
 
+- Test fixes.
+  [vangheem]
+
+- Various structure pattern fixes.
+  [vangheem]
+
+- Make relateditems fullwidth.
+  [vangheem]
+
+- Add npm and bower tasks to Makefile.
+  [benniboy]
+
+- TinyMCE pattern fix: Don't append scale to generated image url, if no scale
+  is given.
+  [frapell]
+
 - In the resource registry bundle detail view, add the fields
   ``last_compilation``, ``jscompilation`` and ``csscompilation`` for display.
   This gives more insight about the state of each bundle.
@@ -36,6 +62,9 @@ Fixes and enhancements:
   ``disabled`` states.
   [thet]
 
+- Relicensing from MIT to BSD. Refs #24
+  [thet]
+
 - Modal Pattern: If ``data-base-url`` attribute is available on the body, use
   it. Otherwise search for a ``<base>`` tag. Plone 5 dropped the usage of base
   tags.
diff --git a/mockup/GETTING_STARTED.md b/mockup/GETTING_STARTED.md
index 1ec0e5e..90b0522 100644
--- a/mockup/GETTING_STARTED.md
+++ b/mockup/GETTING_STARTED.md
@@ -131,6 +131,7 @@ After that, access the served site in a webbrowser under the url:
 
     http://localhost:8000
 
+
 # Including a local mockup-core checkout for developing
 
 If you want to also hack on mockup-core together with mockup and not push the
@@ -141,3 +142,30 @@ Just replace the mockup-core line in bower.json with:
 
 Please note, you have to commit the changes on mockup-core before running
 ``make bootstrap``.
+
+
+# Upgrade from pre-2.0 to 2.0 based Mockup patterns
+
+Since version 2.0, Mockup uses the Patternslib scanner and it's registry. This
+allows us to: Use Patternslib patterns with Mockup/Plone and use Mockup
+patterns with Patternslib outside of Plone. The integration with Patternslib
+require that some small changes be made to newly developed Mockup patterns:
+
+1. Patterns should now use pat-registry as dependency instead of
+   mockup-registry.
+
+        define([
+            'jquery'
+            'mockup-patterns-base',
+            'pat-registry'
+        ], function($, Base, registry) {
+
+2. Patterns' selectors are now explicitly specified via the trigger attribute.
+   For example:
+
+       var Modal = Base.extend({
+         name: 'modal',
+         trigger: '.pat-modal',
+
+3. Because of change 2, patterns now fire events via the emit method, instead
+   of the trigger method.
diff --git a/mockup/LEARN.md b/mockup/LEARN.md
index 1e43654..1e33020 100644
--- a/mockup/LEARN.md
+++ b/mockup/LEARN.md
@@ -353,7 +353,7 @@ we create a file called *tests/pattern-helloworld-test.js* and put the following
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-helloworld'
 ], function (expect, $, registry, HelloWorld) {
   "use strict";
@@ -392,7 +392,7 @@ Let's first explain some of the dependencies:
 * **[expect](https://github.com/LearnBoost/expect.js)** -
   A minimalistic BDD assertion toolkit based on the should.js test framework.
    <code>expect(result).to.be.above(0).and.not.equal(7)</code>.
-* **mockup-registry** -
+* **pat-registry** -
   the *registry* is a collection of tools used for managing the patterns.
   It also keeps track of which patterns have been registered, hence its name.  
   In our example we use its **scan()** method,
@@ -584,7 +584,7 @@ We need to include require.js and our js/config.js and then we need to scan the
     &lt;script src="node_modules/requirejs/require.js"&gt;&lt;/script&gt;
     &lt;script src="js/config.js"&gt;&lt;/script&gt;
     &lt;script&gt;
-       require(['jquery', 'mockup-registry','mockup-patterns-helloworld'],
+       require(['jquery', 'pat-registry','mockup-patterns-helloworld'],
          function($, registry) {
            $(document).ready(function (){
              registry.scan($('body'));
@@ -663,7 +663,7 @@ Note, we need to map the jquery.foggy Pattern name to the path and we also need
     &lt;script src="node_modules/requirejs/require.js"&gt;&lt;/script&gt;
     &lt;script src="js/config.js"&gt;&lt;/script&gt;
     &lt;script&gt;
-       require(['jquery', 'mockup-registry','mockup-patterns-foggy'],
+       require(['jquery', 'pat-registry','mockup-patterns-foggy'],
          function($, registry) {
            $(document).ready(function (){
              registry.scan($('body'));
diff --git a/mockup/Makefile b/mockup/Makefile
index a27bbdb..cfd344a 100644
--- a/mockup/Makefile
+++ b/mockup/Makefile
@@ -21,7 +21,15 @@ endif
 
 all: test-once bundles docs
 
-bundles: bundle-widgets bundle-structure bundle-plone
+stamp-npm: package.json
+	npm install
+	touch stamp-npm
+
+stamp-bower: stamp-npm bower.json
+	$(BOWER) install
+	touch stamp-bower
+
+bundles: stamp-bower bundle-widgets bundle-structure bundle-plone
 	# ----------------------------------------------------------------------- #
 	# cp build/widgets* path/to/plone.app.widgets/plone/app/widgets/static
 	# cp build/structure* path/to/wildcard.foldercontents/wildcard/foldercontents/static
@@ -81,12 +89,15 @@ watch:
 test:
 	NODE_PATH=$(NODE_PATH) $(GRUNT) test $(DEBUG) $(VERBOSE) --pattern=$(pattern)
 
-test-once:
+test-once: stamp-bower
 	NODE_PATH=$(NODE_PATH) $(GRUNT) test_once $(DEBUG) $(VERBOSE) --pattern=$(pattern)
 
 test-dev:
 	NODE_PATH=$(NODE_PATH) $(GRUNT) test_dev $(DEBUG) $(VERBOSE) --pattern=$(pattern)
 
+test-serve:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) test_serve $(DEBUG) $(VERBOSE) --pattern=$(pattern)
+
 test-ci:
 	NODE_PATH=$(NODE_PATH) $(GRUNT) test_ci $(DEBUG) $(VERBOSE)
 
@@ -95,6 +106,8 @@ clean:
 	rm -rf build
 	rm -rf node_modules
 	rm -rf bower_components
+	rm -f stamp-npm stamp-bower
+	rm -rf node_modules src/bower_components
 
 clean-deep: clean
 	if test -f $(BOWER); then $(BOWER) cache clean; fi
diff --git a/mockup/bower.json b/mockup/bower.json
index da5915a..0c5b700 100644
--- a/mockup/bower.json
+++ b/mockup/bower.json
@@ -14,15 +14,22 @@
     "jquery-form": "3.46.0",
     "jquery.cookie": "1.4.1",
     "lodash": "2.4.1",
-    "mockup-core": "1.2.15",
+    "logging": "",
+    "mockup-core": "2.0.0",
     "moment": "2.8.3",
     "pickadate": "3.4.0",
     "requirejs-text": "2.0.12",
     "select2": "3.5.1",
-    "tinymce-builded": "4.1.6"
+    "tinymce-builded": "4.1.6",
+    "patternslib": "2.0.8"
   },
   "devDependencies": {
     "expect": "0.3.1",
     "sinonjs": "1.10.2"
+  },
+  "resolutions": {
+    "jquery": "1.11.1",
+    "select2": "3.5.1",
+    "patternslib": "2.0.8"
   }
 }
diff --git a/mockup/js/bundles/filemanager.js b/mockup/js/bundles/filemanager.js
index b8d1391..4a224f2 100644
--- a/mockup/js/bundles/filemanager.js
+++ b/mockup/js/bundles/filemanager.js
@@ -1,6 +1,6 @@
 define([
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-base',
   'mockup-patterns-filemanager'
 ], function($, Registry, Base) {
diff --git a/mockup/js/bundles/plone.js b/mockup/js/bundles/plone.js
index 8ce75ef..9b83092 100644
--- a/mockup/js/bundles/plone.js
+++ b/mockup/js/bundles/plone.js
@@ -1,6 +1,6 @@
 define([
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-base',
 
   'mockup-patterns-select2',
diff --git a/mockup/js/bundles/resourceregistry.js b/mockup/js/bundles/resourceregistry.js
index 72edaad..59fe3c9 100644
--- a/mockup/js/bundles/resourceregistry.js
+++ b/mockup/js/bundles/resourceregistry.js
@@ -1,6 +1,6 @@
 define([
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-resourceregistry',
 ], function($, Registry) {
   'use strict';
diff --git a/mockup/js/bundles/structure.js b/mockup/js/bundles/structure.js
index 173793d..a88b815 100644
--- a/mockup/js/bundles/structure.js
+++ b/mockup/js/bundles/structure.js
@@ -7,7 +7,7 @@ if (window.jQuery) {
 
 define([
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-base',
   'mockup-patterns-modal',
   'mockup-patterns-structure'
diff --git a/mockup/js/bundles/widgets.js b/mockup/js/bundles/widgets.js
index ce555f9..0b14984 100644
--- a/mockup/js/bundles/widgets.js
+++ b/mockup/js/bundles/widgets.js
@@ -1,6 +1,6 @@
 define([
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-base',
   'mockup-patterns-select2',
   'mockup-patterns-passwordstrength',
diff --git a/mockup/js/config.js b/mockup/js/config.js
index f4224c2..5375d9b 100644
--- a/mockup/js/config.js
+++ b/mockup/js/config.js
@@ -60,6 +60,7 @@
       'mockup-docs-view': 'bower_components/mockup-core/js/docs/view',
       'mockup-fakeserver': 'tests/fakeserver',
       'mockup-i18n': 'js/i18n',
+      'mockup-parser': 'bower_components/mockup-core/js/parser',
       'mockup-patterns-accessibility': 'patterns/accessibility/pattern',
       'mockup-patterns-autotoc': 'patterns/autotoc/pattern',
       'mockup-patterns-backdrop': 'patterns/backdrop/pattern',
@@ -112,7 +113,16 @@
       'text': 'bower_components/requirejs-text/text',
       'tinymce': 'bower_components/tinymce-builded/js/tinymce/tinymce',
       'tinymce-modern-theme': 'bower_components/tinymce-builded/js/tinymce/themes/modern/theme',
-      'underscore': 'bower_components/lodash/dist/lodash.underscore'
+      'underscore': 'bower_components/lodash/dist/lodash.underscore',
+
+      // Patternslib
+      "pat-compat": "bower_components/patternslib/src/core/compat",
+      "pat-jquery-ext": "bower_components/patternslib/src/core/jquery-ext",
+      "pat-logger": "bower_components/patternslib/src/core/logger",
+      "pat-parser": "bower_components/patternslib/src/core/parser",
+      "pat-registry": "bower_components/patternslib/src/core/registry",
+      "pat-utils": "bower_components/patternslib/src/core/utils",
+      "logging": "bower_components/logging/src/logging"
     },
     shim: {
       'JSXTransformer': { exports: 'window.JSXTransformer' },
@@ -131,7 +141,13 @@
       'picker.date': { deps: [ 'picker' ] },
       'picker.time': { deps: [ 'picker' ] },
       'sinon': {exports: 'window.sinon'},
-      'tinymce': { exports: 'window.tinyMCE', init: function () { this.tinyMCE.DOM.events.domLoaded = true; return this.tinyMCE; }},
+      'tinymce': {
+        exports: 'window.tinyMCE',
+        init: function () {
+          this.tinyMCE.DOM.events.domLoaded = true;
+          return this.tinyMCE;
+        }
+      },
       'tinymce-modern-theme': { deps: ['tinymce'] },
       'underscore': { exports: 'window._' }
     },
diff --git a/mockup/js/i18n-wrapper.js b/mockup/js/i18n-wrapper.js
index 72c174b..f9cb00b 100644
--- a/mockup/js/i18n-wrapper.js
+++ b/mockup/js/i18n-wrapper.js
@@ -2,9 +2,9 @@
  *
  * This is a singleton.
  * Configuration is done on the body tag data-i18ncatalogurl attribute
- *     <body data-i18ncatalogurl="/jsi18n">
+ *     <body data-i18ncatalogurl="/plonejsi18n">
  *
- *  Or, it'll default to "/jsi18n"
+ *  Or, it'll default to "/plonejsi18n"
  */
 
 define([
diff --git a/mockup/js/i18n.js b/mockup/js/i18n.js
index 6161195..cd9cc36 100644
--- a/mockup/js/i18n.js
+++ b/mockup/js/i18n.js
@@ -2,9 +2,9 @@
  *
  * This is a singleton.
  * Configuration is done on the body tag data-i18ncatalogurl attribute
- *     <body data-i18ncatalogurl="/jsi18n">
+ *     <body data-i18ncatalogurl="/plonejsi18n">
  *
- *  Or, it'll default to "/jsi18n"
+ *  Or, it'll default to "/plonejsi18n"
  */
 
 /* global portal_url:true */
@@ -20,7 +20,7 @@ define([
 
     self.baseUrl = $('body').attr('data-i18ncatalogurl');
     if (!self.baseUrl) {
-      self.baseUrl = '/jsi18n';
+      self.baseUrl = '/plonejsi18n';
     }
     self.currentLanguage = $('html').attr('lang') || 'en';
     self.storage = null;
diff --git a/mockup/package.json b/mockup/package.json
index c36cee5..7c2c5f7 100644
--- a/mockup/package.json
+++ b/mockup/package.json
@@ -1,10 +1,11 @@
 {
   "name": "mockup",
-  "version": "1.8.2",
+  "version": "2.0.0",
   "description": "A collection of client side patterns for faster and easier web development",
   "homepage": "http://plone.github.io/mockup",
   "devDependencies": {
     "bower": "~1.3.2",
+    "chai": "^1.10.0",
     "coveralls": "~2.10.0",
     "extend": "~1.2.1",
     "grunt": "~0.4.4",
@@ -18,17 +19,21 @@
     "grunt-karma": "~0.8.2",
     "grunt-sed": "~0.1.1",
     "karma": "~0.12.9",
+    "karma-chai": "^0.1.0",
     "karma-chrome-launcher": "~0.1.3",
     "karma-coverage": "~0.2.1",
+    "karma-firefox-launcher": "~0.1.4",
     "karma-junit-reporter": "~0.2.2",
     "karma-mocha": "~0.1.3",
     "karma-phantomjs-launcher": "~0.1.4",
     "karma-requirejs": "~0.2.1",
     "karma-sauce-launcher": "~0.2.10",
     "karma-script-launcher": "~0.1.0",
+    "karma-spec-reporter": "0.0.16",
     "lcov-result-merger": "~0.0.2",
     "less": "~1.7.0",
     "mocha": "~1.18.2",
+    "phantomjs": "^1.9.13",
     "requirejs": "~2.1.11"
   },
   "maintainers": [
diff --git a/mockup/patterns/accessibility/pattern.js b/mockup/patterns/accessibility/pattern.js
index aaafebd..5891e85 100644
--- a/mockup/patterns/accessibility/pattern.js
+++ b/mockup/patterns/accessibility/pattern.js
@@ -48,6 +48,7 @@ define([
 
   var Accessibility = Base.extend({
     name: 'accessibility',
+    trigger: '.pat-accessibility',
     defaults: {
       'smallbtn': null,
       'normalbtn': null,
diff --git a/mockup/patterns/autotoc/pattern.js b/mockup/patterns/autotoc/pattern.js
index caada30..501fdd1 100644
--- a/mockup/patterns/autotoc/pattern.js
+++ b/mockup/patterns/autotoc/pattern.js
@@ -77,6 +77,7 @@ define([
 
   var AutoTOC = Base.extend({
     name: 'autotoc',
+    trigger: '.pat-autotoc',
     defaults: {
       section: 'section',
       levels: 'h1,h2,h3',
diff --git a/mockup/patterns/backdrop/pattern.js b/mockup/patterns/backdrop/pattern.js
index ce2baf8..ede1246 100644
--- a/mockup/patterns/backdrop/pattern.js
+++ b/mockup/patterns/backdrop/pattern.js
@@ -24,6 +24,7 @@ define([
 
   var Backdrop = Base.extend({
     name: 'backdrop',
+    trigger: '.pat-backdrop',
     defaults: {
       zIndex: null,
       opacity: 0.8,
@@ -64,20 +65,20 @@ define([
     show: function() {
       var self = this;
       if (!self.$el.hasClass(self.options.classActiveName)) {
-        self.trigger('show');
+        self.emit('show');
         self.$backdrop.css('opacity', '0').show();
         self.$el.addClass(self.options.classActiveName);
         self.$backdrop.animate({ opacity: self.options.opacity }, 500);
-        self.trigger('shown');
+        self.emit('shown');
       }
     },
     hide: function() {
       var self = this;
       if (self.$el.hasClass(self.options.classActiveName)) {
-        self.trigger('hide');
+        self.emit('hide');
         self.$backdrop.animate({ opacity: '0' }, 500).hide();
         self.$el.removeClass(self.options.classActiveName);
-        self.trigger('hidden');
+        self.emit('hidden');
       }
     }
   });
diff --git a/mockup/patterns/cookietrigger/pattern.js b/mockup/patterns/cookietrigger/pattern.js
index f13b7c8..20669f8 100644
--- a/mockup/patterns/cookietrigger/pattern.js
+++ b/mockup/patterns/cookietrigger/pattern.js
@@ -20,6 +20,7 @@ define([
 
   var CookieTrigger = Base.extend({
     name: 'cookietrigger',
+    trigger: '.pat-cookietrigger',
 
     isCookiesEnabled: function() {
       /* Test whether cookies are enabled by attempting to set a cookie
diff --git a/mockup/patterns/eventedit/pattern.js b/mockup/patterns/eventedit/pattern.js
index d60b8a7..01dedef 100644
--- a/mockup/patterns/eventedit/pattern.js
+++ b/mockup/patterns/eventedit/pattern.js
@@ -78,35 +78,29 @@ define([
 
   var EventEdit = Base.extend({
     name: 'eventedit',
+    trigger: '.pat-eventedit',
     defaults: {
       errorClass: 'error'
     },
     init: function () {
       var self = this, $el = self.$el, jq_open_end, jq_end, jq_start;
+      var jq_whole_day, jq_time;
+      jq_whole_day = self.aOrB(
+        $('#formfield-form-widgets-IEventBasic-whole_day input', $el),
+        $('#archetypes-fieldname-wholeDay input#wholeDay', $el)
+      );
 
-      $(document).on('scan-completed.registry.mockup-core', function(event) {
-        // Wait for the registry scan to be finished, because we depend on DOM
-        // structures from pickadate, which are not ready yet.
-        var jq_whole_day, jq_time;
-
-        jq_whole_day = self.aOrB(
-          $('#formfield-form-widgets-IEventBasic-whole_day input', $el),
-          $('#archetypes-fieldname-wholeDay input#wholeDay', $el)
-        );
-
-        jq_time = self.aOrB(
-          $('#formfield-form-widgets-IEventBasic-start .pattern-pickadate-time-wrapper, #formfield-form-widgets-IEventBasic-end .pattern-pickadate-time-wrapper', $el),
-          $('#archetypes-fieldname-startDate .pattern-pickadate-time-wrapper, #archetypes-fieldname-endDate .pattern-pickadate-time-wrapper', $el)
-        );
-
-        if (jq_whole_day.length > 0 && jq_time.length > 0) {
-          jq_whole_day.bind('change', function (e) {
-            self.showHideWidget(jq_time, e.target.checked, true);
-          });
-          self.showHideWidget(jq_time, jq_whole_day.get(0).checked, false);
-        }
+      jq_time = self.aOrB(
+        $('#formfield-form-widgets-IEventBasic-start .pattern-pickadate-time-wrapper, #formfield-form-widgets-IEventBasic-end .pattern-pickadate-time-wrapper', $el),
+        $('#archetypes-fieldname-startDate .pattern-pickadate-time-wrapper, #archetypes-fieldname-endDate .pattern-pickadate-time-wrapper', $el)
+      );
 
-      });
+      if (jq_whole_day.length > 0 && jq_time.length > 0) {
+        jq_whole_day.bind('change', function (e) {
+          self.showHideWidget(jq_time, e.target.checked, true);
+        });
+        self.showHideWidget(jq_time, jq_whole_day.get(0).checked, false);
+      }
 
       // OPEN END INIT
       jq_open_end = self.aOrB(
@@ -130,15 +124,13 @@ define([
         $('#archetypes-fieldname-startDate', $el)
       );
       jq_start.each(function () {
-        $(this).on('focus', '.picker__input', function () { self.initDelta(); });
         $(this).on('change', '.picker__input', function () { self.updateEndDate(); });
       });
       jq_end.each(function () {
-        $(this).on('focus', '.picker__input', function () { self.initDelta(); });
         $(this).on('change', '.picker__input', function () { self.validateEndDate(); });
       });
-
     },
+
     aOrB: function (a, b) {
       /* Return element a or element b, depending on which is available.
        * Parameter a and b: CSS selectors.
@@ -152,6 +144,7 @@ define([
       }
       return $(ret);
     },
+
     getDateTime: function (datetimewidget) {
       var date, time, datetime;
       date = $('.pattern-pickadate-date-wrapper input[name="_submit"]', datetimewidget).prop('value');
@@ -172,7 +165,9 @@ define([
       );
       return datetime;
     },
-    initDelta: function () {
+
+    getTimeDelta: function () {
+        // Return time delta between the start and end dates in days
         var self = this, $el = self.$el, start_datetime, end_datetime;
         start_datetime = self.getDateTime(
           self.aOrB(
@@ -186,9 +181,9 @@ define([
             $('#archetypes-fieldname-endDate', $el)
           )
         );
-        // delta in days
-        self.startEndDelta = (end_datetime - start_datetime) / 1000 / 60;
+        return (end_datetime - start_datetime) / 1000 / 60;
     },
+
     updateEndDate: function () {
         var self = this, $el = self.$el, jq_start, jq_end, start_date, new_end_date;
         jq_start = self.aOrB(
@@ -201,14 +196,15 @@ define([
         );
 
         start_date = self.getDateTime(jq_start);
-        new_end_date = new Date(start_date);
-        new_end_date.setMinutes(start_date.getMinutes() + self.startEndDelta);
+        new_end_date = new Date(start_date.getTime());
+        new_end_date.setMinutes(start_date.getMinutes() + self.getTimeDelta());
 
-        if (new_end_date) {
+        if (new_end_date && !isNaN(new_end_date.getTime())) {
           $('.pattern-pickadate-date', jq_end).pickadate('picker').set('select', new_end_date);
           $('.pattern-pickadate-time', jq_end).pickatime('picker').set('select', new_end_date);
         }
     },
+
     validateEndDate: function () {
         var self = this, $el = self.$el, jq_start, jq_end, start_datetime, end_datetime;
         jq_start = self.aOrB(
@@ -219,16 +215,15 @@ define([
           $('#formfield-form-widgets-IEventBasic-end', $el),
           $('#archetypes-fieldname-endDate', $el)
         );
-
         start_datetime = self.getDateTime(jq_start);
         end_datetime = self.getDateTime(jq_end);
-
         if (end_datetime < start_datetime) {
             jq_end.addClass(self.options.errorClass);
         } else {
             jq_end.removeClass(self.options.errorClass);
         }
     },
+
     showHideWidget: function (widget, hide, fade) {
         var $widget = $(widget);
         if (hide === true) {
@@ -239,8 +234,6 @@ define([
             else { $widget.show(); }
         }
     }
-
   });
-
   return EventEdit;
 });
diff --git a/mockup/patterns/filemanager/pattern.js b/mockup/patterns/filemanager/pattern.js
index 4d19d96..978d92e 100644
--- a/mockup/patterns/filemanager/pattern.js
+++ b/mockup/patterns/filemanager/pattern.js
@@ -59,6 +59,7 @@ define([
 
   var FileManager = Base.extend({
     name: 'filemanager',
+    trigger: '.pat-filemanager',
     template: _.template(AppTemplate),
     tabItemTemplate: _.template(
       '<li class="active" data-path="<%= path %>">' +
diff --git a/mockup/patterns/formautofocus/pattern.js b/mockup/patterns/formautofocus/pattern.js
index 43b62f4..310a238 100644
--- a/mockup/patterns/formautofocus/pattern.js
+++ b/mockup/patterns/formautofocus/pattern.js
@@ -21,6 +21,7 @@ define([
 
   var FormAutoFocus = Base.extend({
     name: 'formautofocus',
+    trigger: '.pat-formautofocus',
     defaults: {
       condition: 'div.error',
       target: 'div.error :input:not(.formTabs):visible:first',
@@ -29,9 +30,9 @@ define([
     init: function() {
       var self = this;
       if ($(self.options.condition, self.$el).size() !== 0) {
-        $(self.options.target, self.$el).focus();
+        $(self.options.target, self.$el).focusin();
       } else {
-        $(self.options.always, self.$el).focus();
+        $(self.options.always, self.$el).focusin();
       }
 
     }
diff --git a/mockup/patterns/formunloadalert/pattern.js b/mockup/patterns/formunloadalert/pattern.js
index 12c66ba..11e7427 100644
--- a/mockup/patterns/formunloadalert/pattern.js
+++ b/mockup/patterns/formunloadalert/pattern.js
@@ -36,6 +36,7 @@ define([
 
   var FormUnloadAlert = Base.extend({
     name: 'formunloadalert',
+    trigger: '.pat-formunloadalert',
     _changed : false,       // Stores a listing of raised changes by their key
     _suppressed : false,     // whether or not warning should be suppressed
     defaults: {
diff --git a/mockup/patterns/inlinevalidation/pattern.js b/mockup/patterns/inlinevalidation/pattern.js
index 52ccbc8..182ba32 100644
--- a/mockup/patterns/inlinevalidation/pattern.js
+++ b/mockup/patterns/inlinevalidation/pattern.js
@@ -26,6 +26,7 @@ define([
 
   var InlineValidation = Base.extend({
     name: 'inlinevalidation',
+    trigger: '.pat-inlinevalidation',
 
     render_error: function ($field, errmsg) {
        var $errbox = $('div.fieldErrorBox', $field);
diff --git a/mockup/patterns/markspeciallinks/pattern.js b/mockup/patterns/markspeciallinks/pattern.js
index 73f8eff..25475e4 100644
--- a/mockup/patterns/markspeciallinks/pattern.js
+++ b/mockup/patterns/markspeciallinks/pattern.js
@@ -86,6 +86,7 @@ define([
 
   var MarkSpecialLinks = Base.extend({
     name: 'markspeciallinks',
+    trigger: '.pat-markspeciallinks',
     defaults: {
       external_links_open_new_window: false,
       mark_special_links: true
@@ -140,12 +141,11 @@ define([
                 res = protocols.exec(this.href);
                 if (res) {
                     var iconclass = 'glyphicon link-' + res[0];
-                    jQuery(this).before('<i class="' + iconclass + '"></i>');
+                    $(this).before('<i class="' + iconclass + '"></i>');
                 }
             }
         );
       }
-
     }
   });
   return MarkSpecialLinks;
diff --git a/mockup/patterns/modal/pattern.js b/mockup/patterns/modal/pattern.js
index 5f1c3e1..d8cfce9 100644
--- a/mockup/patterns/modal/pattern.js
+++ b/mockup/patterns/modal/pattern.js
@@ -74,7 +74,7 @@ define([
   'underscore',
   'mockup-patterns-base',
   'mockup-patterns-backdrop',
-  'mockup-registry',
+  'pat-registry',
   'mockup-router',
   'mockup-utils',
   'jquery.form'
@@ -83,6 +83,7 @@ define([
 
   var Modal = Base.extend({
     name: 'modal',
+    trigger: '.pat-modal',
     createModal: null,
     $model: null,
     defaults: {
@@ -264,7 +265,7 @@ define([
             } else {
               console.log('error happened do something');
             }
-            self.trigger('formActionError', [xhr, textStatus, errorStatus]);
+            self.emit('formActionError', [xhr, textStatus, errorStatus]);
           },
           success: function(response, state, xhr, form) {
             self.loading.hide();
@@ -302,7 +303,7 @@ define([
                 self.reloadWindow();
               }
             }
-            self.trigger('formActionSuccess', [response, state, xhr, form]);
+            self.emit('formActionSuccess', [response, state, xhr, form]);
           }
         });
       },
@@ -341,7 +342,7 @@ define([
               console.log('error happened do something');
             }
             self.loading.hide();
-            self.trigger('linkActionError', [xhr, textStatus, errorStatus]);
+            self.emit('linkActionError', [xhr, textStatus, errorStatus]);
           },
           success: function(response, state, xhr) {
             self.redraw(response, patternOptions);
@@ -349,14 +350,14 @@ define([
               options.onSuccess(self, response, state, xhr);
             }
             self.loading.hide();
-            self.trigger('linkActionSuccess', [response, state, xhr]);
+            self.emit('linkActionSuccess', [response, state, xhr]);
           }
         });
       },
       render: function(options) {
         var self = this;
 
-        self.trigger('before-render');
+        self.emit('before-render');
 
         if (!self.$raw) {
           return;
@@ -436,7 +437,7 @@ define([
           $button.hide();
         });
 
-        self.trigger('before-events-setup');
+        self.emit('before-events-setup');
 
         // Wire up events
         $('.plone-modal-header > a.plone-modal-close, .plone-modal-footer > a.plone-modal-close', self.$modal)
@@ -479,7 +480,7 @@ define([
           .appendTo(self.$wrapperInner);
         self.$modal.data('pattern-' + self.name, self);
 
-        self.trigger('after-render');
+        self.emit('after-render');
       }
     },
     reloadWindow: function() {
@@ -602,12 +603,12 @@ define([
           self.show();
         });
       }
-
       self.initModal();
     },
+
     createAjaxModal: function() {
       var self = this;
-      self.trigger('before-ajax');
+      self.emit('before-ajax');
       self.loading.show();
       self.ajaxXHR = $.ajax({
         url: self.options.ajaxUrl,
@@ -616,26 +617,30 @@ define([
         self.ajaxXHR = undefined;
         self.loading.hide();
         self.$raw = $('<div />').append($(utils.parseBodyTag(response)));
-        self.trigger('after-ajax', self, textStatus, xhr);
+        self.emit('after-ajax', self, textStatus, xhr);
         self._show();
       });
     },
+
     createTargetModal: function() {
       var self = this;
       self.$raw = $(self.options.target).clone();
       self._show();
     },
+
     createBasicModal: function() {
       var self = this;
       self.$raw = $('<div/>').html(self.$el.clone());
       self._show();
     },
+
     createHtmlModal: function() {
       var self = this;
       var $el = $(self.options.html);
       self.$raw = $el;
       self._show();
     },
+
     initModal: function() {
       var self = this;
       if (self.options.ajaxUrl) {
@@ -780,9 +785,9 @@ define([
     },
     render: function(options) {
       var self = this;
-      self.trigger('render');
+      self.emit('render');
       self.options.render.apply(self, [options]);
-      self.trigger('rendered');
+      self.emit('rendered');
     },
     show: function() {
       var self = this;
@@ -791,7 +796,7 @@ define([
     _show: function() {
       var self = this;
       self.render.apply(self, [ self.options ]);
-      self.trigger('show');
+      self.emit('show');
       self.backdrop.show();
       self.$wrapper.show();
       self.loading.hide();
@@ -806,7 +811,7 @@ define([
       $(window.parent).on('resize.modal.patterns', function() {
         self.positionModal();
       });
-      self.trigger('shown');
+      self.emit('shown');
       $('body').addClass('plone-modal-open');
     },
     hide: function() {
@@ -814,7 +819,7 @@ define([
       if (self.ajaxXHR) {
         self.ajaxXHR.abort();
       }
-      self.trigger('hide');
+      self.emit('hide');
       if (self._suppressHide) {
         if (!confirm(self._suppressHide)) {
           return;
@@ -832,19 +837,19 @@ define([
         self.initModal();
       }
       $(window.parent).off('resize.modal.patterns');
-      self.trigger('hidden');
+      self.emit('hidden');
       $('body').removeClass('plone-modal-open');
     },
     redraw: function(response, options) {
       var self = this;
-      self.trigger('beforeDraw');
+      self.emit('beforeDraw');
       self.$modal.remove();
       self.$raw = $('<div />').append($(utils.parseBodyTag(response)));
       self.render.apply(self, [options || self.options]);
       self.$modal.addClass(self.options.templateOptions.classActiveName);
       self.positionModal();
       registry.scan(self.$modal);
-      self.trigger('afterDraw');
+      self.emit('afterDraw');
     }
   });
 
diff --git a/mockup/patterns/moment/pattern.js b/mockup/patterns/moment/pattern.js
index 25283ff..17c1867 100644
--- a/mockup/patterns/moment/pattern.js
+++ b/mockup/patterns/moment/pattern.js
@@ -89,6 +89,7 @@ define([
 
   var Moment = Base.extend({
     name: 'moment',
+    trigger: '.pat-moment',
     defaults: {
       // selector of elements to format dates for
       selector: null,
diff --git a/mockup/patterns/passwordstrength/pattern.js b/mockup/patterns/passwordstrength/pattern.js
index 25b93d7..cad33b4 100644
--- a/mockup/patterns/passwordstrength/pattern.js
+++ b/mockup/patterns/passwordstrength/pattern.js
@@ -56,6 +56,7 @@ define([
 
   var PasswordStrength = Base.extend({
     name: 'passwordstrength',
+    trigger: '.pat-passwordstrength',
     defaults: {
         zxcvbn: '//cdnjs.cloudflare.com/ajax/libs/zxcvbn/1.0/zxcvbn.js'
     },
diff --git a/mockup/patterns/pickadate/pattern.js b/mockup/patterns/pickadate/pattern.js
index c756e88..2324b9e 100644
--- a/mockup/patterns/pickadate/pattern.js
+++ b/mockup/patterns/pickadate/pattern.js
@@ -95,6 +95,7 @@ define([
 
   var PickADate = Base.extend({
     name: 'pickadate',
+    trigger: '.pat-pickadate',
     defaults: {
       separator: ' ',
       date: {
@@ -301,7 +302,7 @@ define([
 
       self.$el.attr('value', value);
 
-      self.trigger('updated');
+      self.emit('updated');
     }
   });
 
diff --git a/mockup/patterns/preventdoublesubmit/pattern.js b/mockup/patterns/preventdoublesubmit/pattern.js
index fb80ef0..167ad7b 100644
--- a/mockup/patterns/preventdoublesubmit/pattern.js
+++ b/mockup/patterns/preventdoublesubmit/pattern.js
@@ -29,6 +29,7 @@ define([
 
   var PreventDoubleSubmit = Base.extend({
     name: 'preventdoublesubmit',
+    trigger: '.pat-preventdoublesubmit',
     defaults: {
       message : _t('You already clicked the submit button. ' +
                 'Do you really want to submit this form again?'),
diff --git a/mockup/patterns/querystring/pattern.js b/mockup/patterns/querystring/pattern.js
index 852f036..c06257a 100644
--- a/mockup/patterns/querystring/pattern.js
+++ b/mockup/patterns/querystring/pattern.js
@@ -417,6 +417,7 @@ define([
 
   var QueryString = Base.extend({
     name: 'querystring',
+    trigger: '.pat-querystring',
     defaults: {
       indexes: [],
       classWrapperName: 'querystring-wrapper',
diff --git a/mockup/patterns/relateditems/pattern.js b/mockup/patterns/relateditems/pattern.js
index fed64eb..2bb697f 100644
--- a/mockup/patterns/relateditems/pattern.js
+++ b/mockup/patterns/relateditems/pattern.js
@@ -28,7 +28,7 @@
  *    separator(string): Select2 option. String which separates multiple items. (',')
  *    tokenSeparators(array): Select2 option, refer to select2 documentation.
  *    ([",", " "])
- *    width(string): Specify a width for the widget. ('300px')
+ *    width(string): Specify a width for the widget. ('100%')
  *
  * Documentation:
  *    The Related Items pattern is based on Select2 so many of the same options will work here as well.
@@ -83,11 +83,12 @@ define([
 
   var RelatedItems = Base.extend({
     name: 'relateditems',
+    trigger: '.pat-relateditems',
     browsing: false,
     currentPath: null,
     defaults: {
       vocabularyUrl: null, // must be set to work
-      width: '300px',
+      width: '100%',
       multiple: true,
       tokenSeparators: [',', ' '],
       separator: ',',
@@ -181,7 +182,7 @@ define([
     },
     browseTo: function(path) {
       var self = this;
-      self.trigger('before-browse');
+      self.emit('before-browse');
       self.currentPath = path;
       if (path === '/' && self.options.mode === 'search') {
         self.deactivateBrowsing();
@@ -190,7 +191,7 @@ define([
       }
       self.$el.select2('close');
       self.$el.select2('open');
-      self.trigger('after-browse');
+      self.emit('after-browse');
     },
     setBreadCrumbs: function() {
       var self = this;
@@ -286,16 +287,16 @@ define([
     },
     selectItem: function(item) {
       var self = this;
-      self.trigger('selecting');
+      self.emit('selecting');
       var data = self.$el.select2('data');
       data.push(item);
       self.$el.select2('data', data);
       item.selected = true;
-      self.trigger('selected');
+      self.emit('selected');
     },
     deselectItem: function(item) {
       var self = this;
-      self.trigger('deselecting');
+      self.emit('deselecting');
       var data = self.$el.select2('data');
       _.each(data, function(obj, i) {
         if (obj.UID === item.UID) {
@@ -304,7 +305,7 @@ define([
       });
       self.$el.select2('data', data);
       item.selected = false;
-      self.trigger('deselected');
+      self.emit('deselected');
     },
     isSelectable: function(item) {
       var self = this;
diff --git a/mockup/patterns/resourceregistry/js/registry.js b/mockup/patterns/resourceregistry/js/registry.js
index fe6cbfc..b08483f 100644
--- a/mockup/patterns/resourceregistry/js/registry.js
+++ b/mockup/patterns/resourceregistry/js/registry.js
@@ -194,7 +194,7 @@ define([
           'we will try to keep you updated on the progress.</p><p> Press the "Build it" ' +
           'button to proceed.</p></div>' +
         '<ul class="list-group hidden"></ul>' +
-        '<button class="plone-btn plone-btn-default cancel hidden">Close</button>' +
+        '<button class="plone-btn plone-btn-default cancel hidden cancel-build">Close</button>' +
         '<button class="plone-btn plone-btn-primary build">Build it</button>' +
       '</div>', bundleListItem.options),
       content: null,
@@ -204,7 +204,7 @@ define([
     self.modal.on('shown', function() {
       var $el = self.modal.$modal;
       var $info = $el.find('.start-info');
-      self.$btnClose = $el.find('button.cancel');
+      self.$btnClose = $el.find('button.cancel-build');
       var $btn = $el.find('button.build');
       $btn.off('click').on('click', function(e){
         e.preventDefault();
@@ -264,13 +264,13 @@ define([
     };
 
     self._buildCSSBundle = function(config){
-      var $iframe = $('<iframe><html><head></head><body></body></html></iframe>').
+      var $iframe = $('<iframe style="display:none"><html><head></head><body></body></html></iframe>').
           appendTo('body').on('load', function(){
       });
       var iframe = $iframe[0];
       var win = iframe.contentWindow || iframe;
       win.lessErrorReporting = function(what, error, href){
-        if(what !== "remove"){
+        if(what !== 'remove'){
           self.addResult('less compilation error on file ' + href + ': ' + error);
         }
       };
@@ -312,6 +312,7 @@ define([
             var $el = $(this);
             data['data-' + $el.attr('id')] = $el.html();
           });
+          $iframe.remove();
           $.ajax({
             url: self.rview.options.data.manageUrl,
             type: 'POST',
@@ -387,7 +388,7 @@ define([
           }
         });
       };
-      var $iframe = $('<iframe><html><head></head><body></body></html></iframe').appendTo('body');
+      var $iframe = $('<iframe style="display:none"><html><head></head><body></body></html></iframe').appendTo('body');
       var iframe = $iframe[0];
       var win = iframe.contentWindow || iframe;
       var head = $iframe.contents().find('head')[0];
@@ -398,6 +399,7 @@ define([
         win.requirejs.optimize(config, function(combined_files){
           self.addResult('Saved javascript bundle, Build results: <pre>' + combined_files + '</pre>');
           self.buildCSSBundle();
+          $iframe.remove();
         });
       };
       head.appendChild(script);
@@ -515,7 +517,7 @@ define([
           '<label>' +
             '<input type="checkbox" ' +
               '<% if(data.development){ %> checked="checked" <% } %>' +
-              ' > Development Mode' +
+              ' > Development Mode(only logged in users)' +
           '</label>' +
         '</div>' +
       '</div>' +
diff --git a/mockup/patterns/resourceregistry/pattern.js b/mockup/patterns/resourceregistry/pattern.js
index 89bdc62..863a068 100644
--- a/mockup/patterns/resourceregistry/pattern.js
+++ b/mockup/patterns/resourceregistry/pattern.js
@@ -213,6 +213,7 @@ define([
 
   var ResourceRegistry = Base.extend({
     name: 'resourceregistry',
+    trigger: '.pat-resourceregistry',
     defaults: {
       bundles: {},
       resources: {},
diff --git a/mockup/patterns/select2/pattern.js b/mockup/patterns/select2/pattern.js
index 6b25e26..c012d66 100644
--- a/mockup/patterns/select2/pattern.js
+++ b/mockup/patterns/select2/pattern.js
@@ -71,6 +71,7 @@ define([
 
   var Select2 = Base.extend({
     name: 'select2',
+    trigger: '.pat-select2',
     defaults: {
       separator: ','
     },
diff --git a/mockup/patterns/sortable/pattern.js b/mockup/patterns/sortable/pattern.js
index e2a0a73..7c7487d 100644
--- a/mockup/patterns/sortable/pattern.js
+++ b/mockup/patterns/sortable/pattern.js
@@ -54,6 +54,7 @@ define([
 
   var SortablePattern = Base.extend({
     name: 'sortable',
+    trigger: '.pat-sortable',
     defaults: {
       selector: 'li',
       dragClass: 'item-dragging',
diff --git a/mockup/patterns/structure/js/views/app.js b/mockup/patterns/structure/js/views/app.js
index 7b80c37..e78c3c5 100644
--- a/mockup/patterns/structure/js/views/app.js
+++ b/mockup/patterns/structure/js/views/app.js
@@ -179,6 +179,7 @@ define([
 
       self.collection.on('pager', function() {
         self.loading.show();
+        window.location.hash = self.queryHelper.getCurrentPath();
       });
 
       /* detect key events */
diff --git a/mockup/patterns/structure/js/views/properties.js b/mockup/patterns/structure/js/views/properties.js
index 4090dd8..1ed4de9 100644
--- a/mockup/patterns/structure/js/views/properties.js
+++ b/mockup/patterns/structure/js/views/properties.js
@@ -77,10 +77,10 @@ define([
     },
     applyButtonClicked: function(e) {
       var data = {
-        effectiveDate: this.effectivePickADate.$date.attr('value'),
-        effectiveTime: this.effectivePickADate.$time.attr('value'),
-        expirationDate: this.expirationPickADate.$date.attr('value'),
-        expirationTime: this.expirationPickADate.$time.attr('value'),
+        effectiveDate: this.effectivePickADate.$date.val(),
+        effectiveTime: this.effectivePickADate.$time.val(),
+        expirationDate: this.expirationPickADate.$date.val(),
+        expirationTime: this.expirationPickADate.$time.val(),
         copyright: this.$copyright.val(),
         contributors: JSON.stringify(this.$contributors.select2('data')),
         creators: JSON.stringify(this.$creators.select2('data'))
diff --git a/mockup/patterns/structure/js/views/table.js b/mockup/patterns/structure/js/views/table.js
index e598087..7d4f476 100644
--- a/mockup/patterns/structure/js/views/table.js
+++ b/mockup/patterns/structure/js/views/table.js
@@ -101,7 +101,7 @@ define([
       }
 
       self.moment = new Moment(self.$el, {
-        selector: '.ModificationDate,.EffectiveDate,.CreationDate',
+        selector: '.ModificationDate,.EffectiveDate,.CreationDate,.ExpirationDate',
         format: 'relative'
       });
       self.addReordering();
diff --git a/mockup/patterns/structure/js/views/upload.js b/mockup/patterns/structure/js/views/upload.js
index 68cb636..5f03a70 100644
--- a/mockup/patterns/structure/js/views/upload.js
+++ b/mockup/patterns/structure/js/views/upload.js
@@ -54,7 +54,7 @@ define([
         } else {
           relatedItems.$el.select2('data', [self.currentPathData.object]);
         }
-        self.upload.currentPath = currentPath;
+        self.upload.setPath(currentPath);
       }
     }
 
diff --git a/mockup/patterns/structure/pattern.js b/mockup/patterns/structure/pattern.js
index ea9fe66..ddb4b83 100644
--- a/mockup/patterns/structure/pattern.js
+++ b/mockup/patterns/structure/pattern.js
@@ -43,6 +43,7 @@ define([
 
   var Structure = Base.extend({
     name: 'structure',
+    trigger: '.pat-structure',
     defaults: {
       vocabularyUrl: null,
       tagsVocabularyUrl: null,
@@ -65,6 +66,7 @@ define([
       availableColumns: {
         'ModificationDate': _t('Last modified'),
         'EffectiveDate': _t('Published'),
+        'ExpirationDate': _t('Expiration'),
         'CreationDate': _t('Created'),
         'review_state': _t('Review state'),
         'Subject': _t('Tags'),
@@ -133,6 +135,10 @@ define([
       self.options.queryHelper = new utils.QueryHelper(
         $.extend(true, {}, self.options, {pattern: self}));
 
+      // check and see if a hash is provided for initial path
+      if(window.location.hash.substring(0, 2) === '#/'){
+        self.options.queryHelper.currentPath = window.location.hash.substring(1);
+      }
       delete self.options.attributes; // not compatible with backbone
 
       self.view = new AppView(self.options);
diff --git a/mockup/patterns/structure/templates/tablerow.xml b/mockup/patterns/structure/templates/tablerow.xml
index 8583088..90eb345 100644
--- a/mockup/patterns/structure/templates/tablerow.xml
+++ b/mockup/patterns/structure/templates/tablerow.xml
@@ -1,14 +1,6 @@
 <td class="selection"><input type="checkbox" <% if(selected){ %> checked="checked" <% } %>/></td>
 <td class="title">
-  <a href="<%- getURL %>">
-    <% if(['File', 'Image'].indexOf(attributes.Type) !== -1){ %>
-      <span class="glyphicon glyphicon-file"></span>
-    <% } %>
-    <% if(attributes.is_folderish) { %>
-      <span class="glyphicon glyphicon-folder-open"></span>
-    <% } %>
-    <%- Title %>
-  </a>
+  <a href="<%- getURL %>" class="state-<%- review_state %> contenttype-<%- Type.toLowerCase() %>"><%- Title %></a>
 </td>
 <% _.each(activeColumns, function(column){ %>
   <% if(_.has(availableColumns, column)) { %>
diff --git a/mockup/patterns/tablesorter/pattern.js b/mockup/patterns/tablesorter/pattern.js
index 4e3df09..4176567 100644
--- a/mockup/patterns/tablesorter/pattern.js
+++ b/mockup/patterns/tablesorter/pattern.js
@@ -79,6 +79,7 @@ define([
 
   var TableSorter = Base.extend({
     name: 'tablesorter',
+    trigger: '.pat-tablesorter',
     defaults: {},
     sortabledataclass: function (cell) {
       var re, matches;
diff --git a/mockup/patterns/textareamimetypeselector/pattern.js b/mockup/patterns/textareamimetypeselector/pattern.js
index 5a0c84c..9be19b1 100644
--- a/mockup/patterns/textareamimetypeselector/pattern.js
+++ b/mockup/patterns/textareamimetypeselector/pattern.js
@@ -59,13 +59,14 @@
 define([
   'jquery',
   'mockup-patterns-base',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-tinymce'
 ], function ($, Base, registry, tinymce) {
   'use strict';
 
   var TextareaMimetypeSelector = Base.extend({
     name: 'textareamimetypeselector',
+    trigger: '.pat-textareamimetypeselector',
     textarea: undefined,
     currentWidget: undefined,
     defaults: {
diff --git a/mockup/patterns/texteditor/pattern.js b/mockup/patterns/texteditor/pattern.js
index 7f03733..6c173b9 100644
--- a/mockup/patterns/texteditor/pattern.js
+++ b/mockup/patterns/texteditor/pattern.js
@@ -68,6 +68,7 @@ define([
 
   var AcePattern = Base.extend({
     name: 'texteditor',
+    trigger: '.pat-texteditor',
     defaults: {
       theme: null,
       mode: 'text',
diff --git a/mockup/patterns/thememapper/pattern.js b/mockup/patterns/thememapper/pattern.js
index be9acee..6dfe6f0 100644
--- a/mockup/patterns/thememapper/pattern.js
+++ b/mockup/patterns/thememapper/pattern.js
@@ -420,6 +420,7 @@ define([
 
   var ThemeMapper = Base.extend({
     name: 'thememapper',
+    trigger: '.pat-thememapper',
     defaults: {
       filemanagerConfig: {},
       mockupUrl: null,
diff --git a/mockup/patterns/tinymce/js/links.js b/mockup/patterns/tinymce/js/links.js
index 1bf69dd..42af3cb 100644
--- a/mockup/patterns/tinymce/js/links.js
+++ b/mockup/patterns/tinymce/js/links.js
@@ -1,6 +1,7 @@
 define([
   'jquery',
   'underscore',
+  'pat-registry',
   'mockup-patterns-base',
   'mockup-patterns-relateditems',
   'mockup-patterns-modal',
@@ -8,15 +9,16 @@ define([
   'mockup-patterns-upload',
   'text!mockup-patterns-tinymce-url/templates/link.xml',
   'text!mockup-patterns-tinymce-url/templates/image.xml'
-], function($, _, Base, RelatedItems, Modal, tinymce, Upload,
-            LinkTemplate, ImageTemplate) {
+], function($, _, registry, Base, RelatedItems, Modal, tinymce, Upload, LinkTemplate, ImageTemplate) {
   'use strict';
 
   var LinkType = Base.extend({
     name: 'linktype',
+    trigger: '.pat-linktype',
     defaults: {
       linkModal: null // required
     },
+
     init: function() {
       this.linkModal = this.options.linkModal;
       this.tinypattern = this.options.tinypattern;
@@ -24,18 +26,23 @@ define([
       this.dom = this.tiny.dom;
       this.$input = this.$el.find('input');
     },
+
     value: function() {
       return this.$input.val();
     },
+
     toUrl: function() {
       return this.value();
     },
+
     load: function(element) {
       this.$input.attr('value', this.tiny.dom.getAttrib(element, 'data-val'));
     },
+
     set: function(val) {
       this.$input.attr('value', val);
     },
+
     attributes: function() {
       return {
         'data-val': this.value()
@@ -45,23 +52,24 @@ define([
 
   var InternalLink = LinkType.extend({
     init: function() {
-      var self = this;
-      LinkType.prototype.init.call(self);
-      self.$input.addClass('pat-relateditems');
-      self.createRelatedItems();
+      LinkType.prototype.init.call(this);
+      this.$input.addClass('pat-relateditems');
+      this.createRelatedItems();
     },
+
     createRelatedItems: function() {
       this.relatedItems = new RelatedItems(this.$input,
         this.linkModal.options.relatedItems);
     },
+
     value: function() {
-      var self = this;
-      var val = self.$input.select2('data');
+      var val = this.$input.select2('data');
       if (val && typeof(val) === 'object') {
         val = val[0];
       }
       return val;
     },
+
     toUrl: function() {
       var value = this.value();
       if (value) {
@@ -75,6 +83,7 @@ define([
         this.set(val);
       }
     },
+
     set: function(val) {
       // kill it and then reinitialize since select2 will load data then
       this.$input.select2('destroy');
@@ -83,6 +92,7 @@ define([
       this.$input.attr('value', val);
       this.createRelatedItems();
     },
+
     attributes: function() {
       var val = this.value();
       if (val) {
@@ -92,7 +102,6 @@ define([
       }
       return {};
     }
-
   });
 
   var UploadLink = InternalLink.extend({
@@ -105,7 +114,6 @@ define([
       }
       return paths.join('/');
     }
-
   });
 
   var ImageLink = InternalLink.extend({
@@ -129,13 +137,16 @@ define([
       }
       return null;
     },
+
     load: function(element) {
       LinkType.prototype.load.apply(this, [element]);
       this.linkModal.$subject.val(this.tiny.dom.getAttrib(element, 'data-subject'));
     },
+
     getSubject: function() {
       return this.linkModal.$subject.val();
     },
+
     attributes: function() {
       var attribs = LinkType.prototype.attributes.call(this);
       attribs['data-subject'] = this.getSubject();
@@ -145,21 +156,21 @@ define([
 
   var AnchorLink = LinkType.extend({
     init: function() {
-      var self = this;
-      LinkType.prototype.init.call(self);
-      self.$select = self.$el.find('select');
-      self.anchorNodes = [];
-      self.anchorData = [];
-      self.populate();
+      LinkType.prototype.init.call(this);
+      this.$select = this.$el.find('select');
+      this.anchorNodes = [];
+      this.anchorData = [];
+      this.populate();
     },
+
     value: function() {
-      var self = this;
-      var val = self.$select.select2('data');
+      var val = this.$select.select2('data');
       if (val && typeof(val) === 'object') {
-        val = val['id'];
+        val = val.id;
       }
       return val;
     },
+
     populate: function() {
       var self = this;
       self.$select.find('option').remove();
@@ -216,23 +227,23 @@ define([
         self.$select.append('<option>No anchors found..</option>');
       }
     },
+
     getIndex: function(name) {
-      var self = this;
-      for (var i = 0; i < self.anchorData.length; i = i + 1) {
-        var data = self.anchorData[i];
+      for (var i = 0; i < this.anchorData.length; i = i + 1) {
+        var data = this.anchorData[i];
         if (data.name === name) {
           return i;
         }
       }
       return 0;
     },
+
     toUrl: function() {
-      var self = this;
-      var val = self.value();
+      var val = this.value();
       if (val) {
         var index = parseInt(val, 10);
-        var node = self.anchorNodes[index];
-        var data = self.anchorData[index];
+        var node = this.anchorNodes[index];
+        var data = this.anchorData[index];
         if (data.newAnchor) {
           node.innerHTML = '<a name="' + data.name + '" class="mce-item-anchor"></a>' + node.innerHTML;
         }
@@ -240,6 +251,7 @@ define([
       }
       return null;
     },
+
     set: function(val) {
       var anchor = this.getIndex(val);
       this.$select.select2('data', '' + anchor);
@@ -296,6 +308,7 @@ define([
 
   var LinkModal = Base.extend({
     name: 'linkmodal',
+    trigger: '.pat-linkmodal',
     defaults: {
       anchorSelector: 'h1,h2,h3',
       linkTypes: [
@@ -351,7 +364,7 @@ define([
       self.dom = self.tiny.dom;
       self.linkType = self.options.initialLinkType;
       self.linkTypes = {};
-      self.modal = new Modal(self.$el, {
+      self.modal = registry.patterns.modal.init(self.$el, {
         html: self.generateModalHtml(),
         content: null,
         buttons: '.btn'
@@ -360,29 +373,31 @@ define([
         self.modalShown.apply(self, [e]);
       });
     },
+
     generateModalHtml: function() {
-      var self = this;
-      return self.template({
-        text: self.options.text,
-        insertHeading: self.options.text.insertHeading,
-        linkTypes: self.options.linkTypes,
-        externalText: self.options.text.external,
-        emailText: self.options.text.email,
-        subjectText: self.options.text.subject,
-        targetList: self.options.targetList,
-        titleText: self.options.text.title,
-        externalImageText: self.options.text.externalImage,
-        altText: self.options.text.alt,
-        imageAlignText: self.options.text.imageAlign,
-        scaleText: self.options.text.scale,
-        scales: self.options.scales,
-        cancelBtn: self.options.text.cancelBtn,
-        insertBtn: self.options.text.insertBtn
+      return this.template({
+        text: this.options.text,
+        insertHeading: this.options.text.insertHeading,
+        linkTypes: this.options.linkTypes,
+        externalText: this.options.text.external,
+        emailText: this.options.text.email,
+        subjectText: this.options.text.subject,
+        targetList: this.options.targetList,
+        titleText: this.options.text.title,
+        externalImageText: this.options.text.externalImage,
+        altText: this.options.text.alt,
+        imageAlignText: this.options.text.imageAlign,
+        scaleText: this.options.text.scale,
+        scales: this.options.scales,
+        cancelBtn: this.options.text.cancelBtn,
+        insertBtn: this.options.text.insertBtn
       });
     },
+
     isImageMode: function() {
       return ['image', 'uploadImage', 'externalImage'].indexOf(this.linkType) !== -1;
     },
+
     initElements: function() {
       var self = this;
       self.$target = $('select[name="target"]', self.modal.$modal);
@@ -413,14 +428,16 @@ define([
         });
       });
     },
+
     getLinkUrl: function() {
       // get the url, only get one uid
-      var self = this;
-      return self.linkTypes[self.linkType].toUrl();
+      return this.linkTypes[this.linkType].toUrl();
     },
+
     getValue: function() {
       return this.linkTypes[this.linkType].value();
     },
+
     updateAnchor: function(href) {
       var self = this;
       var target = self.$target.val();
@@ -433,12 +450,13 @@ define([
       }, self.linkTypes[self.linkType].attributes());
       self.tiny.execCommand('mceInsertLink', false, data);
     },
+
     focusElement: function(elm) {
-      var self = this;
-      self.tiny.focus();
-      self.tiny.selection.select(elm);
-      self.tiny.nodeChanged();
+      this.tiny.focus();
+      this.tiny.selection.select(elm);
+      this.tiny.nodeChanged();
     },
+
     updateImage: function(src) {
       var self = this;
       var data = $.extend(true, {}, {
@@ -476,12 +494,11 @@ define([
         self.focusElement(self.imgElm);
       }
     },
+
     modalShown: function(e) {
       var self = this;
-
       self.initElements();
       self.initData();
-
       // upload init
       self.$upload = $('.uploadify-me', self.modal.$modal);
       self.options.upload.relatedItems = self.options.relatedItems;
@@ -515,18 +532,19 @@ define([
         self.hide();
       });
     },
+
     show: function() {
       this.modal.show();
     },
+
     hide: function() {
       this.modal.hide();
     },
+
     initData: function() {
       var self = this;
-
       self.selection = self.tiny.selection;
       self.tiny.focus();
-
       var selectedElm = self.imgElm = self.selection.getNode();
       self.anchorElm = self.dom.getParent(selectedElm, 'a[href]');
 
@@ -582,41 +600,42 @@ define([
         }
       }
     },
+
     guessImageLink: function(src) {
-      var self = this;
-      if (src.indexOf(self.options.prependToScalePart) !== -1) {
-        self.linkType = 'image';
-        self.$scale.val(self.tinypattern.getScaleFromUrl(src));
-        self.linkTypes.image.set(self.tinypattern.stripGeneratedUrl(src));
+      if (src.indexOf(this.options.prependToScalePart) !== -1) {
+        this.linkType = 'image';
+        this.$scale.val(this.tinypattern.getScaleFromUrl(src));
+        this.linkTypes.image.set(this.tinypattern.stripGeneratedUrl(src));
       } else {
-        self.linkType = 'externalImage';
-        self.linkTypes.externalImage.set(src);
+        this.linkType = 'externalImage';
+        this.linkTypes.externalImage.set(src);
       }
     },
+
     guessAnchorLink: function(href) {
-      var self = this;
-      if (self.options.prependToUrl &&
-          href.indexOf(self.options.prependToUrl) !== -1) {
+      if (this.options.prependToUrl &&
+          href.indexOf(this.options.prependToUrl) !== -1) {
         // XXX if using default configuration, it gets more difficult
         // here to detect internal urls so this might need to change...
-        self.linkType = 'internal';
-        self.linkTypes.internal.set(self.tinypattern.stripGeneratedUrl(href));
+        this.linkType = 'internal';
+        this.linkTypes.internal.set(this.tinypattern.stripGeneratedUrl(href));
       } else if (href.indexOf('mailto:') !== -1) {
-        self.linkType = 'email';
+        this.linkType = 'email';
         var email = href.substring('mailto:'.length, href.length);
         var split = email.split('?subject=');
-        self.linkTypes.email.set(split[0]);
+        this.linkTypes.email.set(split[0]);
         if (split.length > 1) {
-          self.$subject.val(decodeURIComponent(split[1]));
+          this.$subject.val(decodeURIComponent(split[1]));
         }
       } else if (href[0] === '#') {
-        self.linkType = 'anchor';
-        self.linkTypes.anchor.setRaw(href.substring(1));
+        this.linkType = 'anchor';
+        this.linkTypes.anchor.setRaw(href.substring(1));
       } else {
-        self.linkType = 'external';
-        self.linkTypes.external.setRaw(href);
+        this.linkType = 'external';
+        this.linkTypes.external.setRaw(href);
       }
     },
+
     setSelectElement: function($el, val) {
       $el.find('option:selected').prop('selected', false);
       if (val) {
@@ -624,17 +643,16 @@ define([
         $el.find('option[value="' + val + '"]').prop('selected', true);
       }
     },
+
     reinitialize: function() {
       /*
        * This will probably be called before show is run.
        * It will overwrite the base html template given to
        * be able to privde default values for the overlay
        */
-      var self = this;
-      self.modal.options.html = self.generateModalHtml();
+      this.modal.options.html = this.generateModalHtml();
     }
   });
-
   return LinkModal;
 
 });
diff --git a/mockup/patterns/tinymce/pattern.js b/mockup/patterns/tinymce/pattern.js
index d4a2493..8384e96 100644
--- a/mockup/patterns/tinymce/pattern.js
+++ b/mockup/patterns/tinymce/pattern.js
@@ -60,16 +60,46 @@ define([
   'mockup-patterns-tinymce-url/js/links',
   "mockup-i18n",
   'translate',
-  'tinymce-modern-theme', 'tinymce-advlist', 'tinymce-anchor', 'tinymce-autolink',
-  'tinymce-autoresize', 'tinymce-autosave', 'tinymce-bbcode', 'tinymce-charmap',
-  'tinymce-code', 'tinymce-colorpicker', 'tinymce-contextmenu', 'tinymce-directionality',
-  'tinymce-emoticons', 'tinymce-fullpage', 'tinymce-fullscreen', 'tinymce-hr',
-  'tinymce-image', 'tinymce-importcss', 'tinymce-insertdatetime', 'tinymce-layer',
-  'tinymce-legacyoutput', 'tinymce-link', 'tinymce-lists', 'tinymce-media',
-  'tinymce-nonbreaking', 'tinymce-noneditable', 'tinymce-pagebreak', 'tinymce-paste',
-  'tinymce-preview', 'tinymce-print', 'tinymce-save', 'tinymce-searchreplace',
-  'tinymce-spellchecker', 'tinymce-tabfocus', 'tinymce-table', 'tinymce-template',
-  'tinymce-textcolor', 'tinymce-textpattern', 'tinymce-visualblocks', 'tinymce-visualchars',
+  'tinymce-modern-theme',
+  'tinymce-advlist',
+  'tinymce-anchor',
+  'tinymce-autolink',
+  'tinymce-autoresize',
+  'tinymce-autosave',
+  'tinymce-bbcode',
+  'tinymce-charmap',
+  'tinymce-code',
+  'tinymce-colorpicker',
+  'tinymce-contextmenu',
+  'tinymce-directionality',
+  'tinymce-emoticons',
+  'tinymce-fullpage',
+  'tinymce-fullscreen',
+  'tinymce-hr',
+  'tinymce-image',
+  'tinymce-importcss',
+  'tinymce-insertdatetime',
+  'tinymce-layer',
+  'tinymce-legacyoutput',
+  'tinymce-link',
+  'tinymce-lists',
+  'tinymce-media',
+  'tinymce-nonbreaking',
+  'tinymce-noneditable',
+  'tinymce-pagebreak',
+  'tinymce-paste',
+  'tinymce-preview',
+  'tinymce-print',
+  'tinymce-save',
+  'tinymce-searchreplace',
+  'tinymce-spellchecker',
+  'tinymce-tabfocus',
+  'tinymce-table',
+  'tinymce-template',
+  'tinymce-textcolor',
+  'tinymce-textpattern',
+  'tinymce-visualblocks',
+  'tinymce-visualchars',
   'tinymce-wordcount'
 ], function($, _,
             Base, RelatedItems, Modal, tinymce,
@@ -79,6 +109,7 @@ define([
 
   var TinyMCE = Base.extend({
     name: 'tinymce',
+    trigger: '.pat-tinymce',
     defaults: {
       upload: {
         uploadMultiple: false,
diff --git a/mockup/patterns/toggle/pattern.js b/mockup/patterns/toggle/pattern.js
index 5664bd3..212ce4f 100644
--- a/mockup/patterns/toggle/pattern.js
+++ b/mockup/patterns/toggle/pattern.js
@@ -127,6 +127,7 @@ define([
 
   var Toggle = Base.extend({
     name: 'toggle',
+    trigger: '.pat-toggle',
     defaults: {
       attribute: 'class',
       event: 'click',
@@ -187,23 +188,23 @@ define([
     },
     remove: function() {
       var self = this;
-      self.trigger('remove-attr');
+      self.emit('remove-attr');
       if (self.options.attribute === 'class') {
         self.$target.removeClass(self.options.value);
       } else {
         self.$target.removeAttr(self.options.attribute);
       }
-      self.trigger('attr-removed');
+      self.emit('attr-removed');
     },
     add: function() {
       var self = this;
-      self.trigger('add-attr');
+      self.emit('add-attr');
       if (self.options.attribute === 'class') {
         self.$target.addClass(self.options.value);
       } else {
         self.$target.attr(self.options.attribute, self.options.value);
       }
-      self.trigger('added-attr');
+      self.emit('added-attr');
     }
   });
 
diff --git a/mockup/patterns/tooltip/pattern.js b/mockup/patterns/tooltip/pattern.js
index 66f1210..189fc42 100644
--- a/mockup/patterns/tooltip/pattern.js
+++ b/mockup/patterns/tooltip/pattern.js
@@ -62,6 +62,7 @@ define([
 
   var ToolTip = Base.extend({
     name: 'tooltip',
+    trigger: '.pat-tooltip',
     defaults: {
       attribute: 'class',
       enterEvent: 'mouseenter',
diff --git a/mockup/patterns/tree/pattern.js b/mockup/patterns/tree/pattern.js
index b061e27..cb310dd 100644
--- a/mockup/patterns/tree/pattern.js
+++ b/mockup/patterns/tree/pattern.js
@@ -61,6 +61,7 @@ define([
 
   var Tree = Base.extend({
     name: 'tree',
+    trigger: '.pat-tree',
     defaults: {
       dragAndDrop: false,
       autoOpen: false,
diff --git a/mockup/patterns/upload/less/pattern.upload.less b/mockup/patterns/upload/less/pattern.upload.less
index 7184337..24767cb 100644
--- a/mockup/patterns/upload/less/pattern.upload.less
+++ b/mockup/patterns/upload/less/pattern.upload.less
@@ -26,9 +26,9 @@
             padding-top: 10px;
         }
         .previews{
-            margin-top: 2em;
-            .item{ padding: 5px 0; }
-            .title{ padding-left: 0; }
+            margin-top: 4em;
+            .item{ padding: 5px 0; clear: both;}
+            .title{ padding-left: 3px; }
             .info img {
                 width: 32px;
                 height: 32px;
diff --git a/mockup/patterns/upload/pattern.js b/mockup/patterns/upload/pattern.js
index 1f84094..4fa932c 100644
--- a/mockup/patterns/upload/pattern.js
+++ b/mockup/patterns/upload/pattern.js
@@ -58,6 +58,7 @@ define([
 
   var UploadPattern = Base.extend({
     name: 'upload',
+    trigger: '.pat-upload',
     defaults: {
       showTitle: true,
       url: null, // XXX MUST provide url to submit to OR be in a form
@@ -391,6 +392,12 @@ define([
       return Math.round(mb / 1024) + ' GB';
     },
 
+    setPath: function(path){
+      var self = this;
+      self.currentPath = path;
+      self.options.url = self.dropzone.options.url = self.getUrl();
+    },
+
     setupRelatedItems: function($input) {
       var self = this;
       var options = self.options.relatedItems;
@@ -400,12 +407,11 @@ define([
       var ri = new RelatedItems($input, options);
       ri.$el.on('change', function() {
         var result = $(this).select2('data');
+        var path = null;
         if (result.length > 0){
-          self.currentPath = result[0].path;
-        } else {
-          self.currentPath = null;
+          path = result[0].path;
         }
-        self.options.url = self.dropzone.options.url = self.getUrl();
+        self.setPath(path);
       });
       return ri;
     }
diff --git a/mockup/tests/fakeserver.js b/mockup/tests/fakeserver.js
index 0cf55ec..f283eeb 100644
--- a/mockup/tests/fakeserver.js
+++ b/mockup/tests/fakeserver.js
@@ -657,7 +657,7 @@ define([
           'autotoc': 'patterns/autotoc/pattern',
           'mockup-patterns-base': 'bower_components/mockup-core/js/pattern',
           'jquery': 'bower_components/jquery/dist/jquery',
-          'mockup-registry': 'bower_components/mockup-core/js/registry'
+          "pat-registry": "bower_components/patternslib/src/core/registry",
         },
         include: ['autotoc']
       };
@@ -678,4 +678,4 @@ define([
   });
   return server;
 
-});
\ No newline at end of file
+});
diff --git a/mockup/tests/i18n-test.js b/mockup/tests/i18n-test.js
index 31f1677..d2b9259 100644
--- a/mockup/tests/i18n-test.js
+++ b/mockup/tests/i18n-test.js
@@ -20,7 +20,7 @@ define([
       it('baseUrl', function() {
         i18n.configure({ baseUrl: '/something' });
         expect(i18n.baseUrl).to.be('/something');
-        i18n.configure({ baseUrl: '/jsi18n' });
+        i18n.configure({ baseUrl: '/plonejsi18n' });
       });
     });
 
@@ -29,7 +29,7 @@ define([
       it('correct params', function() {
         i18n.configure({ baseUrl: '/foobar' });
         expect(i18n.getUrl('foobar', 'es')).to.be('/foobar?domain=foobar&language=es');
-        i18n.configure({ baseUrl: '/jsi18n' });
+        i18n.configure({ baseUrl: '/plonejsi18n' });
       });
     });
 
@@ -64,14 +64,14 @@ define([
         server.autoRespond = true;
         var clock = sinon.useFakeTimers();
 
-        server.respondWith('GET', /jsi18n/, function (xhr) {
+        server.respondWith('GET', /plonejsi18n/, function (xhr) {
           xhr.respond(200, { 'Content-Type': 'application/json' }, JSON.stringify({
             foo: 'bar',
           }));
         });
         i18n.configure({
           currentLanguage: 'en',
-          baseUrl: '/jsi18n'
+          baseUrl: '/plonejsi18n'
         });
         i18n.loadCatalog('foobar');
         clock.tick(500);
diff --git a/mockup/tests/pattern-accessibility-test.js b/mockup/tests/pattern-accessibility-test.js
index 9ad242f..5249bf7 100644
--- a/mockup/tests/pattern-accessibility-test.js
+++ b/mockup/tests/pattern-accessibility-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-accessibility'
 ], function(expect, $, registry, Accessibility) {
   'use strict';
diff --git a/mockup/tests/pattern-autotoc-test.js b/mockup/tests/pattern-autotoc-test.js
index e11950b..b52b077 100644
--- a/mockup/tests/pattern-autotoc-test.js
+++ b/mockup/tests/pattern-autotoc-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-autotoc'
 ], function(expect, $, Registry, AutoTOC) {
   'use strict';
diff --git a/mockup/tests/pattern-backdrop-test.js b/mockup/tests/pattern-backdrop-test.js
index 1939052..24df487 100644
--- a/mockup/tests/pattern-backdrop-test.js
+++ b/mockup/tests/pattern-backdrop-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-backdrop'
 ], function(expect, $, registry, Backdrop) {
   'use strict';
diff --git a/mockup/tests/pattern-cookietrigger-test.js b/mockup/tests/pattern-cookietrigger-test.js
index 1d837cc..3c7d5eb 100644
--- a/mockup/tests/pattern-cookietrigger-test.js
+++ b/mockup/tests/pattern-cookietrigger-test.js
@@ -2,7 +2,7 @@ define([
   'expect',
   'jquery',
   'sinon',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-cookietrigger'
 ], function(expect, $, sinon, registry, Pattern) {
   'use strict';
@@ -26,9 +26,9 @@ define([
         '</div>';
 
       var $el = $(widget).appendTo('body').hide();
-      Pattern.extend({isCookiesEnabled: sinon.stub().returns(0)});
+      $.extend(true, Pattern.prototype, {isCookiesEnabled: sinon.stub().returns(0)});
       expect($el.is(':visible')).to.equal(false);
-      var pattern = registry.init($el, 'cookietrigger');
+      var pattern = registry.patterns.cookietrigger.init($el);
       expect($el.is(':visible')).to.equal(true);
     });
 
@@ -39,9 +39,9 @@ define([
         '</div>';
 
       var $el = $(widget).appendTo('body').hide();
-      Pattern.extend({isCookiesEnabled: sinon.stub().returns(1)});
+      $.extend(true, Pattern.prototype, {isCookiesEnabled: sinon.stub().returns(1)});
       expect($el.is(':visible')).to.equal(false);
-      var pattern = registry.init($el, 'cookietrigger');
+      var pattern = registry.patterns.cookietrigger.init($el);
       expect($el.is(':visible')).to.equal(false);
     });
   });
diff --git a/mockup/tests/pattern-eventedit-test.js b/mockup/tests/pattern-eventedit-test.js
index 1a2d8da..4e0c205 100644
--- a/mockup/tests/pattern-eventedit-test.js
+++ b/mockup/tests/pattern-eventedit-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-eventedit'
 ], function(expect, $, registry, EventEdit) {
   'use strict';
@@ -49,12 +49,11 @@ define([
       $(sel_whole_day + ' input', $el).trigger('change');
       expect($('.pattern-pickadate-time-wrapper', $el).is(':visible')).to.be.equal(true);
 
-
       // changing start time
       $(sel_start + ' .pattern-pickadate-time', $el).click();
       $(sel_start + ' .pattern-pickadate-time-wrapper li:contains("10:00 AM")', $el).click();
       expect($(sel_start + ' .pattern-pickadate-time-wrapper input[name="_submit"]', $el).prop('value')).to.be.equal('10:00');
-      expect($(sel_end + ' .pattern-pickadate-time-wrapper input[name="_submit"]', $el).prop('value')).to.be.equal('11:30');
+      expect($(sel_end + ' .pattern-pickadate-time-wrapper input[name="_submit"]', $el).prop('value')).to.be.equal('15:30');
 
       // wrong end time
       $(sel_end + ' .pattern-pickadate-time', $el).click();
diff --git a/mockup/tests/pattern-filemanager-test.js b/mockup/tests/pattern-filemanager-test.js
index f40002f..1789b42 100644
--- a/mockup/tests/pattern-filemanager-test.js
+++ b/mockup/tests/pattern-filemanager-test.js
@@ -2,7 +2,7 @@ define([
   'sinon',
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-filemanager'
 ], function(sinon, expect, $, registry, Tree) {
   'use strict';
diff --git a/mockup/tests/pattern-formautofocus-test.js b/mockup/tests/pattern-formautofocus-test.js
index 406db72..c835b2c 100644
--- a/mockup/tests/pattern-formautofocus-test.js
+++ b/mockup/tests/pattern-formautofocus-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-formautofocus'
 ], function(expect, $, registry, FormAutoFocus) {
   'use strict';
@@ -46,7 +46,7 @@ define([
         '</div>')
         .appendTo('body');
       expect($('input#first-input').is(':focus')).to.be.equal(false);
-      $('input').on('focus', function() {
+      $('input').on('focusin', function() {
         expect($(this).attr('id')).to.equal('input1-inside-error');
         expect($('input#first-input-should-not-focus').is(':focus')).to.be.equal(false);
         expect($('input#input-inside-error-should-not-focus').is(':focus')).to.be.equal(false);
@@ -55,6 +55,7 @@ define([
       registry.scan($el);
       $el.remove();
     });
+
     it('when the condition is not met, focus on the first input', function(done) {
       var $el = $('' +
         '<div>' +
@@ -65,7 +66,7 @@ define([
         '</div>')
         .appendTo('body');
       expect($('input#first-input').is(':focus')).to.be.equal(false);
-      $('input').on('focus', function() {
+      $('input').on('focusin', function() {
         expect($(this).attr('id')).to.equal('first-input');
         expect($('input#first-input-should-not-focus').is(':focus')).to.be.equal(false);
         expect($('input#input-inside-error-should-not-focus').is(':focus')).to.be.equal(false);
diff --git a/mockup/tests/pattern-formunloadalert-test.js b/mockup/tests/pattern-formunloadalert-test.js
index bc5717a..7915fb6 100644
--- a/mockup/tests/pattern-formunloadalert-test.js
+++ b/mockup/tests/pattern-formunloadalert-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-formunloadalert'
 ], function(expect, $, registry, FormUnloadAlert) {
   'use strict';
diff --git a/mockup/tests/pattern-inlinevalidation-test.js b/mockup/tests/pattern-inlinevalidation-test.js
index 8795c65..c4f425c 100644
--- a/mockup/tests/pattern-inlinevalidation-test.js
+++ b/mockup/tests/pattern-inlinevalidation-test.js
@@ -2,7 +2,7 @@ define([
   'expect',
   'jquery',
   'sinon',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-inlinevalidation'
 ], function(expect, $, sinon, registry, Pattern) {
   'use strict';
@@ -27,8 +27,8 @@ define([
         '         value="Welcome to Plone" type="text">' +
         '</div>';
       var $el = $(widget).appendTo('body');
-      Pattern.extend({validate_z3cform_field: sinon.spy()});
-      var pattern = registry.init($el, 'inlinevalidation', {type: 'z3c.form'});
+      $.extend(true, Pattern.prototype, {validate_z3cform_field: sinon.spy()});
+      var pattern = registry.patterns.inlinevalidation.init($el, null, {type: 'z3c.form'});
       expect(pattern.validate_z3cform_field.called).to.equal(false);
       $el.children('input').blur();
       expect(pattern.validate_z3cform_field.called).to.equal(true);
@@ -37,8 +37,8 @@ define([
     it('A formlib input is validated on the "blur" event', function() {
       var $el = $('<div class="pat-inlinevalidation" data-pat-inlinevalidation=\'{"type": "formlib"}\'> <input type="text"> </div>')
                 .appendTo('body');
-      Pattern.extend({validate_formlib_field: sinon.spy()});
-      var pattern = registry.init($el, 'inlinevalidation', {type: 'formlib'});
+      $.extend(true, Pattern.prototype, {validate_formlib_field: sinon.spy()});
+      var pattern = registry.patterns.inlinevalidation.init($el, null, {type: 'formlib'});
       expect(pattern.validate_formlib_field.called).to.equal(false);
       $el.children('input').blur();
       expect(pattern.validate_formlib_field.called).to.equal(true);
@@ -47,8 +47,8 @@ define([
     it('An archetypes input is validated on the "blur" event', function() {
       var $el = $('<div class="pat-inlinevalidation" data-pat-inlinevalidation=\'{"type": "archetypes"}\'> <input class="blurrable" type="text"> </div>')
                 .appendTo('body');
-      Pattern.extend({validate_archetypes_field: sinon.spy()});
-      var pattern = registry.init($el, 'inlinevalidation', {type: 'archetypes'});
+      $.extend(true, Pattern.prototype, {validate_archetypes_field: sinon.spy()});
+      var pattern = registry.patterns.inlinevalidation.init($el, null, {type: 'archetypes'});
       expect(pattern.validate_archetypes_field.called).to.equal(false);
       $el.children('input').blur();
       expect(pattern.validate_archetypes_field.called).to.equal(true);
diff --git a/mockup/tests/pattern-markspeciallinks-test.js b/mockup/tests/pattern-markspeciallinks-test.js
index a2a2e5f..4fe355c 100644
--- a/mockup/tests/pattern-markspeciallinks-test.js
+++ b/mockup/tests/pattern-markspeciallinks-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-markspeciallinks'
 ], function(expect, $, registry, MarkSpecialLinks) {
   'use strict';
@@ -52,29 +52,29 @@ define([
     it('normal external links have target=_blank', function() {
       registry.scan(this.$el);
       var link = this.$el.find('a');
-      expect(link.eq(0).attr("target")===undefined).to.be.equal(true);
-      expect(link.eq(1).attr("target")===undefined).to.be.equal(true);
-      expect(link.eq(2).attr("target")).to.be.equal("_blank");
-      expect(link.eq(3).attr("target")===undefined).to.be.equal(true);
-      expect(link.eq(0).parent("i").length).to.be.equal(1);
-      expect(link.eq(1).parent("i").length).to.be.equal(0);
-      expect(link.eq(4).parent("i").length).to.be.equal(0);
-      expect(link.eq(5).parent("i").length).to.be.equal(0);
+      expect(link.eq(0).attr('target')===undefined).to.be.equal(true);
+      expect(link.eq(1).attr('target')===undefined).to.be.equal(true);
+      expect(link.eq(2).attr('target')).to.be.equal('_blank');
+      expect(link.eq(3).attr('target')===undefined).to.be.equal(true);
+      expect(link.eq(0).prev()[0].tagName).to.be.equal('I');
+      expect(link.eq(1).prev()[0].tagName).not.to.equal('I');
+      expect(link.eq(4).prev().length).to.be.equal(0);
+      expect(link.eq(5).prev()[0].tagName).not.to.equal('I');
     });
     it('check for correct icon classes per protocol', function() {
       registry.scan(this.$el);
       var listel = this.$el.next('.icons').find('li');
-      expect(listel.eq(0).find("i").hasClass('link-external')).to.be.equal(true);
-      expect(listel.eq(1).find("i").hasClass('link-https')).to.be.equal(true);
-      expect(listel.eq(2).find("i").hasClass('link-mailto')).to.be.equal(true);
-      expect(listel.eq(3).find("i").hasClass('link-ftp')).to.be.equal(true);
-      expect(listel.eq(4).find("i").hasClass('link-news')).to.be.equal(true);
-      expect(listel.eq(5).find("i").hasClass('link-irc')).to.be.equal(true);
-      expect(listel.eq(6).find("i").hasClass('link-h323')).to.be.equal(true);
-      expect(listel.eq(7).find("i").hasClass('link-sip')).to.be.equal(true);
-      expect(listel.eq(8).find("i").hasClass('link-callto')).to.be.equal(true);
-      expect(listel.eq(9).find("i").hasClass('link-feed')).to.be.equal(true);
-      expect(listel.eq(10).find("i").hasClass('link-webcal')).to.be.equal(true);
+      expect(listel.eq(0).find('i').hasClass('link-external')).to.be.equal(true);
+      expect(listel.eq(1).find('i').hasClass('link-https')).to.be.equal(true);
+      expect(listel.eq(2).find('i').hasClass('link-mailto')).to.be.equal(true);
+      expect(listel.eq(3).find('i').hasClass('link-ftp')).to.be.equal(true);
+      expect(listel.eq(4).find('i').hasClass('link-news')).to.be.equal(true);
+      expect(listel.eq(5).find('i').hasClass('link-irc')).to.be.equal(true);
+      expect(listel.eq(6).find('i').hasClass('link-h323')).to.be.equal(true);
+      expect(listel.eq(7).find('i').hasClass('link-sip')).to.be.equal(true);
+      expect(listel.eq(8).find('i').hasClass('link-callto')).to.be.equal(true);
+      expect(listel.eq(9).find('i').hasClass('link-feed')).to.be.equal(true);
+      expect(listel.eq(10).find('i').hasClass('link-webcal')).to.be.equal(true);
     });
   });
 });
diff --git a/mockup/tests/pattern-modal-test.js b/mockup/tests/pattern-modal-test.js
index 21acaa4..5c06bef 100644
--- a/mockup/tests/pattern-modal-test.js
+++ b/mockup/tests/pattern-modal-test.js
@@ -2,7 +2,7 @@ define([
   'expect',
   'jquery',
   'sinon',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-modal'
 ], function(expect, $, sinon, registry, Modal) {
   'use strict';
diff --git a/mockup/tests/pattern-moment-test.js b/mockup/tests/pattern-moment-test.js
index f048895..8b49c60 100644
--- a/mockup/tests/pattern-moment-test.js
+++ b/mockup/tests/pattern-moment-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-moment'
 ], function(expect, $, registry, Moment) {
   'use strict';
diff --git a/mockup/tests/pattern-passwordstrength-test.js b/mockup/tests/pattern-passwordstrength-test.js
index 695c765..f2c55fc 100644
--- a/mockup/tests/pattern-passwordstrength-test.js
+++ b/mockup/tests/pattern-passwordstrength-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-passwordstrength'
 ], function(expect, $, registry, PasswordStrength) {
   'use strict';
@@ -48,11 +48,8 @@ define([
       window.zxcvbn = fakeZxcvbn;
       registry.scan($el);
 
-      expect($el.html()).to.equal(
-          '<input type="password" class="pat-passwordstrength">' +
-          '<div class="pat-passwordstrength-meter level-0">' +
-          '<div></div>' + '<div></div>' + '<div></div>' + '<div></div>' +
-          '</div>');
+      expect($el.find('.pat-passwordstrength').size()).to.be.equal(1);
+      expect($el.find('.pat-passwordstrength-meter').hasClass('level-0')).to.be.equal(true);
     });
 
     it('tries to load zxcvbn once if not available', function() {
diff --git a/mockup/tests/pattern-pickadate-test.js b/mockup/tests/pattern-pickadate-test.js
index 10d4ce0..5a48d4e 100644
--- a/mockup/tests/pattern-pickadate-test.js
+++ b/mockup/tests/pattern-pickadate-test.js
@@ -2,7 +2,7 @@ define([
   'expect',
   'jquery',
   'sinon',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-pickadate',
   'mockup-patterns-select2'
 ], function(expect, $, sinon, registry, PickADate, Select2) {
@@ -423,7 +423,7 @@ define([
                                           ']}}'
               );
         self.$el.appendTo('body');
-        registry.scan($input);
+        registry.scan($input, ['pickadate']);
 
         // check if visible and data value are set to default
         expect($('.pattern-pickadate-timezone .select2-chosen').text()).to.equal('Enter timezone...');
@@ -439,7 +439,7 @@ define([
                                           ']}}'
               );
         self.$el.appendTo('body');
-        registry.scan($input);
+        registry.scan($input, ['pickadate']);
 
         var $time = $('.pattern-pickadate-timezone');
 
diff --git a/mockup/tests/pattern-preventdoublesubmit-test.js b/mockup/tests/pattern-preventdoublesubmit-test.js
index 65d4c1d..83e2b75 100644
--- a/mockup/tests/pattern-preventdoublesubmit-test.js
+++ b/mockup/tests/pattern-preventdoublesubmit-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-preventdoublesubmit'
 ], function(expect, $, registry, PreventDoubleSubmit) {
   'use strict';
diff --git a/mockup/tests/pattern-relateditems-test.js b/mockup/tests/pattern-relateditems-test.js
index b877685..08ddde7 100644
--- a/mockup/tests/pattern-relateditems-test.js
+++ b/mockup/tests/pattern-relateditems-test.js
@@ -3,7 +3,7 @@ define([
   'jquery',
   'underscore',
   'sinon',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-relateditems'
 ], function(expect, $, _, sinon, registry, RelatedItems) {
   'use strict';
diff --git a/mockup/tests/pattern-resourceregistry-test.js b/mockup/tests/pattern-resourceregistry-test.js
index a05c403..a20dd6e 100644
--- a/mockup/tests/pattern-resourceregistry-test.js
+++ b/mockup/tests/pattern-resourceregistry-test.js
@@ -2,7 +2,7 @@ define([
   'sinon',
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-resourceregistry'
 ], function(sinon, expect, $, registry) {
   'use strict';
diff --git a/mockup/tests/pattern-select2-test.js b/mockup/tests/pattern-select2-test.js
index 17174a0..c49bdc9 100644
--- a/mockup/tests/pattern-select2-test.js
+++ b/mockup/tests/pattern-select2-test.js
@@ -2,7 +2,7 @@ define([
   'expect',
   'jquery',
   'sinon',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-select2'
 ], function(expect, $, sinon, registry, Select2) {
   'use strict';
diff --git a/mockup/tests/pattern-sortable-test.js b/mockup/tests/pattern-sortable-test.js
index 8949ea3..3acba00 100644
--- a/mockup/tests/pattern-sortable-test.js
+++ b/mockup/tests/pattern-sortable-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-sortable'
 ], function(expect, $, registry, Sortable) {
   'use strict';
diff --git a/mockup/tests/pattern-structure-test.js b/mockup/tests/pattern-structure-test.js
index 120624c..1bbb6e9 100644
--- a/mockup/tests/pattern-structure-test.js
+++ b/mockup/tests/pattern-structure-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-structure',
   'sinon',
 ], function(expect, $, registry, Structure, sinon) {
diff --git a/mockup/tests/pattern-tablesorter-test.js b/mockup/tests/pattern-tablesorter-test.js
index cedbf27..827f071 100644
--- a/mockup/tests/pattern-tablesorter-test.js
+++ b/mockup/tests/pattern-tablesorter-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-tablesorter'
 ], function(expect, $, registry, Tablesorter) {
   'use strict';
diff --git a/mockup/tests/pattern-textareamimetypeselector-test.js b/mockup/tests/pattern-textareamimetypeselector-test.js
index 413e18a..585da9c 100644
--- a/mockup/tests/pattern-textareamimetypeselector-test.js
+++ b/mockup/tests/pattern-textareamimetypeselector-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-textareamimetypeselector',
   'mockup-patterns-tinymce'
 ], function(expect, $, registry, textareamimetypeselector, tinymce) {
diff --git a/mockup/tests/pattern-tinymce-test.js b/mockup/tests/pattern-tinymce-test.js
index 118ca95..905321b 100644
--- a/mockup/tests/pattern-tinymce-test.js
+++ b/mockup/tests/pattern-tinymce-test.js
@@ -2,7 +2,7 @@ define([
   'expect',
   'jquery',
   'sinon',
-  'mockup-registry',
+  'pat-registry',
   'tinymce',
   'mockup-patterns-tinymce'
 ], function(expect, $, sinon, registry, tinymce, TinyMCE) {
@@ -12,12 +12,10 @@ define([
   $.fx.off = true;
 
   var createTinymce = function(options) {
-    if (options === undefined) {
-      options = {};
-    }
-    var $el = $('<textarea class="pat-tinymce"></textarea>').appendTo('body');
-
-    return new TinyMCE($el, options);
+    return registry.patterns.tinymce.init(
+      $('<textarea class="pat-tinymce"></textarea>').appendTo('body'),
+        options || {}
+      );
   };
 
   describe('TinyMCE', function() {
@@ -188,7 +186,6 @@ define([
       expect(pattern.getScaleFromUrl('foobar/somescale/image_large')).to.equal('large');
     });
 
-
     it('test add link', function() {
       var pattern = createTinymce({
         prependToUrl: 'resolveuid/',
@@ -197,7 +194,6 @@ define([
           ajaxvocabulary: '/data.json'
         }
       });
-
       pattern.addLinkClicked();
       pattern.linkModal.linkTypes.internal.$input.select2('data', {
         UID: 'foobar',
@@ -207,6 +203,7 @@ define([
       });
       expect(pattern.linkModal.getLinkUrl()).to.equal('resolveuid/foobar');
     });
+
     it('test add external link', function() {
       var pattern = createTinymce();
       pattern.addLinkClicked();
@@ -243,7 +240,7 @@ define([
 
     it('test adds data attributes', function() {
       var pattern = createTinymce();
-
+      pattern.tiny.setContent('<p>blah</p>');
       pattern.addLinkClicked();
       pattern.linkModal.linkTypes.internal.$input.select2('data', {
         UID: 'foobar',
@@ -251,7 +248,6 @@ define([
         Title: 'Foobar',
         path: '/foobar'
       });
-      pattern.tiny.setContent('<p>blah</p>');
       pattern.linkModal.focusElement(pattern.tiny.dom.getRoot().getElementsByTagName('p')[0]);
       pattern.linkModal.$button.trigger('click');
       expect(pattern.tiny.getContent()).to.contain('data-val="foobar"');
diff --git a/mockup/tests/pattern-toggle-test.js b/mockup/tests/pattern-toggle-test.js
index aa65f5c..054ccdc 100644
--- a/mockup/tests/pattern-toggle-test.js
+++ b/mockup/tests/pattern-toggle-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-toggle'
 ], function(expect, $, registry, Toggle) {
   'use strict';
diff --git a/mockup/tests/pattern-tooltip-test.js b/mockup/tests/pattern-tooltip-test.js
index 4683d7a..ff9555e 100644
--- a/mockup/tests/pattern-tooltip-test.js
+++ b/mockup/tests/pattern-tooltip-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-tooltip'
 ], function(expect, $, registry, ToolTip) {
   'use strict';
diff --git a/mockup/tests/pattern-tree-test.js b/mockup/tests/pattern-tree-test.js
index 9b242dc..273eeef 100644
--- a/mockup/tests/pattern-tree-test.js
+++ b/mockup/tests/pattern-tree-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-tree'
 ], function(expect, $, registry, Tree) {
   'use strict';
diff --git a/mockup/tests/pattern-upload-test.js b/mockup/tests/pattern-upload-test.js
index 7c55df2..dc2ec63 100644
--- a/mockup/tests/pattern-upload-test.js
+++ b/mockup/tests/pattern-upload-test.js
@@ -1,7 +1,7 @@
 define([
   'expect',
   'jquery',
-  'mockup-registry',
+  'pat-registry',
   'mockup-patterns-upload'
 ], function(expect, $, registry, Upload) {
   'use strict';
diff --git a/mockup/tests/utils-test.js b/mockup/tests/utils-test.js
index 3123450..3f72935 100644
--- a/mockup/tests/utils-test.js
+++ b/mockup/tests/utils-test.js
@@ -183,7 +183,7 @@ define([
           zIndex: function() { return 999; }
         });
         loading.show();
-        expect(loading.$el[0].style.zIndex).to.equal('999');
+        expect(loading.$el[0].style.zIndex + '').to.equal('999');
       });
       it('works with backdrop', function() {
         var initCalled = false;


Repository: mockup
Branch: refs/heads/master
Date: 2015-02-06T11:13:54+01:00
Author: Eric BREHAULT (ebrehault) <ebrehault@gmail.com>
Commit: https://github.com/plone/mockup/commit/9e808d7169e390c58942476a4cad653c84c496a5

refactor

Files changed:
M mockup/patterns/tinymce/pattern.js

diff --git a/mockup/patterns/tinymce/pattern.js b/mockup/patterns/tinymce/pattern.js
index 8384e96..4853d45 100644
--- a/mockup/patterns/tinymce/pattern.js
+++ b/mockup/patterns/tinymce/pattern.js
@@ -276,26 +276,40 @@ define([
     },
     initLanguage: function(call_back){
       var self = this;
-      var ploneLanguage = i18n.currentLanguage;
-      var languages = [ploneLanguage];
-      if (ploneLanguage.split("_") > 1){
-        languages.push(ploneLanguage.split("_")[0]);
-      }
-      else{
-        languages.push(ploneLanguage + "_" + ploneLanguage.toUpperCase());
-      }
-
-      for (var i = 0; i < languages.length; i++) {
-        var language_tmp = languages[i];
+      var lang = i18n.currentLanguage;
+      if (lang != 'en' && self.options.tiny.language !== 'en') {
+        tinymce.baseURL = self.options.loadingBaseUrl;
+        // does the expected language exist?
         $.ajax({
-            url: tinymce.baseURL + "/langs/" + language_tmp + ".js",
-            type:'HEAD',
-            success: function()
-            {
-                call_back(language_tmp);
+          url: tinymce.baseURL + "/langs/" + lang + ".js",
+          type:'HEAD',
+          success: function() {
+            self.options.tiny.language = lang;
+            call_back();
+          },
+          error: function() {
+            // expected lang not available, let's fallback to closest one
+            if (lang.split("_") > 1){
+              lang = lang.split("_")[0];
+            } else {
+              lang = lang + "_" + lang.toUpperCase();
             }
+            $.ajax({
+              url: tinymce.baseURL + "/langs/" + lang + ".js",
+              type:'HEAD',
+              success: function() {
+                self.options.tiny.language = lang;
+                call_back();
+              },
+              error: function() {
+                call_back();
+              }
+            });
+          }
         });
-      };
+      } else {
+        call_back();
+      }
     },
     init: function() {
       var self = this;
@@ -325,23 +339,15 @@ define([
         }
       };
 
-      if (i18n.currentLanguage != 'en' && tinyOptions.language !== 'en') {
-        tinymce.baseURL = self.options.loadingBaseUrl;
-        self.initLanguage(function(lang) {
-          tinyOptions.language = lang;
-          tinymce.init(tinyOptions);
-          self.tiny = tinymce.get(id);
-        });
-      }
-      else{
+      self.initLanguage(function() {
         tinymce.init(tinyOptions);
         self.tiny = tinymce.get(id);
-      }
-      /* tiny really should be doing this by default
-       * but this fixes overlays not saving data */
-      var $form = self.$el.parents('form');
-      $form.on('submit', function() {
-        self.tiny.save();
+        /* tiny really should be doing this by default
+         * but this fixes overlays not saving data */
+        var $form = self.$el.parents('form');
+        $form.on('submit', function() {
+          self.tiny.save();
+        });
       });
     },
     destroy: function() {


Repository: mockup
Branch: refs/heads/master
Date: 2015-03-26T17:23:48+01:00
Author: Eric BREHAULT (ebrehault) <ebrehault@gmail.com>
Commit: https://github.com/plone/mockup/commit/35609e9ae2f77d64ab78fba4a35a7a51dd077ddb

merge

Files changed:
A .bowerrc
A Makefile
A bower.json
A mockup/node_modules
A mockup/patterns/contentloader/pattern.js
A mockup/patterns/livesearch/pattern.js
A mockup/patterns/livesearch/pattern.livesearch.less
A mockup/patterns/recurrence/pattern.js
A mockup/patterns/recurrence/pattern.recurrence.less
A mockup/patterns/resourceregistry/js/builder.js
A mockup/patterns/resourceregistry/js/iframe.js
A mockup/tests/pattern-contentloader-test.js
A mockup/tests/pattern-livesearch-test.js
A package.json
M .travis.yml
M CHANGES.rst
M mockup/Gruntfile.js
M mockup/index.html
M mockup/js/bundles/docs.js
M mockup/js/bundles/filemanager.js
M mockup/js/bundles/plone.js
M mockup/js/bundles/resourceregistry.js
M mockup/js/bundles/widgets.js
M mockup/js/config.js
M mockup/js/ui/views/base.js
M mockup/less/base.less
M mockup/less/docs.less
M mockup/less/structure.less
M mockup/patterns/filemanager/pattern.filemanager.less
M mockup/patterns/modal/pattern.modal.less
M mockup/patterns/relateditems/pattern.js
M mockup/patterns/relateditems/pattern.relateditems.less
M mockup/patterns/resourceregistry/js/fields.js
M mockup/patterns/resourceregistry/js/less.js
M mockup/patterns/resourceregistry/js/overrides.js
M mockup/patterns/resourceregistry/js/patternoptions.js
M mockup/patterns/resourceregistry/js/registry.js
M mockup/patterns/resourceregistry/pattern.js
M mockup/patterns/resourceregistry/pattern.resourceregistry.less
M mockup/patterns/select2/pattern.select2.less
M mockup/patterns/structure/js/views/addmenu.js
M mockup/patterns/structure/js/views/app.js
M mockup/patterns/structure/js/views/columns.js
M mockup/patterns/structure/less/pattern.structure.less
M mockup/patterns/structure/pattern.js
M mockup/patterns/thememapper/pattern.thememapper.less
M mockup/patterns/tinymce/js/links.js
M mockup/patterns/tinymce/less/pattern.tinymce.less
M mockup/patterns/tinymce/pattern.js
M mockup/patterns/tinymce/templates/image.xml
M mockup/patterns/tinymce/templates/link.xml
M mockup/patterns/tree/pattern.tree.less
M mockup/tests/fakeserver.js
M mockup/tests/pattern-relateditems-test.js
M mockup/tests/pattern-resourceregistry-test.js
M mockup/tests/pattern-tinymce-test.js
M setup.py
D mockup/Makefile
D mockup/bower.json
D mockup/package.json

diff --git a/.bowerrc b/.bowerrc
new file mode 100644
index 0000000..efb8c79
--- /dev/null
+++ b/.bowerrc
@@ -0,0 +1,3 @@
+{
+  "directory" : "mockup/bower_components"
+}
diff --git a/.travis.yml b/.travis.yml
index f085097..31ffad1 100644
--- a/.travis.yml
+++ b/.travis.yml
@@ -17,7 +17,6 @@ env:
     - BROWSERS="SL_IPad"
     - BROWSERS="SL_Android"
 install:
-  - cd mockup
   - travis_retry make bootstrap
   - echo "Host github.com" >> ~/.ssh/config
   - echo "   StrictHostKeyChecking no" >> ~/.ssh/config
diff --git a/CHANGES.rst b/CHANGES.rst
index 23f197c..d38d5b3 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -1,15 +1,59 @@
 Changelog
 =========
 
-2.0.0 (unreleased)
+2.0.2 (unreleased)
 ------------------
 
+- update related items tree widget integration to have a bit better
+  user interaction. Automatically open folder nodes and implement double click
+  [vangheem]
+
+- fix rendering issue with tinymce link/image overlay and tree selector
+  [vangheem]
+
+2.0.1 (2015-03-25)
+------------------
+
+- be able to use tinymce plone plugins without image upload part
+  [vangheem]
+
+2.0.0 (2015-03-17)
+------------------
+
+- make sure mockup can be installable with bower again
+  [vangheem]
+
+- Bring back TinyMCE ``sed`` and ``copy`` from ``mockup`` into ``mockup-core``.
+  If we create bundles from an external package based on patterns from mockup,
+  we don't want to care about the sed and copy tasks too. Instead, those should
+  be defined on the patterns itself, but thats for a future release.
+  [thet]
+
+- Add ``id`` and ``Title`` to the default available columns of the structure
+  pattern.
+  [thet]
+
+- fix bootstrap css bleeding into global namespaces
+  [vangheem]
+
+- add recurrence pattern
+  [vangheem]
+
+- add livesearch pattern
+  [vangheem]
+
+- add history support for structure
+  [vangheem]
+
 - Patternslib merge: Use Patternslib's scanner and registry.  This allows us
   to: Use Patternslib patterns with Mockup/Plone and use Mockup patterns with
   Patternslib outside of Plone. For changes required to patterns, see:
   mockup/GETTING_STARTED.md . Refs: #460.
   [jcbrand]
 
+- Add icons to relateditems pattern (see https://github.com/plone/mockup/issues/442)
+  [petschki]
+
 
 1.8.3 (2015-01-26)
 ------------------
@@ -70,6 +114,10 @@ Fixes and enhancements:
   tags.
   [ACatlla, thet]
 
+- Fix less variable overrides on resourceregistry pattern when building
+  CSS from less resources
+  [datakurre]
+
 - Depend on ``tinymce-builded`` 4.1.6, include TinyMCE copy and sed
   configuration in here and fix some sed tasks.
   Revert cd89d377e10a28b797fd3c9d48410ad6ad597486: "Remove bower dependency on
diff --git a/Makefile b/Makefile
new file mode 100644
index 0000000..09e4556
--- /dev/null
+++ b/Makefile
@@ -0,0 +1,119 @@
+GIT = git
+NPM = npm
+NODE_VERSION = $(shell node -v)
+NODE_VERSION_MAJ = $(shell echo $(NODE_VERSION) | cut -f1 -d. | cut -f2 -dv )
+NODE_VERSION_MIN = $(shell echo $(NODE_VERSION) | cut -f2 -d.)
+NODE_VERSION_LT_011 = $(shell [ $(NODE_VERSION_MAJ) -eq 0 -a $(NODE_VERSION_MIN) -lt 11 ] && echo true)
+
+GRUNT = ./node_modules/grunt-cli/bin/grunt
+BOWER = ./node_modules/bower/bin/bower
+NODE_PATH = ./node_modules
+
+DEBUG =
+ifeq ($(debug), true)
+	DEBUG = --debug
+endif
+VERBOSE =
+ifeq ($(verbose), true)
+	VERBOSE = --verbose
+endif
+
+
+all: test-once bundles docs
+
+stamp-npm: package.json
+	npm install
+	touch stamp-npm
+
+stamp-bower: stamp-npm bower.json
+	$(BOWER) install
+	touch stamp-bower
+
+bundles: stamp-bower bundle-widgets bundle-structure bundle-plone
+	# ----------------------------------------------------------------------- #
+	# cp build/widgets* path/to/plone.app.widgets/plone/app/widgets/static
+	# cp build/structure* path/to/wildcard.foldercontents/wildcard/foldercontents/static
+	# cp build/plone* path/to/Products.CMFPlone/Products/CMFPlone/static
+	# ----------------------------------------------------------------------- #
+
+bundle-widgets:
+	mkdir -p build
+	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-widgets $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+bundle-structure:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-structure $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+bundle-plone:
+	mkdir -p build
+	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-plone $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+bundle-filemanager:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-filemanager $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+bundle-resourceregistry:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-resourceregistry $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+docs:
+	if test ! -d docs; then $(GIT) clone git://github.com/plone/mockup.git -b gh-pages docs; fi
+	rm -rf docs/dev
+	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-docs $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+bootstrap-common:
+	mkdir -p build
+
+bootstrap: bootstrap-common
+	@echo node version: $(NODE_VERSION)
+ifeq ($(NODE_VERSION_LT_011),true)
+	# for node < v0.11.x
+	$(NPM) link --prefix=.
+	# remove lib/node_modules, which contains a symlink to the project root.
+	# This leads to infinite recursion at the grunt copy task on make docs.
+	rm -rf lib/node_modules
+else
+	$(NPM) link
+endif
+	NODE_PATH=$(NODE_PATH) $(BOWER) install --config.interactive=0
+	NODE_PATH=$(NODE_PATH) $(GRUNT) sed:bootstrap $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+bootstrap-nix: clean bootstrap-common
+	nix-build default.nix -A build -o nixenv
+	ln -s nixenv/lib/node_modules/mockup/node_modules
+	ln -s nixenv/bower_components
+
+jshint:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) jshint jscs $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+watch:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) watch $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+test:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) test $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js --pattern=$(pattern)
+
+test-once: stamp-bower
+	NODE_PATH=$(NODE_PATH) $(GRUNT) test_once $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js --pattern=$(pattern)
+
+test-dev:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) test_dev $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js --pattern=$(pattern)
+
+test-serve:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) test_serve $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js --pattern=$(pattern)
+
+test-ci:
+	NODE_PATH=$(NODE_PATH) $(GRUNT) test_ci $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
+
+clean:
+	mkdir -p build
+	rm -rf build
+	rm -rf node_modules
+	rm -rf mockup/bower_components
+	rm -f stamp-npm stamp-bower
+	rm -rf node_modules src/bower_components
+
+clean-deep: clean
+	if test -f $(BOWER); then $(BOWER) cache clean; fi
+	if test -f $(NPM); then $(NPM) cache clean; fi
+
+publish-docs:
+	echo -e "Publishing 'docs' bundle!\n"; cd docs; git add -fA .; git commit -m "Travis build $(TRAVIS_BUILD_NUMBER) pushed to 'docs'."; git push -fq https://$(GH_TOKEN)@github.com/plone/mockup.git gh-pages > /dev/null; cd ..;
+
+.PHONY: bundle bundle-widgets bundle-structure bundle-plone docs bootstrap bootstrap-nix jshint test test-once test-dev test-ci publish-docs clean clean-deep
diff --git a/bower.json b/bower.json
new file mode 100644
index 0000000..0f21da1
--- /dev/null
+++ b/bower.json
@@ -0,0 +1,36 @@
+{
+  "name": "mockup",
+  "description": "A collection of client side patterns for faster and easier web development",
+  "dependencies": {
+    "ace-builds": "1.1.7",
+    "backbone": "1.1.2",
+    "backbone.paginator": "0.8.1",
+    "bootstrap": "3.2.0",
+    "console-polyfill": "0.1.2",
+    "dropzone": "3.10.2",
+    "es5-shim": "4.0.3",
+    "jqtree": "0.22.0",
+    "jquery": "1.11.1",
+    "jquery-form": "3.46.0",
+    "jquery.cookie": "1.4.1",
+    "lodash": "2.4.1",
+    "logging": "",
+    "mockup-core": "2.1.5",
+    "moment": "2.8.3",
+    "pickadate": "3.4.0",
+    "requirejs-text": "2.0.12",
+    "select2": "3.5.1",
+    "tinymce-builded": "4.1.6",
+    "patternslib": "2.0.8",
+    "jquery.recurrenceinput.js": "v1.3"
+  },
+  "devDependencies": {
+    "expect": "0.3.1",
+    "sinonjs": "1.10.2"
+  },
+  "resolutions": {
+    "jquery": "1.11.1",
+    "select2": "3.5.1",
+    "patternslib": "2.0.8"
+  }
+}
diff --git a/mockup/Gruntfile.js b/mockup/Gruntfile.js
index b9ee36d..222f27b 100644
--- a/mockup/Gruntfile.js
+++ b/mockup/Gruntfile.js
@@ -1,19 +1,13 @@
-/* Grunt software build task definitions.
- */
-
+// Grunt software build task definitions.
 /* global module:true */
-
-
 module.exports = function(grunt) {
   'use strict';
 
   var MockupGrunt = require('./bower_components/mockup-core/js/grunt'),
       requirejsOptions = require('./js/config'),
-      extend = require('./node_modules/extend/index'),
       mockup = new MockupGrunt(requirejsOptions),
       docsExtraIncludes = [];
 
-
   for (var i = 0; i < mockup.patterns.length; i = i + 1) {
     if (mockup.patterns[i].indexOf('-url') === -1) {
       docsExtraIncludes.push(mockup.patterns[i]);
@@ -21,76 +15,6 @@ module.exports = function(grunt) {
     }
   }
 
-  var copy_tinymce = function (name, path) {
-    var ret = {};
-    ret[name] = {
-      files: [
-        {
-          expand: true, cwd: 'bower_components/tinymce-builded/js/tinymce/langs', src: '*', dest: path + name + '-tinymce/langs'
-        }, {
-          expand: true, cwd: 'bower_components/tinymce-builded/js/tinymce/skins/lightgray/fonts/', src: 'tinymce*', dest: path,
-          rename: function(dest, src) { return dest + name + '-tinymce-font-' + src; }
-        }, {
-          expand: true, cwd: 'bower_components/tinymce-builded/js/tinymce/skins/lightgray/img/', src: '*', dest: path,
-          rename: function(dest, src) { return dest + name + '-tinymce-img-' + src; }
-        }, {
-          expand: true, cwd: 'bower_components/tinymce-builded/js/tinymce/skins/lightgray/', src: 'content.min.css', dest: path,
-          rename: function(dest, src) { return dest + name + '-tinymce-' + src; }
-        }
-      ]
-    };
-    return ret;
-  };
-  var sed_tinymce = function(name, path, url) {
-    var ret = {};
-
-    ret[name + '-tinymce-fonts'] = {
-      path: path + name + '.min.css',
-      pattern: 'url\\(fonts/tinymce',
-      replacement: 'url(' + url + '-tinymce-font-tinymce'
-      //pattern: 'url\\(\'?fonts/tinymce(.*)\'?',  // match urls with and without quotes
-      //replacement: 'url(\'' + url + '-tinymce-font-tinymce$1\''
-    };
-    ret[name + '-tinymce-img-loader'] = {
-      path: path + name + '.min.css',
-      pattern: 'url\\(\'?img/loader.gif\'?',  // match urls with and without quotes
-      replacement: 'url(\'' + url + '-tinymce-img-loader.gif\''
-    };
-    ret[name + '-tinymce-img-anchor'] = {
-      path: path + name + '.min.css',
-      pattern: 'url\\(\'?img/anchor.gif\'?',
-      replacement: 'url(\'' + url + '-tinymce-img-anchor.gif\''
-    };
-    ret[name + '-tinymce-img-object'] = {
-      path: path + name + '.min.css',
-      pattern: 'url\\(\'?img/object.gif\'?',
-      replacement: 'url(\'' + url + '-tinymce-img-object.gif\''
-    };
-
-    ret[name + '-tinymce-fonts2'] = {
-      path: path + name + '-tinymce-content.min.css',
-      pattern: 'url\\(fonts/tinymce',
-      replacement: 'url(' + url + '-tinymce-font-tinymce'
-    };
-    ret[name + '-tinymce-img-loader2'] = {
-      path: path + name + '-tinymce-content.min.css',
-      pattern: 'url\\(\'?img/loader.gif\'?',
-      replacement: 'url(\'' + url + '-tinymce-img-loader.gif\''
-    };
-    ret[name + '-tinymce-img-anchor2'] = {
-      path: path + name + '-tinymce-content.min.css',
-      pattern: 'url\\(\'?img/anchor.gif\'?',
-      replacement: 'url(\'' + url + '-tinymce-img-anchor.gif\''
-    };
-    ret[name + '-tinymce-img-object2'] = {
-      path: path + name + '-tinymce-content.min.css',
-      pattern: 'url\\(\'?img/object.gif\'?',
-      replacement: 'url(\'' + url + '-tinymce-img-object.gif\''
-    };
-    return ret;
-  };
-
-
   mockup.registerBundle('docs', {
     less: {
       options : {
@@ -103,43 +27,37 @@ module.exports = function(grunt) {
       }
     },
     copy: {
-      docs: extend(true,
-        {
-          files: [
-            { expand: true, src: 'index.html', dest: 'docs/dev/' },
-            { expand: true, src: '*.md', dest: 'docs/dev/' },
-            { expand: true, src: 'js/**', dest: 'docs/dev/' },
-            { expand: true, src: 'tests/**', dest: 'docs/dev/' },
-            { expand: true, src: 'lib/**', dest: 'docs/dev/' },
-            { expand: true, src: 'bower_components/**', dest: 'docs/dev/' },
-            { expand: true, src: 'node_modules/requirejs/require.js', dest: 'docs/dev/' },
-            { expand: true, src: 'build/**', dest: 'docs/dev/' },
-            { expand: true, src: 'less/**', dest: 'docs/dev/' }
-          ]
-        },
-        copy_tinymce('docs', 'docs/dev/')
-      )
+      docs: {
+        files: [
+          { expand: true, src: 'index.html', dest: 'docs/dev/' },
+          { expand: true, src: '../*.md', dest: 'docs/dev/' },
+          { expand: true, src: 'js/**', dest: 'docs/dev/' },
+          { expand: true, src: 'tests/**', dest: 'docs/dev/' },
+          { expand: true, src: 'lib/**', dest: 'docs/dev/' },
+          { expand: true, src: 'bower_components/**', dest: 'docs/dev/' },
+          { expand: true, src: '../node_modules/requirejs/require.js', dest: 'docs/dev/' },
+          { expand: true, src: 'build/**', dest: 'docs/dev/' },
+          { expand: true, src: 'less/**', dest: 'docs/dev/' }
+        ]
+      },
     },
-    sed: extend(true,
-      {
-        'docs-css': {
-          path: 'docs/dev/index.html',
-          pattern: 'href="docs/dev/docs.min.css"',
-          replacement: 'href="docs.min.css"'
-        },
-        'docs-js': {
-          path: 'docs/dev/index.html',
-          pattern: '<script src="node_modules/grunt-contrib-less/node_modules/less/dist/less-1.6.1.js"></script>\n  <script src="node_modules/requirejs/require.js"></script>\n  <script src="js/config.js"></script>\n  <script>require\\(\\[\'mockup-bundles-docs\'\\]\\);</script>',
-          replacement: '<script src="docs.min.js"></script>'
-        },
-        'docs-legacy-js': {
-          path: 'docs/dev/index.html',
-          pattern: '<script src="bower_components/es5-shim/es5-shim.js"></script>\n    <script src="bower_components/es5-shim/es5-sham.js"></script>\n    <script src="bower_components/console-polyfill/index.js"></script>',
-          replacement: '<script src="docs-legacy.js"></script>'
-        }
+    sed: {
+      'docs-css': {
+        path: 'docs/dev/index.html',
+        pattern: 'href="docs/dev/docs.min.css"',
+        replacement: 'href="docs.min.css"'
       },
-      sed_tinymce('widgets', 'docs/dev/', '++resource++plone.app.widgets')
-    )
+      'docs-js': {
+        path: 'docs/dev/index.html',
+        pattern: '<script src="node_modules/grunt-contrib-less/node_modules/less/dist/less-1.6.1.js"></script>\n  <script src="node_modules/requirejs/require.js"></script>\n  <script src="js/config.js"></script>\n  <script>require\\(\\[\'mockup-bundles-docs\'\\]\\);</script>',
+        replacement: '<script src="docs.min.js"></script>'
+      },
+      'docs-legacy-js': {
+        path: 'docs/dev/index.html',
+        pattern: '<script src="bower_components/es5-shim/es5-shim.js"></script>\n    <script src="bower_components/es5-shim/es5-sham.js"></script>\n    <script src="bower_components/console-polyfill/index.js"></script>',
+        replacement: '<script src="docs-legacy.js"></script>'
+      }
+    },
   }, {
     path: 'docs/dev/',
     url: 'docs',
@@ -149,20 +67,13 @@ module.exports = function(grunt) {
   mockup.registerBundle('structure', {}, { url: '++resource++wildcard.foldercontents-structure' });
   mockup.registerBundle('filemanager', {}, { url: '++resource++plone.resourceeditor-filemanager' });
   mockup.registerBundle('resourceregistry');
-  mockup.registerBundle('plone', {
-    copy: copy_tinymce('plone', 'build/'),
-    sed: sed_tinymce('plone', 'build/', '++resource++plone')
-  }, {path: 'build/', url: '++resource++plone'});
-  mockup.registerBundle('widgets', {
-    copy: copy_tinymce('widgets', 'build/'),
-    sed: sed_tinymce('widgets', 'build/', '++resource++plone.app.widgets')
-  }, {path: 'build/', url: '++resource++plone.app.widgets'});
-
+  mockup.registerBundle('plone', {}, { path: 'build/', url: '++resource++plone' });
+  mockup.registerBundle('widgets', {}, { path: 'build/', url: '++resource++plone.app.widgets' });
 
   mockup.initGrunt(grunt, {
     sed: {
       bootstrap: {
-        path: 'node_modules/lcov-result-merger/index.js',
+        path: '../node_modules/lcov-result-merger/index.js',
         pattern: 'throw new Error\\(\'Unknown Prefix ',
         replacement: '//throw// new Error(\'Unknown Prefix '
       }
diff --git a/mockup/Makefile b/mockup/Makefile
deleted file mode 100644
index cfd344a..0000000
--- a/mockup/Makefile
+++ /dev/null
@@ -1,119 +0,0 @@
-GIT = git
-NPM = npm
-NODE_VERSION = $(shell node -v)
-NODE_VERSION_MAJ = $(shell echo $(NODE_VERSION) | cut -f1 -d. | cut -f2 -dv )
-NODE_VERSION_MIN = $(shell echo $(NODE_VERSION) | cut -f2 -d.)
-NODE_VERSION_LT_011 = $(shell [ $(NODE_VERSION_MAJ) -eq 0 -a $(NODE_VERSION_MIN) -lt 11 ] && echo true)
-
-GRUNT = ./node_modules/grunt-cli/bin/grunt
-BOWER = ./node_modules/bower/bin/bower
-NODE_PATH = ./node_modules
-
-DEBUG =
-ifeq ($(debug), true)
-	DEBUG = --debug
-endif
-VERBOSE =
-ifeq ($(verbose), true)
-	VERBOSE = --verbose
-endif
-
-
-all: test-once bundles docs
-
-stamp-npm: package.json
-	npm install
-	touch stamp-npm
-
-stamp-bower: stamp-npm bower.json
-	$(BOWER) install
-	touch stamp-bower
-
-bundles: stamp-bower bundle-widgets bundle-structure bundle-plone
-	# ----------------------------------------------------------------------- #
-	# cp build/widgets* path/to/plone.app.widgets/plone/app/widgets/static
-	# cp build/structure* path/to/wildcard.foldercontents/wildcard/foldercontents/static
-	# cp build/plone* path/to/Products.CMFPlone/Products/CMFPlone/static
-	# ----------------------------------------------------------------------- #
-
-bundle-widgets:
-	mkdir -p build
-	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-widgets $(DEBUG) $(VERBOSE)
-
-bundle-structure:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-structure $(DEBUG) $(VERBOSE)
-
-bundle-plone:
-	mkdir -p build
-	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-plone $(DEBUG) $(VERBOSE)
-
-bundle-filemanager:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-filemanager $(DEBUG) $(VERBOSE)
-
-bundle-resourceregistry:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-resourceregistry $(DEBUG) $(VERBOSE)
-
-docs:
-	if test ! -d docs; then $(GIT) clone git://github.com/plone/mockup.git -b gh-pages docs; fi
-	rm -rf docs/dev
-	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-docs $(DEBUG) $(VERBOSE)
-
-bootstrap-common:
-	mkdir -p build
-
-bootstrap: clean bootstrap-common
-	@echo node version: $(NODE_VERSION)
-ifeq ($(NODE_VERSION_LT_011),true)
-	# for node < v0.11.x
-	$(NPM) link --prefix=.
-	# remove lib/node_modules, which contains a symlink to the project root.
-	# This leads to infinite recursion at the grunt copy task on make docs.
-	rm -rf lib/node_modules
-else
-	$(NPM) link
-endif
-	NODE_PATH=$(NODE_PATH) $(BOWER) install --config.interactive=0
-	NODE_PATH=$(NODE_PATH) $(GRUNT) sed:bootstrap $(DEBUG) $(VERBOSE)
-
-bootstrap-nix: clean bootstrap-common
-	nix-build default.nix -A build -o nixenv
-	ln -s nixenv/lib/node_modules/mockup/node_modules
-	ln -s nixenv/bower_components
-
-jshint:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) jshint jscs $(DEBUG) $(VERBOSE)
-
-watch:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) watch $(DEBUG) $(VERBOSE)
-
-test:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) test $(DEBUG) $(VERBOSE) --pattern=$(pattern)
-
-test-once: stamp-bower
-	NODE_PATH=$(NODE_PATH) $(GRUNT) test_once $(DEBUG) $(VERBOSE) --pattern=$(pattern)
-
-test-dev:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) test_dev $(DEBUG) $(VERBOSE) --pattern=$(pattern)
-
-test-serve:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) test_serve $(DEBUG) $(VERBOSE) --pattern=$(pattern)
-
-test-ci:
-	NODE_PATH=$(NODE_PATH) $(GRUNT) test_ci $(DEBUG) $(VERBOSE)
-
-clean:
-	mkdir -p build
-	rm -rf build
-	rm -rf node_modules
-	rm -rf bower_components
-	rm -f stamp-npm stamp-bower
-	rm -rf node_modules src/bower_components
-
-clean-deep: clean
-	if test -f $(BOWER); then $(BOWER) cache clean; fi
-	if test -f $(NPM); then $(NPM) cache clean; fi
-
-publish-docs:
-	echo -e "Publishing 'docs' bundle!\n"; cd docs; git add -fA .; git commit -m "Travis build $(TRAVIS_BUILD_NUMBER) pushed to 'docs'."; git push -fq https://$(GH_TOKEN)@github.com/plone/mockup.git gh-pages > /dev/null; cd ..;
-
-.PHONY: bundle bundle-widgets bundle-structure bundle-plone docs bootstrap bootstrap-nix jshint test test-once test-dev test-ci publish-docs clean clean-deep
diff --git a/mockup/bower.json b/mockup/bower.json
deleted file mode 100644
index 0c5b700..0000000
--- a/mockup/bower.json
+++ /dev/null
@@ -1,35 +0,0 @@
-{
-  "name": "mockup",
-  "description": "A collection of client side patterns for faster and easier web development",
-  "dependencies": {
-    "ace-builds": "1.1.7",
-    "backbone": "1.1.2",
-    "backbone.paginator": "0.8.1",
-    "bootstrap": "3.2.0",
-    "console-polyfill": "0.1.2",
-    "dropzone": "3.10.2",
-    "es5-shim": "4.0.3",
-    "jqtree": "0.22.0",
-    "jquery": "1.11.1",
-    "jquery-form": "3.46.0",
-    "jquery.cookie": "1.4.1",
-    "lodash": "2.4.1",
-    "logging": "",
-    "mockup-core": "2.0.0",
-    "moment": "2.8.3",
-    "pickadate": "3.4.0",
-    "requirejs-text": "2.0.12",
-    "select2": "3.5.1",
-    "tinymce-builded": "4.1.6",
-    "patternslib": "2.0.8"
-  },
-  "devDependencies": {
-    "expect": "0.3.1",
-    "sinonjs": "1.10.2"
-  },
-  "resolutions": {
-    "jquery": "1.11.1",
-    "select2": "3.5.1",
-    "patternslib": "2.0.8"
-  }
-}
diff --git a/mockup/index.html b/mockup/index.html
index ff52446..76d2d39 100644
--- a/mockup/index.html
+++ b/mockup/index.html
@@ -20,14 +20,14 @@
   <![endif]-->
 
   <script src="node_modules/requirejs/require.js"></script>
-  <script src="js/config.js"></script>
+  <script src="mockup/js/config.js"></script>
   <script>
     window.DEBUG = true;
     require(['mockup-bundles-docs']);
   </script>
 </head>
 
-<body data-i18ncatalogurl="/tests/json/i18n.json">
+<body data-i18ncatalogurl="/mockup/tests/json/i18n.json">
 </body>
 
 </html>
diff --git a/mockup/js/bundles/docs.js b/mockup/js/bundles/docs.js
index 84964bf..eaae54b 100644
--- a/mockup/js/bundles/docs.js
+++ b/mockup/js/bundles/docs.js
@@ -176,6 +176,21 @@ require([
             title: 'Event Edit Forms',
             description: 'Start/End delta, validation whole day and open end handling',
             url: 'patterns/eventedit/pattern.js'
+          },
+          { id: 'livesearch',
+            title: 'Live search',
+            description: 'Live search widget',
+            url: 'patterns/livesearch/pattern.js'
+          },
+          { id: 'contentloader',
+            title: 'Content Loader',
+            description: 'Dynamically configure content to be reloaded',
+            url: 'patterns/contentloader/pattern.js'
+          },
+          { id: 'recurrence',
+            title: 'Recurrence Widget',
+            description: 'Recurrence widget',
+            url: 'patterns/recurrence/pattern.js'
           }
         ]
       },
diff --git a/mockup/js/bundles/filemanager.js b/mockup/js/bundles/filemanager.js
index 4a224f2..f568a84 100644
--- a/mockup/js/bundles/filemanager.js
+++ b/mockup/js/bundles/filemanager.js
@@ -3,13 +3,12 @@ define([
   'pat-registry',
   'mockup-patterns-base',
   'mockup-patterns-filemanager'
-], function($, Registry, Base) {
+], function($, registry, Base) {
   'use strict';
-
   // initialize only if we are in top frame
   if (window.parent === window) {
-    $(document).ready(function() {
-      Registry.scan($('body'));
-    });
+    if (!registry.initialized) {
+      registry.init();
+    }
   }
 });
diff --git a/mockup/js/bundles/plone.js b/mockup/js/bundles/plone.js
index 9b83092..adc7f61 100644
--- a/mockup/js/bundles/plone.js
+++ b/mockup/js/bundles/plone.js
@@ -20,7 +20,7 @@ define([
   'bootstrap-dropdown',
   'bootstrap-collapse',
   'bootstrap-tooltip'
-], function($, Registry, Base) {
+], function($, registry, Base) {
   'use strict';
 
   // BBB: we need to hook pattern to classes which plone was using until now
@@ -28,18 +28,17 @@ define([
     name: 'plone',
     init: function() {
       var self = this;
-
     }
-
   });
 
   // initialize only if we are in top frame
   if (window.parent === window) {
     $(document).ready(function() {
       $('body').addClass('pat-plone');
-      Registry.scan($('body'));
+      if (!registry.initialized) {
+        registry.init();
+      }
     });
   }
-
   return Plone;
 });
diff --git a/mockup/js/bundles/resourceregistry.js b/mockup/js/bundles/resourceregistry.js
index 59fe3c9..478c327 100644
--- a/mockup/js/bundles/resourceregistry.js
+++ b/mockup/js/bundles/resourceregistry.js
@@ -2,12 +2,9 @@ define([
   'jquery',
   'pat-registry',
   'mockup-patterns-resourceregistry',
-], function($, Registry) {
+], function($, registry, resource_registry) {
   'use strict';
-
-  $(document).ready(function() {
-    var $registry = $('.pat-resourceregistry');
-    Registry.scan($registry);
-  });
-
+  if (!registry.initialized) {
+    registry.init();
+  }
 });
diff --git a/mockup/js/bundles/widgets.js b/mockup/js/bundles/widgets.js
index 0b14984..93a5092 100644
--- a/mockup/js/bundles/widgets.js
+++ b/mockup/js/bundles/widgets.js
@@ -2,14 +2,16 @@ define([
   'jquery',
   'pat-registry',
   'mockup-patterns-base',
+
   'mockup-patterns-select2',
   'mockup-patterns-passwordstrength',
   'mockup-patterns-pickadate',
+  'mockup-patterns-recurrence',
   'mockup-patterns-relateditems',
   'mockup-patterns-querystring',
   'mockup-patterns-textareamimetypeselector',
   'mockup-patterns-tinymce'
-], function($, Registry, Base) {
+], function($, registry, Base) {
   'use strict';
 
   var PloneWidgets = Base.extend({
@@ -23,9 +25,10 @@ define([
   if (window.parent === window) {
     $(document).ready(function() {
       $('body').addClass('pat-plone-widgets');
-      Registry.scan($('body'));
+      if (!registry.initialized) {
+        registry.init();
+      }
     });
   }
-
   return PloneWidgets;
 });
diff --git a/mockup/js/config.js b/mockup/js/config.js
index 5375d9b..0d5be06 100644
--- a/mockup/js/config.js
+++ b/mockup/js/config.js
@@ -44,6 +44,10 @@
       'jquery.event.drag': 'lib/jquery.event.drag',
       'jquery.event.drop': 'lib/jquery.event.drop',
       'jquery.form': 'bower_components/jquery-form/jquery.form',
+      'jquery.recurrenceinput': 'bower_components/jquery.recurrenceinput.js/src/jquery.recurrenceinput',
+      'jquery.tools.dateinput': 'bower_components/jquery.recurrenceinput.js/lib/jquery.tools.dateinput',
+      'jquery.tools.overlay': 'bower_components/jquery.recurrenceinput.js/lib/jquery.tools.overlay',
+      'jquery.tmpl': 'bower_components/jquery.recurrenceinput.js/lib/jquery.tmpl',
       'translate': 'js/i18n-wrapper',
       'marked': 'bower_components/marked/lib/marked',
       'mockup-bundles-docs': 'js/bundles/docs',
@@ -65,6 +69,7 @@
       'mockup-patterns-autotoc': 'patterns/autotoc/pattern',
       'mockup-patterns-backdrop': 'patterns/backdrop/pattern',
       'mockup-patterns-base': 'bower_components/mockup-core/js/pattern',
+      'mockup-patterns-contentloader': 'patterns/contentloader/pattern', 
       'mockup-patterns-cookietrigger': 'patterns/cookietrigger/pattern',
       'mockup-patterns-eventedit': 'patterns/eventedit/pattern',
       'mockup-patterns-filemanager': 'patterns/filemanager/pattern',
@@ -79,6 +84,7 @@
       'mockup-patterns-preventdoublesubmit': 'patterns/preventdoublesubmit/pattern',
       'mockup-patterns-querystring': 'patterns/querystring/pattern',
       'mockup-patterns-relateditems': 'patterns/relateditems/pattern',
+      'mockup-patterns-recurrence': 'patterns/recurrence/pattern',
       'mockup-patterns-resourceregistry': 'patterns/resourceregistry/pattern',
       'mockup-patterns-resourceregistry-url': 'patterns/resourceregistry',
       'mockup-patterns-select2': 'patterns/select2/pattern',
@@ -99,7 +105,7 @@
       'mockup-patterns-upload-url': 'patterns/upload',
       'mockup-patterns-passwordstrength': 'patterns/passwordstrength/pattern',
       'mockup-patterns-passwordstrength-url': 'patterns/passwordstrength',
-      'mockup-registry': 'bower_components/mockup-core/js/registry',
+      'mockup-patterns-livesearch': 'patterns/livesearch/pattern',
       'mockup-router': 'js/router',
       'mockup-ui-url': 'js/ui',
       'mockup-utils': 'js/utils',
@@ -116,13 +122,12 @@
       'underscore': 'bower_components/lodash/dist/lodash.underscore',
 
       // Patternslib
-      "pat-compat": "bower_components/patternslib/src/core/compat",
-      "pat-jquery-ext": "bower_components/patternslib/src/core/jquery-ext",
-      "pat-logger": "bower_components/patternslib/src/core/logger",
-      "pat-parser": "bower_components/patternslib/src/core/parser",
-      "pat-registry": "bower_components/patternslib/src/core/registry",
-      "pat-utils": "bower_components/patternslib/src/core/utils",
-      "logging": "bower_components/logging/src/logging"
+      'pat-compat': 'bower_components/patternslib/src/core/compat',
+      'pat-jquery-ext': 'bower_components/patternslib/src/core/jquery-ext',
+      'pat-logger': 'bower_components/patternslib/src/core/logger',
+      'pat-registry': 'bower_components/patternslib/src/core/registry',
+      'pat-utils': 'bower_components/patternslib/src/core/utils',
+      'logging': 'bower_components/logging/src/logging'
     },
     shim: {
       'JSXTransformer': { exports: 'window.JSXTransformer' },
@@ -149,7 +154,18 @@
         }
       },
       'tinymce-modern-theme': { deps: ['tinymce'] },
-      'underscore': { exports: 'window._' }
+      'underscore': { exports: 'window._' },
+      'jquery.recurrenceinput': {
+        deps: [
+          'jquery',
+          'jquery.tools.overlay',
+          'jquery.tools.dateinput',
+          'jquery.tmpl'
+        ]
+      },
+      'jquery.tools.dateinput': { deps: ['jquery'] },
+      'jquery.tools.overlay': { deps: ['jquery'] },
+      'jquery.tmpl': { deps: ['jquery'] }
     },
     wrapShim: true
   };
diff --git a/mockup/js/ui/views/base.js b/mockup/js/ui/views/base.js
index 188300a..ba490f0 100644
--- a/mockup/js/ui/views/base.js
+++ b/mockup/js/ui/views/base.js
@@ -1,8 +1,9 @@
 define([
   'jquery',
   'underscore',
-  'backbone'
-], function($, _, Backbone) {
+  'backbone',
+  'translate'
+], function($, _, Backbone, _t) {
   'use strict';
 
   var BaseView = Backbone.View.extend({
@@ -36,7 +37,7 @@ define([
     },
     applyTemplate: function() {
       if (this.template !== null) {
-        var data = $.extend({}, this.options, this.serializedModel());
+        var data = $.extend({_t: _t}, this.options, this.serializedModel());
         var template = this.template;
         if(typeof(template) === 'string'){
           template = _.template(template);
diff --git a/mockup/less/base.less b/mockup/less/base.less
index 9172905..e18f05b 100644
--- a/mockup/less/base.less
+++ b/mockup/less/base.less
@@ -6,6 +6,7 @@
 @import (reference) "@{bowerPath}/bootstrap/less/buttons.less";
 @import (reference) "@{bowerPath}/bootstrap/less/button-groups.less";
 @import (reference) "@{bowerPath}/bootstrap/less/progress-bars.less";
+@import (reference) "@{bowerPath}/bootstrap/less/close.less";
 
 
 /* buttons */
@@ -22,9 +23,19 @@
 .plone-btn-danger{ .btn-danger() }
 .plone-btn-link{ .btn-link() }
 
-.plone-btn-group { .btn-group() }
+.plone-btn-group {
+  .plone-btn + .plone-btn,
+  .plone-btn + .plone-btn-group,
+  .plone-btn-group + .plone-btn,
+  .plone-btn-group + .plone-btn-group {
+    margin-left: -1px;
+  }
+}
+
 .plone-btn-block { .btn-block() }
 
+.plone-close { .close() }
+
 
 /* modals */
 .plone-modal{ .modal() }
diff --git a/mockup/less/docs.less b/mockup/less/docs.less
index fc66ac6..5e557c5 100644
--- a/mockup/less/docs.less
+++ b/mockup/less/docs.less
@@ -23,5 +23,7 @@
 @import "../patterns/filemanager/pattern.filemanager.less";
 @import "../patterns/thememapper/pattern.thememapper.less";
 @import "../patterns/resourceregistry/pattern.resourceregistry.less";
+@import "../patterns/livesearch/pattern.livesearch.less";
+@import "../patterns/recurrence/pattern.recurrence.less";
 
 @import "@{bowerPath}/mockup-core/less/docs.less";
diff --git a/mockup/less/structure.less b/mockup/less/structure.less
index 2d04d4b..ed8d1ee 100644
--- a/mockup/less/structure.less
+++ b/mockup/less/structure.less
@@ -9,7 +9,6 @@
 @import "../patterns/querystring/pattern.querystring.less";
 @import "../patterns/structure/less/pattern.structure.less";
 
-@import "@{bowerPath}/bootstrap/less/bootstrap.less";
 @icon-font-path: "@{pathPrefix}../bower_components/bootstrap/dist/fonts/";
 
 .modal.fade.in>.modal-dialog {
diff --git a/mockup/node_modules b/mockup/node_modules
new file mode 120000
index 0000000..68a084a
--- /dev/null
+++ b/mockup/node_modules
@@ -0,0 +1 @@
+../node_modules
\ No newline at end of file
diff --git a/mockup/package.json b/mockup/package.json
deleted file mode 100644
index 7c2c5f7..0000000
--- a/mockup/package.json
+++ /dev/null
@@ -1,60 +0,0 @@
-{
-  "name": "mockup",
-  "version": "2.0.0",
-  "description": "A collection of client side patterns for faster and easier web development",
-  "homepage": "http://plone.github.io/mockup",
-  "devDependencies": {
-    "bower": "~1.3.2",
-    "chai": "^1.10.0",
-    "coveralls": "~2.10.0",
-    "extend": "~1.2.1",
-    "grunt": "~0.4.4",
-    "grunt-cli": "~0.1.13",
-    "grunt-contrib-copy": "~0.5.0",
-    "grunt-contrib-jshint": "~0.10.0",
-    "grunt-contrib-less": "~0.11.0",
-    "grunt-contrib-requirejs": "~0.4.3",
-    "grunt-contrib-uglify": "~0.4.0",
-    "grunt-contrib-watch": "~0.6.1",
-    "grunt-karma": "~0.8.2",
-    "grunt-sed": "~0.1.1",
-    "karma": "~0.12.9",
-    "karma-chai": "^0.1.0",
-    "karma-chrome-launcher": "~0.1.3",
-    "karma-coverage": "~0.2.1",
-    "karma-firefox-launcher": "~0.1.4",
-    "karma-junit-reporter": "~0.2.2",
-    "karma-mocha": "~0.1.3",
-    "karma-phantomjs-launcher": "~0.1.4",
-    "karma-requirejs": "~0.2.1",
-    "karma-sauce-launcher": "~0.2.10",
-    "karma-script-launcher": "~0.1.0",
-    "karma-spec-reporter": "0.0.16",
-    "lcov-result-merger": "~0.0.2",
-    "less": "~1.7.0",
-    "mocha": "~1.18.2",
-    "phantomjs": "^1.9.13",
-    "requirejs": "~2.1.11"
-  },
-  "maintainers": [
-    {
-      "name": "Plone Foundation",
-      "email": "plone-developers@lists.sourceforge.net",
-      "url": "http://plone.org"
-    }
-  ],
-  "repository": {
-    "type": "git",
-    "url": "https://github.com/plone/mockup.git"
-  },
-  "bugs": {
-    "url": "https://github.com/plone/mockup/issues",
-    "email": "plone-developers@lists.sourceforge.net"
-  },
-  "licenses": [
-    {
-      "type": "BSD",
-      "url": "http://opensource.org/licenses/BSD-3-Clause"
-    }
-  ]
-}
diff --git a/mockup/patterns/contentloader/pattern.js b/mockup/patterns/contentloader/pattern.js
new file mode 100644
index 0000000..10670fd
--- /dev/null
+++ b/mockup/patterns/contentloader/pattern.js
@@ -0,0 +1,137 @@
+/* Content loader pattern.
+ *
+ * Options:
+ *    url(string): To load content from remote resource. Use 'el' to use with anchor tag href.
+ *    content(string): CSS selector for content already on page. Can be used in conjunction with url to load remote content on page.
+ *    trigger(string): Event to trigger content loading. Defaults to "click"
+ *    target(string): CSS selector of target for content loading. If this is empty, it's assume content will replace pattern element.
+ *
+ * Documentation:
+ *    # With selector
+ *    {{ example-1 }}
+ *
+ *    # With remote content
+ *    {{ example-2 }}
+ *
+ * Example: example-1
+ *    <a href="#" class="pat-contentloader" data-pat-contentloader="content:#clexample1;target:#clexample1target;">Load content</a>
+ *    <div id="clexample1target">Original Content</div>
+ *    <div id="clexample1" style="display:none">Replaced Content</div>
+ *
+ * Example: example-2
+ *    <a href="#" class="pat-contentloader" data-pat-contentloader="url:something.html;">Load content</a>
+ *
+ *
+ */
+
+
+define([
+  'jquery',
+  'mockup-patterns-base',
+  'pat-logger',
+  'pat-registry',
+  'mockup-utils',
+  'underscore'
+], function($, Base, logger, Registry, utils, _) {
+  'use strict';
+  var log = logger.getLogger('pat-contentloader');
+
+  var ContentLoader = Base.extend({
+    name: 'contentloader',
+    trigger: '.pat-contentloader',
+    defaults: {
+      url: null,
+      content: null,
+      trigger: 'click',
+      target: null,
+      template: null,
+      dataType: 'html'
+    },
+    init: function() {
+      var that = this;
+      if(that.options.url === 'el' && that.$el[0].tagName === 'A'){
+        that.options.url = that.$el.attr('href');
+      }
+      if(that.options.trigger === 'immediate'){
+        that._load();
+      }else{
+        that.$el.on(that.options.trigger, function(e){
+          e.preventDefault();
+          that._load();
+        });
+      }
+    },
+    _load: function(){
+      var that = this;
+      that.$el.addClass('loading-content');
+      if(that.options.url){
+        that.loadRemote();
+      }else{
+        that.loadLocal();
+      }
+    },
+    loadRemote: function(){
+      var that = this;
+      $.ajax({
+        url: that.options.url,
+        dataType: that.options.dataType,
+        success: function(data){
+          var $el;
+          if(that.options.dataType === 'html'){
+            if(data.indexOf('<html') !== -1){
+              data = utils.parseBodyTag(data);
+            }
+            $el = $(data);
+          }else if(that.options.dataType.indexOf('json') !== -1){
+            // must have template defined with json
+            if(data.constructor === Array && data.length === 1){
+              // normalize json if it makes sense since some json returns as array with one item
+              data = data[0];
+            }
+            try{
+              $el = $(_.template(that.options.template, data));
+            }catch(e){
+              // log this
+              log.warn('error rendering template. pat-contentloader will not work');
+              return;
+            }
+          }
+          if(that.options.content !== null){
+            $el = $el.find(that.options.content);
+          }
+          that.loadLocal($el);
+          that.$el.removeClass('loading-content');
+        },
+        error: function(){
+          that.$el.addClass('content-load-error');
+        }
+      });
+    },
+    loadLocal: function($content){
+      var that = this;
+      if(!$content && that.options.content === null){
+        log.warn('No selector configured');
+        return;
+      }
+      var $target = that.$el;
+      if(that.options.target !== null){
+        $target = $(that.options.target);
+        if($target.size() === 0){
+          log.warn('No target nodes found');
+          return;
+        }
+      }
+
+      if(!$content){
+        $content = $(that.options.content).clone();
+      }
+      $content.show();
+      $target.replaceWith($content);
+      Registry.scan($content);
+      that.$el.removeClass('loading-content');
+    }
+  });
+
+  return ContentLoader;
+
+});
diff --git a/mockup/patterns/filemanager/pattern.filemanager.less b/mockup/patterns/filemanager/pattern.filemanager.less
index 1372c8c..477ca66 100644
--- a/mockup/patterns/filemanager/pattern.filemanager.less
+++ b/mockup/patterns/filemanager/pattern.filemanager.less
@@ -1,6 +1,73 @@
+@import "@{mockuplessPath}/ui.less";
+@import "@{mockupPath}/tree/pattern.tree.less";
 @import "@{mockuplessPath}/popover.less";
 
+@import "@{bowerPath}/bootstrap/less/mixins.less";
+@import "@{bowerPath}bootstrap/less/utilities.less";
+@import (reference) "@{bowerPath}/bootstrap/less/buttons.less";
+@import (reference) "@{bowerPath}/bootstrap/less/button-groups.less";
+@import (reference) "@{bowerPath}/bootstrap/less/badges.less";
+@import (reference) "@{bowerPath}/bootstrap/less/popovers.less";
+@import (reference) "@{bowerPath}/bootstrap/less/pagination.less";
+@import (reference) "@{bowerPath}/bootstrap/less/input-groups.less";
+@import (reference) "@{bowerPath}/bootstrap/less/tables.less";
+@import (reference) "@{bowerPath}/bootstrap/less/dropdowns.less";
+@import (reference) "@{bowerPath}/bootstrap/less/forms.less";
+@import (reference) "@{bowerPath}/bootstrap/less/navbar.less";
+@import (reference) "@{bowerPath}/bootstrap/less/navs.less";
+@import (reference) "@{bowerPath}/bootstrap/less/tooltip.less";
+@import (reference) "@{bowerPath}/bootstrap/less/component-animations.less";
+@import (reference) "@{mockuplessPath}/popover.less";
+
+
 .pat-filemanager {
+    .fade:extend(.fade all){}
+    .collapse:extend(.collapse all){}
+    .collapsing:extend(.collapsing all){}
+
+    .popover:extend(.popover all){}
+    .popover-title:extend(.popover-title all){}
+    .popover-content:extend(.popover-content all){}
+    .arrow:extend(.arrow all){}
+    .tooltip:extend(.tooltip all){}
+    .tooltip-arrow:extend(.tooltip-arrow all){}
+    .tooltip-inner:extend(.tooltip-inner all){}
+
+    .table:extend(.table all){}
+    .pagination:extend(.pagination all){}
+
+    .btn:extend(.btn all){}
+    .btn-default:extend(.btn-default all){}
+    .btn-danger:extend(.btn-danger all){}
+    .btn-primary:extend(.btn-primary all){}
+    .btn-group:extend(.btn-group all){}
+    .btn-success:extend(.btn-success all){}
+    .input-group:extend(.input-group all){}
+    .input-group-addon:extend(.input-group-addon all){}
+    .input-group-btn:extend(.input-group-btn all){}
+    .dropdown-menu:extend(.dropdown-menu all){}
+    .dropdown-toggle:extend(.dropdown-toggle all){}
+    .dropdown-header:extend(.dropdown-header all){}
+    .divider:extend(.divider all){}
+
+    .table-striped:extend(.table-striped all){}
+    .table-bordered:extend(.table-bordered all){}
+
+    .nav:extend(.nav all){}
+    .navbar-nav:extend(.navbar-nav all){}
+    .navbar:extend(.navbar all){}
+    .navbar-search:extend(.navbar-search all){}
+    .navbar-collapse:extend(.navbar-collapse all){}
+
+    .form-search:extend(.form-search all){}
+    .ui-offset-parent:extend(.ui-offset-parent all){}
+
+    .form-group:extend(.form-group all){}
+    .help-block:extend(.help-block all){}
+    .checkbox:extend(.checkbox all){}
+
+    .open:extend(.open all){}
+
     #fileselector li label {
         display: inline;
     }
@@ -26,13 +93,19 @@
     .tree {
         float: left;
         width: 17%;
+        word-wrap: break-word;
+        font-size: 0.8em;
+        margin-top: 2.5em;
         ul.jqtree-tree li.jqtree-selected > .jqtree-element, ul.jqtree-tree li.jqtree-selected > .jqtree-element:hover {
         background: #E7E7E7;
         }
         ul.jqtree-tree {
             margin-left: 0px;
-            li span {
-            padding-left: 12px;
+            li.jqtree_common {
+                margin-bottom: 0.2em;
+            }
+            .jqtree-title {
+                margin-left: 0em;
             }
         }
     }
diff --git a/mockup/patterns/livesearch/pattern.js b/mockup/patterns/livesearch/pattern.js
new file mode 100644
index 0000000..4203ab6
--- /dev/null
+++ b/mockup/patterns/livesearch/pattern.js
@@ -0,0 +1,249 @@
+/* Livesearch
+ *
+ * Options:
+ *    ajaxUrl(string): JSON search url
+ *    perPage(integer): results per page, defaults to 7
+ *    quietMillis: how long to wait after type stops before sending out request in milliseconds. Defaults to 350
+ *    minimumInputLength: miniumum number of letters before doing search. Defaults to 3
+ *    inputSelector: css select to input element search is done with. Defaults to input[type="text"]
+ *    itemTemplate: override template used to render item results
+ *
+ * Documentation:
+ *   # General
+ *
+ *   # Default
+ *
+ *   {{ example-1 }}
+ *
+ * Example: example-1
+ *    <form action="search" class="pat-livesearch" data-pat-livesearch="ajaxUrl:livesearch.json">
+ *      <input type="text" />
+ *    </form>
+ *
+ */
+
+define([
+  'jquery',
+  'mockup-patterns-base',
+  'underscore',
+  'translate'
+], function ($, Base, _, _t){
+  'use strict';
+
+  var Livesearch = Base.extend({
+    name: 'livesearch',
+    trigger: '.pat-livesearch',
+    timeout: null,
+    active: false,
+    results: null,
+    selectedItem: -1,
+    resultsClass: 'livesearch-results',
+    defaults: {
+      ajaxUrl: null,
+      perPage: 7,
+      quietMillis: 350,
+      minimumInputLength: 4,
+      inputSelector: 'input[type="text"]',
+      itemTemplate: '<li class="search-result <%- state %>">' +
+        '<h4 class="title"><a href="<%- url %>"><%- title %></a></h4>' +
+        '<p class="description"><%- description %></p>' +
+      '</li>',
+    },
+    doSearch: function(page){
+      var self = this;
+      self.active = true;
+      self.render();
+      self.$el.addClass('searching');
+      var query = self.$el.serialize();
+      if(page === undefined){
+        page = 1;
+      }
+      $.ajax({
+        url: self.options.ajaxUrl + '?' + query +
+             '&page=' + page +
+             '&perPage=' + self.options.perPage,
+        dataType: 'json'
+      }).done(function(data){
+        self.results = data;
+        self.page = page;
+        // maybe odd here.. but we're checking to see if the user
+        // has typed while a search was being performed. Perhap another search if so
+        if(query !== self.$el.serialize()){
+          self.doSearch();
+        }
+      }).fail(function(){
+        self.results = {
+          items: [{
+            url: '',
+            title: _t('Error'),
+            description: _t('There was an error searching'),
+            state: 'error',
+            error: false
+          }],
+          total: 1
+        };
+        self.page = 1;
+      }).always(function(){
+        self.active = false;
+        self.selectedItem = -1;
+        self.$el.removeClass('searching');
+        self.render();
+      });
+    },
+    render: function(){
+      var self = this;
+      self.$results.empty();
+
+      /* find a status message */
+
+      if(self.active){
+        self.$results.append($('<li class="searching">' + _t('searching') + '</li>'));
+      }else if(self.results === null){
+        // no results gathered yet
+        self.$results.append($('<li class="no-results no-search">' + _t('enter search phrase') + '</li>'));
+      } else if(self.results.total === 0){
+        self.$results.append($('<li class="no-results">' + _t('no results found') + '</li>'));
+      } else{
+        self.$results.append($('<li class="results-summary">' + _t('found') +
+                               ' ' + self.results.total + ' ' + _t('results') + '</li>'));
+      }
+
+      if(self.results !== null){
+        var template = _.template(self.options.itemTemplate);
+        _.each(self.results.items, function(item, index){
+          var $el = $(template($.extend({_t: _t}, item)));
+          $el.attr('data-url', item.url).on('click', function(){
+            if(!item.error){
+              window.location = item.url;
+            }
+          });
+          if(index === self.selectedItem){
+            $el.addClass('selected');
+          }
+          self.$results.append($el);
+        });
+        var nav = [];
+        if(self.page > 1){
+          var $prev = $('<a href="#" class="prev">' + _t('Previous') + '</a>');
+          $prev.click(function(e){
+            self.disableHiding = true;
+            e.preventDefault();
+            self.doSearch(self.page - 1);
+          });
+          nav.push($prev);
+        }
+        if((self.page * self.options.perPage) < self.results.total){
+          var $next = $('<a href="#" class="next">' + _t('Next') + '</a>');
+          $next.click(function(e){
+            self.disableHiding = true;
+            e.preventDefault();
+            self.doSearch(self.page + 1);
+          });
+          nav.push($next);
+        }
+        if(nav.length > 0){
+          var $li = $('<li class="load-more"><div class="page">' + self.page + '</div></li>');
+          $li.prepend(nav);
+          self.$results.append($li);
+        }
+      }
+      self.position();
+    },
+    position: function(){
+      /* we are positioning directly below the
+         input box, same width */
+      var self = this;
+
+      self.$el.addClass('livesearch-active');
+      var pos = self.$input.position();
+      self.$results.width(self.$input.outerWidth());
+      self.$results.css({
+        top: pos.top + self.$input.outerHeight(),
+        left: pos.left
+      });
+      self.$results.show();
+    },
+    hide: function(){
+      this.$results.hide();
+      this.$el.removeClass('livesearch-active');
+    },
+    init: function(){
+      var self = this;
+      self.$input = self.$el.find(self.options.inputSelector);
+      self.$input.off('focusout').on('focusout', function(){
+        /* we put this in a timer so click events still
+           get trigger on search results */
+        setTimeout(function(){
+          /* hack, look above, to handle dealing with clicks
+             unfocusing element */
+          if(!self.disableHiding){
+            self.hide();
+          }else{
+            self.disableHiding = false;
+            // and refocus elemtn
+            self.$input.focus();
+          }
+        }, 200);
+      }).off('focusin').on('focusin', function(){
+        if(!self.onceFocused){
+          /* Case: field already filled out but no reasons
+             present yet, do ajax search and grab some results */
+          self.onceFocused = true;
+          if(self.$input.val().length >= self.options.minimumInputLength){
+            self.doSearch();
+          }
+        } else if(!self.$results.is(':visible')){
+          self.render();
+        }
+      }).attr('autocomplete', 'off').off('keyup').on('keyup', function(e){
+        // first off, we're capturing up, down and enter key presses
+        if(self.results && self.results.items && self.results.items.length > 0){
+          var code = e.keyCode || e.which;
+          if(code === 13){
+            /* enter key, check to see if there is a selected item */
+            if(self.selectedItem !== -1){
+              window.location = self.results.items[self.selectedItem].url;
+            }
+            return;
+          } else if(code === 38){
+            /* up key */
+            if(self.selectedItem !== -1){
+              self.selectedItem -= 1;
+              self.render();
+            }
+            return;
+          } else if(code === 40){
+            /* down key */
+            if(self.selectedItem < self.results.items.length){
+              self.selectedItem += 1;
+              self.render();
+            }
+            return;
+          }
+        }
+
+        /* then, we handle timeouts for doing ajax search */
+        if(self.timeout !== null){
+          clearTimeout(self.timeout);
+          self.timeout = null;
+        }
+        if(self.active){
+          return;
+        }
+        if(self.$input.val().length >= self.options.minimumInputLength){
+          self.timeout = setTimeout(function(){
+            self.doSearch();
+          }, self.options.quietMillis);
+        }else{
+          self.results = null;
+          self.render();
+        }
+      });
+
+      /* create result dom */
+      self.$results = $('<ul class="' + self.resultsClass + '"></ul>').hide().insertAfter(self.$input);
+    }
+  });
+
+  return Livesearch;
+});
diff --git a/mockup/patterns/livesearch/pattern.livesearch.less b/mockup/patterns/livesearch/pattern.livesearch.less
new file mode 100644
index 0000000..01d7c3f
--- /dev/null
+++ b/mockup/patterns/livesearch/pattern.livesearch.less
@@ -0,0 +1,44 @@
+.pat-livesearch{
+    min-width: 230px;
+    position:relative;
+
+    .livesearch-results{
+        display:none;
+        position: absolute;
+        background-color: #ffffff;
+        z-index: 100;
+
+        border-right: 1px solid #64bee8;
+        border-bottom: 1px solid #64bee8;
+        border-left: 1px solid #64bee8;
+        outline: 0;
+        -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(100, 190, 232, 0.6);
+        box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(100, 190, 232, 0.6);
+        -moz-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(100, 190, 232, 0.6);
+
+        margin: 0;
+        padding: 0;
+        list-style: none;
+
+        li{
+            margin: 0;
+            padding: 5px;
+            cursor: pointer;
+
+            &.load-more{
+                .next{
+                    float: right;
+                }
+                .prev{
+                    float: left;
+                }
+                .page{
+                    text-align: center;
+                }
+            }
+        }
+        li:hover,li.selected{
+            background-color: #e6e4e4;
+        }
+    }
+}
\ No newline at end of file
diff --git a/mockup/patterns/modal/pattern.modal.less b/mockup/patterns/modal/pattern.modal.less
index 8d6fe05..8c21619 100644
--- a/mockup/patterns/modal/pattern.modal.less
+++ b/mockup/patterns/modal/pattern.modal.less
@@ -1,6 +1,5 @@
 @import "@{mockuplessPath}/base.less";
 
-
 .plone-modal-loading {
   .plone-progress-bar();
   .progress.active .progress-bar();
@@ -69,7 +68,12 @@ transition: opacity .5s linear;
     margin: 30px auto;
   }
 }
-.plone-modal-content {  background: #fff; overflow: hidden;}
+.plone-modal-content {
+  background: #fff;
+  /* XXX this is necessary for some content inside modals
+     to behave properly */
+  overflow: inherit;
+}
 .plone-modal-body {padding: 15px; position: relative;}
 .plone-modal-footer { text-align: right; border-top: 1px solid #e5e5e5; padding: 15px;}
 
diff --git a/mockup/patterns/recurrence/pattern.js b/mockup/patterns/recurrence/pattern.js
new file mode 100644
index 0000000..b77d1d7
--- /dev/null
+++ b/mockup/patterns/recurrence/pattern.js
@@ -0,0 +1,47 @@
+/* Recurrence pattern.
+ *
+ * Options:
+ *    localization(object): Customizations to locatizations. Default to null
+ *    configuration(object): recurrent input widget configuration
+ *
+ * Documentation:
+ *
+ *    # Simple
+ *
+ *    {{ example-1 }}
+ *
+ * Example: example-1
+ *    <textarea class="pat-recurrence"></textarea>
+ *
+ *
+ */
+
+
+define([
+  'jquery',
+  'mockup-patterns-base',
+  'jquery.recurrenceinput'
+], function($, Base) {
+  'use strict';
+
+  var Recurrence = Base.extend({
+    name: 'recurrence',
+    trigger: '.pat-recurrence',
+    defaults: {
+      // just passed onto the widget
+      language: 'en',
+      localization: null,
+      configuration: {}
+    },
+    init: function() {
+      this.$el.addClass('recurrence-widget');
+      if(this.options.localization){
+        $.tools.recurrenceinput.localize(this.options.language, this.options.localization);
+      }
+      this.$el.recurrenceinput(this.options.configuration);
+    }
+  });
+
+  return Recurrence;
+
+});
diff --git a/mockup/patterns/recurrence/pattern.recurrence.less b/mockup/patterns/recurrence/pattern.recurrence.less
new file mode 100644
index 0000000..796bac2
--- /dev/null
+++ b/mockup/patterns/recurrence/pattern.recurrence.less
@@ -0,0 +1,3 @@
+@import (inline) "@{bowerPath}/jquery.recurrenceinput.js/lib/jquery.tools.dateinput.css";
+@import (inline) "@{bowerPath}/jquery.recurrenceinput.js/lib/jquery.tools.overlay.css";
+@import (less) "@{bowerPath}/jquery.recurrenceinput.js/src/jquery.recurrenceinput.css";
diff --git a/mockup/patterns/relateditems/pattern.js b/mockup/patterns/relateditems/pattern.js
index 2bb697f..c401c28 100644
--- a/mockup/patterns/relateditems/pattern.js
+++ b/mockup/patterns/relateditems/pattern.js
@@ -102,12 +102,13 @@ define([
       homeText: _t('home'),
       folderTypes: ['Folder'],
       selectableTypes: null, // null means everything is selectable, otherwise a list of strings to match types that are selectable
-      attributes: ['UID', 'Title', 'Type', 'path'],
+      attributes: ['UID', 'Title', 'Type', 'path', 'getIcon'],
       dropdownCssClass: 'pattern-relateditems-dropdown',
       maximumSelectionSize: -1,
       resultTemplate: '' +
         '<div class="pattern-relateditems-result pattern-relateditems-type-<%= Type %> <% if (selected) { %>pattern-relateditems-active<% } %>">' +
-        '  <a href="#" class="pattern-relateditems-result-select <% if (selectable) { %>selectable<% } %>">' +
+        '  <a href="#" class="pattern-relateditems-result-select <% if (selectable) { %>selectable<% } %> contenttype-<%= Type.toLowerCase() %>">' +
+        '    <% if (getIcon) { %><span class="pattern-relateditems-result-icon"><img src="<%= getIcon %>" /></span><% } %>' +
         '    <span class="pattern-relateditems-result-title"><%= Title %></span>' +
         '    <span class="pattern-relateditems-result-path"><%= path %></span>' +
         '  </a>' +
@@ -120,6 +121,7 @@ define([
       resultTemplateSelector: null,
       selectionTemplate: '' +
         '<span class="pattern-relateditems-item pattern-relateditems-type-<%= Type %>">' +
+        ' <% if (getIcon) { %><span class="pattern-relateditems-result-icon"><img src="<%= getIcon %>" /></span><% } %>' +
         ' <span class="pattern-relateditems-item-title"><%= Title %></span>' +
         ' <span class="pattern-relateditems-item-path"><%= path %></span>' +
         '</span>',
@@ -237,11 +239,13 @@ define([
         dataFilter: function(data) {
           var nodes = [];
           _.each(data.results, function(item) {
-            nodes.push({
+            var node = {
               label: item.Title,
               id: item.UID,
-              path: item.path
-            });
+              path: item.path,
+              folder: self.options.folderTypes.indexOf(item.Type) !== -1
+            };
+            nodes.push(node);
           });
           return nodes;
         }
@@ -251,10 +255,19 @@ define([
         if (node && !node._loaded) {
           self.currentPath = node.path;
           selectedNode = node;
-          treePattern.$el.tree('loadDataFromUrl', self.treeQuery.getUrl(), node);
+          treePattern.$el.tree('loadDataFromUrl', self.treeQuery.getUrl(), node, function(){
+            treePattern.$el.tree('openNode', node);
+          });
           node._loaded = true;
         }
       });
+      treePattern.$el.bind('tree.dblclick', function(e){
+        if(e.node){
+          self.currentPath = e.node.path;
+          self.browseTo(self.currentPath);
+          $treeContainer.fadeOut();
+        }
+      });
       treePattern.$el.bind('tree.refresh', function() {
         /* the purpose of this is that when new data is loaded, the selected
          * node is cleared. This re-selects it as a user browses structure of site */
diff --git a/mockup/patterns/relateditems/pattern.relateditems.less b/mockup/patterns/relateditems/pattern.relateditems.less
index 4185c4e..f1f68f7 100644
--- a/mockup/patterns/relateditems/pattern.relateditems.less
+++ b/mockup/patterns/relateditems/pattern.relateditems.less
@@ -64,23 +64,8 @@
 
   .pattern-relateditems-result-select {
     display: block;
-
-    &.selectable:after {
-      .glyphicon();
-      .glyphicon-chevron-right();
-      position: absolute;
-      left: 0;
-      font-size: 14px;
-      right: 0;
-      top: 50%;
-      margin-top: -14px;
-
-      color: @link-color;
-    }
-    &.selectable{
-      .glyphicon();
-      .glyphicon-record();
-    }
+    line-height: 15px;
+    padding-top: 5px;
   }
 
   .pattern-relateditems-buttons {
@@ -104,7 +89,6 @@
     display: block;
     color: #444;
     font-size: 11px;
-    padding-left: 25px;
   }
 }
 
@@ -129,6 +113,8 @@
         top: 4px;
         display: none;
         z-index: 10000;
+        min-width: 350px;
+        margin-top: 10px;
 
         .pat-tree {
             max-height: 400px;
diff --git a/mockup/patterns/resourceregistry/js/builder.js b/mockup/patterns/resourceregistry/js/builder.js
new file mode 100644
index 0000000..25ee193
--- /dev/null
+++ b/mockup/patterns/resourceregistry/js/builder.js
@@ -0,0 +1,240 @@
+
+define([
+  'jquery',
+  'mockup-patterns-modal',
+  'underscore',
+  'mockup-utils',
+  'mockup-patterns-resourceregistry-url/js/iframe',
+  'translate'
+], function($, Modal, _, utils, IFrame, _t){
+  'use strict';
+
+  var Builder = function(bundleName, bundleListItem){
+    var self = this;
+    self.bundleName = bundleName;
+    self.bundleListItem = bundleListItem;
+    self.rview = bundleListItem.options.registryView;
+    self.$results = null;
+    self.$btnClose = null;
+
+    self.rview.loading.show();
+    self.modal = new Modal($('<div/>').appendTo(self.rview.$el), {
+      html: _.template('<div id="content">' +
+        '<h1>Bundle Builder</h1>' +
+        '<div class="start-info"><p>You are about to build the <span class="label label-primary">' +
+          '<%= name %></span> pattern. </p><p>This may take some a bit of time so ' +
+          'we will try to keep you updated on the progress.</p><p> Press the "Build it" ' +
+          'button to proceed.</p></div>' +
+        '<ul class="list-group hidden"></ul>' +
+        '<button class="plone-btn plone-btn-default cancel hidden cancel-build"><%- _t("Close") %></button>' +
+        '<button class="plone-btn plone-btn-primary build"><%- _t("Build it") %></button>' +
+      '</div>', $.extend({ _t: _t }, bundleListItem.options)),
+      content: null,
+      width: 500,
+      buttons: '.plone-btn'
+    });
+    self.modal.on('shown', function() {
+      var $el = self.modal.$modal;
+      var $info = $el.find('.start-info');
+      self.$btnClose = $el.find('button.cancel-build');
+      var $btn = $el.find('button.build');
+      $btn.off('click').on('click', function(e){
+        e.preventDefault();
+        $info.addClass('hidden');
+        $btn.prop('disabled', true);
+        self.$results = $el.find('.list-group').removeClass('hidden');
+        self.buildJS();
+        self.rview.loading.show();
+      });
+
+      self.$btnClose.off('click').on('click', function(){
+        self.modal.hide();
+      });
+    });
+
+    self.addResult = function(txt, klass){
+      if(!klass){
+        klass = '';
+      }
+      self.$results.append('<li class="list-group-item ' + klass + '">' + txt + '</li>');
+    };
+
+    self.run = function(){
+      self.modal.show();
+    };
+
+    self.finished = function(error){
+      var msg = _t('Finished!');
+      if(error){
+        msg = _t('Error in build process');
+      }
+      self.addResult(msg, 'list-group-item-warning');
+      self.$btnClose.removeClass('hidden');
+      self.rview.loading.hide();
+    };
+
+    self.buildJS = function(){
+      self.addResult(_t('building javascripts'));
+      $.ajax({
+        url: self.rview.options.data.manageUrl,
+        type: 'POST',
+        dataType: 'json',
+        data: {
+          action: 'js-build-config',
+          bundle: self.bundleName,
+          _authenticator: utils.getAuthenticator()
+        },
+        success: function(data){
+          /* sort of weird here, follow along. We'll build CSS after JS */
+          self._buildJSBundle(data);
+        },
+        error: function(){
+          self.addResult(_t('Error building resources'));
+          self.finished(true);
+        }
+      });
+    };
+
+    self._buildCSSBundle = function(config){
+      var iframe = new IFrame({
+        name: 'lessc',
+        resources: config.less.concat([
+          self.rview.options.data.lessConfigUrl,
+          self.rview.options.data.lessUrl]),
+        configure: function(iframe){
+          iframe.window.lessErrorReporting = function(what, error, href){
+            if(what !== 'remove'){
+              self.addResult(_t('less compilation error on file ') + href + ': ' + error);
+            }
+          };
+        }
+      });
+
+      /* XXX okay, wish there were a better way,
+         but we need to pool to find the out if it's down loading less */
+      self.addResult(config.less.length + _t(' css files to build'));
+      var lessModified = Boolean(
+          self.rview.options.data.lessModifyUrl === null ||
+          self.rview.options.data.lessModifyUrl === undefined
+      );
+      var checkFinished = function(){
+        var $styles =  $('style[type="text/css"][id]', iframe.document);
+        for(var i=0; i<$styles.length; i=i+1){
+          var $style = $styles.eq(i); 
+          if($style.attr('id') === 'less:error-message'){
+            self.addResult(_t('Error compiling less'));
+            return self.finished(true);
+          }
+        }
+        if($styles.length === config.less.length && lessModified === true){
+          // we're finished, save it
+          var data = {};
+          $styles.each(function(){
+            var $el = $(this);
+            data['data-' + $el.attr('id')] = $el.html();
+          });
+          iframe.destroy();
+          $.ajax({
+            url: self.rview.options.data.manageUrl,
+            type: 'POST',
+            dataType: 'json',
+            data: $.extend(data, {
+              action: 'save-less-build',
+              bundle: self.bundleName,
+              _authenticator: utils.getAuthenticator()
+            }),
+            success: function(data){
+              self.rview.options.data.overrides.push(data.filepath);
+              self.rview.tabView.overridesView.render();
+              self.addResult(_t('finished saving css bundles'));
+              self.finished();
+            },
+            error: function(){
+              self.addResult(_t('Error saving css bundle'));
+              self.finished(true);
+            }
+          });
+        }else if($styles.length === config.less.length){
+          $styles.each(function(){$(this).remove();});
+
+          script = document.createElement('script');
+          script.setAttribute('type', 'text/javascript');
+          script.setAttribute('src', self.rview.options.data.lessModifyUrl);
+          head.appendChild(script);
+
+          lessModified = true;
+          setTimeout(checkFinished, 300);
+        }else{
+          setTimeout(checkFinished, 300);
+        }
+      };
+      checkFinished();
+    };
+
+    self.buildCSSBundle = function(){
+      self.addResult(_t('building CSS bundle'));
+      $.ajax({
+        url: self.rview.options.data.manageUrl,
+        type: 'POST',
+        dataType: 'json',
+        data: {
+          action: 'less-build-config',
+          bundle: self.bundleName,
+          _authenticator: utils.getAuthenticator()
+        },
+        success: function(data){
+          /* sort of weird here, follow along. We'll build CSS after JS */
+          self._buildCSSBundle(data);
+        },
+        error: function(){
+          self.addResult(_t('Error building css bundle'));
+          self.finished(true);
+        }
+      });
+    };
+
+    self._buildJSBundle = function(config){
+      if(config.include.length === 0){
+        self.addResult(_t('No javascripts to build, skipping'));
+        return self.buildCSSBundle();
+      }
+
+      config.out = function(results){
+        $.ajax({
+          url: self.rview.options.data.manageUrl,
+          type: 'POST',
+          dataType: 'json',
+          data: {
+            action: 'save-js-build',
+            bundle: self.bundleName,
+            data: results,
+            _authenticator: utils.getAuthenticator()
+          },
+          success: function(data){
+            self.rview.options.data.overrides.push(data.filepath);
+            self.rview.tabView.overridesView.render();
+          },
+          error: function(){
+            self.addResult(_t('Error building bundle'));
+            self.finished(true);
+          }
+        });
+      };
+      new IFrame({
+        name: 'rjs',
+        resources: [self.rview.options.data.rjsUrl],
+        onLoad: function(iframe){
+          iframe.window.requirejs.optimize(config, function(combined_files){
+            self.addResult(_t('Saved javascript bundle, Build results') + ': <pre>' + combined_files + '</pre>');
+            self.buildCSSBundle();
+            iframe.destroy();
+          });
+        }
+      });
+    };
+
+    return self;
+  };
+
+  return Builder;
+});
diff --git a/mockup/patterns/resourceregistry/js/fields.js b/mockup/patterns/resourceregistry/js/fields.js
index 0c34c27..6d9ec6f 100644
--- a/mockup/patterns/resourceregistry/js/fields.js
+++ b/mockup/patterns/resourceregistry/js/fields.js
@@ -3,8 +3,9 @@ define([
   'underscore',
   'mockup-ui-url/views/base',
   'mockup-patterns-sortable',
-  'mockup-patterns-select2'
-], function($, _, BaseView, Sortable, Select2) {
+  'mockup-patterns-select2',
+  'translate'
+], function($, _, BaseView, Sortable, Select2, _t) {
   'use strict';
 
 
@@ -120,7 +121,7 @@ define([
         '<span class="hidden glyphicon glyphicon-remove form-control-feedback"></span>' +
       '</div>' +
       '<div class="col-sm-1">' +
-        '<button class="plone-btn plone-btn-danger plone-btn-xs">Remove</button>' +
+        '<button class="plone-btn plone-btn-danger plone-btn-xs"><%- _t("Remove") %></button>' +
       '</div>')
   });
 
@@ -154,7 +155,7 @@ define([
     template: _.template(
       '<label class="col-sm-3 control-label"><%- title %></label>' +
       '<ul class="col-sm-9 fields list-group" />' +
-      '<button class="plone-btn plone-btn-default add pull-right">Add</button>'),
+      '<button class="plone-btn plone-btn-default add pull-right"><%- _t("Add") %></button>'),
     events: {
       'click button.add': 'addRowClicked',
       'change input': 'inputChanged',
@@ -202,7 +203,7 @@ define([
         $container.append('<li class="list-group-item"><div class="input-group">' +
           '<input class="form-control input-sm" value="' + value + '" />' +
           '<span class="input-group-btn">' +
-            '<button class="plone-btn plone-btn-default remove plone-btn-sm">Remove</button></div></li>');
+            '<button class="plone-btn plone-btn-default remove plone-btn-sm">' + _t('Remove') + '</button></div></li>');
       });
 
       if(self.sortable){
diff --git a/mockup/patterns/resourceregistry/js/iframe.js b/mockup/patterns/resourceregistry/js/iframe.js
new file mode 100644
index 0000000..05cf90a
--- /dev/null
+++ b/mockup/patterns/resourceregistry/js/iframe.js
@@ -0,0 +1,109 @@
+/*
+ * much of this code is heavily barrowed from Rok Garbas's iframe
+ * code that has since been removed from mockup
+ */
+
+define([
+  'jquery'
+], function($) {
+  'use strict';
+
+  window.IFrame = function(options) { this.init(options); };
+  window.IFrame.prototype = {
+    defaults: {
+      doctype: '<!doctype html>',
+      title: '',
+      name: '',
+      resources: [],
+      configure: function(){},
+      onLoad: function(){}
+    },
+
+    init: function(options) {
+      var self = this;
+      self.options = $.extend({}, self.defaults, options);
+
+      // register this guy
+      if(!window.iframe){
+        window.iframe = {};
+      }
+      window.iframe[self.options.name] = self;
+
+      self.loaded = false;
+
+      // Create iframe
+      var iframe = window.document.createElement('iframe');
+
+      iframe.setAttribute('id', self.options.name);
+      iframe.setAttribute('name', self.options.name);
+      iframe.setAttribute('style', 'display:none;');
+      iframe.setAttribute('src', 'javascript:false');
+
+      window.document.body.appendChild(iframe);
+      self.el = iframe;
+      self.window = iframe.contentWindow;
+      self.document = self.window.document;
+
+      self.options.configure(self);
+
+      var resourcesData = '';
+      for(var i=0; i<self.options.resources.length; i=i+1){
+        var url = self.options.resources[i];
+        var resource;
+        if (url.slice( -3 ) === '.js') {
+          resource = window.document.createElement('script');
+          resource.src = url;
+          resource.type = 'text/javascript';
+          resource.async = false;
+        } else if (url.slice( -4 ) === '.css') {
+          resource = window.document.createElement('link');
+          resource.href = url;
+          resource.type = 'text/css';
+          resource.rel = 'stylesheet';
+        } else if (url.slice( -5 ) === '.less') {
+          resource = window.document.createElement('link');
+          resource.href = url;
+          resource.type = 'text/css';
+          resource.rel = 'stylesheet/less';
+        }
+        resourcesData += '\n' + resource.outerHTML;
+      }
+
+      self.document.open();
+      self.document.write(
+          self.options.doctype +
+          '<html>' +
+            '<head>' +
+              '<title>' + self.options.title + '</title>' +
+              '<meta http-equiv="X-UA-Compatible" content="IE=edge">' +
+            '</head>' +
+            '<body onload="parent.window.iframe[\'' +
+                self.options.name + '\'].load()">' +
+              resourcesData +
+            '</body>' +
+          '</html>'
+      );
+      self.document.close();
+    },
+
+    load: function() {
+      var self = this;
+
+      // check if already loaded
+      if ( self.loaded === true ) {
+        return;
+      }
+
+      // mark iframe as loaded
+      self.loaded = true;
+
+      self.options.onLoad(self);
+    },
+    destroy: function(){
+      delete window.iframe[this.options.name];
+      window.document.body.removeChild(this.el);
+    }
+  };
+
+  return window.IFrame;
+});
\ No newline at end of file
diff --git a/mockup/patterns/resourceregistry/js/less.js b/mockup/patterns/resourceregistry/js/less.js
index 3bf9f49..0495473 100644
--- a/mockup/patterns/resourceregistry/js/less.js
+++ b/mockup/patterns/resourceregistry/js/less.js
@@ -13,8 +13,8 @@ define([
     template: _.template(
       '<div class="clearfix">' +
         '<div class="btn-group pull-right">' +
-          '<button class="plone-btn plone-btn-default add-variable">Add variable</button>' +
-          '<button class="plone-btn plone-btn-default save">save</button>' +
+          '<button class="plone-btn plone-btn-default add-variable"><%- _t("Add variable") %></button>' +
+          '<button class="plone-btn plone-btn-default save"><%- _t("save") %></button>' +
         '</div>' +
       '</div>' +
       '<div class="row clearfix">' +
diff --git a/mockup/patterns/resourceregistry/js/overrides.js b/mockup/patterns/resourceregistry/js/overrides.js
index 8e0a386..d9dcd05 100644
--- a/mockup/patterns/resourceregistry/js/overrides.js
+++ b/mockup/patterns/resourceregistry/js/overrides.js
@@ -5,34 +5,47 @@ define([
   'underscore',
   'mockup-ui-url/views/base',
   'mockup-patterns-texteditor',
-  'mockup-utils'
-], function($, _, BaseView, TextEditor, utils) {
+  'mockup-utils',
+  'mockup-patterns-select2',
+  'translate'
+], function($, _, BaseView, TextEditor, utils, Select2, _t) {
   'use strict';
 
-  var OverrideResource = BaseView.extend({
-    tagName: 'li',
-    className: 'list-group-item',
-    template: _.template('<a href="#"><%- filepath %></a> ' +
-      '<div class="plone-btn-group pull-right">' +
-        '<button class="plone-btn plone-btn-danger plone-btn-xs">Delete</button>' +
-        '<% if(view.canSave) { %> ' +
-          '<button class="plone-btn plone-btn-primary plone-btn-xs">Save</button> ' +
-          '<button class="plone-btn plone-btn-default plone-btn-xs">Cancel</button> ' +
-        ' <% } %>' +
-      '</div>'),
+  var OverridesView = BaseView.extend({
+    tagName: 'div',
+    className: 'tab-pane overrides',
+    editing: null,
+    canSave: false,
 
+    template: _.template(
+      '<form class="row">' +
+        '<div class="col-md-12">' +
+          '<p><%- _t("Only ++plone++ resources are available to override") %></p>' +
+          '<input class="select" type="hidden" placeholder="<%- _t("Select resource to override...") %>" style="width: 100%" />' +
+        '</div>' +
+      '</form>' +
+      '<div class="row">' +
+        '<div class="col-md-12">' +
+          '<% if(view.editing){ %>' +
+            '<p class="resource-name text-primary"><%- view.editing %></p> ' +
+            '<div class="plone-btn-group">' +
+              '<button class="plone-btn plone-btn-primary plone-btn-xs disabled"><%- _t("Save") %></button> ' +
+              '<button class="plone-btn plone-btn-default plone-btn-xs disabled"><%- _t("Cancel") %></button>' +
+              '<button class="plone-btn plone-btn-danger plone-btn-xs"><%- _t("Delete customizations") %></button>' +
+            '</div>' +
+          '<% } %>' +
+          '<div class="editor" />' +
+        '</div>' +
+      '</div>'),
     events: {
-      'click a': 'itemClicked',
       'click button.plone-btn-danger': 'itemDeleted',
       'click button.plone-btn-primary': 'itemSaved',
       'click button.plone-btn-default': 'itemCancel'
     },
-    canSave: false,
 
     initialize: function(options){
       BaseView.prototype.initialize.apply(this, [options]);
-      this.tabView = this.options.overridesView.tabView;
-      this.loading = this.tabView.loading;
+      this.tabView = options.tabView;
     },
 
     serializedModel: function(){
@@ -41,183 +54,121 @@ define([
 
     itemSaved: function(e){
       e.preventDefault();
-      var self = this;
-      self.tabView.saveData('save-file', {
-        filepath: self.options.filepath,
-        data: self.editor.editor.getValue()
+      var that = this;
+      that.tabView.saveData('save-file', {
+        filepath: that.editing,
+        data: that.editor.editor.getValue()
       }, function(){
-        self.canSave = false;
-        self.render();
+        that.$el.find('.plone-btn-primary,.plone-btn-default').addClass('disabled');
       });
     },
 
     itemDeleted: function(e){
       e.preventDefault();
-      var self = this;
+      var that = this;
       if(confirm('Are you sure you want to delete this override?')){
-        this.options.data.overrides.splice(self.options.index, 1);
-        this.render();
-        self.tabView.saveData('delete-file', {
-          filepath: self.options.filepath
+        that.options.data.overrides.splice(
+          that.options.data.overrides.indexOf(that.editing), 1);
+        that.tabView.saveData('delete-file', {
+          filepath: that.editing
         }, function(){
-          var index = _.indexOf(self.options.overridesView.data.overrides, self.options.filepath);
-          if(index !== -1){
-            self.options.overridesView.data.overrides.splice(index, 1);
-          }
-          self.options.overridesView.render();
-          self.loading.hide();
+          that.editing = null;
+          that.render();
         });
       }
     },
 
     itemCancel: function(e){
       e.preventDefault();
-      this.editor.$el.remove();
-      this.canSave = false;
+      this.editing = null;
       this.render();
     },
 
-    itemClicked: function(e){
-      var self = this;
-      e.preventDefault();
-      var data = self.options.data;
-      var override = data.overrides[self.options.index];
-      var url = data.baseUrl;
-      if(url[url.length - 1] !== '/'){
-        url += '/';
+    customizeResource: function(resource){
+      if(this.options.data.overrides.indexOf(resource) === -1){
+        this.options.data.overrides.push(resource);
       }
-      self.loading.show();
-      $.ajax({
-        // cache busting url
-        url: url + override + '?' + utils.generateId(),
-        dataType: 'text'
-      }).done(function(data){
-        var $pre = $('<pre class="pat-texteditor" />');
-        $pre.html(data);
-        self.options.overridesView.$editorContainer.empty().append($pre);
-        self.editor = new TextEditor($pre, {
-          width: 600,
-          height: 500
-        });
-        self.editor.setSyntax(override);
-        self.editor.editor.on('change', function(){
-          if(!self.canSave){
-            self.canSave = true;
-            self.render();
-          }
-        });
-        self.render();
-        self.loading.hide();
-      }).fail(function(){
-        alert('error loading resource for editing');
-        self.loading.hide();
-      });
-    }
-  });
-
-
-  var OverridesView = BaseView.extend({
-    tagName: 'div',
-    className: 'tab-pane overrides',
-    template: _.template(
-      '<form class="row">' +
-        '<div class="col-md-6 col-md-offset-6">' +
-          '<div class="input-group">' +
-            '<input type="text" class="form-control search-field" />' +
-            '<span class="input-group-btn">' +
-              '<button class="plone-btn plone-btn-default" type="button">Search</button>' +
-            '</span>' +
-          '</div>' +
-        '</div>' +
-      '</form>' +
-      '<div class="row">' +
-        '<ul class="items list-group col-md-5"></ul>' +
-        '<div class="col-md-7">' +
-          '<ul class="hidden list-group search-results" />' +
-          '<div class="editor" />' +
-        '</div>' +
-      '</div>'),
-    events: {
-      'submit form': 'noSubmit',
-      'keyup form input': 'textChange',
-      'click button.clear': 'clearSearchResults',
-      'click button.customize': 'customizeResource'
-    },
-
-    noSubmit: function(e){
-      e.preventDefault();
-    },
-
-    clearSearchResults: function(e){
-      e.preventDefault();
-      this.$searchResults.addClass('hidden');
-      this.$searchInput.attr('value', '');
-    },
-
-    customizeResource: function(e){
-      e.preventDefault();
-      var $btn = $(e.target);
-      this.options.data.overrides.push($btn.parent().find('span').html());
+      this.editing = resource;
       this.render();
     },
 
-    textChange: function(){
-      var self = this;
-      var q = self.$searchInput.val();
-      if(q.length < 4){
-        self.$searchResults.addClass('hidden');
-        return;
-      }
-      q = q.toLowerCase();
-      self.$searchResults.empty().removeClass('hidden');
-      self.$searchResults.append('<li class="list-group-item list-group-item-warning">' +
-        'Results<button class="plone-btn plone-btn-default pull-right plone-btn-xs clear">Clear</button></li>');
-      var matches = [];
-      var data = self.options.data;
-      var urlMatches = function(base, path){
-        var filepath = (base + (path || '')).toLowerCase();
-        if(filepath.indexOf('++plone++') === -1){
-          return false;
-        }
-        return filepath.indexOf(q) !== -1;
-      };
-      _.each(data.resources, function(resource){
+    afterRender: function(){
+      var that = this;
+      var $select = that.$el.find('.select');
+      var overrides = _.map(that.options.data.overrides, function(override){
+        return {
+          id: override,
+          text: override,
+          override: true
+        };
+      });
+      var resources = _.flatten(_.map(that.options.data.resources, function(resource){
         var base = resource.url || '';
         if(base){
           base += '/';
         }
-        if(urlMatches(base, resource.js)){
-          matches.push(base + resource.js);
+        var items = [];
+        var url;
+        if(resource.js && resource.js.indexOf('++plone++') !== -1){
+          url = base + resource.js;
+          if(overrides.indexOf(url) === -1){
+            items.push({id: url, text: url});
+          }
         }
         for(var i=0; i<resource.css.length; i=i+1){
-          if(urlMatches(base, resource.css[i])){
-            matches.push(base + resource.css[i]);
+          url = base + resource.css[i];
+          if(overrides.indexOf(url) === -1 && url.indexOf('++plone++') !== -1){
+            items.push({id: url, text: url});
           }
         }
+        return items;
+      }));
+
+      var format = function(data){
+        if(data.override){
+          return '<span class="customized">' + data.text + ' - ' + _t('customized') + '</span>';
+        }
+        return data.text;
+      };
+      that.select2 = new Select2($select, {
+        data: overrides.concat(_.sortBy(resources, function(d){ return d.id; })),
+        formatResult: format,
+        formatSelection: format
       });
-      _.each(matches, function(filepath){
-        self.$searchResults.append(
-          '<li class="list-group-item"><span>' + filepath + '</span> ' +
-          '<button class="plone-btn plone-btn-danger pull-right plone-btn-xs customize">Customize</button></li>'
-        );
+
+      $select.on('change', function(){
+        that.customizeResource($select.select2('val'));
       });
-    },
 
-    afterRender: function(){
-      var self = this;
-      self.$ul = self.$('ul.items');
-      _.each(self.options.data.overrides, function(filepath, index){
-        var view = new OverrideResource({
-          index: index,
-          filepath: filepath,
-          overridesView: self,
-          data: self.options.data
+      that.$editorContainer = that.$('.editor');
+      if(that.editing !== null){
+        var url = that.options.data.baseUrl;
+        if(url[url.length - 1] !== '/'){
+          url += '/';
+        }
+        that.tabView.loading.show();
+        $.ajax({
+          // cache busting url
+          url: url + that.editing + '?' + utils.generateId(),
+          dataType: 'text'
+        }).done(function(data){
+          var $pre = $('<pre class="pat-texteditor" />');
+          $pre.text(data);
+          that.$editorContainer.empty().append($pre);
+          that.editor = new TextEditor($pre, {
+            width: $('.editor').width(),
+            height: 500
+          });
+          that.editor.setSyntax(that.editing);
+          that.tabView.loading.hide();
+          that.editor.editor.on('change', function(){
+            that.$el.find('.plone-btn-primary,.plone-btn-default').removeClass('disabled');
+          });
+        }).fail(function(){
+          alert(_t('error loading resource for editing'));
+          that.tabView.loading.hide();
         });
-        self.$ul.append(view.render().el);
-      });
-      self.$editorContainer = self.$('.editor');
-      self.$searchInput = self.$('form input');
-      self.$searchResults = self.$('.search-results');
+      }
     }
   });
 
diff --git a/mockup/patterns/resourceregistry/js/patternoptions.js b/mockup/patterns/resourceregistry/js/patternoptions.js
index 7029615..be55fda 100644
--- a/mockup/patterns/resourceregistry/js/patternoptions.js
+++ b/mockup/patterns/resourceregistry/js/patternoptions.js
@@ -15,8 +15,8 @@ define([
     template: _.template(
       '<div class="clearfix">' +
         '<div class="btn-group pull-right">' +
-          '<button class="plone-btn plone-btn-default add-pattern">Add pattern</button>' +
-          '<button class="plone-btn plone-btn-default save">save</button>' +
+          '<button class="plone-btn plone-btn-default add-pattern"><%- _t("Add pattern") %></button>' +
+          '<button class="plone-btn plone-btn-default save"><%- _t("save") %></button>' +
         '</div>' +
       '</div>' +
       '<div class="row clearfix">' +
diff --git a/mockup/patterns/resourceregistry/js/registry.js b/mockup/patterns/resourceregistry/js/registry.js
index b08483f..053be43 100644
--- a/mockup/patterns/resourceregistry/js/registry.js
+++ b/mockup/patterns/resourceregistry/js/registry.js
@@ -5,12 +5,12 @@ define([
   'underscore',
   'mockup-ui-url/views/base',
   'mockup-utils',
-  'mockup-patterns-modal',
-  'mockup-patterns-resourceregistry-url/js/fields'
-], function($, _, BaseView, utils, Modal, fields) {
+  'mockup-patterns-resourceregistry-url/js/fields',
+  'mockup-patterns-resourceregistry-url/js/builder',
+  'translate'
+], function($, _, BaseView, utils, fields, Builder, _t) {
   'use strict';
 
-
   var AbstractResourceEntryView = BaseView.extend({
     tagName: 'div',
     className: 'resource-entry',
@@ -52,37 +52,37 @@ define([
   var ResourceEntryView = AbstractResourceEntryView.extend({
     fields: [{
       name: 'name',
-      title: 'Name',
+      title: _t('Name'),
       view: fields.ResourceNameFieldView
     }, {
       name: 'url',
-      title: 'URL',
-      description: 'Resources base URL'
+      title: _t('URL'),
+      description: _t('Resources base URL')
     }, {
       name: 'js',
-      title: 'JS',
-      description: 'Main JavaScript file'
+      title: _t('JS'),
+      description: _t('Main JavaScript file')
     }, {
       name: 'css',
-      title: 'CSS/LESS',
-      description: 'List of CSS/LESS files to use for resource',
+      title: _t('CSS/LESS'),
+      description: _t('List of CSS/LESS files to use for resource'),
       view: fields.ResourceSortableListFieldView
     },{
       name: 'init',
-      title: 'Init', 
-      description: 'Init instruction for requirejs shim'
+      title: _t('Init'), 
+      description: _t('Init instruction for requirejs shim')
     }, {
       name: 'deps',
-      title: 'Dependencies',
-      description: 'Coma separated values of resources for requirejs shim'
+      title: _t('Dependencies'),
+      description: _t('Coma separated values of resources for requirejs shim')
     }, {
       name: 'export',
-      title: 'Export',
-      description: 'Export vars for requirejs shim'
+      title: _t('Export'),
+      description: _t('Export vars for requirejs shim')
     }, {
       name: 'conf',
-      title: 'Configuration',
-      description: 'Configuration in JSON for the widget',
+      title: _t('Configuration'),
+      description: _t('Configuration in JSON for the widget'),
       view: fields.ResourceTextAreaFieldView
     }]
   });
@@ -91,48 +91,48 @@ define([
   var BundleEntryView = AbstractResourceEntryView.extend({
     fields: [{
       name: 'name',
-      title: 'Name',
+      title: _t('Name'),
       view: fields.ResourceNameFieldView
     }, {
       name: 'resources',
-      title: 'Resources',
-      description: 'A main resource file to bootstrap bundle or a list of resources to load.',
+      title: _t('Resources'),
+      description: _t('A main resource file to bootstrap bundle or a list of resources to load.'),
       view: fields.BundleResourcesFieldView
     }, {
       name: 'depends',
-      title: 'Depends',
-      description: 'Bundle this depends on',
+      title: _t('Depends'),
+      description: _t('Bundle this depends on'),
       view: fields.BundleDependsFieldView
     }, {
       name: 'expression',
-      title: 'Expression',
-      description: 'Conditional expression to decide if this resource will run'
+      title: _t('Expression'),
+      description: _t('Conditional expression to decide if this resource will run')
     }, {
       name: 'enabled',
-      title: 'Enabled',
+      title: _t('Enabled'),
       view: fields.ResourceBoolFieldView
     }, {
       name: 'conditionalcomment',
-      title: 'Conditional comment',
-      description: 'For Internet Exploder hacks...'
+      title: _t('Conditional comment'),
+      description: _t('For Internet Exploder hacks...')
     }, {
       name: 'compile',
-      title: 'Does your bundle contain any RequireJS or LESS files?',
+      title: _t('Does your bundle contain any RequireJS or LESS files?'),
       view: fields.ResourceBoolFieldView
     }, {
       name: 'last_compilation',
-      title: 'Last compilation',
-      description: 'Date/Time when your bundle was last compiled. Empty, if it was never compiled.',
+      title: _t('Last compilation'),
+      description: _t('Date/Time when your bundle was last compiled. Empty, if it was never compiled.'),
       view: fields.ResourceDisplayFieldView
     }, {
       name: 'jscompilation',
-      title: 'Compiled JavaScript',
-      description: 'Automatically generated path to the compiled JavaScript.',
+      title: _t('Compiled JavaScript'),
+      description: _t('Automatically generated path to the compiled JavaScript.'),
       view: fields.ResourceDisplayFieldView
     }, {
       name: 'csscompilation',
-      title: 'Compiled CSS',
-      description: 'Automatically generated path to the compiled CSS.',
+      title: _t('Compiled CSS'),
+      description: _t('Automatically generated path to the compiled CSS.'),
       view: fields.ResourceDisplayFieldView
     }]
   });
@@ -144,18 +144,26 @@ define([
     className: 'list-group-item',
     template: _.template(
       '<a href="#"><%- name %></a> ' +
-      '<button class="pull-right plone-btn plone-btn-danger delete plone-btn-xs">Delete</button>'
+      '<button class="pull-right plone-btn plone-btn-danger delete plone-btn-xs"><%- _t("Delete") %></button>'
     ),
     events: {
       'click a': 'editResource',
       'click button.delete': 'deleteClicked'
     },
+    defaults: {
+      develop_javascript: false,
+      develop_css: false,
+      compile: true
+    },
     afterRender: function(){
       this.$el.attr('data-name', this.options.name);
       this.$el.addClass(this.type + '-list-item-' + this.options.name);
     },
     serializedModel: function(){
-      return $.extend({}, {name: this.options.name}, this.options.data);
+      return $.extend({}, this.defaults, {
+        name: this.options.name,
+        view: this.options.registryView
+      }, this.options.data);
     },
     editResource: function(e){
       if(e){
@@ -166,261 +174,73 @@ define([
         parent: this
       });
       var resource = new ResourceEntryView(options);
-      this.registryView.showResourceEditor(resource);
+      this.registryView.showResourceEditor(resource, this, 'resource');
+
+      // and scroll to resource since huge list makes this hard to notice
+      $('html, body').animate({
+        scrollTop: resource.$el.offset().top
+      }, 1000);
     },
     deleteClicked: function(e){
       e.preventDefault();
-      delete this.options.registryView.options.data.resources[this.options.name];
-      this.options.registryView.dirty = true;
-      this.options.registryView.render();
+      if(confirm(_t('Are you sure you want to delete the ' + this.options.name + ' resource?'))){
+        delete this.options.registryView.options.data.resources[this.options.name];
+        this.options.registryView.dirty = true;
+        this.options.registryView.render();
+      }
     }
   });
 
 
-  var Builder = function(bundleName, bundleListItem){
-    var self = this;
-    self.bundleName = bundleName;
-    self.bundleListItem = bundleListItem;
-    self.rview = bundleListItem.options.registryView;
-    self.$results = null;
-    self.$btnClose = null;
-
-    self.rview.loading.show();
-    self.modal = new Modal($('<div/>').appendTo(self.rview.$el), {
-      html: _.template('<div id="content">' +
-        '<h1>Bundle Builder</h1>' +
-        '<div class="start-info"><p>You are about to build the <span class="label label-primary">' +
-          '<%= name %></span> pattern. </p><p>This may take some a bit of time so ' +
-          'we will try to keep you updated on the progress.</p><p> Press the "Build it" ' +
-          'button to proceed.</p></div>' +
-        '<ul class="list-group hidden"></ul>' +
-        '<button class="plone-btn plone-btn-default cancel hidden cancel-build">Close</button>' +
-        '<button class="plone-btn plone-btn-primary build">Build it</button>' +
-      '</div>', bundleListItem.options),
-      content: null,
-      width: 500,
-      buttons: '.plone-btn'
-    });
-    self.modal.on('shown', function() {
-      var $el = self.modal.$modal;
-      var $info = $el.find('.start-info');
-      self.$btnClose = $el.find('button.cancel-build');
-      var $btn = $el.find('button.build');
-      $btn.off('click').on('click', function(e){
-        e.preventDefault();
-        $info.addClass('hidden');
-        $btn.prop('disabled', true);
-        self.$results = $el.find('.list-group').removeClass('hidden');
-        self.buildJS();
-        self.rview.loading.show();
-      });
-
-      self.$btnClose.off('click').on('click', function(){
-        self.modal.hide();
-      });
-    });
-
-    self.addResult = function(txt, klass){
-      if(!klass){
-        klass = '';
-      }
-      self.$results.append('<li class="list-group-item ' + klass + '">' + txt + '</li>');
-    };
-
-    self.run = function(){
-      self.modal.show();
-    };
-
-    self.finished = function(error){
-      var msg = 'Finished!';
-      if(error){
-        msg = 'Error in build process';
-      }
-      self.addResult(msg, 'list-group-item-warning');
-      self.$btnClose.removeClass('hidden');
-      self.rview.loading.hide();
-    };
-
-    self.buildJS = function(){
-      self.addResult('building javascripts');
-      $.ajax({
-        url: self.rview.options.data.manageUrl,
-        type: 'POST',
-        dataType: 'json',
-        data: {
-          action: 'js-build-config',
-          bundle: self.bundleName,
-          _authenticator: utils.getAuthenticator()
-        },
-        success: function(data){
-          /* sort of weird here, follow along. We'll build CSS after JS */
-          self._buildJSBundle(data);
-        },
-        error: function(){
-          self.addResult('Error building resources');
-          self.finished(true);
-        }
-      });
-    };
-
-    self._buildCSSBundle = function(config){
-      var $iframe = $('<iframe style="display:none"><html><head></head><body></body></html></iframe>').
-          appendTo('body').on('load', function(){
-      });
-      var iframe = $iframe[0];
-      var win = iframe.contentWindow || iframe;
-      win.lessErrorReporting = function(what, error, href){
-        if(what !== 'remove'){
-          self.addResult('less compilation error on file ' + href + ': ' + error);
-        }
-      };
-      var head = $iframe.contents().find('head')[0];
-      _.each(config.less, function(less){
-        var link = document.createElement('link');
-        link.setAttribute('rel', 'stylesheet/less');
-        link.setAttribute('type', 'text/css');
-        link.setAttribute('href', less);
-        head.appendChild(link); 
-      });
-      var script = document.createElement('script');
-      script.setAttribute('type', 'text/javascript');
-      script.setAttribute('src', self.rview.options.data.lessConfigUrl);
-      script.onload = function(){
-        script = document.createElement('script');
-        script.setAttribute('type', 'text/javascript');
-        script.setAttribute('src', self.rview.options.data.lessUrl);
-        head.appendChild(script);
-      };
-      head.appendChild(script);
-
-      /* XXX okay, wish there were a better way,
-         but we need to pool to find the */
-      self.addResult(config.less.length + ' css files to build');
-      var checkFinished = function(){
-        var $styles =  $('style[type="text/css"][id]', head);
-        for(var i=0; i<$styles.length; i=i+1){
-          var $style = $styles.eq(i); 
-          if($style.attr('id') === 'less:error-message'){
-            self.addResult('Error compiling less');
-            return self.finished(true);
-          }
-        }
-        if($styles.length === config.less.length){
-          // we're finished, save it
-          var data = {};
-          $styles.each(function(){
-            var $el = $(this);
-            data['data-' + $el.attr('id')] = $el.html();
-          });
-          $iframe.remove();
-          $.ajax({
-            url: self.rview.options.data.manageUrl,
-            type: 'POST',
-            dataType: 'json',
-            data: $.extend(data, {
-              action: 'save-less-build',
-              bundle: self.bundleName,
-              _authenticator: utils.getAuthenticator()
-            }),
-            success: function(data){
-              self.rview.options.data.overrides.push(data.filepath);
-              self.rview.tabView.overridesView.render();
-              self.addResult('finished saving css bundles');
-              self.finished();
-            },
-            error: function(){
-              self.addResult('Error saving css bundle');
-              self.finished(true);
-            }
-          });
-        }else{
-          setTimeout(checkFinished, 300);
-        }
-      };
-      checkFinished();
-    };
-
-    self.buildCSSBundle = function(){
-      self.addResult('building CSS bundle');
-      $.ajax({
-        url: self.rview.options.data.manageUrl,
-        type: 'POST',
-        dataType: 'json',
-        data: {
-          action: 'less-build-config',
-          bundle: self.bundleName,
-          _authenticator: utils.getAuthenticator()
-        },
-        success: function(data){
-          /* sort of weird here, follow along. We'll build CSS after JS */
-          self._buildCSSBundle(data);
-        },
-        error: function(){
-          self.addResult('Error building css bundle');
-          self.finished(true);
-        }
-      });
-    };
-
-    self._buildJSBundle = function(config){
-      if(config.include.length === 0){
-        self.addResult('No javascripts to build, skipping');
-        return self.buildCSSBundle();
-      }
-      config.out = function(results){
-        $.ajax({
-          url: self.rview.options.data.manageUrl,
-          type: 'POST',
-          dataType: 'json',
-          data: {
-            action: 'save-js-build',
-            bundle: self.bundleName,
-            data: results,
-            _authenticator: utils.getAuthenticator()
-          },
-          success: function(data){
-            self.rview.options.data.overrides.push(data.filepath);
-            self.rview.tabView.overridesView.render();
-          },
-          error: function(){
-            self.addResult('Error building bundle');
-            self.finished(true);
-          }
-        });
-      };
-      var $iframe = $('<iframe style="display:none"><html><head></head><body></body></html></iframe').appendTo('body');
-      var iframe = $iframe[0];
-      var win = iframe.contentWindow || iframe;
-      var head = $iframe.contents().find('head')[0];
-      var script = document.createElement('script');
-      script.setAttribute('type', 'text/javascript');
-      script.setAttribute('src', self.rview.options.data.rjsUrl);
-      script.onload = function(){
-        win.requirejs.optimize(config, function(combined_files){
-          self.addResult('Saved javascript bundle, Build results: <pre>' + combined_files + '</pre>');
-          self.buildCSSBundle();
-          $iframe.remove();
-        });
-      };
-      head.appendChild(script);
-    };
-
-    return self;
-  };
-
-
   var RegistryBundleListItem = RegistryResourceListItem.extend({
     type: 'bundle',
+    active: false,
     template: _.template(
       '<a href="#"><%- name %></a> ' +
-      '<div class="plone-btn-group pull-right">' +
-        '<button class="plone-btn plone-btn-default build plone-btn-xs">Build</button>' +
-        '<button class="plone-btn plone-btn-danger delete plone-btn-xs">Delete</button>' +
+      '<div class="actions">' +
+        '<div class="plone-btn-group">' +
+          '<% if(view.options.data.development) { %>' +
+            '<% if(develop_javascript){ %>' +
+              '<button class="plone-btn plone-btn-warning on develop-js plone-btn-xs"><%- _t("Stop Developing JavaScript") %></button>' +
+            '<% } else { %>' +
+              '<button class="plone-btn plone-btn-default develop-js plone-btn-xs"><%- _t("Develop JavaScript") %></button>' +
+            '<% } %>' +
+            '<% if(develop_css){ %>' +
+              '<button class="plone-btn plone-btn-warning on develop-css plone-btn-xs"><%- _t("Stop Developing CSS") %></button>' +
+            '<% } else { %>' +
+              '<button class="plone-btn plone-btn-default develop-css plone-btn-xs"><%- _t("Develop CSS") %></button>' +
+            '<% } %>' +
+          '<% } %>' +
+          '<% if(compile){ %>' +
+            '<button class="plone-btn plone-btn-default build plone-btn-xs"><%- _t("Build") %></button>' +
+          '<% } %>' +
+          '<button class="plone-btn plone-btn-danger delete plone-btn-xs"><%- _t("Delete") %></button>' +
+        '</div>' +
       '</div>'
     ),
     events: $.extend({}, RegistryResourceListItem.prototype.events, {
-      'click button.build': 'buildClicked'
+      'click button.build': 'buildClicked',
+      'click button.develop-js': 'developJavaScriptClicked',
+      'click button.develop-css': 'developCSSClicked'
     }),
+    developJavaScriptClicked: function(e){
+      e.preventDefault();
+      this.options.data.develop_javascript = !this.options.data.develop_javascript;
+      this.options.registryView.dirty = true;
+      this.options.registryView.render();
+    },
+    developCSSClicked: function(e){
+      e.preventDefault();
+      this.options.data.develop_css = !this.options.data.develop_css;
+      this.options.registryView.dirty = true;
+      this.options.registryView.render();
+    },
+    afterRender: function(){
+      RegistryResourceListItem.prototype.afterRender.apply(this);
+      if(this.active){
+        this.editResource();
+      }
+    },
     editResource: function(e){
       if(e){
         e.preventDefault();
@@ -430,20 +250,34 @@ define([
         parent: this
       });
       var resource = new BundleEntryView(options);
-      this.registryView.showResourceEditor(resource);
+      this.registryView.showResourceEditor(resource, this, 'bundle');
+
+      // only one can be edited at a time, deactivate
+      _.each(this.options.registryView.items.bundles, function(bundleItem){
+        bundleItem.active = false;
+      });
+      this.active = true;
+      this.$el.parent().find('.list-group-item').removeClass('active');
+      this.$el.addClass('active');
     },
     deleteClicked: function(e){
       e.preventDefault();
-      delete this.options.registryView.options.data.bundles[this.options.name];
-      this.options.registryView.dirty = true;
-      this.options.registryView.render();
+      if(confirm(_t('Are you sure you want to delete the ' + this.options.name + ' bundle?'))){
+        delete this.options.registryView.options.data.bundles[this.options.name];
+        this.options.registryView.dirty = true;
+        this.options.registryView.render();
+      }
     },
     
     buildClicked: function(e){
       e.preventDefault();
       var self = this;
-      var builder = new Builder(self.options.name, self);
-      builder.run(); 
+      if(this.options.registryView.dirty){
+        alert(_t('You have unsaved changes. Save or discard before building.'));
+      }else{
+        var builder = new Builder(self.options.name, self);
+        builder.run();
+      }
     }
   });
 
@@ -451,6 +285,7 @@ define([
     tagName: 'div',
     className: 'tab-pane',
     $form: null,
+    activeResource: null,
 
     initialize: function(options) {
       var self = this;
@@ -472,7 +307,12 @@ define([
       */
     },
 
-    showResourceEditor: function(resource){
+    showResourceEditor: function(resource, view, type){
+      this.activeResource = {
+        resource: resource,
+        item: view,
+        type: type
+      };
       this.$form.empty().append(resource.render().el);
     },
 
@@ -488,7 +328,7 @@ define([
       if(e){
         e.preventDefault();
       }
-      if(confirm('Are you sure you want to cancel? You will lose all changes.')){
+      if(confirm(_t('Are you sure you want to cancel? You will lose all changes.'))){
         this._revertData(this.previousData);
         this.render();
       }
@@ -504,12 +344,12 @@ define([
     template: _.template(
       '<div class="clearfix">' +
         '<div class="plone-btn-group pull-right">' +
-          '<button class="plone-btn plone-btn-success save">Save</button>' +
-          '<button class="plone-btn plone-btn-default cancel">Cancel</button>' +
+          '<button class="plone-btn plone-btn-success save"><%- _t("Save") %></button>' +
+          '<button class="plone-btn plone-btn-default cancel"><%- _t("Cancel") %></button>' +
         '</div>' +
         '<div class="plone-btn-group pull-right">' +
-          '<button class="plone-btn plone-btn-default add-bundle">Add bundle</button>' +
-          '<button class="plone-btn plone-btn-default add-resource">Add resource</button>' +
+          '<button class="plone-btn plone-btn-default add-bundle"><%- _t("Add bundle") %></button>' +
+          '<button class="plone-btn plone-btn-default add-resource"><%- _t("Add resource") %></button>' +
         '</div>' +
       '</div>' +
       '<div class="row">' +
@@ -517,21 +357,23 @@ define([
           '<label>' +
             '<input type="checkbox" ' +
               '<% if(data.development){ %> checked="checked" <% } %>' +
-              ' > Development Mode(only logged in users)' +
+              ' > <%- _t("Development Mode(only logged in users)") %>' +
           '</label>' +
         '</div>' +
       '</div>' +
       '<div class="row">' +
         '<div class="items col-md-5">' +
           '<ul class="bundles list-group">' +
-            '<li class="list-group-item list-group-item-warning">Bundles</li>' +
+            '<li class="list-group-item list-group-item-warning"><%- _t("Bundles") %></li>' +
           '</ul>' +
-          '<ul class="resources list-group">' +
-            '<li class="list-group-item list-group-item-warning">Resources ' +
+          '<ul class="resources-header list-group">' +
+            '<li class="list-group-item list-group-item-warning"><%- _t("Resources") %> ' +
               '<input class="float-right form-control input-xs" ' +
-                      'placeholder="Filter..." />' +
+                      'placeholder="<%- _t("Filter...") %>" />' +
             '</li>' +
           '</ul>' +
+          '<ul class="resources list-group">' +
+          '</ul>' +
         '</div>' +
         '<div class="form col-md-7"></div>' +
       '</div>'),
@@ -540,7 +382,7 @@ define([
       'click button.add-resource': 'addResourceClicked',
       'click button.add-bundle': 'addBundleClicked',
       'click button.cancel': 'revertChanges',
-      'keyup .resources input': 'filterResources',
+      'keyup .resources-header input': 'filterResources',
       'change .development-mode input': 'developmentModeChanged'
     },
     filterTimeout: 0,
@@ -570,8 +412,8 @@ define([
         clearTimeout(self.filterTimeout);
       }
       self.filterTimeout = setTimeout(function(){
-        var filterText = self.$('.resources input').val().toLowerCase();
-        var $els = self.$('.resources .list-group-item:not(.list-group-item-warning)');
+        var filterText = self.$('.resources-header input').val().toLowerCase();
+        var $els = self.$('.resources .list-group-item');
         if(!filterText || filterText.length < 3){
           $els.removeClass('hidden');
         }else{
@@ -612,23 +454,38 @@ define([
         resources: {}
       };
       _.each(bundles, function(resourceName){
-        var item = new RegistryBundleListItem({
-          data: data.bundles[resourceName],
-          name: resourceName,
-          registryView: self});
+        var item;
+        if(self.activeResource && self.activeResource.type === 'bundle' && self.activeResource.item.options.name === resourceName){
+          item = self.activeResource.item;
+        }else{
+          item = new RegistryBundleListItem({
+            data: data.bundles[resourceName],
+            name: resourceName,
+            registryView: self});
+        }
         self.items.bundles[resourceName] = item;
         self.$bundles.append(item.render().el);
       });
       var resources = _.sortBy(_.keys(data.resources), function(v){ return v.toLowerCase(); });
       _.each(resources, function(resourceName){
-        var item = new RegistryResourceListItem({
-          data: data.resources[resourceName],
-          name: resourceName,
-          registryView: self});
+        var item;
+        if(self.activeResource && self.activeResource.type === 'resource' && self.activeResource.item.options.name === resourceName){
+          item = self.activeResource.item;
+        } else {
+          item = new RegistryResourceListItem({
+            data: data.resources[resourceName],
+            name: resourceName,
+            registryView: self});
+        }
         self.items.resources[resourceName] = item;
         self.$resources.append(item.render().el);
       });
       BaseResourcesPane.prototype.afterRender.apply(self);
+
+      // finally, show edit pane if there is an active resource
+      if(self.activeResource){
+        self.showResourceEditor(self.activeResource.resource, self.activeResource.item, self.activeResource.type);
+      }
       return self;
     },
 
@@ -674,6 +531,9 @@ define([
       }
       self.options.tabView.saveData('save-development-mode', {
         value: value
+      }, function(){
+        self.options.data.development = self.$('.development-mode input')[0].checked;
+        self.render();
       });
     }
   });
diff --git a/mockup/patterns/resourceregistry/pattern.js b/mockup/patterns/resourceregistry/pattern.js
index 863a068..93de78e 100644
--- a/mockup/patterns/resourceregistry/pattern.js
+++ b/mockup/patterns/resourceregistry/pattern.js
@@ -24,15 +24,21 @@
  *        data-pat-resourceregistry='{"bundles":{
  *                                     "plone": {
  *                                       "resources": ["plone"], "depends": "",
- *                                       "expression": "", "enabled": true, "conditionalcomment": ""
+ *                                       "expression": "", "enabled": true, "conditionalcomment": "",
+ *                                       "develop_javascript": false, "develop_css": false,
+ *                                       "compile": true
  *                                     },
  *                                     "plone-auth": {
  *                                       "resources": ["plone-auth"], "depends": "plone",
- *                                       "expression": "", "enabled": true, "conditionalcomment": ""
+ *                                       "expression": "", "enabled": true, "conditionalcomment": "",
+ *                                       "develop_javascript": false, "develop_css": false,
+ *                                       "compile": true
  *                                     },
  *                                     "barceloneta": {
  *                                       "resources": ["barceloneta"], "depends": "*",
- *                                       "expression": "", "enabled": true, "conditionalcomment": ""
+ *                                       "expression": "", "enabled": true, "conditionalcomment": "",
+ *                                       "develop_javascript": false, "develop_css": false,
+ *                                       "compile": false
  *                                     }
  *                                   },
  *                                   "resources": {
@@ -92,8 +98,10 @@ define([
   'mockup-patterns-resourceregistry-url/js/less',
   'mockup-patterns-resourceregistry-url/js/overrides',
   'mockup-patterns-resourceregistry-url/js/registry',
-  'mockup-patterns-resourceregistry-url/js/patternoptions'
-], function($, Base, _, BaseView, utils, LessVariablesView, OverridesView,RegistryView, PatternOptionsView) {
+  'mockup-patterns-resourceregistry-url/js/patternoptions',
+  'translate'
+], function($, Base, _, BaseView, utils, LessVariablesView,
+            OverridesView,RegistryView, PatternOptionsView, _t) {
   'use strict';
 
 
@@ -102,10 +110,10 @@ define([
     activeTab: 'registry',
     template: _.template('' +
       '<ul class="main-tabs nav nav-tabs" role="tablist">' +
-        '<li class="registry-btn"><a href="#">Registry</a></li>' +
-        '<li class="overrides-btn"><a href="#">Overrides</a></li>' +
-        '<li class="lessvariables-btn"><a href="#">Less Variables</a></li>' +
-        '<li class="patternoptions-btn"><a href="#">Pattern Options</a></li>' +
+        '<li class="registry-btn"><a href="#"><%- _t("Registry") %></a></li>' +
+        '<li class="overrides-btn"><a href="#"><%- _t("Overrides") %></a></li>' +
+        '<li class="lessvariables-btn"><a href="#"><%- _t("Less Variables") %></a></li>' +
+        '<li class="patternoptions-btn"><a href="#"><%- _t("Pattern Options") %></a></li>' +
       '</div>' +
       '<div class="tab-content" />'
     ),
@@ -146,7 +154,7 @@ define([
 
     render: function(){
       var self = this;
-      self.$el.append(self.template());
+      self.$el.append(self.template({_t: _t}));
       self.loading = new utils.Loading();
       self.$tabs = self.$('ul.main-tabs');
       self.$content = self.$('.tab-content');
@@ -204,7 +212,7 @@ define([
         if(onError){
           onError(resp);
         }else{
-          alert('Error processing ajax request for action: ' + action);
+          alert(_t('Error processing ajax request for action: ') + action);
         }
       });
     }
diff --git a/mockup/patterns/resourceregistry/pattern.resourceregistry.less b/mockup/patterns/resourceregistry/pattern.resourceregistry.less
index 17958dd..fe244e3 100644
--- a/mockup/patterns/resourceregistry/pattern.resourceregistry.less
+++ b/mockup/patterns/resourceregistry/pattern.resourceregistry.less
@@ -1,11 +1,44 @@
 @import "@{mockuplessPath}/ui.less";
 @import (less) "@{bowerPath}/select2/select2.css";
 
+@import (reference) "@{bowerPath}/bootstrap/less/list-group.less";
+@import (reference) "@{bowerPath}/bootstrap/less/forms.less";
+@import (reference) "@{bowerPath}/bootstrap/less/input-groups.less";
+@import (reference) "@{bowerPath}/bootstrap/less/type.less";
+@import (reference) "@{bowerPath}/bootstrap/less/navs.less";
+
 
 .pat-resourceregistry {
-    @import "@{bowerPath}/bootstrap/less/list-group.less";
-    @import "@{bowerPath}/bootstrap/less/forms.less";
-    @import "@{bowerPath}/bootstrap/less/input-groups.less";
+
+    .list-group:extend(.list-group all){}
+    .list-group-item:extend(.list-group-item all){}
+    .list-group-item-variant(warning; @state-warning-bg; @state-warning-text);
+
+    .input-group:extend(.input-group all){}
+    .input-group-addon:extend(.input-group-addon all){}
+    .input-group-btn:extend(.input-group-btn all){}
+
+    .text-primary:extend(.text-primary all){}
+
+    .navbar:extend(.navbar all){}
+    .navbar-search:extend(.navbar-search all){}
+    .nav:extend(.nav all){}
+    .nav-tabs:extend(.nav-tabs all){}
+    .tab-content:extend(.tab-content all){
+      > .tab-pane {
+        display: none;
+      }
+      > .active {
+        display: block;
+      }
+    }
+
+    .form-group:extend(.form-group all){}
+    .help-block:extend(.help-block all){}
+    .checkbox:extend(.checkbox all){}
+    .form-control:extend(.form-control all){}
+    .input-sm:extend(.input-sm all){}
+    .control-label:extend(.control-label all){}
 
     .nav-tabs{
         a {
@@ -17,7 +50,23 @@
             font-size: 11px; /* need to try and fit long strings */
         }
     }
+    .resources-header.list-group{
+        margin-bottom: 0;
+        li{
+            border-bottom: 0;
+            border-bottom-right-radius: 0;
+            border-bottom-left-radius: 0;
+        }
+    }
     .resources.list-group{
+        max-height: 700px;
+        overflow-x: scroll;
+
+        li{
+            border-top-right-radius: 0;
+            border-top-left-radius: 0;
+        }
+
         .list-group-item-warning{
             position: relative;
 
diff --git a/mockup/patterns/select2/pattern.select2.less b/mockup/patterns/select2/pattern.select2.less
index 7f03628..44a0b43 100644
--- a/mockup/patterns/select2/pattern.select2.less
+++ b/mockup/patterns/select2/pattern.select2.less
@@ -12,3 +12,6 @@
     cursor: move;
 }
 
+.pat-select2{
+    min-width:50%;
+}
\ No newline at end of file
diff --git a/mockup/patterns/structure/js/views/addmenu.js b/mockup/patterns/structure/js/views/addmenu.js
index d84b44a..592be7b 100644
--- a/mockup/patterns/structure/js/views/addmenu.js
+++ b/mockup/patterns/structure/js/views/addmenu.js
@@ -6,10 +6,9 @@ define([
   'backbone',
   'mockup-ui-url/views/buttongroup',
   'mockup-ui-url/views/button',
-  'mockup-patterns-modal',
   'mockup-utils',
   'bootstrap-dropdown'
-], function($, _, Backbone, ButtonGroup, ButtonView, Modal, utils) {
+], function($, _, Backbone, ButtonGroup, ButtonView, utils) {
   'use strict';
 
   var AddMenu = ButtonGroup.extend({
@@ -49,7 +48,10 @@ define([
       var self = this;
       e.preventDefault();
       self.app.loading.show();
-
+      window.location = button.url;
+      /* Do not launch in overlay otherwise you get overlays insides of
+         overlays potentials--nasty. Leave here if we change our mind
+         for some reason.
       $.ajax({
         url: button.url,
         type: 'POST',
@@ -95,6 +97,7 @@ define([
           self.app.loading.hide();
         }
       });
+    */
     },
     render: function() {
       var self = this;
diff --git a/mockup/patterns/structure/js/views/app.js b/mockup/patterns/structure/js/views/app.js
index e78c3c5..391bafd 100644
--- a/mockup/patterns/structure/js/views/app.js
+++ b/mockup/patterns/structure/js/views/app.js
@@ -179,14 +179,54 @@ define([
 
       self.collection.on('pager', function() {
         self.loading.show();
-        window.location.hash = self.queryHelper.getCurrentPath();
-      });
 
-      /* detect key events */
-      $(document).bind('keyup keydown', function(e) {
-        self.keyEvent = e;
+        /* maintain history here */
+        if(self.options.urlStructure && window.history && window.history.pushState){
+          if (!self.doNotPushState){
+            var path = self.queryHelper.getCurrentPath();
+            if(path === '/'){
+              path = '';
+            }
+            var url = self.options.urlStructure.base + path + self.options.urlStructure.appended;
+            window.history.pushState(null, null, url);
+            $('body').trigger('structure-url-changed', path);
+          }else{
+            self.doNotPushState = false;
+          }
+        }
       });
 
+      if (self.options.urlStructure && window.history && window.history.pushState){
+        $(window).bind('popstate', function () {
+          /* normalize this url first... */
+          var url = window.location.href;
+          if(url.indexOf('?') !== -1){
+            url = url.split('?')[0];
+          }
+          if(url.indexOf('#') !== -1){
+            url = url.split('#')[0];
+          }
+          // take off the base url
+          var path = url.substring(self.options.urlStructure.base.length);
+          if(path.substring(path.length - self.options.urlStructure.appended.length) ===
+              self.options.urlStructure.appended){
+            /* check that it ends with appended value */
+            path = path.substring(0, path.length - self.options.urlStructure.appended.length);
+          }
+          if(!path){
+            path = '/';
+          }
+          self.queryHelper.currentPath = path;
+          $('body').trigger('structure-url-changed', path);
+          // since this next call causes state to be pushed...
+          self.doNotPushState = true;
+          self.collection.goTo(self.collection.information.firstPage);
+        });
+        /* detect key events */
+        $(document).bind('keyup keydown', function(e) {
+          self.keyEvent = e;
+        });
+      }
     },
     inQueryMode: function() {
       if (this.additionalCriterias.length > 0) {
diff --git a/mockup/patterns/structure/js/views/columns.js b/mockup/patterns/structure/js/views/columns.js
index 8f6d68a..8b4ef8e 100644
--- a/mockup/patterns/structure/js/views/columns.js
+++ b/mockup/patterns/structure/js/views/columns.js
@@ -70,8 +70,3 @@ define([
 
   return ColumnsView;
 });
-
-
-
-
-
diff --git a/mockup/patterns/structure/less/pattern.structure.less b/mockup/patterns/structure/less/pattern.structure.less
index 3b2c7a3..6f99f87 100644
--- a/mockup/patterns/structure/less/pattern.structure.less
+++ b/mockup/patterns/structure/less/pattern.structure.less
@@ -1,19 +1,73 @@
+@import "@{bowerPath}/bootstrap/less/variables.less"; // Modify this for custom colors, font-sizes, etc
+@icon-font-path: "@{bowerPath}/bootstrap/dist/fonts/";
+@import "@{bowerPath}/bootstrap/less/glyphicons.less";
+
+@import "@{bowerPath}/bootstrap/less/mixins.less";
+@import "@{bowerPath}bootstrap/less/utilities.less";
+@import (reference) "@{bowerPath}/bootstrap/less/buttons.less";
+@import (reference) "@{bowerPath}/bootstrap/less/button-groups.less";
+@import (reference) "@{bowerPath}/bootstrap/less/badges.less";
+@import (reference) "@{bowerPath}/bootstrap/less/popovers.less";
+@import (reference) "@{bowerPath}/bootstrap/less/pagination.less";
+@import (reference) "@{bowerPath}/bootstrap/less/input-groups.less";
+@import (reference) "@{bowerPath}/bootstrap/less/tables.less";
+@import (reference) "@{bowerPath}/bootstrap/less/dropdowns.less";
+@import (reference) "@{bowerPath}/bootstrap/less/forms.less";
+@import (reference) "@{bowerPath}/bootstrap/less/navbar.less";
+@import (reference) "@{bowerPath}/bootstrap/less/navs.less";
+@import (reference) "@{bowerPath}/bootstrap/less/tooltip.less";
+@import (reference) "@{bowerPath}/bootstrap/less/component-animations.less";
+@import (reference) "@{mockuplessPath}/popover.less";
+
+
+/*
+@import "@{bowerPath}bootstrap/less/tooltip.less";
+*/
 
 .pat-structure {
 
-    @import "@{bowerPath}/bootstrap/less/variables.less"; // Modify this for custom colors, font-sizes, etc
-    @icon-font-path: "@{bowerPath}/bootstrap/dist/fonts/";
-
-    @import "@{bowerPath}/bootstrap/less/mixins.less";
-    @import "@{bowerPath}/bootstrap/less/buttons.less";
-    @import "@{bowerPath}/bootstrap/less/button-groups.less";
-    @import "@{bowerPath}/bootstrap/less/glyphicons.less";
-    @import "@{bowerPath}/bootstrap/less/badges.less";
-    @import "@{bowerPath}/bootstrap/less/popovers.less";
-    @import "@{bowerPath}/bootstrap/less/pagination.less";
-    @import "@{bowerPath}/bootstrap/less/tables.less";
-    @import "@{mockuplessPath}/popover.less";
-
+    .fade:extend(.fade all){}
+    .collapse:extend(.collapse all){}
+    .collapsing:extend(.collapsing all){}
+
+    .popover:extend(.popover all){}
+    .popover-title:extend(.popover-title all){}
+    .popover-content:extend(.popover-content all){}
+    .arrow:extend(.arrow all){}
+    .tooltip:extend(.tooltip all){}
+    .tooltip-arrow:extend(.tooltip-arrow all){}
+    .tooltip-inner:extend(.tooltip-inner all){}
+
+    .table:extend(.table all){}
+    .pagination:extend(.pagination all){}
+
+    .btn:extend(.btn all){}
+    .btn-default:extend(.btn-default all){}
+    .btn-danger:extend(.btn-danger all){}
+    .btn-primary:extend(.btn-primary all){}
+    .btn-group:extend(.btn-group all){}
+    .btn-success:extend(.btn-success all){}
+    .input-group:extend(.input-group all){}
+    .input-group-addon:extend(.input-group-addon all){}
+    .input-group-btn:extend(.input-group-btn all){}
+    .dropdown-menu:extend(.dropdown-menu all){}
+    .dropdown-toggle:extend(.dropdown-toggle all){}
+    .dropdown-header:extend(.dropdown-header all){}
+    .divider:extend(.divider all){}
+
+    .table-striped:extend(.table-striped all){}
+    .table-bordered:extend(.table-bordered all){}
+
+    .navbar:extend(.navbar all){}
+    .navbar-search:extend(.navbar-search all){}
+    .form-search:extend(.form-search all){}
+    .ui-offset-parent:extend(.ui-offset-parent all){}
+
+    .form-group:extend(.form-group all){}
+    .help-block:extend(.help-block all){}
+    .checkbox:extend(.checkbox all){}
+
+    .open:extend(.open all){}
 
     .btn{
         .btn-xs();
diff --git a/mockup/patterns/structure/pattern.js b/mockup/patterns/structure/pattern.js
index ddb4b83..13c7fd1 100644
--- a/mockup/patterns/structure/pattern.js
+++ b/mockup/patterns/structure/pattern.js
@@ -45,6 +45,9 @@ define([
     name: 'structure',
     trigger: '.pat-structure',
     defaults: {
+      // for implementing history changes
+      // Example: {base: 'http://mysite.com', appended: '/folder_contents'}
+      urlStructure: null,
       vocabularyUrl: null,
       tagsVocabularyUrl: null,
       usersVocabularyUrl: null,
@@ -64,6 +67,8 @@ define([
         'review_state'
       ],
       availableColumns: {
+        'id': _t('ID'),
+        'Title': _t('Title'),
         'ModificationDate': _t('Last modified'),
         'EffectiveDate': _t('Published'),
         'ExpirationDate': _t('Expiration'),
diff --git a/mockup/patterns/thememapper/pattern.thememapper.less b/mockup/patterns/thememapper/pattern.thememapper.less
index 0ea8d9d..6a7a82d 100644
--- a/mockup/patterns/thememapper/pattern.thememapper.less
+++ b/mockup/patterns/thememapper/pattern.thememapper.less
@@ -1,3 +1,6 @@
+@import "@{mockuplessPath}/ui.less";
+/* just be lazy here and include all of bootstrap... */
+@import "@{mockupPath}/filemanager/pattern.filemanager.less";
 
 .pat-thememapper{
     iframe{
@@ -21,7 +24,7 @@
         line-height: 12px;
         padding: 0 0 0 18px;
         margin: 4px 0 0 2px;
-        background-image: url('./full.png');
+        background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAD8GlDQ1BJQ0MgUHJvZmlsZQAAKJGNVd1v21QUP4lvXKQWP6Cxjg4Vi69VU1u5GxqtxgZJk6XpQhq5zdgqpMl1bhpT1za2021Vn/YCbwz4A4CyBx6QeEIaDMT2su0BtElTQRXVJKQ9dNpAaJP2gqpwrq9Tu13GuJGvfznndz7v0TVAx1ea45hJGWDe8l01n5GPn5iWO1YhCc9BJ/RAp6Z7TrpcLgIuxoVH1sNfIcHeNwfa6/9zdVappwMknkJsVz19HvFpgJSpO64PIN5G+fAp30Hc8TziHS4miFhheJbjLMMzHB8POFPqKGKWi6TXtSriJcT9MzH5bAzzHIK1I08t6hq6zHpRdu2aYdJYuk9Q/881bzZa8Xrx6fLmJo/iu4/VXnfH1BB/rmu5ScQvI77m+BkmfxXxvcZcJY14L0DymZp7pML5yTcW61PvIN6JuGr4halQvmjNlCa4bXJ5zj6qhpxrujeKPYMXEd+q00KR5yNAlWZzrF+Ie+uNsdC/MO4tTOZafhbroyXuR3Df08bLiHsQf+ja6gTPWVimZl7l/oUrjl8OcxDWLbNU5D6JRL2gxkDu16fGuC054OMhclsyXTOOFEL+kmMGs4i5kfNuQ62EnBuam8tzP+Q+tSqhz9SuqpZlvR1EfBiOJTSgYMMM7jpYsAEyqJCHDL4dcFFTAwNMlFDUUpQYiadhDmXteeWAw3HEmA2s15k1RmnP4RHuhBybdBOF7MfnICmSQ2SYjIBM3iRvkcMki9IRcnDTthyLz2Ld2fTzPjTQK+Mdg8y5nkZfFO+se9LQr3/09xZr+5GcaSufeAfAww60mAPx+q8u/bAr8rFCLrx7s+vqEkw8qb+p26n11Aruq6m1iJH6PbWGv1VIY25mkNE8PkaQhxfLIF7DZXx80HD/A3l2jLclYs061xNpWCfoB6WHJTjbH0mV35Q/lRXlC+W8cndbl9t2SfhU+Fb4UfhO+F74GWThknBZ+Em4InwjXIyd1ePnY/Psg3pb1TJNu15TMKWMtFt6ScpKL0ivSMXIn9QtDUlj0h7U7N48t3i8eC0GnMC91dX2sTivgloDTgUVeEGHLTizbf5Da9JLhkhh29QOs1luMcScmBXTIIt7xRFxSBxnuJWfuAd1I7jntkyd/pgKaIwVr3MgmDo2q8x6IdB5QH162mcX7ajtnHGN2bov71OU1+U0fqqoXLD0wX5ZM005UHmySz3qLtDqILDvIL+iH6jB9y2x83ok898GOPQX3lk3Itl0A+BrD6D7tUjWh3fis58BXDigN9yF8M5PJH4B8Gr79/F/XRm8m241mw/wvur4BGDj42bzn+Vmc+NL9L8GcMn8F1kAcXjEKMJAAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVQokX3SMUoEQRAF0Nczy4ZipmggCLp6AJP1CIIewBuYzKH2El7EYFdW1kRMxdwyqZGmR7ahqKb6/1+/q7tEhHaVUkpERCnlEbc4xiWORMQk0GW+wzciY9tN5LNJ5jd8VPXXfepL7FJ5gy+sZo33Dh1+cIMzvOMeC5z+qaJvOs0xYFnVejUwbQyYN+S+suoJD7iqPA95OBuBFdkqL7RO8G600YJHwnM15zWuRxv/vVGHi2pQJzjP/fQLpMcDvOSsP3G4j/AL85OZj4EeME0AAAAASUVORK5CYII=');
         background-repeat: no-repeat;
         text-decoration: none;
         border-bottom: none !important;
@@ -30,7 +33,7 @@
         content: none;
     }
     .fullscreenActive {
-        background-image: url('./small.png');
+        background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAD8GlDQ1BJQ0MgUHJvZmlsZQAAKJGNVd1v21QUP4lvXKQWP6Cxjg4Vi69VU1u5GxqtxgZJk6XpQhq5zdgqpMl1bhpT1za2021Vn/YCbwz4A4CyBx6QeEIaDMT2su0BtElTQRXVJKQ9dNpAaJP2gqpwrq9Tu13GuJGvfznndz7v0TVAx1ea45hJGWDe8l01n5GPn5iWO1YhCc9BJ/RAp6Z7TrpcLgIuxoVH1sNfIcHeNwfa6/9zdVappwMknkJsVz19HvFpgJSpO64PIN5G+fAp30Hc8TziHS4miFhheJbjLMMzHB8POFPqKGKWi6TXtSriJcT9MzH5bAzzHIK1I08t6hq6zHpRdu2aYdJYuk9Q/881bzZa8Xrx6fLmJo/iu4/VXnfH1BB/rmu5ScQvI77m+BkmfxXxvcZcJY14L0DymZp7pML5yTcW61PvIN6JuGr4halQvmjNlCa4bXJ5zj6qhpxrujeKPYMXEd+q00KR5yNAlWZzrF+Ie+uNsdC/MO4tTOZafhbroyXuR3Df08bLiHsQf+ja6gTPWVimZl7l/oUrjl8OcxDWLbNU5D6JRL2gxkDu16fGuC054OMhclsyXTOOFEL+kmMGs4i5kfNuQ62EnBuam8tzP+Q+tSqhz9SuqpZlvR1EfBiOJTSgYMMM7jpYsAEyqJCHDL4dcFFTAwNMlFDUUpQYiadhDmXteeWAw3HEmA2s15k1RmnP4RHuhBybdBOF7MfnICmSQ2SYjIBM3iRvkcMki9IRcnDTthyLz2Ld2fTzPjTQK+Mdg8y5nkZfFO+se9LQr3/09xZr+5GcaSufeAfAww60mAPx+q8u/bAr8rFCLrx7s+vqEkw8qb+p26n11Aruq6m1iJH6PbWGv1VIY25mkNE8PkaQhxfLIF7DZXx80HD/A3l2jLclYs061xNpWCfoB6WHJTjbH0mV35Q/lRXlC+W8cndbl9t2SfhU+Fb4UfhO+F74GWThknBZ+Em4InwjXIyd1ePnY/Psg3pb1TJNu15TMKWMtFt6ScpKL0ivSMXIn9QtDUlj0h7U7N48t3i8eC0GnMC91dX2sTivgloDTgUVeEGHLTizbf5Da9JLhkhh29QOs1luMcScmBXTIIt7xRFxSBxnuJWfuAd1I7jntkyd/pgKaIwVr3MgmDo2q8x6IdB5QH162mcX7ajtnHGN2bov71OU1+U0fqqoXLD0wX5ZM005UHmySz3qLtDqILDvIL+iH6jB9y2x83ok898GOPQX3lk3Itl0A+BrD6D7tUjWh3fis58BXDigN9yF8M5PJH4B8Gr79/F/XRm8m241mw/wvur4BGDj42bzn+Vmc+NL9L8GcMn8F1kAcXjEKMJAAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1klEQVQokW3SMUoDURDG8d9sIuwFLPQGYrF94g0WPIAnsLT1LmJpn1NYB7FLYwotbAUFccciEwnrPhj+j3nz+L4382SmqUCLtvYd1uinCpviAisssUViM3VhVryson28oGv8X1E8LX4VrzJz3UBENBExi4gjzKvgrNgWbyOinUNmDpX8wXftn3CPZ7zhfS/f4gLHOME5HjPzbsLun/wN+oP8R1ltS3XYGclh35lldeKzeF35+biLTUR0eBg98LWYU7Y2dbAtpRUWh0MczUlvN/Zu/CWm4hfV25ukt9oGAwAAAABJRU5ErkJggg==');
     }
 
     .refresh {
@@ -39,7 +42,7 @@
         line-height: 12px;
         padding: 0 0 0 12px;
         margin: 4px 0 0 5px;
-        background-image: url('./refresh.png');
+        background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAEJGlDQ1BJQ0MgUHJvZmlsZQAAOBGFVd9v21QUPolvUqQWPyBYR4eKxa9VU1u5GxqtxgZJk6XtShal6dgqJOQ6N4mpGwfb6baqT3uBNwb8AUDZAw9IPCENBmJ72fbAtElThyqqSUh76MQPISbtBVXhu3ZiJ1PEXPX6yznfOec7517bRD1fabWaGVWIlquunc8klZOnFpSeTYrSs9RLA9Sr6U4tkcvNEi7BFffO6+EdigjL7ZHu/k72I796i9zRiSJPwG4VHX0Z+AxRzNRrtksUvwf7+Gm3BtzzHPDTNgQCqwKXfZwSeNHHJz1OIT8JjtAq6xWtCLwGPLzYZi+3YV8DGMiT4VVuG7oiZpGzrZJhcs/hL49xtzH/Dy6bdfTsXYNY+5yluWO4D4neK/ZUvok/17X0HPBLsF+vuUlhfwX4j/rSfAJ4H1H0qZJ9dN7nR19frRTeBt4Fe9FwpwtN+2p1MXscGLHR9SXrmMgjONd1ZxKzpBeA71b4tNhj6JGoyFNp4GHgwUp9qplfmnFW5oTdy7NamcwCI49kv6fN5IAHgD+0rbyoBc3SOjczohbyS1drbq6pQdqumllRC/0ymTtej8gpbbuVwpQfyw66dqEZyxZKxtHpJn+tZnpnEdrYBbueF9qQn93S7HQGGHnYP7w6L+YGHNtd1FJitqPAR+hERCNOFi1i1alKO6RQnjKUxL1GNjwlMsiEhcPLYTEiT9ISbN15OY/jx4SMshe9LaJRpTvHr3C/ybFYP1PZAfwfYrPsMBtnE6SwN9ib7AhLwTrBDgUKcm06FSrTfSj187xPdVQWOk5Q8vxAfSiIUc7Z7xr6zY/+hpqwSyv0I0/QMTRb7RMgBxNodTfSPqdraz/sDjzKBrv4zu2+a2t0/HHzjd2Lbcc2sG7GtsL42K+xLfxtUgI7YHqKlqHK8HbCCXgjHT1cAdMlDetv4FnQ2lLasaOl6vmB0CMmwT/IPszSueHQqv6i/qluqF+oF9TfO2qEGTumJH0qfSv9KH0nfS/9TIp0Wboi/SRdlb6RLgU5u++9nyXYe69fYRPdil1o1WufNSdTTsp75BfllPy8/LI8G7AUuV8ek6fkvfDsCfbNDP0dvRh0CrNqTbV7LfEEGDQPJQadBtfGVMWEq3QWWdufk6ZSNsjG2PQjp3ZcnOWWing6noonSInvi0/Ex+IzAreevPhe+CawpgP1/pMTMDo64G0sTCXIM+KdOnFWRfQKdJvQzV1+Bt8OokmrdtY2yhVX2a+qrykJfMq4Ml3VR4cVzTQVz+UoNne4vcKLoyS+gyKO6EHe+75Fdt0Mbe5bRIf/wjvrVmhbqBN97RD1vxrahvBOfOYzoosH9bq94uejSOQGkVM6sN/7HelL4t10t9F4gPdVzydEOx83Gv+uNxo7XyL/FtFl8z9ZAHF4bBsrEwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAO5JREFUKBWNkb0RgkAQhe8ccrEDZwgIhQ6wErEDS6EE7IAOpATMIKAGNWcGv3dyigm6M8v+vfduj7PjOBpvcRwfrLU59ZZ+SKzxahiGKgiCuuu61IoQRdFaDYYJLru/ghHpbRDsSpUHo15TJgw2cuW4J5OC1RrEROC2bfeuy2c69UT6dYqFcGGtjIGUr8RFWwF2x/4DlpK79KLkNGSTm1J36V8EwDswIfdsAoFpfB7DmJL1jnMRgIV+P146wmyoX1j4WsoTOKPXIHSeEwQONQCoXBZKGWt47UyJv4PW0EPleIUblEVSnjNL+75/qP8E/EloRr2HQksAAAAASUVORK5CYII=');
         background-repeat: no-repeat;
         text-decoration: none;
         border-bottom: none !important;
diff --git a/mockup/patterns/tinymce/js/links.js b/mockup/patterns/tinymce/js/links.js
index 42af3cb..dfe2265 100644
--- a/mockup/patterns/tinymce/js/links.js
+++ b/mockup/patterns/tinymce/js/links.js
@@ -367,7 +367,7 @@ define([
       self.modal = registry.patterns.modal.init(self.$el, {
         html: self.generateModalHtml(),
         content: null,
-        buttons: '.btn'
+        buttons: '.plone-btn'
       });
       self.modal.on('shown', function(e) {
         self.modalShown.apply(self, [e]);
@@ -376,6 +376,7 @@ define([
 
     generateModalHtml: function() {
       return this.template({
+        upload: this.options.upload,
         text: this.options.text,
         insertHeading: this.options.text.insertHeading,
         linkTypes: this.options.linkTypes,
@@ -500,15 +501,17 @@ define([
       self.initElements();
       self.initData();
       // upload init
-      self.$upload = $('.uploadify-me', self.modal.$modal);
-      self.options.upload.relatedItems = self.options.relatedItems;
-      self.$upload.addClass('pat-upload').patternUpload(self.options.upload);
-      self.$upload.on('uploadAllCompleted', function(evt, data) {
-        self.$upload.attr({
-          'data-filename': data.files ? data.files[0].name : '',
-          'data-path': data.path
+      if(self.options.upload){
+        self.$upload = $('.uploadify-me', self.modal.$modal);
+        self.options.upload.relatedItems = self.options.relatedItems;
+        self.$upload.addClass('pat-upload').patternUpload(self.options.upload);
+        self.$upload.on('uploadAllCompleted', function(evt, data) {
+          self.$upload.attr({
+            'data-filename': data.files ? data.files[0].name : '',
+            'data-path': data.path
+          });
         });
-      });
+      }
 
       self.$button.off('click').on('click', function(e) {
         e.preventDefault();
diff --git a/mockup/patterns/tinymce/less/pattern.tinymce.less b/mockup/patterns/tinymce/less/pattern.tinymce.less
index 5135c1f..a15b854 100644
--- a/mockup/patterns/tinymce/less/pattern.tinymce.less
+++ b/mockup/patterns/tinymce/less/pattern.tinymce.less
@@ -1,11 +1,8 @@
-@import (less) "@{bowerPath}/tinymce-builded/js/tinymce/skins/lightgray/skin.min.css";
-@import (inline) "@{bowerPath}/tinymce-builded/js/tinymce/skins/lightgray/content.inline.min.css";
+@import (less) "@{bowerPath}/tinymce-builded/js/tinymce/skins/lightgray/skin.less";
+@import (inline) "@{bowerPath}/tinymce-builded/js/tinymce/skins/lightgray/Content.less";
 @import (inline) "@{bowerPath}/tinymce-builded/js/tinymce/plugins/visualblocks/css/visualblocks.css";
 @import "@{mockupPath}/modal/pattern.modal.less";
 @import "@{mockupPath}/autotoc/pattern.autotoc.less";
-@import "@{bowerPath}/bootstrap/less/buttons.less";
-@import "@{bowerPath}/bootstrap/less/button-groups.less";
-@import "@{bowerPath}/bootstrap/less/close.less";
 @import "@{mockupPath}/upload/less/pattern.upload.less";
 
 div.linkModal {
diff --git a/mockup/patterns/tinymce/pattern.js b/mockup/patterns/tinymce/pattern.js
index 4853d45..dd293ad 100644
--- a/mockup/patterns/tinymce/pattern.js
+++ b/mockup/patterns/tinymce/pattern.js
@@ -118,7 +118,7 @@ define([
       },
       relatedItems: {
         // UID attribute is required here since we're working with related items
-        attributes: ['UID', 'Title', 'Description', 'getURL', 'Type', 'path', 'ModificationDate'],
+        attributes: ['UID', 'Title', 'Description', 'getURL', 'Type', 'path', 'ModificationDate', 'getIcon'],
         batchSize: 20,
         basePath: '/',
         vocabularyUrl: null,
@@ -149,6 +149,7 @@ define([
       linkAttribute: 'path', // attribute to get link value from data
       prependToScalePart: '/imagescale/', // some value here is required to be able to parse scales back
       appendToScalePart: '',
+      appendToOriginalScalePart: '',
       scales: _t('Listing (16x16):listing,Icon (32x32):icon,Tile (64x64):tile,' +
               'Thumb (128x128):thumb,Mini (200x200):mini,Preview (400x400):preview,' +
               'Large (768x768):large'),
@@ -159,38 +160,37 @@ define([
         {text: _t('Open in top frame (replaces all frames)'), value: '_top'}
       ],
       imageTypes: 'Image',
-      folderTypes: 'Folder,Plone Site',
+      folderTypes: ['Folder', 'Plone Site'],
       linkableTypes: 'Document,Event,File,Folder,Image,News Item,Topic',
       tiny: {
         'content_css': '../../../bower_components/tinymce-builded/js/tinymce/skins/lightgray/content.min.css',
         theme: '-modern',
         plugins: [
-          '-advlist -autolink -lists -charmap -print -preview -anchor ' +
-          '-searchreplace -visualblocks -code -fullscreen -autoresize ' +
-          '-insertdatetime -media -table -contextmenu -paste -plonelink -ploneimage'
+          'advlist autolink lists charmap print preview anchor ' +
+          'searchreplace visualblocks code fullscreen ' +
+          'insertdatetime media table contextmenu paste plonelink ploneimage'
         ],
         menubar: 'edit table format tools view insert',
         toolbar: 'undo redo | styleselect | bold italic | ' +
                  'alignleft aligncenter alignright alignjustify | ' +
                  'bullist numlist outdent indent | ' +
                  'unlink plonelink ploneimage',
-        'autoresize_max_height': 1500
+        //'autoresize_max_height': 900,
+        'height': 400
       }
     },
     addLinkClicked: function() {
       var self = this;
       if (self.linkModal === null) {
         var $el = $('<div/>').insertAfter(self.$el);
+        var linkTypes = ['internal', 'upload', 'external', 'email', 'anchor'];
+        if(!self.options.upload){
+          linkTypes.splice(1, 1);
+        }
         self.linkModal = new LinkModal($el,
           $.extend(true, {}, self.options, {
             tinypattern: self,
-            linkTypes: [
-              'internal',
-              'upload',
-              'external',
-              'email',
-              'anchor'
-            ]
+            linkTypes: linkTypes
           })
         );
         self.linkModal.show();
@@ -202,9 +202,13 @@ define([
     addImageClicked: function() {
       var self = this;
       if (self.imageModal === null) {
+        var linkTypes = ['image', 'uploadImage', 'externalImage'];
+        if(!self.options.upload){
+          linkTypes.splice(1, 1);
+        }
         var options = $.extend(true, {}, self.options, {
           tinypattern: self,
-          linkTypes: ['image', 'uploadImage', 'externalImage'],
+          linkTypes: linkTypes,
           initialLinkType: 'image',
           text: {
             insertHeading: _t('Insert Image')
@@ -213,9 +217,9 @@ define([
             baseCriteria: [{
               i: 'Type',
               o: 'plone.app.querystring.operation.list.contains',
-              v: self.options.imageTypes.split(',').concat(self.options.folderTypes.split(','))
+              v: self.options.imageTypes.concat(self.options.folderTypes)
             }],
-            selectableTypes: self.options.imageTypes.split(','),
+            selectableTypes: self.options.imageTypes,
             resultTemplate: ResultTemplate,
             selectionTemplate: SelectionTemplate
           }
@@ -233,12 +237,20 @@ define([
       var part = data[self.options.linkAttribute];
       return self.options.prependToUrl + part + self.options.appendToUrl;
     },
-    generateImageUrl: function(data, scale) {
+    generateImageUrl: function(data, scale_name) {
       var self = this;
       var url = self.generateUrl(data);
-      if (scale !== ""){
-          url = (url + self.options.prependToScalePart + scale +
-                 self.options.appendToScalePart);
+      if (scale_name !== ""){
+        var part = scale_name;
+        for(var i=0; i<self.options.scales.length; i++){
+          if(self.options.scales[i].name == scale_name){
+            part = self.options.scales[i].part;
+          }
+        }
+        url = (url + self.options.prependToScalePart + part +
+               self.options.appendToScalePart);
+      }else{
+        url = url + self.options.appendToOriginalScalePart;
       }
       return url;
     },
@@ -340,8 +352,26 @@ define([
       };
 
       self.initLanguage(function() {
+        if(typeof(self.options.scales) === 'string'){
+          self.options.scales = _.map(self.options.scales.split(','), function(scale){
+            var scale = scale.split(':');
+            return {
+              part: scale[1],
+              name: scale[1],
+              label: scale[0]
+            }
+          });
+        }
+        if(typeof(self.options.folderTypes) === 'string'){
+          self.options.folderTypes = self.options.folderTypes.split(',');
+        }
+        if(typeof(self.options.imageTypes) === 'string'){
+          self.options.imageTypes = self.options.imageTypes.split(',');
+        }
+
         tinymce.init(tinyOptions);
         self.tiny = tinymce.get(id);
+
         /* tiny really should be doing this by default
          * but this fixes overlays not saving data */
         var $form = self.$el.parents('form');
diff --git a/mockup/patterns/tinymce/templates/image.xml b/mockup/patterns/tinymce/templates/image.xml
index 42b7872..be5a307 100644
--- a/mockup/patterns/tinymce/templates/image.xml
+++ b/mockup/patterns/tinymce/templates/image.xml
@@ -1,7 +1,9 @@
 <div>
   <div class="linkModal">
     <h1><%- insertHeading %></h1>
+    <% if(upload){ %>
     <p class="info">Drag and drop files from your desktop onto dialog to upload</p>
+    <% } %>
 
     <div class="linkTypes pat-autotoc autotabs"
          data-pat-autotoc="section:fieldset;levels:legend;">
@@ -16,10 +18,9 @@
             <label><%- scaleText %></label>
             <select name="scale">
               <option value="">Original</option>
-                <% _.each(scales.split(','), function(scale){ %>
-                  <% var scale = scale.split(':'); %>
-                  <option value="<%- scale[1] %>">
-                    <%- scale[0] %>
+                <% _.each(scales, function(scale){ %>
+                  <option value="<%- scale.part %>">
+                    <%- scale.label %>
                   </option>
                 <% }); %>
             </select>
@@ -27,10 +28,12 @@
         </div>
       </fieldset>
 
+      <% if(upload){ %>
       <fieldset class="linkType uploadImage" data-linkType="uploadImage">
         <legend>Upload</legend>
         <div class="uploadify-me"></div>
       </fieldset>
+      <% } %>
 
       <fieldset class="linkType externalImage" data-linkType="externalImage">
         <legend>External image</legend>
@@ -65,8 +68,8 @@
       </div>
     </div>
 
-    <input type="submit" class="btn" name="cancel" value="<%- cancelBtn %>" />
-    <input type="submit" class="btn btn-primary" name="insert" value="<%- insertBtn %>" />
+    <input type="submit" class="plone-btn" name="cancel" value="<%- cancelBtn %>" />
+    <input type="submit" class="plone-btn plone-btn-primary" name="insert" value="<%- insertBtn %>" />
 
   </div>
 </div>
diff --git a/mockup/patterns/tinymce/templates/link.xml b/mockup/patterns/tinymce/templates/link.xml
index fa53674..f93d408 100644
--- a/mockup/patterns/tinymce/templates/link.xml
+++ b/mockup/patterns/tinymce/templates/link.xml
@@ -1,7 +1,9 @@
 <div>
   <div class="linkModal">
     <h1><%- insertHeading %></h1>
+    <% if(upload){ %>
     <p class="info">Drag and drop files from your desktop onto dialog to upload</p>
+    <% } %>
 
     <div class="linkTypes pat-autotoc autotabs"
          data-pat-autotoc="section:fieldset;levels:legend;">
@@ -16,10 +18,12 @@
         </div>
       </fieldset>
 
+      <% if(upload){ %>
       <fieldset class="linkType upload" data-linkType="upload">
         <legend>Upload</legend>
         <div class="uploadify-me"></div>
       </fieldset>
+      <% } %>
 
       <fieldset class="linkType external" data-linkType="external">
         <legend>External</legend>
@@ -72,7 +76,7 @@
       </div>
     </div>
 
-    <input type="submit" class="btn" name="cancel" value="<%- cancelBtn %>" />
-    <input type="submit" class="btn btn-primary" name="insert" value="<%- insertBtn %>" />
+    <input type="submit" class="plone-btn" name="cancel" value="<%- cancelBtn %>" />
+    <input type="submit" class="plone-btn plone-btn-primary" name="insert" value="<%- insertBtn %>" />
   </div>
 </div>
diff --git a/mockup/patterns/tree/pattern.tree.less b/mockup/patterns/tree/pattern.tree.less
index 6947e29..8f42efd 100644
--- a/mockup/patterns/tree/pattern.tree.less
+++ b/mockup/patterns/tree/pattern.tree.less
@@ -1,3 +1,3 @@
 /* (inline) forces includes this file without processing it.
  * Necessary because of the IE hack in there, which causes ParseError. */
-@import (inline) "@{bowerPath}/jqtree/jqtree.css";
+@import (inline) "@{bowerPath}/jqtree/jqtree.css";
\ No newline at end of file
diff --git a/mockup/tests/fakeserver.js b/mockup/tests/fakeserver.js
index f283eeb..10df4dc 100644
--- a/mockup/tests/fakeserver.js
+++ b/mockup/tests/fakeserver.js
@@ -163,6 +163,24 @@ define([
     }));
   });
 
+  server.respondWith('GET', /livesearch\.json/, function (xhr, id) {
+    var items = [{
+      url: 'http://localhost:8081/news/aggregator',
+      description: 'Site News',
+      title: 'News',
+      state: 'published'
+    }, {
+      url: 'http://localhost:8081/news/aggregator',
+      description: 'Site News',
+      title: 'News',
+      state: 'published'
+    }];
+    xhr.respond(200, { 'Content-Type': 'application/json' }, JSON.stringify({
+      total: items.length,
+      items: items
+    }));
+  });
+
   // define here so it's the same for the entire page load.
   // these are all random items on the root of the site
   var randomItems = [];
@@ -657,7 +675,7 @@ define([
           'autotoc': 'patterns/autotoc/pattern',
           'mockup-patterns-base': 'bower_components/mockup-core/js/pattern',
           'jquery': 'bower_components/jquery/dist/jquery',
-          "pat-registry": "bower_components/patternslib/src/core/registry",
+          'pat-registry': 'bower_components/patternslib/src/core/registry'
         },
         include: ['autotoc']
       };
diff --git a/mockup/tests/pattern-contentloader-test.js b/mockup/tests/pattern-contentloader-test.js
new file mode 100644
index 0000000..0c38eab
--- /dev/null
+++ b/mockup/tests/pattern-contentloader-test.js
@@ -0,0 +1,77 @@
+define([
+  'expect',
+  'jquery',
+  'sinon',
+  'pat-registry',
+  'mockup-patterns-contentloader'
+], function(expect, $, sinon, registry, ContentLoader) {
+  'use strict';
+
+  window.mocha.setup('bdd');
+  $.fx.off = true;
+
+   /* ==========================
+   TEST: Livesearch 
+  ========================== */
+
+  describe('Livesearch', function() {
+    beforeEach(function() {
+      this.server = sinon.fakeServer.create();
+      this.server.autoRespond = true;
+      this.server.respondWith('GET', /something\.html/, [
+        200,
+        { 'Content-Type': 'text/html' },
+        '<html> ' +
+        '<head></head>' +
+        '<body> ' +
+        '<div id="content">' +
+        '<h1>Content from AJAX</h1>' +
+        '<p>Ah, it is a rock, though. Should beat everything.</p>' +
+        '</body> ' +
+        '</html>'
+      ]);
+      this.clock = sinon.useFakeTimers();
+
+      this.$el = $('<a href="#" class="pat-contentloader">Loader</a>').appendTo($('body'));
+
+    });
+
+    afterEach(function() {
+      $('body').empty();
+      this.server.restore();
+      this.clock.restore();
+    });
+
+    it('load local content', function() {
+      $('<div class="content">foobar</div>').appendTo($('body'));
+      var loader = new ContentLoader(this.$el, {
+        content: '.content'
+      });
+      this.$el.trigger('click');
+      expect($('.content').size()).to.equal(2);
+    });
+
+    it('load local content to target', function() {
+      $('<div class="content">foobar</div>').appendTo($('body'));
+      $('<div class="target">blah</div>').appendTo($('body'));
+      var loader = new ContentLoader(this.$el, {
+        content: '.content',
+        target: '.target'
+      });
+      this.$el.trigger('click');
+      expect($('.content').size()).to.equal(2);
+      expect($('.target').size()).to.equal(0);
+    });
+
+    it('load remote content', function() {
+      var loader = new ContentLoader(this.$el, {
+        url: 'something.html'
+      });
+      this.$el.trigger('click');
+      this.clock.tick(1000);
+      expect($('#content').size()).to.equal(1);
+    });
+
+  });
+
+});
diff --git a/mockup/tests/pattern-livesearch-test.js b/mockup/tests/pattern-livesearch-test.js
new file mode 100644
index 0000000..0a69950
--- /dev/null
+++ b/mockup/tests/pattern-livesearch-test.js
@@ -0,0 +1,115 @@
+define([
+  'expect',
+  'jquery',
+  'sinon',
+  'pat-registry',
+  'mockup-patterns-livesearch'
+], function(expect, $, sinon, registry, Livesearch) {
+  'use strict';
+
+  window.mocha.setup('bdd');
+  $.fx.off = true;
+
+   /* ==========================
+   TEST: Livesearch 
+  ========================== */
+
+  describe('Livesearch', function() {
+    beforeEach(function() {
+      this.server = sinon.fakeServer.create();
+      this.server.autoRespond = true;
+
+      this.server.respondWith('GET', /livesearch\.json/, function (xhr, id) {
+        var items = [];
+        for(var i=0; i<7; i=i+1){
+          items.push({
+            url: 'http://localhost:8081/news/aggregator',
+            description: 'Site News',
+            title: 'News',
+            state: 'published'
+          });
+        }
+        xhr.respond(200, { 'Content-Type': 'application/json' }, JSON.stringify({
+          total: items.length * 2,
+          items: items
+        }));
+      });
+      this.clock = sinon.useFakeTimers();
+
+      this.$el = $('' +
+        '<form class="pat-livesearch">' +
+        ' <input type="text" value="foobar" />' +
+        '</form>').appendTo($('body'));
+
+      this.ls = new Livesearch(this.$el, {
+        ajaxUrl: 'livesearch.json'
+      });
+    });
+
+    afterEach(function() {
+      $('body').empty();
+      this.server.restore();
+      this.clock.restore();
+      this.$el.remove();
+    });
+
+    it('results on focus', function() {
+      this.ls.$input.trigger('focusin');
+      this.clock.tick(1000);
+      expect(this.$el.find('.livesearch-results li').size()).to.equal(9);
+    });
+
+    it('responds to keyup', function() {
+      this.ls.$input.trigger('keyup');
+      this.clock.tick(1000);
+      expect(this.$el.find('.livesearch-results li').size()).to.equal(9);
+    });
+
+    it('does not show with minimum length not met', function() {
+      this.ls.$input.attr('value', 'fo');
+      this.ls.$input.trigger('keyup');
+      this.clock.tick(1000);
+      expect(this.$el.find('.livesearch-results li').size()).to.equal(1);
+    });
+
+    it('focus out hides', function() {
+      this.ls.$input.trigger('keyup');
+      this.clock.tick(1000);
+      expect(this.$el.find('.livesearch-results li').size()).to.equal(9);
+
+      this.ls.$input.trigger('focusout');
+      this.clock.tick(1000);
+      expect(this.$el.find('.livesearch-results').is(':visible')).to.equal(false);
+
+    });
+
+    it('focus back in shows already searched', function() {
+      this.ls.$input.trigger('keyup');
+      this.clock.tick(1000);
+      expect(this.$el.find('.livesearch-results li').size()).to.equal(9);
+
+      this.ls.$input.trigger('focusout');
+      this.clock.tick(1000);
+      expect(this.$el.find('.livesearch-results').is(':visible')).to.equal(false);
+
+      this.ls.$input.trigger('focusin');
+      this.clock.tick(1000);
+      expect(this.$el.find('.livesearch-results').is(':visible')).to.equal(true);
+    });
+
+    it('should show next and prev', function() {
+      this.ls.$input.trigger('keyup');
+      this.clock.tick(1000);
+      expect(this.$el.find('.livesearch-results li').size()).to.equal(9);
+      expect(this.$el.find('.livesearch-results li a.next').size()).to.equal(1);
+
+      this.ls.doSearch(2);
+      this.clock.tick(1000);
+
+      expect(this.$el.find('.livesearch-results li').size()).to.equal(9);
+      expect(this.$el.find('.livesearch-results li a.prev').size()).to.equal(1);
+    });
+
+  });
+
+});
diff --git a/mockup/tests/pattern-relateditems-test.js b/mockup/tests/pattern-relateditems-test.js
index 08ddde7..52f6855 100644
--- a/mockup/tests/pattern-relateditems-test.js
+++ b/mockup/tests/pattern-relateditems-test.js
@@ -36,25 +36,25 @@ define([
       }
       this.server.respondWith(/relateditems-test.json/, function(xhr, id) {
         var root = [
-          {UID: 'jasdlfdlkdkjasdf', Title: 'Some Image', path: '/test.png', Type: 'Image'},
-          {UID: 'asdlfkjasdlfkjasdf', Title: 'News', path: '/news', Type: 'Folder'},
-          {UID: '124asdfasasdaf34', Title: 'About', path: '/about', Type: 'Folder'},
-          {UID: 'asdf1234', Title: 'Projects', path: '/projects', Type: 'Folder'},
-          {UID: 'asdf1234gsad', Title: 'Contact', path: '/contact', Type: 'Document'},
-          {UID: 'asdv34sdfs', Title: 'Privacy Policy', path: '/policy', Type: 'Document'},
-          {UID: 'asdfasdf234sdf', Title: 'Our Process', path: '/our-process', Type: 'Folder'},
-          {UID: 'asdhsfghyt45', Title: 'Donate', path: '/donate-now', Type: 'Document'},
+          {UID: 'jasdlfdlkdkjasdf', Title: 'Some Image', path: '/test.png', Type: 'Image', getIcon: "image.png"},
+          {UID: 'asdlfkjasdlfkjasdf', Title: 'News', path: '/news', Type: 'Folder', getIcon: ""},
+          {UID: '124asdfasasdaf34', Title: 'About', path: '/about', Type: 'Folder', getIcon: ""},
+          {UID: 'asdf1234', Title: 'Projects', path: '/projects', Type: 'Folder', getIcon: ""},
+          {UID: 'asdf1234gsad', Title: 'Contact', path: '/contact', Type: 'Document', getIcon: "document.png"},
+          {UID: 'asdv34sdfs', Title: 'Privacy Policy', path: '/policy', Type: 'Document', getIcon: ""},
+          {UID: 'asdfasdf234sdf', Title: 'Our Process', path: '/our-process', Type: 'Folder', getIcon: "folder.png"},
+          {UID: 'asdhsfghyt45', Title: 'Donate', path: '/donate-now', Type: 'Document', getIcon: ""},
         ];
         var about = [
-          {UID: 'gfn5634f', Title: 'About Us', path: '/about/about-us', Type: 'Document'},
-          {UID: '45dsfgsdcd', Title: 'Philosophy', path: '/about/philosophy', Type: 'Document'},
-          {UID: 'dfgsdfgj675', Title: 'Staff', path: '/about/staff', Type: 'Folder'},
-          {UID: 'sdfbsfdh345', Title: 'Board of Directors', path: '/about/board-of-directors', Type: 'Document'}
+          {UID: 'gfn5634f', Title: 'About Us', path: '/about/about-us', Type: 'Document', getIcon: ""},
+          {UID: '45dsfgsdcd', Title: 'Philosophy', path: '/about/philosophy', Type: 'Document', getIcon: ""},
+          {UID: 'dfgsdfgj675', Title: 'Staff', path: '/about/staff', Type: 'Folder', getIcon: ""},
+          {UID: 'sdfbsfdh345', Title: 'Board of Directors', path: '/about/board-of-directors', Type: 'Document', getIcon: ""}
         ];
 
         var staff = [
-          {UID: 'asdfasdf9sdf', Title: 'Mike', path: '/about/staff/mike', Type: 'Document'},
-          {UID: 'cvbcvb82345', Title: 'Joe', path: '/about/staff/joe', Type: 'Document'}
+          {UID: 'asdfasdf9sdf', Title: 'Mike', path: '/about/staff/mike', Type: 'Document', getIcon: ""},
+          {UID: 'cvbcvb82345', Title: 'Joe', path: '/about/staff/joe', Type: 'Document', getIcon: ""}
         ];
         var searchables = about.concat(root).concat(staff);
 
diff --git a/mockup/tests/pattern-resourceregistry-test.js b/mockup/tests/pattern-resourceregistry-test.js
index a20dd6e..6c99c51 100644
--- a/mockup/tests/pattern-resourceregistry-test.js
+++ b/mockup/tests/pattern-resourceregistry-test.js
@@ -4,7 +4,7 @@ define([
   'jquery',
   'pat-registry',
   'mockup-patterns-resourceregistry'
-], function(sinon, expect, $, registry) {
+], function(sinon, expect, $, registry, ResourceRegistry) {
   'use strict';
 
   window.mocha.setup('bdd');
@@ -15,15 +15,18 @@ define([
       var testData = {"bundles":{
                         "plone": {
                           "resources": "plone", "depends": null,
-                          "expression": "", "enabled": true, "conditionalcomment": ""
+                          "expression": "", "enabled": true, "conditionalcomment": "",
+                          "develop_javascript": false, "develop_css": false, "compile": true
                         },
                         "plone-auth": {
                           "resources": "plone-auth", "depends": "plone",
-                          "expression": "", "enabled": true, "conditionalcomment": ""
+                          "expression": "", "enabled": true, "conditionalcomment": "",
+                          "develop_javascript": false, "develop_css": false, "compile": true
                         },
                         "barceloneta": {
                           "resources": "plone", "depends": "*",
-                          "expression": "", "enabled": true, "conditionalcomment": ""
+                          "expression": "", "enabled": true, "conditionalcomment": "",
+                          "develop_javascript": false, "develop_css": false, "compile": true
                         }
                       },
                       "resources": {
@@ -65,13 +68,11 @@ define([
       this.$el = $('' +
         '<div>' +
         '  <div class="pat-resourceregistry "' +
-        "    data-pat-resourceregistry='" + JSON.stringify(testData) + "'>" +
         '  </div>' +
         '</div>');
 
-      registry.scan(this.$el);
       this.$pat =  this.$el.find('.pat-resourceregistry');
-      this.pat = this.$pat.data('pattern-resourceregistry');
+      this.pat = new ResourceRegistry(this.$pat, testData);
     });
     afterEach(function() {
       this.$el.remove();
@@ -79,23 +80,13 @@ define([
 
     it('loads', function() {
       expect(this.$el.find('ul.bundles li').length).to.equal(4);
-      expect(this.$el.find('ul.resources li').length).to.equal(7);
-    });
-
-    it('searches', function(){
-      this.pat.tabs.showOverrides = true;
-      this.pat.tabs.hideShow();
-      this.$el.find('.search-field').attr('value', 'bundles');
-      this.pat.tabs.overridesView.textChange();
-      expect(this.$el.find('.search-results li').length).to.equal(5);
+      expect(this.$el.find('ul.resources li').length).to.equal(6);
     });
 
     it('customize resource', function(){
       this.pat.tabs.showOverrides = true;
       this.pat.tabs.hideShow();
-      this.$el.find('.search-field').attr('value', 'plone');
-      this.pat.tabs.overridesView.textChange();
-      this.$el.find('.search-results li:last button').trigger('click');
+      this.$el.find('.select').select2('val', 'plone', true);
       expect(this.pat.options.overrides.length).to.equal(2);
     });
 
@@ -122,11 +113,13 @@ define([
     });
 
     it('delete resource', function(){
+      window.confirm = function() { return true; };
       this.$pat.find('.resource-list-item-autotoc button').trigger('click');
       expect(this.pat.options.resources.autotoc).to.equal(undefined);
     });
 
     it('delete bundle', function(){
+      window.confirm = function() { return true; };
       this.$pat.find('.bundle-list-item-plone button').trigger('click');
       expect(this.pat.options.bundles.plone).to.equal(undefined);
     });
@@ -137,7 +130,7 @@ define([
 
     it('add resource', function(){
       this.$pat.find('button.add-resource').trigger('click');
-      expect(this.$el.find('ul.resources li').length).to.equal(8);
+      expect(this.$el.find('ul.resources li').length).to.equal(7);
     });
 
     it('add bundle', function(){
diff --git a/mockup/tests/pattern-tinymce-test.js b/mockup/tests/pattern-tinymce-test.js
index 905321b..d78855b 100644
--- a/mockup/tests/pattern-tinymce-test.js
+++ b/mockup/tests/pattern-tinymce-test.js
@@ -35,7 +35,8 @@ define([
             path: '/news/aggregator',
             Type: 'Collection',
             Description: 'Site News',
-            Title: 'News'
+            Title: 'News',
+            getIcon: ''
           },
           {
             UID: 'fooasdfasdf1123asZ',
@@ -43,7 +44,8 @@ define([
             getURL: 'http://localhost:8081/about',
             Type: 'Page',
             Description: 'About',
-            Title: 'About'
+            Title: 'About',
+            getIcon: 'document.png'
           },
         ];
 
@@ -199,7 +201,8 @@ define([
         UID: 'foobar',
         Type: 'Page',
         Title: 'Foobar',
-        path: '/foobar'
+        path: '/foobar',
+        getIcon: ''
       });
       expect(pattern.linkModal.getLinkUrl()).to.equal('resolveuid/foobar');
     });
@@ -246,7 +249,8 @@ define([
         UID: 'foobar',
         Type: 'Page',
         Title: 'Foobar',
-        path: '/foobar'
+        path: '/foobar',
+        getIcon: ''
       });
       pattern.linkModal.focusElement(pattern.tiny.dom.getRoot().getElementsByTagName('p')[0]);
       pattern.linkModal.$button.trigger('click');
diff --git a/package.json b/package.json
new file mode 100644
index 0000000..7c2c5f7
--- /dev/null
+++ b/package.json
@@ -0,0 +1,60 @@
+{
+  "name": "mockup",
+  "version": "2.0.0",
+  "description": "A collection of client side patterns for faster and easier web development",
+  "homepage": "http://plone.github.io/mockup",
+  "devDependencies": {
+    "bower": "~1.3.2",
+    "chai": "^1.10.0",
+    "coveralls": "~2.10.0",
+    "extend": "~1.2.1",
+    "grunt": "~0.4.4",
+    "grunt-cli": "~0.1.13",
+    "grunt-contrib-copy": "~0.5.0",
+    "grunt-contrib-jshint": "~0.10.0",
+    "grunt-contrib-less": "~0.11.0",
+    "grunt-contrib-requirejs": "~0.4.3",
+    "grunt-contrib-uglify": "~0.4.0",
+    "grunt-contrib-watch": "~0.6.1",
+    "grunt-karma": "~0.8.2",
+    "grunt-sed": "~0.1.1",
+    "karma": "~0.12.9",
+    "karma-chai": "^0.1.0",
+    "karma-chrome-launcher": "~0.1.3",
+    "karma-coverage": "~0.2.1",
+    "karma-firefox-launcher": "~0.1.4",
+    "karma-junit-reporter": "~0.2.2",
+    "karma-mocha": "~0.1.3",
+    "karma-phantomjs-launcher": "~0.1.4",
+    "karma-requirejs": "~0.2.1",
+    "karma-sauce-launcher": "~0.2.10",
+    "karma-script-launcher": "~0.1.0",
+    "karma-spec-reporter": "0.0.16",
+    "lcov-result-merger": "~0.0.2",
+    "less": "~1.7.0",
+    "mocha": "~1.18.2",
+    "phantomjs": "^1.9.13",
+    "requirejs": "~2.1.11"
+  },
+  "maintainers": [
+    {
+      "name": "Plone Foundation",
+      "email": "plone-developers@lists.sourceforge.net",
+      "url": "http://plone.org"
+    }
+  ],
+  "repository": {
+    "type": "git",
+    "url": "https://github.com/plone/mockup.git"
+  },
+  "bugs": {
+    "url": "https://github.com/plone/mockup/issues",
+    "email": "plone-developers@lists.sourceforge.net"
+  },
+  "licenses": [
+    {
+      "type": "BSD",
+      "url": "http://opensource.org/licenses/BSD-3-Clause"
+    }
+  ]
+}
diff --git a/setup.py b/setup.py
index 6df8267..c4cf500 100644
--- a/setup.py
+++ b/setup.py
@@ -1,7 +1,7 @@
 from setuptools import setup, find_packages
 import json
 
-package_json = json.load(open('mockup/package.json'))
+package_json = json.load(open('package.json'))
 version = package_json['version']
 
 setup(


Repository: mockup
Branch: refs/heads/master
Date: 2015-04-01T00:04:08+02:00
Author: Johannes Raggam (thet) <raggam-nl@adm.at>
Commit: https://github.com/plone/mockup/commit/401afccab46b86b7510f409d0e5f00b96b26cc63

Merge branch 'master' into davisp1-tinymce-lang

Files changed:
M CHANGES.rst
M Makefile
M bower.json
M mockup/GETTING_STARTED.md
M mockup/Gruntfile.js
M mockup/index.html
M mockup/js/ui/views/button.js
M mockup/patterns/tooltip/pattern.js
M mockup/tests/pattern-tooltip-test.js

diff --git a/CHANGES.rst b/CHANGES.rst
index d38d5b3..b23af9e 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,6 +4,9 @@ Changelog
 2.0.2 (unreleased)
 ------------------
 
+- Fix building of docs with ``make docs``.
+  [thet]
+
 - update related items tree widget integration to have a bit better
   user interaction. Automatically open folder nodes and implement double click
   [vangheem]
diff --git a/Makefile b/Makefile
index 09e4556..e33cddb 100644
--- a/Makefile
+++ b/Makefile
@@ -54,8 +54,9 @@ bundle-resourceregistry:
 	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-resourceregistry $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
 
 docs:
-	if test ! -d docs; then $(GIT) clone git://github.com/plone/mockup.git -b gh-pages docs; fi
-	rm -rf docs/dev
+	rm -Rf mockup/docs; mkdir mockup/docs; cp -R .git mockup/docs; cd mockup/docs; $(GIT) checkout gh-pages;
+	# if test ! -d mockup/docs; then $(GIT) clone git://github.com/plone/mockup.git -b gh-pages mockup/docs; fi
+	rm -rf mockup/docs/dev
 	NODE_PATH=$(NODE_PATH) $(GRUNT) bundle-docs $(DEBUG) $(VERBOSE) --gruntfile=mockup/Gruntfile.js
 
 bootstrap-common:
@@ -114,6 +115,7 @@ clean-deep: clean
 	if test -f $(NPM); then $(NPM) cache clean; fi
 
 publish-docs:
-	echo -e "Publishing 'docs' bundle!\n"; cd docs; git add -fA .; git commit -m "Travis build $(TRAVIS_BUILD_NUMBER) pushed to 'docs'."; git push -fq https://$(GH_TOKEN)@github.com/plone/mockup.git gh-pages > /dev/null; cd ..;
+	echo -e "Publishing 'docs' bundle!\n"; cd mockup/docs; git add -fA .; git commit -m "Publishing docs"; git push -f git@github.com:plone/mockup.git gh-pages; cd ../..;
+	# echo -e "Publishing 'docs' bundle!\n"; cd mockup/docs; git add -fA .; git commit -m "Travis build $(TRAVIS_BUILD_NUMBER) pushed to 'docs'."; git push -fq https://$(GH_TOKEN)@github.com/plone/mockup.git gh-pages > /dev/null; cd ..;
 
 .PHONY: bundle bundle-widgets bundle-structure bundle-plone docs bootstrap bootstrap-nix jshint test test-once test-dev test-ci publish-docs clean clean-deep
diff --git a/bower.json b/bower.json
index 0f21da1..c70b4e4 100644
--- a/bower.json
+++ b/bower.json
@@ -15,7 +15,7 @@
     "jquery.cookie": "1.4.1",
     "lodash": "2.4.1",
     "logging": "",
-    "mockup-core": "2.1.5",
+    "mockup-core": "2.1.6",
     "moment": "2.8.3",
     "pickadate": "3.4.0",
     "requirejs-text": "2.0.12",
diff --git a/mockup/GETTING_STARTED.md b/mockup/GETTING_STARTED.md
index 90b0522..2095cca 100644
--- a/mockup/GETTING_STARTED.md
+++ b/mockup/GETTING_STARTED.md
@@ -143,6 +143,9 @@ Just replace the mockup-core line in bower.json with:
 Please note, you have to commit the changes on mockup-core before running
 ``make bootstrap``.
 
+Alternatively, on UNIX based systems, simply make a symlink from
+bower_components/mockup-core/ to your local mockup-core checkout.
+
 
 # Upgrade from pre-2.0 to 2.0 based Mockup patterns
 
diff --git a/mockup/Gruntfile.js b/mockup/Gruntfile.js
index 222f27b..ea0f786 100644
--- a/mockup/Gruntfile.js
+++ b/mockup/Gruntfile.js
@@ -29,15 +29,15 @@ module.exports = function(grunt) {
     copy: {
       docs: {
         files: [
+          { expand: true, src: '*.md', dest: 'docs/dev/' },
+          { expand: true, src: 'bower_components/**', dest: 'docs/dev/' },
           { expand: true, src: 'index.html', dest: 'docs/dev/' },
-          { expand: true, src: '../*.md', dest: 'docs/dev/' },
           { expand: true, src: 'js/**', dest: 'docs/dev/' },
-          { expand: true, src: 'tests/**', dest: 'docs/dev/' },
+          { expand: true, src: 'less/**', dest: 'docs/dev/' },
           { expand: true, src: 'lib/**', dest: 'docs/dev/' },
-          { expand: true, src: 'bower_components/**', dest: 'docs/dev/' },
-          { expand: true, src: '../node_modules/requirejs/require.js', dest: 'docs/dev/' },
-          { expand: true, src: 'build/**', dest: 'docs/dev/' },
-          { expand: true, src: 'less/**', dest: 'docs/dev/' }
+          { expand: true, src: 'node_modules/requirejs/require.js', dest: 'docs/dev/' },
+          { expand: true, src: 'patterns/**', dest: 'docs/dev/' },
+          { expand: true, src: 'tests/**', dest: 'docs/dev/' },
         ]
       },
     },
@@ -47,15 +47,20 @@ module.exports = function(grunt) {
         pattern: 'href="docs/dev/docs.min.css"',
         replacement: 'href="docs.min.css"'
       },
-      'docs-js': {
-        path: 'docs/dev/index.html',
-        pattern: '<script src="node_modules/grunt-contrib-less/node_modules/less/dist/less-1.6.1.js"></script>\n  <script src="node_modules/requirejs/require.js"></script>\n  <script src="js/config.js"></script>\n  <script>require\\(\\[\'mockup-bundles-docs\'\\]\\);</script>',
-        replacement: '<script src="docs.min.js"></script>'
-      },
+      //'docs-js': {
+      //  path: 'docs/dev/index.html',
+      //  pattern: '<script src="node_modules/requirejs/require.js"></script>\n  <script src="js/config.js"></script>\n  <script>\n    window.DEBUG = true;\n    require\\(\\[\'mockup-bundles-docs\'\\]\\);\n  </script>',
+      //  replacement: '<script src="docs.min.js"></script>'
+      //},
       'docs-legacy-js': {
         path: 'docs/dev/index.html',
         pattern: '<script src="bower_components/es5-shim/es5-shim.js"></script>\n    <script src="bower_components/es5-shim/es5-sham.js"></script>\n    <script src="bower_components/console-polyfill/index.js"></script>',
         replacement: '<script src="docs-legacy.js"></script>'
+      },
+      'docs-catalogurl': {
+        path: 'docs/dev/index.html',
+        pattern: 'data-i18ncatalogurl="/tests/json/i18n.json"',
+        replacement: 'data-i18ncatalogurl="/mockup/dev/tests/json/i18n.json"',
       }
     },
   }, {
diff --git a/mockup/index.html b/mockup/index.html
index 76d2d39..ff52446 100644
--- a/mockup/index.html
+++ b/mockup/index.html
@@ -20,14 +20,14 @@
   <![endif]-->
 
   <script src="node_modules/requirejs/require.js"></script>
-  <script src="mockup/js/config.js"></script>
+  <script src="js/config.js"></script>
   <script>
     window.DEBUG = true;
     require(['mockup-bundles-docs']);
   </script>
 </head>
 
-<body data-i18ncatalogurl="/mockup/tests/json/i18n.json">
+<body data-i18ncatalogurl="/tests/json/i18n.json">
 </body>
 
 </html>
diff --git a/mockup/js/ui/views/button.js b/mockup/js/ui/views/button.js
index 659b11e..f22c7c7 100644
--- a/mockup/js/ui/views/button.js
+++ b/mockup/js/ui/views/button.js
@@ -3,8 +3,8 @@ define([
   'backbone',
   'underscore',
   'mockup-ui-url/views/base',
-  'bootstrap-tooltip'
-], function($, Backbone, _, BaseView) {
+  'mockup-patterns-tooltip'
+], function($, Backbone, _, BaseView, Tooltip) {
   'use strict';
 
   var ButtonView = BaseView.extend({
@@ -45,9 +45,9 @@ define([
         });
 
         if (this.tooltip !== null) {
-          this.$el.tooltip({
-            title: this.tooltip
-          });
+
+          this.$el.attr('title', this.tooltip);
+          var tooltipPattern = new Tooltip(this.$el);
           // XXX since tooltip triggers hidden
           // suppress so it plays nice with modals, backdrops, etc
           this.$el.on('hidden', function(e) {
diff --git a/mockup/patterns/tooltip/pattern.js b/mockup/patterns/tooltip/pattern.js
index 189fc42..b86f4aa 100644
--- a/mockup/patterns/tooltip/pattern.js
+++ b/mockup/patterns/tooltip/pattern.js
@@ -18,39 +18,20 @@
  *    - Create some text that you want to be the link that will reveal the
  *      tooltip.
  *    - Select the view html button
- *    - Find your text. and wrap that text with an href tag, and add a class
- *      and the href tag.
- *    - It should look like < a class="pat-tooltip" href="#my-demo-tip"> My
- *      link text </a>
+ *    - Find your text, and surround it with an HTML tag. Any normal tag works fine.
+ *    - It should look like:
+ *      <span class="pat-tooltip" data-toggle="tooltip" title="Tooltip text">My link text</span>
  *    - Choose Save
  *
- *    Now that we have added our link we now need to add our tooltip.
- *
- *    - Choose "edit"
- *    - Immediently following the link click to add some text and hit your
- *      "return" key
- *    - Add the text that you want to be the tip.
- *    - Choose the "edit html" button
- *    - Find the tip text and wrap that text with a div tag, an ID tag and a
- *      class.
- *    - It should look like <div id="my-demo-tip" class="tooltips"> My Tip
- *      Text here </div>
- *    - Choose Save and test your tooltip.
- *
- *    Note: it's important that the href AND the ID be named exactly the same
- *    thing. This is what links them together.
- *
  *    # Example
  *
  *    {{ example-1 }}
  *
  * Example: example-1
- *    <p href=".example-class" class="pat-tooltip">
- *      Hover over this line to see a tooltip
- *    </p>
- *    <p class="tooltips example-class">
- *      Setting the .example-class in the href makes this show up
- *    </p>
+ *      <a href="#" data-toggle="tooltip" class="pat-tooltip"
+ *            title="Setting the data-toggle and title makes this show up">
+ *            Hover over this line to see a tooltip
+ *      </a>
  *
  */
 
@@ -60,49 +41,427 @@ define([
 ], function($, Base, undefined) {
   'use strict';
 
-  var ToolTip = Base.extend({
+  var Tooltip = Base.extend({
     name: 'tooltip',
     trigger: '.pat-tooltip',
-    defaults: {
-      attribute: 'class',
-      enterEvent: 'mouseenter',
-      exitEvent: 'mouseleave'
-    },
-    init: function() {
-      var self = this;
-
-      self.on(self.options.enterEvent, function(e) {
-        e.stopPropagation();
-        self.show.apply(self, [e]);
-      });
-      self.on(self.options.exitEvent, function(e) {
-        e.stopPropagation();
-        self.hide.apply(self, [e]);
-      });
 
+    init: function(element, options) {
+        this.data = new bootstrapTooltip(this.$el[0], this.options);
     },
-    closest: function($el, selector) {
-      var $closest;
-      $.each($el.parents(), function(i, el) {
-        $closest = $(selector, el);
-        if ($closest.size() !== 0) {
-          return false;
-        }
-      });
-      return $closest;
-    },
-    show : function(e) {
-      var s = $(e.target).attr('href');
-      this.closest(this.$el, s).addClass('active');
-    },
+  });
 
-    hide : function(e) {
-      var s = $(e.target).attr('href');
-      this.closest(this.$el, s).removeClass('active');
+  //This is pulled almost directly from the Bootstrap Tooltip
+  //extension. We rename it just to differentiate from the pattern.
+  var bootstrapTooltip = function (element, options) {
+    this.type       =
+    this.options    =
+    this.enabled    =
+    this.timeout    =
+    this.hoverState =
+    this.$element   = null
+
+    this.init('tooltip', element, options)
+  }
+
+  bootstrapTooltip.VERSION  = '3.2.0'
+
+  bootstrapTooltip.DEFAULTS = {
+    animation: true,
+    placement: 'top',
+    selector: false,
+    template: '<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
+    trigger: 'hover focus',
+    title: '',
+    delay: 0,
+    html: false,
+    container: false,
+    viewport: {
+      selector: 'body',
+      padding: 0
     }
+  }
 
-  });
+  bootstrapTooltip.prototype.init = function (type, element, options) {
+    this.enabled   = true
+    this.type      = type
+    this.$element  = $(element)
+    this.options   = this.getOptions(options)
+    this.$viewport = this.options.viewport && $(this.options.viewport.selector || this.options.viewport)
+
+    var triggers = this.options.trigger.split(' ')
+
+    for (var i = triggers.length; i--;) {
+      var trigger = triggers[i]
+
+      if (trigger == 'click') {
+        this.$element.on('click.' + this.type, this.options.selector, $.proxy(this.toggle, this))
+      } else if (trigger != 'manual') {
+        var eventIn  = trigger == 'hover' ? 'mouseenter' : 'focusin'
+        var eventOut = trigger == 'hover' ? 'mouseleave' : 'focusout'
+
+        this.$element.on(eventIn  + '.' + this.type, this.options.selector, $.proxy(this.enter, this))
+        this.$element.on(eventOut + '.' + this.type, this.options.selector, $.proxy(this.leave, this))
+      }
+    }
+
+    this.options.selector ?
+      (this._options = $.extend({}, this.options, { trigger: 'manual', selector: '' })) :
+      this.fixTitle()
+  }
+
+  bootstrapTooltip.prototype.getDefaults = function () {
+    return bootstrapTooltip.DEFAULTS
+  }
+
+  bootstrapTooltip.prototype.getOptions = function (options) {
+    options = $.extend({}, this.getDefaults(), this.$element.data(), options)
+
+    if (options.delay && typeof options.delay == 'number') {
+      options.delay = {
+        show: options.delay,
+        hide: options.delay
+      }
+    }
+
+    return options
+  }
+
+  bootstrapTooltip.prototype.getDelegateOptions = function () {
+    var options  = {}
+    var defaults = this.getDefaults()
+
+    this._options && $.each(this._options, function (key, value) {
+      if (defaults[key] != value) options[key] = value
+    })
+
+    return options
+  }
+
+  bootstrapTooltip.prototype.enter = function (obj) {
+    var self = obj instanceof this.constructor ?
+      obj : $(obj.currentTarget).data('bs.' + this.type)
+
+    if (!self) {
+      self = new this.constructor(obj.currentTarget, this.getDelegateOptions())
+      $(obj.currentTarget).data('bs.' + this.type, self)
+    }
+
+    clearTimeout(self.timeout)
+
+    self.hoverState = 'in'
+
+    if (!self.options.delay || !self.options.delay.show) return self.show()
+
+    self.timeout = setTimeout(function () {
+      if (self.hoverState == 'in') self.show()
+    }, self.options.delay.show)
+  }
+
+  bootstrapTooltip.prototype.leave = function (obj) {
+    var self = obj instanceof this.constructor ?
+      obj : $(obj.currentTarget).data('bs.' + this.type)
+
+    if (!self) {
+      self = new this.constructor(obj.currentTarget, this.getDelegateOptions())
+      $(obj.currentTarget).data('bs.' + this.type, self)
+    }
+
+    clearTimeout(self.timeout)
+
+    self.hoverState = 'out'
+
+    if (!self.options.delay || !self.options.delay.hide) return self.hide()
+
+    self.timeout = setTimeout(function () {
+      if (self.hoverState == 'out') self.hide()
+    }, self.options.delay.hide)
+  }
+
+  bootstrapTooltip.prototype.show = function () {
+    var e = $.Event('show.bs.' + this.type)
+
+    if (this.hasContent() && this.enabled) {
+      this.$element.trigger(e)
+
+      var inDom = $.contains(document.documentElement, this.$element[0])
+      if (e.isDefaultPrevented() || !inDom) return
+      var that = this
+
+      var $tip = this.tip()
+
+      var tipId = this.getUID(this.type)
+
+      this.setContent()
+      $tip.attr('id', tipId)
+      this.$element.attr('aria-describedby', tipId)
+
+      if (this.options.animation) $tip.addClass('fade')
+
+      var placement = typeof this.options.placement == 'function' ?
+        this.options.placement.call(this, $tip[0], this.$element[0]) :
+        this.options.placement
+
+      var autoToken = /\s?auto?\s?/i
+      var autoPlace = autoToken.test(placement)
+      if (autoPlace) placement = placement.replace(autoToken, '') || 'top'
+
+      $tip
+        .detach()
+        .css({ top: 0, left: 0, display: 'block' })
+        .addClass(placement)
+        .data('bs.' + this.type, this)
+
+      this.options.container ? $tip.appendTo(this.options.container) : $tip.insertAfter(this.$element)
+
+      var pos          = this.getPosition()
+      var actualWidth  = $tip[0].offsetWidth
+      var actualHeight = $tip[0].offsetHeight
+
+      if (autoPlace) {
+        var orgPlacement = placement
+        var $parent      = this.$element.parent()
+        var parentDim    = this.getPosition($parent)
+
+        placement = placement == 'bottom' && pos.top   + pos.height       + actualHeight - parentDim.scroll > parentDim.height ? 'top'    :
+                    placement == 'top'    && pos.top   - parentDim.scroll - actualHeight < 0                                   ? 'bottom' :
+                    placement == 'right'  && pos.right + actualWidth      > parentDim.width                                    ? 'left'   :
+                    placement == 'left'   && pos.left  - actualWidth      < parentDim.left                                     ? 'right'  :
+                    placement
+
+        $tip
+          .removeClass(orgPlacement)
+          .addClass(placement)
+      }
+
+      var calculatedOffset = this.getCalculatedOffset(placement, pos, actualWidth, actualHeight)
+
+      this.applyPlacement(calculatedOffset, placement)
+
+      var complete = function () {
+        that.$element.trigger('shown.bs.' + that.type)
+        that.hoverState = null
+      }
+
+      $.support.transition && this.$tip.hasClass('fade') ?
+        $tip
+          .one('bsTransitionEnd', complete)
+          .emulateTransitionEnd(150) :
+        complete()
+    }
+  }
+
+  bootstrapTooltip.prototype.applyPlacement = function (offset, placement) {
+    var $tip   = this.tip()
+    var width  = $tip[0].offsetWidth
+    var height = $tip[0].offsetHeight
+
+    // manually read margins because getBoundingClientRect includes difference
+    var marginTop = parseInt($tip.css('margin-top'), 10)
+    var marginLeft = parseInt($tip.css('margin-left'), 10)
+
+    // we must check for NaN for ie 8/9
+    if (isNaN(marginTop))  marginTop  = 0
+    if (isNaN(marginLeft)) marginLeft = 0
+
+    offset.top  = offset.top  + marginTop
+    offset.left = offset.left + marginLeft
+
+    // $.fn.offset doesn't round pixel values
+    // so we use setOffset directly with our own function B-0
+    $.offset.setOffset($tip[0], $.extend({
+      using: function (props) {
+        $tip.css({
+          top: Math.round(props.top),
+          left: Math.round(props.left)
+        })
+      }
+    }, offset), 0)
+
+    $tip.addClass('in')
+
+    // check to see if placing tip in new offset caused the tip to resize itself
+    var actualWidth  = $tip[0].offsetWidth
+    var actualHeight = $tip[0].offsetHeight
+
+    if (placement == 'top' && actualHeight != height) {
+      offset.top = offset.top + height - actualHeight
+    }
+
+    var delta = this.getViewportAdjustedDelta(placement, offset, actualWidth, actualHeight)
+
+    if (delta.left) offset.left += delta.left
+    else offset.top += delta.top
+
+    var arrowDelta          = delta.left ? delta.left * 2 - width + actualWidth : delta.top * 2 - height + actualHeight
+    var arrowPosition       = delta.left ? 'left'        : 'top'
+    var arrowOffsetPosition = delta.left ? 'offsetWidth' : 'offsetHeight'
+
+    $tip.offset(offset)
+    this.replaceArrow(arrowDelta, $tip[0][arrowOffsetPosition], arrowPosition)
+  }
+
+  bootstrapTooltip.prototype.replaceArrow = function (delta, dimension, position) {
+    this.arrow().css(position, delta ? (50 * (1 - delta / dimension) + '%') : '')
+  }
+
+  bootstrapTooltip.prototype.setContent = function () {
+    var $tip  = this.tip()
+    var title = this.getTitle()
+
+    $tip.find('.tooltip-inner')[this.options.html ? 'ht`ml' : 'text'](title)
+    $tip.removeClass('fade in top bottom left right')
+  }
+
+  bootstrapTooltip.prototype.hide = function () {
+    var that = this
+    var $tip = this.tip()
+    var e    = $.Event('hide.bs.' + this.type)
+
+    this.$element.removeAttr('aria-describedby')
+
+    function complete() {
+      if (that.hoverState != 'in') $tip.detach()
+      that.$element.trigger('hidden.bs.' + that.type)
+    }
+
+    this.$element.trigger(e)
+
+    if (e.isDefaultPrevented()) return
+
+    $tip.removeClass('in')
+
+    $.support.transition && this.$tip.hasClass('fade') ?
+      $tip
+        .one('bsTransitionEnd', complete)
+        .emulateTransitionEnd(150) :
+      complete()
+
+    this.hoverState = null
+
+    return this
+  }
+
+  bootstrapTooltip.prototype.fixTitle = function () {
+    var $e = this.$element
+    if ($e.attr('title') || typeof ($e.attr('data-original-title')) != 'string') {
+      $e.attr('data-original-title', $e.attr('title') || '').attr('title', '')
+    }
+  }
+
+  bootstrapTooltip.prototype.hasContent = function () {
+    return this.getTitle()
+  }
+
+  bootstrapTooltip.prototype.getPosition = function ($element) {
+    $element   = $element || this.$element
+    var el     = $element[0]
+    var isBody = el.tagName == 'BODY'
+    return $.extend({}, (typeof el.getBoundingClientRect == 'function') ? el.getBoundingClientRect() : null, {
+      scroll: isBody ? document.documentElement.scrollTop || document.body.scrollTop : $element.scrollTop(),
+      width:  isBody ? $(window).width()  : $element.outerWidth(),
+      height: isBody ? $(window).height() : $element.outerHeight()
+    }, isBody ? { top: 0, left: 0 } : $element.offset())
+  }
+
+  bootstrapTooltip.prototype.getCalculatedOffset = function (placement, pos, actualWidth, actualHeight) {
+    return placement == 'bottom' ? { top: pos.top + pos.height,   left: pos.left + pos.width / 2 - actualWidth / 2  } :
+           placement == 'top'    ? { top: pos.top - actualHeight, left: pos.left + pos.width / 2 - actualWidth / 2  } :
+           placement == 'left'   ? { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth } :
+        /* placement == 'right' */ { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width   }
+
+  }
+
+  bootstrapTooltip.prototype.getViewportAdjustedDelta = function (placement, pos, actualWidth, actualHeight) {
+    var delta = { top: 0, left: 0 }
+    if (!this.$viewport) return delta
+
+    var viewportPadding = this.options.viewport && this.options.viewport.padding || 0
+    var viewportDimensions = this.getPosition(this.$viewport)
+
+    if (/right|left/.test(placement)) {
+      var topEdgeOffset    = pos.top - viewportPadding - viewportDimensions.scroll
+      var bottomEdgeOffset = pos.top + viewportPadding - viewportDimensions.scroll + actualHeight
+      if (topEdgeOffset < viewportDimensions.top) { // top overflow
+        delta.top = viewportDimensions.top - topEdgeOffset
+      } else if (bottomEdgeOffset > viewportDimensions.top + viewportDimensions.height) { // bottom overflow
+        delta.top = viewportDimensions.top + viewportDimensions.height - bottomEdgeOffset
+      }
+    } else {
+      var leftEdgeOffset  = pos.left - viewportPadding
+      var rightEdgeOffset = pos.left + viewportPadding + actualWidth
+      if (leftEdgeOffset < viewportDimensions.left) { // left overflow
+        delta.left = viewportDimensions.left - leftEdgeOffset
+      } else if (rightEdgeOffset > viewportDimensions.width) { // right overflow
+        delta.left = viewportDimensions.left + viewportDimensions.width - rightEdgeOffset
+      }
+    }
+
+    return delta
+  }
+
+  bootstrapTooltip.prototype.getTitle = function () {
+    var title
+    var $e = this.$element
+    var o  = this.options
+
+    title = $e.attr('data-original-title')
+      || (typeof o.title == 'function' ? o.title.call($e[0]) :  o.title)
+
+    return title
+  }
+
+  bootstrapTooltip.prototype.getUID = function (prefix) {
+    do prefix += ~~(Math.random() * 1000000)
+    while (document.getElementById(prefix))
+    return prefix
+  }
+
+  bootstrapTooltip.prototype.tip = function () {
+    return (this.$tip = this.$tip || $(this.options.template))
+  }
+
+  bootstrapTooltip.prototype.arrow = function () {
+    return (this.$arrow = this.$arrow || this.tip().find('.tooltip-arrow'))
+  }
+
+  bootstrapTooltip.prototype.validate = function () {
+    if (!this.$element[0].parentNode) {
+      this.hide()
+      this.$element = null
+      this.options  = null
+    }
+  }
+
+  bootstrapTooltip.prototype.enable = function () {
+    this.enabled = true
+  }
+
+  bootstrapTooltip.prototype.disable = function () {
+    this.enabled = false
+  }
+
+  bootstrapTooltip.prototype.toggleEnabled = function () {
+    this.enabled = !this.enabled
+  }
+
+  bootstrapTooltip.prototype.toggle = function (e) {
+    var self = this
+    if (e) {
+      self = $(e.currentTarget).data('bs.' + this.type)
+      if (!self) {
+        self = new this.constructor(e.currentTarget, this.getDelegateOptions())
+        $(e.currentTarget).data('bs.' + this.type, self)
+      }
+    }
+
+    self.tip().hasClass('in') ? self.leave(self) : self.enter(self)
+  }
+
+  bootstrapTooltip.prototype.destroy = function () {
+    clearTimeout(this.timeout)
+    this.hide().$element.off('.' + this.type).removeData('bs.' + this.type)
+  }
 
-  return ToolTip;
+  return Tooltip;
 
 });
diff --git a/mockup/tests/pattern-tooltip-test.js b/mockup/tests/pattern-tooltip-test.js
index ff9555e..d885650 100644
--- a/mockup/tests/pattern-tooltip-test.js
+++ b/mockup/tests/pattern-tooltip-test.js
@@ -3,7 +3,7 @@ define([
   'jquery',
   'pat-registry',
   'mockup-patterns-tooltip'
-], function(expect, $, registry, ToolTip) {
+], function(expect, $, registry, Tooltip) {
   'use strict';
 
   window.mocha.setup('bdd');
@@ -17,30 +17,31 @@ define([
 
     beforeEach(function() {
       this.$el = $('' +
-        '<div><p href=".example-class" class="pat-tooltip">' +
+        '<div><a href="#" class="pat-tooltip" data-toggle="tooltip" title="data">' +
         '  Hover over this line to see a tooltip' +
-        '</p>' +
-        '<p class="tooltips example-class">' +
-        '  Setting the .example-class in the href makes this show up' +
-        '</p></div>');
+        '</a></div>');
+      $('body').append(this.$el);
     });
 
     afterEach(function() {
       this.$el.remove();
     });
 
-    it('tooltip appears and disappears', function() {
+
+    it.skip('tooltip appears and disappears', function() {
       registry.scan(this.$el);
 
       var trs;
 
-      $('.pat-tooltip', this.$el).trigger('mouseenter.tooltip.patterns');
-      trs = this.$el.find('.example-class');
-      expect(trs.eq(0).hasClass('active')).to.be.equal(true);
+      var $el = this.$el.find('a');
+      $el.data('suppress.mouseenter', (new Date().getTime()) + 10000);
+      $el.trigger('mouseenter');
+      trs = this.$el.find('.tooltip');
+      expect(trs.eq(0).length).to.equal(1);
 
-      $('.pat-tooltip', this.$el).trigger('mouseleave.tooltip.patterns');
-      trs = this.$el.find('.example-class');
-      expect(trs.eq(0).hasClass('active')).to.be.equal(false);
+      this.$el.trigger('mouseleave');
+      trs = this.$el.find('.tooltip');
+      expect(trs.eq(0).length).to.equal(0);
     });
 
   });


