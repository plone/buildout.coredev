Repository: mockup


Branch: refs/heads/master
Date: 2020-04-06T16:37:44-03:00
Author: Franco Pellegrini (frapell) <frapell@gmail.com>
Commit: https://github.com/plone/mockup/commit/1f6214e3a981f0323d2dc69ce19debf883fb98e4

pat-inlinevalidation: Fix bug where drop downs would not get validated. fixes gh-971

Files changed:
A news/971.bugfix
M mockup/patterns/inlinevalidation/pattern.js

b'diff --git a/mockup/patterns/inlinevalidation/pattern.js b/mockup/patterns/inlinevalidation/pattern.js\nindex a23f89b1b..7f4a0140c 100644\n--- a/mockup/patterns/inlinevalidation/pattern.js\n+++ b/mockup/patterns/inlinevalidation/pattern.js\n@@ -126,6 +126,12 @@ define([\n             fset = $input.closest(\'fieldset\').attr(\'data-fieldset\'),\n             fname = $field.attr(\'data-fieldname\');\n \n+        // XXX: When cloning a form, values from \'select\' elements are not kept\n+        //      so we copy them from the original form here.\n+        $.each( $("select", $form), function ( k, v ) {\n+          $(\'[name="\'+v.name+\'"]\', $cloned_form).val($(v).val());\n+        } );\n+\n         // XXX: Remove binary files so they are not uploaded to server\n         $cloned_form.find("input[type=file]").remove();\n         if (fname) {\ndiff --git a/news/971.bugfix b/news/971.bugfix\nnew file mode 100644\nindex 000000000..c1cca85f1\n--- /dev/null\n+++ b/news/971.bugfix\n@@ -0,0 +1,2 @@\n+pat-inlinevalidation: Fix bug where drop downs would not get validated\n+[frapell]\n'

Repository: mockup


Branch: refs/heads/master
Date: 2020-04-07T10:35:05-03:00
Author: Franco Pellegrini (frapell) <frapell@gmail.com>
Commit: https://github.com/plone/mockup/commit/8b6ca5de14c802c354f7b97888037ab98a9060be

Be more specific that this is for &lt;select&gt; fields

Files changed:
M mockup/patterns/inlinevalidation/pattern.js

b'diff --git a/mockup/patterns/inlinevalidation/pattern.js b/mockup/patterns/inlinevalidation/pattern.js\nindex 7f4a0140c..ff0eec283 100644\n--- a/mockup/patterns/inlinevalidation/pattern.js\n+++ b/mockup/patterns/inlinevalidation/pattern.js\n@@ -129,7 +129,7 @@ define([\n         // XXX: When cloning a form, values from \'select\' elements are not kept\n         //      so we copy them from the original form here.\n         $.each( $("select", $form), function ( k, v ) {\n-          $(\'[name="\'+v.name+\'"]\', $cloned_form).val($(v).val());\n+          $(\'select[name="\'+v.name+\'"]\', $cloned_form).val($(v).val());\n         } );\n \n         // XXX: Remove binary files so they are not uploaded to server\n'

Repository: mockup


Branch: refs/heads/master
Date: 2020-04-08T10:24:05+02:00
Author: Alessandro Pisa (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/mockup/commit/d7d515065dd5fdb79c902e2e41862e96664f8173

Merge pull request #972 from plone/frapell-inlinevalidation

pat-inlinevalidation: Fix bug where drop downs would not get validated

Files changed:
A news/971.bugfix
M mockup/patterns/inlinevalidation/pattern.js

b'diff --git a/mockup/patterns/inlinevalidation/pattern.js b/mockup/patterns/inlinevalidation/pattern.js\nindex a23f89b1b..ff0eec283 100644\n--- a/mockup/patterns/inlinevalidation/pattern.js\n+++ b/mockup/patterns/inlinevalidation/pattern.js\n@@ -126,6 +126,12 @@ define([\n             fset = $input.closest(\'fieldset\').attr(\'data-fieldset\'),\n             fname = $field.attr(\'data-fieldname\');\n \n+        // XXX: When cloning a form, values from \'select\' elements are not kept\n+        //      so we copy them from the original form here.\n+        $.each( $("select", $form), function ( k, v ) {\n+          $(\'select[name="\'+v.name+\'"]\', $cloned_form).val($(v).val());\n+        } );\n+\n         // XXX: Remove binary files so they are not uploaded to server\n         $cloned_form.find("input[type=file]").remove();\n         if (fname) {\ndiff --git a/news/971.bugfix b/news/971.bugfix\nnew file mode 100644\nindex 000000000..c1cca85f1\n--- /dev/null\n+++ b/news/971.bugfix\n@@ -0,0 +1,2 @@\n+pat-inlinevalidation: Fix bug where drop downs would not get validated\n+[frapell]\n'

