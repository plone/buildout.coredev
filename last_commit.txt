Repository: Products.PortalTransforms


Branch: refs/heads/master
Date: 2022-10-26T15:24:45+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.PortalTransforms/commit/e27aac99435354221fa2fcf39b7aba550b01235a

Fixed regular expression in tests on Python 3.11.

This fixes https://github.com/plone/Products.PortalTransforms/issues/48

Files changed:
A news/48.bugfix
M Products/PortalTransforms/tests/test_engine.py

b"diff --git a/Products/PortalTransforms/tests/test_engine.py b/Products/PortalTransforms/tests/test_engine.py\nindex 23c121f..f43f85a 100644\n--- a/Products/PortalTransforms/tests/test_engine.py\n+++ b/Products/PortalTransforms/tests/test_engine.py\n@@ -22,8 +22,8 @@ class HtmlToText(BaseTransform):\n     output = 'text/plain'\n \n     def __call__(self, orig, **kwargs):\n-        orig = re.sub('<[^>]*>(?i)(?m)', '', orig)\n-        return urllib.parse.unquote(re.sub('\\n+', '\\n', orig)).strip()\n+        orig = re.sub(r'(?i)(?m)<[^>]*>', '', orig)\n+        return urllib.parse.unquote(re.sub(r'\\n+', '\\n', orig)).strip()\n \n     def convert(self, orig, data, **kwargs):\n         orig = self.__call__(orig)\n@@ -42,7 +42,7 @@ class FooToBar(BaseTransform):\n \n     def __call__(self, orig, **kwargs):\n         orig = re.sub('foo', 'bar', orig)\n-        return urllib.parse.unquote(re.sub('\\n+', '\\n', orig)).strip()\n+        return urllib.parse.unquote(re.sub(r'\\n+', '\\n', orig)).strip()\n \n     def convert(self, orig, data, **kwargs):\n         orig = self.__call__(orig)\ndiff --git a/news/48.bugfix b/news/48.bugfix\nnew file mode 100644\nindex 0000000..dadacc7\n--- /dev/null\n+++ b/news/48.bugfix\n@@ -0,0 +1,2 @@\n+Fixed regular expression in tests on Python 3.11.\n+[maurits]\n"

Repository: Products.PortalTransforms


Branch: refs/heads/master
Date: 2022-10-26T20:58:45-07:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/Products.PortalTransforms/commit/e73e91f251b62cd871c8bf9a0d0b262bb99e315f

Merge pull request #49 from plone/maurits-regexp-311

Fixed regular expression in tests on Python 3.11.

Files changed:
A news/48.bugfix
M Products/PortalTransforms/tests/test_engine.py

b"diff --git a/Products/PortalTransforms/tests/test_engine.py b/Products/PortalTransforms/tests/test_engine.py\nindex 23c121f..f43f85a 100644\n--- a/Products/PortalTransforms/tests/test_engine.py\n+++ b/Products/PortalTransforms/tests/test_engine.py\n@@ -22,8 +22,8 @@ class HtmlToText(BaseTransform):\n     output = 'text/plain'\n \n     def __call__(self, orig, **kwargs):\n-        orig = re.sub('<[^>]*>(?i)(?m)', '', orig)\n-        return urllib.parse.unquote(re.sub('\\n+', '\\n', orig)).strip()\n+        orig = re.sub(r'(?i)(?m)<[^>]*>', '', orig)\n+        return urllib.parse.unquote(re.sub(r'\\n+', '\\n', orig)).strip()\n \n     def convert(self, orig, data, **kwargs):\n         orig = self.__call__(orig)\n@@ -42,7 +42,7 @@ class FooToBar(BaseTransform):\n \n     def __call__(self, orig, **kwargs):\n         orig = re.sub('foo', 'bar', orig)\n-        return urllib.parse.unquote(re.sub('\\n+', '\\n', orig)).strip()\n+        return urllib.parse.unquote(re.sub(r'\\n+', '\\n', orig)).strip()\n \n     def convert(self, orig, data, **kwargs):\n         orig = self.__call__(orig)\ndiff --git a/news/48.bugfix b/news/48.bugfix\nnew file mode 100644\nindex 0000000..dadacc7\n--- /dev/null\n+++ b/news/48.bugfix\n@@ -0,0 +1,2 @@\n+Fixed regular expression in tests on Python 3.11.\n+[maurits]\n"

