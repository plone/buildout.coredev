Repository: plone.volto


Branch: refs/heads/main
Date: 2024-01-22T14:10:47+01:00
Author: Victor Fernandez de Alba (sneridagh) <sneridagh@gmail.com>
Commit: https://github.com/plone/plone.volto/commit/2c506a437734c080b1109f412c622b5e1c3fd2a7

Add VOLTO_FRONTEND_DOMAIN as env var

Files changed:
M src/plone/volto/patches.py

b'diff --git a/src/plone/volto/patches.py b/src/plone/volto/patches.py\nindex 86128ad..f70d12b 100644\n--- a/src/plone/volto/patches.py\n+++ b/src/plone/volto/patches.py\n@@ -11,6 +11,7 @@\n from zope.component import getUtility\n \n import logging\n+import os\n \n \n LOG = logging.getLogger("Zope.SiteErrorLog")\n@@ -52,7 +53,9 @@ def construct_url(self, randomstring):\n \n         registry = getUtility(IRegistry)\n         settings = registry.forInterface(IVoltoSettings, prefix="volto", check=False)\n-        settings_frontend_domain = getattr(settings, "frontend_domain", None)\n+        settings_frontend_domain = os.environ["VOLTO_FRONTEND_DOMAIN"] or getattr(\n+            settings, "frontend_domain", None\n+        )\n         if settings_frontend_domain:\n             frontend_domain = settings_frontend_domain\n         if frontend_domain.endswith("/"):\n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2024-01-22T14:13:31+01:00
Author: Victor Fernandez de Alba (sneridagh) <sneridagh@gmail.com>
Commit: https://github.com/plone/plone.volto/commit/2070b78f964018ec511bdb23d758516755306a15

Changelog

Files changed:
A news/139.feature

b'diff --git a/news/139.feature b/news/139.feature\nnew file mode 100644\nindex 0000000..d85ddfa\n--- /dev/null\n+++ b/news/139.feature\n@@ -0,0 +1,2 @@\n+Add `VOLTO_FRONTEND_DOMAIN` as env var for `volto.frontend_domain` registry setting\n+[@sneridagh]\n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2024-01-29T12:39:18+01:00
Author: Víctor Fernández de Alba (sneridagh) <sneridagh@gmail.com>
Commit: https://github.com/plone/plone.volto/commit/ffa2651ea3050e830731961caa6cc275761d6e70

Update src/plone/volto/patches.py

Co-authored-by: David Glick &lt;david@glicksoftware.com&gt;

Files changed:
M src/plone/volto/patches.py

b'diff --git a/src/plone/volto/patches.py b/src/plone/volto/patches.py\nindex f70d12b..589eecd 100644\n--- a/src/plone/volto/patches.py\n+++ b/src/plone/volto/patches.py\n@@ -53,7 +53,7 @@ def construct_url(self, randomstring):\n \n         registry = getUtility(IRegistry)\n         settings = registry.forInterface(IVoltoSettings, prefix="volto", check=False)\n-        settings_frontend_domain = os.environ["VOLTO_FRONTEND_DOMAIN"] or getattr(\n+        settings_frontend_domain = os.environ.get("VOLTO_FRONTEND_DOMAIN") or getattr(\n             settings, "frontend_domain", None\n         )\n         if settings_frontend_domain:\n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2024-01-29T12:39:24+01:00
Author: Víctor Fernández de Alba (sneridagh) <sneridagh@gmail.com>
Commit: https://github.com/plone/plone.volto/commit/1ed263c21442c6fb6e10faf0e684d05ff29fae42

Merge branch 'main' into addfrontenddomainasenvvar

Files changed:
M CHANGES.rst
M setup.py
D news/133.bugfix
D news/137.bugfix

b'diff --git a/CHANGES.rst b/CHANGES.rst\nindex ccdf507..26db1b1 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -8,6 +8,18 @@ Changelog\n \n .. towncrier release notes start\n \n+4.2.1 (2024-01-26)\n+------------------\n+\n+Bug fixes:\n+\n+\n+- Fix changed behavior and marker interfaces for plone.leadimage and plone.richtext.\n+  See: https://github.com/plone/plone.app.contenttypes/pull/480\n+  @thet (#133)\n+- Avoid accidental acquisition in ``block_types`` indexer. @davisagli (#137)\n+\n+\n 4.2.0 (2023-12-13)\n ------------------\n \ndiff --git a/news/133.bugfix b/news/133.bugfix\ndeleted file mode 100644\nindex 5b0fac5..0000000\n--- a/news/133.bugfix\n+++ /dev/null\n@@ -1,3 +0,0 @@\n-Fix changed behavior and marker interfaces for plone.leadimage and plone.richtext.\n-See: https://github.com/plone/plone.app.contenttypes/pull/480\n-[thet]\ndiff --git a/news/137.bugfix b/news/137.bugfix\ndeleted file mode 100644\nindex 88b5ed8..0000000\n--- a/news/137.bugfix\n+++ /dev/null\n@@ -1 +0,0 @@\n-Avoid accidental acquisition in ``block_types`` indexer. @davisagli\ndiff --git a/setup.py b/setup.py\nindex 7af15be..47d5abb 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -25,7 +25,7 @@ def readfile(name):\n \n setup(\n     name="plone.volto",\n-    version="4.2.1.dev0",\n+    version="4.2.2.dev0",\n     description="Volto integration add-on for Plone",\n     long_description=long_description,\n     # Get more from https://pypi.org/classifiers/\n'

Repository: plone.volto


Branch: refs/heads/main
Date: 2024-01-30T10:00:35-08:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.volto/commit/83c8115bd410c6d5890c86f13c9796768fdafad2

Merge pull request #139 from plone/addfrontenddomainasenvvar

Add VOLTO_FRONTEND_DOMAIN as env var

Files changed:
A news/139.feature
M src/plone/volto/patches.py

b'diff --git a/news/139.feature b/news/139.feature\nnew file mode 100644\nindex 00000000..d85ddfa3\n--- /dev/null\n+++ b/news/139.feature\n@@ -0,0 +1,2 @@\n+Add `VOLTO_FRONTEND_DOMAIN` as env var for `volto.frontend_domain` registry setting\n+[@sneridagh]\ndiff --git a/src/plone/volto/patches.py b/src/plone/volto/patches.py\nindex 86128ad9..589eecd7 100644\n--- a/src/plone/volto/patches.py\n+++ b/src/plone/volto/patches.py\n@@ -11,6 +11,7 @@\n from zope.component import getUtility\n \n import logging\n+import os\n \n \n LOG = logging.getLogger("Zope.SiteErrorLog")\n@@ -52,7 +53,9 @@ def construct_url(self, randomstring):\n \n         registry = getUtility(IRegistry)\n         settings = registry.forInterface(IVoltoSettings, prefix="volto", check=False)\n-        settings_frontend_domain = getattr(settings, "frontend_domain", None)\n+        settings_frontend_domain = os.environ.get("VOLTO_FRONTEND_DOMAIN") or getattr(\n+            settings, "frontend_domain", None\n+        )\n         if settings_frontend_domain:\n             frontend_domain = settings_frontend_domain\n         if frontend_domain.endswith("/"):\n'

