Repository: plone.app.contentmenu


Branch: refs/heads/master
Date: 2021-09-23T16:15:07+02:00
Author: Peter Holzer (agitator) <peter.holzer@agitator.com>
Commit: https://github.com/plone/plone.app.contentmenu/commit/700c9c018a26465813d28ed17b1fe8b625f832e2

add icon resolver markup

Files changed:
M plone/app/contentmenu/contentmenu.pt
M plone/app/contentmenu/menu.py

b'diff --git a/plone/app/contentmenu/contentmenu.pt b/plone/app/contentmenu/contentmenu.pt\nindex ac44ded..e563932 100644\n--- a/plone/app/contentmenu/contentmenu.pt\n+++ b/plone/app/contentmenu/contentmenu.pt\n@@ -1,6 +1,7 @@\n <tal:contentactionmenus\n     condition="view/available"\n-    define="menu view/menu;"\n+    define="menu view/menu;\n+            icons python:context.restrictedTraverse(\'@@iconresolver\');"\n     i18n:domain="plone">\n   <tal:menus repeat="menuItem menu">\n     <li\n@@ -79,6 +80,9 @@\n                               class subMenuItem/extra/class | nothing;\n                               data-pat-plone-modal subMenuItem/extra/modal | nothing;"\n               tal:condition="subMenuItem/action">\n+            <tal:icon tal:condition="python:subMenuItem[\'icon\']"\n+              tal:replace="structure python:icons.tag(subMenuItem[\'icon\'], tag_alt=subMenuItem[\'title\'], tag_class=\'toolbarIcon\')" />\n+  \n             <tal:title\n                 content="structure subMenuItem/title"\n                 i18n:translate="">\ndiff --git a/plone/app/contentmenu/menu.py b/plone/app/contentmenu/menu.py\nindex 4203374..6089331 100644\n--- a/plone/app/contentmenu/menu.py\n+++ b/plone/app/contentmenu/menu.py\n@@ -58,7 +58,7 @@ class ActionsSubMenuItem(BrowserSubMenuItem):\n     description = _(u\'title_actions_menu\',\n                     default=u\'Actions for the current content item\')\n     submenuId = \'plone_contentmenu_actions\'\n-\n+    icon = "toolbar-action/actions"\n     order = 30\n     extra = {\n         \'id\': \'plone-contentmenu-actions\',\n@@ -135,7 +135,7 @@ class DisplaySubMenuItem(BrowserSubMenuItem):\n \n     title = _(u\'label_choose_template\', default=u\'Display\')\n     submenuId = \'plone_contentmenu_display\'\n-\n+    icon = "toolbar-action/display"\n     order = 40\n \n     def __init__(self, context, request):\n@@ -495,9 +495,10 @@ def getMenuItems(self, obj, request):\n @implementer(IFactoriesSubMenuItem)\n class FactoriesSubMenuItem(BrowserSubMenuItem):\n \n+    title = _(u\'label_add_new_item\', default=u\'Add new\\u2026\')\n     submenuId = \'plone_contentmenu_factory\'\n+    icon = "toolbar-action/factories"\n     order = 10\n-    title = _(u\'label_add_new_item\', default=u\'Add new\\u2026\')\n     description = _(u\'title_add_new_items_inside_item\',\n                     default=u\'Add new items inside this item\')\n \n@@ -671,6 +672,7 @@ class WorkflowSubMenuItem(BrowserSubMenuItem):\n \n     title = _(u\'label_state\', default=u\'State:\')\n     short_title = _(u\'State\')\n+    icon = "toolbar-action/workflows"\n     submenuId = \'plone_contentmenu_workflow\'\n     order = 20\n \n@@ -848,6 +850,7 @@ class PortletManagerSubMenuItem(BrowserSubMenuItem):\n \n     title = _(u\'manage_portlets_link\', default=u\'Manage portlets\')\n     submenuId = \'plone_contentmenu_portletmanager\'\n+    icon = "toolbar-action/portlet"\n     order = 50\n \n     def __init__(self, context, request):\n'

Repository: plone.app.contentmenu


Branch: refs/heads/master
Date: 2021-09-23T16:42:42+02:00
Author: Peter Holzer (agitator) <peter.holzer@agitator.com>
Commit: https://github.com/plone/plone.app.contentmenu/commit/cebf442e7e076a7011d722511fa9505c579f4c21

fix display of svg toolbar icons

Files changed:
M plone/app/contentmenu/contentmenu.pt
M plone/app/contentmenu/interfaces.py
M plone/app/contentmenu/menu.py

b'diff --git a/plone/app/contentmenu/contentmenu.pt b/plone/app/contentmenu/contentmenu.pt\nindex e563932..098b17e 100644\n--- a/plone/app/contentmenu/contentmenu.pt\n+++ b/plone/app/contentmenu/contentmenu.pt\n@@ -18,16 +18,21 @@\n           tal:define="state_class menuItem/extra/class | nothing;\n                       state_class python:state_class and state_class or \'\'"\n           >\n+\n         <span\n             aria-hidden="true"\n             class=""\n             tal:attributes="class string:icon-${identifier} ${menuItem/extra/class} toolbar-menu-icon"\n-            tal:condition="menuItem/extra/stateTitle | nothing"></span>\n+            tal:condition="menuItem/extra/stateTitle | nothing">\n+          <tal:icon tal:replace="structure python:icons.tag(menuItem.get(\'icon\',\'\') and menuItem[\'icon\'] or \'toolbar-action\', tag_alt=menuItem.get(\'id\',\'toolbarIcon\'), tag_class=\'toolbarIcon\')" />\n+        </span>\n         <span\n             aria-hidden="true"\n             class=""\n             tal:attributes="class string:icon-${identifier} toolbar-menu-icon"\n-            tal:condition="not: menuItem/extra/stateTitle | nothing"></span>\n+            tal:condition="not: menuItem/extra/stateTitle | nothing">\n+          <tal:icon tal:replace="structure python:icons.tag(menuItem.get(\'icon\',\'\') and menuItem[\'icon\'] or \'toolbar-action\', tag_alt=menuItem.get(\'id\',\'toolbarIcon\'), tag_class=\'toolbarIcon\')" />\n+        </span>\n         <span tal:omit-tag="not: menuItem/extra/stateTitle | nothing">\n           <span\n               class="plone-toolbar-title"\ndiff --git a/plone/app/contentmenu/interfaces.py b/plone/app/contentmenu/interfaces.py\nindex 586cc2a..40344c4 100644\n--- a/plone/app/contentmenu/interfaces.py\n+++ b/plone/app/contentmenu/interfaces.py\n@@ -51,6 +51,7 @@ class IContentMenuItem(Interface):\n #   stateTitle   :   The title of the state - to be displayed after the main\n #                        item title\n #   class        :   A CSS class to apply\n+#   icon         :   Icon name from registry\n #   separator    :   True if the item should be preceded by a separator\n #   hideChildren :   True if the item\'s children should not be rendered\n \ndiff --git a/plone/app/contentmenu/menu.py b/plone/app/contentmenu/menu.py\nindex 6089331..8cccd3a 100644\n--- a/plone/app/contentmenu/menu.py\n+++ b/plone/app/contentmenu/menu.py\n@@ -672,7 +672,7 @@ class WorkflowSubMenuItem(BrowserSubMenuItem):\n \n     title = _(u\'label_state\', default=u\'State:\')\n     short_title = _(u\'State\')\n-    icon = "toolbar-action/workflows"\n+    icon = "toolbar-action/workflow"\n     submenuId = \'plone_contentmenu_workflow\'\n     order = 20\n \n@@ -850,7 +850,7 @@ class PortletManagerSubMenuItem(BrowserSubMenuItem):\n \n     title = _(u\'manage_portlets_link\', default=u\'Manage portlets\')\n     submenuId = \'plone_contentmenu_portletmanager\'\n-    icon = "toolbar-action/portlet"\n+    icon = "toolbar-action/portlets"\n     order = 50\n \n     def __init__(self, context, request):\n'

Repository: plone.app.contentmenu


Branch: refs/heads/master
Date: 2021-11-18T16:57:54+01:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.contentmenu/commit/28c2d2e84c3fc806e25354ee2782eeb31a2c236a

Update toolbar markup to Bootstrap 5 Sidebars

Files changed:
M plone/app/contentmenu/contentmenu.pt
M plone/app/contentmenu/menu.py

b'diff --git a/plone/app/contentmenu/contentmenu.pt b/plone/app/contentmenu/contentmenu.pt\nindex 098b17e..a697d0d 100644\n--- a/plone/app/contentmenu/contentmenu.pt\n+++ b/plone/app/contentmenu/contentmenu.pt\n@@ -8,104 +8,76 @@\n         tal:attributes="id menuItem/extra/id"\n         tal:define="submenu menuItem/submenu;\n                     identifier menuItem/extra/id">\n-      <a\n-          href="#"\n+\n+      <a href="#"\n           i18n:attributes="title;"\n           tal:attributes="href python:menuItem[\'action\'] or \'javascript:void(0)\';\n-                          style python:not menuItem[\'action\'] and \'cursor: default;; pointer-events: none\' or None;\n-                          title menuItem/description;\n-                          class string:label-${state_class}"\n+                          style python:\'cursor: default;; pointer-events: none\' if not menuItem[\'action\'] else None;\n+                          title menuItem/description;"\n           tal:define="state_class menuItem/extra/class | nothing;\n-                      state_class python:state_class and state_class or \'\'"\n-          >\n+                      state_class python:\'label-%s\' % state_class if state_class else \'\'"\n+          class="text-white ${python:\'nav-link dropdown-toggle collapsed\' if submenu else \'\'}"\n+          data-bs-toggle="collapse"\n+          data-bs-target="#collapse-${identifier}"\n+          aria-expanded="${python:\'false\' if submenu else None}">\n+\n+        <tal:icon tal:replace="structure python:icons.tag(menuItem.get(\'icon\',\'\') and menuItem[\'icon\'] or \'toolbar-action\', tag_alt=menuItem.get(\'id\',\'toolbarIcon\'), tag_class=\'me-1\')" />\n \n         <span\n-            aria-hidden="true"\n-            class=""\n-            tal:attributes="class string:icon-${identifier} ${menuItem/extra/class} toolbar-menu-icon"\n-            tal:condition="menuItem/extra/stateTitle | nothing">\n-          <tal:icon tal:replace="structure python:icons.tag(menuItem.get(\'icon\',\'\') and menuItem[\'icon\'] or \'toolbar-action\', tag_alt=menuItem.get(\'id\',\'toolbarIcon\'), tag_class=\'toolbarIcon\')" />\n-        </span>\n-        <span\n-            aria-hidden="true"\n-            class=""\n-            tal:attributes="class string:icon-${identifier} toolbar-menu-icon"\n-            tal:condition="not: menuItem/extra/stateTitle | nothing">\n-          <tal:icon tal:replace="structure python:icons.tag(menuItem.get(\'icon\',\'\') and menuItem[\'icon\'] or \'toolbar-action\', tag_alt=menuItem.get(\'id\',\'toolbarIcon\'), tag_class=\'toolbarIcon\')" />\n+            i18n:translate=""\n+            tal:replace="menuItem/title">\n+            Menu Title\n         </span>\n-        <span tal:omit-tag="not: menuItem/extra/stateTitle | nothing">\n-          <span\n-              class="plone-toolbar-title"\n-              i18n:translate=""\n-              tal:content="menuItem/title">\n-              Menu Title\n-            </span>\n         <span\n-            class="plone-toolbar-short-title"\n             i18n:translate=""\n-            tal:content="menuItem/extra/shortTitle | menuItem/title">\n-            Short Title\n-          </span>\n-          <span\n-              class="plone-toolbar-state-title"\n-              i18n:translate=""\n-              tal:condition="menuItem/extra/stateTitle | nothing"\n-              tal:content="menuItem/extra/stateTitle">\n-                State title\n-            </span>\n+            class="ms-1 ${state_class}"\n+            tal:content="menuItem/extra/stateTitle | nothing">\n+              State title\n         </span>\n-        <span\n-            class="plone-toolbar-caret"\n-            tal:condition="not:menuItem/extra/hideChildren | not:submenu | nothing"></span>\n+\n       </a>\n-      <ul\n-          aria-hidden="true"\n-          tal:condition="not:menuItem/extra/hideChildren | not:submenu | nothing">\n-        <li class="plone-toolbar-submenu-header">\n-          <span tal:omit-tag="not:menuItem/extra/stateTitle | nothing">\n-            <span tal:content="menuItem/title">Menu Title</span>\n-            <span\n-                i18n:translate=""\n-                tal:attributes="class string:${menuItem/extra/class}"\n-                tal:condition="menuItem/extra/stateTitle | nothing"\n-                tal:content="menuItem/extra/stateTitle">\n-                State title\n+\n+      <div id="collapse-${identifier}" class="collapse"\n+             tal:condition="submenu | nothing">\n+\n+        <ul class="nav nav-pills flex-column small">\n+          <li tal:repeat="subMenuItem submenu" class="ps-3">\n+            <tal:block define="extra_class subMenuItem/extra/class | string:">\n+            <a class="text-white nav-link ${extra_class}"\n+                href="#"\n+                i18n:attributes="title"\n+                tal:attributes="href subMenuItem/action;\n+                                title subMenuItem/description;\n+                                id subMenuItem/extra/id | nothing;\n+                                data-pat-plone-modal subMenuItem/extra/modal | nothing;"\n+                tal:condition="subMenuItem/action">\n+\n+                <tal:icon tal:replace="structure python:icons.tag(\'check\' if \'active\' in extra_class else (subMenuItem.get(\'icon\') or \'dot\'), tag_alt=subMenuItem[\'title\'], tag_class=\'me-1\')" />\n+\n+              <tal:title\n+                  content="structure subMenuItem/title"\n+                  i18n:translate="">\n+                    Title\n+                </tal:title>\n+            </a>\n+            <span class="text-white nav-link ${extra_class}"\n+                tal:attributes="id subMenuItem/extra/id | nothing"\n+                tal:condition="not:subMenuItem/action">\n+                <tal:icon tal:condition="python:\'active\' in extra_class"\n+                          tal:replace="structure python:icons.tag(\'check\', tag_class=\'me-1\')" />\n+                <span\n+                  i18n:translate=""\n+                  tal:replace="structure subMenuItem/title">\n+                    Title\n+                </span>\n             </span>\n-          </span>\n-        </li>\n-        <li\n-            tal:attributes="class string:${menuItem/extra/li_class | nothing} ${subMenuItem/extra/separator}"\n-            tal:repeat="subMenuItem submenu">\n-          <a\n-              href="#"\n-              i18n:attributes="title"\n-              tal:attributes="href subMenuItem/action;\n-                              title subMenuItem/description;\n-                              id subMenuItem/extra/id | nothing;\n-                              class subMenuItem/extra/class | nothing;\n-                              data-pat-plone-modal subMenuItem/extra/modal | nothing;"\n-              tal:condition="subMenuItem/action">\n-            <tal:icon tal:condition="python:subMenuItem[\'icon\']"\n-              tal:replace="structure python:icons.tag(subMenuItem[\'icon\'], tag_alt=subMenuItem[\'title\'], tag_class=\'toolbarIcon\')" />\n-  \n-            <tal:title\n-                content="structure subMenuItem/title"\n-                i18n:translate="">\n-                  Title\n-              </tal:title>\n-          </a>\n-          <span\n-              tal:attributes="id subMenuItem/extra/id | nothing;\n-                              class subMenuItem/extra/class | nothing"\n-              tal:condition="not:subMenuItem/action">\n-            <span\n-                i18n:translate=""\n-                tal:content="structure subMenuItem/title">\n-                  Title\n-              </span>\n-          </span>\n-        </li>\n-      </ul>\n+            </tal:block>\n+          </li>\n+          <li tal:condition="not:repeat/menuItem/end">\n+            <hr />\n+          </li>\n+        </ul>\n+      </div>\n     </li>\n   </tal:menus>\n </tal:contentactionmenus>\ndiff --git a/plone/app/contentmenu/menu.py b/plone/app/contentmenu/menu.py\nindex 8cccd3a..7fe16d6 100644\n--- a/plone/app/contentmenu/menu.py\n+++ b/plone/app/contentmenu/menu.py\n@@ -321,7 +321,7 @@ def getMenuItems(self, obj, request):\n                 \'extra\': {\n                     \'id\': \'folderDefaultPageDisplay\',\n                     \'separator\': None,\n-                    \'class\': \'actionMenuSelected\'},\n+                    \'class\': \'active\'},\n                 \'submenu\': None,\n             })\n \n@@ -413,7 +413,7 @@ def getMenuItems(self, obj, request):\n                         \'extra\': {\n                             \'id\': \'plone-contentmenu-display-\' + id,\n                             \'separator\': None,\n-                            \'class\': is_selected and \'actionMenuSelected\' or \'\'\n+                            \'class\': is_selected and \'active\' or \'\'\n                         },\n                         \'submenu\': None,\n                     })\n'

Repository: plone.app.contentmenu


Branch: refs/heads/master
Date: 2022-01-27T10:09:35+01:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.contentmenu/commit/ef5683400b5d744b803dcc8f463ea3c2506726fd

minor change for enabling dark/light mode in toolbar

Files changed:
M plone/app/contentmenu/contentmenu.pt

b'diff --git a/plone/app/contentmenu/contentmenu.pt b/plone/app/contentmenu/contentmenu.pt\nindex a697d0d..39043b8 100644\n--- a/plone/app/contentmenu/contentmenu.pt\n+++ b/plone/app/contentmenu/contentmenu.pt\n@@ -16,7 +16,7 @@\n                           title menuItem/description;"\n           tal:define="state_class menuItem/extra/class | nothing;\n                       state_class python:\'label-%s\' % state_class if state_class else \'\'"\n-          class="text-white ${python:\'nav-link dropdown-toggle collapsed\' if submenu else \'\'}"\n+          class="${python:\'nav-link dropdown-toggle collapsed\' if submenu else \'\'}"\n           data-bs-toggle="collapse"\n           data-bs-target="#collapse-${identifier}"\n           aria-expanded="${python:\'false\' if submenu else None}">\n@@ -43,7 +43,7 @@\n         <ul class="nav nav-pills flex-column small">\n           <li tal:repeat="subMenuItem submenu" class="ps-3">\n             <tal:block define="extra_class subMenuItem/extra/class | string:">\n-            <a class="text-white nav-link ${extra_class}"\n+            <a class="nav-link ${extra_class}"\n                 href="#"\n                 i18n:attributes="title"\n                 tal:attributes="href subMenuItem/action;\n@@ -60,7 +60,7 @@\n                     Title\n                 </tal:title>\n             </a>\n-            <span class="text-white nav-link ${extra_class}"\n+            <span class="nav-link ${extra_class}"\n                 tal:attributes="id subMenuItem/extra/id | nothing"\n                 tal:condition="not:subMenuItem/action">\n                 <tal:icon tal:condition="python:\'active\' in extra_class"\n@@ -73,9 +73,7 @@\n             </span>\n             </tal:block>\n           </li>\n-          <li tal:condition="not:repeat/menuItem/end">\n-            <hr />\n-          </li>\n+          <li class="border-top my-2" tal:condition="not:repeat/menuItem/end"></li>\n         </ul>\n       </div>\n     </li>\n'

Repository: plone.app.contentmenu


Branch: refs/heads/master
Date: 2022-01-27T14:15:01+01:00
Author: petschki (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.contentmenu/commit/bf28534319cff2faaeb0fb33d400745d5c8882d3

accordion behavior for collapsibles

Files changed:
M plone/app/contentmenu/contentmenu.pt

b'diff --git a/plone/app/contentmenu/contentmenu.pt b/plone/app/contentmenu/contentmenu.pt\nindex 39043b8..e0c3c97 100644\n--- a/plone/app/contentmenu/contentmenu.pt\n+++ b/plone/app/contentmenu/contentmenu.pt\n@@ -37,7 +37,7 @@\n \n       </a>\n \n-      <div id="collapse-${identifier}" class="collapse"\n+      <div id="collapse-${identifier}" class="collapse" data-bs-parent=".plone-toolbar-main"\n              tal:condition="submenu | nothing">\n \n         <ul class="nav nav-pills flex-column small">\n'

Repository: plone.app.contentmenu


Branch: refs/heads/master
Date: 2022-01-28T09:45:40+01:00
Author: Peter Mathis (petschki) <peter.mathis@kombinat.at>
Commit: https://github.com/plone/plone.app.contentmenu/commit/8c419bbab9ff98d49e3d7c6b5ccbac73f5f84d02

toolbar topmode

Files changed:
M plone/app/contentmenu/contentmenu.pt

b'diff --git a/plone/app/contentmenu/contentmenu.pt b/plone/app/contentmenu/contentmenu.pt\nindex e0c3c97..f25fbda 100644\n--- a/plone/app/contentmenu/contentmenu.pt\n+++ b/plone/app/contentmenu/contentmenu.pt\n@@ -4,10 +4,9 @@\n             icons python:context.restrictedTraverse(\'@@iconresolver\');"\n     i18n:domain="plone">\n   <tal:menus repeat="menuItem menu">\n-    <li\n-        tal:attributes="id menuItem/extra/id"\n-        tal:define="submenu menuItem/submenu;\n-                    identifier menuItem/extra/id">\n+    <tal:def define="submenu menuItem/submenu;\n+                     identifier menuItem/extra/id">\n+    <li tal:attributes="id menuItem/extra/id">\n \n       <a href="#"\n           i18n:attributes="title;"\n@@ -37,11 +36,11 @@\n \n       </a>\n \n-      <div id="collapse-${identifier}" class="collapse" data-bs-parent=".plone-toolbar-main"\n+      <div id="collapse-${identifier}" class="collapse" data-bs-parent="#edit-zone"\n              tal:condition="submenu | nothing">\n \n         <ul class="nav nav-pills flex-column small">\n-          <li tal:repeat="subMenuItem submenu" class="ps-3">\n+          <li tal:repeat="subMenuItem submenu">\n             <tal:block define="extra_class subMenuItem/extra/class | string:">\n             <a class="nav-link ${extra_class}"\n                 href="#"\n@@ -77,5 +76,6 @@\n         </ul>\n       </div>\n     </li>\n+    </tal:def>\n   </tal:menus>\n </tal:contentactionmenus>\n'

Repository: plone.app.contentmenu


Branch: refs/heads/master
Date: 2022-03-24T12:31:24+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.contentmenu/commit/a0337370b7b50d457de141142c3154e9e6bb03f1

Add news file.

Files changed:
A news/30.breaking

b'diff --git a/news/30.breaking b/news/30.breaking\nnew file mode 100644\nindex 0000000..a62477a\n--- /dev/null\n+++ b/news/30.breaking\n@@ -0,0 +1,5 @@\n+Use Plone 6 icon resolver and SVG icons.\n+[agitator]\n+\n+Changes for new Plone 6 toolbar.\n+[petschki]\n'

Repository: plone.app.contentmenu


Branch: refs/heads/master
Date: 2022-03-24T15:27:57+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.contentmenu/commit/c5385cff3d01a6c776d1551adf05f9b8eb7bd347

Merge pull request #30 from plone/barceloneta-lts-svg-icons

add icon resolver markup

Files changed:
A news/30.breaking
M plone/app/contentmenu/contentmenu.pt
M plone/app/contentmenu/interfaces.py
M plone/app/contentmenu/menu.py

b'diff --git a/news/30.breaking b/news/30.breaking\nnew file mode 100644\nindex 0000000..a62477a\n--- /dev/null\n+++ b/news/30.breaking\n@@ -0,0 +1,5 @@\n+Use Plone 6 icon resolver and SVG icons.\n+[agitator]\n+\n+Changes for new Plone 6 toolbar.\n+[petschki]\ndiff --git a/plone/app/contentmenu/contentmenu.pt b/plone/app/contentmenu/contentmenu.pt\nindex ac44ded..f25fbda 100644\n--- a/plone/app/contentmenu/contentmenu.pt\n+++ b/plone/app/contentmenu/contentmenu.pt\n@@ -1,102 +1,81 @@\n <tal:contentactionmenus\n     condition="view/available"\n-    define="menu view/menu;"\n+    define="menu view/menu;\n+            icons python:context.restrictedTraverse(\'@@iconresolver\');"\n     i18n:domain="plone">\n   <tal:menus repeat="menuItem menu">\n-    <li\n-        tal:attributes="id menuItem/extra/id"\n-        tal:define="submenu menuItem/submenu;\n-                    identifier menuItem/extra/id">\n-      <a\n-          href="#"\n+    <tal:def define="submenu menuItem/submenu;\n+                     identifier menuItem/extra/id">\n+    <li tal:attributes="id menuItem/extra/id">\n+\n+      <a href="#"\n           i18n:attributes="title;"\n           tal:attributes="href python:menuItem[\'action\'] or \'javascript:void(0)\';\n-                          style python:not menuItem[\'action\'] and \'cursor: default;; pointer-events: none\' or None;\n-                          title menuItem/description;\n-                          class string:label-${state_class}"\n+                          style python:\'cursor: default;; pointer-events: none\' if not menuItem[\'action\'] else None;\n+                          title menuItem/description;"\n           tal:define="state_class menuItem/extra/class | nothing;\n-                      state_class python:state_class and state_class or \'\'"\n-          >\n+                      state_class python:\'label-%s\' % state_class if state_class else \'\'"\n+          class="${python:\'nav-link dropdown-toggle collapsed\' if submenu else \'\'}"\n+          data-bs-toggle="collapse"\n+          data-bs-target="#collapse-${identifier}"\n+          aria-expanded="${python:\'false\' if submenu else None}">\n+\n+        <tal:icon tal:replace="structure python:icons.tag(menuItem.get(\'icon\',\'\') and menuItem[\'icon\'] or \'toolbar-action\', tag_alt=menuItem.get(\'id\',\'toolbarIcon\'), tag_class=\'me-1\')" />\n+\n         <span\n-            aria-hidden="true"\n-            class=""\n-            tal:attributes="class string:icon-${identifier} ${menuItem/extra/class} toolbar-menu-icon"\n-            tal:condition="menuItem/extra/stateTitle | nothing"></span>\n-        <span\n-            aria-hidden="true"\n-            class=""\n-            tal:attributes="class string:icon-${identifier} toolbar-menu-icon"\n-            tal:condition="not: menuItem/extra/stateTitle | nothing"></span>\n-        <span tal:omit-tag="not: menuItem/extra/stateTitle | nothing">\n-          <span\n-              class="plone-toolbar-title"\n-              i18n:translate=""\n-              tal:content="menuItem/title">\n-              Menu Title\n-            </span>\n-        <span\n-            class="plone-toolbar-short-title"\n             i18n:translate=""\n-            tal:content="menuItem/extra/shortTitle | menuItem/title">\n-            Short Title\n-          </span>\n-          <span\n-              class="plone-toolbar-state-title"\n-              i18n:translate=""\n-              tal:condition="menuItem/extra/stateTitle | nothing"\n-              tal:content="menuItem/extra/stateTitle">\n-                State title\n-            </span>\n+            tal:replace="menuItem/title">\n+            Menu Title\n         </span>\n         <span\n-            class="plone-toolbar-caret"\n-            tal:condition="not:menuItem/extra/hideChildren | not:submenu | nothing"></span>\n+            i18n:translate=""\n+            class="ms-1 ${state_class}"\n+            tal:content="menuItem/extra/stateTitle | nothing">\n+              State title\n+        </span>\n+\n       </a>\n-      <ul\n-          aria-hidden="true"\n-          tal:condition="not:menuItem/extra/hideChildren | not:submenu | nothing">\n-        <li class="plone-toolbar-submenu-header">\n-          <span tal:omit-tag="not:menuItem/extra/stateTitle | nothing">\n-            <span tal:content="menuItem/title">Menu Title</span>\n-            <span\n-                i18n:translate=""\n-                tal:attributes="class string:${menuItem/extra/class}"\n-                tal:condition="menuItem/extra/stateTitle | nothing"\n-                tal:content="menuItem/extra/stateTitle">\n-                State title\n+\n+      <div id="collapse-${identifier}" class="collapse" data-bs-parent="#edit-zone"\n+             tal:condition="submenu | nothing">\n+\n+        <ul class="nav nav-pills flex-column small">\n+          <li tal:repeat="subMenuItem submenu">\n+            <tal:block define="extra_class subMenuItem/extra/class | string:">\n+            <a class="nav-link ${extra_class}"\n+                href="#"\n+                i18n:attributes="title"\n+                tal:attributes="href subMenuItem/action;\n+                                title subMenuItem/description;\n+                                id subMenuItem/extra/id | nothing;\n+                                data-pat-plone-modal subMenuItem/extra/modal | nothing;"\n+                tal:condition="subMenuItem/action">\n+\n+                <tal:icon tal:replace="structure python:icons.tag(\'check\' if \'active\' in extra_class else (subMenuItem.get(\'icon\') or \'dot\'), tag_alt=subMenuItem[\'title\'], tag_class=\'me-1\')" />\n+\n+              <tal:title\n+                  content="structure subMenuItem/title"\n+                  i18n:translate="">\n+                    Title\n+                </tal:title>\n+            </a>\n+            <span class="nav-link ${extra_class}"\n+                tal:attributes="id subMenuItem/extra/id | nothing"\n+                tal:condition="not:subMenuItem/action">\n+                <tal:icon tal:condition="python:\'active\' in extra_class"\n+                          tal:replace="structure python:icons.tag(\'check\', tag_class=\'me-1\')" />\n+                <span\n+                  i18n:translate=""\n+                  tal:replace="structure subMenuItem/title">\n+                    Title\n+                </span>\n             </span>\n-          </span>\n-        </li>\n-        <li\n-            tal:attributes="class string:${menuItem/extra/li_class | nothing} ${subMenuItem/extra/separator}"\n-            tal:repeat="subMenuItem submenu">\n-          <a\n-              href="#"\n-              i18n:attributes="title"\n-              tal:attributes="href subMenuItem/action;\n-                              title subMenuItem/description;\n-                              id subMenuItem/extra/id | nothing;\n-                              class subMenuItem/extra/class | nothing;\n-                              data-pat-plone-modal subMenuItem/extra/modal | nothing;"\n-              tal:condition="subMenuItem/action">\n-            <tal:title\n-                content="structure subMenuItem/title"\n-                i18n:translate="">\n-                  Title\n-              </tal:title>\n-          </a>\n-          <span\n-              tal:attributes="id subMenuItem/extra/id | nothing;\n-                              class subMenuItem/extra/class | nothing"\n-              tal:condition="not:subMenuItem/action">\n-            <span\n-                i18n:translate=""\n-                tal:content="structure subMenuItem/title">\n-                  Title\n-              </span>\n-          </span>\n-        </li>\n-      </ul>\n+            </tal:block>\n+          </li>\n+          <li class="border-top my-2" tal:condition="not:repeat/menuItem/end"></li>\n+        </ul>\n+      </div>\n     </li>\n+    </tal:def>\n   </tal:menus>\n </tal:contentactionmenus>\ndiff --git a/plone/app/contentmenu/interfaces.py b/plone/app/contentmenu/interfaces.py\nindex 586cc2a..40344c4 100644\n--- a/plone/app/contentmenu/interfaces.py\n+++ b/plone/app/contentmenu/interfaces.py\n@@ -51,6 +51,7 @@ class IContentMenuItem(Interface):\n #   stateTitle   :   The title of the state - to be displayed after the main\n #                        item title\n #   class        :   A CSS class to apply\n+#   icon         :   Icon name from registry\n #   separator    :   True if the item should be preceded by a separator\n #   hideChildren :   True if the item\'s children should not be rendered\n \ndiff --git a/plone/app/contentmenu/menu.py b/plone/app/contentmenu/menu.py\nindex 4203374..7fe16d6 100644\n--- a/plone/app/contentmenu/menu.py\n+++ b/plone/app/contentmenu/menu.py\n@@ -58,7 +58,7 @@ class ActionsSubMenuItem(BrowserSubMenuItem):\n     description = _(u\'title_actions_menu\',\n                     default=u\'Actions for the current content item\')\n     submenuId = \'plone_contentmenu_actions\'\n-\n+    icon = "toolbar-action/actions"\n     order = 30\n     extra = {\n         \'id\': \'plone-contentmenu-actions\',\n@@ -135,7 +135,7 @@ class DisplaySubMenuItem(BrowserSubMenuItem):\n \n     title = _(u\'label_choose_template\', default=u\'Display\')\n     submenuId = \'plone_contentmenu_display\'\n-\n+    icon = "toolbar-action/display"\n     order = 40\n \n     def __init__(self, context, request):\n@@ -321,7 +321,7 @@ def getMenuItems(self, obj, request):\n                 \'extra\': {\n                     \'id\': \'folderDefaultPageDisplay\',\n                     \'separator\': None,\n-                    \'class\': \'actionMenuSelected\'},\n+                    \'class\': \'active\'},\n                 \'submenu\': None,\n             })\n \n@@ -413,7 +413,7 @@ def getMenuItems(self, obj, request):\n                         \'extra\': {\n                             \'id\': \'plone-contentmenu-display-\' + id,\n                             \'separator\': None,\n-                            \'class\': is_selected and \'actionMenuSelected\' or \'\'\n+                            \'class\': is_selected and \'active\' or \'\'\n                         },\n                         \'submenu\': None,\n                     })\n@@ -495,9 +495,10 @@ def getMenuItems(self, obj, request):\n @implementer(IFactoriesSubMenuItem)\n class FactoriesSubMenuItem(BrowserSubMenuItem):\n \n+    title = _(u\'label_add_new_item\', default=u\'Add new\\u2026\')\n     submenuId = \'plone_contentmenu_factory\'\n+    icon = "toolbar-action/factories"\n     order = 10\n-    title = _(u\'label_add_new_item\', default=u\'Add new\\u2026\')\n     description = _(u\'title_add_new_items_inside_item\',\n                     default=u\'Add new items inside this item\')\n \n@@ -671,6 +672,7 @@ class WorkflowSubMenuItem(BrowserSubMenuItem):\n \n     title = _(u\'label_state\', default=u\'State:\')\n     short_title = _(u\'State\')\n+    icon = "toolbar-action/workflow"\n     submenuId = \'plone_contentmenu_workflow\'\n     order = 20\n \n@@ -848,6 +850,7 @@ class PortletManagerSubMenuItem(BrowserSubMenuItem):\n \n     title = _(u\'manage_portlets_link\', default=u\'Manage portlets\')\n     submenuId = \'plone_contentmenu_portletmanager\'\n+    icon = "toolbar-action/portlets"\n     order = 50\n \n     def __init__(self, context, request):\n'

