Repository: plone.formwidget.namedfile


Branch: refs/heads/master
Date: 2021-03-09T11:35:52+01:00
Author: vangheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.formwidget.namedfile/commit/1f7c34bd1b8807681391fe6e830a48be0b1471b5

fix value is none

Files changed:
A news/35.bugfix
M plone/formwidget/namedfile/widget.py

b'diff --git a/news/35.bugfix b/news/35.bugfix\nnew file mode 100644\nindex 0000000..32a1fc9\n--- /dev/null\n+++ b/news/35.bugfix\n@@ -0,0 +1 @@\n+Fix `NamedFileWidget` bug when trying to create value from `None`. [vangheem]\n\\ No newline at end of file\ndiff --git a/plone/formwidget/namedfile/widget.py b/plone/formwidget/namedfile/widget.py\nindex c97920d..0f974fd 100644\n--- a/plone/formwidget/namedfile/widget.py\n+++ b/plone/formwidget/namedfile/widget.py\n@@ -307,7 +307,8 @@ def extract(self, default=NOVALUE):\n             dm = getMultiAdapter((self.context, self.field,), IDataManager)\n             # For sub-widgets to function use a query() not get()\n             data = dm.query(default)\n-            data = _make_namedfile(data, self.field, self.context)\n+            if data is not None:\n+                data = _make_namedfile(data, self.field, self.context)\n             return data\n \n         # empty unnamed FileUploads should not count as a value\n'

Repository: plone.formwidget.namedfile


Branch: refs/heads/master
Date: 2021-03-09T11:36:44+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.formwidget.namedfile/commit/88675a68ac9aef324e6e7ed4eb4e6ac311993a8c

Merge pull request #35 from plone/value-none-error

Fix `NamedFileWidget` bug when trying to create value   from `None`

Files changed:
A news/35.bugfix
M plone/formwidget/namedfile/widget.py

b'diff --git a/news/35.bugfix b/news/35.bugfix\nnew file mode 100644\nindex 0000000..32a1fc9\n--- /dev/null\n+++ b/news/35.bugfix\n@@ -0,0 +1 @@\n+Fix `NamedFileWidget` bug when trying to create value from `None`. [vangheem]\n\\ No newline at end of file\ndiff --git a/plone/formwidget/namedfile/widget.py b/plone/formwidget/namedfile/widget.py\nindex c97920d..0f974fd 100644\n--- a/plone/formwidget/namedfile/widget.py\n+++ b/plone/formwidget/namedfile/widget.py\n@@ -307,7 +307,8 @@ def extract(self, default=NOVALUE):\n             dm = getMultiAdapter((self.context, self.field,), IDataManager)\n             # For sub-widgets to function use a query() not get()\n             data = dm.query(default)\n-            data = _make_namedfile(data, self.field, self.context)\n+            if data is not None:\n+                data = _make_namedfile(data, self.field, self.context)\n             return data\n \n         # empty unnamed FileUploads should not count as a value\n'

