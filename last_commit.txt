Repository: plone.portlet.static


Branch: refs/heads/master
Date: 2021-02-13T09:50:05+01:00
Author: Peter Mathis (petschki) <petschki@users.noreply.github.com>
Commit: https://github.com/plone/plone.portlet.static/commit/03f7e430cb8ed139dad3a3b592d772d4c0f24d3d

Barceloneta LTS (#21)

* update markup for bootstrap

* fix required omit_border

* fix test

Co-authored-by: Peter Holzer &lt;peter.holzer@agitator.com&gt;

Files changed:
A news/20.bugfix
M plone/portlet/static/static.pt
M plone/portlet/static/static.py
M plone/portlet/static/tests/test_portlet_static.py

b'diff --git a/news/20.bugfix b/news/20.bugfix\nnew file mode 100644\nindex 0000000..8593049\n--- /dev/null\n+++ b/news/20.bugfix\n@@ -0,0 +1,2 @@\n+Remove explicit required attribute on `omit_border` boolean\n+[petschki]\n\\ No newline at end of file\ndiff --git a/plone/portlet/static/static.pt b/plone/portlet/static/static.pt\nindex df5143d..1c15a02 100644\n--- a/plone/portlet/static/static.pt\n+++ b/plone/portlet/static/static.pt\n@@ -1,32 +1,39 @@\n-<div tal:condition="view/data/omit_border"\n-     tal:attributes="class string:portletStaticText ${view/css_class}"\n-     tal:content="structure view/transformed" />\n+<html xmlns="http://www.w3.org/1999/xhtml"\n+      xmlns:tal="http://xml.zope.org/namespaces/tal"\n+      xmlns:i18n="http://xml.zope.org/namespaces/i18n"\n+      tal:omit-tag="">\n \n-<section tal:condition="not:view/data/omit_border"\n-    tal:attributes="class string:portlet portletStaticText ${view/css_class}"\n-    i18n:domain="plone">\n+  <div tal:condition="view/data/omit_border"\n+      tal:attributes="class string:portletStaticText ${view/css_class}"\n+      tal:content="structure view/transformed" />\n \n-    <header class="portletHeader"\n+  <div tal:condition="not:view/data/omit_border"\n+      tal:attributes="class string:card portlet portletStaticText ${view/css_class}"\n+      i18n:domain="plone">\n+\n+    <div class="card-header"\n         tal:define="header view/data/header"\n-        tal:attributes="class python:header and \'portletHeader\' or \'portletHeader titleless\'">\n-           <a class="tile"\n-              tal:condition="header"\n-              tal:omit-tag="not:view/has_link"\n-              tal:attributes="href view/data/more_url"\n-              tal:content="header"\n-              />\n-    </header>\n+        tal:attributes="class python:header and \'card-header\' or \'card-header titleless\'">\n+      <a class="tile"\n+          tal:condition="header"\n+          tal:omit-tag="not:view/has_link"\n+          tal:attributes="href view/data/more_url"\n+          tal:content="header"\n+          />\n+    </div>\n+\n+    <div class="card-body">\n+      <div tal:content="structure view/transformed" />\n+    </div>\n+\n+    <div class="card-footer" tal:condition="view/has_footer">\n+      <a class="tile"\n+          tal:omit-tag="not:view/has_link"\n+          tal:attributes="href view/data/more_url"\n+          tal:content="view/data/footer"\n+          />\n+    </div>\n \n-    <section class="portletContent">\n-        <div tal:replace="structure view/transformed" />\n-    </section>\n-    \n-    <footer class="portletFooter" tal:condition="view/has_footer">\n-           <a class="tile"\n-              tal:omit-tag="not:view/has_link"\n-              tal:attributes="href view/data/more_url"\n-              tal:content="view/data/footer"\n-              />\n-    </footer>\n+  </div>\n \n-</section>\n+</html>\n\\ No newline at end of file\ndiff --git a/plone/portlet/static/static.py b/plone/portlet/static/static.py\nindex ad5da71..5a4514e 100644\n--- a/plone/portlet/static/static.py\n+++ b/plone/portlet/static/static.py\n@@ -49,7 +49,7 @@ class IStaticPortlet(IPortletDataProvider):\n             u"Tick this box if you want to render the text above "\n             "without the standard header, border or footer."\n         ),\n-        required=True,\n+        required=False,\n         default=False)\n \n     footer = schema.TextLine(\ndiff --git a/plone/portlet/static/tests/test_portlet_static.py b/plone/portlet/static/tests/test_portlet_static.py\nindex 8a01011..bb8e12a 100644\n--- a/plone/portlet/static/tests/test_portlet_static.py\n+++ b/plone/portlet/static/tests/test_portlet_static.py\n@@ -131,7 +131,7 @@ def test_no_header(self):\n         r.update()\n         output = r.render()\n         self.assertTrue(\'<a class="tile"\' not in output)\n-        self.assertTrue(\'<header class="portletHeader titleless"\' in output)\n+        self.assertTrue(\'<div class="card-header"\' not in output)\n \n     def test_hide(self):\n         self.assertRaises(TypeError, static.Assignment, hide=True)\n'

