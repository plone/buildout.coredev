Repository: Products.CMFPlone


Branch: refs/heads/5.2.x
Date: 2020-04-15T02:20:06+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/b43d5d2c269c2e5e614660a5d1fc650b4124c036

fix py 3.8 time.clock removal

Files changed:
A news/3082.bugfix
M Products/CMFPlone/CatalogTool.py

b'diff --git a/Products/CMFPlone/CatalogTool.py b/Products/CMFPlone/CatalogTool.py\nindex 5b42c34f37..0ac59665a4 100644\n--- a/Products/CMFPlone/CatalogTool.py\n+++ b/Products/CMFPlone/CatalogTool.py\n@@ -45,6 +45,12 @@\n import six\n import time\n \n+try:\n+    from time import clock as process_time\n+except ImportError:\n+    from time import process_time\n+\n+\n logger = logging.getLogger(\'Plone\')\n \n _marker = object()\n@@ -514,12 +520,12 @@ def manage_catalogRebuild(self, RESPONSE=None, URL1=None):\n         method. This may take a long time.\n         """\n         elapse = time.time()\n-        c_elapse = time.clock()\n+        c_elapse = process_time()\n \n         self.clearFindAndRebuild()\n \n         elapse = time.time() - elapse\n-        c_elapse = time.clock() - c_elapse\n+        c_elapse = process_time() - c_elapse\n \n         msg = (\'Catalog Rebuilt\\n\'\n                \'Total time: %s\\n\'\ndiff --git a/news/3082.bugfix b/news/3082.bugfix\nnew file mode 100644\nindex 0000000000..1755dc18f7\n--- /dev/null\n+++ b/news/3082.bugfix\n@@ -0,0 +1 @@\n+Fix Python 3.8 ``time.clock`` removal in CatalogTool [jensens]\n'

Repository: Products.CMFPlone


Branch: refs/heads/5.2.x
Date: 2020-04-15T08:46:40+02:00
Author: Alessandro Pisa (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/f473a0b46db2053b92bd14b3da2fdb269f7ea288

Merge pull request #3082 from plone/fix-py38-time.clock-removal

Fix py38 time.clock removal

Files changed:
A news/3082.bugfix
M Products/CMFPlone/CatalogTool.py

b'diff --git a/Products/CMFPlone/CatalogTool.py b/Products/CMFPlone/CatalogTool.py\nindex 5b42c34f37..0ac59665a4 100644\n--- a/Products/CMFPlone/CatalogTool.py\n+++ b/Products/CMFPlone/CatalogTool.py\n@@ -45,6 +45,12 @@\n import six\n import time\n \n+try:\n+    from time import clock as process_time\n+except ImportError:\n+    from time import process_time\n+\n+\n logger = logging.getLogger(\'Plone\')\n \n _marker = object()\n@@ -514,12 +520,12 @@ def manage_catalogRebuild(self, RESPONSE=None, URL1=None):\n         method. This may take a long time.\n         """\n         elapse = time.time()\n-        c_elapse = time.clock()\n+        c_elapse = process_time()\n \n         self.clearFindAndRebuild()\n \n         elapse = time.time() - elapse\n-        c_elapse = time.clock() - c_elapse\n+        c_elapse = process_time() - c_elapse\n \n         msg = (\'Catalog Rebuilt\\n\'\n                \'Total time: %s\\n\'\ndiff --git a/news/3082.bugfix b/news/3082.bugfix\nnew file mode 100644\nindex 0000000000..1755dc18f7\n--- /dev/null\n+++ b/news/3082.bugfix\n@@ -0,0 +1 @@\n+Fix Python 3.8 ``time.clock`` removal in CatalogTool [jensens]\n'

