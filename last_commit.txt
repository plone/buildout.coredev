Repository: plone.testing


Branch: refs/heads/master
Date: 2021-02-11T14:38:45+01:00
Author: JÃ¼rgen Gmach (jugmac00) <juergen.gmach@googlemail.com>
Commit: https://github.com/plone/plone.testing/commit/7cc926921ea858b716ad7c93593a5ccd68eef9f8

Fix `clear_untrusted_proxy_headers` deprecation warning

Fixes...

DeprecationWarning: In future versions of Waitress
clear_untrusted_proxy_headers will be set to True by default. You may
opt-out by setting this value to False, or opt-in explicitly by setting
this to True.

Files changed:
A news/77.bugfix
M src/plone/testing/zope.py

b'diff --git a/news/77.bugfix b/news/77.bugfix\nnew file mode 100644\nindex 0000000..7aa576c\n--- /dev/null\n+++ b/news/77.bugfix\n@@ -0,0 +1 @@\n+fix waitress deprecation warning\n\\ No newline at end of file\ndiff --git a/src/plone/testing/zope.py b/src/plone/testing/zope.py\nindex 01ac3bb..f59a53d 100644\n--- a/src/plone/testing/zope.py\n+++ b/src/plone/testing/zope.py\n@@ -917,7 +917,7 @@ def setUpServer(self):\n         """Create a WSGI server instance and save it in self.server.\n         """\n         app = self.make_wsgi_app()\n-        kwargs = {}\n+        kwargs = {\'clear_untrusted_proxy_headers\': False}\n         if self.host is not None:\n             kwargs[\'host\'] = self.host\n         if self.port is not None:\n'

Repository: plone.testing


Branch: refs/heads/master
Date: 2021-04-23T09:52:41+02:00
Author: Alessandro Pisa (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/plone.testing/commit/91c01aaaeb627b1c53525ef7e45c67db2a71405d

Merge pull request #78 from plone/fix-deprecation-warning

Fix `clear_untrusted_proxy_headers` deprecation warning

Files changed:
A news/77.bugfix
M src/plone/testing/zope.py

b'diff --git a/news/77.bugfix b/news/77.bugfix\nnew file mode 100644\nindex 0000000..7aa576c\n--- /dev/null\n+++ b/news/77.bugfix\n@@ -0,0 +1 @@\n+fix waitress deprecation warning\n\\ No newline at end of file\ndiff --git a/src/plone/testing/zope.py b/src/plone/testing/zope.py\nindex 01ac3bb..f59a53d 100644\n--- a/src/plone/testing/zope.py\n+++ b/src/plone/testing/zope.py\n@@ -917,7 +917,7 @@ def setUpServer(self):\n         """Create a WSGI server instance and save it in self.server.\n         """\n         app = self.make_wsgi_app()\n-        kwargs = {}\n+        kwargs = {\'clear_untrusted_proxy_headers\': False}\n         if self.host is not None:\n             kwargs[\'host\'] = self.host\n         if self.port is not None:\n'

