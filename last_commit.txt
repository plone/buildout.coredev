Repository: plone.restapi


Branch: refs/heads/master
Date: 2020-12-18T07:27:49+01:00
Author: Timo Stollenwerk (tisto) <tisto@users.noreply.github.com>
Commit: https://github.com/plone/plone.restapi/commit/a58429c17bc06437ed7366e056cd8008b627c78b

make update (#1033)

* make update

* Update docs

* Update docs

* Update docs

* Update docs

* Fix no-uncommitted-changes check

* Fix uncommmitted changes

* Fix uncommited changes test

* Fix ci

* fix env check

* Plone version is 5.2

* Debug

* We need env vars on the script itself

* Fix env

* Comment out no-uncommitted changes check

* Avoid dynamic dexterity schema updates.

* Re ad no uncommitted doc changes

* Update docs

Files changed:
M .github/workflows/ci.yml
M plone-4.3.x.cfg
M plone-5.1.x.cfg
M plone-5.2.x.cfg
M src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp
M test-no-uncommitted-doc-changes.in
M versions.cfg

b'diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml\nindex dfa298581..72c8295b1 100644\n--- a/.github/workflows/ci.yml\n+++ b/.github/workflows/ci.yml\n@@ -80,6 +80,9 @@ jobs:\n       # test no uncommited changes\n       - name: test no uncommited changes\n         run: bin/test-no-uncommitted-doc-changes\n+        env:\n+          PYTHON_VERSION: ${{ matrix.python-version }}\n+          PLONE_VERSION: ${{ matrix.plone-version }}\n \n       # test sphinx warnings\n       - name: sphinx\ndiff --git a/plone-4.3.x.cfg b/plone-4.3.x.cfg\nindex fb9916c7a..a00b3456c 100644\n--- a/plone-4.3.x.cfg\n+++ b/plone-4.3.x.cfg\n@@ -5,13 +5,29 @@ extends =\n     versions.cfg\n \n [versions]\n-plone.restapi =\n-plone.schema = 1.2.1\n-# Error: The requirement (\'distlib<1,>=0.3.1\') is not allowed by your [versions] constraint (0.3.0)\n-distlib = 0.3.1\n-# zipp >= 2.0.0 is not compatible with Python 2\n-zipp = 1.2.0\n+plone.testing = 5.0.0\n+pytz = 2017.3\n+zope.interface = 4.1.0\n+\n+# fixes zlib failure: https://stackoverflow.com/questions/34631806/fail-during-installation-of-pillow-python-module-in-linux\n+# Pillow = 5.4.1\n+future = 0.17.1\n+six = 1.11.0\n+\n+# fixes: SyntaxError: invalid syntax (more.py, line 340)\n+zipp = 0.5.2\n+\n+# more-itertools >= 6.0.0 dropped python2.7 support\n+more-itertools = 5.0.0\n+\n # Error: The requirement (\'Pygments>=2.5.1\') is not allowed by your [versions] constraint (2.2.0)\n Pygments = 2.5.2\n+\n # Last pyrsistent version that is python 2 compatible:\n pyrsistent = 0.15.7\n+\n+# Error: The requirement (\'distlib<1,>=0.3.1\') is not allowed by your [versions] constraint (0.3.0)\n+distlib = 0.3.1\n+\n+# plone.restapi specific pins\n+plone.restapi =\n\\ No newline at end of file\ndiff --git a/plone-5.1.x.cfg b/plone-5.1.x.cfg\nindex 3329abea9..40165e1c1 100644\n--- a/plone-5.1.x.cfg\n+++ b/plone-5.1.x.cfg\n@@ -5,7 +5,35 @@ extends =\n     versions.cfg\n \n [versions]\n-plone.restapi =\n+plone.testing = 5.0.0\n+\n+# Error: The requirement (\'virtualenv>=20.0.35\') is not allowed by your [versions] constraint (20.0.26)\n+virtualenv = 20.0.35\n+\n+# Error: The requirement (\'distlib<1,>=0.3.1\') is not allowed by your [versions] constraint (0.3.0)\n+distlib = 0.3.1\n+\n+# fixes: SyntaxError: invalid syntax (more.py, line 340)\n+zipp = 0.5.2\n \n-# plone.restapi specific\n+# zest.releaser\n+zest.releaser = 6.20.1\n+twine = 1.11.0\n+towncrier = 19.2.0\n+zestreleaser.towncrier = 1.1.0\n+# docutils = 0.13.1\n+\n+# Sphinx\n+Sphinx = 1.6.5\n+docutils = 0.14\n+Pygments = 2.5.1\n+sphinxcontrib-httpexample = 0.7.0\n+sphinxcontrib-httpdomain = 1.5.0\n+sphinx-rtd-theme = 0.2.4\n+Jinja2 = 2.10\n+Babel = 2.5.1\n+astunparse = 1.6.2\n+\n+# plone.restapi specific pins\n+plone.restapi =\n plone.schema = 1.2.1\ndiff --git a/plone-5.2.x.cfg b/plone-5.2.x.cfg\nindex 3ece3b833..f39c263b3 100644\n--- a/plone-5.2.x.cfg\n+++ b/plone-5.2.x.cfg\n@@ -1,28 +1,24 @@\n [buildout]\n extends =\n     base.cfg\n-    https://dist.plone.org/release/5.2.2/versions.cfg\n+    https://dist.plone.org/release/5.2.3/versions.cfg\n find-links += https://dist.plone.org/thirdparty/\n versions=versions\n \n [versions]\n-plone.restapi =\n-plone.namedfile = 5.3.1\n-astunparse = 1.6.2\n+black = 20.8b1\n \n-# requirement for jsonfield\n-plone.schema = 1.2.1\n+# Error: The requirement (\'virtualenv>=20.0.35\') is not allowed by your [versions] constraint (20.0.26)\n+virtualenv = 20.0.35\n \n-# requirement for the @types endpoint enhancements\n-# https://github.com/plone/plone.restapi/pull/951\n-# https://github.com/plone/plone.schemaeditor/pull/77\n-plone.schemaeditor = 3.0.1\n+# Error: The requirement (\'pep517>=0.9\') is not allowed by your [versions] constraint (0.8.2)\n+pep517 = 0.9.1\n \n # Error: The requirement (\'importlib-metadata>=1\') is not allowed by your [versions] constraint (0.23)\n importlib-metadata = 2.0.0\n \n-# Error: The requirement (\'pep517>=0.9\') is not allowed by your [versions] constraint (0.8.2)\n-pep517 = 0.9.1\n+# avoid dynamic schema updates: https://github.com/plone/plone.dexterity/pull/137\n+plone.dexterity = 2.9.8\n \n-# Error: The requirement (\'virtualenv>=20.0.35\') is not allowed by your [versions] constraint (20.0.26)\n-virtualenv = 20.0.35\n+# plone.restapi specific pins\n+plone.restapi =\n\\ No newline at end of file\ndiff --git a/src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp b/src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp\nindex 5937d0f05..fe8011f33 100644\n--- a/src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp\n+++ b/src/plone/restapi/tests/http-examples/translated_messages_types_folder.resp\n@@ -252,8 +252,7 @@ Content-Type: application/json+schema\n     }\n   }, \n   "required": [\n-    "title", \n-    "nextPreviousEnabled"\n+    "title"\n   ], \n   "title": "Carpeta", \n   "type": "object"\ndiff --git a/test-no-uncommitted-doc-changes.in b/test-no-uncommitted-doc-changes.in\nindex e21fe30bb..5772f8f8b 100644\n--- a/test-no-uncommitted-doc-changes.in\n+++ b/test-no-uncommitted-doc-changes.in\n@@ -13,7 +13,7 @@ function red {\n     echo "$RED $1 $RESET"\n }\n \n-if [ "$PLONE_VERSION" == "5.2.x" ] && [ $TRAVIS_PYTHON_VERSION == \'3.7\' ]; then\n+if [ "$PLONE_VERSION" == "5.2" ] && [ "$PYTHON_VERSION" == \'3.7\' ]; then\n     echo "Running check for undocumented changes for Plone 5.2.x on Python 3.7"\n else\n     # request/response dumps have known differences for Plone 5\ndiff --git a/versions.cfg b/versions.cfg\nindex 35f7bc49a..782a43cde 100644\n--- a/versions.cfg\n+++ b/versions.cfg\n@@ -36,3 +36,8 @@ sphinxcontrib-httpdomain = 1.5.0\n sphinx-rtd-theme = 0.2.4\n Jinja2 = 2.10\n Babel = 2.5.1\n+\n+# plone.rest(api) specific pins\n+\n+# last py2 compatible version\n+httpie = 1.0.3\n'

