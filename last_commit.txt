Repository: plone.app.textfield


Branch: refs/heads/master
Date: 2020-08-22T11:25:03+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.textfield/commit/348a6cb8b5b93447b9145325d7092ac1f8254082

Fixed deprecation warning for zope.component.interfaces.ComponentLookupError

```
DeprecationWarning: ComponentLookupError is deprecated. Import from zope.interface.interfaces
```

And moved some imports out of the try/except ImportError which is only meant for IMarkupSchema.
With the original code, once the backwards compatibility import in zope.component is gone,
we would have gotten an ImportError for it, and the markup schema would not be available.

Files changed:
A news/43.bugfix
M plone/app/textfield/utils.py

b'diff --git a/news/43.bugfix b/news/43.bugfix\nnew file mode 100644\nindex 0000000..5a87e62\n--- /dev/null\n+++ b/news/43.bugfix\n@@ -0,0 +1,2 @@\n+Fixed deprecation warning for ``zope.component.interfaces.ComponentLookupError``.\n+[maurits]\ndiff --git a/plone/app/textfield/utils.py b/plone/app/textfield/utils.py\nindex 4c19ae1..8ce90d9 100644\n--- a/plone/app/textfield/utils.py\n+++ b/plone/app/textfield/utils.py\n@@ -1,13 +1,13 @@\n # -*- coding: utf-8 -*-\n+from plone.registry.interfaces import IRegistry\n from Products.CMFCore.utils import getToolByName\n+from zope.component import getUtility\n from zope.component.hooks import getSite\n+from zope.interface.interfaces import ComponentLookupError\n \n \n try:\n     from Products.CMFPlone.interfaces import IMarkupSchema\n-    from plone.registry.interfaces import IRegistry\n-    from zope.component import getUtility\n-    from zope.component.interfaces import ComponentLookupError\n except ImportError:\n     IMarkupSchema = None\n \n'

Repository: plone.app.textfield


Branch: refs/heads/master
Date: 2020-08-24T12:30:21+02:00
Author: Maurits van Rees (mauritsvanrees) <m.van.rees@zestsoftware.nl>
Commit: https://github.com/plone/plone.app.textfield/commit/484005ceeae61e3e0caa69186a3f3d4a80e16cd5

Merge pull request #43 from plone/maurits/fix-startup-warnings

Fixed deprecation warning for ComponentLookupError

Files changed:
A news/43.bugfix
M plone/app/textfield/utils.py

b'diff --git a/news/43.bugfix b/news/43.bugfix\nnew file mode 100644\nindex 0000000..5a87e62\n--- /dev/null\n+++ b/news/43.bugfix\n@@ -0,0 +1,2 @@\n+Fixed deprecation warning for ``zope.component.interfaces.ComponentLookupError``.\n+[maurits]\ndiff --git a/plone/app/textfield/utils.py b/plone/app/textfield/utils.py\nindex 4c19ae1..8ce90d9 100644\n--- a/plone/app/textfield/utils.py\n+++ b/plone/app/textfield/utils.py\n@@ -1,13 +1,13 @@\n # -*- coding: utf-8 -*-\n+from plone.registry.interfaces import IRegistry\n from Products.CMFCore.utils import getToolByName\n+from zope.component import getUtility\n from zope.component.hooks import getSite\n+from zope.interface.interfaces import ComponentLookupError\n \n \n try:\n     from Products.CMFPlone.interfaces import IMarkupSchema\n-    from plone.registry.interfaces import IRegistry\n-    from zope.component import getUtility\n-    from zope.component.interfaces import ComponentLookupError\n except ImportError:\n     IMarkupSchema = None\n \n'

