Repository: plone.restapi


Branch: refs/heads/master
Date: 2023-07-14T14:28:23-04:00
Author: Akshat Jain (Akshat2Jain) <101265586+Akshat2Jain@users.noreply.github.com>
Commit: https://github.com/plone/plone.restapi/commit/477bfa4c576bb447f92a79b4a53aba7a527bbec6

Resolve version constraints for black package installation (#1671)

* added constraints.txt

* added log

* removed verison.cfg

* added flake8

---------

Co-authored-by: David Glick &lt;david@glicksoftware.com&gt;

Files changed:
A constraints.txt
A news/1671.internal
M .github/workflows/black.yml
M .github/workflows/flake8.yml
M Makefile
D versions.cfg

b"diff --git a/.github/workflows/black.yml b/.github/workflows/black.yml\nindex 57e85c144..a4535713e 100644\n--- a/.github/workflows/black.yml\n+++ b/.github/workflows/black.yml\n@@ -20,9 +20,9 @@ jobs:\n           python-version: ${{ matrix.python-version }}\n           cache: pip\n \n-      # install black (extract version from versions.cfg)\n+      # install black (with constraints)\n       - name: install black\n-        run: pip install click==$(awk '/^click =/{print $NF}' versions.cfg) black==$(awk '/^black =/{print $NF}' versions.cfg)\n+        run: pip install -c constraints.txt black\n \n       # run black\n       - name: run black\ndiff --git a/.github/workflows/flake8.yml b/.github/workflows/flake8.yml\nindex e373ff62f..ffbf0b3b2 100644\n--- a/.github/workflows/flake8.yml\n+++ b/.github/workflows/flake8.yml\n@@ -22,7 +22,7 @@ jobs:\n \n       # install flake8\n       - name: install flake8\n-        run: pip install flake8==$(awk '/^flake8 =/{print $NF}' versions.cfg)\n+        run: pip install -c constraints.txt flake8\n \n       # run black\n       - name: run flake8\ndiff --git a/Makefile b/Makefile\nindex 61fb4d8f7..a1e6e002b 100644\n--- a/Makefile\n+++ b/Makefile\n@@ -44,7 +44,7 @@ update: ## Update Make and Buildout\n bin/buildout: bin/pip\n \tbin/pip install --upgrade pip\n \tbin/pip install -r requirements-5.2.txt\n-\tbin/pip install black || true\n+\tbin/pip install -c constraints.txt black\n \t@touch -c $@\n \n bin/python bin/pip:\ndiff --git a/constraints.txt b/constraints.txt\nnew file mode 100644\nindex 000000000..f2204a07f\n--- /dev/null\n+++ b/constraints.txt\n@@ -0,0 +1,2 @@\n+black == 22.3.0\n+flake8 == 4.0.1\n\\ No newline at end of file\ndiff --git a/news/1671.internal b/news/1671.internal\nnew file mode 100644\nindex 000000000..57afb924d\n--- /dev/null\n+++ b/news/1671.internal\n@@ -0,0 +1 @@\n+Updated package installation to use constraints.txt for black package, ensuring compatibility and consistent versions. @Akshat2Jain\n\\ No newline at end of file\ndiff --git a/versions.cfg b/versions.cfg\ndeleted file mode 100644\nindex f14e01e91..000000000\n--- a/versions.cfg\n+++ /dev/null\n@@ -1,30 +0,0 @@\n-[versions]\n-# Buildout\n-setuptools =\n-zc.buildout =\n-plone.restapi =\n-\n-# code analysis\n-black = 22.3.0\n-click = 8.0.4\n-flake8 = 4.0.1\n-\n-# Error: The requirement ('virtualenv>=20.0.35') is not allowed by your [versions] constraint (20.0.26)\n-virtualenv = 20.0.35\n-\n-# Error: The requirement ('pep517>=0.9') is not allowed by your [versions] constraint (0.8.2)\n-pep517 = 0.9.1\n-\n-# Error: The requirement ('importlib-metadata>=1') is not allowed by your [versions] constraint (0.23)\n-importlib-metadata = 2.0.0\n-\n-# cryptography 3.4 requires a rust compiler installed on the system:\n-# https://github.com/pyca/cryptography/blob/master/CHANGELOG.rst#34---2021-02-07\n-cryptography = 3.3.2\n-\n-# cffi 1.14.3 fails on apple m1\n-cffi = 1.14.4\n-\n-# requirement for json widget tests to pass\n-plone.schema = 1.3.0\n-plone.dexterity = 2.9.8\n\\ No newline at end of file\n"

