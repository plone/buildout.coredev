Repository: plone.scale


Branch: refs/heads/master
Date: 2023-10-03T14:45:24+02:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.scale/commit/e8dbc430141052e67a9043f7b5be982f30318c0e

Fix KeyErrors in ScalesDict conflict resolution

Files changed:
M plone/scale/storage.py

b'diff --git a/plone/scale/storage.py b/plone/scale/storage.py\nindex d08a31b..3e4ac1d 100644\n--- a/plone/scale/storage.py\n+++ b/plone/scale/storage.py\n@@ -104,7 +104,7 @@ def _p_resolveConflict(self, oldState, savedState, newState):\n                     del saved[key]\n                 else:\n                     # modified by saved, deleted by new\n-                    self.raise_conflict(saved[key], new[key])\n+                    self.raise_conflict(saved[key], key)\n         for key in added:\n             if key in saved:\n                 # added by saved, added by new\n@@ -116,7 +116,7 @@ def _p_resolveConflict(self, oldState, savedState, newState):\n         for key in modified:\n             if key not in saved:\n                 # deleted by saved, modified by new\n-                self.raise_conflict(saved[key], new[key])\n+                self.raise_conflict(key, new[key])\n             elif saved[key]["modified"] != old[key]["modified"]:\n                 # modified by saved, modified by new\n                 self.raise_conflict(saved[key], new[key])\n'

Repository: plone.scale


Branch: refs/heads/master
Date: 2023-10-03T14:49:01+02:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.scale/commit/7fc5c3f5624ddb46fdf4658756ddf4ee278acfc4

changelog

Files changed:
A news/84.bugfix

b'diff --git a/news/84.bugfix b/news/84.bugfix\nnew file mode 100644\nindex 0000000..6b047a3\n--- /dev/null\n+++ b/news/84.bugfix\n@@ -0,0 +1 @@\n+Fix KeyError in ScalesDict conflict resolution. @davisagli\n'

Repository: plone.scale


Branch: refs/heads/master
Date: 2023-10-03T16:32:46+02:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.scale/commit/4f4d6703b755b734a1850e1f9c0b753c005318cc

Merge pull request #84 from plone/fix-conflict-res

Fix KeyErrors in ScalesDict conflict resolution

Files changed:
A news/84.bugfix
M plone/scale/storage.py

b'diff --git a/news/84.bugfix b/news/84.bugfix\nnew file mode 100644\nindex 0000000..6b047a3\n--- /dev/null\n+++ b/news/84.bugfix\n@@ -0,0 +1 @@\n+Fix KeyError in ScalesDict conflict resolution. @davisagli\ndiff --git a/plone/scale/storage.py b/plone/scale/storage.py\nindex d08a31b..3e4ac1d 100644\n--- a/plone/scale/storage.py\n+++ b/plone/scale/storage.py\n@@ -104,7 +104,7 @@ def _p_resolveConflict(self, oldState, savedState, newState):\n                     del saved[key]\n                 else:\n                     # modified by saved, deleted by new\n-                    self.raise_conflict(saved[key], new[key])\n+                    self.raise_conflict(saved[key], key)\n         for key in added:\n             if key in saved:\n                 # added by saved, added by new\n@@ -116,7 +116,7 @@ def _p_resolveConflict(self, oldState, savedState, newState):\n         for key in modified:\n             if key not in saved:\n                 # deleted by saved, modified by new\n-                self.raise_conflict(saved[key], new[key])\n+                self.raise_conflict(key, new[key])\n             elif saved[key]["modified"] != old[key]["modified"]:\n                 # modified by saved, modified by new\n                 self.raise_conflict(saved[key], new[key])\n'

