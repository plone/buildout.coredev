Repository: Products.CMFPlone


Branch: refs/heads/5.2.x
Date: 2020-10-12T21:38:54+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/935def902830b5bb3c5fddd8de6bb53f90534c67

Robot tests: Do not use jQuery.size() but use ``.length`` instead.
``.size()`` is deprecated since 1.8.

Files changed:
A news/3195.bugfix
M Products/CMFPlone/tests/robot/common.robot
M Products/CMFPlone/tests/robot/keywords.robot
M Products/CMFPlone/tests/robot/test_edit.robot
M Products/CMFPlone/tests/robot/test_folder_contents.robot
M Products/CMFPlone/tests/robot/test_overlays.robot
M Products/CMFPlone/tests/robot/test_querystring.robot

b'diff --git a/Products/CMFPlone/tests/robot/common.robot b/Products/CMFPlone/tests/robot/common.robot\nindex 54a5df371e..33791aa6dc 100644\n--- a/Products/CMFPlone/tests/robot/common.robot\n+++ b/Products/CMFPlone/tests/robot/common.robot\n@@ -61,7 +61,7 @@ there should be \'${count}\' livesearch results\n     Wait until keyword succeeds  5s  1s  Xpath Should Match X Times  //div[@id = \'LSResult\']/descendant::li  ${count}\n \n patterns are loaded\n-    Wait For Condition  return window.jQuery(\'body.patterns-loaded\').size() > 0\n+    Wait For Condition  return !!document.querySelector(\'body.patterns-loaded\')\n \n Refresh JS/CSS resources\n     # Not needed anymore, and it is breaking the Plone Zope 4 tests.\ndiff --git a/Products/CMFPlone/tests/robot/keywords.robot b/Products/CMFPlone/tests/robot/keywords.robot\nindex fa97b4bd18..75765ffc38 100644\n--- a/Products/CMFPlone/tests/robot/keywords.robot\n+++ b/Products/CMFPlone/tests/robot/keywords.robot\n@@ -28,7 +28,7 @@ a folder \'${title}\'\n   Create content  type=Folder  title=${title}\n \n patterns are loaded\n-  Wait For Condition  return window.jQuery(\'body.patterns-loaded\').size() > 0\n+  Wait For Condition  return !!document.querySelector(\'body.patterns-loaded\')\n \n a folder with a document \'${title}\'\n   ${folder_uid}=  Create content  type=Folder  title=folder\ndiff --git a/Products/CMFPlone/tests/robot/test_edit.robot b/Products/CMFPlone/tests/robot/test_edit.robot\nindex 94896000da..67ad46425e 100644\n--- a/Products/CMFPlone/tests/robot/test_edit.robot\n+++ b/Products/CMFPlone/tests/robot/test_edit.robot\n@@ -83,7 +83,7 @@ I have the title input field\n     Element Should Be Visible  xpath=//fieldset[@id=\'fieldset-default\']\n \n I can only see the default tab\n-    Wait For Condition  return window.jQuery(\'.autotoc-nav .active:visible\').size() > 0\n+    Wait For Condition  return window.jQuery(\'.autotoc-nav .active:visible\').length > 0\n     Element Should Not Be Visible  xpath=//fieldset[@id=\'fieldset-settings\']\n     Element Should Not Be Visible  xpath=//fieldset[@id=\'fieldset-dates\']\n     Element Should Not Be Visible  xpath=//fieldset[@id=\'fieldset-categorization\']\ndiff --git a/Products/CMFPlone/tests/robot/test_folder_contents.robot b/Products/CMFPlone/tests/robot/test_folder_contents.robot\nindex 2e08c6d686..960b9dc068 100644\n--- a/Products/CMFPlone/tests/robot/test_folder_contents.robot\n+++ b/Products/CMFPlone/tests/robot/test_folder_contents.robot\n@@ -129,4 +129,4 @@ Should be above\n     Should be true  ${locator1-position} < ${locator2-position}\n \n folder contents pattern loaded\n-    Wait For Condition  return window.jQuery(\'.pat-structure div.navbar\').size() > 0\n+    Wait For Condition  return !!document.querySelector(\'.pat-structure div.navbar\')\ndiff --git a/Products/CMFPlone/tests/robot/test_overlays.robot b/Products/CMFPlone/tests/robot/test_overlays.robot\nindex 4afeee27a2..0d57b15fde 100644\n--- a/Products/CMFPlone/tests/robot/test_overlays.robot\n+++ b/Products/CMFPlone/tests/robot/test_overlays.robot\n@@ -283,7 +283,7 @@ I trigger the add a new user action\n \n a document \'${title}\' in the test folder\n     Go to  ${PLONE_URL}/${TEST_FOLDER}/++add++Document\n-    Wait For Condition  return window.jQuery(\'.autotoc-nav .active:visible\').size() > 0\n+    Wait For Condition  return window.jQuery(\'.autotoc-nav .active:visible\').length > 0\n     Execute Javascript  $(\'#form-widgets-IDublinCore-title\').val(\'${title}\'); return 0;\n     Click Button  Save\n \ndiff --git a/Products/CMFPlone/tests/robot/test_querystring.robot b/Products/CMFPlone/tests/robot/test_querystring.robot\nindex ee6de5a090..074d47da20 100644\n--- a/Products/CMFPlone/tests/robot/test_querystring.robot\n+++ b/Products/CMFPlone/tests/robot/test_querystring.robot\n@@ -231,7 +231,7 @@ the querystring pattern\n     Execute Javascript  $(window).unbind(\'beforeunload\')\n \n querystring pattern loaded\n-    Wait For Condition  return window.jQuery(\'.querystring-criteria-remove\').size() > 0\n+    Wait For Condition  return !!document.querySelector(\'.querystring-criteria-remove\')\n \n a bunch of folders\n     #We create enough items to give meaningful test results\n@@ -347,4 +347,4 @@ mark results\n     Execute Javascript  $("dl.searchResults").attr("marker", "marked")\n \n wait until result is no longer marked\n-    Wait for condition  return $("dl.searchResults").length > 0 && $("dl.searchResults").attr("marker") != "marked"\n\\ No newline at end of file\n+    Wait for condition  return $("dl.searchResults").length > 0 && $("dl.searchResults").attr("marker") != "marked"\ndiff --git a/news/3195.bugfix b/news/3195.bugfix\nnew file mode 100644\nindex 0000000000..85ee3939e4\n--- /dev/null\n+++ b/news/3195.bugfix\n@@ -0,0 +1,3 @@\n+Robot tests: Do not use jQuery.size() but use ``.length`` instead.\n+``.size()`` is deprecated since 1.8.\n+[thet]\n'

