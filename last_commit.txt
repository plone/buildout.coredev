Repository: plone.app.versioningbehavior


Branch: refs/heads/master
Date: 2020-07-21T13:40:02+02:00
Author: Laurent Lasudry (laulaz) <lasudry@gmail.com>
Commit: https://github.com/plone/plone.app.versioningbehavior/commit/d8a627a9a3f959b18c9c332d74ce917aa8cbaba8

Avoid traceback when transforming links on content type with no primary field

This refs #51

Files changed:
A news/51.bugfix
M plone/app/versioningbehavior/browser.py

b"diff --git a/news/51.bugfix b/news/51.bugfix\nnew file mode 100644\nindex 0000000..a93cfa2\n--- /dev/null\n+++ b/news/51.bugfix\n@@ -0,0 +1,2 @@\n+Avoid traceback when transforming links on content type with no primary field\n+[laulaz]\ndiff --git a/plone/app/versioningbehavior/browser.py b/plone/app/versioningbehavior/browser.py\nindex 1c9d952..5568dc0 100644\n--- a/plone/app/versioningbehavior/browser.py\n+++ b/plone/app/versioningbehavior/browser.py\n@@ -104,7 +104,7 @@ def __call__(self):\n         if not version_id:\n             raise ValueError(u'Missing parameter on the request: version_id')\n \n-        field_id = self.request.get('field_id', IPrimaryFieldInfo(self.context).fieldname)\n+        field_id = self.request.get('field_id') or IPrimaryFieldInfo(self.context).fieldname\n         filename = self.request.get('filename')\n         do_not_stream = self.request.get('do_not_stream')\n \n"

Repository: plone.app.versioningbehavior


Branch: refs/heads/master
Date: 2020-07-22T14:13:29+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.versioningbehavior/commit/f6ecbc5a84b8e2c46be237c220e86096d852ef10

Merge pull request #52 from IMIO/master

Avoid traceback when transforming links on content type with no primary field

Files changed:
A news/51.bugfix
M plone/app/versioningbehavior/browser.py

b"diff --git a/news/51.bugfix b/news/51.bugfix\nnew file mode 100644\nindex 0000000..a93cfa2\n--- /dev/null\n+++ b/news/51.bugfix\n@@ -0,0 +1,2 @@\n+Avoid traceback when transforming links on content type with no primary field\n+[laulaz]\ndiff --git a/plone/app/versioningbehavior/browser.py b/plone/app/versioningbehavior/browser.py\nindex 1c9d952..5568dc0 100644\n--- a/plone/app/versioningbehavior/browser.py\n+++ b/plone/app/versioningbehavior/browser.py\n@@ -104,7 +104,7 @@ def __call__(self):\n         if not version_id:\n             raise ValueError(u'Missing parameter on the request: version_id')\n \n-        field_id = self.request.get('field_id', IPrimaryFieldInfo(self.context).fieldname)\n+        field_id = self.request.get('field_id') or IPrimaryFieldInfo(self.context).fieldname\n         filename = self.request.get('filename')\n         do_not_stream = self.request.get('do_not_stream')\n \n"

