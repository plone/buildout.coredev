Repository: plone.app.iterate


Branch: refs/heads/master
Date: 2021-06-29T10:57:14+02:00
Author: Victor Fernandez de Alba (sneridagh) <sneridagh@gmail.com>
Commit: https://github.com/plone/plone.app.iterate/commit/75d5e340c038ec6ec4ea0be3faf979f10d130ab7

Fix checkin/checkout process for containers, since there was an annotation left to reset (pos) on checkout and it broke the sections viewlet

Files changed:
A news/93.bugfix
M plone/app/iterate/dexterity/copier.py

b'diff --git a/news/93.bugfix b/news/93.bugfix\nnew file mode 100644\nindex 0000000..da3af77\n--- /dev/null\n+++ b/news/93.bugfix\n@@ -0,0 +1,2 @@\n+- Fix checkin/checkout process for containers, since there was an annotation left to "reset" (pos) on checkout and it broke the sections viewlet\n+  [sneridagh]\ndiff --git a/plone/app/iterate/dexterity/copier.py b/plone/app/iterate/dexterity/copier.py\nindex 472a8ff..d89a47f 100644\n--- a/plone/app/iterate/dexterity/copier.py\n+++ b/plone/app/iterate/dexterity/copier.py\n@@ -209,6 +209,8 @@ def _copyBaseline(self, container):\n         # Remove plone.folder.order from it to not spoil the wc\n         if "plone.folder.ordered.order" in wc_annotations:\n             wc_annotations.pop("plone.folder.ordered.order")\n+        if "plone.folder.ordered.pos" in wc_annotations:\n+            wc_annotations.pop("plone.folder.ordered.pos")\n \n         return obj\n \n@@ -255,6 +257,8 @@ def _replaceBaseline(self, baseline):\n         # Remove plone.folder.ordered.order from it to not mess with the original\n         if "plone.folder.ordered.order" in wc_annotations:\n             wc_annotations.pop("plone.folder.ordered.order")\n+        if "plone.folder.ordered.pos" in wc_annotations:\n+            wc_annotations.pop("plone.folder.ordered.pos")\n \n         baseline_annotations.update(wc_annotations)\n \n'

Repository: plone.app.iterate


Branch: refs/heads/master
Date: 2021-06-29T14:20:37+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.iterate/commit/2dc28e0a8ab64e571ece9b8f8c233d4f5fa41a7f

Merge pull request #94 from plone/fixsectionviewletbroken

Fix checkin/checkout process for containers, since there was an annotâ€¦

Files changed:
A news/93.bugfix
M plone/app/iterate/dexterity/copier.py

b'diff --git a/news/93.bugfix b/news/93.bugfix\nnew file mode 100644\nindex 0000000..da3af77\n--- /dev/null\n+++ b/news/93.bugfix\n@@ -0,0 +1,2 @@\n+- Fix checkin/checkout process for containers, since there was an annotation left to "reset" (pos) on checkout and it broke the sections viewlet\n+  [sneridagh]\ndiff --git a/plone/app/iterate/dexterity/copier.py b/plone/app/iterate/dexterity/copier.py\nindex 472a8ff..d89a47f 100644\n--- a/plone/app/iterate/dexterity/copier.py\n+++ b/plone/app/iterate/dexterity/copier.py\n@@ -209,6 +209,8 @@ def _copyBaseline(self, container):\n         # Remove plone.folder.order from it to not spoil the wc\n         if "plone.folder.ordered.order" in wc_annotations:\n             wc_annotations.pop("plone.folder.ordered.order")\n+        if "plone.folder.ordered.pos" in wc_annotations:\n+            wc_annotations.pop("plone.folder.ordered.pos")\n \n         return obj\n \n@@ -255,6 +257,8 @@ def _replaceBaseline(self, baseline):\n         # Remove plone.folder.ordered.order from it to not mess with the original\n         if "plone.folder.ordered.order" in wc_annotations:\n             wc_annotations.pop("plone.folder.ordered.order")\n+        if "plone.folder.ordered.pos" in wc_annotations:\n+            wc_annotations.pop("plone.folder.ordered.pos")\n \n         baseline_annotations.update(wc_annotations)\n \n'

