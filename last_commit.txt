Repository: plone.scale


Branch: refs/heads/master
Date: 2024-01-18T22:48:05+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.scale/commit/b45521925f19898de2bce327c6bd465cf64f5aa5

Fix incompatibility with Pillow 10.1+.

Instead of setting ``image.mode``, we call ``image.convert``. This works in Pillow 9 and 10.

Files changed:
A news/89.bugfix
M plone/scale/scale.py

b'diff --git a/news/89.bugfix b/news/89.bugfix\nnew file mode 100644\nindex 0000000..12351b4\n--- /dev/null\n+++ b/news/89.bugfix\n@@ -0,0 +1,4 @@\n+Fix incompatibility with Pillow 10.1+.\n+Instead of setting ``image.mode``, we call ``image.convert``.\n+This works in Pillow 9 and 10.\n+[maurits]\ndiff --git a/plone/scale/scale.py b/plone/scale/scale.py\nindex 01ba778..c3f7624 100644\n--- a/plone/scale/scale.py\n+++ b/plone/scale/scale.py\n@@ -174,7 +174,7 @@ def scaleSingleFrame(\n         if extrema.get("A") == (255, 255):\n             # no alpha used, just change the mode, which causes the alpha band\n             # to be dropped on save\n-            image.mode = "RGB"\n+            image = image.convert("RGB")\n         else:\n             # switch to PNG, which supports alpha\n             format_ = "PNG"\n'

Repository: plone.scale


Branch: refs/heads/master
Date: 2024-01-18T22:49:51+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.scale/commit/ca982e2893712cc90946a06700521c6c6f45089d

pre-commit autoupdate: flake8 7.0.0

Files changed:
M .pre-commit-config.yaml

b'diff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nindex aa2a758..38e73ea 100644\n--- a/.pre-commit-config.yaml\n+++ b/.pre-commit-config.yaml\n@@ -32,7 +32,7 @@ repos:\n #  """\n ##\n -   repo: https://github.com/PyCQA/flake8\n-    rev: 6.1.0\n+    rev: 7.0.0\n     hooks:\n     -   id: flake8\n \n'

Repository: plone.scale


Branch: refs/heads/master
Date: 2024-01-29T09:59:03+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.scale/commit/5f7f34010365a66133f5d76efee979ae6398ead8

Merge pull request #90 from plone/maurits-pillow-10

Fix incompatibility with Pillow 10.1+.

Files changed:
A news/89.bugfix
M .pre-commit-config.yaml
M plone/scale/scale.py

b'diff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nindex aa2a758..38e73ea 100644\n--- a/.pre-commit-config.yaml\n+++ b/.pre-commit-config.yaml\n@@ -32,7 +32,7 @@ repos:\n #  """\n ##\n -   repo: https://github.com/PyCQA/flake8\n-    rev: 6.1.0\n+    rev: 7.0.0\n     hooks:\n     -   id: flake8\n \ndiff --git a/news/89.bugfix b/news/89.bugfix\nnew file mode 100644\nindex 0000000..12351b4\n--- /dev/null\n+++ b/news/89.bugfix\n@@ -0,0 +1,4 @@\n+Fix incompatibility with Pillow 10.1+.\n+Instead of setting ``image.mode``, we call ``image.convert``.\n+This works in Pillow 9 and 10.\n+[maurits]\ndiff --git a/plone/scale/scale.py b/plone/scale/scale.py\nindex 01ba778..c3f7624 100644\n--- a/plone/scale/scale.py\n+++ b/plone/scale/scale.py\n@@ -174,7 +174,7 @@ def scaleSingleFrame(\n         if extrema.get("A") == (255, 255):\n             # no alpha used, just change the mode, which causes the alpha band\n             # to be dropped on save\n-            image.mode = "RGB"\n+            image = image.convert("RGB")\n         else:\n             # switch to PNG, which supports alpha\n             format_ = "PNG"\n'

