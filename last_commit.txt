Repository: diazo


Branch: refs/heads/master
Date: 2024-01-29T22:20:39+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/diazo/commit/8c6fdf7706d7493397a41c089433babeb7cfe1cb

Configuring with plone/meta

Files changed:
A .editorconfig
A .flake8
A .github/workflows/meta.yml
A .meta.toml
A .pre-commit-config.yaml
A news/5d3e918e.internal
M .gitignore
M pyproject.toml
M tox.ini
D bootstrap.py

b'diff --git a/.editorconfig b/.editorconfig\nnew file mode 100644\nindex 0000000..fa698fb\n--- /dev/null\n+++ b/.editorconfig\n@@ -0,0 +1,54 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/main/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+#\n+# EditorConfig Configuration file, for more details see:\n+# http://EditorConfig.org\n+# EditorConfig is a convention description, that could be interpreted\n+# by multiple editors to enforce common coding conventions for specific\n+# file types\n+\n+# top-most EditorConfig file:\n+# Will ignore other EditorConfig files in Home directory or upper tree level.\n+root = true\n+\n+\n+[*]  # For All Files\n+# Unix-style newlines with a newline ending every file\n+end_of_line = lf\n+insert_final_newline = true\n+trim_trailing_whitespace = true\n+# Set default charset\n+charset = utf-8\n+# Indent style default\n+indent_style = space\n+# Max Line Length - a hard line wrap, should be disabled\n+max_line_length = off\n+\n+[*.{py,cfg,ini}]\n+# 4 space indentation\n+indent_size = 4\n+\n+[*.{yml,zpt,pt,dtml,zcml,html,xml}]\n+# 2 space indentation\n+indent_size = 2\n+\n+[*.{json,jsonl,js,jsx,ts,tsx,css,less,scss}]  # Frontend development\n+# 2 space indentation\n+indent_size = 2\n+max_line_length = 80\n+\n+[{Makefile,.gitmodules}]\n+# Tab indentation (no size specified, but view as 4 spaces)\n+indent_style = tab\n+indent_size = unset\n+tab_width = unset\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [editorconfig]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/.flake8 b/.flake8\nnew file mode 100644\nindex 0000000..38918f4\n--- /dev/null\n+++ b/.flake8\n@@ -0,0 +1,22 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/main/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+[flake8]\n+doctests = 1\n+ignore =\n+    # black takes care of line length\n+    E501,\n+    # black takes care of where to break lines\n+    W503,\n+    # black takes care of spaces within slicing (list[:])\n+    E203,\n+    # black takes care of spaces after commas\n+    E231,\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [flake8]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/.github/workflows/meta.yml b/.github/workflows/meta.yml\nnew file mode 100644\nindex 0000000..b8edec0\n--- /dev/null\n+++ b/.github/workflows/meta.yml\n@@ -0,0 +1,68 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/main/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+name: Meta\n+on:\n+  push:\n+    branches:\n+      - master\n+      - main\n+  pull_request:\n+    branches:\n+      - master\n+      - main\n+  workflow_dispatch:\n+\n+##\n+# To set environment variables for all jobs, add in .meta.toml:\n+# [github]\n+# env = """\n+#     debug: 1\n+#     image-name: \'org/image\'\n+#     image-tag: \'latest\'\n+# """\n+##\n+\n+jobs:\n+  qa:\n+    uses: plone/meta/.github/workflows/qa.yml@main\n+  test:\n+    uses: plone/meta/.github/workflows/test.yml@main\n+  coverage:\n+    uses: plone/meta/.github/workflows/coverage.yml@main\n+  dependencies:\n+    uses: plone/meta/.github/workflows/dependencies.yml@main\n+  release_ready:\n+    uses: plone/meta/.github/workflows/release_ready.yml@main\n+  circular:\n+    uses: plone/meta/.github/workflows/circular.yml@main\n+\n+##\n+# To modify the list of default jobs being created add in .meta.toml:\n+# [github]\n+# jobs = [\n+#    "qa",\n+#    "test",\n+#    "coverage",\n+#    "dependencies",\n+#    "release_ready",\n+#    "circular",\n+#    ]\n+##\n+\n+##\n+# To request that some OS level dependencies get installed\n+# when running tests/coverage jobs, add in .meta.toml:\n+# [github]\n+# os_dependencies = "git libxml2 libxslt"\n+##\n+\n+\n+##\n+# Specify additional jobs in .meta.toml:\n+#  [github]\n+#  extra_lines = """\n+#  another:\n+#    uses: org/repo/.github/workflows/file.yml@main\n+#  """\n+##\ndiff --git a/.gitignore b/.gitignore\nindex 282e164..486392f 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -1,20 +1,56 @@\n-bin\n-develop-eggs\n-docs/_build\n-parts/\n-build/\n-_build/\n-reports/\n-dist/\n+# Generated from:\n+# https://github.com/plone/meta/tree/main/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+# python related\n+*.egg-info\n *.pyc\n *.pyo\n-*.egg-info\n+\n+# translation related\n+*.mo\n+\n+# tools related\n+build/\n+.coverage\n+.*project\n+coverage.xml\n+dist/\n+docs/_build\n+__pycache__/\n+.tox\n+.vscode/\n+node_modules/\n+\n+# venv / buildout related\n+bin/\n+develop-eggs/\n+eggs/\n .eggs/\n+etc/\n .installed.cfg\n-.tox/\n-include\n-lib/python2.7\n-.python-version\n-.cache/\n-coverage*\n-.coverage*\n+include/\n+lib/\n+lib64\n+.mr.developer.cfg\n+parts/\n+pyvenv.cfg\n+var/\n+local.cfg\n+\n+# mxdev\n+/instance/\n+/.make-sentinels/\n+/*-mxdev.txt\n+/reports/\n+/sources/\n+/venv/\n+.installed.txt\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [gitignore]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/.meta.toml b/.meta.toml\nnew file mode 100644\nindex 0000000..103d7ca\n--- /dev/null\n+++ b/.meta.toml\n@@ -0,0 +1,6 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/main/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+[meta]\n+template = "default"\n+commit-id = "5d3e918e"\ndiff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nnew file mode 100644\nindex 0000000..caf34e5\n--- /dev/null\n+++ b/.pre-commit-config.yaml\n@@ -0,0 +1,94 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/main/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+ci:\n+    autofix_prs: false\n+    autoupdate_schedule: monthly\n+\n+repos:\n+-   repo: https://github.com/asottile/pyupgrade\n+    rev: v3.15.0\n+    hooks:\n+    -   id: pyupgrade\n+        args: [--py38-plus]\n+-   repo: https://github.com/pycqa/isort\n+    rev: 5.13.2\n+    hooks:\n+    -   id: isort\n+-   repo: https://github.com/psf/black\n+    rev: 23.12.1\n+    hooks:\n+    -   id: black\n+-   repo: https://github.com/collective/zpretty\n+    rev: 3.1.0\n+    hooks:\n+    -   id: zpretty\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  zpretty_extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n+-   repo: https://github.com/PyCQA/flake8\n+    rev: 6.1.0\n+    hooks:\n+    -   id: flake8\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  flake8_extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n+-   repo: https://github.com/codespell-project/codespell\n+    rev: v2.2.6\n+    hooks:\n+    -   id: codespell\n+        additional_dependencies:\n+          - tomli\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  codespell_extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n+-   repo: https://github.com/mgedmin/check-manifest\n+    rev: "0.49"\n+    hooks:\n+    -   id: check-manifest\n+-   repo: https://github.com/regebro/pyroma\n+    rev: "4.2"\n+    hooks:\n+    -   id: pyroma\n+-   repo: https://github.com/mgedmin/check-python-versions\n+    rev: "0.22.0"\n+    hooks:\n+    -   id: check-python-versions\n+        args: [\'--only\', \'setup.py,pyproject.toml\']\n+-   repo: https://github.com/collective/i18ndude\n+    rev: "6.1.0"\n+    hooks:\n+    -   id: i18ndude\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  i18ndude_extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/bootstrap.py b/bootstrap.py\ndeleted file mode 100755\nindex ed57894..0000000\n--- a/bootstrap.py\n+++ /dev/null\n@@ -1,178 +0,0 @@\n-##############################################################################\n-#\n-# Copyright (c) 2006 Zope Foundation and Contributors.\n-# All Rights Reserved.\n-#\n-# This software is subject to the provisions of the Zope Public License,\n-# Version 2.1 (ZPL).  A copy of the ZPL should accompany this distribution.\n-# THIS SOFTWARE IS PROVIDED "AS IS" AND ANY AND ALL EXPRESS OR IMPLIED\n-# WARRANTIES ARE DISCLAIMED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n-# WARRANTIES OF TITLE, MERCHANTABILITY, AGAINST INFRINGEMENT, AND FITNESS\n-# FOR A PARTICULAR PURPOSE.\n-#\n-##############################################################################\n-"""Bootstrap a buildout-based project\n-\n-Simply run this script in a directory containing a buildout.cfg.\n-The script accepts buildout command-line options, so you can\n-use the -c option to specify an alternate configuration file.\n-"""\n-\n-import os\n-import shutil\n-import sys\n-import tempfile\n-\n-from optparse import OptionParser\n-\n-tmpeggs = tempfile.mkdtemp()\n-\n-usage = \'\'\'\\\n-[DESIRED PYTHON FOR BUILDOUT] bootstrap.py [options]\n-\n-Bootstraps a buildout-based project.\n-\n-Simply run this script in a directory containing a buildout.cfg, using the\n-Python that you want bin/buildout to use.\n-\n-Note that by using --find-links to point to local resources, you can keep \n-this script from going over the network.\n-\'\'\'\n-\n-parser = OptionParser(usage=usage)\n-parser.add_option("-v", "--version", help="use a specific zc.buildout version")\n-\n-parser.add_option("-t", "--accept-buildout-test-releases",\n-                  dest=\'accept_buildout_test_releases\',\n-                  action="store_true", default=False,\n-                  help=("Normally, if you do not specify a --version, the "\n-                        "bootstrap script and buildout gets the newest "\n-                        "*final* versions of zc.buildout and its recipes and "\n-                        "extensions for you.  If you use this flag, "\n-                        "bootstrap and buildout will get the newest releases "\n-                        "even if they are alphas or betas."))\n-parser.add_option("-c", "--config-file",\n-                  help=("Specify the path to the buildout configuration "\n-                        "file to be used."))\n-parser.add_option("-f", "--find-links",\n-                  help=("Specify a URL to search for buildout releases"))\n-parser.add_option("--allow-site-packages",\n-                  action="store_true", default=False,\n-                  help=("Let bootstrap.py use existing site packages"))\n-\n-\n-options, args = parser.parse_args()\n-\n-######################################################################\n-# load/install setuptools\n-\n-try:\n-    if options.allow_site_packages:\n-        import setuptools\n-        import pkg_resources\n-    from urllib.request import urlopen\n-except ImportError:\n-    from urllib2 import urlopen\n-\n-ez = {}\n-exec(urlopen(\'https://bootstrap.pypa.io/ez_setup.py\').read(), ez)\n-\n-if not options.allow_site_packages:\n-    # ez_setup imports site, which adds site packages\n-    # this will remove them from the path to ensure that incompatible versions \n-    # of setuptools are not in the path\n-    import site\n-    # inside a virtualenv, there is no \'getsitepackages\'. \n-    # We can\'t remove these reliably\n-    if hasattr(site, \'getsitepackages\'):\n-        for sitepackage_path in site.getsitepackages():\n-            sys.path[:] = [x for x in sys.path if sitepackage_path not in x]\n-\n-setup_args = dict(to_dir=tmpeggs, download_delay=0)\n-ez[\'use_setuptools\'](**setup_args)\n-import setuptools\n-import pkg_resources\n-\n-# This does not (always?) update the default working set.  We will\n-# do it.\n-for path in sys.path:\n-    if path not in pkg_resources.working_set.entries:\n-        pkg_resources.working_set.add_entry(path)\n-\n-######################################################################\n-# Install buildout\n-\n-ws = pkg_resources.working_set\n-\n-cmd = [sys.executable, \'-c\',\n-       \'from setuptools.command.easy_install import main; main()\',\n-       \'-mZqNxd\', tmpeggs]\n-\n-find_links = os.environ.get(\n-    \'bootstrap-testing-find-links\',\n-    options.find_links or\n-    (\'http://downloads.buildout.org/\'\n-     if options.accept_buildout_test_releases else None)\n-    )\n-if find_links:\n-    cmd.extend([\'-f\', find_links])\n-\n-setuptools_path = ws.find(\n-    pkg_resources.Requirement.parse(\'setuptools\')).location\n-\n-requirement = \'zc.buildout\'\n-version = options.version\n-if version is None and not options.accept_buildout_test_releases:\n-    # Figure out the most recent final version of zc.buildout.\n-    import setuptools.package_index\n-    _final_parts = \'*final-\', \'*final\'\n-\n-    def _final_version(parsed_version):\n-        for part in parsed_version:\n-            if (part[:1] == \'*\') and (part not in _final_parts):\n-                return False\n-        return True\n-    index = setuptools.package_index.PackageIndex(\n-        search_path=[setuptools_path])\n-    if find_links:\n-        index.add_find_links((find_links,))\n-    req = pkg_resources.Requirement.parse(requirement)\n-    if index.obtain(req) is not None:\n-        best = []\n-        bestv = None\n-        for dist in index[req.project_name]:\n-            distv = dist.parsed_version\n-            if _final_version(distv):\n-                if bestv is None or distv > bestv:\n-                    best = [dist]\n-                    bestv = distv\n-                elif distv == bestv:\n-                    best.append(dist)\n-        if best:\n-            best.sort()\n-            version = best[-1].version\n-if version:\n-    requirement = \'==\'.join((requirement, version))\n-cmd.append(requirement)\n-\n-import subprocess\n-if subprocess.call(cmd, env=dict(os.environ, PYTHONPATH=setuptools_path)) != 0:\n-    raise Exception(\n-        "Failed to execute command:\\n%s" % repr(cmd)[1:-1])\n-\n-######################################################################\n-# Import and run buildout\n-\n-ws.add_entry(tmpeggs)\n-ws.require(requirement)\n-import zc.buildout.buildout\n-\n-if not [a for a in args if \'=\' not in a]:\n-    args.append(\'bootstrap\')\n-\n-# if -c was provided, we push it back into args for buildout\' main function\n-if options.config_file is not None:\n-    args[0:0] = [\'-c\', options.config_file]\n-\n-zc.buildout.buildout.main(args)\n-shutil.rmtree(tmpeggs)\ndiff --git a/news/5d3e918e.internal b/news/5d3e918e.internal\nnew file mode 100644\nindex 0000000..c08f539\n--- /dev/null\n+++ b/news/5d3e918e.internal\n@@ -0,0 +1,2 @@\n+Update configuration files.\n+[plone devs]\ndiff --git a/pyproject.toml b/pyproject.toml\nindex 05b615d..f39d091 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -1,6 +1,12 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/main/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+[build-system]\n+requires = ["setuptools>=68.2"]\n+\n [tool.towncrier]\n-filename = "CHANGES.rst"\n directory = "news/"\n+filename = "CHANGES.rst"\n title_format = "{version} ({project_date})"\n underlines = ["-", ""]\n \n@@ -18,3 +24,136 @@ showcontent = true\n directory = "bugfix"\n name = "Bug fixes:"\n showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "internal"\n+name = "Internal:"\n+showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "documentation"\n+name = "Documentation:"\n+showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "tests"\n+name = "Tests"\n+showcontent = true\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  towncrier_extra_lines = """\n+#  extra_configuration\n+#  """\n+##\n+\n+[tool.isort]\n+profile = "plone"\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  isort_extra_lines = """\n+#  extra_configuration\n+#  """\n+##\n+\n+[tool.black]\n+target-version = ["py38"]\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  black_extra_lines = """\n+#  extra_configuration\n+#  """\n+##\n+\n+[tool.codespell]\n+ignore-words-list = "discreet,"\n+skip = "*.po,"\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  codespell_ignores = "foo,bar"\n+#  codespell_skip = "*.po,*.map,package-lock.json"\n+##\n+\n+[tool.dependencychecker]\n+Zope = [\n+  # Zope own provided namespaces\n+  \'App\', \'OFS\', \'Products.Five\', \'Products.OFSP\', \'Products.PageTemplates\',\n+  \'Products.SiteAccess\', \'Shared\', \'Testing\', \'ZPublisher\', \'ZTUtils\',\n+  \'Zope2\', \'webdav\', \'zmi\',\n+  # ExtensionClass own provided namespaces\n+  \'ExtensionClass\', \'ComputedAttribute\', \'MethodObject\',\n+  # Zope dependencies\n+  \'AccessControl\', \'Acquisition\', \'AuthEncoding\', \'beautifulsoup4\', \'BTrees\',\n+  \'cffi\', \'Chameleon\', \'DateTime\', \'DocumentTemplate\',\n+  \'MultiMapping\', \'multipart\', \'PasteDeploy\', \'Persistence\', \'persistent\',\n+  \'pycparser\', \'python-gettext\', \'pytz\', \'RestrictedPython\', \'roman\',\n+  \'soupsieve\', \'transaction\', \'waitress\', \'WebOb\', \'WebTest\', \'WSGIProxy2\',\n+  \'z3c.pt\', \'zc.lockfile\', \'ZConfig\', \'zExceptions\', \'ZODB\', \'zodbpickle\',\n+  \'zope.annotation\', \'zope.browser\', \'zope.browsermenu\', \'zope.browserpage\',\n+  \'zope.browserresource\', \'zope.cachedescriptors\', \'zope.component\',\n+  \'zope.configuration\', \'zope.container\', \'zope.contentprovider\',\n+  \'zope.contenttype\', \'zope.datetime\', \'zope.deferredimport\',\n+  \'zope.deprecation\', \'zope.dottedname\', \'zope.event\', \'zope.exceptions\',\n+  \'zope.filerepresentation\', \'zope.globalrequest\', \'zope.hookable\',\n+  \'zope.i18n\', \'zope.i18nmessageid\', \'zope.interface\', \'zope.lifecycleevent\',\n+  \'zope.location\', \'zope.pagetemplate\', \'zope.processlifetime\', \'zope.proxy\',\n+  \'zope.ptresource\', \'zope.publisher\', \'zope.schema\', \'zope.security\',\n+  \'zope.sequencesort\', \'zope.site\', \'zope.size\', \'zope.structuredtext\',\n+  \'zope.tal\', \'zope.tales\', \'zope.testbrowser\', \'zope.testing\',\n+  \'zope.traversing\', \'zope.viewlet\'\n+]\n+\'Products.CMFCore\' = [\n+  \'docutils\', \'five.localsitemanager\', \'Missing\', \'Products.BTreeFolder2\',\n+  \'Products.GenericSetup\', \'Products.MailHost\', \'Products.PythonScripts\',\n+  \'Products.StandardCacheManagers\', \'Products.ZCatalog\', \'Record\',\n+  \'zope.sendmail\', \'Zope\'\n+]\n+\'plone.base\' = [\n+  \'plone.batching\', \'plone.registry\', \'plone.schema\',\'plone.z3cform\',\n+  \'Products.CMFCore\', \'Products.CMFDynamicViewFTI\',\n+]\n+python-dateutil = [\'dateutil\']\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  dependencies_ignores = "[\'zestreleaser.towncrier\']"\n+#  dependencies_mappings = [\n+#    "gitpython = [\'git\']",\n+#    "pygithub = [\'github\']",\n+#  ]\n+##\n+\n+[tool.check-manifest]\n+ignore = [\n+    ".editorconfig",\n+    ".meta.toml",\n+    ".pre-commit-config.yaml",\n+    "tox.ini",\n+    ".flake8",\n+    "mx.ini",\n+\n+]\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  check_manifest_ignores = """\n+#      "*.map.js",\n+#      "*.pyc",\n+#  """\n+##\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/tox.ini b/tox.ini\nindex 642f24c..64435e8 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -1,144 +1,216 @@\n-# Tox (http://tox.testrun.org/) is a tool for running tests in multiple virtualenvs.\n-# This configuration file will run the test suite on all supported python versions.\n-# To use it, "pip install -c constrains.txt tox" and then run "tox" from this directory.\n-\n+# Generated from:\n+# https://github.com/plone/meta/tree/main/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n [tox]\n+# We need 4.4.0 for constrain_package_deps.\n+min_version = 4.4.0\n envlist =\n-    py2.7,\n-    py3.5,\n-    py3.6,\n-    py3.7,\n-    py3.8,\n-    py3.9,\n-    py3.10,\n-    docs,\n-    isort,\n-    lint,\n-    coverage-report\n-\n-[testenv]\n-usedevelop = True\n-extras =\n+    lint\n     test\n+    dependencies\n \n-commands =\n-    python -VV\n-    pip list\n-    mkdir -p {toxinidir}/reports/coverage {toxinidir}/reports/pytest\n-    pytest --cov=lib --cov-report=xml --html={toxinidir}/reports/pytest/report-{envname}.html --self-contained-html lib/diazo/tests {posargs}\n \n-setenv =\n-    COVERAGE_FILE=.coverage.{envname}\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [tox]\n+#  envlist_lines = """\n+#      my_other_environment\n+#  """\n+#  config_lines = """\n+#  my_extra_top_level_tox_configuration_lines\n+#  """\n+##\n \n-deps =\n-    -cconstraints.txt\n-    pdbpp\n-    pytest\n-    pytest-cov\n-    pytest-remove-stale-bytecode\n-    pytest-mock\n-    pytest-html\n-\n-whitelist_externals =\n-    mkdir\n-\n-[testenv:coverage-report]\n+[testenv]\n+skip_install = true\n+allowlist_externals =\n+    echo\n+    false\n+# Make sure typos like `tox -e formaat` are caught instead of silently doing nothing.\n+# See https://github.com/tox-dev/tox/issues/2858.\n+commands =\n+    echo "Unrecognized environment name {envname}"\n+    false\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [tox]\n+#  testenv_options = """\n+#  basepython = /usr/bin/python3.8\n+#  """\n+##\n+\n+[testenv:init]\n+description = Prepare environment\n skip_install = true\n+commands =\n+    echo "Initial setup complete"\n \n-depends =\n-    py2.7,\n-    py3.5,\n-    py3.6,\n-    py3.7,\n-    py3.8,\n-    py3.9,\n-    py3.10,\n \n+[testenv:format]\n+description = automatically reformat code\n+skip_install = true\n deps =\n-    -cconstraints.txt\n-    coverage\n-\n-setenv =\n-    COVERAGE_FILE=.coverage\n-\n+    pre-commit\n commands =\n-    coverage erase\n-    coverage combine\n-    coverage report\n-    coverage html\n-    coverage xml\n+    pre-commit run -a pyupgrade\n+    pre-commit run -a isort\n+    pre-commit run -a black\n+    pre-commit run -a zpretty\n \n-[testenv:isort-apply]\n+[testenv:lint]\n+description = run linters that will help improve the code style\n skip_install = true\n-deps = isort\n+deps =\n+    pre-commit\n commands =\n-    isort {toxinidir}/lib setup.py\n+    pre-commit run -a\n \n-[testenv:isort]\n+[testenv:dependencies]\n+description = check if the package defines all its dependencies\n skip_install = true\n-deps = isort\n+deps =\n+    build\n+    z3c.dependencychecker==2.14.3\n commands =\n-    isort --show-config\n-    isort --check-only --diff {toxinidir}/lib setup.py\n-\n-[lint]\n-skip_install = true\n-\n+    python -m build --sdist\n+    dependencychecker\n+\n+[testenv:dependencies-graph]\n+description = generate a graph out of the dependencies of the package\n+skip_install = false\n+allowlist_externals =\n+    sh\n deps =\n-    -cconstraints.txt\n-    flake8\n-    # helper to generate HTML reports:\n-    flake8-html\n-    # Useful flake8 plugins that are Python and Plone specific:\n-    flake8-blind-except\n-    flake8-coding\n-    flake8-commas\n-    flake8-debugger\n-    flake8-deprecated\n-    flake8-isort\n-    flake8-pep3101\n-    flake8-plone-hasattr\n-    flake8-print\n-    flake8-quotes\n-    flake8-string-format\n-    flake8-todo\n-    flake8_strict\n-\n+    pipdeptree==2.5.1\n+    graphviz  # optional dependency of pipdeptree\n commands =\n-    python -VV\n-    pip list\n-    mkdir -p {toxinidir}/_build/reports/flake8\n-    #- flake8 --format=html --htmldir={toxinidir}/_build/reports/flake8 --doctests src tests setup.py\n-    #flake8 src tests setup.py --doctests\n-    - flake8 --format=html --htmldir={toxinidir}/_build/reports/flake8 --doctests lib setup.py\n-    flake8 lib setup.py --doctests\n-\n-whitelist_externals =\n-    mkdir\n-\n-[testenv:docs]\n+    sh -c \'pipdeptree --exclude setuptools,wheel,pipdeptree,zope.interface,zope.component --graph-output svg > dependencies.svg\'\n+\n+[testenv:test]\n+description = run the distribution tests\n+use_develop = true\n+skip_install = false\n+constrain_package_deps = true\n+set_env =\n+    ROBOT_BROWSER=headlesschrome\n+\n+##\n+# Specify extra test environment variables in .meta.toml:\n+#  [tox]\n+#  test_environment_variables = """\n+#      PIP_EXTRA_INDEX_URL=https://my-pypi.my-server.com/\n+#  """\n+#\n+# Set constrain_package_deps .meta.toml:\n+#  [tox]\n+#  constrain_package_deps = "false"\n+##\n+deps =\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+    \n+##\n+# Specify additional deps in .meta.toml:\n+#  [tox]\n+#  test_deps_additional = "-esources/plonegovbr.portal_base[test]"\n+#\n+# Specify a custom constraints file in .meta.toml:\n+#  [tox]\n+#  constraints_file = "https://my-server.com/constraints.txt"\n+##\n commands =\n-    python -VV\n-    pip list\n-    mkdir -p {toxinidir}/_build/\n-    sphinx-build -b html -d {toxinidir}/_build/docs/doctrees docs {toxinidir}/_build/docs/html\n-    # The following line should be enabled if we do have testable code in the docs.\n-    #sphinx-build -b doctest docs build/docs/doctrees\n+    zope-testrunner --all --test-path={toxinidir} -s diazo {posargs}\n+extras =\n+    test\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [tox]\n+#  test_extras = """\n+#      tests\n+#      widgets\n+#  """\n+##\n+\n+[testenv:coverage]\n+description = get a test coverage report\n+use_develop = true\n+skip_install = false\n+constrain_package_deps = true\n+set_env =\n+    ROBOT_BROWSER=headlesschrome\n+\n+##\n+# Specify extra test environment variables in .meta.toml:\n+#  [tox]\n+#  test_environment_variables = """\n+#      PIP_EXTRA_INDEX_URL=https://my-pypi.my-server.com/\n+#  """\n+##\n deps =\n-    -cconstraints.txt\n-    Sphinx\n+    coverage\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+    \n+commands =\n+    coverage run --branch --source diazo {envbindir}/zope-testrunner --quiet --all --test-path={toxinidir} -s diazo {posargs}\n+    coverage report -m --format markdown\n+    coverage xml\n+extras =\n+    test\n \n-whitelist_externals =\n-    mkdir\n \n-[testenv:release]\n+[testenv:release-check]\n+description = ensure that the distribution is ready to release\n skip_install = true\n-\n deps =\n-    -cconstraints.txt\n-    zest.releaser[recommended]\n-\n+    twine\n+    build\n+    towncrier\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+    \n+commands =\n+    # fake version to not have to install the package\n+    # we build the change log as news entries might break\n+    # the README that is displayed on PyPI\n+    towncrier build --version=100.0.0 --yes\n+    python -m build --sdist\n+    twine check dist/*\n+\n+[testenv:circular]\n+description = ensure there are no cyclic dependencies\n+use_develop = true\n+skip_install = false\n+set_env =\n+\n+##\n+# Specify extra test environment variables in .meta.toml:\n+#  [tox]\n+#  test_environment_variables = """\n+#      PIP_EXTRA_INDEX_URL=https://my-pypi.my-server.com/\n+#  """\n+##\n+allowlist_externals =\n+    sh\n+deps =\n+    pipdeptree\n+    pipforester\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+    \n commands =\n-    python -VV\n-    pip list\n-    fullrelease --no-input -v\n+    # Generate the full dependency tree\n+    sh -c \'pipdeptree -j > forest.json\'\n+    # Generate a DOT graph with the circular dependencies, if any\n+    pipforester -i forest.json -o forest.dot --cycles\n+    # Report if there are any circular dependencies, i.e. error if there are any\n+    pipforester -i forest.json --check-cycles -o /dev/null\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [tox]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n'

Repository: diazo


Branch: refs/heads/master
Date: 2024-01-29T22:44:35+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/diazo/commit/904bf884e74ff0f2adbaabc21139309834bbbcec

Drop support for Pythons that are end of life. Require Python 3.8 or higher.

Remove all buildout configs.  They all seem really old and unmaintained, though there could still be value in them.

Files changed:
A news/23.breaking
M MANIFEST.in
M setup.cfg
M setup.py
D .github/workflows/test.yml
D buildout.cfg
D checkdocs.cfg
D constraints.txt
D lxml.cfg
D nginx.cfg
D templates/nginx.conf.in
D templates/varnish.vcl.in
D varnish.cfg
D versions.cfg

b'diff --git a/.github/workflows/test.yml b/.github/workflows/test.yml\ndeleted file mode 100644\nindex 7d8005d..0000000\n--- a/.github/workflows/test.yml\n+++ /dev/null\n@@ -1,46 +0,0 @@\n-name: Test\n-\n-on:\n-  push:\n-    branches-ignore:\n-      - "master"\n-\n-jobs:\n-  build:\n-    runs-on: ubuntu-latest\n-    strategy:\n-      fail-fast: false\n-      matrix:\n-        python-version:\n-          - "2.7"\n-          - "3.5"\n-          - "3.6"\n-          - "3.7"\n-          - "3.8"\n-          - "3.9"\n-          - "3.10"\n-\n-    steps:\n-      - uses: actions/checkout@v2\n-\n-      - name: Setup Python ${{ matrix.python-version }}\n-        id: setup\n-        uses: actions/setup-python@v2\n-        with:\n-          python-version: ${{ matrix.python-version }}\n-\n-      - name: Install package\n-        run: |\n-          pip install -c constraints.txt tox coverage\n-\n-      - name: Run tests\n-        env:\n-          TOXENV: py${{ matrix.python-version }}\n-        run: |\n-          tox\n-\n-      - name: Run coverage\n-        env:\n-          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n-        run: |\n-          coverage combine\ndiff --git a/MANIFEST.in b/MANIFEST.in\nindex 86944be..980ed1b 100644\n--- a/MANIFEST.in\n+++ b/MANIFEST.in\n@@ -23,6 +23,7 @@ graft templates\n \n # Blacklist / Exclude Files and Path\n prune docs/_build\n+prune .tox\n global-exclude *pyc\n global-exclude *pyo\n global-exclude *pydinclude pyproject.toml\ndiff --git a/buildout.cfg b/buildout.cfg\ndeleted file mode 100644\nindex 3812ad2..0000000\n--- a/buildout.cfg\n+++ /dev/null\n@@ -1,28 +0,0 @@\n-[buildout]\n-extends = versions.cfg\n-parts =\n-    diazo\n-    test\n-    wsgi\n-    sphinx\n-develop = .\n-\n-[diazo]\n-recipe = zc.recipe.egg\n-eggs = diazo\n-interpreter = py\n-\n-[test]\n-recipe = zc.recipe.testrunner\n-eggs = diazo [test]\n-defaults = [\'--auto-color\']\n-\n-[wsgi]\n-recipe = zc.recipe.egg\n-eggs =\n-    diazo [wsgi]\n-    gearbox\n-scripts = gearbox\n-\n-[sphinx]\n-recipe = zc.recipe.egg\ndiff --git a/checkdocs.cfg b/checkdocs.cfg\ndeleted file mode 100644\nindex 18afe5a..0000000\n--- a/checkdocs.cfg\n+++ /dev/null\n@@ -1,6 +0,0 @@\n-[buildout]\n-extends = buildout.cfg\n-\n-[diazo]\n-eggs +=\n-    collective.checkdocs\ndiff --git a/constraints.txt b/constraints.txt\ndeleted file mode 100644\nindex c6ad05a..0000000\n--- a/constraints.txt\n+++ /dev/null\n@@ -1,3 +0,0 @@\n-# Constrains for testing Diazo / Plone Packages\n-# ---------------------------------------------\n-\ndiff --git a/lxml.cfg b/lxml.cfg\ndeleted file mode 100644\nindex ebe1c1b..0000000\n--- a/lxml.cfg\n+++ /dev/null\n@@ -1,14 +0,0 @@\n-[buildout]\n-extends = buildout.cfg\n-\n-# lxml must be first in parts.\n-parts =\n-    lxml\n-    diazo\n-    test\n-\n-[lxml]\n-recipe = z3c.recipe.staticlxml\n-egg = lxml\n-libxml2-url = http://xmlsoft.org/sources/libxml2-2.7.7.tar.gz\n-libxslt-url = http://xmlsoft.org/sources/libxslt-1.1.26.tar.gz\ndiff --git a/news/23.breaking b/news/23.breaking\nnew file mode 100644\nindex 0000000..f7b5432\n--- /dev/null\n+++ b/news/23.breaking\n@@ -0,0 +1,3 @@\n+Drop support for Pythons that are end of life.\n+Support Python 3.8-3.12.\n+[maurits]\ndiff --git a/nginx.cfg b/nginx.cfg\ndeleted file mode 100644\nindex aa1e9ac..0000000\n--- a/nginx.cfg\n+++ /dev/null\n@@ -1,67 +0,0 @@\n-[buildout]\n-extends = lxml.cfg\n-parts +=\n-    nginx\n-    nginx.conf\n-    example-theme\n-    ploneorg-theme\n-    rebuild-themes\n-\n-[nginx]\n-recipe = zc.recipe.cmmi\n-url = http://html-xslt.googlecode.com/files/nginx-0.7.67-html-xslt-4.tar.gz\n-# The SSI bug was fixed in nginx-0.7.65-html-xslt-2.tar.gz\n-extra_options =\n-    --conf-path=${buildout:directory}/etc/nginx.conf\n-    --sbin-path=${buildout:directory}/bin\n-    --error-log-path=${buildout:directory}/var/log/nginx-error.log\n-    --http-log-path=${buildout:directory}/var/log/nginx-access.log\n-    --pid-path=${buildout:directory}/var/nginx.pid\n-    --lock-path=${buildout:directory}/var/nginx.lock\n-    --with-http_stub_status_module\n-    --with-http_xslt_module\n-    --with-libxml2=${buildout:directory}/parts/lxml/libxml2\n-    --with-libxslt=${buildout:directory}/parts/lxml/libxslt\n-#    --with-debug --with-cc-opt="-O0" # helps debugging with gdb\n-\n-[nginx.conf]\n-recipe = collective.recipe.template\n-port = 8000\n-root = ${buildout:directory}/examples\n-filter.xsl = ${buildout:directory}/lib/diazo/filter.xsl\n-example.xsl = ${buildout:directory}/etc/example.xsl\n-ploneorg.xsl = ${buildout:directory}/etc/ploneorg.xsl\n-input = ${buildout:directory}/templates/nginx.conf.in\n-output = ${buildout:directory}/etc/nginx.conf\n-\n-[example-theme]\n-recipe = plone.recipe.command\n-includemode = ssi\n-command =\n-    ${buildout:directory}/bin/diazocompiler \\\n-        --includemode=${:includemode}  --output=${nginx.conf:example.xsl} \\\n-        ${nginx.conf:root}/rules.xml ${nginx.conf:root}/theme.html\n-update-command = ${:command}\n-\n-[ploneorg-theme]\n-recipe = plone.recipe.command\n-includemode = ssi\n-command =\n-    ${buildout:directory}/bin/diazocompiler \\\n-        --includemode=${:includemode}  --output=${nginx.conf:ploneorg.xsl} \\\n-        --extra=${nginx.conf:root}/ploneorg/default-extra.xsl \\\n-        ${nginx.conf:root}/ploneorg/default.xml ${nginx.conf:root}/ploneorg/plone.html\n-update-command = ${:command}\n-\n-[rebuild-themes]\n-recipe = collective.recipe.template\n-library-path = ${buildout:directory}/parts/lxml/libxml2/lib:${buildout:directory}/parts/lxml/libxslt/lib\n-inline =\n-    #!/bin/sh\n-    export LD_LIBRARY_PATH=${:library-path}\n-    export DYLD_LIBRARY_PATH=${:library-path}\n-    ${example-theme:command} && echo example theme rebuilt\n-    ${ploneorg-theme:command} && echo ploneorg theme rebuilt\n-    ${buildout:directory}/bin/nginx -s reload && echo nginx reloaded.\n-output = ${buildout:directory}/bin/rebuild-themes\n-mode = 755\ndiff --git a/setup.cfg b/setup.cfg\nindex fc83f1e..b2ce010 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -1,22 +1,3 @@\n-[check-manifest]\n-ignore =\n-    *.cfg\n-    bootstrap.py\n-    tox.ini\n-\n-[isort]\n-# for details see\n-# http://docs.plone.org/develop/styleguide/python.html#grouping-and-sorting\n-force_alphabetical_sort = True\n-force_single_line = True\n-lines_after_imports = 2\n-line_length = 200\n-\n-[flake8]\n-exclude =\n-\n-ignore =\n-\n [tool:pytest]\n addopts = -ra\n \n@@ -28,14 +9,9 @@ norecursedirs = fixures\n [coverage:run]\n branch = True\n source = lib\n-omit =\n-    bootstrap.py\n \n [coverage:report]\n precision = 2\n \n [coverage:html]\n directory = reports/coverage\n-\n-[bdist_wheel]\n-universal = 1\ndiff --git a/setup.py b/setup.py\nindex 28c732a..ff87f61 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -1,71 +1,66 @@\n-# -*- coding: utf-8 -*-\n-\n from setuptools import find_packages\n from setuptools import setup\n \n \n extras_require = {\n-    \'wsgi\': [\n-        \'repoze.xmliter\',\n-        \'WebOb\',\n+    "wsgi": [\n+        "repoze.xmliter",\n+        "WebOb",\n     ],\n-    \'test\': [\n-        \'repoze.xmliter\',\n-        \'WebOb\',\n-        \'py\',\n+    "test": [\n+        "repoze.xmliter",\n+        "WebOb",\n+        "py",\n     ],\n }\n \n \n-readme = open(\'README.rst\').read()\n-changes = open(\'CHANGES.rst\').read()\n-long_desc = readme + \'\\n\\n\' + changes\n+readme = open("README.rst").read()\n+changes = open("CHANGES.rst").read()\n+long_desc = readme + "\\n\\n" + changes\n \n setup(\n-    name=\'diazo\',\n-    version=\'1.5.1.dev0\',\n+    name="diazo",\n+    version="1.5.1.dev0",\n     description="""Diazo implements a Deliverance like language using a pure\n         XSLT engine. With Diazo, you "compile" your theme and ruleset in one\n         step, then use a superfast/simple transform on each request thereafter.\n         Alternatively, compile your theme during development, check it into\n         version control, and not touch Diazo during deployment.""",\n-    keywords=\'web theming\',\n+    keywords="web theming",\n     long_description=long_desc,\n-    packages=find_packages(\'lib\'),\n-    package_dir={\'\': \'lib\'},\n+    packages=find_packages("lib"),\n+    package_dir={"": "lib"},\n     include_package_data=True,\n     zip_safe=False,\n-    author=\'Paul Everitt, Laurence Rowe and Martin Aspeli.\',\n-    author_email=\'laurence@lrowe.co.uk\',\n-    url=\'http://diazo.org\',\n-    license=\'New BSD\',\n+    author="Paul Everitt, Laurence Rowe and Martin Aspeli.",\n+    author_email="laurence@lrowe.co.uk",\n+    url="http://diazo.org",\n+    license="New BSD",\n     classifiers=[\n-        \'Development Status :: 6 - Mature\',\n-        \'License :: OSI Approved :: BSD License\',\n-        \'Programming Language :: Python\',\n-        \'Programming Language :: Python :: 2\',\n-        \'Programming Language :: Python :: 2.7\',\n-        \'Programming Language :: Python :: 3\',\n-        \'Programming Language :: Python :: 3.5\',\n-        \'Programming Language :: Python :: 3.6\',\n-        \'Programming Language :: Python :: 3.7\',\n-        \'Programming Language :: Python :: 3.8\',\n-        \'Programming Language :: Python :: 3.9\',\n-        \'Programming Language :: Python :: 3.10\',\n-        \'Topic :: Internet :: WWW/HTTP\',\n-        \'Topic :: Internet :: WWW/HTTP :: WSGI\',\n-        \'Topic :: Internet :: WWW/HTTP :: WSGI :: Middleware\',\n-        \'Topic :: Text Processing :: Markup :: XML\',\n+        "Development Status :: 6 - Mature",\n+        "License :: OSI Approved :: BSD License",\n+        "Programming Language :: Python",\n+        "Programming Language :: Python :: 3.8",\n+        "Programming Language :: Python :: 3.9",\n+        "Programming Language :: Python :: 3.10",\n+        "Programming Language :: Python :: 3.11",\n+        "Programming Language :: Python :: 3.12",\n+        "Topic :: Internet :: WWW/HTTP",\n+        "Topic :: Internet :: WWW/HTTP :: WSGI",\n+        "Topic :: Internet :: WWW/HTTP :: WSGI :: Middleware",\n+        "Topic :: Text Processing :: Markup :: XML",\n     ],\n+    python_requires=">=3.8",\n     install_requires=[\n-    #    \'setuptools\',\n-        \'lxml\',\n-        \'cssselect\',\n-        \'six\',\n+        #    \'setuptools\',\n+        "lxml",\n+        "cssselect",\n+        "six",\n     ],\n     extras_require=extras_require,\n-    test_suite=\'diazo.tests.alltests\',\n-    tests_require=extras_require[\'test\'],\n+    test_suite="diazo.tests.alltests",\n+    tests_require=extras_require["test"],\n     entry_points="""\n         [console_scripts]\n         diazocompiler = diazo.compiler:main\ndiff --git a/templates/nginx.conf.in b/templates/nginx.conf.in\ndeleted file mode 100644\nindex d0aab53..0000000\n--- a/templates/nginx.conf.in\n+++ /dev/null\n@@ -1,78 +0,0 @@\n-worker_processes 1;\n-error_log ${buildout:directory}/var/log/nginx-error.log debug;\n-\n-events {\n-#    worker_connections  1024;\n-}\n-\n-http {\n-    include ${buildout:directory}/etc/mime.types;\n-#    gzip on;\n-    server {\n-        listen ${port};\n-        server_name localhost;\n-        root ${root};\n-        autoindex on;\n-\n-        # Decide if we need to filter\n-        if ($args ~ "^(.*);filter_xpath=(.*)$") {\n-            set $newargs $1;\n-            set $filter_xpath $2;\n-            # rewrite args to avoid looping\n-            rewrite    ^(.*)$    /_include$1?$newargs?;\n-        }\n-\n-        location @include500 { return 500; }\n-        location @include404 { return 404; }\n-\n-        location ^~ /_include {\n-            # Restrict to subrequests\n-            internal;\n-            error_page 404 = @include404;\n-\n-            # Cache in Varnish for 1h\n-            expires 1h;\n-\n-            # Proxy\n-            rewrite    ^/_include(.*)$    $1    break;\n-            proxy_pass http://127.0.0.1:${port};\n-\n-            # Our safety belt.\n-            proxy_set_header X-Loop 1$http_X_Loop; # unary count\n-            proxy_set_header Accept-Encoding "";\n-            error_page 500 = @include500;\n-            if ($http_X_Loop ~ "11111") {\n-                return 500;\n-            }\n-\n-            # Filter by xpath\n-            xslt_stylesheet ${filter.xsl}\n-                xpath=$filter_xpath\n-                ;\n-            xslt_html_parser on;\n-            xslt_types text/html;\n-        }\n-\n-        # Our styled location.\n-        location /styled {\n-            alias ${root};\n-            xslt_stylesheet ${example.xsl}\n-                path=\'$uri\'\n-                ;\n-            xslt_html_parser on;\n-            xslt_types text/html;\n-            # Switch on ssi here to enable external includes.\n-            ssi on;\n-        }\n-\n-        # Another styled location.\n-        location /styled/ploneorg {\n-            alias ${root}/ploneorg;\n-            xslt_stylesheet ${ploneorg.xsl}\n-                path=\'$uri\'\n-                ;\n-            xslt_html_parser on;\n-            xslt_types text/html;\n-        }\n-    }\n-}\ndiff --git a/templates/varnish.vcl.in b/templates/varnish.vcl.in\ndeleted file mode 100644\nindex 8378dae..0000000\n--- a/templates/varnish.vcl.in\n+++ /dev/null\n@@ -1,14 +0,0 @@\n-backend default {\n-    .host = "127.0.0.1";\n-    .port = "${nginx.conf:port}";\n-}\n-\n-sub vcl_recv {\n-    set req.backend = default;\n-}\n-\n-sub vcl_fetch {\n-    if (obj.http.Content-Type == "text/html; charset=utf-8") {\n-        esi;\n-    }\n-}\ndiff --git a/varnish.cfg b/varnish.cfg\ndeleted file mode 100644\nindex 8a9ae98..0000000\n--- a/varnish.cfg\n+++ /dev/null\n@@ -1,25 +0,0 @@\n-[buildout]\n-extends = nginx.cfg\n-parts +=\n-    varnish-build\n-    varnish\n-    varnish.vcl\n-\n-[example-theme]\n-includemode = esi\n-\n-[varnish-build]\n-recipe= zc.recipe.cmmi\n-url = ${varnish:download-url}\n-\n-[varnish]\n-recipe = plone.recipe.varnish\n-daemon = ${buildout:parts-directory}/varnish-build/sbin/varnishd\n-bind = 127.0.0.1:8001\n-config = ${buildout:directory}/etc/varnish.vcl\n-cache-size = 10M\n-\n-[varnish.vcl]\n-recipe = collective.recipe.template\n-input = ${buildout:directory}/templates/varnish.vcl.in\n-output = ${buildout:directory}/etc/varnish.vcl\n\\ No newline at end of file\ndiff --git a/versions.cfg b/versions.cfg\ndeleted file mode 100644\nindex 0c6d2e4..0000000\n--- a/versions.cfg\n+++ /dev/null\n@@ -1,10 +0,0 @@\n-[buildout]\n-versions = versions\n-\n-[versions]\n-WebOb = 1.4\n-cssselect = 0.9.1\n-lxml = 3.3.5\n-repoze.xmliter = 0.6\n-FormEncode = 1.3.0a1\n-py = 1.11.0\n'

Repository: diazo


Branch: refs/heads/master
Date: 2024-01-29T22:56:14+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/diazo/commit/f837571090375586d7519f4c8f1c2d993dc81df8

Rename lib directory to src.

lib is in the updated .gitignore file, and in Plone we expect the code to be in src, not in lib.
No other changes in this commit.

Files changed:
A src/diazo/__init__.py
A src/diazo/annotate-rules.xsl
A src/diazo/annotate-themes.xsl
A src/diazo/apply-conditions.xsl
A src/diazo/apply-rules.xsl
A src/diazo/compiler.py
A src/diazo/cssrules.py
A src/diazo/debug_resources/diazo-debug.css
A src/diazo/debug_resources/diazo-debug.js
A src/diazo/debug_resources/iframe.js
A src/diazo/debug_resources/jquery-1.8.3.min.js
A src/diazo/defaults.xsl
A src/diazo/diazo-debug.zcml
A src/diazo/dummy.html
A src/diazo/emit-stylesheet.xsl
A src/diazo/filter.xsl
A src/diazo/filter_html.xsl
A src/diazo/filter_xhtml.xsl
A src/diazo/fixup-themes.xsl
A src/diazo/identity.xsl
A src/diazo/include.xsl
A src/diazo/merge-conditions.xsl
A src/diazo/normalize-rules.xsl
A src/diazo/rules.py
A src/diazo/run.py
A src/diazo/runtrace.py
A src/diazo/runtrace_to_html.xsl
A src/diazo/tests/__init__.py
A src/diazo/tests/absolute-prefix-disabled/content.html
A src/diazo/tests/absolute-prefix-disabled/options.cfg
A src/diazo/tests/absolute-prefix-disabled/output.html
A src/diazo/tests/absolute-prefix-disabled/rules.xml
A src/diazo/tests/absolute-prefix-disabled/theme.html
A src/diazo/tests/absolute-prefix-ie-conditional-comments/content.html
A src/diazo/tests/absolute-prefix-ie-conditional-comments/options.cfg
A src/diazo/tests/absolute-prefix-ie-conditional-comments/output.html
A src/diazo/tests/absolute-prefix-ie-conditional-comments/rules.xml
A src/diazo/tests/absolute-prefix-ie-conditional-comments/theme.html
A src/diazo/tests/absolute-prefix/content.html
A src/diazo/tests/absolute-prefix/options.cfg
A src/diazo/tests/absolute-prefix/output.html
A src/diazo/tests/absolute-prefix/rules.xml
A src/diazo/tests/absolute-prefix/theme.html
A src/diazo/tests/allow-curly-brackets/README.rst
A src/diazo/tests/allow-curly-brackets/content.html
A src/diazo/tests/allow-curly-brackets/output.html
A src/diazo/tests/allow-curly-brackets/rules.xml
A src/diazo/tests/allow-curly-brackets/theme.html
A src/diazo/tests/append/content.html
A src/diazo/tests/append/output.html
A src/diazo/tests/append/rules.xml
A src/diazo/tests/append/theme.html
A src/diazo/tests/append/xpaths.txt
A src/diazo/tests/before-content-conditional/content.html
A src/diazo/tests/before-content-conditional/output.html
A src/diazo/tests/before-content-conditional/rules.xml
A src/diazo/tests/before-content-conditional/theme.html
A src/diazo/tests/before-prepend-append-after/content.html
A src/diazo/tests/before-prepend-append-after/output.html
A src/diazo/tests/before-prepend-append-after/rules.xml
A src/diazo/tests/before-prepend-append-after/theme.html
A src/diazo/tests/comments-outside-root-tag/content.html
A src/diazo/tests/comments-outside-root-tag/output.html
A src/diazo/tests/comments-outside-root-tag/rules.xml
A src/diazo/tests/comments-outside-root-tag/theme.html
A src/diazo/tests/comments/content.html
A src/diazo/tests/comments/output.html
A src/diazo/tests/comments/rules.xml
A src/diazo/tests/comments/theme.html
A src/diazo/tests/comments/xpaths.txt
A src/diazo/tests/conditional-content-rules-with-variable/content.html
A src/diazo/tests/conditional-content-rules-with-variable/output.html
A src/diazo/tests/conditional-content-rules-with-variable/rules.xml
A src/diazo/tests/conditional-content-rules-with-variable/theme.html
A src/diazo/tests/conditional-drop-in-append-1/content.html
A src/diazo/tests/conditional-drop-in-append-1/output.html
A src/diazo/tests/conditional-drop-in-append-1/rules.xml
A src/diazo/tests/conditional-drop-in-append-1/theme.html
A src/diazo/tests/conditional-drop-in-append-2/content.html
A src/diazo/tests/conditional-drop-in-append-2/output.html
A src/diazo/tests/conditional-drop-in-append-2/rules.xml
A src/diazo/tests/conditional-drop-in-append-2/theme.html
A src/diazo/tests/conditional-include-content/content.html
A src/diazo/tests/conditional-include-content/output.html
A src/diazo/tests/conditional-include-content/rules.xml
A src/diazo/tests/conditional-include-content/theme.html
A src/diazo/tests/conditional-rules-1/content.html
A src/diazo/tests/conditional-rules-1/output.html
A src/diazo/tests/conditional-rules-1/rules.xml
A src/diazo/tests/conditional-rules-1/theme.html
A src/diazo/tests/conditional-rules-1/xpaths.txt
A src/diazo/tests/conditional-rules-2/content.html
A src/diazo/tests/conditional-rules-2/output.html
A src/diazo/tests/conditional-rules-2/rules.xml
A src/diazo/tests/conditional-rules-2/theme.html
A src/diazo/tests/conditional-rules-2/xpaths.txt
A src/diazo/tests/copy-xsl/content.html
A src/diazo/tests/copy-xsl/output.html
A src/diazo/tests/copy-xsl/rules.xml
A src/diazo/tests/copy-xsl/theme.html
A src/diazo/tests/copy/README.rst
A src/diazo/tests/copy/content.html
A src/diazo/tests/copy/output.html
A src/diazo/tests/copy/rules.xml
A src/diazo/tests/copy/theme.html
A src/diazo/tests/copy/xpaths.txt
A src/diazo/tests/css-prefix/content.html
A src/diazo/tests/css-prefix/output.html
A src/diazo/tests/css-prefix/rules.xml
A src/diazo/tests/css-prefix/theme.html
A src/diazo/tests/css-xpath-child-selectors/content.html
A src/diazo/tests/css-xpath-child-selectors/output.html
A src/diazo/tests/css-xpath-child-selectors/rules.xml
A src/diazo/tests/css-xpath-child-selectors/theme.html
A src/diazo/tests/css-xsl-template/content.html
A src/diazo/tests/css-xsl-template/output.html
A src/diazo/tests/css-xsl-template/rules.xml
A src/diazo/tests/css-xsl-template/theme.html
A src/diazo/tests/default-options.cfg
A src/diazo/tests/document-includes/content.html
A src/diazo/tests/document-includes/extra.html
A src/diazo/tests/document-includes/output.html
A src/diazo/tests/document-includes/rules.xml
A src/diazo/tests/document-includes/theme.html
A src/diazo/tests/document-includes/xpaths.txt
A src/diazo/tests/drop-content-comment/content.html
A src/diazo/tests/drop-content-comment/output.html
A src/diazo/tests/drop-content-comment/rules.xml
A src/diazo/tests/drop-content-comment/theme.html
A src/diazo/tests/drop-content/content.html
A src/diazo/tests/drop-content/output.html
A src/diazo/tests/drop-content/rules.xml
A src/diazo/tests/drop-content/theme.html
A src/diazo/tests/drop-content/xpaths.txt
A src/diazo/tests/drop-replace/content.html
A src/diazo/tests/drop-replace/output.html
A src/diazo/tests/drop-replace/rules.xml
A src/diazo/tests/drop-replace/theme.html
A src/diazo/tests/drop-theme-children/content.html
A src/diazo/tests/drop-theme-children/output.html
A src/diazo/tests/drop-theme-children/rules.xml
A src/diazo/tests/drop-theme-children/theme.html
A src/diazo/tests/drop-theme-comment/content.html
A src/diazo/tests/drop-theme-comment/output.html
A src/diazo/tests/drop-theme-comment/rules.xml
A src/diazo/tests/drop-theme-comment/theme.html
A src/diazo/tests/empty-xmlns/README.txt
A src/diazo/tests/empty-xmlns/content.html
A src/diazo/tests/empty-xmlns/output.html
A src/diazo/tests/empty-xmlns/rules.xml
A src/diazo/tests/empty-xmlns/theme.html
A src/diazo/tests/entities/content.html
A src/diazo/tests/entities/output.html
A src/diazo/tests/entities/rules.xml
A src/diazo/tests/entities/theme.html
A src/diazo/tests/esi/content.html
A src/diazo/tests/esi/output.html
A src/diazo/tests/esi/rules.xml
A src/diazo/tests/esi/theme.html
A src/diazo/tests/esi/xpaths.txt
A src/diazo/tests/html-attributes/content.html
A src/diazo/tests/html-attributes/output.html
A src/diazo/tests/html-attributes/rules.xml
A src/diazo/tests/html-attributes/theme.html
A src/diazo/tests/html-xml-lang-2/content.html
A src/diazo/tests/html-xml-lang-2/output.html
A src/diazo/tests/html-xml-lang-2/rules.xml
A src/diazo/tests/html-xml-lang-2/theme.html
A src/diazo/tests/html-xml-lang-3/content.html
A src/diazo/tests/html-xml-lang-3/output.html
A src/diazo/tests/html-xml-lang-3/rules.xml
A src/diazo/tests/html-xml-lang-3/theme.html
A src/diazo/tests/html-xml-lang/content.html
A src/diazo/tests/html-xml-lang/output.html
A src/diazo/tests/html-xml-lang/rules.xml
A src/diazo/tests/html-xml-lang/theme.html
A src/diazo/tests/if-path-1/content.html
A src/diazo/tests/if-path-1/options.cfg
A src/diazo/tests/if-path-1/output.html
A src/diazo/tests/if-path-1/rules.xml
A src/diazo/tests/if-path-1/theme.html
A src/diazo/tests/if-path-2/content.html
A src/diazo/tests/if-path-2/options.cfg
A src/diazo/tests/if-path-2/output.html
A src/diazo/tests/if-path-2/rules.xml
A src/diazo/tests/if-path-2/theme.html
A src/diazo/tests/if-path-3/content.html
A src/diazo/tests/if-path-3/options.cfg
A src/diazo/tests/if-path-3/output.html
A src/diazo/tests/if-path-3/rules.xml
A src/diazo/tests/if-path-3/theme.html
A src/diazo/tests/if-path-4/content.html
A src/diazo/tests/if-path-4/options.cfg
A src/diazo/tests/if-path-4/output.html
A src/diazo/tests/if-path-4/rules.xml
A src/diazo/tests/if-path-4/theme.html
A src/diazo/tests/if-path-5/content.html
A src/diazo/tests/if-path-5/options.cfg
A src/diazo/tests/if-path-5/output.html
A src/diazo/tests/if-path-5/rules.xml
A src/diazo/tests/if-path-5/theme.html
A src/diazo/tests/if-path-6/content.html
A src/diazo/tests/if-path-6/options.cfg
A src/diazo/tests/if-path-6/output.html
A src/diazo/tests/if-path-6/rules.xml
A src/diazo/tests/if-path-6/theme.html
A src/diazo/tests/if-path-7/content.html
A src/diazo/tests/if-path-7/options.cfg
A src/diazo/tests/if-path-7/output.html
A src/diazo/tests/if-path-7/rules.xml
A src/diazo/tests/if-path-7/theme.html
A src/diazo/tests/if-path-8/content.html
A src/diazo/tests/if-path-8/options.cfg
A src/diazo/tests/if-path-8/output.html
A src/diazo/tests/if-path-8/rules.xml
A src/diazo/tests/if-path-8/theme.html
A src/diazo/tests/include-content/content.html
A src/diazo/tests/include-content/extra.html
A src/diazo/tests/include-content/output.html
A src/diazo/tests/include-content/rules.xml
A src/diazo/tests/include-content/theme.html
A src/diazo/tests/indent-off/content.html
A src/diazo/tests/indent-off/options.cfg
A src/diazo/tests/indent-off/output.html
A src/diazo/tests/indent-off/rules.xml
A src/diazo/tests/indent-off/theme.html
A src/diazo/tests/inline-xsl-apply-templates/content.html
A src/diazo/tests/inline-xsl-apply-templates/output.html
A src/diazo/tests/inline-xsl-apply-templates/rules.xml
A src/diazo/tests/inline-xsl-apply-templates/theme.html
A src/diazo/tests/inline-xsl-directives/content.html
A src/diazo/tests/inline-xsl-directives/output.html
A src/diazo/tests/inline-xsl-directives/rules.xml
A src/diazo/tests/inline-xsl-directives/theme.html
A src/diazo/tests/modify-theme/content.html
A src/diazo/tests/modify-theme/output.html
A src/diazo/tests/modify-theme/rules.xml
A src/diazo/tests/modify-theme/theme.html
A src/diazo/tests/modify-theme/xpaths.txt
A src/diazo/tests/multi-copy-1/content.html
A src/diazo/tests/multi-copy-1/rules.xml
A src/diazo/tests/multi-copy-1/theme.html
A src/diazo/tests/multi-copy-1/xpaths.txt
A src/diazo/tests/multi-copy-2/content.html
A src/diazo/tests/multi-copy-2/rules.xml
A src/diazo/tests/multi-copy-2/theme.html
A src/diazo/tests/multi-copy-2/xpaths.txt
A src/diazo/tests/multi-copy-3/content.html
A src/diazo/tests/multi-copy-3/rules.xml
A src/diazo/tests/multi-copy-3/theme.html
A src/diazo/tests/multi-copy-3/xpaths.txt
A src/diazo/tests/multi-copy-4/content.html
A src/diazo/tests/multi-copy-4/rules.xml
A src/diazo/tests/multi-copy-4/theme.html
A src/diazo/tests/multi-copy-4/xpaths.txt
A src/diazo/tests/multi-replace-1/content.html
A src/diazo/tests/multi-replace-1/rules.xml
A src/diazo/tests/multi-replace-1/theme.html
A src/diazo/tests/multi-replace-1/xpaths.txt
A src/diazo/tests/multi-replace-2/content.html
A src/diazo/tests/multi-replace-2/rules.xml
A src/diazo/tests/multi-replace-2/theme.html
A src/diazo/tests/multi-replace-2/xpaths.txt
A src/diazo/tests/multi-replace-3/content.html
A src/diazo/tests/multi-replace-3/rules.xml
A src/diazo/tests/multi-replace-3/theme.html
A src/diazo/tests/multi-replace-3/xpaths.txt
A src/diazo/tests/multi-replace-4/content.html
A src/diazo/tests/multi-replace-4/rules.xml
A src/diazo/tests/multi-replace-4/theme.html
A src/diazo/tests/multi-replace-4/xpaths.txt
A src/diazo/tests/multi-theme-1/content.html
A src/diazo/tests/multi-theme-1/options.cfg
A src/diazo/tests/multi-theme-1/output.html
A src/diazo/tests/multi-theme-1/rules.xml
A src/diazo/tests/multi-theme-1/theme1.html
A src/diazo/tests/multi-theme-1/theme2.html
A src/diazo/tests/multi-theme-2/content.html
A src/diazo/tests/multi-theme-2/options.cfg
A src/diazo/tests/multi-theme-2/output.html
A src/diazo/tests/multi-theme-2/rules.xml
A src/diazo/tests/multi-theme-2/theme1.html
A src/diazo/tests/multi-theme-2/theme2.html
A src/diazo/tests/multi-theme-3/content.html
A src/diazo/tests/multi-theme-3/options.cfg
A src/diazo/tests/multi-theme-3/output.html
A src/diazo/tests/multi-theme-3/rules.xml
A src/diazo/tests/multi-theme-3/theme1.html
A src/diazo/tests/multi-theme-3/theme2.html
A src/diazo/tests/multi-theme-4/content.html
A src/diazo/tests/multi-theme-4/options.cfg
A src/diazo/tests/multi-theme-4/output.html
A src/diazo/tests/multi-theme-4/rules.xml
A src/diazo/tests/multi-theme-4/theme1.html
A src/diazo/tests/multi-theme-4/theme2.html
A src/diazo/tests/multi-theme-5/content.html
A src/diazo/tests/multi-theme-5/options.cfg
A src/diazo/tests/multi-theme-5/output.html
A src/diazo/tests/multi-theme-5/rules.xml
A src/diazo/tests/multi-theme-5/theme1.html
A src/diazo/tests/multi-theme-5/theme2.html
A src/diazo/tests/multi-theme-variable-1/content.html
A src/diazo/tests/multi-theme-variable-1/options.cfg
A src/diazo/tests/multi-theme-variable-1/output.html
A src/diazo/tests/multi-theme-variable-1/rules.xml
A src/diazo/tests/multi-theme-variable-1/theme1.html
A src/diazo/tests/multi-theme-variable-1/theme2.html
A src/diazo/tests/nested-conditions-1/content.html
A src/diazo/tests/nested-conditions-1/output.html
A src/diazo/tests/nested-conditions-1/rules.xml
A src/diazo/tests/nested-conditions-1/theme.html
A src/diazo/tests/nested-conditions-2/content.html
A src/diazo/tests/nested-conditions-2/output.html
A src/diazo/tests/nested-conditions-2/rules.xml
A src/diazo/tests/nested-conditions-2/theme.html
A src/diazo/tests/nested-conditions-3/content.html
A src/diazo/tests/nested-conditions-3/output.html
A src/diazo/tests/nested-conditions-3/rules.xml
A src/diazo/tests/nested-conditions-3/theme.html
A src/diazo/tests/nested-rules-for-xinclude/content.html
A src/diazo/tests/nested-rules-for-xinclude/output.html
A src/diazo/tests/nested-rules-for-xinclude/rules.xml
A src/diazo/tests/nested-rules-for-xinclude/theme.html
A src/diazo/tests/notheme-xmlns/content.html
A src/diazo/tests/notheme-xmlns/output.html
A src/diazo/tests/notheme-xmlns/rules.xml
A src/diazo/tests/notheme-xmlns/theme.html
A src/diazo/tests/null-if-content/content.html
A src/diazo/tests/null-if-content/rules.xml
A src/diazo/tests/null-if-content/theme.html
A src/diazo/tests/null-if-content/xpaths.txt
A src/diazo/tests/path-param-1/content.html
A src/diazo/tests/path-param-1/options.cfg
A src/diazo/tests/path-param-1/output.html
A src/diazo/tests/path-param-1/rules.xml
A src/diazo/tests/path-param-1/theme.html
A src/diazo/tests/path-param-2/content.html
A src/diazo/tests/path-param-2/options.cfg
A src/diazo/tests/path-param-2/output.html
A src/diazo/tests/path-param-2/rules.xml
A src/diazo/tests/path-param-2/theme.html
A src/diazo/tests/pre-line-endings/content.html
A src/diazo/tests/pre-line-endings/extra.html
A src/diazo/tests/pre-line-endings/output.html
A src/diazo/tests/pre-line-endings/rules.xml
A src/diazo/tests/pre-line-endings/theme.html
A src/diazo/tests/prepend-append/content.html
A src/diazo/tests/prepend-append/output.html
A src/diazo/tests/prepend-append/rules.xml
A src/diazo/tests/prepend-append/theme.html
A src/diazo/tests/prepend-append/xpaths.txt
A src/diazo/tests/prepend/content.html
A src/diazo/tests/prepend/output.html
A src/diazo/tests/prepend/rules.xml
A src/diazo/tests/prepend/theme.html
A src/diazo/tests/prepend/xpaths.txt
A src/diazo/tests/replace-after/content.html
A src/diazo/tests/replace-after/output.html
A src/diazo/tests/replace-after/rules.xml
A src/diazo/tests/replace-after/theme.html
A src/diazo/tests/replace-after/xpaths.txt
A src/diazo/tests/replace/README.rst
A src/diazo/tests/replace/content.html
A src/diazo/tests/replace/output.html
A src/diazo/tests/replace/rules.xml
A src/diazo/tests/replace/theme.html
A src/diazo/tests/replace/xpaths.txt
A src/diazo/tests/ssi/content.html
A src/diazo/tests/ssi/output.html
A src/diazo/tests/ssi/rules.xml
A src/diazo/tests/ssi/theme.html
A src/diazo/tests/ssi/xpaths.txt
A src/diazo/tests/ssiwait/content.html
A src/diazo/tests/ssiwait/output.html
A src/diazo/tests/ssiwait/rules.xml
A src/diazo/tests/ssiwait/theme.html
A src/diazo/tests/ssiwait/xpaths.txt
A src/diazo/tests/style-script-quoting-1/content.html
A src/diazo/tests/style-script-quoting-1/output.html
A src/diazo/tests/style-script-quoting-1/rules.xml
A src/diazo/tests/style-script-quoting-1/theme.html
A src/diazo/tests/style-script-quoting-1/xpaths.txt
A src/diazo/tests/style-script-quoting-2/content.html
A src/diazo/tests/style-script-quoting-2/output.html
A src/diazo/tests/style-script-quoting-2/rules.xml
A src/diazo/tests/style-script-quoting-2/theme.html
A src/diazo/tests/test_diazo.py
A src/diazo/tests/test_trace.py
A src/diazo/tests/test_wsgi.py
A src/diazo/tests/test_wsgi_files/custom_param.xml
A src/diazo/tests/test_wsgi_files/esi.xml
A src/diazo/tests/test_wsgi_files/explicit_theme.xml
A src/diazo/tests/test_wsgi_files/path_param.xml
A src/diazo/tests/test_wsgi_files/simple_transform.xml
A src/diazo/tests/test_wsgi_files/subrequest.xml
A src/diazo/tests/test_wsgi_files/theme.html
A src/diazo/tests/update-namespace-1/content.html
A src/diazo/tests/update-namespace-1/rules.xml
A src/diazo/tests/update-namespace-1/theme.html
A src/diazo/tests/update-namespace-1/xpaths.txt
A src/diazo/tests/update-namespace-2/content.html
A src/diazo/tests/update-namespace-2/output.html
A src/diazo/tests/update-namespace-2/rules.xml
A src/diazo/tests/update-namespace-2/theme.html
A src/diazo/tests/update-namespace-3/content.html
A src/diazo/tests/update-namespace-3/output.html
A src/diazo/tests/update-namespace-3/rules.xml
A src/diazo/tests/update-namespace-3/theme.html
A src/diazo/tests/v1-after-both-children/content.html
A src/diazo/tests/v1-after-both-children/output.html
A src/diazo/tests/v1-after-both-children/rules.xml
A src/diazo/tests/v1-after-both-children/theme.html
A src/diazo/tests/v1-after-content-children/content.html
A src/diazo/tests/v1-after-content-children/output.html
A src/diazo/tests/v1-after-content-children/rules.xml
A src/diazo/tests/v1-after-content-children/theme.html
A src/diazo/tests/v1-after-theme-children/content.html
A src/diazo/tests/v1-after-theme-children/output.html
A src/diazo/tests/v1-after-theme-children/rules.xml
A src/diazo/tests/v1-after-theme-children/theme.html
A src/diazo/tests/v1-after/content.html
A src/diazo/tests/v1-after/output.html
A src/diazo/tests/v1-after/rules.xml
A src/diazo/tests/v1-after/theme.html
A src/diazo/tests/v1-before-both-children/content.html
A src/diazo/tests/v1-before-both-children/output.html
A src/diazo/tests/v1-before-both-children/rules.xml
A src/diazo/tests/v1-before-both-children/theme.html
A src/diazo/tests/v1-before-content-children/content.html
A src/diazo/tests/v1-before-content-children/output.html
A src/diazo/tests/v1-before-content-children/rules.xml
A src/diazo/tests/v1-before-content-children/theme.html
A src/diazo/tests/v1-before-content-content-children/content.html
A src/diazo/tests/v1-before-content-content-children/output.html
A src/diazo/tests/v1-before-content-content-children/rules.xml
A src/diazo/tests/v1-before-content-content-children/theme.html
A src/diazo/tests/v1-before-replace-after-content/content.html
A src/diazo/tests/v1-before-replace-after-content/output.html
A src/diazo/tests/v1-before-replace-after-content/rules.xml
A src/diazo/tests/v1-before-replace-after-content/theme.html
A src/diazo/tests/v1-before-theme-children/content.html
A src/diazo/tests/v1-before-theme-children/output.html
A src/diazo/tests/v1-before-theme-children/rules.xml
A src/diazo/tests/v1-before-theme-children/theme.html
A src/diazo/tests/v1-before/content.html
A src/diazo/tests/v1-before/output.html
A src/diazo/tests/v1-before/rules.xml
A src/diazo/tests/v1-before/theme.html
A src/diazo/tests/v1-copy-all-attributes-conditional-1/content.html
A src/diazo/tests/v1-copy-all-attributes-conditional-1/output.html
A src/diazo/tests/v1-copy-all-attributes-conditional-1/rules.xml
A src/diazo/tests/v1-copy-all-attributes-conditional-1/theme.html
A src/diazo/tests/v1-copy-all-attributes-conditional-2/content.html
A src/diazo/tests/v1-copy-all-attributes-conditional-2/output.html
A src/diazo/tests/v1-copy-all-attributes-conditional-2/rules.xml
A src/diazo/tests/v1-copy-all-attributes-conditional-2/theme.html
A src/diazo/tests/v1-copy-all-attributes-conditional-3/content.html
A src/diazo/tests/v1-copy-all-attributes-conditional-3/output.html
A src/diazo/tests/v1-copy-all-attributes-conditional-3/rules.xml
A src/diazo/tests/v1-copy-all-attributes-conditional-3/theme.html
A src/diazo/tests/v1-copy-all-attributes-href/content.html
A src/diazo/tests/v1-copy-all-attributes-href/include.html
A src/diazo/tests/v1-copy-all-attributes-href/output.html
A src/diazo/tests/v1-copy-all-attributes-href/rules.xml
A src/diazo/tests/v1-copy-all-attributes-href/theme.html
A src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/content.html
A src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/output.html
A src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/rules.xml
A src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/theme.html
A src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/content.html
A src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/output.html
A src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/rules.xml
A src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/theme.html
A src/diazo/tests/v1-copy-all-attributes/content.html
A src/diazo/tests/v1-copy-all-attributes/output.html
A src/diazo/tests/v1-copy-all-attributes/rules.xml
A src/diazo/tests/v1-copy-all-attributes/theme.html
A src/diazo/tests/v1-copy-attribute-exists/content.html
A src/diazo/tests/v1-copy-attribute-exists/output.html
A src/diazo/tests/v1-copy-attribute-exists/rules.xml
A src/diazo/tests/v1-copy-attribute-exists/theme.html
A src/diazo/tests/v1-copy-attribute-not-exists/content.html
A src/diazo/tests/v1-copy-attribute-not-exists/output.html
A src/diazo/tests/v1-copy-attribute-not-exists/rules.xml
A src/diazo/tests/v1-copy-attribute-not-exists/theme.html
A src/diazo/tests/v1-copy-multi-attribute/content.html
A src/diazo/tests/v1-copy-multi-attribute/output.html
A src/diazo/tests/v1-copy-multi-attribute/rules.xml
A src/diazo/tests/v1-copy-multi-attribute/theme.html
A src/diazo/tests/v1-drop-all-attributes-content/content.html
A src/diazo/tests/v1-drop-all-attributes-content/output.html
A src/diazo/tests/v1-drop-all-attributes-content/rules.xml
A src/diazo/tests/v1-drop-all-attributes-content/theme.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/content.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/output.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/rules.xml
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/theme.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/content.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/output.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/rules.xml
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/theme.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/content.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/output.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/rules.xml
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/theme.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/content.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/output.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/rules.xml
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/theme.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/content.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/output.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/rules.xml
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/theme.html
A src/diazo/tests/v1-drop-all-attributes-theme/content.html
A src/diazo/tests/v1-drop-all-attributes-theme/output.html
A src/diazo/tests/v1-drop-all-attributes-theme/rules.xml
A src/diazo/tests/v1-drop-all-attributes-theme/theme.html
A src/diazo/tests/v1-drop-and-replace-messages/content.html
A src/diazo/tests/v1-drop-and-replace-messages/output.html
A src/diazo/tests/v1-drop-and-replace-messages/rules.xml
A src/diazo/tests/v1-drop-and-replace-messages/theme.html
A src/diazo/tests/v1-drop-and-replace-portlets/content.html
A src/diazo/tests/v1-drop-and-replace-portlets/output.html
A src/diazo/tests/v1-drop-and-replace-portlets/rules.xml
A src/diazo/tests/v1-drop-and-replace-portlets/theme.html
A src/diazo/tests/v1-drop-attribute-content/content.html
A src/diazo/tests/v1-drop-attribute-content/output.html
A src/diazo/tests/v1-drop-attribute-content/rules.xml
A src/diazo/tests/v1-drop-attribute-content/theme.html
A src/diazo/tests/v1-drop-attribute-theme-conditional-1/content.html
A src/diazo/tests/v1-drop-attribute-theme-conditional-1/output.html
A src/diazo/tests/v1-drop-attribute-theme-conditional-1/rules.xml
A src/diazo/tests/v1-drop-attribute-theme-conditional-1/theme.html
A src/diazo/tests/v1-drop-attribute-theme-conditional-2/content.html
A src/diazo/tests/v1-drop-attribute-theme-conditional-2/output.html
A src/diazo/tests/v1-drop-attribute-theme-conditional-2/rules.xml
A src/diazo/tests/v1-drop-attribute-theme-conditional-2/theme.html
A src/diazo/tests/v1-drop-attribute-theme/content.html
A src/diazo/tests/v1-drop-attribute-theme/output.html
A src/diazo/tests/v1-drop-attribute-theme/rules.xml
A src/diazo/tests/v1-drop-attribute-theme/theme.html
A src/diazo/tests/v1-drop-multi-attributes-content/content.html
A src/diazo/tests/v1-drop-multi-attributes-content/output.html
A src/diazo/tests/v1-drop-multi-attributes-content/rules.xml
A src/diazo/tests/v1-drop-multi-attributes-content/theme.html
A src/diazo/tests/v1-drop-multi-attributes-theme/content.html
A src/diazo/tests/v1-drop-multi-attributes-theme/output.html
A src/diazo/tests/v1-drop-multi-attributes-theme/rules.xml
A src/diazo/tests/v1-drop-multi-attributes-theme/theme.html
A src/diazo/tests/v1-if-content/content.html
A src/diazo/tests/v1-if-content/output.html
A src/diazo/tests/v1-if-content/rules.xml
A src/diazo/tests/v1-if-content/theme.html
A src/diazo/tests/v1-if-custom-param/content.html
A src/diazo/tests/v1-if-custom-param/options.cfg
A src/diazo/tests/v1-if-custom-param/output.html
A src/diazo/tests/v1-if-custom-param/rules.xml
A src/diazo/tests/v1-if-custom-param/theme.html
A src/diazo/tests/v1-if-merge/content.html
A src/diazo/tests/v1-if-merge/output.html
A src/diazo/tests/v1-if-merge/rules.xml
A src/diazo/tests/v1-if-merge/theme.html
A src/diazo/tests/v1-if-not-content/content.html
A src/diazo/tests/v1-if-not-content/output.html
A src/diazo/tests/v1-if-not-content/rules.xml
A src/diazo/tests/v1-if-not-content/theme.html
A src/diazo/tests/v1-if-not-path/content.html
A src/diazo/tests/v1-if-not-path/options.cfg
A src/diazo/tests/v1-if-not-path/output.html
A src/diazo/tests/v1-if-not-path/rules.xml
A src/diazo/tests/v1-if-not-path/theme.html
A src/diazo/tests/v1-if-not/content.html
A src/diazo/tests/v1-if-not/output.html
A src/diazo/tests/v1-if-not/rules.xml
A src/diazo/tests/v1-if-not/theme.html
A src/diazo/tests/v1-if-path/content.html
A src/diazo/tests/v1-if-path/options.cfg
A src/diazo/tests/v1-if-path/output.html
A src/diazo/tests/v1-if-path/rules.xml
A src/diazo/tests/v1-if-path/theme.html
A src/diazo/tests/v1-if/content.html
A src/diazo/tests/v1-if/output.html
A src/diazo/tests/v1-if/rules.xml
A src/diazo/tests/v1-if/theme.html
A src/diazo/tests/v1-merge-multiple-if-true/content.html
A src/diazo/tests/v1-merge-multiple-if-true/output.html
A src/diazo/tests/v1-merge-multiple-if-true/rules.xml
A src/diazo/tests/v1-merge-multiple-if-true/theme.html
A src/diazo/tests/v1-merge-multiple/content.html
A src/diazo/tests/v1-merge-multiple/output.html
A src/diazo/tests/v1-merge-multiple/rules.xml
A src/diazo/tests/v1-merge-multiple/theme.html
A src/diazo/tests/v1-merge-separator/content.html
A src/diazo/tests/v1-merge-separator/output.html
A src/diazo/tests/v1-merge-separator/rules.xml
A src/diazo/tests/v1-merge-separator/theme.html
A src/diazo/tests/v1-merge/content.html
A src/diazo/tests/v1-merge/output.html
A src/diazo/tests/v1-merge/rules.xml
A src/diazo/tests/v1-merge/theme.html
A src/diazo/tests/v1-notheme-if-content/content.html
A src/diazo/tests/v1-notheme-if-content/output.html
A src/diazo/tests/v1-notheme-if-content/rules.xml
A src/diazo/tests/v1-notheme-if-content/theme.html
A src/diazo/tests/v1-notheme-if-merge/content.html
A src/diazo/tests/v1-notheme-if-merge/output.html
A src/diazo/tests/v1-notheme-if-merge/rules.xml
A src/diazo/tests/v1-notheme-if-merge/theme.html
A src/diazo/tests/v1-notheme-if-path/content.html
A src/diazo/tests/v1-notheme-if-path/options.cfg
A src/diazo/tests/v1-notheme-if-path/output.html
A src/diazo/tests/v1-notheme-if-path/rules.xml
A src/diazo/tests/v1-notheme-if-path/theme.html
A src/diazo/tests/v1-notheme-if/content.html
A src/diazo/tests/v1-notheme-if/output.html
A src/diazo/tests/v1-notheme-if/rules.xml
A src/diazo/tests/v1-notheme-if/theme.html
A src/diazo/tests/v1-notheme-nomatch/content.html
A src/diazo/tests/v1-notheme-nomatch/output.html
A src/diazo/tests/v1-notheme-nomatch/rules.xml
A src/diazo/tests/v1-notheme-nomatch/theme.html
A src/diazo/tests/v1-notheme-theme-precedence/content.html
A src/diazo/tests/v1-notheme-theme-precedence/options.cfg
A src/diazo/tests/v1-notheme-theme-precedence/output.html
A src/diazo/tests/v1-notheme-theme-precedence/rules.xml
A src/diazo/tests/v1-notheme-theme-precedence/theme.html
A src/diazo/tests/v1-replace-both-children/content.html
A src/diazo/tests/v1-replace-both-children/output.html
A src/diazo/tests/v1-replace-both-children/rules.xml
A src/diazo/tests/v1-replace-both-children/theme.html
A src/diazo/tests/v1-replace-content-children/content.html
A src/diazo/tests/v1-replace-content-children/output.html
A src/diazo/tests/v1-replace-content-children/rules.xml
A src/diazo/tests/v1-replace-content-children/theme.html
A src/diazo/tests/v1-replace-content-conditional-1/content.html
A src/diazo/tests/v1-replace-content-conditional-1/output.html
A src/diazo/tests/v1-replace-content-conditional-1/rules.xml
A src/diazo/tests/v1-replace-content-conditional-1/theme.html
A src/diazo/tests/v1-replace-content-conditional-2/content.html
A src/diazo/tests/v1-replace-content-conditional-2/output.html
A src/diazo/tests/v1-replace-content-conditional-2/rules.xml
A src/diazo/tests/v1-replace-content-conditional-2/theme.html
A src/diazo/tests/v1-replace-content-content-children-conditional-1/content.html
A src/diazo/tests/v1-replace-content-content-children-conditional-1/output.html
A src/diazo/tests/v1-replace-content-content-children-conditional-1/rules.xml
A src/diazo/tests/v1-replace-content-content-children-conditional-1/theme.html
A src/diazo/tests/v1-replace-content-content-children-conditional-2/content.html
A src/diazo/tests/v1-replace-content-content-children-conditional-2/output.html
A src/diazo/tests/v1-replace-content-content-children-conditional-2/rules.xml
A src/diazo/tests/v1-replace-content-content-children-conditional-2/theme.html
A src/diazo/tests/v1-replace-content-content-children/content.html
A src/diazo/tests/v1-replace-content-content-children/output.html
A src/diazo/tests/v1-replace-content-content-children/rules.xml
A src/diazo/tests/v1-replace-content-content-children/theme.html
A src/diazo/tests/v1-replace-content/content.html
A src/diazo/tests/v1-replace-content/output.html
A src/diazo/tests/v1-replace-content/rules.xml
A src/diazo/tests/v1-replace-content/theme.html
A src/diazo/tests/v1-replace-theme-children/content.html
A src/diazo/tests/v1-replace-theme-children/output.html
A src/diazo/tests/v1-replace-theme-children/rules.xml
A src/diazo/tests/v1-replace-theme-children/theme.html
A src/diazo/tests/v1-replace/content.html
A src/diazo/tests/v1-replace/output.html
A src/diazo/tests/v1-replace/rules.xml
A src/diazo/tests/v1-replace/theme.html
A src/diazo/tests/v1-strip-content/content.html
A src/diazo/tests/v1-strip-content/output.html
A src/diazo/tests/v1-strip-content/rules.xml
A src/diazo/tests/v1-strip-content/theme.html
A src/diazo/tests/v1-strip-if-content/content.html
A src/diazo/tests/v1-strip-if-content/output.html
A src/diazo/tests/v1-strip-if-content/rules.xml
A src/diazo/tests/v1-strip-if-content/theme.html
A src/diazo/tests/v1-strip-if-theme/content.html
A src/diazo/tests/v1-strip-if-theme/output.html
A src/diazo/tests/v1-strip-if-theme/rules.xml
A src/diazo/tests/v1-strip-if-theme/theme.html
A src/diazo/tests/v1-strip-theme/content.html
A src/diazo/tests/v1-strip-theme/output.html
A src/diazo/tests/v1-strip-theme/rules.xml
A src/diazo/tests/v1-strip-theme/theme.html
A src/diazo/tests/without-theme/content.html
A src/diazo/tests/without-theme/options.cfg
A src/diazo/tests/without-theme/output.html
A src/diazo/tests/without-theme/rules.xml
A src/diazo/tests/xinclude/content.html
A src/diazo/tests/xinclude/included-rules.xml
A src/diazo/tests/xinclude/output.html
A src/diazo/tests/xinclude/rules.xml
A src/diazo/tests/xinclude/theme.html
A src/diazo/update-namespace.xsl
A src/diazo/utils.py
A src/diazo/wsgi.py
D lib/diazo/__init__.py
D lib/diazo/annotate-rules.xsl
D lib/diazo/annotate-themes.xsl
D lib/diazo/apply-conditions.xsl
D lib/diazo/apply-rules.xsl
D lib/diazo/compiler.py
D lib/diazo/cssrules.py
D lib/diazo/debug_resources/diazo-debug.css
D lib/diazo/debug_resources/diazo-debug.js
D lib/diazo/debug_resources/iframe.js
D lib/diazo/debug_resources/jquery-1.8.3.min.js
D lib/diazo/defaults.xsl
D lib/diazo/diazo-debug.zcml
D lib/diazo/dummy.html
D lib/diazo/emit-stylesheet.xsl
D lib/diazo/filter.xsl
D lib/diazo/filter_html.xsl
D lib/diazo/filter_xhtml.xsl
D lib/diazo/fixup-themes.xsl
D lib/diazo/identity.xsl
D lib/diazo/include.xsl
D lib/diazo/merge-conditions.xsl
D lib/diazo/normalize-rules.xsl
D lib/diazo/rules.py
D lib/diazo/run.py
D lib/diazo/runtrace.py
D lib/diazo/runtrace_to_html.xsl
D lib/diazo/tests/__init__.py
D lib/diazo/tests/absolute-prefix-disabled/content.html
D lib/diazo/tests/absolute-prefix-disabled/options.cfg
D lib/diazo/tests/absolute-prefix-disabled/output.html
D lib/diazo/tests/absolute-prefix-disabled/rules.xml
D lib/diazo/tests/absolute-prefix-disabled/theme.html
D lib/diazo/tests/absolute-prefix-ie-conditional-comments/content.html
D lib/diazo/tests/absolute-prefix-ie-conditional-comments/options.cfg
D lib/diazo/tests/absolute-prefix-ie-conditional-comments/output.html
D lib/diazo/tests/absolute-prefix-ie-conditional-comments/rules.xml
D lib/diazo/tests/absolute-prefix-ie-conditional-comments/theme.html
D lib/diazo/tests/absolute-prefix/content.html
D lib/diazo/tests/absolute-prefix/options.cfg
D lib/diazo/tests/absolute-prefix/output.html
D lib/diazo/tests/absolute-prefix/rules.xml
D lib/diazo/tests/absolute-prefix/theme.html
D lib/diazo/tests/allow-curly-brackets/README.rst
D lib/diazo/tests/allow-curly-brackets/content.html
D lib/diazo/tests/allow-curly-brackets/output.html
D lib/diazo/tests/allow-curly-brackets/rules.xml
D lib/diazo/tests/allow-curly-brackets/theme.html
D lib/diazo/tests/append/content.html
D lib/diazo/tests/append/output.html
D lib/diazo/tests/append/rules.xml
D lib/diazo/tests/append/theme.html
D lib/diazo/tests/append/xpaths.txt
D lib/diazo/tests/before-content-conditional/content.html
D lib/diazo/tests/before-content-conditional/output.html
D lib/diazo/tests/before-content-conditional/rules.xml
D lib/diazo/tests/before-content-conditional/theme.html
D lib/diazo/tests/before-prepend-append-after/content.html
D lib/diazo/tests/before-prepend-append-after/output.html
D lib/diazo/tests/before-prepend-append-after/rules.xml
D lib/diazo/tests/before-prepend-append-after/theme.html
D lib/diazo/tests/comments-outside-root-tag/content.html
D lib/diazo/tests/comments-outside-root-tag/output.html
D lib/diazo/tests/comments-outside-root-tag/rules.xml
D lib/diazo/tests/comments-outside-root-tag/theme.html
D lib/diazo/tests/comments/content.html
D lib/diazo/tests/comments/output.html
D lib/diazo/tests/comments/rules.xml
D lib/diazo/tests/comments/theme.html
D lib/diazo/tests/comments/xpaths.txt
D lib/diazo/tests/conditional-content-rules-with-variable/content.html
D lib/diazo/tests/conditional-content-rules-with-variable/output.html
D lib/diazo/tests/conditional-content-rules-with-variable/rules.xml
D lib/diazo/tests/conditional-content-rules-with-variable/theme.html
D lib/diazo/tests/conditional-drop-in-append-1/content.html
D lib/diazo/tests/conditional-drop-in-append-1/output.html
D lib/diazo/tests/conditional-drop-in-append-1/rules.xml
D lib/diazo/tests/conditional-drop-in-append-1/theme.html
D lib/diazo/tests/conditional-drop-in-append-2/content.html
D lib/diazo/tests/conditional-drop-in-append-2/output.html
D lib/diazo/tests/conditional-drop-in-append-2/rules.xml
D lib/diazo/tests/conditional-drop-in-append-2/theme.html
D lib/diazo/tests/conditional-include-content/content.html
D lib/diazo/tests/conditional-include-content/output.html
D lib/diazo/tests/conditional-include-content/rules.xml
D lib/diazo/tests/conditional-include-content/theme.html
D lib/diazo/tests/conditional-rules-1/content.html
D lib/diazo/tests/conditional-rules-1/output.html
D lib/diazo/tests/conditional-rules-1/rules.xml
D lib/diazo/tests/conditional-rules-1/theme.html
D lib/diazo/tests/conditional-rules-1/xpaths.txt
D lib/diazo/tests/conditional-rules-2/content.html
D lib/diazo/tests/conditional-rules-2/output.html
D lib/diazo/tests/conditional-rules-2/rules.xml
D lib/diazo/tests/conditional-rules-2/theme.html
D lib/diazo/tests/conditional-rules-2/xpaths.txt
D lib/diazo/tests/copy-xsl/content.html
D lib/diazo/tests/copy-xsl/output.html
D lib/diazo/tests/copy-xsl/rules.xml
D lib/diazo/tests/copy-xsl/theme.html
D lib/diazo/tests/copy/README.rst
D lib/diazo/tests/copy/content.html
D lib/diazo/tests/copy/output.html
D lib/diazo/tests/copy/rules.xml
D lib/diazo/tests/copy/theme.html
D lib/diazo/tests/copy/xpaths.txt
D lib/diazo/tests/css-prefix/content.html
D lib/diazo/tests/css-prefix/output.html
D lib/diazo/tests/css-prefix/rules.xml
D lib/diazo/tests/css-prefix/theme.html
D lib/diazo/tests/css-xpath-child-selectors/content.html
D lib/diazo/tests/css-xpath-child-selectors/output.html
D lib/diazo/tests/css-xpath-child-selectors/rules.xml
D lib/diazo/tests/css-xpath-child-selectors/theme.html
D lib/diazo/tests/css-xsl-template/content.html
D lib/diazo/tests/css-xsl-template/output.html
D lib/diazo/tests/css-xsl-template/rules.xml
D lib/diazo/tests/css-xsl-template/theme.html
D lib/diazo/tests/default-options.cfg
D lib/diazo/tests/document-includes/content.html
D lib/diazo/tests/document-includes/extra.html
D lib/diazo/tests/document-includes/output.html
D lib/diazo/tests/document-includes/rules.xml
D lib/diazo/tests/document-includes/theme.html
D lib/diazo/tests/document-includes/xpaths.txt
D lib/diazo/tests/drop-content-comment/content.html
D lib/diazo/tests/drop-content-comment/output.html
D lib/diazo/tests/drop-content-comment/rules.xml
D lib/diazo/tests/drop-content-comment/theme.html
D lib/diazo/tests/drop-content/content.html
D lib/diazo/tests/drop-content/output.html
D lib/diazo/tests/drop-content/rules.xml
D lib/diazo/tests/drop-content/theme.html
D lib/diazo/tests/drop-content/xpaths.txt
D lib/diazo/tests/drop-replace/content.html
D lib/diazo/tests/drop-replace/output.html
D lib/diazo/tests/drop-replace/rules.xml
D lib/diazo/tests/drop-replace/theme.html
D lib/diazo/tests/drop-theme-children/content.html
D lib/diazo/tests/drop-theme-children/output.html
D lib/diazo/tests/drop-theme-children/rules.xml
D lib/diazo/tests/drop-theme-children/theme.html
D lib/diazo/tests/drop-theme-comment/content.html
D lib/diazo/tests/drop-theme-comment/output.html
D lib/diazo/tests/drop-theme-comment/rules.xml
D lib/diazo/tests/drop-theme-comment/theme.html
D lib/diazo/tests/empty-xmlns/README.txt
D lib/diazo/tests/empty-xmlns/content.html
D lib/diazo/tests/empty-xmlns/output.html
D lib/diazo/tests/empty-xmlns/rules.xml
D lib/diazo/tests/empty-xmlns/theme.html
D lib/diazo/tests/entities/content.html
D lib/diazo/tests/entities/output.html
D lib/diazo/tests/entities/rules.xml
D lib/diazo/tests/entities/theme.html
D lib/diazo/tests/esi/content.html
D lib/diazo/tests/esi/output.html
D lib/diazo/tests/esi/rules.xml
D lib/diazo/tests/esi/theme.html
D lib/diazo/tests/esi/xpaths.txt
D lib/diazo/tests/html-attributes/content.html
D lib/diazo/tests/html-attributes/output.html
D lib/diazo/tests/html-attributes/rules.xml
D lib/diazo/tests/html-attributes/theme.html
D lib/diazo/tests/html-xml-lang-2/content.html
D lib/diazo/tests/html-xml-lang-2/output.html
D lib/diazo/tests/html-xml-lang-2/rules.xml
D lib/diazo/tests/html-xml-lang-2/theme.html
D lib/diazo/tests/html-xml-lang-3/content.html
D lib/diazo/tests/html-xml-lang-3/output.html
D lib/diazo/tests/html-xml-lang-3/rules.xml
D lib/diazo/tests/html-xml-lang-3/theme.html
D lib/diazo/tests/html-xml-lang/content.html
D lib/diazo/tests/html-xml-lang/output.html
D lib/diazo/tests/html-xml-lang/rules.xml
D lib/diazo/tests/html-xml-lang/theme.html
D lib/diazo/tests/if-path-1/content.html
D lib/diazo/tests/if-path-1/options.cfg
D lib/diazo/tests/if-path-1/output.html
D lib/diazo/tests/if-path-1/rules.xml
D lib/diazo/tests/if-path-1/theme.html
D lib/diazo/tests/if-path-2/content.html
D lib/diazo/tests/if-path-2/options.cfg
D lib/diazo/tests/if-path-2/output.html
D lib/diazo/tests/if-path-2/rules.xml
D lib/diazo/tests/if-path-2/theme.html
D lib/diazo/tests/if-path-3/content.html
D lib/diazo/tests/if-path-3/options.cfg
D lib/diazo/tests/if-path-3/output.html
D lib/diazo/tests/if-path-3/rules.xml
D lib/diazo/tests/if-path-3/theme.html
D lib/diazo/tests/if-path-4/content.html
D lib/diazo/tests/if-path-4/options.cfg
D lib/diazo/tests/if-path-4/output.html
D lib/diazo/tests/if-path-4/rules.xml
D lib/diazo/tests/if-path-4/theme.html
D lib/diazo/tests/if-path-5/content.html
D lib/diazo/tests/if-path-5/options.cfg
D lib/diazo/tests/if-path-5/output.html
D lib/diazo/tests/if-path-5/rules.xml
D lib/diazo/tests/if-path-5/theme.html
D lib/diazo/tests/if-path-6/content.html
D lib/diazo/tests/if-path-6/options.cfg
D lib/diazo/tests/if-path-6/output.html
D lib/diazo/tests/if-path-6/rules.xml
D lib/diazo/tests/if-path-6/theme.html
D lib/diazo/tests/if-path-7/content.html
D lib/diazo/tests/if-path-7/options.cfg
D lib/diazo/tests/if-path-7/output.html
D lib/diazo/tests/if-path-7/rules.xml
D lib/diazo/tests/if-path-7/theme.html
D lib/diazo/tests/if-path-8/content.html
D lib/diazo/tests/if-path-8/options.cfg
D lib/diazo/tests/if-path-8/output.html
D lib/diazo/tests/if-path-8/rules.xml
D lib/diazo/tests/if-path-8/theme.html
D lib/diazo/tests/include-content/content.html
D lib/diazo/tests/include-content/extra.html
D lib/diazo/tests/include-content/output.html
D lib/diazo/tests/include-content/rules.xml
D lib/diazo/tests/include-content/theme.html
D lib/diazo/tests/indent-off/content.html
D lib/diazo/tests/indent-off/options.cfg
D lib/diazo/tests/indent-off/output.html
D lib/diazo/tests/indent-off/rules.xml
D lib/diazo/tests/indent-off/theme.html
D lib/diazo/tests/inline-xsl-apply-templates/content.html
D lib/diazo/tests/inline-xsl-apply-templates/output.html
D lib/diazo/tests/inline-xsl-apply-templates/rules.xml
D lib/diazo/tests/inline-xsl-apply-templates/theme.html
D lib/diazo/tests/inline-xsl-directives/content.html
D lib/diazo/tests/inline-xsl-directives/output.html
D lib/diazo/tests/inline-xsl-directives/rules.xml
D lib/diazo/tests/inline-xsl-directives/theme.html
D lib/diazo/tests/modify-theme/content.html
D lib/diazo/tests/modify-theme/output.html
D lib/diazo/tests/modify-theme/rules.xml
D lib/diazo/tests/modify-theme/theme.html
D lib/diazo/tests/modify-theme/xpaths.txt
D lib/diazo/tests/multi-copy-1/content.html
D lib/diazo/tests/multi-copy-1/rules.xml
D lib/diazo/tests/multi-copy-1/theme.html
D lib/diazo/tests/multi-copy-1/xpaths.txt
D lib/diazo/tests/multi-copy-2/content.html
D lib/diazo/tests/multi-copy-2/rules.xml
D lib/diazo/tests/multi-copy-2/theme.html
D lib/diazo/tests/multi-copy-2/xpaths.txt
D lib/diazo/tests/multi-copy-3/content.html
D lib/diazo/tests/multi-copy-3/rules.xml
D lib/diazo/tests/multi-copy-3/theme.html
D lib/diazo/tests/multi-copy-3/xpaths.txt
D lib/diazo/tests/multi-copy-4/content.html
D lib/diazo/tests/multi-copy-4/rules.xml
D lib/diazo/tests/multi-copy-4/theme.html
D lib/diazo/tests/multi-copy-4/xpaths.txt
D lib/diazo/tests/multi-replace-1/content.html
D lib/diazo/tests/multi-replace-1/rules.xml
D lib/diazo/tests/multi-replace-1/theme.html
D lib/diazo/tests/multi-replace-1/xpaths.txt
D lib/diazo/tests/multi-replace-2/content.html
D lib/diazo/tests/multi-replace-2/rules.xml
D lib/diazo/tests/multi-replace-2/theme.html
D lib/diazo/tests/multi-replace-2/xpaths.txt
D lib/diazo/tests/multi-replace-3/content.html
D lib/diazo/tests/multi-replace-3/rules.xml
D lib/diazo/tests/multi-replace-3/theme.html
D lib/diazo/tests/multi-replace-3/xpaths.txt
D lib/diazo/tests/multi-replace-4/content.html
D lib/diazo/tests/multi-replace-4/rules.xml
D lib/diazo/tests/multi-replace-4/theme.html
D lib/diazo/tests/multi-replace-4/xpaths.txt
D lib/diazo/tests/multi-theme-1/content.html
D lib/diazo/tests/multi-theme-1/options.cfg
D lib/diazo/tests/multi-theme-1/output.html
D lib/diazo/tests/multi-theme-1/rules.xml
D lib/diazo/tests/multi-theme-1/theme1.html
D lib/diazo/tests/multi-theme-1/theme2.html
D lib/diazo/tests/multi-theme-2/content.html
D lib/diazo/tests/multi-theme-2/options.cfg
D lib/diazo/tests/multi-theme-2/output.html
D lib/diazo/tests/multi-theme-2/rules.xml
D lib/diazo/tests/multi-theme-2/theme1.html
D lib/diazo/tests/multi-theme-2/theme2.html
D lib/diazo/tests/multi-theme-3/content.html
D lib/diazo/tests/multi-theme-3/options.cfg
D lib/diazo/tests/multi-theme-3/output.html
D lib/diazo/tests/multi-theme-3/rules.xml
D lib/diazo/tests/multi-theme-3/theme1.html
D lib/diazo/tests/multi-theme-3/theme2.html
D lib/diazo/tests/multi-theme-4/content.html
D lib/diazo/tests/multi-theme-4/options.cfg
D lib/diazo/tests/multi-theme-4/output.html
D lib/diazo/tests/multi-theme-4/rules.xml
D lib/diazo/tests/multi-theme-4/theme1.html
D lib/diazo/tests/multi-theme-4/theme2.html
D lib/diazo/tests/multi-theme-5/content.html
D lib/diazo/tests/multi-theme-5/options.cfg
D lib/diazo/tests/multi-theme-5/output.html
D lib/diazo/tests/multi-theme-5/rules.xml
D lib/diazo/tests/multi-theme-5/theme1.html
D lib/diazo/tests/multi-theme-5/theme2.html
D lib/diazo/tests/multi-theme-variable-1/content.html
D lib/diazo/tests/multi-theme-variable-1/options.cfg
D lib/diazo/tests/multi-theme-variable-1/output.html
D lib/diazo/tests/multi-theme-variable-1/rules.xml
D lib/diazo/tests/multi-theme-variable-1/theme1.html
D lib/diazo/tests/multi-theme-variable-1/theme2.html
D lib/diazo/tests/nested-conditions-1/content.html
D lib/diazo/tests/nested-conditions-1/output.html
D lib/diazo/tests/nested-conditions-1/rules.xml
D lib/diazo/tests/nested-conditions-1/theme.html
D lib/diazo/tests/nested-conditions-2/content.html
D lib/diazo/tests/nested-conditions-2/output.html
D lib/diazo/tests/nested-conditions-2/rules.xml
D lib/diazo/tests/nested-conditions-2/theme.html
D lib/diazo/tests/nested-conditions-3/content.html
D lib/diazo/tests/nested-conditions-3/output.html
D lib/diazo/tests/nested-conditions-3/rules.xml
D lib/diazo/tests/nested-conditions-3/theme.html
D lib/diazo/tests/nested-rules-for-xinclude/content.html
D lib/diazo/tests/nested-rules-for-xinclude/output.html
D lib/diazo/tests/nested-rules-for-xinclude/rules.xml
D lib/diazo/tests/nested-rules-for-xinclude/theme.html
D lib/diazo/tests/notheme-xmlns/content.html
D lib/diazo/tests/notheme-xmlns/output.html
D lib/diazo/tests/notheme-xmlns/rules.xml
D lib/diazo/tests/notheme-xmlns/theme.html
D lib/diazo/tests/null-if-content/content.html
D lib/diazo/tests/null-if-content/rules.xml
D lib/diazo/tests/null-if-content/theme.html
D lib/diazo/tests/null-if-content/xpaths.txt
D lib/diazo/tests/path-param-1/content.html
D lib/diazo/tests/path-param-1/options.cfg
D lib/diazo/tests/path-param-1/output.html
D lib/diazo/tests/path-param-1/rules.xml
D lib/diazo/tests/path-param-1/theme.html
D lib/diazo/tests/path-param-2/content.html
D lib/diazo/tests/path-param-2/options.cfg
D lib/diazo/tests/path-param-2/output.html
D lib/diazo/tests/path-param-2/rules.xml
D lib/diazo/tests/path-param-2/theme.html
D lib/diazo/tests/pre-line-endings/content.html
D lib/diazo/tests/pre-line-endings/extra.html
D lib/diazo/tests/pre-line-endings/output.html
D lib/diazo/tests/pre-line-endings/rules.xml
D lib/diazo/tests/pre-line-endings/theme.html
D lib/diazo/tests/prepend-append/content.html
D lib/diazo/tests/prepend-append/output.html
D lib/diazo/tests/prepend-append/rules.xml
D lib/diazo/tests/prepend-append/theme.html
D lib/diazo/tests/prepend-append/xpaths.txt
D lib/diazo/tests/prepend/content.html
D lib/diazo/tests/prepend/output.html
D lib/diazo/tests/prepend/rules.xml
D lib/diazo/tests/prepend/theme.html
D lib/diazo/tests/prepend/xpaths.txt
D lib/diazo/tests/replace-after/content.html
D lib/diazo/tests/replace-after/output.html
D lib/diazo/tests/replace-after/rules.xml
D lib/diazo/tests/replace-after/theme.html
D lib/diazo/tests/replace-after/xpaths.txt
D lib/diazo/tests/replace/README.rst
D lib/diazo/tests/replace/content.html
D lib/diazo/tests/replace/output.html
D lib/diazo/tests/replace/rules.xml
D lib/diazo/tests/replace/theme.html
D lib/diazo/tests/replace/xpaths.txt
D lib/diazo/tests/ssi/content.html
D lib/diazo/tests/ssi/output.html
D lib/diazo/tests/ssi/rules.xml
D lib/diazo/tests/ssi/theme.html
D lib/diazo/tests/ssi/xpaths.txt
D lib/diazo/tests/ssiwait/content.html
D lib/diazo/tests/ssiwait/output.html
D lib/diazo/tests/ssiwait/rules.xml
D lib/diazo/tests/ssiwait/theme.html
D lib/diazo/tests/ssiwait/xpaths.txt
D lib/diazo/tests/style-script-quoting-1/content.html
D lib/diazo/tests/style-script-quoting-1/output.html
D lib/diazo/tests/style-script-quoting-1/rules.xml
D lib/diazo/tests/style-script-quoting-1/theme.html
D lib/diazo/tests/style-script-quoting-1/xpaths.txt
D lib/diazo/tests/style-script-quoting-2/content.html
D lib/diazo/tests/style-script-quoting-2/output.html
D lib/diazo/tests/style-script-quoting-2/rules.xml
D lib/diazo/tests/style-script-quoting-2/theme.html
D lib/diazo/tests/test_diazo.py
D lib/diazo/tests/test_trace.py
D lib/diazo/tests/test_wsgi.py
D lib/diazo/tests/test_wsgi_files/custom_param.xml
D lib/diazo/tests/test_wsgi_files/esi.xml
D lib/diazo/tests/test_wsgi_files/explicit_theme.xml
D lib/diazo/tests/test_wsgi_files/path_param.xml
D lib/diazo/tests/test_wsgi_files/simple_transform.xml
D lib/diazo/tests/test_wsgi_files/subrequest.xml
D lib/diazo/tests/test_wsgi_files/theme.html
D lib/diazo/tests/update-namespace-1/content.html
D lib/diazo/tests/update-namespace-1/rules.xml
D lib/diazo/tests/update-namespace-1/theme.html
D lib/diazo/tests/update-namespace-1/xpaths.txt
D lib/diazo/tests/update-namespace-2/content.html
D lib/diazo/tests/update-namespace-2/output.html
D lib/diazo/tests/update-namespace-2/rules.xml
D lib/diazo/tests/update-namespace-2/theme.html
D lib/diazo/tests/update-namespace-3/content.html
D lib/diazo/tests/update-namespace-3/output.html
D lib/diazo/tests/update-namespace-3/rules.xml
D lib/diazo/tests/update-namespace-3/theme.html
D lib/diazo/tests/v1-after-both-children/content.html
D lib/diazo/tests/v1-after-both-children/output.html
D lib/diazo/tests/v1-after-both-children/rules.xml
D lib/diazo/tests/v1-after-both-children/theme.html
D lib/diazo/tests/v1-after-content-children/content.html
D lib/diazo/tests/v1-after-content-children/output.html
D lib/diazo/tests/v1-after-content-children/rules.xml
D lib/diazo/tests/v1-after-content-children/theme.html
D lib/diazo/tests/v1-after-theme-children/content.html
D lib/diazo/tests/v1-after-theme-children/output.html
D lib/diazo/tests/v1-after-theme-children/rules.xml
D lib/diazo/tests/v1-after-theme-children/theme.html
D lib/diazo/tests/v1-after/content.html
D lib/diazo/tests/v1-after/output.html
D lib/diazo/tests/v1-after/rules.xml
D lib/diazo/tests/v1-after/theme.html
D lib/diazo/tests/v1-before-both-children/content.html
D lib/diazo/tests/v1-before-both-children/output.html
D lib/diazo/tests/v1-before-both-children/rules.xml
D lib/diazo/tests/v1-before-both-children/theme.html
D lib/diazo/tests/v1-before-content-children/content.html
D lib/diazo/tests/v1-before-content-children/output.html
D lib/diazo/tests/v1-before-content-children/rules.xml
D lib/diazo/tests/v1-before-content-children/theme.html
D lib/diazo/tests/v1-before-content-content-children/content.html
D lib/diazo/tests/v1-before-content-content-children/output.html
D lib/diazo/tests/v1-before-content-content-children/rules.xml
D lib/diazo/tests/v1-before-content-content-children/theme.html
D lib/diazo/tests/v1-before-replace-after-content/content.html
D lib/diazo/tests/v1-before-replace-after-content/output.html
D lib/diazo/tests/v1-before-replace-after-content/rules.xml
D lib/diazo/tests/v1-before-replace-after-content/theme.html
D lib/diazo/tests/v1-before-theme-children/content.html
D lib/diazo/tests/v1-before-theme-children/output.html
D lib/diazo/tests/v1-before-theme-children/rules.xml
D lib/diazo/tests/v1-before-theme-children/theme.html
D lib/diazo/tests/v1-before/content.html
D lib/diazo/tests/v1-before/output.html
D lib/diazo/tests/v1-before/rules.xml
D lib/diazo/tests/v1-before/theme.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-1/content.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-1/output.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-1/rules.xml
D lib/diazo/tests/v1-copy-all-attributes-conditional-1/theme.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-2/content.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-2/output.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-2/rules.xml
D lib/diazo/tests/v1-copy-all-attributes-conditional-2/theme.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-3/content.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-3/output.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-3/rules.xml
D lib/diazo/tests/v1-copy-all-attributes-conditional-3/theme.html
D lib/diazo/tests/v1-copy-all-attributes-href/content.html
D lib/diazo/tests/v1-copy-all-attributes-href/include.html
D lib/diazo/tests/v1-copy-all-attributes-href/output.html
D lib/diazo/tests/v1-copy-all-attributes-href/rules.xml
D lib/diazo/tests/v1-copy-all-attributes-href/theme.html
D lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/content.html
D lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/output.html
D lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/rules.xml
D lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/theme.html
D lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/content.html
D lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/output.html
D lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/rules.xml
D lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/theme.html
D lib/diazo/tests/v1-copy-all-attributes/content.html
D lib/diazo/tests/v1-copy-all-attributes/output.html
D lib/diazo/tests/v1-copy-all-attributes/rules.xml
D lib/diazo/tests/v1-copy-all-attributes/theme.html
D lib/diazo/tests/v1-copy-attribute-exists/content.html
D lib/diazo/tests/v1-copy-attribute-exists/output.html
D lib/diazo/tests/v1-copy-attribute-exists/rules.xml
D lib/diazo/tests/v1-copy-attribute-exists/theme.html
D lib/diazo/tests/v1-copy-attribute-not-exists/content.html
D lib/diazo/tests/v1-copy-attribute-not-exists/output.html
D lib/diazo/tests/v1-copy-attribute-not-exists/rules.xml
D lib/diazo/tests/v1-copy-attribute-not-exists/theme.html
D lib/diazo/tests/v1-copy-multi-attribute/content.html
D lib/diazo/tests/v1-copy-multi-attribute/output.html
D lib/diazo/tests/v1-copy-multi-attribute/rules.xml
D lib/diazo/tests/v1-copy-multi-attribute/theme.html
D lib/diazo/tests/v1-drop-all-attributes-content/content.html
D lib/diazo/tests/v1-drop-all-attributes-content/output.html
D lib/diazo/tests/v1-drop-all-attributes-content/rules.xml
D lib/diazo/tests/v1-drop-all-attributes-content/theme.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/content.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/output.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/rules.xml
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/theme.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/content.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/output.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/rules.xml
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/theme.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/content.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/output.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/rules.xml
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/theme.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/content.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/output.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/rules.xml
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/theme.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/content.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/output.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/rules.xml
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/theme.html
D lib/diazo/tests/v1-drop-all-attributes-theme/content.html
D lib/diazo/tests/v1-drop-all-attributes-theme/output.html
D lib/diazo/tests/v1-drop-all-attributes-theme/rules.xml
D lib/diazo/tests/v1-drop-all-attributes-theme/theme.html
D lib/diazo/tests/v1-drop-and-replace-messages/content.html
D lib/diazo/tests/v1-drop-and-replace-messages/output.html
D lib/diazo/tests/v1-drop-and-replace-messages/rules.xml
D lib/diazo/tests/v1-drop-and-replace-messages/theme.html
D lib/diazo/tests/v1-drop-and-replace-portlets/content.html
D lib/diazo/tests/v1-drop-and-replace-portlets/output.html
D lib/diazo/tests/v1-drop-and-replace-portlets/rules.xml
D lib/diazo/tests/v1-drop-and-replace-portlets/theme.html
D lib/diazo/tests/v1-drop-attribute-content/content.html
D lib/diazo/tests/v1-drop-attribute-content/output.html
D lib/diazo/tests/v1-drop-attribute-content/rules.xml
D lib/diazo/tests/v1-drop-attribute-content/theme.html
D lib/diazo/tests/v1-drop-attribute-theme-conditional-1/content.html
D lib/diazo/tests/v1-drop-attribute-theme-conditional-1/output.html
D lib/diazo/tests/v1-drop-attribute-theme-conditional-1/rules.xml
D lib/diazo/tests/v1-drop-attribute-theme-conditional-1/theme.html
D lib/diazo/tests/v1-drop-attribute-theme-conditional-2/content.html
D lib/diazo/tests/v1-drop-attribute-theme-conditional-2/output.html
D lib/diazo/tests/v1-drop-attribute-theme-conditional-2/rules.xml
D lib/diazo/tests/v1-drop-attribute-theme-conditional-2/theme.html
D lib/diazo/tests/v1-drop-attribute-theme/content.html
D lib/diazo/tests/v1-drop-attribute-theme/output.html
D lib/diazo/tests/v1-drop-attribute-theme/rules.xml
D lib/diazo/tests/v1-drop-attribute-theme/theme.html
D lib/diazo/tests/v1-drop-multi-attributes-content/content.html
D lib/diazo/tests/v1-drop-multi-attributes-content/output.html
D lib/diazo/tests/v1-drop-multi-attributes-content/rules.xml
D lib/diazo/tests/v1-drop-multi-attributes-content/theme.html
D lib/diazo/tests/v1-drop-multi-attributes-theme/content.html
D lib/diazo/tests/v1-drop-multi-attributes-theme/output.html
D lib/diazo/tests/v1-drop-multi-attributes-theme/rules.xml
D lib/diazo/tests/v1-drop-multi-attributes-theme/theme.html
D lib/diazo/tests/v1-if-content/content.html
D lib/diazo/tests/v1-if-content/output.html
D lib/diazo/tests/v1-if-content/rules.xml
D lib/diazo/tests/v1-if-content/theme.html
D lib/diazo/tests/v1-if-custom-param/content.html
D lib/diazo/tests/v1-if-custom-param/options.cfg
D lib/diazo/tests/v1-if-custom-param/output.html
D lib/diazo/tests/v1-if-custom-param/rules.xml
D lib/diazo/tests/v1-if-custom-param/theme.html
D lib/diazo/tests/v1-if-merge/content.html
D lib/diazo/tests/v1-if-merge/output.html
D lib/diazo/tests/v1-if-merge/rules.xml
D lib/diazo/tests/v1-if-merge/theme.html
D lib/diazo/tests/v1-if-not-content/content.html
D lib/diazo/tests/v1-if-not-content/output.html
D lib/diazo/tests/v1-if-not-content/rules.xml
D lib/diazo/tests/v1-if-not-content/theme.html
D lib/diazo/tests/v1-if-not-path/content.html
D lib/diazo/tests/v1-if-not-path/options.cfg
D lib/diazo/tests/v1-if-not-path/output.html
D lib/diazo/tests/v1-if-not-path/rules.xml
D lib/diazo/tests/v1-if-not-path/theme.html
D lib/diazo/tests/v1-if-not/content.html
D lib/diazo/tests/v1-if-not/output.html
D lib/diazo/tests/v1-if-not/rules.xml
D lib/diazo/tests/v1-if-not/theme.html
D lib/diazo/tests/v1-if-path/content.html
D lib/diazo/tests/v1-if-path/options.cfg
D lib/diazo/tests/v1-if-path/output.html
D lib/diazo/tests/v1-if-path/rules.xml
D lib/diazo/tests/v1-if-path/theme.html
D lib/diazo/tests/v1-if/content.html
D lib/diazo/tests/v1-if/output.html
D lib/diazo/tests/v1-if/rules.xml
D lib/diazo/tests/v1-if/theme.html
D lib/diazo/tests/v1-merge-multiple-if-true/content.html
D lib/diazo/tests/v1-merge-multiple-if-true/output.html
D lib/diazo/tests/v1-merge-multiple-if-true/rules.xml
D lib/diazo/tests/v1-merge-multiple-if-true/theme.html
D lib/diazo/tests/v1-merge-multiple/content.html
D lib/diazo/tests/v1-merge-multiple/output.html
D lib/diazo/tests/v1-merge-multiple/rules.xml
D lib/diazo/tests/v1-merge-multiple/theme.html
D lib/diazo/tests/v1-merge-separator/content.html
D lib/diazo/tests/v1-merge-separator/output.html
D lib/diazo/tests/v1-merge-separator/rules.xml
D lib/diazo/tests/v1-merge-separator/theme.html
D lib/diazo/tests/v1-merge/content.html
D lib/diazo/tests/v1-merge/output.html
D lib/diazo/tests/v1-merge/rules.xml
D lib/diazo/tests/v1-merge/theme.html
D lib/diazo/tests/v1-notheme-if-content/content.html
D lib/diazo/tests/v1-notheme-if-content/output.html
D lib/diazo/tests/v1-notheme-if-content/rules.xml
D lib/diazo/tests/v1-notheme-if-content/theme.html
D lib/diazo/tests/v1-notheme-if-merge/content.html
D lib/diazo/tests/v1-notheme-if-merge/output.html
D lib/diazo/tests/v1-notheme-if-merge/rules.xml
D lib/diazo/tests/v1-notheme-if-merge/theme.html
D lib/diazo/tests/v1-notheme-if-path/content.html
D lib/diazo/tests/v1-notheme-if-path/options.cfg
D lib/diazo/tests/v1-notheme-if-path/output.html
D lib/diazo/tests/v1-notheme-if-path/rules.xml
D lib/diazo/tests/v1-notheme-if-path/theme.html
D lib/diazo/tests/v1-notheme-if/content.html
D lib/diazo/tests/v1-notheme-if/output.html
D lib/diazo/tests/v1-notheme-if/rules.xml
D lib/diazo/tests/v1-notheme-if/theme.html
D lib/diazo/tests/v1-notheme-nomatch/content.html
D lib/diazo/tests/v1-notheme-nomatch/output.html
D lib/diazo/tests/v1-notheme-nomatch/rules.xml
D lib/diazo/tests/v1-notheme-nomatch/theme.html
D lib/diazo/tests/v1-notheme-theme-precedence/content.html
D lib/diazo/tests/v1-notheme-theme-precedence/options.cfg
D lib/diazo/tests/v1-notheme-theme-precedence/output.html
D lib/diazo/tests/v1-notheme-theme-precedence/rules.xml
D lib/diazo/tests/v1-notheme-theme-precedence/theme.html
D lib/diazo/tests/v1-replace-both-children/content.html
D lib/diazo/tests/v1-replace-both-children/output.html
D lib/diazo/tests/v1-replace-both-children/rules.xml
D lib/diazo/tests/v1-replace-both-children/theme.html
D lib/diazo/tests/v1-replace-content-children/content.html
D lib/diazo/tests/v1-replace-content-children/output.html
D lib/diazo/tests/v1-replace-content-children/rules.xml
D lib/diazo/tests/v1-replace-content-children/theme.html
D lib/diazo/tests/v1-replace-content-conditional-1/content.html
D lib/diazo/tests/v1-replace-content-conditional-1/output.html
D lib/diazo/tests/v1-replace-content-conditional-1/rules.xml
D lib/diazo/tests/v1-replace-content-conditional-1/theme.html
D lib/diazo/tests/v1-replace-content-conditional-2/content.html
D lib/diazo/tests/v1-replace-content-conditional-2/output.html
D lib/diazo/tests/v1-replace-content-conditional-2/rules.xml
D lib/diazo/tests/v1-replace-content-conditional-2/theme.html
D lib/diazo/tests/v1-replace-content-content-children-conditional-1/content.html
D lib/diazo/tests/v1-replace-content-content-children-conditional-1/output.html
D lib/diazo/tests/v1-replace-content-content-children-conditional-1/rules.xml
D lib/diazo/tests/v1-replace-content-content-children-conditional-1/theme.html
D lib/diazo/tests/v1-replace-content-content-children-conditional-2/content.html
D lib/diazo/tests/v1-replace-content-content-children-conditional-2/output.html
D lib/diazo/tests/v1-replace-content-content-children-conditional-2/rules.xml
D lib/diazo/tests/v1-replace-content-content-children-conditional-2/theme.html
D lib/diazo/tests/v1-replace-content-content-children/content.html
D lib/diazo/tests/v1-replace-content-content-children/output.html
D lib/diazo/tests/v1-replace-content-content-children/rules.xml
D lib/diazo/tests/v1-replace-content-content-children/theme.html
D lib/diazo/tests/v1-replace-content/content.html
D lib/diazo/tests/v1-replace-content/output.html
D lib/diazo/tests/v1-replace-content/rules.xml
D lib/diazo/tests/v1-replace-content/theme.html
D lib/diazo/tests/v1-replace-theme-children/content.html
D lib/diazo/tests/v1-replace-theme-children/output.html
D lib/diazo/tests/v1-replace-theme-children/rules.xml
D lib/diazo/tests/v1-replace-theme-children/theme.html
D lib/diazo/tests/v1-replace/content.html
D lib/diazo/tests/v1-replace/output.html
D lib/diazo/tests/v1-replace/rules.xml
D lib/diazo/tests/v1-replace/theme.html
D lib/diazo/tests/v1-strip-content/content.html
D lib/diazo/tests/v1-strip-content/output.html
D lib/diazo/tests/v1-strip-content/rules.xml
D lib/diazo/tests/v1-strip-content/theme.html
D lib/diazo/tests/v1-strip-if-content/content.html
D lib/diazo/tests/v1-strip-if-content/output.html
D lib/diazo/tests/v1-strip-if-content/rules.xml
D lib/diazo/tests/v1-strip-if-content/theme.html
D lib/diazo/tests/v1-strip-if-theme/content.html
D lib/diazo/tests/v1-strip-if-theme/output.html
D lib/diazo/tests/v1-strip-if-theme/rules.xml
D lib/diazo/tests/v1-strip-if-theme/theme.html
D lib/diazo/tests/v1-strip-theme/content.html
D lib/diazo/tests/v1-strip-theme/output.html
D lib/diazo/tests/v1-strip-theme/rules.xml
D lib/diazo/tests/v1-strip-theme/theme.html
D lib/diazo/tests/without-theme/content.html
D lib/diazo/tests/without-theme/options.cfg
D lib/diazo/tests/without-theme/output.html
D lib/diazo/tests/without-theme/rules.xml
D lib/diazo/tests/xinclude/content.html
D lib/diazo/tests/xinclude/included-rules.xml
D lib/diazo/tests/xinclude/output.html
D lib/diazo/tests/xinclude/rules.xml
D lib/diazo/tests/xinclude/theme.html
D lib/diazo/update-namespace.xsl
D lib/diazo/utils.py
D lib/diazo/wsgi.py

b'diff --git a/lib/diazo/__init__.py b/src/diazo/__init__.py\nsimilarity index 100%\nrename from lib/diazo/__init__.py\nrename to src/diazo/__init__.py\ndiff --git a/lib/diazo/annotate-rules.xsl b/src/diazo/annotate-rules.xsl\nsimilarity index 100%\nrename from lib/diazo/annotate-rules.xsl\nrename to src/diazo/annotate-rules.xsl\ndiff --git a/lib/diazo/annotate-themes.xsl b/src/diazo/annotate-themes.xsl\nsimilarity index 100%\nrename from lib/diazo/annotate-themes.xsl\nrename to src/diazo/annotate-themes.xsl\ndiff --git a/lib/diazo/apply-conditions.xsl b/src/diazo/apply-conditions.xsl\nsimilarity index 100%\nrename from lib/diazo/apply-conditions.xsl\nrename to src/diazo/apply-conditions.xsl\ndiff --git a/lib/diazo/apply-rules.xsl b/src/diazo/apply-rules.xsl\nsimilarity index 100%\nrename from lib/diazo/apply-rules.xsl\nrename to src/diazo/apply-rules.xsl\ndiff --git a/lib/diazo/compiler.py b/src/diazo/compiler.py\nsimilarity index 100%\nrename from lib/diazo/compiler.py\nrename to src/diazo/compiler.py\ndiff --git a/lib/diazo/cssrules.py b/src/diazo/cssrules.py\nsimilarity index 100%\nrename from lib/diazo/cssrules.py\nrename to src/diazo/cssrules.py\ndiff --git a/lib/diazo/debug_resources/diazo-debug.css b/src/diazo/debug_resources/diazo-debug.css\nsimilarity index 100%\nrename from lib/diazo/debug_resources/diazo-debug.css\nrename to src/diazo/debug_resources/diazo-debug.css\ndiff --git a/lib/diazo/debug_resources/diazo-debug.js b/src/diazo/debug_resources/diazo-debug.js\nsimilarity index 100%\nrename from lib/diazo/debug_resources/diazo-debug.js\nrename to src/diazo/debug_resources/diazo-debug.js\ndiff --git a/lib/diazo/debug_resources/iframe.js b/src/diazo/debug_resources/iframe.js\nsimilarity index 100%\nrename from lib/diazo/debug_resources/iframe.js\nrename to src/diazo/debug_resources/iframe.js\ndiff --git a/lib/diazo/debug_resources/jquery-1.8.3.min.js b/src/diazo/debug_resources/jquery-1.8.3.min.js\nsimilarity index 100%\nrename from lib/diazo/debug_resources/jquery-1.8.3.min.js\nrename to src/diazo/debug_resources/jquery-1.8.3.min.js\ndiff --git a/lib/diazo/defaults.xsl b/src/diazo/defaults.xsl\nsimilarity index 100%\nrename from lib/diazo/defaults.xsl\nrename to src/diazo/defaults.xsl\ndiff --git a/lib/diazo/diazo-debug.zcml b/src/diazo/diazo-debug.zcml\nsimilarity index 100%\nrename from lib/diazo/diazo-debug.zcml\nrename to src/diazo/diazo-debug.zcml\ndiff --git a/lib/diazo/dummy.html b/src/diazo/dummy.html\nsimilarity index 100%\nrename from lib/diazo/dummy.html\nrename to src/diazo/dummy.html\ndiff --git a/lib/diazo/emit-stylesheet.xsl b/src/diazo/emit-stylesheet.xsl\nsimilarity index 100%\nrename from lib/diazo/emit-stylesheet.xsl\nrename to src/diazo/emit-stylesheet.xsl\ndiff --git a/lib/diazo/filter.xsl b/src/diazo/filter.xsl\nsimilarity index 100%\nrename from lib/diazo/filter.xsl\nrename to src/diazo/filter.xsl\ndiff --git a/lib/diazo/filter_html.xsl b/src/diazo/filter_html.xsl\nsimilarity index 100%\nrename from lib/diazo/filter_html.xsl\nrename to src/diazo/filter_html.xsl\ndiff --git a/lib/diazo/filter_xhtml.xsl b/src/diazo/filter_xhtml.xsl\nsimilarity index 100%\nrename from lib/diazo/filter_xhtml.xsl\nrename to src/diazo/filter_xhtml.xsl\ndiff --git a/lib/diazo/fixup-themes.xsl b/src/diazo/fixup-themes.xsl\nsimilarity index 100%\nrename from lib/diazo/fixup-themes.xsl\nrename to src/diazo/fixup-themes.xsl\ndiff --git a/lib/diazo/identity.xsl b/src/diazo/identity.xsl\nsimilarity index 100%\nrename from lib/diazo/identity.xsl\nrename to src/diazo/identity.xsl\ndiff --git a/lib/diazo/include.xsl b/src/diazo/include.xsl\nsimilarity index 100%\nrename from lib/diazo/include.xsl\nrename to src/diazo/include.xsl\ndiff --git a/lib/diazo/merge-conditions.xsl b/src/diazo/merge-conditions.xsl\nsimilarity index 100%\nrename from lib/diazo/merge-conditions.xsl\nrename to src/diazo/merge-conditions.xsl\ndiff --git a/lib/diazo/normalize-rules.xsl b/src/diazo/normalize-rules.xsl\nsimilarity index 100%\nrename from lib/diazo/normalize-rules.xsl\nrename to src/diazo/normalize-rules.xsl\ndiff --git a/lib/diazo/rules.py b/src/diazo/rules.py\nsimilarity index 100%\nrename from lib/diazo/rules.py\nrename to src/diazo/rules.py\ndiff --git a/lib/diazo/run.py b/src/diazo/run.py\nsimilarity index 100%\nrename from lib/diazo/run.py\nrename to src/diazo/run.py\ndiff --git a/lib/diazo/runtrace.py b/src/diazo/runtrace.py\nsimilarity index 100%\nrename from lib/diazo/runtrace.py\nrename to src/diazo/runtrace.py\ndiff --git a/lib/diazo/runtrace_to_html.xsl b/src/diazo/runtrace_to_html.xsl\nsimilarity index 100%\nrename from lib/diazo/runtrace_to_html.xsl\nrename to src/diazo/runtrace_to_html.xsl\ndiff --git a/lib/diazo/tests/__init__.py b/src/diazo/tests/__init__.py\nsimilarity index 100%\nrename from lib/diazo/tests/__init__.py\nrename to src/diazo/tests/__init__.py\ndiff --git a/lib/diazo/tests/absolute-prefix-disabled/content.html b/src/diazo/tests/absolute-prefix-disabled/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-disabled/content.html\nrename to src/diazo/tests/absolute-prefix-disabled/content.html\ndiff --git a/lib/diazo/tests/absolute-prefix-disabled/options.cfg b/src/diazo/tests/absolute-prefix-disabled/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-disabled/options.cfg\nrename to src/diazo/tests/absolute-prefix-disabled/options.cfg\ndiff --git a/lib/diazo/tests/absolute-prefix-disabled/output.html b/src/diazo/tests/absolute-prefix-disabled/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-disabled/output.html\nrename to src/diazo/tests/absolute-prefix-disabled/output.html\ndiff --git a/lib/diazo/tests/absolute-prefix-disabled/rules.xml b/src/diazo/tests/absolute-prefix-disabled/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-disabled/rules.xml\nrename to src/diazo/tests/absolute-prefix-disabled/rules.xml\ndiff --git a/lib/diazo/tests/absolute-prefix-disabled/theme.html b/src/diazo/tests/absolute-prefix-disabled/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-disabled/theme.html\nrename to src/diazo/tests/absolute-prefix-disabled/theme.html\ndiff --git a/lib/diazo/tests/absolute-prefix-ie-conditional-comments/content.html b/src/diazo/tests/absolute-prefix-ie-conditional-comments/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-ie-conditional-comments/content.html\nrename to src/diazo/tests/absolute-prefix-ie-conditional-comments/content.html\ndiff --git a/lib/diazo/tests/absolute-prefix-ie-conditional-comments/options.cfg b/src/diazo/tests/absolute-prefix-ie-conditional-comments/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-ie-conditional-comments/options.cfg\nrename to src/diazo/tests/absolute-prefix-ie-conditional-comments/options.cfg\ndiff --git a/lib/diazo/tests/absolute-prefix-ie-conditional-comments/output.html b/src/diazo/tests/absolute-prefix-ie-conditional-comments/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-ie-conditional-comments/output.html\nrename to src/diazo/tests/absolute-prefix-ie-conditional-comments/output.html\ndiff --git a/lib/diazo/tests/absolute-prefix-ie-conditional-comments/rules.xml b/src/diazo/tests/absolute-prefix-ie-conditional-comments/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-ie-conditional-comments/rules.xml\nrename to src/diazo/tests/absolute-prefix-ie-conditional-comments/rules.xml\ndiff --git a/lib/diazo/tests/absolute-prefix-ie-conditional-comments/theme.html b/src/diazo/tests/absolute-prefix-ie-conditional-comments/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-ie-conditional-comments/theme.html\nrename to src/diazo/tests/absolute-prefix-ie-conditional-comments/theme.html\ndiff --git a/lib/diazo/tests/absolute-prefix/content.html b/src/diazo/tests/absolute-prefix/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix/content.html\nrename to src/diazo/tests/absolute-prefix/content.html\ndiff --git a/lib/diazo/tests/absolute-prefix/options.cfg b/src/diazo/tests/absolute-prefix/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix/options.cfg\nrename to src/diazo/tests/absolute-prefix/options.cfg\ndiff --git a/lib/diazo/tests/absolute-prefix/output.html b/src/diazo/tests/absolute-prefix/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix/output.html\nrename to src/diazo/tests/absolute-prefix/output.html\ndiff --git a/lib/diazo/tests/absolute-prefix/rules.xml b/src/diazo/tests/absolute-prefix/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix/rules.xml\nrename to src/diazo/tests/absolute-prefix/rules.xml\ndiff --git a/lib/diazo/tests/absolute-prefix/theme.html b/src/diazo/tests/absolute-prefix/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix/theme.html\nrename to src/diazo/tests/absolute-prefix/theme.html\ndiff --git a/lib/diazo/tests/allow-curly-brackets/README.rst b/src/diazo/tests/allow-curly-brackets/README.rst\nsimilarity index 100%\nrename from lib/diazo/tests/allow-curly-brackets/README.rst\nrename to src/diazo/tests/allow-curly-brackets/README.rst\ndiff --git a/lib/diazo/tests/allow-curly-brackets/content.html b/src/diazo/tests/allow-curly-brackets/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/allow-curly-brackets/content.html\nrename to src/diazo/tests/allow-curly-brackets/content.html\ndiff --git a/lib/diazo/tests/allow-curly-brackets/output.html b/src/diazo/tests/allow-curly-brackets/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/allow-curly-brackets/output.html\nrename to src/diazo/tests/allow-curly-brackets/output.html\ndiff --git a/lib/diazo/tests/allow-curly-brackets/rules.xml b/src/diazo/tests/allow-curly-brackets/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/allow-curly-brackets/rules.xml\nrename to src/diazo/tests/allow-curly-brackets/rules.xml\ndiff --git a/lib/diazo/tests/allow-curly-brackets/theme.html b/src/diazo/tests/allow-curly-brackets/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/allow-curly-brackets/theme.html\nrename to src/diazo/tests/allow-curly-brackets/theme.html\ndiff --git a/lib/diazo/tests/append/content.html b/src/diazo/tests/append/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/append/content.html\nrename to src/diazo/tests/append/content.html\ndiff --git a/lib/diazo/tests/append/output.html b/src/diazo/tests/append/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/append/output.html\nrename to src/diazo/tests/append/output.html\ndiff --git a/lib/diazo/tests/append/rules.xml b/src/diazo/tests/append/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/append/rules.xml\nrename to src/diazo/tests/append/rules.xml\ndiff --git a/lib/diazo/tests/append/theme.html b/src/diazo/tests/append/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/append/theme.html\nrename to src/diazo/tests/append/theme.html\ndiff --git a/lib/diazo/tests/append/xpaths.txt b/src/diazo/tests/append/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/append/xpaths.txt\nrename to src/diazo/tests/append/xpaths.txt\ndiff --git a/lib/diazo/tests/before-content-conditional/content.html b/src/diazo/tests/before-content-conditional/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/before-content-conditional/content.html\nrename to src/diazo/tests/before-content-conditional/content.html\ndiff --git a/lib/diazo/tests/before-content-conditional/output.html b/src/diazo/tests/before-content-conditional/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/before-content-conditional/output.html\nrename to src/diazo/tests/before-content-conditional/output.html\ndiff --git a/lib/diazo/tests/before-content-conditional/rules.xml b/src/diazo/tests/before-content-conditional/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/before-content-conditional/rules.xml\nrename to src/diazo/tests/before-content-conditional/rules.xml\ndiff --git a/lib/diazo/tests/before-content-conditional/theme.html b/src/diazo/tests/before-content-conditional/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/before-content-conditional/theme.html\nrename to src/diazo/tests/before-content-conditional/theme.html\ndiff --git a/lib/diazo/tests/before-prepend-append-after/content.html b/src/diazo/tests/before-prepend-append-after/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/before-prepend-append-after/content.html\nrename to src/diazo/tests/before-prepend-append-after/content.html\ndiff --git a/lib/diazo/tests/before-prepend-append-after/output.html b/src/diazo/tests/before-prepend-append-after/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/before-prepend-append-after/output.html\nrename to src/diazo/tests/before-prepend-append-after/output.html\ndiff --git a/lib/diazo/tests/before-prepend-append-after/rules.xml b/src/diazo/tests/before-prepend-append-after/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/before-prepend-append-after/rules.xml\nrename to src/diazo/tests/before-prepend-append-after/rules.xml\ndiff --git a/lib/diazo/tests/before-prepend-append-after/theme.html b/src/diazo/tests/before-prepend-append-after/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/before-prepend-append-after/theme.html\nrename to src/diazo/tests/before-prepend-append-after/theme.html\ndiff --git a/lib/diazo/tests/comments-outside-root-tag/content.html b/src/diazo/tests/comments-outside-root-tag/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/comments-outside-root-tag/content.html\nrename to src/diazo/tests/comments-outside-root-tag/content.html\ndiff --git a/lib/diazo/tests/comments-outside-root-tag/output.html b/src/diazo/tests/comments-outside-root-tag/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/comments-outside-root-tag/output.html\nrename to src/diazo/tests/comments-outside-root-tag/output.html\ndiff --git a/lib/diazo/tests/comments-outside-root-tag/rules.xml b/src/diazo/tests/comments-outside-root-tag/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/comments-outside-root-tag/rules.xml\nrename to src/diazo/tests/comments-outside-root-tag/rules.xml\ndiff --git a/lib/diazo/tests/comments-outside-root-tag/theme.html b/src/diazo/tests/comments-outside-root-tag/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/comments-outside-root-tag/theme.html\nrename to src/diazo/tests/comments-outside-root-tag/theme.html\ndiff --git a/lib/diazo/tests/comments/content.html b/src/diazo/tests/comments/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/comments/content.html\nrename to src/diazo/tests/comments/content.html\ndiff --git a/lib/diazo/tests/comments/output.html b/src/diazo/tests/comments/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/comments/output.html\nrename to src/diazo/tests/comments/output.html\ndiff --git a/lib/diazo/tests/comments/rules.xml b/src/diazo/tests/comments/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/comments/rules.xml\nrename to src/diazo/tests/comments/rules.xml\ndiff --git a/lib/diazo/tests/comments/theme.html b/src/diazo/tests/comments/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/comments/theme.html\nrename to src/diazo/tests/comments/theme.html\ndiff --git a/lib/diazo/tests/comments/xpaths.txt b/src/diazo/tests/comments/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/comments/xpaths.txt\nrename to src/diazo/tests/comments/xpaths.txt\ndiff --git a/lib/diazo/tests/conditional-content-rules-with-variable/content.html b/src/diazo/tests/conditional-content-rules-with-variable/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-content-rules-with-variable/content.html\nrename to src/diazo/tests/conditional-content-rules-with-variable/content.html\ndiff --git a/lib/diazo/tests/conditional-content-rules-with-variable/output.html b/src/diazo/tests/conditional-content-rules-with-variable/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-content-rules-with-variable/output.html\nrename to src/diazo/tests/conditional-content-rules-with-variable/output.html\ndiff --git a/lib/diazo/tests/conditional-content-rules-with-variable/rules.xml b/src/diazo/tests/conditional-content-rules-with-variable/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-content-rules-with-variable/rules.xml\nrename to src/diazo/tests/conditional-content-rules-with-variable/rules.xml\ndiff --git a/lib/diazo/tests/conditional-content-rules-with-variable/theme.html b/src/diazo/tests/conditional-content-rules-with-variable/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-content-rules-with-variable/theme.html\nrename to src/diazo/tests/conditional-content-rules-with-variable/theme.html\ndiff --git a/lib/diazo/tests/conditional-drop-in-append-1/content.html b/src/diazo/tests/conditional-drop-in-append-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-drop-in-append-1/content.html\nrename to src/diazo/tests/conditional-drop-in-append-1/content.html\ndiff --git a/lib/diazo/tests/conditional-drop-in-append-1/output.html b/src/diazo/tests/conditional-drop-in-append-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-drop-in-append-1/output.html\nrename to src/diazo/tests/conditional-drop-in-append-1/output.html\ndiff --git a/lib/diazo/tests/conditional-drop-in-append-1/rules.xml b/src/diazo/tests/conditional-drop-in-append-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-drop-in-append-1/rules.xml\nrename to src/diazo/tests/conditional-drop-in-append-1/rules.xml\ndiff --git a/lib/diazo/tests/conditional-drop-in-append-1/theme.html b/src/diazo/tests/conditional-drop-in-append-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-drop-in-append-1/theme.html\nrename to src/diazo/tests/conditional-drop-in-append-1/theme.html\ndiff --git a/lib/diazo/tests/conditional-drop-in-append-2/content.html b/src/diazo/tests/conditional-drop-in-append-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-drop-in-append-2/content.html\nrename to src/diazo/tests/conditional-drop-in-append-2/content.html\ndiff --git a/lib/diazo/tests/conditional-drop-in-append-2/output.html b/src/diazo/tests/conditional-drop-in-append-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-drop-in-append-2/output.html\nrename to src/diazo/tests/conditional-drop-in-append-2/output.html\ndiff --git a/lib/diazo/tests/conditional-drop-in-append-2/rules.xml b/src/diazo/tests/conditional-drop-in-append-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-drop-in-append-2/rules.xml\nrename to src/diazo/tests/conditional-drop-in-append-2/rules.xml\ndiff --git a/lib/diazo/tests/conditional-drop-in-append-2/theme.html b/src/diazo/tests/conditional-drop-in-append-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-drop-in-append-2/theme.html\nrename to src/diazo/tests/conditional-drop-in-append-2/theme.html\ndiff --git a/lib/diazo/tests/conditional-include-content/content.html b/src/diazo/tests/conditional-include-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-include-content/content.html\nrename to src/diazo/tests/conditional-include-content/content.html\ndiff --git a/lib/diazo/tests/conditional-include-content/output.html b/src/diazo/tests/conditional-include-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-include-content/output.html\nrename to src/diazo/tests/conditional-include-content/output.html\ndiff --git a/lib/diazo/tests/conditional-include-content/rules.xml b/src/diazo/tests/conditional-include-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-include-content/rules.xml\nrename to src/diazo/tests/conditional-include-content/rules.xml\ndiff --git a/lib/diazo/tests/conditional-include-content/theme.html b/src/diazo/tests/conditional-include-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-include-content/theme.html\nrename to src/diazo/tests/conditional-include-content/theme.html\ndiff --git a/lib/diazo/tests/conditional-rules-1/content.html b/src/diazo/tests/conditional-rules-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-1/content.html\nrename to src/diazo/tests/conditional-rules-1/content.html\ndiff --git a/lib/diazo/tests/conditional-rules-1/output.html b/src/diazo/tests/conditional-rules-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-1/output.html\nrename to src/diazo/tests/conditional-rules-1/output.html\ndiff --git a/lib/diazo/tests/conditional-rules-1/rules.xml b/src/diazo/tests/conditional-rules-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-1/rules.xml\nrename to src/diazo/tests/conditional-rules-1/rules.xml\ndiff --git a/lib/diazo/tests/conditional-rules-1/theme.html b/src/diazo/tests/conditional-rules-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-1/theme.html\nrename to src/diazo/tests/conditional-rules-1/theme.html\ndiff --git a/lib/diazo/tests/conditional-rules-1/xpaths.txt b/src/diazo/tests/conditional-rules-1/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-1/xpaths.txt\nrename to src/diazo/tests/conditional-rules-1/xpaths.txt\ndiff --git a/lib/diazo/tests/conditional-rules-2/content.html b/src/diazo/tests/conditional-rules-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-2/content.html\nrename to src/diazo/tests/conditional-rules-2/content.html\ndiff --git a/lib/diazo/tests/conditional-rules-2/output.html b/src/diazo/tests/conditional-rules-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-2/output.html\nrename to src/diazo/tests/conditional-rules-2/output.html\ndiff --git a/lib/diazo/tests/conditional-rules-2/rules.xml b/src/diazo/tests/conditional-rules-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-2/rules.xml\nrename to src/diazo/tests/conditional-rules-2/rules.xml\ndiff --git a/lib/diazo/tests/conditional-rules-2/theme.html b/src/diazo/tests/conditional-rules-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-2/theme.html\nrename to src/diazo/tests/conditional-rules-2/theme.html\ndiff --git a/lib/diazo/tests/conditional-rules-2/xpaths.txt b/src/diazo/tests/conditional-rules-2/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-2/xpaths.txt\nrename to src/diazo/tests/conditional-rules-2/xpaths.txt\ndiff --git a/lib/diazo/tests/copy-xsl/content.html b/src/diazo/tests/copy-xsl/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/copy-xsl/content.html\nrename to src/diazo/tests/copy-xsl/content.html\ndiff --git a/lib/diazo/tests/copy-xsl/output.html b/src/diazo/tests/copy-xsl/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/copy-xsl/output.html\nrename to src/diazo/tests/copy-xsl/output.html\ndiff --git a/lib/diazo/tests/copy-xsl/rules.xml b/src/diazo/tests/copy-xsl/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/copy-xsl/rules.xml\nrename to src/diazo/tests/copy-xsl/rules.xml\ndiff --git a/lib/diazo/tests/copy-xsl/theme.html b/src/diazo/tests/copy-xsl/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/copy-xsl/theme.html\nrename to src/diazo/tests/copy-xsl/theme.html\ndiff --git a/lib/diazo/tests/copy/README.rst b/src/diazo/tests/copy/README.rst\nsimilarity index 100%\nrename from lib/diazo/tests/copy/README.rst\nrename to src/diazo/tests/copy/README.rst\ndiff --git a/lib/diazo/tests/copy/content.html b/src/diazo/tests/copy/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/copy/content.html\nrename to src/diazo/tests/copy/content.html\ndiff --git a/lib/diazo/tests/copy/output.html b/src/diazo/tests/copy/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/copy/output.html\nrename to src/diazo/tests/copy/output.html\ndiff --git a/lib/diazo/tests/copy/rules.xml b/src/diazo/tests/copy/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/copy/rules.xml\nrename to src/diazo/tests/copy/rules.xml\ndiff --git a/lib/diazo/tests/copy/theme.html b/src/diazo/tests/copy/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/copy/theme.html\nrename to src/diazo/tests/copy/theme.html\ndiff --git a/lib/diazo/tests/copy/xpaths.txt b/src/diazo/tests/copy/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/copy/xpaths.txt\nrename to src/diazo/tests/copy/xpaths.txt\ndiff --git a/lib/diazo/tests/css-prefix/content.html b/src/diazo/tests/css-prefix/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/css-prefix/content.html\nrename to src/diazo/tests/css-prefix/content.html\ndiff --git a/lib/diazo/tests/css-prefix/output.html b/src/diazo/tests/css-prefix/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/css-prefix/output.html\nrename to src/diazo/tests/css-prefix/output.html\ndiff --git a/lib/diazo/tests/css-prefix/rules.xml b/src/diazo/tests/css-prefix/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/css-prefix/rules.xml\nrename to src/diazo/tests/css-prefix/rules.xml\ndiff --git a/lib/diazo/tests/css-prefix/theme.html b/src/diazo/tests/css-prefix/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/css-prefix/theme.html\nrename to src/diazo/tests/css-prefix/theme.html\ndiff --git a/lib/diazo/tests/css-xpath-child-selectors/content.html b/src/diazo/tests/css-xpath-child-selectors/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/css-xpath-child-selectors/content.html\nrename to src/diazo/tests/css-xpath-child-selectors/content.html\ndiff --git a/lib/diazo/tests/css-xpath-child-selectors/output.html b/src/diazo/tests/css-xpath-child-selectors/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/css-xpath-child-selectors/output.html\nrename to src/diazo/tests/css-xpath-child-selectors/output.html\ndiff --git a/lib/diazo/tests/css-xpath-child-selectors/rules.xml b/src/diazo/tests/css-xpath-child-selectors/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/css-xpath-child-selectors/rules.xml\nrename to src/diazo/tests/css-xpath-child-selectors/rules.xml\ndiff --git a/lib/diazo/tests/css-xpath-child-selectors/theme.html b/src/diazo/tests/css-xpath-child-selectors/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/css-xpath-child-selectors/theme.html\nrename to src/diazo/tests/css-xpath-child-selectors/theme.html\ndiff --git a/lib/diazo/tests/css-xsl-template/content.html b/src/diazo/tests/css-xsl-template/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/css-xsl-template/content.html\nrename to src/diazo/tests/css-xsl-template/content.html\ndiff --git a/lib/diazo/tests/css-xsl-template/output.html b/src/diazo/tests/css-xsl-template/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/css-xsl-template/output.html\nrename to src/diazo/tests/css-xsl-template/output.html\ndiff --git a/lib/diazo/tests/css-xsl-template/rules.xml b/src/diazo/tests/css-xsl-template/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/css-xsl-template/rules.xml\nrename to src/diazo/tests/css-xsl-template/rules.xml\ndiff --git a/lib/diazo/tests/css-xsl-template/theme.html b/src/diazo/tests/css-xsl-template/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/css-xsl-template/theme.html\nrename to src/diazo/tests/css-xsl-template/theme.html\ndiff --git a/lib/diazo/tests/default-options.cfg b/src/diazo/tests/default-options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/default-options.cfg\nrename to src/diazo/tests/default-options.cfg\ndiff --git a/lib/diazo/tests/document-includes/content.html b/src/diazo/tests/document-includes/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/document-includes/content.html\nrename to src/diazo/tests/document-includes/content.html\ndiff --git a/lib/diazo/tests/document-includes/extra.html b/src/diazo/tests/document-includes/extra.html\nsimilarity index 100%\nrename from lib/diazo/tests/document-includes/extra.html\nrename to src/diazo/tests/document-includes/extra.html\ndiff --git a/lib/diazo/tests/document-includes/output.html b/src/diazo/tests/document-includes/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/document-includes/output.html\nrename to src/diazo/tests/document-includes/output.html\ndiff --git a/lib/diazo/tests/document-includes/rules.xml b/src/diazo/tests/document-includes/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/document-includes/rules.xml\nrename to src/diazo/tests/document-includes/rules.xml\ndiff --git a/lib/diazo/tests/document-includes/theme.html b/src/diazo/tests/document-includes/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/document-includes/theme.html\nrename to src/diazo/tests/document-includes/theme.html\ndiff --git a/lib/diazo/tests/document-includes/xpaths.txt b/src/diazo/tests/document-includes/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/document-includes/xpaths.txt\nrename to src/diazo/tests/document-includes/xpaths.txt\ndiff --git a/lib/diazo/tests/drop-content-comment/content.html b/src/diazo/tests/drop-content-comment/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content-comment/content.html\nrename to src/diazo/tests/drop-content-comment/content.html\ndiff --git a/lib/diazo/tests/drop-content-comment/output.html b/src/diazo/tests/drop-content-comment/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content-comment/output.html\nrename to src/diazo/tests/drop-content-comment/output.html\ndiff --git a/lib/diazo/tests/drop-content-comment/rules.xml b/src/diazo/tests/drop-content-comment/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content-comment/rules.xml\nrename to src/diazo/tests/drop-content-comment/rules.xml\ndiff --git a/lib/diazo/tests/drop-content-comment/theme.html b/src/diazo/tests/drop-content-comment/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content-comment/theme.html\nrename to src/diazo/tests/drop-content-comment/theme.html\ndiff --git a/lib/diazo/tests/drop-content/content.html b/src/diazo/tests/drop-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content/content.html\nrename to src/diazo/tests/drop-content/content.html\ndiff --git a/lib/diazo/tests/drop-content/output.html b/src/diazo/tests/drop-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content/output.html\nrename to src/diazo/tests/drop-content/output.html\ndiff --git a/lib/diazo/tests/drop-content/rules.xml b/src/diazo/tests/drop-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content/rules.xml\nrename to src/diazo/tests/drop-content/rules.xml\ndiff --git a/lib/diazo/tests/drop-content/theme.html b/src/diazo/tests/drop-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content/theme.html\nrename to src/diazo/tests/drop-content/theme.html\ndiff --git a/lib/diazo/tests/drop-content/xpaths.txt b/src/diazo/tests/drop-content/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content/xpaths.txt\nrename to src/diazo/tests/drop-content/xpaths.txt\ndiff --git a/lib/diazo/tests/drop-replace/content.html b/src/diazo/tests/drop-replace/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-replace/content.html\nrename to src/diazo/tests/drop-replace/content.html\ndiff --git a/lib/diazo/tests/drop-replace/output.html b/src/diazo/tests/drop-replace/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-replace/output.html\nrename to src/diazo/tests/drop-replace/output.html\ndiff --git a/lib/diazo/tests/drop-replace/rules.xml b/src/diazo/tests/drop-replace/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/drop-replace/rules.xml\nrename to src/diazo/tests/drop-replace/rules.xml\ndiff --git a/lib/diazo/tests/drop-replace/theme.html b/src/diazo/tests/drop-replace/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-replace/theme.html\nrename to src/diazo/tests/drop-replace/theme.html\ndiff --git a/lib/diazo/tests/drop-theme-children/content.html b/src/diazo/tests/drop-theme-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-theme-children/content.html\nrename to src/diazo/tests/drop-theme-children/content.html\ndiff --git a/lib/diazo/tests/drop-theme-children/output.html b/src/diazo/tests/drop-theme-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-theme-children/output.html\nrename to src/diazo/tests/drop-theme-children/output.html\ndiff --git a/lib/diazo/tests/drop-theme-children/rules.xml b/src/diazo/tests/drop-theme-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/drop-theme-children/rules.xml\nrename to src/diazo/tests/drop-theme-children/rules.xml\ndiff --git a/lib/diazo/tests/drop-theme-children/theme.html b/src/diazo/tests/drop-theme-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-theme-children/theme.html\nrename to src/diazo/tests/drop-theme-children/theme.html\ndiff --git a/lib/diazo/tests/drop-theme-comment/content.html b/src/diazo/tests/drop-theme-comment/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-theme-comment/content.html\nrename to src/diazo/tests/drop-theme-comment/content.html\ndiff --git a/lib/diazo/tests/drop-theme-comment/output.html b/src/diazo/tests/drop-theme-comment/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-theme-comment/output.html\nrename to src/diazo/tests/drop-theme-comment/output.html\ndiff --git a/lib/diazo/tests/drop-theme-comment/rules.xml b/src/diazo/tests/drop-theme-comment/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/drop-theme-comment/rules.xml\nrename to src/diazo/tests/drop-theme-comment/rules.xml\ndiff --git a/lib/diazo/tests/drop-theme-comment/theme.html b/src/diazo/tests/drop-theme-comment/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-theme-comment/theme.html\nrename to src/diazo/tests/drop-theme-comment/theme.html\ndiff --git a/lib/diazo/tests/empty-xmlns/README.txt b/src/diazo/tests/empty-xmlns/README.txt\nsimilarity index 100%\nrename from lib/diazo/tests/empty-xmlns/README.txt\nrename to src/diazo/tests/empty-xmlns/README.txt\ndiff --git a/lib/diazo/tests/empty-xmlns/content.html b/src/diazo/tests/empty-xmlns/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/empty-xmlns/content.html\nrename to src/diazo/tests/empty-xmlns/content.html\ndiff --git a/lib/diazo/tests/empty-xmlns/output.html b/src/diazo/tests/empty-xmlns/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/empty-xmlns/output.html\nrename to src/diazo/tests/empty-xmlns/output.html\ndiff --git a/lib/diazo/tests/empty-xmlns/rules.xml b/src/diazo/tests/empty-xmlns/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/empty-xmlns/rules.xml\nrename to src/diazo/tests/empty-xmlns/rules.xml\ndiff --git a/lib/diazo/tests/empty-xmlns/theme.html b/src/diazo/tests/empty-xmlns/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/empty-xmlns/theme.html\nrename to src/diazo/tests/empty-xmlns/theme.html\ndiff --git a/lib/diazo/tests/entities/content.html b/src/diazo/tests/entities/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/entities/content.html\nrename to src/diazo/tests/entities/content.html\ndiff --git a/lib/diazo/tests/entities/output.html b/src/diazo/tests/entities/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/entities/output.html\nrename to src/diazo/tests/entities/output.html\ndiff --git a/lib/diazo/tests/entities/rules.xml b/src/diazo/tests/entities/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/entities/rules.xml\nrename to src/diazo/tests/entities/rules.xml\ndiff --git a/lib/diazo/tests/entities/theme.html b/src/diazo/tests/entities/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/entities/theme.html\nrename to src/diazo/tests/entities/theme.html\ndiff --git a/lib/diazo/tests/esi/content.html b/src/diazo/tests/esi/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/esi/content.html\nrename to src/diazo/tests/esi/content.html\ndiff --git a/lib/diazo/tests/esi/output.html b/src/diazo/tests/esi/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/esi/output.html\nrename to src/diazo/tests/esi/output.html\ndiff --git a/lib/diazo/tests/esi/rules.xml b/src/diazo/tests/esi/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/esi/rules.xml\nrename to src/diazo/tests/esi/rules.xml\ndiff --git a/lib/diazo/tests/esi/theme.html b/src/diazo/tests/esi/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/esi/theme.html\nrename to src/diazo/tests/esi/theme.html\ndiff --git a/lib/diazo/tests/esi/xpaths.txt b/src/diazo/tests/esi/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/esi/xpaths.txt\nrename to src/diazo/tests/esi/xpaths.txt\ndiff --git a/lib/diazo/tests/html-attributes/content.html b/src/diazo/tests/html-attributes/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-attributes/content.html\nrename to src/diazo/tests/html-attributes/content.html\ndiff --git a/lib/diazo/tests/html-attributes/output.html b/src/diazo/tests/html-attributes/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-attributes/output.html\nrename to src/diazo/tests/html-attributes/output.html\ndiff --git a/lib/diazo/tests/html-attributes/rules.xml b/src/diazo/tests/html-attributes/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/html-attributes/rules.xml\nrename to src/diazo/tests/html-attributes/rules.xml\ndiff --git a/lib/diazo/tests/html-attributes/theme.html b/src/diazo/tests/html-attributes/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-attributes/theme.html\nrename to src/diazo/tests/html-attributes/theme.html\ndiff --git a/lib/diazo/tests/html-xml-lang-2/content.html b/src/diazo/tests/html-xml-lang-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang-2/content.html\nrename to src/diazo/tests/html-xml-lang-2/content.html\ndiff --git a/lib/diazo/tests/html-xml-lang-2/output.html b/src/diazo/tests/html-xml-lang-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang-2/output.html\nrename to src/diazo/tests/html-xml-lang-2/output.html\ndiff --git a/lib/diazo/tests/html-xml-lang-2/rules.xml b/src/diazo/tests/html-xml-lang-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang-2/rules.xml\nrename to src/diazo/tests/html-xml-lang-2/rules.xml\ndiff --git a/lib/diazo/tests/html-xml-lang-2/theme.html b/src/diazo/tests/html-xml-lang-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang-2/theme.html\nrename to src/diazo/tests/html-xml-lang-2/theme.html\ndiff --git a/lib/diazo/tests/html-xml-lang-3/content.html b/src/diazo/tests/html-xml-lang-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang-3/content.html\nrename to src/diazo/tests/html-xml-lang-3/content.html\ndiff --git a/lib/diazo/tests/html-xml-lang-3/output.html b/src/diazo/tests/html-xml-lang-3/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang-3/output.html\nrename to src/diazo/tests/html-xml-lang-3/output.html\ndiff --git a/lib/diazo/tests/html-xml-lang-3/rules.xml b/src/diazo/tests/html-xml-lang-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang-3/rules.xml\nrename to src/diazo/tests/html-xml-lang-3/rules.xml\ndiff --git a/lib/diazo/tests/html-xml-lang-3/theme.html b/src/diazo/tests/html-xml-lang-3/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang-3/theme.html\nrename to src/diazo/tests/html-xml-lang-3/theme.html\ndiff --git a/lib/diazo/tests/html-xml-lang/content.html b/src/diazo/tests/html-xml-lang/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang/content.html\nrename to src/diazo/tests/html-xml-lang/content.html\ndiff --git a/lib/diazo/tests/html-xml-lang/output.html b/src/diazo/tests/html-xml-lang/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang/output.html\nrename to src/diazo/tests/html-xml-lang/output.html\ndiff --git a/lib/diazo/tests/html-xml-lang/rules.xml b/src/diazo/tests/html-xml-lang/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang/rules.xml\nrename to src/diazo/tests/html-xml-lang/rules.xml\ndiff --git a/lib/diazo/tests/html-xml-lang/theme.html b/src/diazo/tests/html-xml-lang/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang/theme.html\nrename to src/diazo/tests/html-xml-lang/theme.html\ndiff --git a/lib/diazo/tests/if-path-1/content.html b/src/diazo/tests/if-path-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-1/content.html\nrename to src/diazo/tests/if-path-1/content.html\ndiff --git a/lib/diazo/tests/if-path-1/options.cfg b/src/diazo/tests/if-path-1/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-1/options.cfg\nrename to src/diazo/tests/if-path-1/options.cfg\ndiff --git a/lib/diazo/tests/if-path-1/output.html b/src/diazo/tests/if-path-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-1/output.html\nrename to src/diazo/tests/if-path-1/output.html\ndiff --git a/lib/diazo/tests/if-path-1/rules.xml b/src/diazo/tests/if-path-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-1/rules.xml\nrename to src/diazo/tests/if-path-1/rules.xml\ndiff --git a/lib/diazo/tests/if-path-1/theme.html b/src/diazo/tests/if-path-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-1/theme.html\nrename to src/diazo/tests/if-path-1/theme.html\ndiff --git a/lib/diazo/tests/if-path-2/content.html b/src/diazo/tests/if-path-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-2/content.html\nrename to src/diazo/tests/if-path-2/content.html\ndiff --git a/lib/diazo/tests/if-path-2/options.cfg b/src/diazo/tests/if-path-2/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-2/options.cfg\nrename to src/diazo/tests/if-path-2/options.cfg\ndiff --git a/lib/diazo/tests/if-path-2/output.html b/src/diazo/tests/if-path-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-2/output.html\nrename to src/diazo/tests/if-path-2/output.html\ndiff --git a/lib/diazo/tests/if-path-2/rules.xml b/src/diazo/tests/if-path-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-2/rules.xml\nrename to src/diazo/tests/if-path-2/rules.xml\ndiff --git a/lib/diazo/tests/if-path-2/theme.html b/src/diazo/tests/if-path-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-2/theme.html\nrename to src/diazo/tests/if-path-2/theme.html\ndiff --git a/lib/diazo/tests/if-path-3/content.html b/src/diazo/tests/if-path-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-3/content.html\nrename to src/diazo/tests/if-path-3/content.html\ndiff --git a/lib/diazo/tests/if-path-3/options.cfg b/src/diazo/tests/if-path-3/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-3/options.cfg\nrename to src/diazo/tests/if-path-3/options.cfg\ndiff --git a/lib/diazo/tests/if-path-3/output.html b/src/diazo/tests/if-path-3/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-3/output.html\nrename to src/diazo/tests/if-path-3/output.html\ndiff --git a/lib/diazo/tests/if-path-3/rules.xml b/src/diazo/tests/if-path-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-3/rules.xml\nrename to src/diazo/tests/if-path-3/rules.xml\ndiff --git a/lib/diazo/tests/if-path-3/theme.html b/src/diazo/tests/if-path-3/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-3/theme.html\nrename to src/diazo/tests/if-path-3/theme.html\ndiff --git a/lib/diazo/tests/if-path-4/content.html b/src/diazo/tests/if-path-4/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-4/content.html\nrename to src/diazo/tests/if-path-4/content.html\ndiff --git a/lib/diazo/tests/if-path-4/options.cfg b/src/diazo/tests/if-path-4/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-4/options.cfg\nrename to src/diazo/tests/if-path-4/options.cfg\ndiff --git a/lib/diazo/tests/if-path-4/output.html b/src/diazo/tests/if-path-4/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-4/output.html\nrename to src/diazo/tests/if-path-4/output.html\ndiff --git a/lib/diazo/tests/if-path-4/rules.xml b/src/diazo/tests/if-path-4/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-4/rules.xml\nrename to src/diazo/tests/if-path-4/rules.xml\ndiff --git a/lib/diazo/tests/if-path-4/theme.html b/src/diazo/tests/if-path-4/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-4/theme.html\nrename to src/diazo/tests/if-path-4/theme.html\ndiff --git a/lib/diazo/tests/if-path-5/content.html b/src/diazo/tests/if-path-5/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-5/content.html\nrename to src/diazo/tests/if-path-5/content.html\ndiff --git a/lib/diazo/tests/if-path-5/options.cfg b/src/diazo/tests/if-path-5/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-5/options.cfg\nrename to src/diazo/tests/if-path-5/options.cfg\ndiff --git a/lib/diazo/tests/if-path-5/output.html b/src/diazo/tests/if-path-5/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-5/output.html\nrename to src/diazo/tests/if-path-5/output.html\ndiff --git a/lib/diazo/tests/if-path-5/rules.xml b/src/diazo/tests/if-path-5/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-5/rules.xml\nrename to src/diazo/tests/if-path-5/rules.xml\ndiff --git a/lib/diazo/tests/if-path-5/theme.html b/src/diazo/tests/if-path-5/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-5/theme.html\nrename to src/diazo/tests/if-path-5/theme.html\ndiff --git a/lib/diazo/tests/if-path-6/content.html b/src/diazo/tests/if-path-6/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-6/content.html\nrename to src/diazo/tests/if-path-6/content.html\ndiff --git a/lib/diazo/tests/if-path-6/options.cfg b/src/diazo/tests/if-path-6/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-6/options.cfg\nrename to src/diazo/tests/if-path-6/options.cfg\ndiff --git a/lib/diazo/tests/if-path-6/output.html b/src/diazo/tests/if-path-6/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-6/output.html\nrename to src/diazo/tests/if-path-6/output.html\ndiff --git a/lib/diazo/tests/if-path-6/rules.xml b/src/diazo/tests/if-path-6/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-6/rules.xml\nrename to src/diazo/tests/if-path-6/rules.xml\ndiff --git a/lib/diazo/tests/if-path-6/theme.html b/src/diazo/tests/if-path-6/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-6/theme.html\nrename to src/diazo/tests/if-path-6/theme.html\ndiff --git a/lib/diazo/tests/if-path-7/content.html b/src/diazo/tests/if-path-7/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-7/content.html\nrename to src/diazo/tests/if-path-7/content.html\ndiff --git a/lib/diazo/tests/if-path-7/options.cfg b/src/diazo/tests/if-path-7/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-7/options.cfg\nrename to src/diazo/tests/if-path-7/options.cfg\ndiff --git a/lib/diazo/tests/if-path-7/output.html b/src/diazo/tests/if-path-7/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-7/output.html\nrename to src/diazo/tests/if-path-7/output.html\ndiff --git a/lib/diazo/tests/if-path-7/rules.xml b/src/diazo/tests/if-path-7/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-7/rules.xml\nrename to src/diazo/tests/if-path-7/rules.xml\ndiff --git a/lib/diazo/tests/if-path-7/theme.html b/src/diazo/tests/if-path-7/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-7/theme.html\nrename to src/diazo/tests/if-path-7/theme.html\ndiff --git a/lib/diazo/tests/if-path-8/content.html b/src/diazo/tests/if-path-8/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-8/content.html\nrename to src/diazo/tests/if-path-8/content.html\ndiff --git a/lib/diazo/tests/if-path-8/options.cfg b/src/diazo/tests/if-path-8/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-8/options.cfg\nrename to src/diazo/tests/if-path-8/options.cfg\ndiff --git a/lib/diazo/tests/if-path-8/output.html b/src/diazo/tests/if-path-8/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-8/output.html\nrename to src/diazo/tests/if-path-8/output.html\ndiff --git a/lib/diazo/tests/if-path-8/rules.xml b/src/diazo/tests/if-path-8/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-8/rules.xml\nrename to src/diazo/tests/if-path-8/rules.xml\ndiff --git a/lib/diazo/tests/if-path-8/theme.html b/src/diazo/tests/if-path-8/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-8/theme.html\nrename to src/diazo/tests/if-path-8/theme.html\ndiff --git a/lib/diazo/tests/include-content/content.html b/src/diazo/tests/include-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/include-content/content.html\nrename to src/diazo/tests/include-content/content.html\ndiff --git a/lib/diazo/tests/include-content/extra.html b/src/diazo/tests/include-content/extra.html\nsimilarity index 100%\nrename from lib/diazo/tests/include-content/extra.html\nrename to src/diazo/tests/include-content/extra.html\ndiff --git a/lib/diazo/tests/include-content/output.html b/src/diazo/tests/include-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/include-content/output.html\nrename to src/diazo/tests/include-content/output.html\ndiff --git a/lib/diazo/tests/include-content/rules.xml b/src/diazo/tests/include-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/include-content/rules.xml\nrename to src/diazo/tests/include-content/rules.xml\ndiff --git a/lib/diazo/tests/include-content/theme.html b/src/diazo/tests/include-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/include-content/theme.html\nrename to src/diazo/tests/include-content/theme.html\ndiff --git a/lib/diazo/tests/indent-off/content.html b/src/diazo/tests/indent-off/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/indent-off/content.html\nrename to src/diazo/tests/indent-off/content.html\ndiff --git a/lib/diazo/tests/indent-off/options.cfg b/src/diazo/tests/indent-off/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/indent-off/options.cfg\nrename to src/diazo/tests/indent-off/options.cfg\ndiff --git a/lib/diazo/tests/indent-off/output.html b/src/diazo/tests/indent-off/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/indent-off/output.html\nrename to src/diazo/tests/indent-off/output.html\ndiff --git a/lib/diazo/tests/indent-off/rules.xml b/src/diazo/tests/indent-off/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/indent-off/rules.xml\nrename to src/diazo/tests/indent-off/rules.xml\ndiff --git a/lib/diazo/tests/indent-off/theme.html b/src/diazo/tests/indent-off/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/indent-off/theme.html\nrename to src/diazo/tests/indent-off/theme.html\ndiff --git a/lib/diazo/tests/inline-xsl-apply-templates/content.html b/src/diazo/tests/inline-xsl-apply-templates/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/inline-xsl-apply-templates/content.html\nrename to src/diazo/tests/inline-xsl-apply-templates/content.html\ndiff --git a/lib/diazo/tests/inline-xsl-apply-templates/output.html b/src/diazo/tests/inline-xsl-apply-templates/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/inline-xsl-apply-templates/output.html\nrename to src/diazo/tests/inline-xsl-apply-templates/output.html\ndiff --git a/lib/diazo/tests/inline-xsl-apply-templates/rules.xml b/src/diazo/tests/inline-xsl-apply-templates/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/inline-xsl-apply-templates/rules.xml\nrename to src/diazo/tests/inline-xsl-apply-templates/rules.xml\ndiff --git a/lib/diazo/tests/inline-xsl-apply-templates/theme.html b/src/diazo/tests/inline-xsl-apply-templates/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/inline-xsl-apply-templates/theme.html\nrename to src/diazo/tests/inline-xsl-apply-templates/theme.html\ndiff --git a/lib/diazo/tests/inline-xsl-directives/content.html b/src/diazo/tests/inline-xsl-directives/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/inline-xsl-directives/content.html\nrename to src/diazo/tests/inline-xsl-directives/content.html\ndiff --git a/lib/diazo/tests/inline-xsl-directives/output.html b/src/diazo/tests/inline-xsl-directives/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/inline-xsl-directives/output.html\nrename to src/diazo/tests/inline-xsl-directives/output.html\ndiff --git a/lib/diazo/tests/inline-xsl-directives/rules.xml b/src/diazo/tests/inline-xsl-directives/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/inline-xsl-directives/rules.xml\nrename to src/diazo/tests/inline-xsl-directives/rules.xml\ndiff --git a/lib/diazo/tests/inline-xsl-directives/theme.html b/src/diazo/tests/inline-xsl-directives/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/inline-xsl-directives/theme.html\nrename to src/diazo/tests/inline-xsl-directives/theme.html\ndiff --git a/lib/diazo/tests/modify-theme/content.html b/src/diazo/tests/modify-theme/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/modify-theme/content.html\nrename to src/diazo/tests/modify-theme/content.html\ndiff --git a/lib/diazo/tests/modify-theme/output.html b/src/diazo/tests/modify-theme/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/modify-theme/output.html\nrename to src/diazo/tests/modify-theme/output.html\ndiff --git a/lib/diazo/tests/modify-theme/rules.xml b/src/diazo/tests/modify-theme/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/modify-theme/rules.xml\nrename to src/diazo/tests/modify-theme/rules.xml\ndiff --git a/lib/diazo/tests/modify-theme/theme.html b/src/diazo/tests/modify-theme/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/modify-theme/theme.html\nrename to src/diazo/tests/modify-theme/theme.html\ndiff --git a/lib/diazo/tests/modify-theme/xpaths.txt b/src/diazo/tests/modify-theme/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/modify-theme/xpaths.txt\nrename to src/diazo/tests/modify-theme/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-copy-1/content.html b/src/diazo/tests/multi-copy-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-1/content.html\nrename to src/diazo/tests/multi-copy-1/content.html\ndiff --git a/lib/diazo/tests/multi-copy-1/rules.xml b/src/diazo/tests/multi-copy-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-1/rules.xml\nrename to src/diazo/tests/multi-copy-1/rules.xml\ndiff --git a/lib/diazo/tests/multi-copy-1/theme.html b/src/diazo/tests/multi-copy-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-1/theme.html\nrename to src/diazo/tests/multi-copy-1/theme.html\ndiff --git a/lib/diazo/tests/multi-copy-1/xpaths.txt b/src/diazo/tests/multi-copy-1/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-1/xpaths.txt\nrename to src/diazo/tests/multi-copy-1/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-copy-2/content.html b/src/diazo/tests/multi-copy-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-2/content.html\nrename to src/diazo/tests/multi-copy-2/content.html\ndiff --git a/lib/diazo/tests/multi-copy-2/rules.xml b/src/diazo/tests/multi-copy-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-2/rules.xml\nrename to src/diazo/tests/multi-copy-2/rules.xml\ndiff --git a/lib/diazo/tests/multi-copy-2/theme.html b/src/diazo/tests/multi-copy-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-2/theme.html\nrename to src/diazo/tests/multi-copy-2/theme.html\ndiff --git a/lib/diazo/tests/multi-copy-2/xpaths.txt b/src/diazo/tests/multi-copy-2/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-2/xpaths.txt\nrename to src/diazo/tests/multi-copy-2/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-copy-3/content.html b/src/diazo/tests/multi-copy-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-3/content.html\nrename to src/diazo/tests/multi-copy-3/content.html\ndiff --git a/lib/diazo/tests/multi-copy-3/rules.xml b/src/diazo/tests/multi-copy-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-3/rules.xml\nrename to src/diazo/tests/multi-copy-3/rules.xml\ndiff --git a/lib/diazo/tests/multi-copy-3/theme.html b/src/diazo/tests/multi-copy-3/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-3/theme.html\nrename to src/diazo/tests/multi-copy-3/theme.html\ndiff --git a/lib/diazo/tests/multi-copy-3/xpaths.txt b/src/diazo/tests/multi-copy-3/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-3/xpaths.txt\nrename to src/diazo/tests/multi-copy-3/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-copy-4/content.html b/src/diazo/tests/multi-copy-4/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-4/content.html\nrename to src/diazo/tests/multi-copy-4/content.html\ndiff --git a/lib/diazo/tests/multi-copy-4/rules.xml b/src/diazo/tests/multi-copy-4/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-4/rules.xml\nrename to src/diazo/tests/multi-copy-4/rules.xml\ndiff --git a/lib/diazo/tests/multi-copy-4/theme.html b/src/diazo/tests/multi-copy-4/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-4/theme.html\nrename to src/diazo/tests/multi-copy-4/theme.html\ndiff --git a/lib/diazo/tests/multi-copy-4/xpaths.txt b/src/diazo/tests/multi-copy-4/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-4/xpaths.txt\nrename to src/diazo/tests/multi-copy-4/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-replace-1/content.html b/src/diazo/tests/multi-replace-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-1/content.html\nrename to src/diazo/tests/multi-replace-1/content.html\ndiff --git a/lib/diazo/tests/multi-replace-1/rules.xml b/src/diazo/tests/multi-replace-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-1/rules.xml\nrename to src/diazo/tests/multi-replace-1/rules.xml\ndiff --git a/lib/diazo/tests/multi-replace-1/theme.html b/src/diazo/tests/multi-replace-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-1/theme.html\nrename to src/diazo/tests/multi-replace-1/theme.html\ndiff --git a/lib/diazo/tests/multi-replace-1/xpaths.txt b/src/diazo/tests/multi-replace-1/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-1/xpaths.txt\nrename to src/diazo/tests/multi-replace-1/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-replace-2/content.html b/src/diazo/tests/multi-replace-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-2/content.html\nrename to src/diazo/tests/multi-replace-2/content.html\ndiff --git a/lib/diazo/tests/multi-replace-2/rules.xml b/src/diazo/tests/multi-replace-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-2/rules.xml\nrename to src/diazo/tests/multi-replace-2/rules.xml\ndiff --git a/lib/diazo/tests/multi-replace-2/theme.html b/src/diazo/tests/multi-replace-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-2/theme.html\nrename to src/diazo/tests/multi-replace-2/theme.html\ndiff --git a/lib/diazo/tests/multi-replace-2/xpaths.txt b/src/diazo/tests/multi-replace-2/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-2/xpaths.txt\nrename to src/diazo/tests/multi-replace-2/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-replace-3/content.html b/src/diazo/tests/multi-replace-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-3/content.html\nrename to src/diazo/tests/multi-replace-3/content.html\ndiff --git a/lib/diazo/tests/multi-replace-3/rules.xml b/src/diazo/tests/multi-replace-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-3/rules.xml\nrename to src/diazo/tests/multi-replace-3/rules.xml\ndiff --git a/lib/diazo/tests/multi-replace-3/theme.html b/src/diazo/tests/multi-replace-3/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-3/theme.html\nrename to src/diazo/tests/multi-replace-3/theme.html\ndiff --git a/lib/diazo/tests/multi-replace-3/xpaths.txt b/src/diazo/tests/multi-replace-3/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-3/xpaths.txt\nrename to src/diazo/tests/multi-replace-3/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-replace-4/content.html b/src/diazo/tests/multi-replace-4/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-4/content.html\nrename to src/diazo/tests/multi-replace-4/content.html\ndiff --git a/lib/diazo/tests/multi-replace-4/rules.xml b/src/diazo/tests/multi-replace-4/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-4/rules.xml\nrename to src/diazo/tests/multi-replace-4/rules.xml\ndiff --git a/lib/diazo/tests/multi-replace-4/theme.html b/src/diazo/tests/multi-replace-4/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-4/theme.html\nrename to src/diazo/tests/multi-replace-4/theme.html\ndiff --git a/lib/diazo/tests/multi-replace-4/xpaths.txt b/src/diazo/tests/multi-replace-4/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-4/xpaths.txt\nrename to src/diazo/tests/multi-replace-4/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-theme-1/content.html b/src/diazo/tests/multi-theme-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-1/content.html\nrename to src/diazo/tests/multi-theme-1/content.html\ndiff --git a/lib/diazo/tests/multi-theme-1/options.cfg b/src/diazo/tests/multi-theme-1/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-1/options.cfg\nrename to src/diazo/tests/multi-theme-1/options.cfg\ndiff --git a/lib/diazo/tests/multi-theme-1/output.html b/src/diazo/tests/multi-theme-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-1/output.html\nrename to src/diazo/tests/multi-theme-1/output.html\ndiff --git a/lib/diazo/tests/multi-theme-1/rules.xml b/src/diazo/tests/multi-theme-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-1/rules.xml\nrename to src/diazo/tests/multi-theme-1/rules.xml\ndiff --git a/lib/diazo/tests/multi-theme-1/theme1.html b/src/diazo/tests/multi-theme-1/theme1.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-1/theme1.html\nrename to src/diazo/tests/multi-theme-1/theme1.html\ndiff --git a/lib/diazo/tests/multi-theme-1/theme2.html b/src/diazo/tests/multi-theme-1/theme2.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-1/theme2.html\nrename to src/diazo/tests/multi-theme-1/theme2.html\ndiff --git a/lib/diazo/tests/multi-theme-2/content.html b/src/diazo/tests/multi-theme-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-2/content.html\nrename to src/diazo/tests/multi-theme-2/content.html\ndiff --git a/lib/diazo/tests/multi-theme-2/options.cfg b/src/diazo/tests/multi-theme-2/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-2/options.cfg\nrename to src/diazo/tests/multi-theme-2/options.cfg\ndiff --git a/lib/diazo/tests/multi-theme-2/output.html b/src/diazo/tests/multi-theme-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-2/output.html\nrename to src/diazo/tests/multi-theme-2/output.html\ndiff --git a/lib/diazo/tests/multi-theme-2/rules.xml b/src/diazo/tests/multi-theme-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-2/rules.xml\nrename to src/diazo/tests/multi-theme-2/rules.xml\ndiff --git a/lib/diazo/tests/multi-theme-2/theme1.html b/src/diazo/tests/multi-theme-2/theme1.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-2/theme1.html\nrename to src/diazo/tests/multi-theme-2/theme1.html\ndiff --git a/lib/diazo/tests/multi-theme-2/theme2.html b/src/diazo/tests/multi-theme-2/theme2.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-2/theme2.html\nrename to src/diazo/tests/multi-theme-2/theme2.html\ndiff --git a/lib/diazo/tests/multi-theme-3/content.html b/src/diazo/tests/multi-theme-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-3/content.html\nrename to src/diazo/tests/multi-theme-3/content.html\ndiff --git a/lib/diazo/tests/multi-theme-3/options.cfg b/src/diazo/tests/multi-theme-3/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-3/options.cfg\nrename to src/diazo/tests/multi-theme-3/options.cfg\ndiff --git a/lib/diazo/tests/multi-theme-3/output.html b/src/diazo/tests/multi-theme-3/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-3/output.html\nrename to src/diazo/tests/multi-theme-3/output.html\ndiff --git a/lib/diazo/tests/multi-theme-3/rules.xml b/src/diazo/tests/multi-theme-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-3/rules.xml\nrename to src/diazo/tests/multi-theme-3/rules.xml\ndiff --git a/lib/diazo/tests/multi-theme-3/theme1.html b/src/diazo/tests/multi-theme-3/theme1.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-3/theme1.html\nrename to src/diazo/tests/multi-theme-3/theme1.html\ndiff --git a/lib/diazo/tests/multi-theme-3/theme2.html b/src/diazo/tests/multi-theme-3/theme2.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-3/theme2.html\nrename to src/diazo/tests/multi-theme-3/theme2.html\ndiff --git a/lib/diazo/tests/multi-theme-4/content.html b/src/diazo/tests/multi-theme-4/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-4/content.html\nrename to src/diazo/tests/multi-theme-4/content.html\ndiff --git a/lib/diazo/tests/multi-theme-4/options.cfg b/src/diazo/tests/multi-theme-4/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-4/options.cfg\nrename to src/diazo/tests/multi-theme-4/options.cfg\ndiff --git a/lib/diazo/tests/multi-theme-4/output.html b/src/diazo/tests/multi-theme-4/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-4/output.html\nrename to src/diazo/tests/multi-theme-4/output.html\ndiff --git a/lib/diazo/tests/multi-theme-4/rules.xml b/src/diazo/tests/multi-theme-4/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-4/rules.xml\nrename to src/diazo/tests/multi-theme-4/rules.xml\ndiff --git a/lib/diazo/tests/multi-theme-4/theme1.html b/src/diazo/tests/multi-theme-4/theme1.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-4/theme1.html\nrename to src/diazo/tests/multi-theme-4/theme1.html\ndiff --git a/lib/diazo/tests/multi-theme-4/theme2.html b/src/diazo/tests/multi-theme-4/theme2.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-4/theme2.html\nrename to src/diazo/tests/multi-theme-4/theme2.html\ndiff --git a/lib/diazo/tests/multi-theme-5/content.html b/src/diazo/tests/multi-theme-5/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-5/content.html\nrename to src/diazo/tests/multi-theme-5/content.html\ndiff --git a/lib/diazo/tests/multi-theme-5/options.cfg b/src/diazo/tests/multi-theme-5/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-5/options.cfg\nrename to src/diazo/tests/multi-theme-5/options.cfg\ndiff --git a/lib/diazo/tests/multi-theme-5/output.html b/src/diazo/tests/multi-theme-5/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-5/output.html\nrename to src/diazo/tests/multi-theme-5/output.html\ndiff --git a/lib/diazo/tests/multi-theme-5/rules.xml b/src/diazo/tests/multi-theme-5/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-5/rules.xml\nrename to src/diazo/tests/multi-theme-5/rules.xml\ndiff --git a/lib/diazo/tests/multi-theme-5/theme1.html b/src/diazo/tests/multi-theme-5/theme1.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-5/theme1.html\nrename to src/diazo/tests/multi-theme-5/theme1.html\ndiff --git a/lib/diazo/tests/multi-theme-5/theme2.html b/src/diazo/tests/multi-theme-5/theme2.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-5/theme2.html\nrename to src/diazo/tests/multi-theme-5/theme2.html\ndiff --git a/lib/diazo/tests/multi-theme-variable-1/content.html b/src/diazo/tests/multi-theme-variable-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-variable-1/content.html\nrename to src/diazo/tests/multi-theme-variable-1/content.html\ndiff --git a/lib/diazo/tests/multi-theme-variable-1/options.cfg b/src/diazo/tests/multi-theme-variable-1/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-variable-1/options.cfg\nrename to src/diazo/tests/multi-theme-variable-1/options.cfg\ndiff --git a/lib/diazo/tests/multi-theme-variable-1/output.html b/src/diazo/tests/multi-theme-variable-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-variable-1/output.html\nrename to src/diazo/tests/multi-theme-variable-1/output.html\ndiff --git a/lib/diazo/tests/multi-theme-variable-1/rules.xml b/src/diazo/tests/multi-theme-variable-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-variable-1/rules.xml\nrename to src/diazo/tests/multi-theme-variable-1/rules.xml\ndiff --git a/lib/diazo/tests/multi-theme-variable-1/theme1.html b/src/diazo/tests/multi-theme-variable-1/theme1.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-variable-1/theme1.html\nrename to src/diazo/tests/multi-theme-variable-1/theme1.html\ndiff --git a/lib/diazo/tests/multi-theme-variable-1/theme2.html b/src/diazo/tests/multi-theme-variable-1/theme2.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-variable-1/theme2.html\nrename to src/diazo/tests/multi-theme-variable-1/theme2.html\ndiff --git a/lib/diazo/tests/nested-conditions-1/content.html b/src/diazo/tests/nested-conditions-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-1/content.html\nrename to src/diazo/tests/nested-conditions-1/content.html\ndiff --git a/lib/diazo/tests/nested-conditions-1/output.html b/src/diazo/tests/nested-conditions-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-1/output.html\nrename to src/diazo/tests/nested-conditions-1/output.html\ndiff --git a/lib/diazo/tests/nested-conditions-1/rules.xml b/src/diazo/tests/nested-conditions-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-1/rules.xml\nrename to src/diazo/tests/nested-conditions-1/rules.xml\ndiff --git a/lib/diazo/tests/nested-conditions-1/theme.html b/src/diazo/tests/nested-conditions-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-1/theme.html\nrename to src/diazo/tests/nested-conditions-1/theme.html\ndiff --git a/lib/diazo/tests/nested-conditions-2/content.html b/src/diazo/tests/nested-conditions-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-2/content.html\nrename to src/diazo/tests/nested-conditions-2/content.html\ndiff --git a/lib/diazo/tests/nested-conditions-2/output.html b/src/diazo/tests/nested-conditions-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-2/output.html\nrename to src/diazo/tests/nested-conditions-2/output.html\ndiff --git a/lib/diazo/tests/nested-conditions-2/rules.xml b/src/diazo/tests/nested-conditions-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-2/rules.xml\nrename to src/diazo/tests/nested-conditions-2/rules.xml\ndiff --git a/lib/diazo/tests/nested-conditions-2/theme.html b/src/diazo/tests/nested-conditions-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-2/theme.html\nrename to src/diazo/tests/nested-conditions-2/theme.html\ndiff --git a/lib/diazo/tests/nested-conditions-3/content.html b/src/diazo/tests/nested-conditions-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-3/content.html\nrename to src/diazo/tests/nested-conditions-3/content.html\ndiff --git a/lib/diazo/tests/nested-conditions-3/output.html b/src/diazo/tests/nested-conditions-3/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-3/output.html\nrename to src/diazo/tests/nested-conditions-3/output.html\ndiff --git a/lib/diazo/tests/nested-conditions-3/rules.xml b/src/diazo/tests/nested-conditions-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-3/rules.xml\nrename to src/diazo/tests/nested-conditions-3/rules.xml\ndiff --git a/lib/diazo/tests/nested-conditions-3/theme.html b/src/diazo/tests/nested-conditions-3/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-3/theme.html\nrename to src/diazo/tests/nested-conditions-3/theme.html\ndiff --git a/lib/diazo/tests/nested-rules-for-xinclude/content.html b/src/diazo/tests/nested-rules-for-xinclude/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-rules-for-xinclude/content.html\nrename to src/diazo/tests/nested-rules-for-xinclude/content.html\ndiff --git a/lib/diazo/tests/nested-rules-for-xinclude/output.html b/src/diazo/tests/nested-rules-for-xinclude/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-rules-for-xinclude/output.html\nrename to src/diazo/tests/nested-rules-for-xinclude/output.html\ndiff --git a/lib/diazo/tests/nested-rules-for-xinclude/rules.xml b/src/diazo/tests/nested-rules-for-xinclude/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/nested-rules-for-xinclude/rules.xml\nrename to src/diazo/tests/nested-rules-for-xinclude/rules.xml\ndiff --git a/lib/diazo/tests/nested-rules-for-xinclude/theme.html b/src/diazo/tests/nested-rules-for-xinclude/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-rules-for-xinclude/theme.html\nrename to src/diazo/tests/nested-rules-for-xinclude/theme.html\ndiff --git a/lib/diazo/tests/notheme-xmlns/content.html b/src/diazo/tests/notheme-xmlns/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/notheme-xmlns/content.html\nrename to src/diazo/tests/notheme-xmlns/content.html\ndiff --git a/lib/diazo/tests/notheme-xmlns/output.html b/src/diazo/tests/notheme-xmlns/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/notheme-xmlns/output.html\nrename to src/diazo/tests/notheme-xmlns/output.html\ndiff --git a/lib/diazo/tests/notheme-xmlns/rules.xml b/src/diazo/tests/notheme-xmlns/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/notheme-xmlns/rules.xml\nrename to src/diazo/tests/notheme-xmlns/rules.xml\ndiff --git a/lib/diazo/tests/notheme-xmlns/theme.html b/src/diazo/tests/notheme-xmlns/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/notheme-xmlns/theme.html\nrename to src/diazo/tests/notheme-xmlns/theme.html\ndiff --git a/lib/diazo/tests/null-if-content/content.html b/src/diazo/tests/null-if-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/null-if-content/content.html\nrename to src/diazo/tests/null-if-content/content.html\ndiff --git a/lib/diazo/tests/null-if-content/rules.xml b/src/diazo/tests/null-if-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/null-if-content/rules.xml\nrename to src/diazo/tests/null-if-content/rules.xml\ndiff --git a/lib/diazo/tests/null-if-content/theme.html b/src/diazo/tests/null-if-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/null-if-content/theme.html\nrename to src/diazo/tests/null-if-content/theme.html\ndiff --git a/lib/diazo/tests/null-if-content/xpaths.txt b/src/diazo/tests/null-if-content/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/null-if-content/xpaths.txt\nrename to src/diazo/tests/null-if-content/xpaths.txt\ndiff --git a/lib/diazo/tests/path-param-1/content.html b/src/diazo/tests/path-param-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-1/content.html\nrename to src/diazo/tests/path-param-1/content.html\ndiff --git a/lib/diazo/tests/path-param-1/options.cfg b/src/diazo/tests/path-param-1/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-1/options.cfg\nrename to src/diazo/tests/path-param-1/options.cfg\ndiff --git a/lib/diazo/tests/path-param-1/output.html b/src/diazo/tests/path-param-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-1/output.html\nrename to src/diazo/tests/path-param-1/output.html\ndiff --git a/lib/diazo/tests/path-param-1/rules.xml b/src/diazo/tests/path-param-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-1/rules.xml\nrename to src/diazo/tests/path-param-1/rules.xml\ndiff --git a/lib/diazo/tests/path-param-1/theme.html b/src/diazo/tests/path-param-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-1/theme.html\nrename to src/diazo/tests/path-param-1/theme.html\ndiff --git a/lib/diazo/tests/path-param-2/content.html b/src/diazo/tests/path-param-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-2/content.html\nrename to src/diazo/tests/path-param-2/content.html\ndiff --git a/lib/diazo/tests/path-param-2/options.cfg b/src/diazo/tests/path-param-2/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-2/options.cfg\nrename to src/diazo/tests/path-param-2/options.cfg\ndiff --git a/lib/diazo/tests/path-param-2/output.html b/src/diazo/tests/path-param-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-2/output.html\nrename to src/diazo/tests/path-param-2/output.html\ndiff --git a/lib/diazo/tests/path-param-2/rules.xml b/src/diazo/tests/path-param-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-2/rules.xml\nrename to src/diazo/tests/path-param-2/rules.xml\ndiff --git a/lib/diazo/tests/path-param-2/theme.html b/src/diazo/tests/path-param-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-2/theme.html\nrename to src/diazo/tests/path-param-2/theme.html\ndiff --git a/lib/diazo/tests/pre-line-endings/content.html b/src/diazo/tests/pre-line-endings/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/pre-line-endings/content.html\nrename to src/diazo/tests/pre-line-endings/content.html\ndiff --git a/lib/diazo/tests/pre-line-endings/extra.html b/src/diazo/tests/pre-line-endings/extra.html\nsimilarity index 100%\nrename from lib/diazo/tests/pre-line-endings/extra.html\nrename to src/diazo/tests/pre-line-endings/extra.html\ndiff --git a/lib/diazo/tests/pre-line-endings/output.html b/src/diazo/tests/pre-line-endings/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/pre-line-endings/output.html\nrename to src/diazo/tests/pre-line-endings/output.html\ndiff --git a/lib/diazo/tests/pre-line-endings/rules.xml b/src/diazo/tests/pre-line-endings/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/pre-line-endings/rules.xml\nrename to src/diazo/tests/pre-line-endings/rules.xml\ndiff --git a/lib/diazo/tests/pre-line-endings/theme.html b/src/diazo/tests/pre-line-endings/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/pre-line-endings/theme.html\nrename to src/diazo/tests/pre-line-endings/theme.html\ndiff --git a/lib/diazo/tests/prepend-append/content.html b/src/diazo/tests/prepend-append/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/prepend-append/content.html\nrename to src/diazo/tests/prepend-append/content.html\ndiff --git a/lib/diazo/tests/prepend-append/output.html b/src/diazo/tests/prepend-append/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/prepend-append/output.html\nrename to src/diazo/tests/prepend-append/output.html\ndiff --git a/lib/diazo/tests/prepend-append/rules.xml b/src/diazo/tests/prepend-append/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/prepend-append/rules.xml\nrename to src/diazo/tests/prepend-append/rules.xml\ndiff --git a/lib/diazo/tests/prepend-append/theme.html b/src/diazo/tests/prepend-append/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/prepend-append/theme.html\nrename to src/diazo/tests/prepend-append/theme.html\ndiff --git a/lib/diazo/tests/prepend-append/xpaths.txt b/src/diazo/tests/prepend-append/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/prepend-append/xpaths.txt\nrename to src/diazo/tests/prepend-append/xpaths.txt\ndiff --git a/lib/diazo/tests/prepend/content.html b/src/diazo/tests/prepend/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/prepend/content.html\nrename to src/diazo/tests/prepend/content.html\ndiff --git a/lib/diazo/tests/prepend/output.html b/src/diazo/tests/prepend/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/prepend/output.html\nrename to src/diazo/tests/prepend/output.html\ndiff --git a/lib/diazo/tests/prepend/rules.xml b/src/diazo/tests/prepend/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/prepend/rules.xml\nrename to src/diazo/tests/prepend/rules.xml\ndiff --git a/lib/diazo/tests/prepend/theme.html b/src/diazo/tests/prepend/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/prepend/theme.html\nrename to src/diazo/tests/prepend/theme.html\ndiff --git a/lib/diazo/tests/prepend/xpaths.txt b/src/diazo/tests/prepend/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/prepend/xpaths.txt\nrename to src/diazo/tests/prepend/xpaths.txt\ndiff --git a/lib/diazo/tests/replace-after/content.html b/src/diazo/tests/replace-after/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/replace-after/content.html\nrename to src/diazo/tests/replace-after/content.html\ndiff --git a/lib/diazo/tests/replace-after/output.html b/src/diazo/tests/replace-after/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/replace-after/output.html\nrename to src/diazo/tests/replace-after/output.html\ndiff --git a/lib/diazo/tests/replace-after/rules.xml b/src/diazo/tests/replace-after/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/replace-after/rules.xml\nrename to src/diazo/tests/replace-after/rules.xml\ndiff --git a/lib/diazo/tests/replace-after/theme.html b/src/diazo/tests/replace-after/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/replace-after/theme.html\nrename to src/diazo/tests/replace-after/theme.html\ndiff --git a/lib/diazo/tests/replace-after/xpaths.txt b/src/diazo/tests/replace-after/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/replace-after/xpaths.txt\nrename to src/diazo/tests/replace-after/xpaths.txt\ndiff --git a/lib/diazo/tests/replace/README.rst b/src/diazo/tests/replace/README.rst\nsimilarity index 100%\nrename from lib/diazo/tests/replace/README.rst\nrename to src/diazo/tests/replace/README.rst\ndiff --git a/lib/diazo/tests/replace/content.html b/src/diazo/tests/replace/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/replace/content.html\nrename to src/diazo/tests/replace/content.html\ndiff --git a/lib/diazo/tests/replace/output.html b/src/diazo/tests/replace/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/replace/output.html\nrename to src/diazo/tests/replace/output.html\ndiff --git a/lib/diazo/tests/replace/rules.xml b/src/diazo/tests/replace/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/replace/rules.xml\nrename to src/diazo/tests/replace/rules.xml\ndiff --git a/lib/diazo/tests/replace/theme.html b/src/diazo/tests/replace/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/replace/theme.html\nrename to src/diazo/tests/replace/theme.html\ndiff --git a/lib/diazo/tests/replace/xpaths.txt b/src/diazo/tests/replace/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/replace/xpaths.txt\nrename to src/diazo/tests/replace/xpaths.txt\ndiff --git a/lib/diazo/tests/ssi/content.html b/src/diazo/tests/ssi/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/ssi/content.html\nrename to src/diazo/tests/ssi/content.html\ndiff --git a/lib/diazo/tests/ssi/output.html b/src/diazo/tests/ssi/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/ssi/output.html\nrename to src/diazo/tests/ssi/output.html\ndiff --git a/lib/diazo/tests/ssi/rules.xml b/src/diazo/tests/ssi/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/ssi/rules.xml\nrename to src/diazo/tests/ssi/rules.xml\ndiff --git a/lib/diazo/tests/ssi/theme.html b/src/diazo/tests/ssi/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/ssi/theme.html\nrename to src/diazo/tests/ssi/theme.html\ndiff --git a/lib/diazo/tests/ssi/xpaths.txt b/src/diazo/tests/ssi/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/ssi/xpaths.txt\nrename to src/diazo/tests/ssi/xpaths.txt\ndiff --git a/lib/diazo/tests/ssiwait/content.html b/src/diazo/tests/ssiwait/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/ssiwait/content.html\nrename to src/diazo/tests/ssiwait/content.html\ndiff --git a/lib/diazo/tests/ssiwait/output.html b/src/diazo/tests/ssiwait/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/ssiwait/output.html\nrename to src/diazo/tests/ssiwait/output.html\ndiff --git a/lib/diazo/tests/ssiwait/rules.xml b/src/diazo/tests/ssiwait/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/ssiwait/rules.xml\nrename to src/diazo/tests/ssiwait/rules.xml\ndiff --git a/lib/diazo/tests/ssiwait/theme.html b/src/diazo/tests/ssiwait/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/ssiwait/theme.html\nrename to src/diazo/tests/ssiwait/theme.html\ndiff --git a/lib/diazo/tests/ssiwait/xpaths.txt b/src/diazo/tests/ssiwait/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/ssiwait/xpaths.txt\nrename to src/diazo/tests/ssiwait/xpaths.txt\ndiff --git a/lib/diazo/tests/style-script-quoting-1/content.html b/src/diazo/tests/style-script-quoting-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-1/content.html\nrename to src/diazo/tests/style-script-quoting-1/content.html\ndiff --git a/lib/diazo/tests/style-script-quoting-1/output.html b/src/diazo/tests/style-script-quoting-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-1/output.html\nrename to src/diazo/tests/style-script-quoting-1/output.html\ndiff --git a/lib/diazo/tests/style-script-quoting-1/rules.xml b/src/diazo/tests/style-script-quoting-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-1/rules.xml\nrename to src/diazo/tests/style-script-quoting-1/rules.xml\ndiff --git a/lib/diazo/tests/style-script-quoting-1/theme.html b/src/diazo/tests/style-script-quoting-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-1/theme.html\nrename to src/diazo/tests/style-script-quoting-1/theme.html\ndiff --git a/lib/diazo/tests/style-script-quoting-1/xpaths.txt b/src/diazo/tests/style-script-quoting-1/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-1/xpaths.txt\nrename to src/diazo/tests/style-script-quoting-1/xpaths.txt\ndiff --git a/lib/diazo/tests/style-script-quoting-2/content.html b/src/diazo/tests/style-script-quoting-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-2/content.html\nrename to src/diazo/tests/style-script-quoting-2/content.html\ndiff --git a/lib/diazo/tests/style-script-quoting-2/output.html b/src/diazo/tests/style-script-quoting-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-2/output.html\nrename to src/diazo/tests/style-script-quoting-2/output.html\ndiff --git a/lib/diazo/tests/style-script-quoting-2/rules.xml b/src/diazo/tests/style-script-quoting-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-2/rules.xml\nrename to src/diazo/tests/style-script-quoting-2/rules.xml\ndiff --git a/lib/diazo/tests/style-script-quoting-2/theme.html b/src/diazo/tests/style-script-quoting-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-2/theme.html\nrename to src/diazo/tests/style-script-quoting-2/theme.html\ndiff --git a/lib/diazo/tests/test_diazo.py b/src/diazo/tests/test_diazo.py\nsimilarity index 100%\nrename from lib/diazo/tests/test_diazo.py\nrename to src/diazo/tests/test_diazo.py\ndiff --git a/lib/diazo/tests/test_trace.py b/src/diazo/tests/test_trace.py\nsimilarity index 100%\nrename from lib/diazo/tests/test_trace.py\nrename to src/diazo/tests/test_trace.py\ndiff --git a/lib/diazo/tests/test_wsgi.py b/src/diazo/tests/test_wsgi.py\nsimilarity index 100%\nrename from lib/diazo/tests/test_wsgi.py\nrename to src/diazo/tests/test_wsgi.py\ndiff --git a/lib/diazo/tests/test_wsgi_files/custom_param.xml b/src/diazo/tests/test_wsgi_files/custom_param.xml\nsimilarity index 100%\nrename from lib/diazo/tests/test_wsgi_files/custom_param.xml\nrename to src/diazo/tests/test_wsgi_files/custom_param.xml\ndiff --git a/lib/diazo/tests/test_wsgi_files/esi.xml b/src/diazo/tests/test_wsgi_files/esi.xml\nsimilarity index 100%\nrename from lib/diazo/tests/test_wsgi_files/esi.xml\nrename to src/diazo/tests/test_wsgi_files/esi.xml\ndiff --git a/lib/diazo/tests/test_wsgi_files/explicit_theme.xml b/src/diazo/tests/test_wsgi_files/explicit_theme.xml\nsimilarity index 100%\nrename from lib/diazo/tests/test_wsgi_files/explicit_theme.xml\nrename to src/diazo/tests/test_wsgi_files/explicit_theme.xml\ndiff --git a/lib/diazo/tests/test_wsgi_files/path_param.xml b/src/diazo/tests/test_wsgi_files/path_param.xml\nsimilarity index 100%\nrename from lib/diazo/tests/test_wsgi_files/path_param.xml\nrename to src/diazo/tests/test_wsgi_files/path_param.xml\ndiff --git a/lib/diazo/tests/test_wsgi_files/simple_transform.xml b/src/diazo/tests/test_wsgi_files/simple_transform.xml\nsimilarity index 100%\nrename from lib/diazo/tests/test_wsgi_files/simple_transform.xml\nrename to src/diazo/tests/test_wsgi_files/simple_transform.xml\ndiff --git a/lib/diazo/tests/test_wsgi_files/subrequest.xml b/src/diazo/tests/test_wsgi_files/subrequest.xml\nsimilarity index 100%\nrename from lib/diazo/tests/test_wsgi_files/subrequest.xml\nrename to src/diazo/tests/test_wsgi_files/subrequest.xml\ndiff --git a/lib/diazo/tests/test_wsgi_files/theme.html b/src/diazo/tests/test_wsgi_files/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/test_wsgi_files/theme.html\nrename to src/diazo/tests/test_wsgi_files/theme.html\ndiff --git a/lib/diazo/tests/update-namespace-1/content.html b/src/diazo/tests/update-namespace-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-1/content.html\nrename to src/diazo/tests/update-namespace-1/content.html\ndiff --git a/lib/diazo/tests/update-namespace-1/rules.xml b/src/diazo/tests/update-namespace-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-1/rules.xml\nrename to src/diazo/tests/update-namespace-1/rules.xml\ndiff --git a/lib/diazo/tests/update-namespace-1/theme.html b/src/diazo/tests/update-namespace-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-1/theme.html\nrename to src/diazo/tests/update-namespace-1/theme.html\ndiff --git a/lib/diazo/tests/update-namespace-1/xpaths.txt b/src/diazo/tests/update-namespace-1/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-1/xpaths.txt\nrename to src/diazo/tests/update-namespace-1/xpaths.txt\ndiff --git a/lib/diazo/tests/update-namespace-2/content.html b/src/diazo/tests/update-namespace-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-2/content.html\nrename to src/diazo/tests/update-namespace-2/content.html\ndiff --git a/lib/diazo/tests/update-namespace-2/output.html b/src/diazo/tests/update-namespace-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-2/output.html\nrename to src/diazo/tests/update-namespace-2/output.html\ndiff --git a/lib/diazo/tests/update-namespace-2/rules.xml b/src/diazo/tests/update-namespace-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-2/rules.xml\nrename to src/diazo/tests/update-namespace-2/rules.xml\ndiff --git a/lib/diazo/tests/update-namespace-2/theme.html b/src/diazo/tests/update-namespace-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-2/theme.html\nrename to src/diazo/tests/update-namespace-2/theme.html\ndiff --git a/lib/diazo/tests/update-namespace-3/content.html b/src/diazo/tests/update-namespace-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-3/content.html\nrename to src/diazo/tests/update-namespace-3/content.html\ndiff --git a/lib/diazo/tests/update-namespace-3/output.html b/src/diazo/tests/update-namespace-3/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-3/output.html\nrename to src/diazo/tests/update-namespace-3/output.html\ndiff --git a/lib/diazo/tests/update-namespace-3/rules.xml b/src/diazo/tests/update-namespace-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-3/rules.xml\nrename to src/diazo/tests/update-namespace-3/rules.xml\ndiff --git a/lib/diazo/tests/update-namespace-3/theme.html b/src/diazo/tests/update-namespace-3/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-3/theme.html\nrename to src/diazo/tests/update-namespace-3/theme.html\ndiff --git a/lib/diazo/tests/v1-after-both-children/content.html b/src/diazo/tests/v1-after-both-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-both-children/content.html\nrename to src/diazo/tests/v1-after-both-children/content.html\ndiff --git a/lib/diazo/tests/v1-after-both-children/output.html b/src/diazo/tests/v1-after-both-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-both-children/output.html\nrename to src/diazo/tests/v1-after-both-children/output.html\ndiff --git a/lib/diazo/tests/v1-after-both-children/rules.xml b/src/diazo/tests/v1-after-both-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-both-children/rules.xml\nrename to src/diazo/tests/v1-after-both-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-after-both-children/theme.html b/src/diazo/tests/v1-after-both-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-both-children/theme.html\nrename to src/diazo/tests/v1-after-both-children/theme.html\ndiff --git a/lib/diazo/tests/v1-after-content-children/content.html b/src/diazo/tests/v1-after-content-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-content-children/content.html\nrename to src/diazo/tests/v1-after-content-children/content.html\ndiff --git a/lib/diazo/tests/v1-after-content-children/output.html b/src/diazo/tests/v1-after-content-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-content-children/output.html\nrename to src/diazo/tests/v1-after-content-children/output.html\ndiff --git a/lib/diazo/tests/v1-after-content-children/rules.xml b/src/diazo/tests/v1-after-content-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-content-children/rules.xml\nrename to src/diazo/tests/v1-after-content-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-after-content-children/theme.html b/src/diazo/tests/v1-after-content-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-content-children/theme.html\nrename to src/diazo/tests/v1-after-content-children/theme.html\ndiff --git a/lib/diazo/tests/v1-after-theme-children/content.html b/src/diazo/tests/v1-after-theme-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-theme-children/content.html\nrename to src/diazo/tests/v1-after-theme-children/content.html\ndiff --git a/lib/diazo/tests/v1-after-theme-children/output.html b/src/diazo/tests/v1-after-theme-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-theme-children/output.html\nrename to src/diazo/tests/v1-after-theme-children/output.html\ndiff --git a/lib/diazo/tests/v1-after-theme-children/rules.xml b/src/diazo/tests/v1-after-theme-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-theme-children/rules.xml\nrename to src/diazo/tests/v1-after-theme-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-after-theme-children/theme.html b/src/diazo/tests/v1-after-theme-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-theme-children/theme.html\nrename to src/diazo/tests/v1-after-theme-children/theme.html\ndiff --git a/lib/diazo/tests/v1-after/content.html b/src/diazo/tests/v1-after/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after/content.html\nrename to src/diazo/tests/v1-after/content.html\ndiff --git a/lib/diazo/tests/v1-after/output.html b/src/diazo/tests/v1-after/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after/output.html\nrename to src/diazo/tests/v1-after/output.html\ndiff --git a/lib/diazo/tests/v1-after/rules.xml b/src/diazo/tests/v1-after/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after/rules.xml\nrename to src/diazo/tests/v1-after/rules.xml\ndiff --git a/lib/diazo/tests/v1-after/theme.html b/src/diazo/tests/v1-after/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after/theme.html\nrename to src/diazo/tests/v1-after/theme.html\ndiff --git a/lib/diazo/tests/v1-before-both-children/content.html b/src/diazo/tests/v1-before-both-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-both-children/content.html\nrename to src/diazo/tests/v1-before-both-children/content.html\ndiff --git a/lib/diazo/tests/v1-before-both-children/output.html b/src/diazo/tests/v1-before-both-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-both-children/output.html\nrename to src/diazo/tests/v1-before-both-children/output.html\ndiff --git a/lib/diazo/tests/v1-before-both-children/rules.xml b/src/diazo/tests/v1-before-both-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-both-children/rules.xml\nrename to src/diazo/tests/v1-before-both-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-before-both-children/theme.html b/src/diazo/tests/v1-before-both-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-both-children/theme.html\nrename to src/diazo/tests/v1-before-both-children/theme.html\ndiff --git a/lib/diazo/tests/v1-before-content-children/content.html b/src/diazo/tests/v1-before-content-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-content-children/content.html\nrename to src/diazo/tests/v1-before-content-children/content.html\ndiff --git a/lib/diazo/tests/v1-before-content-children/output.html b/src/diazo/tests/v1-before-content-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-content-children/output.html\nrename to src/diazo/tests/v1-before-content-children/output.html\ndiff --git a/lib/diazo/tests/v1-before-content-children/rules.xml b/src/diazo/tests/v1-before-content-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-content-children/rules.xml\nrename to src/diazo/tests/v1-before-content-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-before-content-children/theme.html b/src/diazo/tests/v1-before-content-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-content-children/theme.html\nrename to src/diazo/tests/v1-before-content-children/theme.html\ndiff --git a/lib/diazo/tests/v1-before-content-content-children/content.html b/src/diazo/tests/v1-before-content-content-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-content-content-children/content.html\nrename to src/diazo/tests/v1-before-content-content-children/content.html\ndiff --git a/lib/diazo/tests/v1-before-content-content-children/output.html b/src/diazo/tests/v1-before-content-content-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-content-content-children/output.html\nrename to src/diazo/tests/v1-before-content-content-children/output.html\ndiff --git a/lib/diazo/tests/v1-before-content-content-children/rules.xml b/src/diazo/tests/v1-before-content-content-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-content-content-children/rules.xml\nrename to src/diazo/tests/v1-before-content-content-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-before-content-content-children/theme.html b/src/diazo/tests/v1-before-content-content-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-content-content-children/theme.html\nrename to src/diazo/tests/v1-before-content-content-children/theme.html\ndiff --git a/lib/diazo/tests/v1-before-replace-after-content/content.html b/src/diazo/tests/v1-before-replace-after-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-replace-after-content/content.html\nrename to src/diazo/tests/v1-before-replace-after-content/content.html\ndiff --git a/lib/diazo/tests/v1-before-replace-after-content/output.html b/src/diazo/tests/v1-before-replace-after-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-replace-after-content/output.html\nrename to src/diazo/tests/v1-before-replace-after-content/output.html\ndiff --git a/lib/diazo/tests/v1-before-replace-after-content/rules.xml b/src/diazo/tests/v1-before-replace-after-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-replace-after-content/rules.xml\nrename to src/diazo/tests/v1-before-replace-after-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-before-replace-after-content/theme.html b/src/diazo/tests/v1-before-replace-after-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-replace-after-content/theme.html\nrename to src/diazo/tests/v1-before-replace-after-content/theme.html\ndiff --git a/lib/diazo/tests/v1-before-theme-children/content.html b/src/diazo/tests/v1-before-theme-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-theme-children/content.html\nrename to src/diazo/tests/v1-before-theme-children/content.html\ndiff --git a/lib/diazo/tests/v1-before-theme-children/output.html b/src/diazo/tests/v1-before-theme-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-theme-children/output.html\nrename to src/diazo/tests/v1-before-theme-children/output.html\ndiff --git a/lib/diazo/tests/v1-before-theme-children/rules.xml b/src/diazo/tests/v1-before-theme-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-theme-children/rules.xml\nrename to src/diazo/tests/v1-before-theme-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-before-theme-children/theme.html b/src/diazo/tests/v1-before-theme-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-theme-children/theme.html\nrename to src/diazo/tests/v1-before-theme-children/theme.html\ndiff --git a/lib/diazo/tests/v1-before/content.html b/src/diazo/tests/v1-before/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before/content.html\nrename to src/diazo/tests/v1-before/content.html\ndiff --git a/lib/diazo/tests/v1-before/output.html b/src/diazo/tests/v1-before/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before/output.html\nrename to src/diazo/tests/v1-before/output.html\ndiff --git a/lib/diazo/tests/v1-before/rules.xml b/src/diazo/tests/v1-before/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before/rules.xml\nrename to src/diazo/tests/v1-before/rules.xml\ndiff --git a/lib/diazo/tests/v1-before/theme.html b/src/diazo/tests/v1-before/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before/theme.html\nrename to src/diazo/tests/v1-before/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-1/content.html b/src/diazo/tests/v1-copy-all-attributes-conditional-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-1/content.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-1/content.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-1/output.html b/src/diazo/tests/v1-copy-all-attributes-conditional-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-1/output.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-1/output.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-1/rules.xml b/src/diazo/tests/v1-copy-all-attributes-conditional-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-1/rules.xml\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-1/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-1/theme.html b/src/diazo/tests/v1-copy-all-attributes-conditional-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-1/theme.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-1/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-2/content.html b/src/diazo/tests/v1-copy-all-attributes-conditional-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-2/content.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-2/content.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-2/output.html b/src/diazo/tests/v1-copy-all-attributes-conditional-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-2/output.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-2/output.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-2/rules.xml b/src/diazo/tests/v1-copy-all-attributes-conditional-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-2/rules.xml\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-2/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-2/theme.html b/src/diazo/tests/v1-copy-all-attributes-conditional-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-2/theme.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-2/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-3/content.html b/src/diazo/tests/v1-copy-all-attributes-conditional-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-3/content.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-3/content.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-3/output.html b/src/diazo/tests/v1-copy-all-attributes-conditional-3/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-3/output.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-3/output.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-3/rules.xml b/src/diazo/tests/v1-copy-all-attributes-conditional-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-3/rules.xml\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-3/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-3/theme.html b/src/diazo/tests/v1-copy-all-attributes-conditional-3/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-3/theme.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-3/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-href/content.html b/src/diazo/tests/v1-copy-all-attributes-href/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-href/content.html\nrename to src/diazo/tests/v1-copy-all-attributes-href/content.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-href/include.html b/src/diazo/tests/v1-copy-all-attributes-href/include.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-href/include.html\nrename to src/diazo/tests/v1-copy-all-attributes-href/include.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-href/output.html b/src/diazo/tests/v1-copy-all-attributes-href/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-href/output.html\nrename to src/diazo/tests/v1-copy-all-attributes-href/output.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-href/rules.xml b/src/diazo/tests/v1-copy-all-attributes-href/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-href/rules.xml\nrename to src/diazo/tests/v1-copy-all-attributes-href/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-href/theme.html b/src/diazo/tests/v1-copy-all-attributes-href/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-href/theme.html\nrename to src/diazo/tests/v1-copy-all-attributes-href/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/content.html b/src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/content.html\nrename to src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/content.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/output.html b/src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/output.html\nrename to src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/output.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/rules.xml b/src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/rules.xml\nrename to src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/theme.html b/src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/theme.html\nrename to src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/content.html b/src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/content.html\nrename to src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/content.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/output.html b/src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/output.html\nrename to src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/output.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/rules.xml b/src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/rules.xml\nrename to src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/theme.html b/src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/theme.html\nrename to src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes/content.html b/src/diazo/tests/v1-copy-all-attributes/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes/content.html\nrename to src/diazo/tests/v1-copy-all-attributes/content.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes/output.html b/src/diazo/tests/v1-copy-all-attributes/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes/output.html\nrename to src/diazo/tests/v1-copy-all-attributes/output.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes/rules.xml b/src/diazo/tests/v1-copy-all-attributes/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes/rules.xml\nrename to src/diazo/tests/v1-copy-all-attributes/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes/theme.html b/src/diazo/tests/v1-copy-all-attributes/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes/theme.html\nrename to src/diazo/tests/v1-copy-all-attributes/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-attribute-exists/content.html b/src/diazo/tests/v1-copy-attribute-exists/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-attribute-exists/content.html\nrename to src/diazo/tests/v1-copy-attribute-exists/content.html\ndiff --git a/lib/diazo/tests/v1-copy-attribute-exists/output.html b/src/diazo/tests/v1-copy-attribute-exists/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-attribute-exists/output.html\nrename to src/diazo/tests/v1-copy-attribute-exists/output.html\ndiff --git a/lib/diazo/tests/v1-copy-attribute-exists/rules.xml b/src/diazo/tests/v1-copy-attribute-exists/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-attribute-exists/rules.xml\nrename to src/diazo/tests/v1-copy-attribute-exists/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-attribute-exists/theme.html b/src/diazo/tests/v1-copy-attribute-exists/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-attribute-exists/theme.html\nrename to src/diazo/tests/v1-copy-attribute-exists/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-attribute-not-exists/content.html b/src/diazo/tests/v1-copy-attribute-not-exists/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-attribute-not-exists/content.html\nrename to src/diazo/tests/v1-copy-attribute-not-exists/content.html\ndiff --git a/lib/diazo/tests/v1-copy-attribute-not-exists/output.html b/src/diazo/tests/v1-copy-attribute-not-exists/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-attribute-not-exists/output.html\nrename to src/diazo/tests/v1-copy-attribute-not-exists/output.html\ndiff --git a/lib/diazo/tests/v1-copy-attribute-not-exists/rules.xml b/src/diazo/tests/v1-copy-attribute-not-exists/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-attribute-not-exists/rules.xml\nrename to src/diazo/tests/v1-copy-attribute-not-exists/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-attribute-not-exists/theme.html b/src/diazo/tests/v1-copy-attribute-not-exists/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-attribute-not-exists/theme.html\nrename to src/diazo/tests/v1-copy-attribute-not-exists/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-multi-attribute/content.html b/src/diazo/tests/v1-copy-multi-attribute/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-multi-attribute/content.html\nrename to src/diazo/tests/v1-copy-multi-attribute/content.html\ndiff --git a/lib/diazo/tests/v1-copy-multi-attribute/output.html b/src/diazo/tests/v1-copy-multi-attribute/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-multi-attribute/output.html\nrename to src/diazo/tests/v1-copy-multi-attribute/output.html\ndiff --git a/lib/diazo/tests/v1-copy-multi-attribute/rules.xml b/src/diazo/tests/v1-copy-multi-attribute/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-multi-attribute/rules.xml\nrename to src/diazo/tests/v1-copy-multi-attribute/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-multi-attribute/theme.html b/src/diazo/tests/v1-copy-multi-attribute/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-multi-attribute/theme.html\nrename to src/diazo/tests/v1-copy-multi-attribute/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-content/content.html b/src/diazo/tests/v1-drop-all-attributes-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-content/content.html\nrename to src/diazo/tests/v1-drop-all-attributes-content/content.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-content/output.html b/src/diazo/tests/v1-drop-all-attributes-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-content/output.html\nrename to src/diazo/tests/v1-drop-all-attributes-content/output.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-content/rules.xml b/src/diazo/tests/v1-drop-all-attributes-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-content/rules.xml\nrename to src/diazo/tests/v1-drop-all-attributes-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-content/theme.html b/src/diazo/tests/v1-drop-all-attributes-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-content/theme.html\nrename to src/diazo/tests/v1-drop-all-attributes-content/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/content.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/content.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/content.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/output.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/output.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/output.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/rules.xml b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/rules.xml\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/theme.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/theme.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/content.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/content.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/content.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/output.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/output.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/output.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/rules.xml b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/rules.xml\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/theme.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/theme.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/content.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/content.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/content.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/output.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/output.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/output.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/rules.xml b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/rules.xml\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/theme.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/theme.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/content.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/content.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/content.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/output.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/output.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/output.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/rules.xml b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/rules.xml\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/theme.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/theme.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/content.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/content.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/content.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/output.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/output.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/output.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/rules.xml b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/rules.xml\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/theme.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/theme.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme/content.html b/src/diazo/tests/v1-drop-all-attributes-theme/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme/content.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme/content.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme/output.html b/src/diazo/tests/v1-drop-all-attributes-theme/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme/output.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme/output.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme/rules.xml b/src/diazo/tests/v1-drop-all-attributes-theme/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme/rules.xml\nrename to src/diazo/tests/v1-drop-all-attributes-theme/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme/theme.html b/src/diazo/tests/v1-drop-all-attributes-theme/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme/theme.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-and-replace-messages/content.html b/src/diazo/tests/v1-drop-and-replace-messages/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-and-replace-messages/content.html\nrename to src/diazo/tests/v1-drop-and-replace-messages/content.html\ndiff --git a/lib/diazo/tests/v1-drop-and-replace-messages/output.html b/src/diazo/tests/v1-drop-and-replace-messages/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-and-replace-messages/output.html\nrename to src/diazo/tests/v1-drop-and-replace-messages/output.html\ndiff --git a/lib/diazo/tests/v1-drop-and-replace-messages/rules.xml b/src/diazo/tests/v1-drop-and-replace-messages/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-and-replace-messages/rules.xml\nrename to src/diazo/tests/v1-drop-and-replace-messages/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-and-replace-messages/theme.html b/src/diazo/tests/v1-drop-and-replace-messages/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-and-replace-messages/theme.html\nrename to src/diazo/tests/v1-drop-and-replace-messages/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-and-replace-portlets/content.html b/src/diazo/tests/v1-drop-and-replace-portlets/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-and-replace-portlets/content.html\nrename to src/diazo/tests/v1-drop-and-replace-portlets/content.html\ndiff --git a/lib/diazo/tests/v1-drop-and-replace-portlets/output.html b/src/diazo/tests/v1-drop-and-replace-portlets/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-and-replace-portlets/output.html\nrename to src/diazo/tests/v1-drop-and-replace-portlets/output.html\ndiff --git a/lib/diazo/tests/v1-drop-and-replace-portlets/rules.xml b/src/diazo/tests/v1-drop-and-replace-portlets/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-and-replace-portlets/rules.xml\nrename to src/diazo/tests/v1-drop-and-replace-portlets/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-and-replace-portlets/theme.html b/src/diazo/tests/v1-drop-and-replace-portlets/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-and-replace-portlets/theme.html\nrename to src/diazo/tests/v1-drop-and-replace-portlets/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-content/content.html b/src/diazo/tests/v1-drop-attribute-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-content/content.html\nrename to src/diazo/tests/v1-drop-attribute-content/content.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-content/output.html b/src/diazo/tests/v1-drop-attribute-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-content/output.html\nrename to src/diazo/tests/v1-drop-attribute-content/output.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-content/rules.xml b/src/diazo/tests/v1-drop-attribute-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-content/rules.xml\nrename to src/diazo/tests/v1-drop-attribute-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-attribute-content/theme.html b/src/diazo/tests/v1-drop-attribute-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-content/theme.html\nrename to src/diazo/tests/v1-drop-attribute-content/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme-conditional-1/content.html b/src/diazo/tests/v1-drop-attribute-theme-conditional-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme-conditional-1/content.html\nrename to src/diazo/tests/v1-drop-attribute-theme-conditional-1/content.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme-conditional-1/output.html b/src/diazo/tests/v1-drop-attribute-theme-conditional-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme-conditional-1/output.html\nrename to src/diazo/tests/v1-drop-attribute-theme-conditional-1/output.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme-conditional-1/rules.xml b/src/diazo/tests/v1-drop-attribute-theme-conditional-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme-conditional-1/rules.xml\nrename to src/diazo/tests/v1-drop-attribute-theme-conditional-1/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme-conditional-1/theme.html b/src/diazo/tests/v1-drop-attribute-theme-conditional-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme-conditional-1/theme.html\nrename to src/diazo/tests/v1-drop-attribute-theme-conditional-1/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme-conditional-2/content.html b/src/diazo/tests/v1-drop-attribute-theme-conditional-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme-conditional-2/content.html\nrename to src/diazo/tests/v1-drop-attribute-theme-conditional-2/content.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme-conditional-2/output.html b/src/diazo/tests/v1-drop-attribute-theme-conditional-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme-conditional-2/output.html\nrename to src/diazo/tests/v1-drop-attribute-theme-conditional-2/output.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme-conditional-2/rules.xml b/src/diazo/tests/v1-drop-attribute-theme-conditional-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme-conditional-2/rules.xml\nrename to src/diazo/tests/v1-drop-attribute-theme-conditional-2/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme-conditional-2/theme.html b/src/diazo/tests/v1-drop-attribute-theme-conditional-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme-conditional-2/theme.html\nrename to src/diazo/tests/v1-drop-attribute-theme-conditional-2/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme/content.html b/src/diazo/tests/v1-drop-attribute-theme/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme/content.html\nrename to src/diazo/tests/v1-drop-attribute-theme/content.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme/output.html b/src/diazo/tests/v1-drop-attribute-theme/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme/output.html\nrename to src/diazo/tests/v1-drop-attribute-theme/output.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme/rules.xml b/src/diazo/tests/v1-drop-attribute-theme/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme/rules.xml\nrename to src/diazo/tests/v1-drop-attribute-theme/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme/theme.html b/src/diazo/tests/v1-drop-attribute-theme/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme/theme.html\nrename to src/diazo/tests/v1-drop-attribute-theme/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-multi-attributes-content/content.html b/src/diazo/tests/v1-drop-multi-attributes-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-multi-attributes-content/content.html\nrename to src/diazo/tests/v1-drop-multi-attributes-content/content.html\ndiff --git a/lib/diazo/tests/v1-drop-multi-attributes-content/output.html b/src/diazo/tests/v1-drop-multi-attributes-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-multi-attributes-content/output.html\nrename to src/diazo/tests/v1-drop-multi-attributes-content/output.html\ndiff --git a/lib/diazo/tests/v1-drop-multi-attributes-content/rules.xml b/src/diazo/tests/v1-drop-multi-attributes-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-multi-attributes-content/rules.xml\nrename to src/diazo/tests/v1-drop-multi-attributes-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-multi-attributes-content/theme.html b/src/diazo/tests/v1-drop-multi-attributes-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-multi-attributes-content/theme.html\nrename to src/diazo/tests/v1-drop-multi-attributes-content/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-multi-attributes-theme/content.html b/src/diazo/tests/v1-drop-multi-attributes-theme/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-multi-attributes-theme/content.html\nrename to src/diazo/tests/v1-drop-multi-attributes-theme/content.html\ndiff --git a/lib/diazo/tests/v1-drop-multi-attributes-theme/output.html b/src/diazo/tests/v1-drop-multi-attributes-theme/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-multi-attributes-theme/output.html\nrename to src/diazo/tests/v1-drop-multi-attributes-theme/output.html\ndiff --git a/lib/diazo/tests/v1-drop-multi-attributes-theme/rules.xml b/src/diazo/tests/v1-drop-multi-attributes-theme/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-multi-attributes-theme/rules.xml\nrename to src/diazo/tests/v1-drop-multi-attributes-theme/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-multi-attributes-theme/theme.html b/src/diazo/tests/v1-drop-multi-attributes-theme/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-multi-attributes-theme/theme.html\nrename to src/diazo/tests/v1-drop-multi-attributes-theme/theme.html\ndiff --git a/lib/diazo/tests/v1-if-content/content.html b/src/diazo/tests/v1-if-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-content/content.html\nrename to src/diazo/tests/v1-if-content/content.html\ndiff --git a/lib/diazo/tests/v1-if-content/output.html b/src/diazo/tests/v1-if-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-content/output.html\nrename to src/diazo/tests/v1-if-content/output.html\ndiff --git a/lib/diazo/tests/v1-if-content/rules.xml b/src/diazo/tests/v1-if-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-content/rules.xml\nrename to src/diazo/tests/v1-if-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-if-content/theme.html b/src/diazo/tests/v1-if-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-content/theme.html\nrename to src/diazo/tests/v1-if-content/theme.html\ndiff --git a/lib/diazo/tests/v1-if-custom-param/content.html b/src/diazo/tests/v1-if-custom-param/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-custom-param/content.html\nrename to src/diazo/tests/v1-if-custom-param/content.html\ndiff --git a/lib/diazo/tests/v1-if-custom-param/options.cfg b/src/diazo/tests/v1-if-custom-param/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-custom-param/options.cfg\nrename to src/diazo/tests/v1-if-custom-param/options.cfg\ndiff --git a/lib/diazo/tests/v1-if-custom-param/output.html b/src/diazo/tests/v1-if-custom-param/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-custom-param/output.html\nrename to src/diazo/tests/v1-if-custom-param/output.html\ndiff --git a/lib/diazo/tests/v1-if-custom-param/rules.xml b/src/diazo/tests/v1-if-custom-param/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-custom-param/rules.xml\nrename to src/diazo/tests/v1-if-custom-param/rules.xml\ndiff --git a/lib/diazo/tests/v1-if-custom-param/theme.html b/src/diazo/tests/v1-if-custom-param/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-custom-param/theme.html\nrename to src/diazo/tests/v1-if-custom-param/theme.html\ndiff --git a/lib/diazo/tests/v1-if-merge/content.html b/src/diazo/tests/v1-if-merge/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-merge/content.html\nrename to src/diazo/tests/v1-if-merge/content.html\ndiff --git a/lib/diazo/tests/v1-if-merge/output.html b/src/diazo/tests/v1-if-merge/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-merge/output.html\nrename to src/diazo/tests/v1-if-merge/output.html\ndiff --git a/lib/diazo/tests/v1-if-merge/rules.xml b/src/diazo/tests/v1-if-merge/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-merge/rules.xml\nrename to src/diazo/tests/v1-if-merge/rules.xml\ndiff --git a/lib/diazo/tests/v1-if-merge/theme.html b/src/diazo/tests/v1-if-merge/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-merge/theme.html\nrename to src/diazo/tests/v1-if-merge/theme.html\ndiff --git a/lib/diazo/tests/v1-if-not-content/content.html b/src/diazo/tests/v1-if-not-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-content/content.html\nrename to src/diazo/tests/v1-if-not-content/content.html\ndiff --git a/lib/diazo/tests/v1-if-not-content/output.html b/src/diazo/tests/v1-if-not-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-content/output.html\nrename to src/diazo/tests/v1-if-not-content/output.html\ndiff --git a/lib/diazo/tests/v1-if-not-content/rules.xml b/src/diazo/tests/v1-if-not-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-content/rules.xml\nrename to src/diazo/tests/v1-if-not-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-if-not-content/theme.html b/src/diazo/tests/v1-if-not-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-content/theme.html\nrename to src/diazo/tests/v1-if-not-content/theme.html\ndiff --git a/lib/diazo/tests/v1-if-not-path/content.html b/src/diazo/tests/v1-if-not-path/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-path/content.html\nrename to src/diazo/tests/v1-if-not-path/content.html\ndiff --git a/lib/diazo/tests/v1-if-not-path/options.cfg b/src/diazo/tests/v1-if-not-path/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-path/options.cfg\nrename to src/diazo/tests/v1-if-not-path/options.cfg\ndiff --git a/lib/diazo/tests/v1-if-not-path/output.html b/src/diazo/tests/v1-if-not-path/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-path/output.html\nrename to src/diazo/tests/v1-if-not-path/output.html\ndiff --git a/lib/diazo/tests/v1-if-not-path/rules.xml b/src/diazo/tests/v1-if-not-path/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-path/rules.xml\nrename to src/diazo/tests/v1-if-not-path/rules.xml\ndiff --git a/lib/diazo/tests/v1-if-not-path/theme.html b/src/diazo/tests/v1-if-not-path/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-path/theme.html\nrename to src/diazo/tests/v1-if-not-path/theme.html\ndiff --git a/lib/diazo/tests/v1-if-not/content.html b/src/diazo/tests/v1-if-not/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not/content.html\nrename to src/diazo/tests/v1-if-not/content.html\ndiff --git a/lib/diazo/tests/v1-if-not/output.html b/src/diazo/tests/v1-if-not/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not/output.html\nrename to src/diazo/tests/v1-if-not/output.html\ndiff --git a/lib/diazo/tests/v1-if-not/rules.xml b/src/diazo/tests/v1-if-not/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not/rules.xml\nrename to src/diazo/tests/v1-if-not/rules.xml\ndiff --git a/lib/diazo/tests/v1-if-not/theme.html b/src/diazo/tests/v1-if-not/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not/theme.html\nrename to src/diazo/tests/v1-if-not/theme.html\ndiff --git a/lib/diazo/tests/v1-if-path/content.html b/src/diazo/tests/v1-if-path/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-path/content.html\nrename to src/diazo/tests/v1-if-path/content.html\ndiff --git a/lib/diazo/tests/v1-if-path/options.cfg b/src/diazo/tests/v1-if-path/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-path/options.cfg\nrename to src/diazo/tests/v1-if-path/options.cfg\ndiff --git a/lib/diazo/tests/v1-if-path/output.html b/src/diazo/tests/v1-if-path/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-path/output.html\nrename to src/diazo/tests/v1-if-path/output.html\ndiff --git a/lib/diazo/tests/v1-if-path/rules.xml b/src/diazo/tests/v1-if-path/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-path/rules.xml\nrename to src/diazo/tests/v1-if-path/rules.xml\ndiff --git a/lib/diazo/tests/v1-if-path/theme.html b/src/diazo/tests/v1-if-path/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-path/theme.html\nrename to src/diazo/tests/v1-if-path/theme.html\ndiff --git a/lib/diazo/tests/v1-if/content.html b/src/diazo/tests/v1-if/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if/content.html\nrename to src/diazo/tests/v1-if/content.html\ndiff --git a/lib/diazo/tests/v1-if/output.html b/src/diazo/tests/v1-if/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if/output.html\nrename to src/diazo/tests/v1-if/output.html\ndiff --git a/lib/diazo/tests/v1-if/rules.xml b/src/diazo/tests/v1-if/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if/rules.xml\nrename to src/diazo/tests/v1-if/rules.xml\ndiff --git a/lib/diazo/tests/v1-if/theme.html b/src/diazo/tests/v1-if/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if/theme.html\nrename to src/diazo/tests/v1-if/theme.html\ndiff --git a/lib/diazo/tests/v1-merge-multiple-if-true/content.html b/src/diazo/tests/v1-merge-multiple-if-true/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-multiple-if-true/content.html\nrename to src/diazo/tests/v1-merge-multiple-if-true/content.html\ndiff --git a/lib/diazo/tests/v1-merge-multiple-if-true/output.html b/src/diazo/tests/v1-merge-multiple-if-true/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-multiple-if-true/output.html\nrename to src/diazo/tests/v1-merge-multiple-if-true/output.html\ndiff --git a/lib/diazo/tests/v1-merge-multiple-if-true/rules.xml b/src/diazo/tests/v1-merge-multiple-if-true/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-multiple-if-true/rules.xml\nrename to src/diazo/tests/v1-merge-multiple-if-true/rules.xml\ndiff --git a/lib/diazo/tests/v1-merge-multiple-if-true/theme.html b/src/diazo/tests/v1-merge-multiple-if-true/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-multiple-if-true/theme.html\nrename to src/diazo/tests/v1-merge-multiple-if-true/theme.html\ndiff --git a/lib/diazo/tests/v1-merge-multiple/content.html b/src/diazo/tests/v1-merge-multiple/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-multiple/content.html\nrename to src/diazo/tests/v1-merge-multiple/content.html\ndiff --git a/lib/diazo/tests/v1-merge-multiple/output.html b/src/diazo/tests/v1-merge-multiple/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-multiple/output.html\nrename to src/diazo/tests/v1-merge-multiple/output.html\ndiff --git a/lib/diazo/tests/v1-merge-multiple/rules.xml b/src/diazo/tests/v1-merge-multiple/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-multiple/rules.xml\nrename to src/diazo/tests/v1-merge-multiple/rules.xml\ndiff --git a/lib/diazo/tests/v1-merge-multiple/theme.html b/src/diazo/tests/v1-merge-multiple/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-multiple/theme.html\nrename to src/diazo/tests/v1-merge-multiple/theme.html\ndiff --git a/lib/diazo/tests/v1-merge-separator/content.html b/src/diazo/tests/v1-merge-separator/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-separator/content.html\nrename to src/diazo/tests/v1-merge-separator/content.html\ndiff --git a/lib/diazo/tests/v1-merge-separator/output.html b/src/diazo/tests/v1-merge-separator/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-separator/output.html\nrename to src/diazo/tests/v1-merge-separator/output.html\ndiff --git a/lib/diazo/tests/v1-merge-separator/rules.xml b/src/diazo/tests/v1-merge-separator/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-separator/rules.xml\nrename to src/diazo/tests/v1-merge-separator/rules.xml\ndiff --git a/lib/diazo/tests/v1-merge-separator/theme.html b/src/diazo/tests/v1-merge-separator/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-separator/theme.html\nrename to src/diazo/tests/v1-merge-separator/theme.html\ndiff --git a/lib/diazo/tests/v1-merge/content.html b/src/diazo/tests/v1-merge/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge/content.html\nrename to src/diazo/tests/v1-merge/content.html\ndiff --git a/lib/diazo/tests/v1-merge/output.html b/src/diazo/tests/v1-merge/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge/output.html\nrename to src/diazo/tests/v1-merge/output.html\ndiff --git a/lib/diazo/tests/v1-merge/rules.xml b/src/diazo/tests/v1-merge/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge/rules.xml\nrename to src/diazo/tests/v1-merge/rules.xml\ndiff --git a/lib/diazo/tests/v1-merge/theme.html b/src/diazo/tests/v1-merge/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge/theme.html\nrename to src/diazo/tests/v1-merge/theme.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-content/content.html b/src/diazo/tests/v1-notheme-if-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-content/content.html\nrename to src/diazo/tests/v1-notheme-if-content/content.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-content/output.html b/src/diazo/tests/v1-notheme-if-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-content/output.html\nrename to src/diazo/tests/v1-notheme-if-content/output.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-content/rules.xml b/src/diazo/tests/v1-notheme-if-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-content/rules.xml\nrename to src/diazo/tests/v1-notheme-if-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-notheme-if-content/theme.html b/src/diazo/tests/v1-notheme-if-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-content/theme.html\nrename to src/diazo/tests/v1-notheme-if-content/theme.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-merge/content.html b/src/diazo/tests/v1-notheme-if-merge/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-merge/content.html\nrename to src/diazo/tests/v1-notheme-if-merge/content.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-merge/output.html b/src/diazo/tests/v1-notheme-if-merge/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-merge/output.html\nrename to src/diazo/tests/v1-notheme-if-merge/output.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-merge/rules.xml b/src/diazo/tests/v1-notheme-if-merge/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-merge/rules.xml\nrename to src/diazo/tests/v1-notheme-if-merge/rules.xml\ndiff --git a/lib/diazo/tests/v1-notheme-if-merge/theme.html b/src/diazo/tests/v1-notheme-if-merge/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-merge/theme.html\nrename to src/diazo/tests/v1-notheme-if-merge/theme.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-path/content.html b/src/diazo/tests/v1-notheme-if-path/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-path/content.html\nrename to src/diazo/tests/v1-notheme-if-path/content.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-path/options.cfg b/src/diazo/tests/v1-notheme-if-path/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-path/options.cfg\nrename to src/diazo/tests/v1-notheme-if-path/options.cfg\ndiff --git a/lib/diazo/tests/v1-notheme-if-path/output.html b/src/diazo/tests/v1-notheme-if-path/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-path/output.html\nrename to src/diazo/tests/v1-notheme-if-path/output.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-path/rules.xml b/src/diazo/tests/v1-notheme-if-path/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-path/rules.xml\nrename to src/diazo/tests/v1-notheme-if-path/rules.xml\ndiff --git a/lib/diazo/tests/v1-notheme-if-path/theme.html b/src/diazo/tests/v1-notheme-if-path/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-path/theme.html\nrename to src/diazo/tests/v1-notheme-if-path/theme.html\ndiff --git a/lib/diazo/tests/v1-notheme-if/content.html b/src/diazo/tests/v1-notheme-if/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if/content.html\nrename to src/diazo/tests/v1-notheme-if/content.html\ndiff --git a/lib/diazo/tests/v1-notheme-if/output.html b/src/diazo/tests/v1-notheme-if/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if/output.html\nrename to src/diazo/tests/v1-notheme-if/output.html\ndiff --git a/lib/diazo/tests/v1-notheme-if/rules.xml b/src/diazo/tests/v1-notheme-if/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if/rules.xml\nrename to src/diazo/tests/v1-notheme-if/rules.xml\ndiff --git a/lib/diazo/tests/v1-notheme-if/theme.html b/src/diazo/tests/v1-notheme-if/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if/theme.html\nrename to src/diazo/tests/v1-notheme-if/theme.html\ndiff --git a/lib/diazo/tests/v1-notheme-nomatch/content.html b/src/diazo/tests/v1-notheme-nomatch/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-nomatch/content.html\nrename to src/diazo/tests/v1-notheme-nomatch/content.html\ndiff --git a/lib/diazo/tests/v1-notheme-nomatch/output.html b/src/diazo/tests/v1-notheme-nomatch/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-nomatch/output.html\nrename to src/diazo/tests/v1-notheme-nomatch/output.html\ndiff --git a/lib/diazo/tests/v1-notheme-nomatch/rules.xml b/src/diazo/tests/v1-notheme-nomatch/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-nomatch/rules.xml\nrename to src/diazo/tests/v1-notheme-nomatch/rules.xml\ndiff --git a/lib/diazo/tests/v1-notheme-nomatch/theme.html b/src/diazo/tests/v1-notheme-nomatch/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-nomatch/theme.html\nrename to src/diazo/tests/v1-notheme-nomatch/theme.html\ndiff --git a/lib/diazo/tests/v1-notheme-theme-precedence/content.html b/src/diazo/tests/v1-notheme-theme-precedence/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-theme-precedence/content.html\nrename to src/diazo/tests/v1-notheme-theme-precedence/content.html\ndiff --git a/lib/diazo/tests/v1-notheme-theme-precedence/options.cfg b/src/diazo/tests/v1-notheme-theme-precedence/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-theme-precedence/options.cfg\nrename to src/diazo/tests/v1-notheme-theme-precedence/options.cfg\ndiff --git a/lib/diazo/tests/v1-notheme-theme-precedence/output.html b/src/diazo/tests/v1-notheme-theme-precedence/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-theme-precedence/output.html\nrename to src/diazo/tests/v1-notheme-theme-precedence/output.html\ndiff --git a/lib/diazo/tests/v1-notheme-theme-precedence/rules.xml b/src/diazo/tests/v1-notheme-theme-precedence/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-theme-precedence/rules.xml\nrename to src/diazo/tests/v1-notheme-theme-precedence/rules.xml\ndiff --git a/lib/diazo/tests/v1-notheme-theme-precedence/theme.html b/src/diazo/tests/v1-notheme-theme-precedence/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-theme-precedence/theme.html\nrename to src/diazo/tests/v1-notheme-theme-precedence/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-both-children/content.html b/src/diazo/tests/v1-replace-both-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-both-children/content.html\nrename to src/diazo/tests/v1-replace-both-children/content.html\ndiff --git a/lib/diazo/tests/v1-replace-both-children/output.html b/src/diazo/tests/v1-replace-both-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-both-children/output.html\nrename to src/diazo/tests/v1-replace-both-children/output.html\ndiff --git a/lib/diazo/tests/v1-replace-both-children/rules.xml b/src/diazo/tests/v1-replace-both-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-both-children/rules.xml\nrename to src/diazo/tests/v1-replace-both-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-both-children/theme.html b/src/diazo/tests/v1-replace-both-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-both-children/theme.html\nrename to src/diazo/tests/v1-replace-both-children/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-content-children/content.html b/src/diazo/tests/v1-replace-content-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-children/content.html\nrename to src/diazo/tests/v1-replace-content-children/content.html\ndiff --git a/lib/diazo/tests/v1-replace-content-children/output.html b/src/diazo/tests/v1-replace-content-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-children/output.html\nrename to src/diazo/tests/v1-replace-content-children/output.html\ndiff --git a/lib/diazo/tests/v1-replace-content-children/rules.xml b/src/diazo/tests/v1-replace-content-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-children/rules.xml\nrename to src/diazo/tests/v1-replace-content-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-content-children/theme.html b/src/diazo/tests/v1-replace-content-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-children/theme.html\nrename to src/diazo/tests/v1-replace-content-children/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-content-conditional-1/content.html b/src/diazo/tests/v1-replace-content-conditional-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-conditional-1/content.html\nrename to src/diazo/tests/v1-replace-content-conditional-1/content.html\ndiff --git a/lib/diazo/tests/v1-replace-content-conditional-1/output.html b/src/diazo/tests/v1-replace-content-conditional-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-conditional-1/output.html\nrename to src/diazo/tests/v1-replace-content-conditional-1/output.html\ndiff --git a/lib/diazo/tests/v1-replace-content-conditional-1/rules.xml b/src/diazo/tests/v1-replace-content-conditional-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-conditional-1/rules.xml\nrename to src/diazo/tests/v1-replace-content-conditional-1/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-content-conditional-1/theme.html b/src/diazo/tests/v1-replace-content-conditional-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-conditional-1/theme.html\nrename to src/diazo/tests/v1-replace-content-conditional-1/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-content-conditional-2/content.html b/src/diazo/tests/v1-replace-content-conditional-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-conditional-2/content.html\nrename to src/diazo/tests/v1-replace-content-conditional-2/content.html\ndiff --git a/lib/diazo/tests/v1-replace-content-conditional-2/output.html b/src/diazo/tests/v1-replace-content-conditional-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-conditional-2/output.html\nrename to src/diazo/tests/v1-replace-content-conditional-2/output.html\ndiff --git a/lib/diazo/tests/v1-replace-content-conditional-2/rules.xml b/src/diazo/tests/v1-replace-content-conditional-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-conditional-2/rules.xml\nrename to src/diazo/tests/v1-replace-content-conditional-2/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-content-conditional-2/theme.html b/src/diazo/tests/v1-replace-content-conditional-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-conditional-2/theme.html\nrename to src/diazo/tests/v1-replace-content-conditional-2/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children-conditional-1/content.html b/src/diazo/tests/v1-replace-content-content-children-conditional-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children-conditional-1/content.html\nrename to src/diazo/tests/v1-replace-content-content-children-conditional-1/content.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children-conditional-1/output.html b/src/diazo/tests/v1-replace-content-content-children-conditional-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children-conditional-1/output.html\nrename to src/diazo/tests/v1-replace-content-content-children-conditional-1/output.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children-conditional-1/rules.xml b/src/diazo/tests/v1-replace-content-content-children-conditional-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children-conditional-1/rules.xml\nrename to src/diazo/tests/v1-replace-content-content-children-conditional-1/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children-conditional-1/theme.html b/src/diazo/tests/v1-replace-content-content-children-conditional-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children-conditional-1/theme.html\nrename to src/diazo/tests/v1-replace-content-content-children-conditional-1/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children-conditional-2/content.html b/src/diazo/tests/v1-replace-content-content-children-conditional-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children-conditional-2/content.html\nrename to src/diazo/tests/v1-replace-content-content-children-conditional-2/content.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children-conditional-2/output.html b/src/diazo/tests/v1-replace-content-content-children-conditional-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children-conditional-2/output.html\nrename to src/diazo/tests/v1-replace-content-content-children-conditional-2/output.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children-conditional-2/rules.xml b/src/diazo/tests/v1-replace-content-content-children-conditional-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children-conditional-2/rules.xml\nrename to src/diazo/tests/v1-replace-content-content-children-conditional-2/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children-conditional-2/theme.html b/src/diazo/tests/v1-replace-content-content-children-conditional-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children-conditional-2/theme.html\nrename to src/diazo/tests/v1-replace-content-content-children-conditional-2/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children/content.html b/src/diazo/tests/v1-replace-content-content-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children/content.html\nrename to src/diazo/tests/v1-replace-content-content-children/content.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children/output.html b/src/diazo/tests/v1-replace-content-content-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children/output.html\nrename to src/diazo/tests/v1-replace-content-content-children/output.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children/rules.xml b/src/diazo/tests/v1-replace-content-content-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children/rules.xml\nrename to src/diazo/tests/v1-replace-content-content-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children/theme.html b/src/diazo/tests/v1-replace-content-content-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children/theme.html\nrename to src/diazo/tests/v1-replace-content-content-children/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-content/content.html b/src/diazo/tests/v1-replace-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content/content.html\nrename to src/diazo/tests/v1-replace-content/content.html\ndiff --git a/lib/diazo/tests/v1-replace-content/output.html b/src/diazo/tests/v1-replace-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content/output.html\nrename to src/diazo/tests/v1-replace-content/output.html\ndiff --git a/lib/diazo/tests/v1-replace-content/rules.xml b/src/diazo/tests/v1-replace-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content/rules.xml\nrename to src/diazo/tests/v1-replace-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-content/theme.html b/src/diazo/tests/v1-replace-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content/theme.html\nrename to src/diazo/tests/v1-replace-content/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-theme-children/content.html b/src/diazo/tests/v1-replace-theme-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-theme-children/content.html\nrename to src/diazo/tests/v1-replace-theme-children/content.html\ndiff --git a/lib/diazo/tests/v1-replace-theme-children/output.html b/src/diazo/tests/v1-replace-theme-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-theme-children/output.html\nrename to src/diazo/tests/v1-replace-theme-children/output.html\ndiff --git a/lib/diazo/tests/v1-replace-theme-children/rules.xml b/src/diazo/tests/v1-replace-theme-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-theme-children/rules.xml\nrename to src/diazo/tests/v1-replace-theme-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-theme-children/theme.html b/src/diazo/tests/v1-replace-theme-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-theme-children/theme.html\nrename to src/diazo/tests/v1-replace-theme-children/theme.html\ndiff --git a/lib/diazo/tests/v1-replace/content.html b/src/diazo/tests/v1-replace/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace/content.html\nrename to src/diazo/tests/v1-replace/content.html\ndiff --git a/lib/diazo/tests/v1-replace/output.html b/src/diazo/tests/v1-replace/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace/output.html\nrename to src/diazo/tests/v1-replace/output.html\ndiff --git a/lib/diazo/tests/v1-replace/rules.xml b/src/diazo/tests/v1-replace/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace/rules.xml\nrename to src/diazo/tests/v1-replace/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace/theme.html b/src/diazo/tests/v1-replace/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace/theme.html\nrename to src/diazo/tests/v1-replace/theme.html\ndiff --git a/lib/diazo/tests/v1-strip-content/content.html b/src/diazo/tests/v1-strip-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-content/content.html\nrename to src/diazo/tests/v1-strip-content/content.html\ndiff --git a/lib/diazo/tests/v1-strip-content/output.html b/src/diazo/tests/v1-strip-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-content/output.html\nrename to src/diazo/tests/v1-strip-content/output.html\ndiff --git a/lib/diazo/tests/v1-strip-content/rules.xml b/src/diazo/tests/v1-strip-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-content/rules.xml\nrename to src/diazo/tests/v1-strip-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-strip-content/theme.html b/src/diazo/tests/v1-strip-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-content/theme.html\nrename to src/diazo/tests/v1-strip-content/theme.html\ndiff --git a/lib/diazo/tests/v1-strip-if-content/content.html b/src/diazo/tests/v1-strip-if-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-if-content/content.html\nrename to src/diazo/tests/v1-strip-if-content/content.html\ndiff --git a/lib/diazo/tests/v1-strip-if-content/output.html b/src/diazo/tests/v1-strip-if-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-if-content/output.html\nrename to src/diazo/tests/v1-strip-if-content/output.html\ndiff --git a/lib/diazo/tests/v1-strip-if-content/rules.xml b/src/diazo/tests/v1-strip-if-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-if-content/rules.xml\nrename to src/diazo/tests/v1-strip-if-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-strip-if-content/theme.html b/src/diazo/tests/v1-strip-if-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-if-content/theme.html\nrename to src/diazo/tests/v1-strip-if-content/theme.html\ndiff --git a/lib/diazo/tests/v1-strip-if-theme/content.html b/src/diazo/tests/v1-strip-if-theme/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-if-theme/content.html\nrename to src/diazo/tests/v1-strip-if-theme/content.html\ndiff --git a/lib/diazo/tests/v1-strip-if-theme/output.html b/src/diazo/tests/v1-strip-if-theme/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-if-theme/output.html\nrename to src/diazo/tests/v1-strip-if-theme/output.html\ndiff --git a/lib/diazo/tests/v1-strip-if-theme/rules.xml b/src/diazo/tests/v1-strip-if-theme/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-if-theme/rules.xml\nrename to src/diazo/tests/v1-strip-if-theme/rules.xml\ndiff --git a/lib/diazo/tests/v1-strip-if-theme/theme.html b/src/diazo/tests/v1-strip-if-theme/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-if-theme/theme.html\nrename to src/diazo/tests/v1-strip-if-theme/theme.html\ndiff --git a/lib/diazo/tests/v1-strip-theme/content.html b/src/diazo/tests/v1-strip-theme/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-theme/content.html\nrename to src/diazo/tests/v1-strip-theme/content.html\ndiff --git a/lib/diazo/tests/v1-strip-theme/output.html b/src/diazo/tests/v1-strip-theme/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-theme/output.html\nrename to src/diazo/tests/v1-strip-theme/output.html\ndiff --git a/lib/diazo/tests/v1-strip-theme/rules.xml b/src/diazo/tests/v1-strip-theme/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-theme/rules.xml\nrename to src/diazo/tests/v1-strip-theme/rules.xml\ndiff --git a/lib/diazo/tests/v1-strip-theme/theme.html b/src/diazo/tests/v1-strip-theme/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-theme/theme.html\nrename to src/diazo/tests/v1-strip-theme/theme.html\ndiff --git a/lib/diazo/tests/without-theme/content.html b/src/diazo/tests/without-theme/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/without-theme/content.html\nrename to src/diazo/tests/without-theme/content.html\ndiff --git a/lib/diazo/tests/without-theme/options.cfg b/src/diazo/tests/without-theme/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/without-theme/options.cfg\nrename to src/diazo/tests/without-theme/options.cfg\ndiff --git a/lib/diazo/tests/without-theme/output.html b/src/diazo/tests/without-theme/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/without-theme/output.html\nrename to src/diazo/tests/without-theme/output.html\ndiff --git a/lib/diazo/tests/without-theme/rules.xml b/src/diazo/tests/without-theme/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/without-theme/rules.xml\nrename to src/diazo/tests/without-theme/rules.xml\ndiff --git a/lib/diazo/tests/xinclude/content.html b/src/diazo/tests/xinclude/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/xinclude/content.html\nrename to src/diazo/tests/xinclude/content.html\ndiff --git a/lib/diazo/tests/xinclude/included-rules.xml b/src/diazo/tests/xinclude/included-rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/xinclude/included-rules.xml\nrename to src/diazo/tests/xinclude/included-rules.xml\ndiff --git a/lib/diazo/tests/xinclude/output.html b/src/diazo/tests/xinclude/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/xinclude/output.html\nrename to src/diazo/tests/xinclude/output.html\ndiff --git a/lib/diazo/tests/xinclude/rules.xml b/src/diazo/tests/xinclude/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/xinclude/rules.xml\nrename to src/diazo/tests/xinclude/rules.xml\ndiff --git a/lib/diazo/tests/xinclude/theme.html b/src/diazo/tests/xinclude/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/xinclude/theme.html\nrename to src/diazo/tests/xinclude/theme.html\ndiff --git a/lib/diazo/update-namespace.xsl b/src/diazo/update-namespace.xsl\nsimilarity index 100%\nrename from lib/diazo/update-namespace.xsl\nrename to src/diazo/update-namespace.xsl\ndiff --git a/lib/diazo/utils.py b/src/diazo/utils.py\nsimilarity index 100%\nrename from lib/diazo/utils.py\nrename to src/diazo/utils.py\ndiff --git a/lib/diazo/wsgi.py b/src/diazo/wsgi.py\nsimilarity index 100%\nrename from lib/diazo/wsgi.py\nrename to src/diazo/wsgi.py\n'

Repository: diazo


Branch: refs/heads/master
Date: 2024-01-29T22:56:25+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/diazo/commit/5a067191662b5c6cd6c8332fda0a15923f61c697

Update rest of the code to look in src, not lib.

Files changed:
M MANIFEST.in
M docs/deployment.rst
M setup.cfg
M setup.py

b'diff --git a/MANIFEST.in b/MANIFEST.in\nindex 980ed1b..5d5589d 100644\n--- a/MANIFEST.in\n+++ b/MANIFEST.in\n@@ -1,25 +1,12 @@\n # MANIFEST.in - Definition which files should be included in a release:\n \n # Files to include:\n-include *.txt\n-global-include *.rst\n-global-include *.cfg\n-global-include *.xsl\n-global-include *.py\n-global-include *.xsl\n-global-include *.zcml\n-global-include *.html\n-global-include *.css\n-global-include *.js\n-global-include *.cfg\n-global-include *.xml\n+include *.rst\n \n # Whitelist / Include Path completely:\n graft docs\n graft examples\n-graft lib\n-graft lib*\n-graft templates\n+graft src\n \n # Blacklist / Exclude Files and Path\n prune docs/_build\ndiff --git a/docs/deployment.rst b/docs/deployment.rst\nindex 2615649..ff518a9 100644\n--- a/docs/deployment.rst\n+++ b/docs/deployment.rst\n@@ -142,12 +142,12 @@ will need to compile Nginx with a special version of the XSLT module that\n can (optionally) use the HTML parser from libxml2.\n \n If you expect the source content to be xhtml well-formed and valid, then you\n-should be able to avoid the ``xslt_html_parser on;`` directive. You can \n+should be able to avoid the ``xslt_html_parser on;`` directive. You can\n achieve this if you generate the source content.\n \n-Otherwise, if you expect non-xhtml compliant html, you need to compile Nginx \n-from source. At the time of this writing, the html-xslt_ project proposes \n-full Nginx sources for Nginx 0.7 and 0.8, whereas Nginx is now 1.6 and 1.7. \n+Otherwise, if you expect non-xhtml compliant html, you need to compile Nginx\n+from source. At the time of this writing, the html-xslt_ project proposes\n+full Nginx sources for Nginx 0.7 and 0.8, whereas Nginx is now 1.6 and 1.7.\n Here is an alternative `patch\n <https://github.com/jcu-eresearch/nginx-custom-build/blob/master/nginx-xslt-html-parser.patch>`_\n you should be able to apply to any Nginx source code with the command-line\n@@ -155,7 +155,7 @@ you should be able to apply to any Nginx source code with the command-line\n \n In the future, the necessary patches to enable HTML mode parsing will\n hopefully be part of the standard Nginx distribution. There also is a\n-`Nginx ticket <http://trac.nginx.org/nginx/ticket/609>`_ asking for the \n+`Nginx ticket <http://trac.nginx.org/nginx/ticket/609>`_ asking for the\n xslt_html_parser in the http_xslt_module.\n \n Using a properly patched Nginx, you can configure it with XSLT support like\n@@ -301,7 +301,7 @@ below uses this parameter to apply a filter::\n     }\n \n In this example the sub-request is set to loop back on itself, so the include\n-is taken from a themed page. ``filter.xsl`` (in the lib/diazo directory) and\n+is taken from a themed page. ``filter.xsl`` (in the src/diazo directory) and\n ``theme.xsl`` should both be placed in the same directory as ``Nginx.conf``.\n \n An example buildout is available in ``Nginx.cfg`` in this package.\ndiff --git a/setup.cfg b/setup.cfg\nindex b2ce010..1adbac3 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -4,11 +4,9 @@ addopts = -ra\n testpaths =\n #    package-tests/\n \n-norecursedirs = fixures\n-\n [coverage:run]\n branch = True\n-source = lib\n+source = src\n \n [coverage:report]\n precision = 2\ndiff --git a/setup.py b/setup.py\nindex ff87f61..7be6131 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -29,8 +29,8 @@\n         version control, and not touch Diazo during deployment.""",\n     keywords="web theming",\n     long_description=long_desc,\n-    packages=find_packages("lib"),\n-    package_dir={"": "lib"},\n+    packages=find_packages("src"),\n+    package_dir={"": "src"},\n     include_package_data=True,\n     zip_safe=False,\n     author="Paul Everitt, Laurence Rowe and Martin Aspeli.",\n'

Repository: diazo


Branch: refs/heads/master
Date: 2024-01-29T22:56:58+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/diazo/commit/8b1ead3f6d213e32583fd339c3db502f78110416

pyupgrade

Files changed:
M docs/conf.py
M src/diazo/__init__.py
M src/diazo/compiler.py
M src/diazo/cssrules.py
M src/diazo/rules.py
M src/diazo/run.py
M src/diazo/runtrace.py
M src/diazo/tests/__init__.py
M src/diazo/tests/test_diazo.py
M src/diazo/tests/test_trace.py
M src/diazo/tests/test_wsgi.py
M src/diazo/utils.py
M src/diazo/wsgi.py

b'diff --git a/docs/conf.py b/docs/conf.py\nindex bb2cc95..d803f90 100644\n--- a/docs/conf.py\n+++ b/docs/conf.py\n@@ -1,4 +1,3 @@\n-# -*- coding: utf-8 -*-\n #\n # Diazo documentation build configuration file, created by\n # sphinx-quickstart on Tue Nov  2 18:58:07 2010.\n@@ -40,8 +39,8 @@\n master_doc = \'index\'\n \n # General information about the project.\n-project = u\'Diazo\'\n-copyright = u\'2011, Plone Foundation\'\n+project = \'Diazo\'\n+copyright = \'2011, Plone Foundation\'\n \n # The version info for the project you\'re documenting, acts as replacement for\n # |version| and |release|, also used in various other places throughout the\n@@ -178,8 +177,8 @@\n # Grouping the document tree into LaTeX files. List of tuples\n # (source start file, target name, title, author, documentclass [howto/manual]).\n latex_documents = [\n-  (\'index\', \'Diazo.tex\', u\'Diazo Documentation\',\n-   u\'Plone Foundation\', \'manual\'),\n+  (\'index\', \'Diazo.tex\', \'Diazo Documentation\',\n+   \'Plone Foundation\', \'manual\'),\n ]\n \n # The name of an image file (relative to this directory) to place at the top of\n@@ -211,6 +210,6 @@\n # One entry per manual page. List of tuples\n # (source start file, name, description, authors, manual section).\n man_pages = [\n-    (\'index\', \'diazo\', u\'Diazo Documentation\',\n-     [u\'Plone Foundation\'], 1)\n+    (\'index\', \'diazo\', \'Diazo Documentation\',\n+     [\'Plone Foundation\'], 1)\n ]\ndiff --git a/src/diazo/__init__.py b/src/diazo/__init__.py\nindex f442168..861028b 100644\n--- a/src/diazo/__init__.py\n+++ b/src/diazo/__init__.py\n@@ -1,5 +1,3 @@\n-# -*- coding: utf-8 -*-\n-\n import logging\n \n \ndiff --git a/src/diazo/compiler.py b/src/diazo/compiler.py\nindex 14e692b..d63f067 100644\n--- a/src/diazo/compiler.py\n+++ b/src/diazo/compiler.py\n@@ -1,5 +1,4 @@\n #!/usr/bin/env python\n-# -*- coding: utf-8 -*-\n """\\\n Usage: %prog [options] [-r] RULES [-t] THEME\n \n@@ -41,7 +40,7 @@ def set_parser(stylesheet, parser, compiler_parser=None):\n         compiler_parser = etree.XMLParser()\n     compiler_parser.resolvers.add(resolver)\n     identity = pkg_xsl(\'identity.xsl\', compiler_parser)\n-    output_doc = identity(dummy_doc, docurl="\'{name}\'".format(name=name))\n+    output_doc = identity(dummy_doc, docurl=f"\'{name}\'")\n     compiler_parser.resolvers.remove(resolver)\n     return output_doc\n \n@@ -61,7 +60,7 @@ def build_xsl_params_document(xsl_params):\n             \'{http://www.w3.org/1999/XSL/Transform}param\',\n         )\n         param_element.attrib[\'name\'] = param_name\n-        if isinstance(param_value, string_types):\n+        if isinstance(param_value, str):\n             param_element.text = param_value\n         else:\n             param_element.attrib[\'select\'] = str(quote_param(param_value))\ndiff --git a/src/diazo/cssrules.py b/src/diazo/cssrules.py\nindex 34f55ce..22f5e96 100644\n--- a/src/diazo/cssrules.py\n+++ b/src/diazo/cssrules.py\n@@ -1,5 +1,4 @@\n #!/usr/bin/env python\n-# -*- coding: utf-8 -*-\n """\\\n Usage: %prog RULES\n \n@@ -11,7 +10,6 @@\n </rules>\\\n """\n \n-from __future__ import absolute_import\n \n from cssselect import GenericTranslator\n from diazo import utils\ndiff --git a/src/diazo/rules.py b/src/diazo/rules.py\nindex a42cd42..ba89207 100644\n--- a/src/diazo/rules.py\n+++ b/src/diazo/rules.py\n@@ -1,5 +1,4 @@\n #!/usr/bin/env python\n-# -*- coding: utf-8 -*-\n """\\\n Usage: %prog [-r] RULES\n \n@@ -13,8 +12,8 @@\n from diazo.utils import pkg_xsl\n from lxml import etree\n from six import string_types\n-from six.moves.urllib.parse import urljoin\n-from six.moves.urllib.request import urlopen\n+from urllib.parse import urljoin\n+from urllib.request import urlopen\n \n import logging\n import re\n@@ -70,7 +69,7 @@ def add_identifiers(rules_doc):\n                 namespaces[\'xml\'],\n                 \'id\',\n             ),\n-            \'r{index}\'.format(index=index),\n+            f\'r{index}\',\n         )\n     return rules_doc\n \n@@ -80,7 +79,7 @@ def update_namespace(rules_doc):\n     """\n     update = False\n     for ns in (namespaces[\'old1\'], namespaces[\'old2\']):\n-        if rules_doc.xpath("//*[namespace-uri()=\'{ns:s}\']".format(ns=ns)):\n+        if rules_doc.xpath(f"//*[namespace-uri()=\'{ns:s}\']"):\n             logger.warning(\n                 \'The %s namespace is deprecated, use %s instead.\',\n                 ns,\n@@ -88,7 +87,7 @@ def update_namespace(rules_doc):\n             )\n             update = True\n     for ns in (namespaces[\'oldcss1\'], namespaces[\'oldcss2\']):\n-        if rules_doc.xpath("//@*[namespace-uri()=\'{ns:s}\']".format(ns=ns)):\n+        if rules_doc.xpath(f"//@*[namespace-uri()=\'{ns:s}\']"):\n             logger.warning(\n                 \'The %s namespace is deprecated, use %s instead.\',\n                 ns,\n@@ -237,7 +236,7 @@ def add_theme(\n     read_network=False,\n ):\n     if not read_network and \\\n-            isinstance(theme, string_types) and \\\n+            isinstance(theme, str) and \\\n             theme[:6] in (\'ftp://\', \'http:/\', \'https:\'):\n         raise ValueError(\n             "Supplied theme \'{theme}\', but network access denied.".format(\n@@ -328,7 +327,7 @@ def process_rules(\n         return rules_doc\n     if includemode is None:\n         includemode = \'document\'\n-    includemode = "\'{mode:s}\'".format(mode=includemode)\n+    includemode = f"\'{includemode:s}\'"\n     rules_doc = normalize_rules(rules_doc, includemode=includemode)\n     if stop == 7:\n         return rules_doc\ndiff --git a/src/diazo/run.py b/src/diazo/run.py\nindex 62264a7..96cfaa6 100644\n--- a/src/diazo/run.py\n+++ b/src/diazo/run.py\n@@ -1,5 +1,4 @@\n #!/usr/bin/env python\n-# -*- coding: utf-8 -*-\n """\\\n Usage: %prog -x TRANSFORM CONTENT\n \n@@ -143,15 +142,15 @@ def main():\n     content_doc = etree.parse(content, parser=parser)\n     params = {}\n     if options.path is not None:\n-        params[\'path\'] = "\'{path}\'".format(path=options.path)\n+        params[\'path\'] = f"\'{options.path}\'"\n \n     if options.parameters:\n         for key, value in split_params(options.parameters).items():\n             params[key] = quote_param(value)\n \n     output_html = transform(content_doc, **params)\n-    if isinstance(options.output, string_types):\n-        out = open(options.output, \'wt\')\n+    if isinstance(options.output, str):\n+        out = open(options.output, \'w\')\n     else:\n         out = options.output\n     out.write(str(output_html))\n@@ -165,7 +164,7 @@ def main():\n             if options.runtrace_xml == \'-\':\n                 out = sys.stdout\n             else:\n-                out = open(options.runtrace_xml, \'wt\')\n+                out = open(options.runtrace_xml, \'w\')\n             runtrace_doc.write(\n                 out,\n                 encoding=\'utf-8\',\n@@ -175,7 +174,7 @@ def main():\n             if options.runtrace_html == \'-\':\n                 out = sys.stdout\n             else:\n-                out = open(options.runtrace_html, \'wt\')\n+                out = open(options.runtrace_html, \'w\')\n             out.write(str(diazo.runtrace.runtrace_to_html(runtrace_doc)))\n \n     for msg in transform.error_log:\ndiff --git a/src/diazo/runtrace.py b/src/diazo/runtrace.py\nindex 44a50c6..0d73cfc 100644\n--- a/src/diazo/runtrace.py\n+++ b/src/diazo/runtrace.py\n@@ -1,5 +1,4 @@\n #!/usr/bin/env python\n-# -*- coding: utf-8 -*-\n \n from diazo.rules import process_rules\n from diazo.utils import pkg_xsl\ndiff --git a/src/diazo/tests/__init__.py b/src/diazo/tests/__init__.py\nindex c77d1f7..f832af4 100644\n--- a/src/diazo/tests/__init__.py\n+++ b/src/diazo/tests/__init__.py\n@@ -1,6 +1,3 @@\n-# -*- coding: utf-8 -*-\n-\n-\n def alltests():\n     from diazo.tests import test_diazo\n     from diazo.tests import test_trace\ndiff --git a/src/diazo/tests/test_diazo.py b/src/diazo/tests/test_diazo.py\nindex 6c5fd41..f8c11e3 100644\n--- a/src/diazo/tests/test_diazo.py\n+++ b/src/diazo/tests/test_diazo.py\n@@ -1,11 +1,5 @@\n-# -*- coding: utf-8 -*-\n-\n-from __future__ import print_function\n-\n-from builtins import str\n from diazo.utils import quote_param\n from io import BytesIO\n-from io import open\n from io import StringIO\n from lxml import etree\n \n@@ -79,7 +73,7 @@ def xml_compare(x1, x2):\n     """\n     if x1.tag != x2.tag:\n         return False\n-    for name, value in six.iteritems(x1.attrib):\n+    for name, value in x1.attrib.items():\n         if x2.attrib.get(name) != value:\n             return False\n     for name in x2.attrib:\n@@ -135,7 +129,7 @@ def suiteForParent(cls, parent, prefix):\n                 (DiazoTestCase,),\n                 dict(testdir=path),\n             )\n-            suite.addTest(unittest.makeSuite(test_cls))\n+            suite.addTest(unittest.defaultTestLoader.loadTestsFromTestCase(test_cls))\n         return suite\n \n     def testAll(self):\n@@ -200,8 +194,8 @@ def testAll(self):\n                 if self.warnings:\n                     print(\'WARNING:\', \'compiled.xsl has CHANGED\')\n                     for line in difflib.unified_diff(\n-                        old.split(u\'\\n\'),\n-                        new.split(u\'\\n\'),\n+                        old.split(\'\\n\'),\n+                        new.split(\'\\n\'),\n                         xslfn,\n                         \'now\',\n                     ):\n@@ -269,8 +263,8 @@ def testAll(self):\n                 # if self.writefiles:\n                 #    open(outputfn + \'.old\', \'w\').write(old)\n                 for line in difflib.unified_diff(\n-                    old.split(u\'\\n\'),\n-                    new.split(u\'\\n\'),\n+                    old.split(\'\\n\'),\n+                    new.split(\'\\n\'),\n                     outputfn,\n                     \'now\',\n                 ):\ndiff --git a/src/diazo/tests/test_trace.py b/src/diazo/tests/test_trace.py\nindex 619bf2a..808f3d3 100644\n--- a/src/diazo/tests/test_trace.py\n+++ b/src/diazo/tests/test_trace.py\n@@ -1,5 +1,3 @@\n-# -*- coding: utf-8 -*-\n-\n from io import BytesIO\n from lxml import etree\n \ndiff --git a/src/diazo/tests/test_wsgi.py b/src/diazo/tests/test_wsgi.py\nindex de522dd..1876ad7 100644\n--- a/src/diazo/tests/test_wsgi.py\n+++ b/src/diazo/tests/test_wsgi.py\n@@ -1,5 +1,3 @@\n-# -*- coding: utf-8 -*-\n-\n import os.path\n import sys\n import unittest\ndiff --git a/src/diazo/utils.py b/src/diazo/utils.py\nindex 5da81f4..5a3b4bf 100644\n--- a/src/diazo/utils.py\n+++ b/src/diazo/utils.py\n@@ -1,5 +1,3 @@\n-# -*- coding: utf-8 -*-\n-\n from lxml import etree\n from optparse import OptionParser\n from six import integer_types\n@@ -11,14 +9,11 @@\n import sys\n \n \n-if PY3:\n-    try:\n-        stdout = sys.stdout.buffer\n-    except AttributeError:\n-        # This can happen in (doc-)tests e. g. in plone.app.testing:\n-        stdout = None\n-else:\n-    stdout = sys.stdout\n+try:\n+    stdout = sys.stdout.buffer\n+except AttributeError:\n+    # This can happen in (doc-)tests e. g. in plone.app.testing:\n+    stdout = None\n \n strparam = etree.XSLT.strparam\n \n@@ -45,7 +40,7 @@ def namespace(name):\n \n \n def fullname(namespace, name):\n-    return \'{%s}%s\' % (namespace, name)  # NOQA: S001\n+    return f\'{{{namespace}}}{name}\'  # NOQA: S001\n \n \n AC_READ_FILE = etree.XSLTAccessControl(\n@@ -104,11 +99,11 @@ def quote_param(value):\n     Works with strings, booleans, numbers and None.\n     """\n \n-    if isinstance(value, string_types):\n+    if isinstance(value, str):\n         return strparam(value)\n     elif isinstance(value, bool):\n         return value and \'true()\' or \'false()\'\n-    elif isinstance(value, integer_types + (float,)):\n+    elif isinstance(value, (int,) + (float,)):\n         value = repr(value)\n     elif value is None:\n         return \'/..\'\ndiff --git a/src/diazo/wsgi.py b/src/diazo/wsgi.py\nindex 96b184e..f101f3f 100644\n--- a/src/diazo/wsgi.py\n+++ b/src/diazo/wsgi.py\n@@ -1,5 +1,3 @@\n-# -*- coding: utf-8 -*-\n-\n from diazo.compiler import compile_theme\n from diazo.utils import pkg_parse\n from diazo.utils import quote_param\n@@ -7,7 +5,7 @@\n from repoze.xmliter.serializer import XMLSerializer\n from repoze.xmliter.utils import getHTMLSerializer\n from six import string_types\n-from six.moves.urllib.parse import unquote_plus\n+from urllib.parse import unquote_plus\n from webob import Request\n \n import os.path\n@@ -19,7 +17,7 @@\n \n \n def asbool(value):\n-    if isinstance(value, string_types):\n+    if isinstance(value, str):\n         value = value.strip().lower()\n         if value in (\'true\', \'yes\', \'on\', \'y\', \'t\', \'1\', ):\n             return True\n@@ -98,22 +96,22 @@ def resolve(self, system_url, public_id, context):\n             \'text/javascript\',\n             \'application/x-javascript\',\n         ):\n-            result = u\'\'.join([\n-                u\'<html><body><script type="text/javascript">\',\n+            result = \'\'.join([\n+                \'<html><body><script type="text/javascript">\',\n                 result,\n-                u\'</script></body></html>\',\n+                \'</script></body></html>\',\n             ])\n         elif response.content_type == \'text/css\':\n-            result = u\'\'.join([\n-                u\'<html><body><style type="text/css">\',\n+            result = \'\'.join([\n+                \'<html><body><style type="text/css">\',\n                 result,\n-                u\'</style></body></html>\',\n+                \'</style></body></html>\',\n             ])\n \n         return self.resolve_string(result, context)\n \n \n-class XSLTMiddleware(object):\n+class XSLTMiddleware:\n     """Apply XSLT in middleware\n     """\n \n@@ -262,11 +260,11 @@ def __init__(\n         self.ignored_extensions = frozenset(ignored_extensions)\n \n         self.ignored_pattern = re.compile(\n-            \'^.*\\.({ext:s})$\'.format(ext=\'|\'.join(ignored_extensions)),\n+            r\'^.*\\.({ext:s})$\'.format(ext=\'|\'.join(ignored_extensions)),\n         )\n \n         self.environ_param_map = environ_param_map or {}\n-        if isinstance(unquoted_params, string_types):\n+        if isinstance(unquoted_params, str):\n             unquoted_params = unquoted_params.split()\n         self.unquoted_params = unquoted_params and \\\n             frozenset(unquoted_params) or ()\n@@ -415,7 +413,7 @@ def reset_headers(self, response):\n             response.charset = self.charset\n \n \n-class DiazoMiddleware(object):\n+class DiazoMiddleware:\n     """Invoke the Diazo transform as middleware\n     """\n \n'

Repository: diazo


Branch: refs/heads/master
Date: 2024-01-29T22:57:19+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/diazo/commit/e0de146a98084830615c48c1838297c3fb71f147

isort

Files changed:
M docs/conf.py

b'diff --git a/docs/conf.py b/docs/conf.py\nindex d803f90..e7c2f4a 100644\n--- a/docs/conf.py\n+++ b/docs/conf.py\n@@ -10,7 +10,9 @@\n # All configuration values have a default; values that are commented out\n # serve to show the default.\n \n-import sys, os\n+import os\n+import sys\n+\n \n # If extensions (or modules to document with autodoc) are in another directory,\n # add these directories to sys.path here. If the directory is relative to the\n'

Repository: diazo


Branch: refs/heads/master
Date: 2024-01-29T22:57:45+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/diazo/commit/e29c8ccce28a537020738778134c5a5ac743cc86

black

Files changed:
M docs/conf.py
M src/diazo/compiler.py
M src/diazo/cssrules.py
M src/diazo/rules.py
M src/diazo/run.py
M src/diazo/runtrace.py
M src/diazo/tests/__init__.py
M src/diazo/tests/test_diazo.py
M src/diazo/tests/test_trace.py
M src/diazo/tests/test_wsgi.py
M src/diazo/utils.py
M src/diazo/wsgi.py

b'diff --git a/docs/conf.py b/docs/conf.py\nindex e7c2f4a..998d32b 100644\n--- a/docs/conf.py\n+++ b/docs/conf.py\n@@ -17,97 +17,97 @@\n # If extensions (or modules to document with autodoc) are in another directory,\n # add these directories to sys.path here. If the directory is relative to the\n # documentation root, use os.path.abspath to make it absolute, like shown here.\n-#sys.path.insert(0, os.path.abspath(\'.\'))\n+# sys.path.insert(0, os.path.abspath(\'.\'))\n \n # -- General configuration -----------------------------------------------------\n \n # If your documentation needs a minimal Sphinx version, state it here.\n-#needs_sphinx = \'1.0\'\n+# needs_sphinx = \'1.0\'\n \n # Add any Sphinx extension module names here, as strings. They can be extensions\n # coming with Sphinx (named \'sphinx.ext.*\') or your custom ones.\n extensions = []\n \n # Add any paths that contain templates here, relative to this directory.\n-templates_path = [\'_templates\']\n+templates_path = ["_templates"]\n \n # The suffix of source filenames.\n-source_suffix = \'.rst\'\n+source_suffix = ".rst"\n \n # The encoding of source files.\n-#source_encoding = \'utf-8-sig\'\n+# source_encoding = \'utf-8-sig\'\n \n # The master toctree document.\n-master_doc = \'index\'\n+master_doc = "index"\n \n # General information about the project.\n-project = \'Diazo\'\n-copyright = \'2011, Plone Foundation\'\n+project = "Diazo"\n+copyright = "2011, Plone Foundation"\n \n # The version info for the project you\'re documenting, acts as replacement for\n # |version| and |release|, also used in various other places throughout the\n # built documents.\n #\n # The short X.Y version.\n-version = \'1.0b1\'\n+version = "1.0b1"\n # The full version, including alpha/beta/rc tags.\n-release = \'1.0b1\'\n+release = "1.0b1"\n \n # The language for content autogenerated by Sphinx. Refer to documentation\n # for a list of supported languages.\n-#language = None\n+# language = None\n \n # There are two options for replacing |today|: either, you set today to some\n # non-false value, then it is used:\n-#today = \'\'\n+# today = \'\'\n # Else, today_fmt is used as the format for a strftime call.\n-#today_fmt = \'%B %d, %Y\'\n+# today_fmt = \'%B %d, %Y\'\n \n # List of patterns, relative to source directory, that match files and\n # directories to ignore when looking for source files.\n-exclude_patterns = [\'_build\']\n+exclude_patterns = ["_build"]\n \n # The reST default role (used for this markup: `text`) to use for all documents.\n-#default_role = None\n+# default_role = None\n \n # If true, \'()\' will be appended to :func: etc. cross-reference text.\n-#add_function_parentheses = True\n+# add_function_parentheses = True\n \n # If true, the current module name will be prepended to all description\n # unit titles (such as .. function::).\n-#add_module_names = True\n+# add_module_names = True\n \n # If true, sectionauthor and moduleauthor directives will be shown in the\n # output. They are ignored by default.\n-#show_authors = False\n+# show_authors = False\n \n # The name of the Pygments (syntax highlighting) style to use.\n-pygments_style = \'sphinx\'\n+pygments_style = "sphinx"\n \n # A list of ignored prefixes for module index sorting.\n-#modindex_common_prefix = []\n+# modindex_common_prefix = []\n \n \n # -- Options for HTML output ---------------------------------------------------\n \n # The theme to use for HTML and HTML Help pages.  See the documentation for\n # a list of builtin themes.\n-html_theme = \'haiku\'\n+html_theme = "haiku"\n \n # Theme options are theme-specific and customize the look and feel of a theme\n # further.  For a list of options available for each theme, see the\n # documentation.\n-#html_theme_options = {}\n+# html_theme_options = {}\n \n # Add any paths that contain custom themes here, relative to this directory.\n-#html_theme_path = []\n+# html_theme_path = []\n \n # The name for this set of Sphinx documents.  If None, it defaults to\n # "<project> v<release> documentation".\n html_title = "Diazo"\n \n # A shorter title for the navigation bar.  Default is the same as html_title.\n-#html_short_title = None\n+# html_short_title = None\n \n # The name of an image file (relative to this directory) to place at the top\n # of the sidebar.\n@@ -116,102 +116,98 @@\n # The name of an image file (within the static path) to use as favicon of the\n # docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32\n # pixels large.\n-#html_favicon = None\n+# html_favicon = None\n \n # Add any paths that contain custom static files (such as style sheets) here,\n # relative to this directory. They are copied after the builtin static files,\n # so a file named "default.css" will overwrite the builtin "default.css".\n-html_static_path = [\'_static\']\n+html_static_path = ["_static"]\n \n # If not \'\', a \'Last updated on:\' timestamp is inserted at every page bottom,\n # using the given strftime format.\n-#html_last_updated_fmt = \'%b %d, %Y\'\n+# html_last_updated_fmt = \'%b %d, %Y\'\n \n # If true, SmartyPants will be used to convert quotes and dashes to\n # typographically correct entities.\n-#html_use_smartypants = True\n+# html_use_smartypants = True\n \n # Custom sidebar templates, maps document names to template names.\n-#html_sidebars = {}\n+# html_sidebars = {}\n \n # Additional templates that should be rendered to pages, maps page names to\n # template names.\n-#html_additional_pages = {}\n+# html_additional_pages = {}\n \n # If false, no module index is generated.\n-#html_domain_indices = True\n+# html_domain_indices = True\n \n # If false, no index is generated.\n-#html_use_index = True\n+# html_use_index = True\n \n # If true, the index is split into individual pages for each letter.\n-#html_split_index = False\n+# html_split_index = False\n \n # If true, links to the reST sources are added to the pages.\n-#html_show_sourcelink = True\n+# html_show_sourcelink = True\n \n # If true, "Created using Sphinx" is shown in the HTML footer. Default is True.\n-#html_show_sphinx = True\n+# html_show_sphinx = True\n \n # If true, "(C) Copyright ..." is shown in the HTML footer. Default is True.\n-#html_show_copyright = True\n+# html_show_copyright = True\n \n # If true, an OpenSearch description file will be output, and all pages will\n # contain a <link> tag referring to it.  The value of this option must be the\n # base URL from which the finished HTML is served.\n-#html_use_opensearch = \'\'\n+# html_use_opensearch = \'\'\n \n # This is the file name suffix for HTML files (e.g. ".xhtml").\n-#html_file_suffix = None\n+# html_file_suffix = None\n \n # Output file base name for HTML help builder.\n-htmlhelp_basename = \'Diazodoc\'\n+htmlhelp_basename = "Diazodoc"\n \n \n # -- Options for LaTeX output --------------------------------------------------\n \n # The paper size (\'letter\' or \'a4\').\n-#latex_paper_size = \'letter\'\n+# latex_paper_size = \'letter\'\n \n # The font size (\'10pt\', \'11pt\' or \'12pt\').\n-#latex_font_size = \'10pt\'\n+# latex_font_size = \'10pt\'\n \n # Grouping the document tree into LaTeX files. List of tuples\n # (source start file, target name, title, author, documentclass [howto/manual]).\n latex_documents = [\n-  (\'index\', \'Diazo.tex\', \'Diazo Documentation\',\n-   \'Plone Foundation\', \'manual\'),\n+    ("index", "Diazo.tex", "Diazo Documentation", "Plone Foundation", "manual"),\n ]\n \n # The name of an image file (relative to this directory) to place at the top of\n # the title page.\n-#latex_logo = None\n+# latex_logo = None\n \n # For "manual" documents, if this is true, then toplevel headings are parts,\n # not chapters.\n-#latex_use_parts = False\n+# latex_use_parts = False\n \n # If true, show page references after internal links.\n-#latex_show_pagerefs = False\n+# latex_show_pagerefs = False\n \n # If true, show URL addresses after external links.\n-#latex_show_urls = False\n+# latex_show_urls = False\n \n # Additional stuff for the LaTeX preamble.\n-#latex_preamble = \'\'\n+# latex_preamble = \'\'\n \n # Documents to append as an appendix to all manuals.\n-#latex_appendices = []\n+# latex_appendices = []\n \n # If false, no module index is generated.\n-#latex_domain_indices = True\n+# latex_domain_indices = True\n \n \n # -- Options for manual page output --------------------------------------------\n \n # One entry per manual page. List of tuples\n # (source start file, name, description, authors, manual section).\n-man_pages = [\n-    (\'index\', \'diazo\', \'Diazo Documentation\',\n-     [\'Plone Foundation\'], 1)\n-]\n+man_pages = [("index", "diazo", "Diazo Documentation", ["Plone Foundation"], 1)]\ndiff --git a/src/diazo/compiler.py b/src/diazo/compiler.py\nindex d63f067..51191af 100644\n--- a/src/diazo/compiler.py\n+++ b/src/diazo/compiler.py\n@@ -23,23 +23,23 @@\n import pkg_resources\n \n \n-logger = logging.getLogger(\'diazo\')\n+logger = logging.getLogger("diazo")\n usage = __doc__\n \n \n def set_parser(stylesheet, parser, compiler_parser=None):\n-    file_obj = pkg_resources.resource_filename(\'diazo\', \'dummy.html\')\n+    file_obj = pkg_resources.resource_filename("diazo", "dummy.html")\n     with open(file_obj) as file_handler:\n         dummy_doc = etree.parse(\n             file_handler,\n             parser=parser,\n         )\n-    name = \'file:///__diazo__\'\n+    name = "file:///__diazo__"\n     resolver = CustomResolver({name: stylesheet})\n     if compiler_parser is None:\n         compiler_parser = etree.XMLParser()\n     compiler_parser.resolvers.add(resolver)\n-    identity = pkg_xsl(\'identity.xsl\', compiler_parser)\n+    identity = pkg_xsl("identity.xsl", compiler_parser)\n     output_doc = identity(dummy_doc, docurl=f"\'{name}\'")\n     compiler_parser.resolvers.remove(resolver)\n     return output_doc\n@@ -48,8 +48,8 @@ def set_parser(stylesheet, parser, compiler_parser=None):\n def build_xsl_params_document(xsl_params):\n     if xsl_params is None:\n         xsl_params = {}\n-    if \'path\' not in xsl_params:\n-        xsl_params[\'path\'] = \'\'\n+    if "path" not in xsl_params:\n+        xsl_params["path"] = ""\n     known_params = etree.XML(\n         \'<xsl:stylesheet version="1.0" \'\n         \'xmlns:xsl="http://www.w3.org/1999/XSL/Transform" />\',\n@@ -57,14 +57,14 @@ def build_xsl_params_document(xsl_params):\n     for param_name, param_value in xsl_params.items():\n         param_element = etree.SubElement(\n             known_params,\n-            \'{http://www.w3.org/1999/XSL/Transform}param\',\n+            "{http://www.w3.org/1999/XSL/Transform}param",\n         )\n-        param_element.attrib[\'name\'] = param_name\n+        param_element.attrib["name"] = param_name\n         if isinstance(param_value, str):\n             param_element.text = param_value\n         else:\n-            param_element.attrib[\'select\'] = str(quote_param(param_value))\n-        param_element.tail = \'\\n\'\n+            param_element.attrib["select"] = str(quote_param(param_value))\n+        param_element.tail = "\\n"\n \n     return known_params\n \n@@ -124,7 +124,7 @@ def compile_theme(\n       names. Values are default values.\n     """\n     if access_control is not None:\n-        read_network = access_control.options[\'read_network\']\n+        read_network = access_control.options["read_network"]\n     rules_doc = process_rules(\n         rules=rules,\n         theme=theme,\n@@ -145,23 +145,25 @@ def compile_theme(\n     known_params = build_xsl_params_document(xsl_params)\n \n     # Create a pseudo resolver for this\n-    known_params_url = \'file:///__diazo_known_params__\'\n-    emit_stylesheet_resolver = CustomResolver({\n-        known_params_url: etree.tostring(known_params),\n-    })\n+    known_params_url = "file:///__diazo_known_params__"\n+    emit_stylesheet_resolver = CustomResolver(\n+        {\n+            known_params_url: etree.tostring(known_params),\n+        }\n+    )\n     emit_stylesheet_parser = etree.XMLParser()\n     emit_stylesheet_parser.resolvers.add(emit_stylesheet_resolver)\n \n     # Set up parameters\n     params = {}\n     if indent is not None:\n-        params[\'indent\'] = indent and "\'yes\'" or "\'no\'"\n-    params[\'known_params_url\'] = quote_param(known_params_url)\n-    params[\'runtrace\'] = \'1\' if runtrace else \'0\'\n+        params["indent"] = indent and "\'yes\'" or "\'no\'"\n+    params["known_params_url"] = quote_param(known_params_url)\n+    params["runtrace"] = "1" if runtrace else "0"\n \n     # Run the final stage compiler\n     emit_stylesheet = pkg_xsl(\n-        \'emit-stylesheet.xsl\',\n+        "emit-stylesheet.xsl",\n         parser=emit_stylesheet_parser,\n     )\n     compiled_doc = emit_stylesheet(rules_doc, **params)\n@@ -175,8 +177,7 @@ def compile_theme(\n \n \n def main():\n-    """Called from console script\n-    """\n+    """Called from console script"""\n     parser = _createOptionParser(usage=usage)\n     (options, args) = parser.parse_args()\n \n@@ -184,11 +185,11 @@ def main():\n         if len(args) == 2 and options.theme is None:\n             options.rules, options.theme = args\n         elif len(args) == 1:\n-            options.rules, = args\n+            (options.rules,) = args\n         else:\n-            parser.error(\'Wrong number of arguments.\')\n+            parser.error("Wrong number of arguments.")\n     elif args:\n-        parser.error(\'Wrong number of arguments.\')\n+        parser.error("Wrong number of arguments.")\n \n     if options.trace:\n         logger.setLevel(logging.DEBUG)\n@@ -209,13 +210,13 @@ def main():\n     )\n     root = output_xslt.getroot()\n     if not root.tail:\n-        root.tail = \'\\n\'\n+        root.tail = "\\n"\n     output_xslt.write(\n         options.output,\n-        encoding=\'utf-8\',\n+        encoding="utf-8",\n         pretty_print=options.pretty_print,\n     )\n \n \n-if __name__ == \'__main__\':\n+if __name__ == "__main__":\n     main()\ndiff --git a/src/diazo/cssrules.py b/src/diazo/cssrules.py\nindex 22f5e96..c651c50 100644\n--- a/src/diazo/cssrules.py\n+++ b/src/diazo/cssrules.py\n@@ -20,14 +20,14 @@\n import sys\n \n \n-logger = logging.getLogger(\'diazo\')\n+logger = logging.getLogger("diazo")\n usage = __doc__\n \n \n class LocationPathTranslator(GenericTranslator):\n     def xpath_descendant_combinator(self, left, right):\n         """right is a child, grand-child or further descendant of left"""\n-        return left.join(\'//\', right)\n+        return left.join("//", right)\n \n \n _generic_translator = GenericTranslator()\n@@ -35,50 +35,49 @@ def xpath_descendant_combinator(self, left, right):\n \n \n def convert_css_selectors(rules):\n-    """Convert css rules to xpath rules element tree in place\n-    """\n+    """Convert css rules to xpath rules element tree in place"""\n     # XXX: There is a :root pseudo-class  # NOQA: T000\n     # http://www.w3.org/TR/css3-selectors/#root-pseudo\n     # We may wish to add support to lxml.cssselect for it some day.\n     for element in rules.xpath(\n-        "//@*[namespace-uri()=\'{nsp}\']/..".format(nsp=utils.namespaces[\'css\']),\n+        "//@*[namespace-uri()=\'{nsp}\']/..".format(nsp=utils.namespaces["css"]),\n     ):\n         tag_namespace = utils.namespace(element.tag)\n         css_prefix = element.attrib.get(\n             utils.fullname(\n-                utils.namespaces[\'css\'],\n-                \'prefix\',\n+                utils.namespaces["css"],\n+                "prefix",\n             ),\n             None,\n         )\n         for name, value in element.attrib.items():\n             if not name.startswith(\n-                \'{%s}\' % utils.namespaces[\'css\'],  # NOQA: S001\n+                "{%s}" % utils.namespaces["css"],  # NOQA: S001\n             ):\n                 continue\n             localname = utils.localname(name)\n-            if localname == \'prefix\':\n+            if localname == "prefix":\n                 continue\n             if not value:\n-                element.attrib[localname] = \'\'\n+                element.attrib[localname] = ""\n                 continue\n             if (\n-                tag_namespace == utils.namespaces[\'diazo\'] and\n-                localname in\n-                (\n-                    \'content\',\n-                    \'content-children\',\n-                    \'if-content\',\n-                    \'if-not-content\',\n-                ) or (\n-                    tag_namespace == utils.namespaces[\'xsl\'] and\n-                    localname in (\'match\',)\n+                tag_namespace == utils.namespaces["diazo"]\n+                and localname\n+                in (\n+                    "content",\n+                    "content-children",\n+                    "if-content",\n+                    "if-not-content",\n+                )\n+                or (\n+                    tag_namespace == utils.namespaces["xsl"] and localname in ("match",)\n                 )\n             ):\n-                prefix = css_prefix or \'//\'\n+                prefix = css_prefix or "//"\n                 tr = _location_path_translator\n             else:\n-                prefix = css_prefix or \'descendant-or-self::\'\n+                prefix = css_prefix or "descendant-or-self::"\n                 tr = _generic_translator\n             element.attrib[localname] = tr.css_to_xpath(value, prefix=prefix)\n \n@@ -86,33 +85,32 @@ def convert_css_selectors(rules):\n \n \n def main():\n-    """Called from console script\n-    """\n+    """Called from console script"""\n     parser = OptionParser(usage=usage)\n     parser.add_option(\n-        \'-o\',\n-        \'--output\',\n-        metavar=\'output.html\',\n-        help=\'Output filename (instead of stdout)\',\n-        dest=\'output\',\n+        "-o",\n+        "--output",\n+        metavar="output.html",\n+        help="Output filename (instead of stdout)",\n+        dest="output",\n         default=sys.stdout,\n     )\n     parser.add_option(\n-        \'-p\',\n-        \'--pretty-print\',\n-        action=\'store_true\',\n-        help=\'Pretty print output\',\n-        dest=\'pretty_print\',\n+        "-p",\n+        "--pretty-print",\n+        action="store_true",\n+        help="Pretty print output",\n+        dest="pretty_print",\n         default=False,\n     )\n     (options, args) = parser.parse_args()\n \n     if len(args) != 1:\n-        parser.error(\'Invalid number of arguments\')\n+        parser.error("Invalid number of arguments")\n     rules = etree.parse(args[0])\n     convert_css_selectors(rules)\n     rules.write(options.output, pretty_print=options.pretty_print)\n \n \n-if __name__ == \'__main__\':\n+if __name__ == "__main__":\n     main()\ndiff --git a/src/diazo/rules.py b/src/diazo/rules.py\nindex ba89207..a25ec69 100644\n--- a/src/diazo/rules.py\n+++ b/src/diazo/rules.py\n@@ -19,7 +19,7 @@\n import re\n \n \n-logger = logging.getLogger(\'diazo\')\n+logger = logging.getLogger("diazo")\n usage = __doc__\n \n IMPORT_STYLESHEET = re.compile(\n@@ -32,23 +32,23 @@\n     r"""(?P<url>[^ \\t\\n\\r\\f\\v>]+)(?P<after>(?P=quote)[^>]*?>)""",\n     re.IGNORECASE,\n )\n-SRCSET = re.compile(r\'(?P<descriptors>^\\s*|\\s*,\\s*)(?P<url>[^\\s]*)\')\n+SRCSET = re.compile(r"(?P<descriptors>^\\s*|\\s*,\\s*)(?P<url>[^\\s]*)")\n \n \n-update_transform = pkg_xsl(\'update-namespace.xsl\')\n-normalize_rules = pkg_xsl(\'normalize-rules.xsl\')\n-include = pkg_xsl(\'include.xsl\')\n-apply_conditions = pkg_xsl(\'apply-conditions.xsl\')\n-merge_conditions = pkg_xsl(\'merge-conditions.xsl\')\n-annotate_themes = pkg_xsl(\'annotate-themes.xsl\')\n-annotate_rules = pkg_xsl(\'annotate-rules.xsl\')\n-apply_rules = pkg_xsl(\'apply-rules.xsl\')\n-fixup_themes = pkg_xsl(\'fixup-themes.xsl\')\n+update_transform = pkg_xsl("update-namespace.xsl")\n+normalize_rules = pkg_xsl("normalize-rules.xsl")\n+include = pkg_xsl("include.xsl")\n+apply_conditions = pkg_xsl("apply-conditions.xsl")\n+merge_conditions = pkg_xsl("merge-conditions.xsl")\n+annotate_themes = pkg_xsl("annotate-themes.xsl")\n+annotate_rules = pkg_xsl("annotate-rules.xsl")\n+apply_rules = pkg_xsl("apply-rules.xsl")\n+fixup_themes = pkg_xsl("fixup-themes.xsl")\n \n \n def anchor_safe_urljoin(base, url):\n     """Join the base with the url only when the url doesn\'t start with \'#\'"""\n-    if url.startswith(\'#\'):\n+    if url.startswith("#"):\n         return url\n     else:\n         return urljoin(base, url)\n@@ -58,40 +58,39 @@ def add_identifiers(rules_doc):\n     """Add identifiers to the rules for debugging"""\n     for index, elem in enumerate(\n         rules_doc.xpath(\n-            \'//diazo:rules | //diazo:rules/diazo:*\'\n-            \' | //old1:rules | //old1:rules/old1:*\'\n-            \' | //old2:rules | //old2:rules/old1:*\',\n+            "//diazo:rules | //diazo:rules/diazo:*"\n+            " | //old1:rules | //old1:rules/old1:*"\n+            " | //old2:rules | //old2:rules/old1:*",\n             namespaces=namespaces,\n         ),\n     ):\n         elem.set(\n             fullname(\n-                namespaces[\'xml\'],\n-                \'id\',\n+                namespaces["xml"],\n+                "id",\n             ),\n-            f\'r{index}\',\n+            f"r{index}",\n         )\n     return rules_doc\n \n \n def update_namespace(rules_doc):\n-    """Convert old namespace to new namespace in place\n-    """\n+    """Convert old namespace to new namespace in place"""\n     update = False\n-    for ns in (namespaces[\'old1\'], namespaces[\'old2\']):\n+    for ns in (namespaces["old1"], namespaces["old2"]):\n         if rules_doc.xpath(f"//*[namespace-uri()=\'{ns:s}\']"):\n             logger.warning(\n-                \'The %s namespace is deprecated, use %s instead.\',\n+                "The %s namespace is deprecated, use %s instead.",\n                 ns,\n-                namespaces[\'diazo\'],\n+                namespaces["diazo"],\n             )\n             update = True\n-    for ns in (namespaces[\'oldcss1\'], namespaces[\'oldcss2\']):\n+    for ns in (namespaces["oldcss1"], namespaces["oldcss2"]):\n         if rules_doc.xpath(f"//@*[namespace-uri()=\'{ns:s}\']"):\n             logger.warning(\n-                \'The %s namespace is deprecated, use %s instead.\',\n+                "The %s namespace is deprecated, use %s instead.",\n                 ns,\n-                namespaces[\'css\'],\n+                namespaces["css"],\n             )\n             update = True\n     if update:\n@@ -112,14 +111,14 @@ def update_namespace(rules_doc):\n def escape_curly_brackets(theme_doc):\n     for node in theme_doc.iter():\n         for attr in node.attrib:\n-            if \'{\' in node.attrib[attr]:\n-                node.attrib[attr] = node.attrib[attr].replace(\'{\', \'{{\')\n-            if \'}\' in node.attrib[attr]:\n-                node.attrib[attr] = node.attrib[attr].replace(\'}\', \'}}\')\n+            if "{" in node.attrib[attr]:\n+                node.attrib[attr] = node.attrib[attr].replace("{", "{{")\n+            if "}" in node.attrib[attr]:\n+                node.attrib[attr] = node.attrib[attr].replace("}", "}}")\n \n \n def expand_theme(element, theme_doc, absolute_prefix):\n-    prefix = urljoin(absolute_prefix, element.get(\'prefix\', \'\'))\n+    prefix = urljoin(absolute_prefix, element.get("prefix", ""))\n     apply_absolute_prefix(theme_doc, prefix)\n     escape_curly_brackets(theme_doc)\n     theme_root = theme_doc.getroot()\n@@ -137,27 +136,28 @@ def expand_themes(\n     absolute_prefix=None,\n     read_network=False,\n ):\n-    """Expand <theme href=\'...\'/> nodes with the theme html.\n-    """\n+    """Expand <theme href=\'...\'/> nodes with the theme html."""\n     if absolute_prefix is None:\n-        absolute_prefix = \'\'\n+        absolute_prefix = ""\n     base = rules_doc.docinfo.URL\n     if parser is None:\n         parser = etree.HTMLParser()\n     for element in rules_doc.xpath(\n-        \'//diazo:theme[@href]\',\n+        "//diazo:theme[@href]",\n         namespaces=namespaces,\n     ):\n-        url = urljoin(base, element.get(\'href\'))\n-        if not read_network and \\\n-                url.startswith((\'ftp://\', \'ftps://\', \'http://\', \'https://\')):\n+        url = urljoin(base, element.get("href"))\n+        if not read_network and url.startswith(\n+            ("ftp://", "ftps://", "http://", "https://")\n+        ):\n             raise ValueError(\n                 "Supplied theme \'{url}\', but network access denied.".format(\n                     url=url,\n                 ),\n             )\n-        elif read_network and \\\n-                url.startswith((\'ftp://\', \'ftps://\', \'http://\', \'https://\')):\n+        elif read_network and url.startswith(\n+            ("ftp://", "ftps://", "http://", "https://")\n+        ):\n             theme = urlopen(url)\n         else:\n             theme = url\n@@ -169,51 +169,58 @@ def expand_themes(\n def apply_absolute_prefix(theme_doc, absolute_prefix):\n     if not absolute_prefix:\n         return\n-    if not absolute_prefix.endswith(\'/\'):\n-        absolute_prefix = absolute_prefix + \'/\'\n-    for node in theme_doc.xpath(\'//*[@src]\'):\n-        url = urljoin(absolute_prefix, node.get(\'src\'))\n-        node.set(\'src\', url)\n+    if not absolute_prefix.endswith("/"):\n+        absolute_prefix = absolute_prefix + "/"\n+    for node in theme_doc.xpath("//*[@src]"):\n+        url = urljoin(absolute_prefix, node.get("src"))\n+        node.set("src", url)\n     for xlink_attr in theme_doc.xpath(\'//@*[local-name()="xlink:href"]\'):\n         node = xlink_attr.getparent()\n-        url = anchor_safe_urljoin(absolute_prefix, node.get(\'xlink:href\'))\n-        node.set(\'xlink:href\', url)\n-    for node in theme_doc.xpath(\'//*[@srcset]\'):\n-        srcset = node.get(\'srcset\')\n+        url = anchor_safe_urljoin(absolute_prefix, node.get("xlink:href"))\n+        node.set("xlink:href", url)\n+    for node in theme_doc.xpath("//*[@srcset]"):\n+        srcset = node.get("srcset")\n         srcset = SRCSET.sub(\n-            lambda match: match.group(\'descriptors\') + urljoin(\n+            lambda match: match.group("descriptors")\n+            + urljoin(\n                 absolute_prefix,\n-                match.group(\'url\'),\n+                match.group("url"),\n             ),\n             srcset,\n         )\n-        node.set(\'srcset\', srcset)\n-    for node in theme_doc.xpath(\'//*[@href]\'):\n-        url = anchor_safe_urljoin(absolute_prefix, node.get(\'href\'))\n-        node.set(\'href\', url)\n-    for node in theme_doc.xpath(\'//style\'):\n+        node.set("srcset", srcset)\n+    for node in theme_doc.xpath("//*[@href]"):\n+        url = anchor_safe_urljoin(absolute_prefix, node.get("href"))\n+        node.set("href", url)\n+    for node in theme_doc.xpath("//style"):\n         if node.text is None:\n             continue\n         node.text = IMPORT_STYLESHEET.sub(\n-            lambda match: match.group(\'before\') + urljoin(\n+            lambda match: match.group("before")\n+            + urljoin(\n                 absolute_prefix,\n-                match.group(\'url\'),\n-            ) + match.group(\'after\'),\n+                match.group("url"),\n+            )\n+            + match.group("after"),\n             node.text,\n         )\n     for node in theme_doc.xpath(\'//comment()[starts-with(., "[if")]\'):\n         node.text = IMPORT_STYLESHEET.sub(\n-            lambda match: match.group(\'before\') + urljoin(\n+            lambda match: match.group("before")\n+            + urljoin(\n                 absolute_prefix,\n-                match.group(\'url\'),\n-            ) + match.group(\'after\'),\n+                match.group("url"),\n+            )\n+            + match.group("after"),\n             node.text,\n         )\n         node.text = CONDITIONAL_SRC.sub(\n-            lambda match: match.group(\'before\') + urljoin(\n+            lambda match: match.group("before")\n+            + urljoin(\n                 absolute_prefix,\n-                match.group(\'url\'),\n-            ) + match.group(\'after\'),\n+                match.group("url"),\n+            )\n+            + match.group("after"),\n             node.text,\n         )\n \n@@ -221,7 +228,7 @@ def apply_absolute_prefix(theme_doc, absolute_prefix):\n def add_extra(rules_doc, extra):\n     root = rules_doc.getroot()\n     extra_elements = extra.xpath(\n-        \'/xsl:stylesheet/xsl:*\',\n+        "/xsl:stylesheet/xsl:*",\n         namespaces=namespaces,\n     )\n     root.extend(extra_elements)\n@@ -235,20 +242,22 @@ def add_theme(\n     absolute_prefix=None,\n     read_network=False,\n ):\n-    if not read_network and \\\n-            isinstance(theme, str) and \\\n-            theme[:6] in (\'ftp://\', \'http:/\', \'https:\'):\n+    if (\n+        not read_network\n+        and isinstance(theme, str)\n+        and theme[:6] in ("ftp://", "http:/", "https:")\n+    ):\n         raise ValueError(\n             "Supplied theme \'{theme}\', but network access denied.".format(\n                 theme=theme,\n             ),\n         )\n     if absolute_prefix is None:\n-        absolute_prefix = \'\'\n+        absolute_prefix = ""\n     if parser is None:\n         parser = etree.HTMLParser()\n     root = rules_doc.getroot()\n-    element = root.makeelement(fullname(namespaces[\'diazo\'], \'theme\'))\n+    element = root.makeelement(fullname(namespaces["diazo"], "theme"))\n     root.append(element)\n     theme_doc = etree.parse(theme, parser=parser)\n     expand_theme(element, theme_doc, absolute_prefix)\n@@ -261,9 +270,9 @@ def fixup_theme_comment_selectors(rules):\n     selector needs rewriting to replace comment() with xsl:comment\n     """\n     for element in rules.xpath("//@theme[contains(., \'comment()\')]/.."):\n-        element.attrib[\'theme\'] = element.attrib[\'theme\'].replace(\n-            \'comment()\',\n-            \'xsl:comment\',\n+        element.attrib["theme"] = element.attrib["theme"].replace(\n+            "comment()",\n+            "xsl:comment",\n         )\n     return rules\n \n@@ -284,9 +293,9 @@ def process_rules(\n     stop=None,\n ):\n     if trace:\n-        trace = \'1\'\n+        trace = "1"\n     else:\n-        trace = \'0\'\n+        trace = "0"\n     if rules_parser is None:\n         rules_parser = etree.XMLParser(recover=False)\n     rules_doc = etree.parse(rules, parser=rules_parser)\n@@ -301,7 +310,7 @@ def process_rules(\n     if stop == 1:\n         return rules_doc\n     rules_doc = add_identifiers(rules_doc)\n-    if stop == 2 or stop == \'add_identifiers\':\n+    if stop == 2 or stop == "add_identifiers":\n         return rules_doc\n     if update:\n         rules_doc = update_namespace(rules_doc)\n@@ -326,7 +335,7 @@ def process_rules(\n     if stop == 6:\n         return rules_doc\n     if includemode is None:\n-        includemode = \'document\'\n+        includemode = "document"\n     includemode = f"\'{includemode:s}\'"\n     rules_doc = normalize_rules(rules_doc, includemode=includemode)\n     if stop == 7:\n@@ -354,16 +363,15 @@ def process_rules(\n \n \n def main():\n-    """Called from console script\n-    """\n+    """Called from console script"""\n     parser = _createOptionParser(usage=usage)\n     parser.add_option(\n-        \'-s\',\n-        \'--stop\',\n-        metavar=\'n\',\n-        type=\'int\',\n-        help=\'Stop preprocessing at stage n\',\n-        dest=\'stop\',\n+        "-s",\n+        "--stop",\n+        metavar="n",\n+        type="int",\n+        help="Stop preprocessing at stage n",\n+        dest="stop",\n         default=None,\n     )\n     (options, args) = parser.parse_args()\n@@ -372,11 +380,11 @@ def main():\n         if len(args) == 2 and options.theme is None:\n             options.rules, options.theme = args\n         elif len(args) == 1:\n-            options.rules, = args\n+            (options.rules,) = args\n         else:\n-            parser.error(\'Wrong number of arguments.\')\n+            parser.error("Wrong number of arguments.")\n     elif args:\n-        parser.error(\'Wrong number of arguments.\')\n+        parser.error("Wrong number of arguments.")\n \n     if options.trace:\n         logger.setLevel(logging.DEBUG)\n@@ -393,9 +401,9 @@ def main():\n     )\n     root = rules_doc.getroot()\n     if not root.tail:\n-        root.tail = \'\\n\'\n+        root.tail = "\\n"\n     rules_doc.write(options.output, pretty_print=options.pretty_print)\n \n \n-if __name__ == \'__main__\':\n+if __name__ == "__main__":\n     main()\ndiff --git a/src/diazo/run.py b/src/diazo/run.py\nindex 96cfaa6..a331f68 100644\n--- a/src/diazo/run.py\n+++ b/src/diazo/run.py\n@@ -23,7 +23,7 @@\n import sys\n \n \n-logger = logging.getLogger(\'diazo\')\n+logger = logging.getLogger("diazo")\n usage = __doc__\n \n \n@@ -34,7 +34,7 @@ def __init__(self, directory):\n     def resolve(self, url, id, context):\n         # libxml2 does not do this correctly on it\'s own with the HTMLParser\n         # but it does work in Apache\n-        if \'://\' in url or url.startswith(\'/\'):\n+        if "://" in url or url.startswith("/"):\n             # It seems we must explicitly resolve the url here\n             return self.resolve_filename(url, context)\n         url = os.path.join(self.directory, url)\n@@ -42,63 +42,62 @@ def resolve(self, url, id, context):\n \n \n def main():\n-    """Called from console script\n-    """\n+    """Called from console script"""\n     op = _createOptionParser(usage=usage)\n     op.add_option(\n-        \'-x\',\n-        \'--xsl\',\n-        metavar=\'transform.xsl\',\n-        help=\'XSL transform\',\n-        dest=\'xsl\',\n+        "-x",\n+        "--xsl",\n+        metavar="transform.xsl",\n+        help="XSL transform",\n+        dest="xsl",\n         default=None,\n     )\n     op.add_option(\n-        \'--path\',\n-        metavar=\'PATH\',\n-        help=\'URI path\',\n-        dest=\'path\',\n+        "--path",\n+        metavar="PATH",\n+        help="URI path",\n+        dest="path",\n         default=None,\n     )\n     op.add_option(\n-        \'--parameters\',\n-        metavar=\'param1=val1,param2=val2\',\n-        help=\'Set the values of arbitrary parameters\',\n-        dest=\'parameters\',\n+        "--parameters",\n+        metavar="param1=val1,param2=val2",\n+        help="Set the values of arbitrary parameters",\n+        dest="parameters",\n         default=None,\n     )\n     op.add_option(\n-        \'--runtrace-xml\',\n-        metavar=\'runtrace.xml\',\n-        help=\'Write an xml format runtrace to file\',\n-        dest=\'runtrace_xml\',\n+        "--runtrace-xml",\n+        metavar="runtrace.xml",\n+        help="Write an xml format runtrace to file",\n+        dest="runtrace_xml",\n         default=None,\n     )\n     op.add_option(\n-        \'--runtrace-html\',\n-        metavar=\'runtrace.html\',\n-        help=\'Write an html format runtrace to file\',\n-        dest=\'runtrace_html\',\n+        "--runtrace-html",\n+        metavar="runtrace.html",\n+        help="Write an html format runtrace to file",\n+        dest="runtrace_html",\n         default=None,\n     )\n     (options, args) = op.parse_args()\n \n     if len(args) > 2:\n-        op.error(\'Wrong number of arguments.\')\n+        op.error("Wrong number of arguments.")\n     elif len(args) == 2:\n         if options.xsl or options.rules:\n-            op.error(\'Wrong number of arguments.\')\n+            op.error("Wrong number of arguments.")\n         path, content = args\n-        if path.lower().endswith(\'.xsl\'):\n+        if path.lower().endswith(".xsl"):\n             options.xsl = path\n         else:\n             options.rules = path\n     elif len(args) == 1:\n-        content, = args\n+        (content,) = args\n     else:\n-        op.error(\'Wrong number of arguments.\')\n+        op.error("Wrong number of arguments.")\n     if options.rules is None and options.xsl is None:\n-        op.error(\'Must supply either options or rules\')\n+        op.error("Must supply either options or rules")\n \n     if options.trace:\n         logger.setLevel(logging.DEBUG)\n@@ -130,7 +129,7 @@ def main():\n             runtrace=runtrace,\n         )\n \n-    if content == \'-\':\n+    if content == "-":\n         content = sys.stdin\n \n     if options.read_network:\n@@ -142,7 +141,7 @@ def main():\n     content_doc = etree.parse(content, parser=parser)\n     params = {}\n     if options.path is not None:\n-        params[\'path\'] = f"\'{options.path}\'"\n+        params["path"] = f"\'{options.path}\'"\n \n     if options.parameters:\n         for key, value in split_params(options.parameters).items():\n@@ -150,7 +149,7 @@ def main():\n \n     output_html = transform(content_doc, **params)\n     if isinstance(options.output, str):\n-        out = open(options.output, \'w\')\n+        out = open(options.output, "w")\n     else:\n         out = options.output\n     out.write(str(output_html))\n@@ -161,26 +160,26 @@ def main():\n             error_log=transform.error_log,\n         )\n         if options.runtrace_xml:\n-            if options.runtrace_xml == \'-\':\n+            if options.runtrace_xml == "-":\n                 out = sys.stdout\n             else:\n-                out = open(options.runtrace_xml, \'w\')\n+                out = open(options.runtrace_xml, "w")\n             runtrace_doc.write(\n                 out,\n-                encoding=\'utf-8\',\n+                encoding="utf-8",\n                 pretty_print=options.pretty_print,\n             )\n         if options.runtrace_html:\n-            if options.runtrace_html == \'-\':\n+            if options.runtrace_html == "-":\n                 out = sys.stdout\n             else:\n-                out = open(options.runtrace_html, \'w\')\n+                out = open(options.runtrace_html, "w")\n             out.write(str(diazo.runtrace.runtrace_to_html(runtrace_doc)))\n \n     for msg in transform.error_log:\n-        if not msg.message.startswith(\'<runtrace \'):\n+        if not msg.message.startswith("<runtrace "):\n             logger.warn(msg)\n \n \n-if __name__ == \'__main__\':\n+if __name__ == "__main__":\n     main()\ndiff --git a/src/diazo/runtrace.py b/src/diazo/runtrace.py\nindex 0d73cfc..5354ccd 100644\n--- a/src/diazo/runtrace.py\n+++ b/src/diazo/runtrace.py\n@@ -7,41 +7,44 @@\n import logging\n \n \n-logger = logging.getLogger(\'diazo\')\n+logger = logging.getLogger("diazo")\n \n-_runtrace_to_html = pkg_xsl(\'runtrace_to_html.xsl\')\n+_runtrace_to_html = pkg_xsl("runtrace_to_html.xsl")\n \n \n def log_to_xml_string(error_log):\n-    msgs = [l.message for l in error_log if l.message.startswith(\'<runtrace \')]\n+    msgs = [l.message for l in error_log if l.message.startswith("<runtrace ")]\n     return """\n <runtrace xmlns:css="http://namespaces.plone.org/diazo/css">\n     {message:s}\n </runtrace>\n-""".format(message=\'\'.join(msgs))\n+""".format(\n+        message="".join(msgs)\n+    )\n \n \n def generate_runtrace(rules, error_log, rules_parser=None):\n     """Annotate a rules file with the results of a transformation"""\n+\n     def condition_name(trace):\n         """Generate attribute name for this entry"""\n         for k in trace.attrib.keys():\n-            if(k == \'theme_xmlid\'):\n+            if k == "theme_xmlid":\n                 continue\n-            if(k.startswith(\'{http://namespaces.plone.org/diazo/css}\')):\n+            if k.startswith("{http://namespaces.plone.org/diazo/css}"):\n                 continue\n-            return \'runtrace-\' + k\n+            return "runtrace-" + k\n \n     rules_doc = process_rules(\n         rules,\n         rules_parser=rules_parser,\n-        stop=\'add_identifiers\',\n+        stop="add_identifiers",\n     )\n     trace_doc = etree.XML(log_to_xml_string(error_log))\n \n-    for trace in trace_doc.xpath(\'/runtrace/runtrace\'):\n-        for el in rules_doc.xpath("id(\'" + trace.attrib[\'theme_xmlid\'] + "\')"):\n-            el.set(condition_name(trace), trace.text or \'\')\n+    for trace in trace_doc.xpath("/runtrace/runtrace"):\n+        for el in rules_doc.xpath("id(\'" + trace.attrib["theme_xmlid"] + "\')"):\n+            el.set(condition_name(trace), trace.text or "")\n     return rules_doc\n \n \n@@ -52,17 +55,19 @@ def runtrace_to_html(runtrace_doc):\n \n def error_log_to_html(error_log):\n     """Convert an error log into an HTML representation"""\n-    doc = etree.Element(\'ul\')\n+    doc = etree.Element("ul")\n     for l in error_log:\n-        if l.message.startswith(\'<runtrace \'):\n+        if l.message.startswith("<runtrace "):\n             continue\n-        el = etree.Element(\'li\')\n-        el.attrib[\'class\'] = \'domain_{domain_name} level_{level_name} type_{type_name}\'.format(  # NOQA: E501\n+        el = etree.Element("li")\n+        el.attrib[\n+            "class"\n+        ] = "domain_{domain_name} level_{level_name} type_{type_name}".format(  # NOQA: E501\n             domain_name=l.domain_name,\n             level_name=l.level_name,\n             type_name=l.type_name,\n         )\n-        el.text = \'{msg:s} [{line:d}:{column:d}]\'.format(\n+        el.text = "{msg:s} [{line:d}:{column:d}]".format(\n             msg=l.message,\n             line=l.line,\n             column=l.column,\n@@ -78,31 +83,36 @@ def generate_debug_html(\n     rules_parser=None,\n ):\n     """Generate an HTML node with debug info"""\n+\n     def newElement(tag, content, **kwargs):\n         n = etree.Element(tag, **kwargs)\n-        if getattr(content, \'tag\', None):\n+        if getattr(content, "tag", None):\n             n.append(content)\n         else:\n             n.text = content\n         return n\n \n-    debug_output_iframe = etree.Element(\'div\', id=\'diazo-debug-iframe\')\n-    debug_output_iframe.attrib[\'style\'] = \'display:none\'\n-    debug_output_iframe.attrib[\'data-iframe\'] = \'diazo-debug\'\n-    debug_output_iframe.attrib[\'data-iframe-style\'] = \'\'\n-    debug_output_iframe.attrib[\'data-iframe-position\'] = \'bottom\'\n-    debug_output_iframe.attrib[\'data-iframe-resources\'] = \\\n-        base_url + \'/diazo-debug.css;\' + \\\n-        base_url + \'/jquery-1.8.3.min.js;\' + \\\n-        base_url + \'/diazo-debug.js\'\n-    debug_output = etree.Element(\'div\', id=\'diazo-debug\')\n+    debug_output_iframe = etree.Element("div", id="diazo-debug-iframe")\n+    debug_output_iframe.attrib["style"] = "display:none"\n+    debug_output_iframe.attrib["data-iframe"] = "diazo-debug"\n+    debug_output_iframe.attrib["data-iframe-style"] = ""\n+    debug_output_iframe.attrib["data-iframe-position"] = "bottom"\n+    debug_output_iframe.attrib["data-iframe-resources"] = (\n+        base_url\n+        + "/diazo-debug.css;"\n+        + base_url\n+        + "/jquery-1.8.3.min.js;"\n+        + base_url\n+        + "/diazo-debug.js"\n+    )\n+    debug_output = etree.Element("div", id="diazo-debug")\n \n     if error_log:\n         debug_output.append(\n             newElement(\n-                \'section\',\n+                "section",\n                 error_log_to_html(error_log),\n-                id=\'diazo_error_log\',\n+                id="diazo_error_log",\n             ),\n         )\n \n@@ -110,27 +120,27 @@ def newElement(tag, content, **kwargs):\n         runtrace_doc = generate_runtrace(rules, error_log, rules_parser)\n         debug_output.append(\n             newElement(\n-                \'section\',\n+                "section",\n                 runtrace_to_html(runtrace_doc).getroot(),\n-                id=\'diazo_runtrace\',\n+                id="diazo_runtrace",\n             ),\n         )\n     except etree.XMLSyntaxError:\n         debug_output.append(\n             newElement(\n-                \'section\',\n-                \'Rules document could not be parsed!\',\n-                id=\'diazo_runtrace\',\n+                "section",\n+                "Rules document could not be parsed!",\n+                id="diazo_runtrace",\n             ),\n         )\n \n     debug_output_iframe.append(debug_output)\n     debug_output_iframe.append(\n         newElement(\n-            \'script\',\n-            \' \',\n-            text=\'text/javascript\',\n-            src=base_url + \'/iframe.js\',\n+            "script",\n+            " ",\n+            text="text/javascript",\n+            src=base_url + "/iframe.js",\n         ),\n     )\n     return debug_output_iframe\ndiff --git a/src/diazo/tests/__init__.py b/src/diazo/tests/__init__.py\nindex f832af4..c7fd5ab 100644\n--- a/src/diazo/tests/__init__.py\n+++ b/src/diazo/tests/__init__.py\n@@ -4,6 +4,7 @@ def alltests():\n     from diazo.tests import test_wsgi\n \n     import unittest\n+\n     modules = [\n         test_trace,\n         test_wsgi,\ndiff --git a/src/diazo/tests/test_diazo.py b/src/diazo/tests/test_diazo.py\nindex f8c11e3..e2b9be1 100644\n--- a/src/diazo/tests/test_diazo.py\n+++ b/src/diazo/tests/test_diazo.py\n@@ -23,13 +23,13 @@\n     import ConfigParser as configparser\n \n \n-if __name__ == \'__main__\':\n+if __name__ == "__main__":\n     __file__ = sys.argv[0]\n \n \n defaultsfn = pkg_resources.resource_filename(\n-    \'diazo.tests\',\n-    \'default-options.cfg\',\n+    "diazo.tests",\n+    "default-options.cfg",\n )\n \n \n@@ -38,9 +38,9 @@ def text_compare(t1, t2):\n     # See note in xml_compare below.\n     if not t1 and not t2:\n         return True\n-    if t1 == \'*\' or t2 == \'*\':\n+    if t1 == "*" or t2 == "*":\n         return True\n-    return (t1 or \'\').strip() == (t2 or \'\').strip()\n+    return (t1 or "").strip() == (t2 or "").strip()\n \n \n def xml_compare(x1, x2):\n@@ -96,33 +96,31 @@ def xml_compare(x1, x2):\n \n \n class DiazoTestCase(unittest.TestCase):\n-\n-    writefiles = os.environ.get(\'DiazoTESTS_WRITE_FILES\', False)\n+    writefiles = os.environ.get("DiazoTESTS_WRITE_FILES", False)\n     warnings = os.environ.get(\n-        \'DiazoTESTS_WARN\',\n-        \'1\',\n-    ).lower() not in (\'0\', \'false\', \'off\')\n+        "DiazoTESTS_WARN",\n+        "1",\n+    ).lower() not in ("0", "false", "off")\n \n     testdir = os.path.realpath(__file__)\n \n     @classmethod\n     def suiteForParent(cls, parent, prefix):\n-        """Return a suite of diazo tests, one for each directory in parent.\n-        """\n+        """Return a suite of diazo tests, one for each directory in parent."""\n         suite = unittest.TestSuite()\n         for name in os.listdir(parent):\n-            if name.startswith(\'.\'):\n+            if name.startswith("."):\n                 continue\n             path = os.path.join(parent, name)\n             if not os.path.isdir(path):\n                 continue\n \n-            contentpath = os.path.join(path, \'content.html\')\n+            contentpath = os.path.join(path, "content.html")\n             if not os.path.isfile(contentpath):\n                 continue\n \n             test_cls = type(\n-                \'{prefix:s}-{name:s}\'.format(\n+                "{prefix:s}-{name:s}".format(\n                     prefix=prefix,\n                     name=name,\n                 ),\n@@ -135,27 +133,28 @@ def suiteForParent(cls, parent, prefix):\n     def testAll(self):\n         self.errors = BytesIO()\n         config = configparser.ConfigParser()\n-        config.read([defaultsfn, os.path.join(self.testdir, \'options.cfg\')])\n+        config.read([defaultsfn, os.path.join(self.testdir, "options.cfg")])\n \n         themefn = None\n-        if config.get(\'diazotest\', \'theme\'):\n+        if config.get("diazotest", "theme"):\n             themefn = os.path.join(\n                 self.testdir,\n-                config.get(\'diazotest\', \'theme\'),\n+                config.get("diazotest", "theme"),\n             )\n-        contentfn = os.path.join(self.testdir, \'content.html\')\n-        rulesfn = os.path.join(self.testdir, \'rules.xml\')\n-        xpathsfn = os.path.join(self.testdir, \'xpaths.txt\')\n-        xslfn = os.path.join(self.testdir, \'compiled.xsl\')\n-        outputfn = os.path.join(self.testdir, \'output.html\')\n+        contentfn = os.path.join(self.testdir, "content.html")\n+        rulesfn = os.path.join(self.testdir, "rules.xml")\n+        xpathsfn = os.path.join(self.testdir, "xpaths.txt")\n+        xslfn = os.path.join(self.testdir, "compiled.xsl")\n+        outputfn = os.path.join(self.testdir, "output.html")\n \n         xsl_params = {}\n-        extra_params = config.get(\'diazotest\', \'extra-params\')\n+        extra_params = config.get("diazotest", "extra-params")\n         if extra_params:\n-            for token in extra_params.split(\' \'):\n-                token_split = token.split(\':\')\n-                xsl_params[token_split[0]] = len(token_split) > 1 and \\\n-                    token_split[1] or None\n+            for token in extra_params.split(" "):\n+                token_split = token.split(":")\n+                xsl_params[token_split[0]] = (\n+                    len(token_split) > 1 and token_split[1] or None\n+                )\n \n         if not os.path.exists(rulesfn):\n             return\n@@ -172,13 +171,13 @@ def testAll(self):\n             rules=rulesfn,\n             theme=themefn,\n             parser=theme_parser,\n-            absolute_prefix=config.get(\'diazotest\', \'absolute-prefix\'),\n-            indent=config.getboolean(\'diazotest\', \'pretty-print\'),\n+            absolute_prefix=config.get("diazotest", "absolute-prefix"),\n+            indent=config.getboolean("diazotest", "pretty-print"),\n             xsl_params=xsl_params,\n         )\n \n         # Serialize / parse the theme - this can catch problems with escaping.\n-        cts = etree.tostring(ct, encoding=\'unicode\')\n+        cts = etree.tostring(ct, encoding="unicode")\n         parser = etree.XMLParser()\n         etree.fromstring(cts, parser=parser)\n \n@@ -189,34 +188,34 @@ def testAll(self):\n             new = cts\n             if old != new:\n                 if self.writefiles:\n-                    with open(xslfn + \'.old\', \'w\') as f:\n+                    with open(xslfn + ".old", "w") as f:\n                         f.write(old)\n                 if self.warnings:\n-                    print(\'WARNING:\', \'compiled.xsl has CHANGED\')\n+                    print("WARNING:", "compiled.xsl has CHANGED")\n                     for line in difflib.unified_diff(\n-                        old.split(\'\\n\'),\n-                        new.split(\'\\n\'),\n+                        old.split("\\n"),\n+                        new.split("\\n"),\n                         xslfn,\n-                        \'now\',\n+                        "now",\n                     ):\n                         print(line)\n \n         # Write the compiled xsl out to catch unexpected changes\n         if self.writefiles:\n-            with open(xslfn, \'w\') as f:\n+            with open(xslfn, "w") as f:\n                 f.write(cts)\n \n         # Apply the compiled version, then test against desired output\n         theme_parser.resolvers.add(diazo.run.RunResolver(self.testdir))\n         processor = etree.XSLT(ct)\n         params = {}\n-        params[\'path\'] = "\'{path:s}\'".format(\n-            path=config.get(\'diazotest\', \'path\'),\n+        params["path"] = "\'{path:s}\'".format(\n+            path=config.get("diazotest", "path"),\n         )\n \n         for key in xsl_params:\n             try:\n-                params[key] = quote_param(config.get(\'diazotest\', key))\n+                params[key] = quote_param(config.get("diazotest", key))\n             except configparser.NoOptionError:\n                 pass\n \n@@ -232,8 +231,7 @@ def testAll(self):\n \n         # remove the extra meta content type\n \n-        metas = self.themed_content.xpath(\n-            "/html/head/meta[@http-equiv=\'Content-Type\']")\n+        metas = self.themed_content.xpath("/html/head/meta[@http-equiv=\'Content-Type\']")\n         if metas:\n             meta = metas[0]\n             meta.getparent().remove(meta)\n@@ -244,16 +242,18 @@ def testAll(self):\n                     # Read the XPaths from the file, skipping blank lines and\n                     # comments\n                     this_xpath = xpath.strip()\n-                    if not this_xpath or this_xpath[0] == \'#\':\n+                    if not this_xpath or this_xpath[0] == "#":\n                         continue\n-                    assert self.themed_content.xpath(this_xpath), \'{key:s}: {value:s}\'.format(  # NOQA: E501\n+                    assert self.themed_content.xpath(\n+                        this_xpath\n+                    ), "{key:s}: {value:s}".format(  # NOQA: E501\n                         key=xpathsfn,\n                         value=this_xpath,\n                     )\n \n         # Compare to previous version\n         if os.path.exists(outputfn):\n-            with open(outputfn, \'rb\') as f:\n+            with open(outputfn, "rb") as f:\n                 old = f.read()\n             new = self.themed_string\n             if not xml_compare(\n@@ -263,30 +263,30 @@ def testAll(self):\n                 # if self.writefiles:\n                 #    open(outputfn + \'.old\', \'w\').write(old)\n                 for line in difflib.unified_diff(\n-                    old.split(\'\\n\'),\n-                    new.split(\'\\n\'),\n+                    old.split("\\n"),\n+                    new.split("\\n"),\n                     outputfn,\n-                    \'now\',\n+                    "now",\n                 ):\n                     print(line)\n-                assert old == new, \'output.html has CHANGED\'\n+                assert old == new, "output.html has CHANGED"\n \n         # Write out the result to catch unexpected changes\n         if self.writefiles:\n-            with open(outputfn, \'w\') as f:\n+            with open(outputfn, "w") as f:\n                 f.write(self.themed_string)\n \n \n def test_suite():\n     suite = unittest.TestSuite()\n     tests_dir = os.path.dirname(__file__)\n-    suite.addTest(DiazoTestCase.suiteForParent(tests_dir, \'Test\'))\n+    suite.addTest(DiazoTestCase.suiteForParent(tests_dir, "Test"))\n     recipes_dir = os.path.join(\n         tests_dir,\n         "../../..",\n         "docs/recipes",\n     )\n-    if os.path.exists(os.path.join(recipes_dir, \'diazo-tests-marker.txt\')):\n+    if os.path.exists(os.path.join(recipes_dir, "diazo-tests-marker.txt")):\n         # Could still be a \'System\' package.\n-        suite.addTest(DiazoTestCase.suiteForParent(recipes_dir, \'Recipe\'))\n+        suite.addTest(DiazoTestCase.suiteForParent(recipes_dir, "Recipe"))\n     return suite\ndiff --git a/src/diazo/tests/test_trace.py b/src/diazo/tests/test_trace.py\nindex 808f3d3..244ba26 100644\n--- a/src/diazo/tests/test_trace.py\n+++ b/src/diazo/tests/test_trace.py\n@@ -9,14 +9,14 @@\n import unittest\n \n \n-if __name__ == \'__main__\':\n+if __name__ == "__main__":\n     __file__ = sys.argv[0]\n \n \n def _testfile(filename):\n     return os.path.join(\n         os.path.abspath(os.path.dirname(__file__)),\n-        \'test_wsgi_files\',\n+        "test_wsgi_files",\n         filename,\n     )\n \n@@ -91,93 +91,93 @@ def test_internal(self):\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:theme/@runtrace-if-content\',\n-            \'false\',\n+            "/d:rules/d:theme/@runtrace-if-content",\n+            "false",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/@runtrace-if-content\',\n-            \'true\',\n+            "/d:rules/d:rules/@runtrace-if-content",\n+            "true",\n         )\n         # <replace css:content="div.bovine"\n         #          css:theme="div.cow"\n         #          css:if-content="body.female" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[1]/@runtrace-if-content\',\n-            \'false\',\n+            "/d:rules/d:rules/d:replace[1]/@runtrace-if-content",\n+            "false",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[1]/@runtrace-content\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[1]/@runtrace-content",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[1]/@runtrace-theme\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[1]/@runtrace-theme",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[1]/@runtrace-merged-condition\',\n-            \'false\',\n+            "/d:rules/d:rules/d:replace[1]/@runtrace-merged-condition",\n+            "false",\n         )\n         # <replace css:content="div.bovine"\n         #          css:theme="div.bull"\n         #          css:if-content="body.male" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[2]/@runtrace-if-content\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[2]/@runtrace-if-content",\n+            "true",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[2]/@runtrace-content\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[2]/@runtrace-content",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[2]/@runtrace-theme\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[2]/@runtrace-theme",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[2]/@runtrace-merged-condition\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[2]/@runtrace-merged-condition",\n+            "true",\n         )\n         # <replace css:content="div.pig" css:theme="div.pig" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[3]/@runtrace-content\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[3]/@runtrace-content",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[3]/@runtrace-merged-condition\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[3]/@runtrace-merged-condition",\n+            "true",\n         )\n         # <replace css:content="div.antelope" css:theme="div.antelope" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[4]/@runtrace-content\',\n-            \'0\',\n+            "/d:rules/d:rules/d:replace[4]/@runtrace-content",\n+            "0",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[4]/@runtrace-merged-condition\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[4]/@runtrace-merged-condition",\n+            "true",\n         )\n         # <replace css:content="div.iguana" css:theme="div.bull"\n         #          css:if-not-content="body.male" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[6]/@runtrace-if-not-content\',\n-            \'false\',\n+            "/d:rules/d:rules/d:replace[6]/@runtrace-if-not-content",\n+            "false",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[6]/@runtrace-merged-condition\',\n-            \'false\',\n+            "/d:rules/d:rules/d:replace[6]/@runtrace-merged-condition",\n+            "false",\n         )\n \n     def test_external(self):\n@@ -199,36 +199,36 @@ def test_external(self):\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:theme/@runtrace-if-content\',\n-            \'true\',\n+            "/d:rules/d:theme/@runtrace-if-content",\n+            "true",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/@runtrace-if-content\',\n-            \'true\',\n+            "/d:rules/d:rules/@runtrace-if-content",\n+            "true",\n         )\n         # <replace css:content="div.bovine"\n         #          css:theme="div.cow"\n         #          css:if-content="body.female" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[1]/@runtrace-if-content\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[1]/@runtrace-if-content",\n+            "true",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[1]/@runtrace-content\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[1]/@runtrace-content",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[1]/@runtrace-theme\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[1]/@runtrace-theme",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[1]/@runtrace-merged-condition\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[1]/@runtrace-merged-condition",\n+            "true",\n         )\n         # <replace css:content="div.bovine"\n         #          css:theme="div.bull"\n@@ -236,57 +236,57 @@ def test_external(self):\n         # The external theme only has the cow slot\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[2]/@runtrace-if-content\',\n-            \'false\',\n+            "/d:rules/d:rules/d:replace[2]/@runtrace-if-content",\n+            "false",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[2]/@runtrace-content\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[2]/@runtrace-content",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[2]/@runtrace-theme\',\n-            \'0\',\n+            "/d:rules/d:rules/d:replace[2]/@runtrace-theme",\n+            "0",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[2]/@runtrace-merged-condition\',\n-            \'false\',\n+            "/d:rules/d:rules/d:replace[2]/@runtrace-merged-condition",\n+            "false",\n         )\n         # <replace css:content="div.pig" css:theme="div.pig" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[3]/@runtrace-content\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[3]/@runtrace-content",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[3]/@runtrace-merged-condition\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[3]/@runtrace-merged-condition",\n+            "true",\n         )\n         # <replace css:content="div.antelope" css:theme="div.antelope" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[4]/@runtrace-content\',\n-            \'0\',\n+            "/d:rules/d:rules/d:replace[4]/@runtrace-content",\n+            "0",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[4]/@runtrace-merged-condition\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[4]/@runtrace-merged-condition",\n+            "true",\n         )\n         # <replace css:content="div.iguana" css:theme="div.bull"\n         #          css:if-not-content="body.male" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[6]/@runtrace-if-not-content\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[6]/@runtrace-if-not-content",\n+            "true",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[6]/@runtrace-merged-condition\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[6]/@runtrace-merged-condition",\n+            "true",\n         )\n \n     def test_htmlformat(self):\n@@ -383,7 +383,7 @@ def assertXPath(self, doc, xpath, expected):\n         self.assertEqual(\n             doc.xpath(\n                 xpath,\n-                namespaces=(dict(d=\'http://namespaces.plone.org/diazo\')),\n+                namespaces=(dict(d="http://namespaces.plone.org/diazo")),\n             )[0],\n             expected,\n         )\ndiff --git a/src/diazo/tests/test_wsgi.py b/src/diazo/tests/test_wsgi.py\nindex 1876ad7..4e910fb 100644\n--- a/src/diazo/tests/test_wsgi.py\n+++ b/src/diazo/tests/test_wsgi.py\n@@ -3,17 +3,22 @@\n import unittest\n \n \n-if __name__ == \'__main__\':\n+if __name__ == "__main__":\n     __file__ = sys.argv[0]\n \n \n def _testfile(filename):\n-    return \'/\'.join(\n-        (\'file://\',) + os.path.split(\n+    return "/".join(\n+        ("file://",)\n+        + os.path.split(\n             os.path.abspath(\n                 os.path.dirname(__file__),\n             ),\n-        ) + (\'test_wsgi_files\', filename,),\n+        )\n+        + (\n+            "test_wsgi_files",\n+            filename,\n+        ),\n     )\n \n \n@@ -150,7 +155,6 @@ def _testfile(filename):\n \n \n class TestXSLTMiddleware(unittest.TestCase):\n-\n     def test_transform_filename(self):\n         from diazo.wsgi import XSLTMiddleware\n         from webob import Request\n@@ -159,12 +163,12 @@ def test_transform_filename(self):\n         import tempfile\n \n         _, filename = tempfile.mkstemp()\n-        with open(filename, \'wb\') as fp:\n+        with open(filename, "wb") as fp:\n             fp.write(XSLT)\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -175,17 +179,17 @@ def application(environ, start_response):\n         )\n         os.unlink(filename)\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(\n-            response.headers[\'Content-Type\'],\n-            \'text/html; charset=UTF-8\',\n+            response.headers["Content-Type"],\n+            "text/html; charset=UTF-8",\n         )\n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_transform_tree(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -193,8 +197,8 @@ def test_transform_tree(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -204,17 +208,17 @@ def application(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(\n-            response.headers[\'Content-Type\'],\n-            \'text/html; charset=UTF-8\',\n+            response.headers["Content-Type"],\n+            "text/html; charset=UTF-8",\n         )\n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_head_request(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -222,13 +226,13 @@ def test_head_request(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'Content-Length\', str(len(HTML))),\n+                ("Content-Type", "text/html"),\n+                ("Content-Length", str(len(HTML))),\n             ]\n             start_response(status, response_headers)\n-            return [\'\']  # Empty response for HEAD request\n+            return [""]  # Empty response for HEAD request\n \n         app = XSLTMiddleware(\n             application,\n@@ -236,13 +240,13 @@ def application(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        env = dict(REQUEST_METHOD=\'HEAD\')\n-        request = Request.blank(\'/\', environ=env)\n+        env = dict(REQUEST_METHOD="HEAD")\n+        request = Request.blank("/", environ=env)\n         # The *real* test is whether or not an exception is raised here.\n         response = request.get_response(app)\n \n         # Response headers for HEAD request must be updated.\n-        self.assertEqual(response.headers.get(\'Content-Length\'), None)\n+        self.assertEqual(response.headers.get("Content-Length"), None)\n         self.assertFalse(response.body)\n \n     def test_update_content_length(self):\n@@ -251,10 +255,10 @@ def test_update_content_length(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'Content-Length\', str(len(HTML))),\n+                ("Content-Type", "text/html"),\n+                ("Content-Length", str(len(HTML))),\n             ]\n             start_response(status, response_headers)\n             return [HTML]\n@@ -266,10 +270,10 @@ def application(environ, start_response):\n             update_content_length=True,\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertEqual(response.headers[\'Content-Length\'], \'178\')\n+        self.assertEqual(response.headers["Content-Length"], "178")\n \n     def test_dont_update_content_length(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -277,10 +281,10 @@ def test_dont_update_content_length(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'Content-Length\', \'1\'),\n+                ("Content-Type", "text/html"),\n+                ("Content-Length", "1"),\n             ]\n             start_response(status, response_headers)\n             return [HTML]\n@@ -291,10 +295,10 @@ def application(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertEqual(response.headers.get(\'Content-Length\'), None)\n+        self.assertEqual(response.headers.get("Content-Length"), None)\n \n     def test_content_length_zero(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -302,13 +306,13 @@ def test_content_length_zero(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'Content-Length\', \'0\'),\n+                ("Content-Type", "text/html"),\n+                ("Content-Length", "0"),\n             ]\n             start_response(status, response_headers)\n-            return [\'\']\n+            return [""]\n \n         app = XSLTMiddleware(\n             application,\n@@ -317,10 +321,10 @@ def application(environ, start_response):\n             update_content_length=True,\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertEqual(response.headers[\'Content-Length\'], \'0\')\n+        self.assertEqual(response.headers["Content-Length"], "0")\n \n     def test_content_empty(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -328,13 +332,13 @@ def test_content_empty(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'Content-MD5\', \'d41d8cd98f00b204e9800998ecf8427e\'),\n+                ("Content-Type", "text/html"),\n+                ("Content-MD5", "d41d8cd98f00b204e9800998ecf8427e"),\n             ]\n             start_response(status, response_headers)\n-            return [b\'\']\n+            return [b""]\n \n         app = XSLTMiddleware(\n             application,\n@@ -343,12 +347,12 @@ def application(environ, start_response):\n             update_content_length=True,\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(\n-            response.headers[\'Content-MD5\'],\n-            \'d41d8cd98f00b204e9800998ecf8427e\',\n+            response.headers["Content-MD5"],\n+            "d41d8cd98f00b204e9800998ecf8427e",\n         )\n \n     def test_content_range(self):\n@@ -357,17 +361,17 @@ def test_content_range(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             content_length = len(HTML)\n-            content_range = \'bytes {start:d}-{end:d}/{length:d}\'.format(\n+            content_range = "bytes {start:d}-{end:d}/{length:d}".format(\n                 start=0,\n                 end=content_length - 1,\n                 length=content_length,\n             )\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'Content-Range\', content_range),\n-                (\'Content-Length\', str(content_length)),\n+                ("Content-Type", "text/html"),\n+                ("Content-Range", content_range),\n+                ("Content-Length", str(content_length)),\n             ]\n             start_response(status, response_headers)\n             return [HTML]\n@@ -378,10 +382,10 @@ def application(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertFalse(\'Content-Range\' in response.headers)\n+        self.assertFalse("Content-Range" in response.headers)\n \n     def test_no_content_length(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -389,8 +393,8 @@ def test_no_content_length(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -401,10 +405,10 @@ def application(environ, start_response):\n             set_content_length=False,\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertFalse(\'Content-Length\' in response.headers)\n+        self.assertFalse("Content-Length" in response.headers)\n \n     def test_doctype_html(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -412,8 +416,8 @@ def test_doctype_html(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -423,12 +427,12 @@ def application(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(\n-            response.headers[\'Content-Type\'],\n-            \'text/html; charset=UTF-8\',\n+            response.headers["Content-Type"],\n+            "text/html; charset=UTF-8",\n         )\n \n     def test_doctype_xhtml(self):\n@@ -437,8 +441,8 @@ def test_doctype_xhtml(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -448,12 +452,12 @@ def application(environ, start_response):\n             tree=etree.fromstring(XSLT_XHTML),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(\n-            response.headers[\'Content-Type\'],\n-            \'application/xhtml+xml; charset=UTF-8\',\n+            response.headers["Content-Type"],\n+            "application/xhtml+xml; charset=UTF-8",\n         )\n \n     def test_doctype_html5(self):\n@@ -462,8 +466,8 @@ def test_doctype_html5(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -471,13 +475,13 @@ def application(environ, start_response):\n             application,\n             {},\n             tree=etree.fromstring(XSLT_XHTML),\n-            doctype=\'<!DOCTYPE html>\',\n+            doctype="<!DOCTYPE html>",\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertTrue(response.body.startswith(b\'<!DOCTYPE html>\\n<html\'))\n+        self.assertTrue(response.body.startswith(b"<!DOCTYPE html>\\n<html"))\n \n     def test_ignored_extension(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -485,8 +489,8 @@ def test_ignored_extension(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -494,21 +498,21 @@ def application(environ, start_response):\n             application,\n             {},\n             tree=etree.fromstring(XSLT),\n-            ignored_extensions=(\'html\',),\n+            ignored_extensions=("html",),\n         )\n \n-        request = Request.blank(\'/index.html\')\n+        request = Request.blank("/index.html")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_diazo_off_request_header(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -516,8 +520,8 @@ def test_diazo_off_request_header(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -527,20 +531,20 @@ def application(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n-        request.headers[\'X-Diazo-Off\'] = \'yes\'\n+        request = Request.blank("/")\n+        request.headers["X-Diazo-Off"] = "yes"\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n-        request = Request.blank(\'/\')\n-        request.headers[\'X-Diazo-Off\'] = \'no\'\n+        request = Request.blank("/")\n+        request.headers["X-Diazo-Off"] = "no"\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_diazo_off_response_header(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -548,26 +552,26 @@ def test_diazo_off_response_header(self):\n         from webob import Request\n \n         def application1(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'X-Diazo-Off\', \'yes\'),\n+                ("Content-Type", "text/html"),\n+                ("X-Diazo-Off", "yes"),\n             ]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = XSLTMiddleware(application1, {}, tree=etree.fromstring(XSLT))\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n         def application2(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'X-Diazo-Off\', \'no\'),\n+                ("Content-Type", "text/html"),\n+                ("X-Diazo-Off", "no"),\n             ]\n             start_response(status, response_headers)\n             return [HTML]\n@@ -578,13 +582,13 @@ def application2(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_non_html_content_type(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -592,8 +596,8 @@ def test_non_html_content_type(self):\n         from webob import Request\n \n         def application1(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/plain\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/plain")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -603,14 +607,14 @@ def application1(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n         def application2(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -620,13 +624,13 @@ def application2(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_content_encoding(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -634,24 +638,24 @@ def test_content_encoding(self):\n         from webob import Request\n \n         def application1(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'Content-Encoding\', \'zip\'),\n+                ("Content-Type", "text/html"),\n+                ("Content-Encoding", "zip"),\n             ]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = XSLTMiddleware(application1, {}, tree=etree.fromstring(XSLT))\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n         def application2(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -661,13 +665,13 @@ def application2(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_301(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -675,8 +679,8 @@ def test_301(self):\n         from webob import Request\n \n         def application1(environ, start_response):\n-            status = \'301 MOVED PERMANENTLY\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "301 MOVED PERMANENTLY"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -686,14 +690,14 @@ def application1(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n         def application2(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -703,13 +707,13 @@ def application2(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_302(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -717,8 +721,8 @@ def test_302(self):\n         from webob import Request\n \n         def application1(environ, start_response):\n-            status = \'302 MOVED\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "302 MOVED"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -728,14 +732,14 @@ def application1(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n         def application2(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -745,13 +749,13 @@ def application2(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_304(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -759,33 +763,33 @@ def test_304(self):\n         from webob import Request\n \n         def application1(environ, start_response):\n-            status = \'304 NOT MODIFIED\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "304 NOT MODIFIED"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = XSLTMiddleware(application1, {}, tree=etree.fromstring(XSLT))\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n         def application2(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = XSLTMiddleware(application2, {}, tree=etree.fromstring(XSLT))\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_204(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -793,33 +797,33 @@ def test_204(self):\n         from webob import Request\n \n         def application1(environ, start_response):\n-            status = \'204 NO CONTENT\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "204 NO CONTENT"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = XSLTMiddleware(application1, {}, tree=etree.fromstring(XSLT))\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n         def application2(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = XSLTMiddleware(application2, {}, tree=etree.fromstring(XSLT))\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_401(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -827,8 +831,8 @@ def test_401(self):\n         from webob import Request\n \n         def application1(environ, start_response):\n-            status = \'401 UNAUTHORIZED\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "401 UNAUTHORIZED"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -838,14 +842,14 @@ def application1(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n         def application2(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -855,13 +859,13 @@ def application2(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_html_serialization(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -869,13 +873,13 @@ def test_html_serialization(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = XSLTMiddleware(application, {}, tree=etree.fromstring(XSLT_HTML))\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         # HTML serialisation\n@@ -883,14 +887,14 @@ def application(environ, start_response):\n             b\'<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" \'\n             b\'"http://www.w3.org/TR/html4/strict.dtd">\' in response.body,\n         )\n-        self.assertTrue(b\'<br>\' in response.body)\n+        self.assertTrue(b"<br>" in response.body)\n \n         app = XSLTMiddleware(\n             application,\n             {},\n             tree=etree.fromstring(XSLT_XHTML),\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         # XHTML serialisation\n@@ -899,19 +903,19 @@ def application(environ, start_response):\n             b\'"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\'\n             in response.body,\n         )\n-        self.assertTrue(b\'<br />\' in response.body)\n+        self.assertTrue(b"<br />" in response.body)\n \n         app = XSLTMiddleware(\n             application,\n             {},\n             tree=etree.fromstring(XSLT_HTML5),\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         # HTML 5 serialisation\n-        self.assertTrue(b\'<!DOCTYPE html>\' in response.body)\n-        self.assertTrue(b\'<br/>\' in response.body)\n+        self.assertTrue(b"<!DOCTYPE html>" in response.body)\n+        self.assertTrue(b"<br/>" in response.body)\n \n     def test_environ_param(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -919,8 +923,8 @@ def test_environ_param(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -928,19 +932,19 @@ def application(environ, start_response):\n             application,\n             {},\n             tree=etree.fromstring(XSLT_PARAM),\n-            environ_param_map={\'test.param1\': \'someparam\'},\n+            environ_param_map={"test.param1": "someparam"},\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertTrue(b\'<p>defaultvalue</p>\' in response.body)\n+        self.assertTrue(b"<p>defaultvalue</p>" in response.body)\n \n-        request = Request.blank(\'/\')\n-        request.environ[\'test.param1\'] = \'value1\'\n+        request = Request.blank("/")\n+        request.environ["test.param1"] = "value1"\n         response = request.get_response(app)\n \n-        self.assertTrue(b\'<p>value1</p>\' in response.body)\n+        self.assertTrue(b"<p>value1</p>" in response.body)\n \n     def test_params(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -948,8 +952,8 @@ def test_params(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -958,41 +962,40 @@ def application(environ, start_response):\n             {},\n             tree=etree.fromstring(XSLT_PARAM),\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertTrue(b\'<p>defaultvalue</p>\' in response.body)\n+        self.assertTrue(b"<p>defaultvalue</p>" in response.body)\n \n         app = XSLTMiddleware(\n             application,\n             {},\n             tree=etree.fromstring(XSLT_PARAM),\n-            someparam=\'value1\',\n+            someparam="value1",\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertTrue(b\'<p>value1</p>\' in response.body)\n+        self.assertTrue(b"<p>value1</p>" in response.body)\n \n \n class TestDiazoMiddleware(unittest.TestCase):\n-\n     def test_simple_transform(self):\n         from diazo.wsgi import DiazoMiddleware\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = DiazoMiddleware(\n             application,\n             {},\n-            _testfile(\'simple_transform.xml\'),\n+            _testfile("simple_transform.xml"),\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1001,46 +1004,46 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_doctype_html5(self):\n         from diazo.wsgi import DiazoMiddleware\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = DiazoMiddleware(\n             application,\n             {},\n-            _testfile(\'simple_transform.xml\'),\n-            doctype=\'<!DOCTYPE html>\',\n+            _testfile("simple_transform.xml"),\n+            doctype="<!DOCTYPE html>",\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertTrue(response.body.startswith(b\'<!DOCTYPE html>\\n<html\'))\n+        self.assertTrue(response.body.startswith(b"<!DOCTYPE html>\\n<html"))\n \n     def test_with_theme(self):\n         from diazo.wsgi import DiazoMiddleware\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = DiazoMiddleware(\n             application,\n             {},\n-            _testfile(\'explicit_theme.xml\'),\n-            theme=_testfile(\'theme.html\'),\n+            _testfile("explicit_theme.xml"),\n+            theme=_testfile("theme.html"),\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1049,24 +1052,24 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_absolute_prefix(self):\n         from diazo.wsgi import DiazoMiddleware\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = DiazoMiddleware(\n             application,\n             {},\n-            _testfile(\'simple_transform.xml\'),\n+            _testfile("simple_transform.xml"),\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1075,17 +1078,18 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n         self.assertTrue(\n             b\'<link rel="stylesheet" href="./theme.css" />\' in response.body,\n         )\n \n         app = DiazoMiddleware(\n-            application, {},\n-            _testfile(\'simple_transform.xml\'),\n-            prefix=\'/static\',\n+            application,\n+            {},\n+            _testfile("simple_transform.xml"),\n+            prefix="/static",\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1094,10 +1098,9 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n         self.assertTrue(\n-            b\'<link rel="stylesheet" href="/static/theme.css" />\'\n-            in response.body,\n+            b\'<link rel="stylesheet" href="/static/theme.css" />\' in response.body,\n         )\n \n     def test_path_param(self):\n@@ -1105,13 +1108,13 @@ def test_path_param(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n-        app = DiazoMiddleware(application, {}, _testfile(\'path_param.xml\'))\n-        request = Request.blank(\'/\')\n+        app = DiazoMiddleware(application, {}, _testfile("path_param.xml"))\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertFalse(\n@@ -1120,9 +1123,9 @@ def application(environ, start_response):\n         self.assertTrue(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n-        request = Request.blank(\'/index.html\')\n+        request = Request.blank("/index.html")\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1131,26 +1134,26 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_custom_environ_param(self):\n         from diazo.wsgi import DiazoMiddleware\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = DiazoMiddleware(\n             application,\n             {},\n-            _testfile(\'custom_param.xml\'),\n-            environ_param_map={\'test.param1\': \'someparam\'},\n+            _testfile("custom_param.xml"),\n+            environ_param_map={"test.param1": "someparam"},\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertFalse(\n@@ -1159,10 +1162,10 @@ def application(environ, start_response):\n         self.assertTrue(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n-        request = Request.blank(\'/\')\n-        request.environ[\'test.param1\'] = \'value1\'\n+        request = Request.blank("/")\n+        request.environ["test.param1"] = "value1"\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1171,10 +1174,10 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n-        request = Request.blank(\'/\')\n-        request.environ[\'test.param1\'] = \'value2\'\n+        request = Request.blank("/")\n+        request.environ["test.param1"] = "value2"\n         response = request.get_response(app)\n \n         self.assertFalse(\n@@ -1183,25 +1186,25 @@ def application(environ, start_response):\n         self.assertTrue(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_custom_param(self):\n         from diazo.wsgi import DiazoMiddleware\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = DiazoMiddleware(\n             application,\n             {},\n-            _testfile(\'custom_param.xml\'),\n-            someparam=\'value1\',\n+            _testfile("custom_param.xml"),\n+            someparam="value1",\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1210,15 +1213,15 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n         app = DiazoMiddleware(\n             application,\n             {},\n-            _testfile(\'custom_param.xml\'),\n-            someparam=\'value2\',\n+            _testfile("custom_param.xml"),\n+            someparam="value2",\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertFalse(\n@@ -1227,25 +1230,25 @@ def application(environ, start_response):\n         self.assertTrue(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_subrequest(self):\n         from diazo.wsgi import DiazoMiddleware\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n \n             request = Request(environ)\n-            if request.path.endswith(\'/other.html\'):\n+            if request.path.endswith("/other.html"):\n                 return [HTML_ALTERNATIVE]\n             else:\n                 return [HTML]\n \n-        app = DiazoMiddleware(application, {}, _testfile(\'subrequest.xml\'))\n-        request = Request.blank(\'/\')\n+        app = DiazoMiddleware(application, {}, _testfile("subrequest.xml"))\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1254,19 +1257,19 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_esi(self):\n         from diazo.wsgi import DiazoMiddleware\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n \n             request = Request(environ)\n-            if request.path.endswith(\'/other.html\'):\n+            if request.path.endswith("/other.html"):\n                 return [HTML_ALTERNATIVE]\n             else:\n                 return [HTML]\n@@ -1274,10 +1277,10 @@ def application(environ, start_response):\n         app = DiazoMiddleware(\n             application,\n             {},\n-            _testfile(\'esi.xml\'),\n+            _testfile("esi.xml"),\n             filter_xpath=True,\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1288,7 +1291,7 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n         request = Request.blank(\n             """/other.html?;filter_xpath=//*[@id%20=%20\'content\']""",\ndiff --git a/src/diazo/utils.py b/src/diazo/utils.py\nindex 5a3b4bf..f4e72e4 100644\n--- a/src/diazo/utils.py\n+++ b/src/diazo/utils.py\n@@ -17,30 +17,30 @@\n \n strparam = etree.XSLT.strparam\n \n-logger = logging.getLogger(\'diazo\')\n+logger = logging.getLogger("diazo")\n \n namespaces = dict(\n-    diazo=\'http://namespaces.plone.org/diazo\',\n-    css=\'http://namespaces.plone.org/diazo/css\',\n-    old1=\'http://openplans.org/deliverance\',\n-    old2=\'http://namespaces.plone.org/xdv\',\n-    oldcss1=\'http://namespaces.plone.org/xdv+css\',\n-    oldcss2=\'http://namespaces.plone.org/diazo+css\',\n-    xml=\'http://www.w3.org/XML/1998/namespace\',\n-    xsl=\'http://www.w3.org/1999/XSL/Transform\',\n+    diazo="http://namespaces.plone.org/diazo",\n+    css="http://namespaces.plone.org/diazo/css",\n+    old1="http://openplans.org/deliverance",\n+    old2="http://namespaces.plone.org/xdv",\n+    oldcss1="http://namespaces.plone.org/xdv+css",\n+    oldcss2="http://namespaces.plone.org/diazo+css",\n+    xml="http://www.w3.org/XML/1998/namespace",\n+    xsl="http://www.w3.org/1999/XSL/Transform",\n )\n \n \n def localname(name):\n-    return name.rsplit(\'}\', 1)[1]\n+    return name.rsplit("}", 1)[1]\n \n \n def namespace(name):\n-    return name.rsplit(\'}\', 1)[0][1:]\n+    return name.rsplit("}", 1)[0][1:]\n \n \n def fullname(namespace, name):\n-    return f\'{{{namespace}}}{name}\'  # NOQA: S001\n+    return f"{{{namespace}}}{name}"  # NOQA: S001\n \n \n AC_READ_FILE = etree.XSLTAccessControl(\n@@ -85,7 +85,7 @@ def __call__(self, *args, **kw):\n \n \n def pkg_parse(name, parser=None):\n-    with open(pkg_resources.resource_filename(\'diazo\', name)) as f:\n+    with open(pkg_resources.resource_filename("diazo", name)) as f:\n         return etree.parse(f, parser=parser)\n \n \n@@ -102,22 +102,21 @@ def quote_param(value):\n     if isinstance(value, str):\n         return strparam(value)\n     elif isinstance(value, bool):\n-        return value and \'true()\' or \'false()\'\n+        return value and "true()" or "false()"\n     elif isinstance(value, (int,) + (float,)):\n         value = repr(value)\n     elif value is None:\n-        return \'/..\'\n+        return "/.."\n     else:\n-        raise ValueError(\'Cannot convert %s\', value)\n+        raise ValueError("Cannot convert %s", value)\n \n \n def split_params(s):\n-    """Turn foo,bar=baz into {\'foo\': None, \'bar\': \'baz\'}\n-    """\n+    """Turn foo,bar=baz into {\'foo\': None, \'bar\': \'baz\'}"""\n \n     xsl_params = {}\n-    for param in s.split(\',\'):\n-        tokens = [t.strip() for t in param.split(\'=\')]\n+    for param in s.split(","):\n+        tokens = [t.strip() for t in param.split("=")]\n         xsl_params[tokens[0]] = len(tokens) > 1 and tokens[1] or None\n     return xsl_params\n \n@@ -125,86 +124,86 @@ def split_params(s):\n def _createOptionParser(usage):\n     parser = OptionParser(usage=usage)\n     parser.add_option(\n-        \'-o\',\n-        \'--output\',\n-        metavar=\'output.xsl\',\n-        help=\'Output filename (instead of stdout)\',\n-        dest=\'output\',\n+        "-o",\n+        "--output",\n+        metavar="output.xsl",\n+        help="Output filename (instead of stdout)",\n+        dest="output",\n         default=stdout,\n     )\n     parser.add_option(\n-        \'-p\',\n-        \'--pretty-print\',\n-        action=\'store_true\',\n-        help=\'Pretty print output (may alter rendering in browser)\',\n-        dest=\'pretty_print\',\n+        "-p",\n+        "--pretty-print",\n+        action="store_true",\n+        help="Pretty print output (may alter rendering in browser)",\n+        dest="pretty_print",\n         default=False,\n     )\n     parser.add_option(\n-        \'--trace\',\n-        action=\'store_true\',\n-        help=\'Compiler trace logging\',\n-        dest=\'trace\',\n+        "--trace",\n+        action="store_true",\n+        help="Compiler trace logging",\n+        dest="trace",\n         default=False,\n     )\n     parser.add_option(\n-        \'-a\',\n-        \'--absolute-prefix\',\n-        metavar=\'/\',\n-        help=\'relative urls in the theme file will be made into absolute \'\n-             \'links with this prefix.\',\n-        dest=\'absolute_prefix\',\n+        "-a",\n+        "--absolute-prefix",\n+        metavar="/",\n+        help="relative urls in the theme file will be made into absolute "\n+        "links with this prefix.",\n+        dest="absolute_prefix",\n         default=None,\n     )\n     parser.add_option(\n-        \'-i\',\n-        \'--includemode\',\n-        metavar=\'INC\',\n-        help=\'include mode (document, ssi, ssiwait or esi)\',\n-        dest=\'includemode\',\n+        "-i",\n+        "--includemode",\n+        metavar="INC",\n+        help="include mode (document, ssi, ssiwait or esi)",\n+        dest="includemode",\n         default=None,\n     )\n     parser.add_option(\n-        \'-n\',\n-        \'--network\',\n-        action=\'store_true\',\n-        help=\'Allow reads to the network to fetch resources\',\n-        dest=\'read_network\',\n+        "-n",\n+        "--network",\n+        action="store_true",\n+        help="Allow reads to the network to fetch resources",\n+        dest="read_network",\n         default=False,\n     )\n     parser.add_option(\n-        \'-t\',\n-        \'--theme\',\n-        metavar=\'theme.html\',\n-        help=\'Theme file\',\n-        dest=\'theme\',\n+        "-t",\n+        "--theme",\n+        metavar="theme.html",\n+        help="Theme file",\n+        dest="theme",\n         default=None,\n     )\n     parser.add_option(\n-        \'-r\',\n-        \'--rules\',\n-        metavar=\'rules.xml\',\n-        help=\'Diazo rules file\',\n-        dest=\'rules\',\n+        "-r",\n+        "--rules",\n+        metavar="rules.xml",\n+        help="Diazo rules file",\n+        dest="rules",\n         default=None,\n     )\n     parser.add_option(\n-        \'-c\',\n-        \'--custom-parameters\',\n-        metavar=\'param1,param2=defaultval\',\n-        help=\'Comma-separated list of custom parameter names with optional \'\n-             \'default values that the compiled theme will be able accept \'\n-             \'when run\',\n-        dest=\'xsl_params\',\n+        "-c",\n+        "--custom-parameters",\n+        metavar="param1,param2=defaultval",\n+        help="Comma-separated list of custom parameter names with optional "\n+        "default values that the compiled theme will be able accept "\n+        "when run",\n+        dest="xsl_params",\n         default=None,\n     )\n     parser.add_option(\n-        \'-e\',\n-        \'--extra\',\n-        metavar=\'extra.xsl\',\n-        help=\'Extra XSL to be included in the transform \'\n-             \'(depracated, use inline xsl in the rules instead)\',\n-        dest=\'extra\',\n+        "-e",\n+        "--extra",\n+        metavar="extra.xsl",\n+        help="Extra XSL to be included in the transform "\n+        "(depracated, use inline xsl in the rules instead)",\n+        dest="extra",\n         default=None,\n     )\n     return parser\ndiff --git a/src/diazo/wsgi.py b/src/diazo/wsgi.py\nindex f101f3f..4735cee 100644\n--- a/src/diazo/wsgi.py\n+++ b/src/diazo/wsgi.py\n@@ -13,19 +13,33 @@\n import re\n \n \n-DIAZO_OFF_HEADER = \'X-Diazo-Off\'\n+DIAZO_OFF_HEADER = "X-Diazo-Off"\n \n \n def asbool(value):\n     if isinstance(value, str):\n         value = value.strip().lower()\n-        if value in (\'true\', \'yes\', \'on\', \'y\', \'t\', \'1\', ):\n+        if value in (\n+            "true",\n+            "yes",\n+            "on",\n+            "y",\n+            "t",\n+            "1",\n+        ):\n             return True\n-        elif value in (\'false\', \'no\', \'off\', \'n\', \'f\', \'0\', ):\n+        elif value in (\n+            "false",\n+            "no",\n+            "off",\n+            "n",\n+            "f",\n+            "0",\n+        ):\n             return False\n         else:\n             raise ValueError(\n-                \'String is not true/false: {value:r}\'.format(\n+                "String is not true/false: {value:r}".format(\n                     value=value,\n                 ),\n             )\n@@ -35,8 +49,9 @@ def asbool(value):\n \n class FilesystemResolver(etree.Resolver):\n     """Resolver for filesystem paths"""\n+\n     def resolve(self, system_url, public_id, context):\n-        if \'://\' not in system_url and os.path.exists(system_url):\n+        if "://" not in system_url and os.path.exists(system_url):\n             return self.resolve_filename(system_url, context)\n         else:\n             return None\n@@ -44,8 +59,9 @@ def resolve(self, system_url, public_id, context):\n \n class NetworkResolver(etree.Resolver):\n     """Resolver for network urls"""\n+\n     def resolve(self, system_url, public_id, context):\n-        if \'://\' in system_url and system_url != \'file:///__diazo__\':\n+        if "://" in system_url and system_url != "file:///__diazo__":\n             return self.resolve_filename(system_url, context)\n         else:\n             return None\n@@ -55,11 +71,11 @@ class PythonResolver(etree.Resolver):\n     """Resolver for python:// urls"""\n \n     def resolve(self, system_url, public_id, context):\n-        if not system_url.lower().startswith(\'python://\'):\n+        if not system_url.lower().startswith("python://"):\n             return None\n \n         spec = system_url[9:]\n-        package, resource_name = spec.split(\'/\', 1)\n+        package, resource_name = spec.split("/", 1)\n         filename = pkg_resources.resource_filename(package, resource_name)\n \n         return self.resolve_filename(filename, context)\n@@ -73,47 +89,50 @@ def __init__(self, app):\n \n     def resolve(self, system_url, public_id, context):\n         # Ignore URLs with a scheme\n-        if \'://\' in system_url:\n+        if "://" in system_url:\n             return None\n \n         # Ignore the special \'diazo:\' resolvers\n-        if system_url.startswith(\'diazo:\'):\n+        if system_url.startswith("diazo:"):\n             return None\n \n         subrequest = Request.blank(system_url)\n         response = subrequest.get_response(self.app)\n \n         status_code, reason = response.status.split(None, 1)\n-        if not status_code == \'200\':\n+        if not status_code == "200":\n             return None\n \n         if response.charset is None:\n-            response.charset = \'UTF-8\'  # Maybe this should be latin1?\n+            response.charset = "UTF-8"  # Maybe this should be latin1?\n \n         result = response.text\n \n         if response.content_type in (\n-            \'text/javascript\',\n-            \'application/x-javascript\',\n+            "text/javascript",\n+            "application/x-javascript",\n         ):\n-            result = \'\'.join([\n-                \'<html><body><script type="text/javascript">\',\n-                result,\n-                \'</script></body></html>\',\n-            ])\n-        elif response.content_type == \'text/css\':\n-            result = \'\'.join([\n-                \'<html><body><style type="text/css">\',\n-                result,\n-                \'</style></body></html>\',\n-            ])\n+            result = "".join(\n+                [\n+                    \'<html><body><script type="text/javascript">\',\n+                    result,\n+                    "</script></body></html>",\n+                ]\n+            )\n+        elif response.content_type == "text/css":\n+            result = "".join(\n+                [\n+                    \'<html><body><style type="text/css">\',\n+                    result,\n+                    "</style></body></html>",\n+                ]\n+            )\n \n         return self.resolve_string(result, context)\n \n \n class XSLTMiddleware:\n-    """Apply XSLT in middleware\n-    """\n+    """Apply XSLT in middleware"""\n \n     def __init__(\n         self,\n@@ -125,37 +144,37 @@ def __init__(\n         read_file=True,\n         update_content_length=False,\n         ignored_extensions=(\n-            \'js\',\n-            \'css\',\n-            \'gif\',\n-            \'jpg\',\n-            \'jpeg\',\n-            \'pdf\',\n-            \'ps\',\n-            \'doc\',\n-            \'png\',\n-            \'ico\',\n-            \'mov\',\n-            \'mpg\',\n-            \'mpeg\',\n-            \'mp3\',\n-            \'m4a\',\n-            \'txt\',\n-            \'rtf\',\n-            \'swf\',\n-            \'wav\',\n-            \'zip\',\n-            \'wmv\',\n-            \'ppt\',\n-            \'gz\',\n-            \'tgz\',\n-            \'jar\',\n-            \'xls\',\n-            \'bmp\',\n-            \'tif\',\n-            \'tga\',\n-            \'hqx\',\n-            \'avi\',\n+            "js",\n+            "css",\n+            "gif",\n+            "jpg",\n+            "jpeg",\n+            "pdf",\n+            "ps",\n+            "doc",\n+            "png",\n+            "ico",\n+            "mov",\n+            "mpg",\n+            "mpeg",\n+            "mp3",\n+            "m4a",\n+            "txt",\n+            "rtf",\n+            "swf",\n+            "wav",\n+            "zip",\n+            "wmv",\n+            "ppt",\n+            "gz",\n+            "tgz",\n+            "jar",\n+            "xls",\n+            "bmp",\n+            "tif",\n+            "tga",\n+            "hqx",\n+            "avi",\n         ),\n         environ_param_map=None,\n         unquoted_params=None,\n@@ -163,7 +182,7 @@ def __init__(\n         content_type=None,\n         charset=None,\n         remove_conditional_headers=False,\n-        **params  # NOQA: C816\n+        **params,  # NOQA: C816\n     ):\n         """Initialise, giving a filename or parsed XSLT tree.\n \n@@ -213,37 +232,37 @@ def __init__(\n \n         if content_type is None:\n             mediatype = tree.xpath(\n-                \'/xsl:stylesheet/xsl:output/@media-type\',\n-                namespaces=dict(xsl=\'http://www.w3.org/1999/XSL/Transform\'),\n+                "/xsl:stylesheet/xsl:output/@media-type",\n+                namespaces=dict(xsl="http://www.w3.org/1999/XSL/Transform"),\n             )\n             if mediatype:\n                 content_type = mediatype[-1]\n             else:\n                 method = tree.xpath(\n-                    \'/xsl:stylesheet/xsl:output/@method\',\n+                    "/xsl:stylesheet/xsl:output/@method",\n                     namespaces=dict(\n-                        xsl=\'http://www.w3.org/1999/XSL/Transform\',\n+                        xsl="http://www.w3.org/1999/XSL/Transform",\n                     ),\n                 )\n                 if method:\n                     method = method[-1]\n-                    if method.lower() == \'html\':\n-                        content_type = \'text/html\'\n-                    elif method.lower() == \'text\':\n-                        content_type = \'text/plain\'\n-                    elif method.lower() == \'xml\':\n-                        content_type = \'text/xml\'\n+                    if method.lower() == "html":\n+                        content_type = "text/html"\n+                    elif method.lower() == "text":\n+                        content_type = "text/plain"\n+                    elif method.lower() == "xml":\n+                        content_type = "text/xml"\n         self.content_type = content_type\n \n         if charset is None:\n             encoding = tree.xpath(\n-                \'/xsl:stylesheet/xsl:output/@encoding\',\n-                namespaces=dict(xsl=\'http://www.w3.org/1999/XSL/Transform\'),\n+                "/xsl:stylesheet/xsl:output/@encoding",\n+                namespaces=dict(xsl="http://www.w3.org/1999/XSL/Transform"),\n             )\n             if encoding:\n                 charset = encoding[-1]\n             else:\n-                charset = \'UTF-8\'\n+                charset = "UTF-8"\n         self.charset = charset\n \n         self.read_network = asbool(read_network)\n@@ -260,14 +279,13 @@ def __init__(\n         self.ignored_extensions = frozenset(ignored_extensions)\n \n         self.ignored_pattern = re.compile(\n-            r\'^.*\\.({ext:s})$\'.format(ext=\'|\'.join(ignored_extensions)),\n+            r"^.*\\.({ext:s})$".format(ext="|".join(ignored_extensions)),\n         )\n \n         self.environ_param_map = environ_param_map or {}\n         if isinstance(unquoted_params, str):\n             unquoted_params = unquoted_params.split()\n-        self.unquoted_params = unquoted_params and \\\n-            frozenset(unquoted_params) or ()\n+        self.unquoted_params = unquoted_params and frozenset(unquoted_params) or ()\n         self.params = params\n         self.doctype = doctype\n         self.remove_conditional_headers = asbool(remove_conditional_headers)\n@@ -295,7 +313,7 @@ def __call__(self, environ, start_response):\n             input_encoding = response.charset\n \n             # Note, the Content-Length header will not be set\n-            if request.method == \'HEAD\':\n+            if request.method == "HEAD":\n                 self.reset_headers(response)\n                 return response(environ, start_response)\n \n@@ -310,7 +328,7 @@ def __call__(self, environ, start_response):\n                 # Headers should be left intact\n                 return response(environ, start_response)\n         finally:\n-            if getattr(response.app_iter, \'close\', None):\n+            if getattr(response.app_iter, "close", None):\n                 response.app_iter.close()\n \n         self.reset_headers(response)\n@@ -336,10 +354,10 @@ def __call__(self, environ, start_response):\n         # Set content type (normally inferred from stylesheet)\n         # Unfortunately lxml does not expose docinfo.mediaType\n         if self.content_type is None:\n-            if tree.getroot().tag == \'html\':\n-                response.content_type = \'text/html\'\n+            if tree.getroot().tag == "html":\n+                response.content_type = "text/html"\n             else:\n-                response.content_type = \'text/xml\'\n+                response.content_type = "text/xml"\n         response.charset = tree.docinfo.encoding or self.charset\n \n         # Return a repoze.xmliter XMLSerializer, which helps avoid re-parsing\n@@ -355,10 +373,9 @@ def __call__(self, environ, start_response):\n         return response(environ, start_response)\n \n     def should_ignore(self, request):\n-        """Determine if we should ignore the request\n-        """\n+        """Determine if we should ignore the request"""\n \n-        if asbool(request.headers.get(DIAZO_OFF_HEADER, \'no\')):\n+        if asbool(request.headers.get(DIAZO_OFF_HEADER, "no")):\n             return True\n \n         path = request.path_info\n@@ -368,29 +385,28 @@ def should_ignore(self, request):\n         return False\n \n     def should_transform(self, response):\n-        """Determine if we should transform the response\n-        """\n+        """Determine if we should transform the response"""\n \n-        if asbool(response.headers.get(DIAZO_OFF_HEADER, \'no\')):\n+        if asbool(response.headers.get(DIAZO_OFF_HEADER, "no")):\n             return False\n \n-        content_type = response.headers.get(\'Content-Type\')\n+        content_type = response.headers.get("Content-Type")\n         if not content_type or not (\n-            content_type.lower().startswith(\'text/html\') or\n-            content_type.lower().startswith(\'application/xhtml+xml\')\n+            content_type.lower().startswith("text/html")\n+            or content_type.lower().startswith("application/xhtml+xml")\n         ):\n             return False\n \n-        content_encoding = response.headers.get(\'Content-Encoding\')\n-        if content_encoding in (\'zip\', \'deflate\', \'compress\',):\n+        content_encoding = response.headers.get("Content-Encoding")\n+        if content_encoding in (\n+            "zip",\n+            "deflate",\n+            "compress",\n+        ):\n             return False\n \n         status_code, reason = response.status.split(None, 1)\n-        if (\n-            status_code.startswith(\'3\') or\n-            status_code == \'204\' or\n-            status_code == \'401\'\n-        ):\n+        if status_code.startswith("3") or status_code == "204" or status_code == "401":\n             return False\n \n         if response.content_length == 0:\n@@ -414,8 +430,7 @@ def reset_headers(self, response):\n \n \n class DiazoMiddleware:\n-    """Invoke the Diazo transform as middleware\n-    """\n+    """Invoke the Diazo transform as middleware"""\n \n     def __init__(\n         self,\n@@ -424,50 +439,50 @@ def __init__(\n         rules,\n         theme=None,\n         prefix=None,\n-        includemode=\'document\',\n+        includemode="document",\n         debug=False,\n         read_network=False,\n         read_file=True,\n         update_content_length=False,\n         ignored_extensions=(\n-            \'js\',\n-            \'css\',\n-            \'gif\',\n-            \'jpg\',\n-            \'jpeg\',\n-            \'pdf\',\n-            \'ps\',\n-            \'doc\',\n-            \'png\',\n-            \'ico\',\n-            \'mov\',\n-            \'mpg\',\n-            \'mpeg\',\n-            \'mp3\',\n-            \'m4a\',\n-            \'txt\',\n-            \'rtf\',\n-            \'swf\',\n-            \'wav\',\n-            \'zip\',\n-            \'wmv\',\n-            \'ppt\',\n-            \'gz\',\n-            \'tgz\',\n-            \'jar\',\n-            \'xls\',\n-            \'bmp\',\n-            \'tif\',\n-            \'tga\',\n-            \'hqx\',\n-            \'avi\',\n+            "js",\n+            "css",\n+            "gif",\n+            "jpg",\n+            "jpeg",\n+            "pdf",\n+            "ps",\n+            "doc",\n+            "png",\n+            "ico",\n+            "mov",\n+            "mpg",\n+            "mpeg",\n+            "mp3",\n+            "m4a",\n+            "txt",\n+            "rtf",\n+            "swf",\n+            "wav",\n+            "zip",\n+            "wmv",\n+            "ppt",\n+            "gz",\n+            "tgz",\n+            "jar",\n+            "xls",\n+            "bmp",\n+            "tif",\n+            "tga",\n+            "hqx",\n+            "avi",\n         ),\n         environ_param_map=None,\n         unquoted_params=None,\n         doctype=None,\n         content_type=None,\n         filter_xpath=False,\n-        **params  # NOQA: C816\n+        **params,  # NOQA: C816\n     ):\n         """Create the middleware. The parameters are:\n \n@@ -544,12 +559,14 @@ def __init__(\n         self.filter_middleware = self.get_filter_middleware()\n \n         self.environ_param_map = environ_param_map or {}\n-        self.environ_param_map.update({\n-            \'diazo.path\': \'path\',\n-            \'diazo.query_string\': \'query_string\',\n-            \'diazo.host\': \'host\',\n-            \'diazo.scheme\': \'scheme\',\n-        })\n+        self.environ_param_map.update(\n+            {\n+                "diazo.path": "path",\n+                "diazo.query_string": "query_string",\n+                "diazo.host": "host",\n+                "diazo.scheme": "scheme",\n+            }\n+        )\n \n         self.params = params.copy()\n \n@@ -607,11 +624,11 @@ def get_transform_middleware(self):\n             doctype=self.doctype,\n             content_type=self.content_type,\n             unquoted_params=self.unquoted_params,\n-            **self.params  # NOQA: C815,S101\n+            **self.params,  # NOQA: C815,S101\n         )\n \n     def get_filter_middleware(self):\n-        tree = pkg_parse(\'filter_xhtml.xsl\')\n+        tree = pkg_parse("filter_xhtml.xsl")\n         return XSLTMiddleware(\n             self.app,\n             self.global_conf,\n@@ -620,22 +637,22 @@ def get_filter_middleware(self):\n             read_file=False,\n             update_content_length=self.update_content_length,\n             ignored_extensions=self.ignored_extensions,\n-            environ_param_map={\'diazo.filter_xpath\': \'xpath\'},\n-            doctype=\'\',\n+            environ_param_map={"diazo.filter_xpath": "xpath"},\n+            doctype="",\n             content_type=self.content_type,\n-            unquoted_params=[\'xpath\'],\n+            unquoted_params=["xpath"],\n         )\n \n     def __call__(self, environ, start_response):\n         if self.filter_xpath:\n-            filter_xpath = \';filter_xpath=\'\n-            query_string = environ.get(\'QUERY_STRING\', \'\')\n+            filter_xpath = ";filter_xpath="\n+            query_string = environ.get("QUERY_STRING", "")\n             if filter_xpath in query_string:\n-                environ[\'QUERY_STRING\'], xpath = query_string.rsplit(\n+                environ["QUERY_STRING"], xpath = query_string.rsplit(\n                     filter_xpath,\n                     1,\n                 )\n-                environ[\'diazo.filter_xpath\'] = unquote_plus(xpath)\n+                environ["diazo.filter_xpath"] = unquote_plus(xpath)\n                 return self.filter_middleware(environ, start_response)\n \n         transform_middleware = self.transform_middleware\n@@ -647,11 +664,11 @@ def __call__(self, environ, start_response):\n         # Set up variables, some of which are used as transform parameters\n         request = Request(environ)\n \n-        environ[\'diazo.rules\'] = self.rules\n-        environ[\'diazo.absolute_prefix\'] = self.absolute_prefix\n-        environ[\'diazo.path\'] = request.path\n-        environ[\'diazo.query_string\'] = request.query_string\n-        environ[\'diazo.host\'] = request.host\n-        environ[\'diazo.scheme\'] = request.scheme\n+        environ["diazo.rules"] = self.rules\n+        environ["diazo.absolute_prefix"] = self.absolute_prefix\n+        environ["diazo.path"] = request.path\n+        environ["diazo.query_string"] = request.query_string\n+        environ["diazo.host"] = request.host\n+        environ["diazo.scheme"] = request.scheme\n \n         return transform_middleware(environ, start_response)\n'

Repository: diazo


Branch: refs/heads/master
Date: 2024-01-29T23:32:33+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/diazo/commit/f43f11e73b05787f5ac04631eb7776f7c5048747

codespell: configure and fix

Files changed:
M .meta.toml
M docs/advanced.rst
M docs/introduction.rst
M pyproject.toml
M src/diazo/compiler.py
M src/diazo/tests/css-xpath-child-selectors/content.html
M src/diazo/tests/css-xpath-child-selectors/output.html
M src/diazo/utils.py
M tox.ini

b'diff --git a/.meta.toml b/.meta.toml\nindex 103d7ca..7c61593 100644\n--- a/.meta.toml\n+++ b/.meta.toml\n@@ -4,3 +4,6 @@\n [meta]\n template = "default"\n commit-id = "5d3e918e"\n+\n+[pyproject]\n+codespell_skip = "*.po,*.min.js,*.graffle,src/diazo/tests/conditional-drop-in-append*"\ndiff --git a/docs/advanced.rst b/docs/advanced.rst\nindex a14c0ab..b7dd2cb 100644\n--- a/docs/advanced.rst\n+++ b/docs/advanced.rst\n@@ -127,7 +127,7 @@ For example, if the transform is set up to receive a string parameter\n \n     <drop css:theme=".test-site-warning" if="$mode = \'live\'" />\n \n-Use the ``if-not`` attribute to negate the conditon, for example::\n+Use the ``if-not`` attribute to negate the condition, for example::\n \n     <drop css:theme=".test-site-warning" if-not="$mode = \'live\'" />\n \n@@ -344,7 +344,7 @@ the included WSGI middleware include a ``doctype`` option which may be set to\n XInclude\n --------\n \n-You may wish to re-use elements of your rules file across multiple themes.\n+You may wish to reuse elements of your rules file across multiple themes.\n This is particularly useful if you have multiple variations on the same theme\n used to style different pages on a particular website.\n \ndiff --git a/docs/introduction.rst b/docs/introduction.rst\nindex 74655e6..7c3b35a 100644\n--- a/docs/introduction.rst\n+++ b/docs/introduction.rst\n@@ -42,7 +42,7 @@ Bear in mind that:\n   be served from a static webserver, which is normally much faster than\n   serving them from a dynamic application.\n * You can leave the original theme HTML untouched, which makes it easier to\n-  re-use for other scenarios. For example, you can stitch two unrelated\n+  reuse for other scenarios. For example, you can stitch two unrelated\n   applications together by using a single theme file with separate rules\n   files. This would result in two compiled XSLT files. You could use location\n   match rules or similar techniques to choose which one to invoke for a given\ndiff --git a/pyproject.toml b/pyproject.toml\nindex f39d091..a472155 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -72,7 +72,7 @@ target-version = ["py38"]\n \n [tool.codespell]\n ignore-words-list = "discreet,"\n-skip = "*.po,"\n+skip = "*.po,*.po,*.min.js,*.graffle,src/diazo/tests/conditional-drop-in-append*"\n ##\n # Add extra configuration options in .meta.toml:\n #  [pyproject]\ndiff --git a/src/diazo/compiler.py b/src/diazo/compiler.py\nindex 51191af..3cb6fed 100644\n--- a/src/diazo/compiler.py\n+++ b/src/diazo/compiler.py\n@@ -92,7 +92,7 @@ def compile_theme(\n \n     * ``rules`` is the rules file\n     * ``theme`` is the theme file\n-    * ``extra`` is an optional XSLT file with Diazo extensions (depracated, use\n+    * ``extra`` is an optional XSLT file with Diazo extensions (deprecated, use\n       inline xsl in the rules instead)\n     * ``css``   can be set to False to disable CSS syntax support (providing a\n       moderate speed gain)\ndiff --git a/src/diazo/tests/css-xpath-child-selectors/content.html b/src/diazo/tests/css-xpath-child-selectors/content.html\nindex 83787c9..f1fb295 100644\n--- a/src/diazo/tests/css-xpath-child-selectors/content.html\n+++ b/src/diazo/tests/css-xpath-child-selectors/content.html\n@@ -10,6 +10,6 @@ <h2>Smaller Title</h2>\n             <p>content</p>\n             <span class="replace">new item from content</span>\n         </div>\n-        <div class="replace">Someting very great from last content\'s DIV</div>\n+        <div class="replace">Something very great from last content\'s DIV</div>\n     </body>\n </html>\ndiff --git a/src/diazo/tests/css-xpath-child-selectors/output.html b/src/diazo/tests/css-xpath-child-selectors/output.html\nindex 3352e84..a910a37 100644\n--- a/src/diazo/tests/css-xpath-child-selectors/output.html\n+++ b/src/diazo/tests/css-xpath-child-selectors/output.html\n@@ -6,7 +6,7 @@\n   </head>\n   <body>\n     <div>\n-      <div class="replace">Someting very great from last content\'s DIV</div>\n+      <div class="replace">Something very great from last content\'s DIV</div>\n     </div>\n     <div>\n             <span>Third Marker</span>\ndiff --git a/src/diazo/utils.py b/src/diazo/utils.py\nindex f4e72e4..5b7e4e7 100644\n--- a/src/diazo/utils.py\n+++ b/src/diazo/utils.py\n@@ -202,7 +202,7 @@ def _createOptionParser(usage):\n         "--extra",\n         metavar="extra.xsl",\n         help="Extra XSL to be included in the transform "\n-        "(depracated, use inline xsl in the rules instead)",\n+        "(deprecated, use inline xsl in the rules instead)",\n         dest="extra",\n         default=None,\n     )\ndiff --git a/tox.ini b/tox.ini\nindex 64435e8..d6e347c 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -120,7 +120,7 @@ deps =\n #  constraints_file = "https://my-server.com/constraints.txt"\n ##\n commands =\n-    zope-testrunner --all --test-path={toxinidir} -s diazo {posargs}\n+    zope-testrunner --all --test-path={toxinidir}/src -s diazo {posargs}\n extras =\n     test\n \n@@ -154,7 +154,7 @@ deps =\n     -c https://dist.plone.org/release/6.0-dev/constraints.txt\n     \n commands =\n-    coverage run --branch --source diazo {envbindir}/zope-testrunner --quiet --all --test-path={toxinidir} -s diazo {posargs}\n+    coverage run --branch --source diazo {envbindir}/zope-testrunner --quiet --all --test-path={toxinidir}/src -s diazo {posargs}\n     coverage report -m --format markdown\n     coverage xml\n extras =\n'

Repository: diazo


Branch: refs/heads/master
Date: 2024-01-29T23:32:39+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/diazo/commit/01336929b27b3701804153044088361e1c91a74a

flake8.  Remove no longer needed 'six' dependency.

Files changed:
M docs/conf.py
M setup.py
M src/diazo/compiler.py
M src/diazo/rules.py
M src/diazo/run.py
M src/diazo/runtrace.py
M src/diazo/tests/test_diazo.py
M src/diazo/utils.py
M src/diazo/wsgi.py

b'diff --git a/docs/conf.py b/docs/conf.py\nindex 998d32b..ae789c7 100644\n--- a/docs/conf.py\n+++ b/docs/conf.py\n@@ -10,10 +10,6 @@\n # All configuration values have a default; values that are commented out\n # serve to show the default.\n \n-import os\n-import sys\n-\n-\n # If extensions (or modules to document with autodoc) are in another directory,\n # add these directories to sys.path here. If the directory is relative to the\n # documentation root, use os.path.abspath to make it absolute, like shown here.\ndiff --git a/setup.py b/setup.py\nindex 7be6131..dcc0c25 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -56,7 +56,6 @@\n         #    \'setuptools\',\n         "lxml",\n         "cssselect",\n-        "six",\n     ],\n     extras_require=extras_require,\n     test_suite="diazo.tests.alltests",\ndiff --git a/src/diazo/compiler.py b/src/diazo/compiler.py\nindex 3cb6fed..78e63e9 100644\n--- a/src/diazo/compiler.py\n+++ b/src/diazo/compiler.py\n@@ -17,7 +17,6 @@\n from diazo.utils import quote_param\n from diazo.utils import split_params\n from lxml import etree\n-from six import string_types\n \n import logging\n import pkg_resources\ndiff --git a/src/diazo/rules.py b/src/diazo/rules.py\nindex a25ec69..dfab0e3 100644\n--- a/src/diazo/rules.py\n+++ b/src/diazo/rules.py\n@@ -11,7 +11,6 @@\n from diazo.utils import namespaces\n from diazo.utils import pkg_xsl\n from lxml import etree\n-from six import string_types\n from urllib.parse import urljoin\n from urllib.request import urlopen\n \ndiff --git a/src/diazo/run.py b/src/diazo/run.py\nindex a331f68..5d1a9f5 100644\n--- a/src/diazo/run.py\n+++ b/src/diazo/run.py\n@@ -15,7 +15,6 @@\n from diazo.utils import quote_param\n from diazo.utils import split_params\n from lxml import etree\n-from six import string_types\n \n import diazo.runtrace\n import logging\ndiff --git a/src/diazo/runtrace.py b/src/diazo/runtrace.py\nindex 5354ccd..37724b8 100644\n--- a/src/diazo/runtrace.py\n+++ b/src/diazo/runtrace.py\n@@ -13,7 +13,7 @@\n \n \n def log_to_xml_string(error_log):\n-    msgs = [l.message for l in error_log if l.message.startswith("<runtrace ")]\n+    msgs = [log.message for log in error_log if log.message.startswith("<runtrace ")]\n     return """\n <runtrace xmlns:css="http://namespaces.plone.org/diazo/css">\n     {message:s}\n@@ -56,21 +56,21 @@ def runtrace_to_html(runtrace_doc):\n def error_log_to_html(error_log):\n     """Convert an error log into an HTML representation"""\n     doc = etree.Element("ul")\n-    for l in error_log:\n-        if l.message.startswith("<runtrace "):\n+    for log in error_log:\n+        if log.message.startswith("<runtrace "):\n             continue\n         el = etree.Element("li")\n         el.attrib[\n             "class"\n         ] = "domain_{domain_name} level_{level_name} type_{type_name}".format(  # NOQA: E501\n-            domain_name=l.domain_name,\n-            level_name=l.level_name,\n-            type_name=l.type_name,\n+            domain_name=log.domain_name,\n+            level_name=log.level_name,\n+            type_name=log.type_name,\n         )\n         el.text = "{msg:s} [{line:d}:{column:d}]".format(\n-            msg=l.message,\n-            line=l.line,\n-            column=l.column,\n+            msg=log.message,\n+            line=log.line,\n+            column=log.column,\n         )\n         doc.append(el)\n     return doc\ndiff --git a/src/diazo/tests/test_diazo.py b/src/diazo/tests/test_diazo.py\nindex e2b9be1..08e5ef4 100644\n--- a/src/diazo/tests/test_diazo.py\n+++ b/src/diazo/tests/test_diazo.py\n@@ -3,12 +3,12 @@\n from io import StringIO\n from lxml import etree\n \n+import configparser\n import diazo.compiler\n import diazo.run\n import difflib\n import os\n import pkg_resources\n-import six\n import sys\n import unittest\n \n@@ -17,12 +17,6 @@\n # Simple test runner for validating different diazo scenarios\n #\n \n-try:\n-    import configparser\n-except ImportError:\n-    import ConfigParser as configparser\n-\n-\n if __name__ == "__main__":\n     __file__ = sys.argv[0]\n \ndiff --git a/src/diazo/utils.py b/src/diazo/utils.py\nindex 5b7e4e7..d7e2e67 100644\n--- a/src/diazo/utils.py\n+++ b/src/diazo/utils.py\n@@ -1,8 +1,5 @@\n from lxml import etree\n from optparse import OptionParser\n-from six import integer_types\n-from six import PY3\n-from six import string_types\n \n import logging\n import pkg_resources\ndiff --git a/src/diazo/wsgi.py b/src/diazo/wsgi.py\nindex 4735cee..60d9c8e 100644\n--- a/src/diazo/wsgi.py\n+++ b/src/diazo/wsgi.py\n@@ -4,7 +4,6 @@\n from lxml import etree\n from repoze.xmliter.serializer import XMLSerializer\n from repoze.xmliter.utils import getHTMLSerializer\n-from six import string_types\n from urllib.parse import unquote_plus\n from webob import Request\n \n'

Repository: diazo


Branch: refs/heads/master
Date: 2024-01-29T23:32:39+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/diazo/commit/f30b10328a179ef79c8d9030e153acea02a1f5c3

Remove unneeded 'py' test dependency.

Files changed:
M setup.py

b'diff --git a/setup.py b/setup.py\nindex dcc0c25..4e91349 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -10,7 +10,6 @@\n     "test": [\n         "repoze.xmliter",\n         "WebOb",\n-        "py",\n     ],\n }\n \n'

Repository: diazo


Branch: refs/heads/master
Date: 2024-01-29T23:40:42+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/diazo/commit/9a9ce0d36407fec424be1e184efec6cddb999959

Almost completely disable zpretty.

Only handle zcml (which is one file).
When handling html and/or xml, we get various test failures like these:

* `TypeError: a bytes-like object is required, not 'str'`
* `lxml.etree.XMLSyntaxError: Entity 'nbsp' not defined, line 4, column 59`
* `lxml.etree.XMLSyntaxError: Entity 'Acirc' not defined, line 11, column 20`
* `AssertionError: False is not true`

Files changed:
M .meta.toml
M .pre-commit-config.yaml
M src/diazo/diazo-debug.zcml

b'diff --git a/.meta.toml b/.meta.toml\nindex 7c61593..7288454 100644\n--- a/.meta.toml\n+++ b/.meta.toml\n@@ -5,5 +5,11 @@\n template = "default"\n commit-id = "5d3e918e"\n \n+[pre_commit]\n+zpretty_extra_lines = """\n+        # Various test failures when we change xml and html.\n+        files: ".*.(zcml)$"\n+"""\n+\n [pyproject]\n codespell_skip = "*.po,*.min.js,*.graffle,src/diazo/tests/conditional-drop-in-append*"\ndiff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nindex caf34e5..f94e3d8 100644\n--- a/.pre-commit-config.yaml\n+++ b/.pre-commit-config.yaml\n@@ -23,6 +23,8 @@ repos:\n     rev: 3.1.0\n     hooks:\n     -   id: zpretty\n+        # Various test failures when we change xml and html.\n+        files: ".*.(zcml)$"\n \n ##\n # Add extra configuration options in .meta.toml:\ndiff --git a/src/diazo/diazo-debug.zcml b/src/diazo/diazo-debug.zcml\nindex 285694a..189dfd8 100644\n--- a/src/diazo/diazo-debug.zcml\n+++ b/src/diazo/diazo-debug.zcml\n@@ -2,14 +2,16 @@\n     xmlns="http://namespaces.zope.org/zope"\n     xmlns:browser="http://namespaces.zope.org/browser"\n     xmlns:gs="http://namespaces.zope.org/genericsetup"\n-    xmlns:zcml="http://namespaces.zope.org/zcml"\n     xmlns:i18n="http://namespaces.zope.org/i18n"\n     xmlns:plone="http://namespaces.plone.org/plone"\n-    i18n_domain="plone">\n+    xmlns:zcml="http://namespaces.zope.org/zcml"\n+    i18n_domain="plone"\n+    >\n \n-    <!-- Static resources -->\n-    <browser:resourceDirectory\n-        name="diazo-debug"\n-        directory="debug_resources" />\n+  <!-- Static resources -->\n+  <browser:resourceDirectory\n+      name="diazo-debug"\n+      directory="debug_resources"\n+      />\n \n </configure>\n'

Repository: diazo


Branch: refs/heads/master
Date: 2024-01-30T00:10:24+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/diazo/commit/60d93b56a4a3068b22d669fbc4bf8df9ad978ff2

pre-commit autoupdate and fix

Files changed:
M .pre-commit-config.yaml
M src/diazo/runtrace.py

b'diff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nindex f94e3d8..68017b1 100644\n--- a/.pre-commit-config.yaml\n+++ b/.pre-commit-config.yaml\n@@ -16,7 +16,7 @@ repos:\n     hooks:\n     -   id: isort\n -   repo: https://github.com/psf/black\n-    rev: 23.12.1\n+    rev: 24.1.1\n     hooks:\n     -   id: black\n -   repo: https://github.com/collective/zpretty\n@@ -34,7 +34,7 @@ repos:\n #  """\n ##\n -   repo: https://github.com/PyCQA/flake8\n-    rev: 6.1.0\n+    rev: 7.0.0\n     hooks:\n     -   id: flake8\n \ndiff --git a/src/diazo/runtrace.py b/src/diazo/runtrace.py\nindex 37724b8..ec3de65 100644\n--- a/src/diazo/runtrace.py\n+++ b/src/diazo/runtrace.py\n@@ -60,12 +60,12 @@ def error_log_to_html(error_log):\n         if log.message.startswith("<runtrace "):\n             continue\n         el = etree.Element("li")\n-        el.attrib[\n-            "class"\n-        ] = "domain_{domain_name} level_{level_name} type_{type_name}".format(  # NOQA: E501\n-            domain_name=log.domain_name,\n-            level_name=log.level_name,\n-            type_name=log.type_name,\n+        el.attrib["class"] = (\n+            "domain_{domain_name} level_{level_name} type_{type_name}".format(  # NOQA: E501\n+                domain_name=log.domain_name,\n+                level_name=log.level_name,\n+                type_name=log.type_name,\n+            )\n         )\n         el.text = "{msg:s} [{line:d}:{column:d}]".format(\n             msg=log.message,\n'

Repository: diazo


Branch: refs/heads/master
Date: 2024-01-30T00:24:42+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/diazo/commit/ae4f905915d3873e49dde7e67b4eddc6033b0da4

Disable 'dependencies' github action.

It does not take the 'wsgi' extra into account.

Files changed:
M .github/workflows/meta.yml
M .meta.toml

b'diff --git a/.github/workflows/meta.yml b/.github/workflows/meta.yml\nindex b8edec0..1e44406 100644\n--- a/.github/workflows/meta.yml\n+++ b/.github/workflows/meta.yml\n@@ -30,8 +30,6 @@ jobs:\n     uses: plone/meta/.github/workflows/test.yml@main\n   coverage:\n     uses: plone/meta/.github/workflows/coverage.yml@main\n-  dependencies:\n-    uses: plone/meta/.github/workflows/dependencies.yml@main\n   release_ready:\n     uses: plone/meta/.github/workflows/release_ready.yml@main\n   circular:\ndiff --git a/.meta.toml b/.meta.toml\nindex 7288454..5978838 100644\n--- a/.meta.toml\n+++ b/.meta.toml\n@@ -5,6 +5,15 @@\n template = "default"\n commit-id = "5d3e918e"\n \n+[github]\n+jobs = [\n+    "qa",\n+    "test",\n+    "coverage",\n+    "release_ready",\n+    "circular",\n+    ]\n+\n [pre_commit]\n zpretty_extra_lines = """\n         # Various test failures when we change xml and html.\n'

Repository: diazo


Branch: refs/heads/master
Date: 2024-02-10T01:11:21+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/diazo/commit/24cf31335c918a1de55e1a4702e9605cf3ad98ca

Merge pull request #86 from plone/config-with-default-template-5d3e918e

Require Python 3.8+, configure with plone/meta

Files changed:
A .editorconfig
A .flake8
A .github/workflows/meta.yml
A .meta.toml
A .pre-commit-config.yaml
A news/23.breaking
A news/5d3e918e.internal
A src/diazo/__init__.py
A src/diazo/annotate-rules.xsl
A src/diazo/annotate-themes.xsl
A src/diazo/apply-conditions.xsl
A src/diazo/apply-rules.xsl
A src/diazo/compiler.py
A src/diazo/cssrules.py
A src/diazo/debug_resources/diazo-debug.css
A src/diazo/debug_resources/diazo-debug.js
A src/diazo/debug_resources/iframe.js
A src/diazo/debug_resources/jquery-1.8.3.min.js
A src/diazo/defaults.xsl
A src/diazo/diazo-debug.zcml
A src/diazo/dummy.html
A src/diazo/emit-stylesheet.xsl
A src/diazo/filter.xsl
A src/diazo/filter_html.xsl
A src/diazo/filter_xhtml.xsl
A src/diazo/fixup-themes.xsl
A src/diazo/identity.xsl
A src/diazo/include.xsl
A src/diazo/merge-conditions.xsl
A src/diazo/normalize-rules.xsl
A src/diazo/rules.py
A src/diazo/run.py
A src/diazo/runtrace.py
A src/diazo/runtrace_to_html.xsl
A src/diazo/tests/__init__.py
A src/diazo/tests/absolute-prefix-disabled/content.html
A src/diazo/tests/absolute-prefix-disabled/options.cfg
A src/diazo/tests/absolute-prefix-disabled/output.html
A src/diazo/tests/absolute-prefix-disabled/rules.xml
A src/diazo/tests/absolute-prefix-disabled/theme.html
A src/diazo/tests/absolute-prefix-ie-conditional-comments/content.html
A src/diazo/tests/absolute-prefix-ie-conditional-comments/options.cfg
A src/diazo/tests/absolute-prefix-ie-conditional-comments/output.html
A src/diazo/tests/absolute-prefix-ie-conditional-comments/rules.xml
A src/diazo/tests/absolute-prefix-ie-conditional-comments/theme.html
A src/diazo/tests/absolute-prefix/content.html
A src/diazo/tests/absolute-prefix/options.cfg
A src/diazo/tests/absolute-prefix/output.html
A src/diazo/tests/absolute-prefix/rules.xml
A src/diazo/tests/absolute-prefix/theme.html
A src/diazo/tests/allow-curly-brackets/README.rst
A src/diazo/tests/allow-curly-brackets/content.html
A src/diazo/tests/allow-curly-brackets/output.html
A src/diazo/tests/allow-curly-brackets/rules.xml
A src/diazo/tests/allow-curly-brackets/theme.html
A src/diazo/tests/append/content.html
A src/diazo/tests/append/output.html
A src/diazo/tests/append/rules.xml
A src/diazo/tests/append/theme.html
A src/diazo/tests/append/xpaths.txt
A src/diazo/tests/before-content-conditional/content.html
A src/diazo/tests/before-content-conditional/output.html
A src/diazo/tests/before-content-conditional/rules.xml
A src/diazo/tests/before-content-conditional/theme.html
A src/diazo/tests/before-prepend-append-after/content.html
A src/diazo/tests/before-prepend-append-after/output.html
A src/diazo/tests/before-prepend-append-after/rules.xml
A src/diazo/tests/before-prepend-append-after/theme.html
A src/diazo/tests/comments-outside-root-tag/content.html
A src/diazo/tests/comments-outside-root-tag/output.html
A src/diazo/tests/comments-outside-root-tag/rules.xml
A src/diazo/tests/comments-outside-root-tag/theme.html
A src/diazo/tests/comments/content.html
A src/diazo/tests/comments/output.html
A src/diazo/tests/comments/rules.xml
A src/diazo/tests/comments/theme.html
A src/diazo/tests/comments/xpaths.txt
A src/diazo/tests/conditional-content-rules-with-variable/content.html
A src/diazo/tests/conditional-content-rules-with-variable/output.html
A src/diazo/tests/conditional-content-rules-with-variable/rules.xml
A src/diazo/tests/conditional-content-rules-with-variable/theme.html
A src/diazo/tests/conditional-drop-in-append-1/content.html
A src/diazo/tests/conditional-drop-in-append-1/output.html
A src/diazo/tests/conditional-drop-in-append-1/rules.xml
A src/diazo/tests/conditional-drop-in-append-1/theme.html
A src/diazo/tests/conditional-drop-in-append-2/content.html
A src/diazo/tests/conditional-drop-in-append-2/output.html
A src/diazo/tests/conditional-drop-in-append-2/rules.xml
A src/diazo/tests/conditional-drop-in-append-2/theme.html
A src/diazo/tests/conditional-include-content/content.html
A src/diazo/tests/conditional-include-content/output.html
A src/diazo/tests/conditional-include-content/rules.xml
A src/diazo/tests/conditional-include-content/theme.html
A src/diazo/tests/conditional-rules-1/content.html
A src/diazo/tests/conditional-rules-1/output.html
A src/diazo/tests/conditional-rules-1/rules.xml
A src/diazo/tests/conditional-rules-1/theme.html
A src/diazo/tests/conditional-rules-1/xpaths.txt
A src/diazo/tests/conditional-rules-2/content.html
A src/diazo/tests/conditional-rules-2/output.html
A src/diazo/tests/conditional-rules-2/rules.xml
A src/diazo/tests/conditional-rules-2/theme.html
A src/diazo/tests/conditional-rules-2/xpaths.txt
A src/diazo/tests/copy-xsl/content.html
A src/diazo/tests/copy-xsl/output.html
A src/diazo/tests/copy-xsl/rules.xml
A src/diazo/tests/copy-xsl/theme.html
A src/diazo/tests/copy/README.rst
A src/diazo/tests/copy/content.html
A src/diazo/tests/copy/output.html
A src/diazo/tests/copy/rules.xml
A src/diazo/tests/copy/theme.html
A src/diazo/tests/copy/xpaths.txt
A src/diazo/tests/css-prefix/content.html
A src/diazo/tests/css-prefix/output.html
A src/diazo/tests/css-prefix/rules.xml
A src/diazo/tests/css-prefix/theme.html
A src/diazo/tests/css-xpath-child-selectors/content.html
A src/diazo/tests/css-xpath-child-selectors/output.html
A src/diazo/tests/css-xpath-child-selectors/rules.xml
A src/diazo/tests/css-xpath-child-selectors/theme.html
A src/diazo/tests/css-xsl-template/content.html
A src/diazo/tests/css-xsl-template/output.html
A src/diazo/tests/css-xsl-template/rules.xml
A src/diazo/tests/css-xsl-template/theme.html
A src/diazo/tests/default-options.cfg
A src/diazo/tests/document-includes/content.html
A src/diazo/tests/document-includes/extra.html
A src/diazo/tests/document-includes/output.html
A src/diazo/tests/document-includes/rules.xml
A src/diazo/tests/document-includes/theme.html
A src/diazo/tests/document-includes/xpaths.txt
A src/diazo/tests/drop-content-comment/content.html
A src/diazo/tests/drop-content-comment/output.html
A src/diazo/tests/drop-content-comment/rules.xml
A src/diazo/tests/drop-content-comment/theme.html
A src/diazo/tests/drop-content/content.html
A src/diazo/tests/drop-content/output.html
A src/diazo/tests/drop-content/rules.xml
A src/diazo/tests/drop-content/theme.html
A src/diazo/tests/drop-content/xpaths.txt
A src/diazo/tests/drop-replace/content.html
A src/diazo/tests/drop-replace/output.html
A src/diazo/tests/drop-replace/rules.xml
A src/diazo/tests/drop-replace/theme.html
A src/diazo/tests/drop-theme-children/content.html
A src/diazo/tests/drop-theme-children/output.html
A src/diazo/tests/drop-theme-children/rules.xml
A src/diazo/tests/drop-theme-children/theme.html
A src/diazo/tests/drop-theme-comment/content.html
A src/diazo/tests/drop-theme-comment/output.html
A src/diazo/tests/drop-theme-comment/rules.xml
A src/diazo/tests/drop-theme-comment/theme.html
A src/diazo/tests/empty-xmlns/README.txt
A src/diazo/tests/empty-xmlns/content.html
A src/diazo/tests/empty-xmlns/output.html
A src/diazo/tests/empty-xmlns/rules.xml
A src/diazo/tests/empty-xmlns/theme.html
A src/diazo/tests/entities/content.html
A src/diazo/tests/entities/output.html
A src/diazo/tests/entities/rules.xml
A src/diazo/tests/entities/theme.html
A src/diazo/tests/esi/content.html
A src/diazo/tests/esi/output.html
A src/diazo/tests/esi/rules.xml
A src/diazo/tests/esi/theme.html
A src/diazo/tests/esi/xpaths.txt
A src/diazo/tests/html-attributes/content.html
A src/diazo/tests/html-attributes/output.html
A src/diazo/tests/html-attributes/rules.xml
A src/diazo/tests/html-attributes/theme.html
A src/diazo/tests/html-xml-lang-2/content.html
A src/diazo/tests/html-xml-lang-2/output.html
A src/diazo/tests/html-xml-lang-2/rules.xml
A src/diazo/tests/html-xml-lang-2/theme.html
A src/diazo/tests/html-xml-lang-3/content.html
A src/diazo/tests/html-xml-lang-3/output.html
A src/diazo/tests/html-xml-lang-3/rules.xml
A src/diazo/tests/html-xml-lang-3/theme.html
A src/diazo/tests/html-xml-lang/content.html
A src/diazo/tests/html-xml-lang/output.html
A src/diazo/tests/html-xml-lang/rules.xml
A src/diazo/tests/html-xml-lang/theme.html
A src/diazo/tests/if-path-1/content.html
A src/diazo/tests/if-path-1/options.cfg
A src/diazo/tests/if-path-1/output.html
A src/diazo/tests/if-path-1/rules.xml
A src/diazo/tests/if-path-1/theme.html
A src/diazo/tests/if-path-2/content.html
A src/diazo/tests/if-path-2/options.cfg
A src/diazo/tests/if-path-2/output.html
A src/diazo/tests/if-path-2/rules.xml
A src/diazo/tests/if-path-2/theme.html
A src/diazo/tests/if-path-3/content.html
A src/diazo/tests/if-path-3/options.cfg
A src/diazo/tests/if-path-3/output.html
A src/diazo/tests/if-path-3/rules.xml
A src/diazo/tests/if-path-3/theme.html
A src/diazo/tests/if-path-4/content.html
A src/diazo/tests/if-path-4/options.cfg
A src/diazo/tests/if-path-4/output.html
A src/diazo/tests/if-path-4/rules.xml
A src/diazo/tests/if-path-4/theme.html
A src/diazo/tests/if-path-5/content.html
A src/diazo/tests/if-path-5/options.cfg
A src/diazo/tests/if-path-5/output.html
A src/diazo/tests/if-path-5/rules.xml
A src/diazo/tests/if-path-5/theme.html
A src/diazo/tests/if-path-6/content.html
A src/diazo/tests/if-path-6/options.cfg
A src/diazo/tests/if-path-6/output.html
A src/diazo/tests/if-path-6/rules.xml
A src/diazo/tests/if-path-6/theme.html
A src/diazo/tests/if-path-7/content.html
A src/diazo/tests/if-path-7/options.cfg
A src/diazo/tests/if-path-7/output.html
A src/diazo/tests/if-path-7/rules.xml
A src/diazo/tests/if-path-7/theme.html
A src/diazo/tests/if-path-8/content.html
A src/diazo/tests/if-path-8/options.cfg
A src/diazo/tests/if-path-8/output.html
A src/diazo/tests/if-path-8/rules.xml
A src/diazo/tests/if-path-8/theme.html
A src/diazo/tests/include-content/content.html
A src/diazo/tests/include-content/extra.html
A src/diazo/tests/include-content/output.html
A src/diazo/tests/include-content/rules.xml
A src/diazo/tests/include-content/theme.html
A src/diazo/tests/indent-off/content.html
A src/diazo/tests/indent-off/options.cfg
A src/diazo/tests/indent-off/output.html
A src/diazo/tests/indent-off/rules.xml
A src/diazo/tests/indent-off/theme.html
A src/diazo/tests/inline-xsl-apply-templates/content.html
A src/diazo/tests/inline-xsl-apply-templates/output.html
A src/diazo/tests/inline-xsl-apply-templates/rules.xml
A src/diazo/tests/inline-xsl-apply-templates/theme.html
A src/diazo/tests/inline-xsl-directives/content.html
A src/diazo/tests/inline-xsl-directives/output.html
A src/diazo/tests/inline-xsl-directives/rules.xml
A src/diazo/tests/inline-xsl-directives/theme.html
A src/diazo/tests/modify-theme/content.html
A src/diazo/tests/modify-theme/output.html
A src/diazo/tests/modify-theme/rules.xml
A src/diazo/tests/modify-theme/theme.html
A src/diazo/tests/modify-theme/xpaths.txt
A src/diazo/tests/multi-copy-1/content.html
A src/diazo/tests/multi-copy-1/rules.xml
A src/diazo/tests/multi-copy-1/theme.html
A src/diazo/tests/multi-copy-1/xpaths.txt
A src/diazo/tests/multi-copy-2/content.html
A src/diazo/tests/multi-copy-2/rules.xml
A src/diazo/tests/multi-copy-2/theme.html
A src/diazo/tests/multi-copy-2/xpaths.txt
A src/diazo/tests/multi-copy-3/content.html
A src/diazo/tests/multi-copy-3/rules.xml
A src/diazo/tests/multi-copy-3/theme.html
A src/diazo/tests/multi-copy-3/xpaths.txt
A src/diazo/tests/multi-copy-4/content.html
A src/diazo/tests/multi-copy-4/rules.xml
A src/diazo/tests/multi-copy-4/theme.html
A src/diazo/tests/multi-copy-4/xpaths.txt
A src/diazo/tests/multi-replace-1/content.html
A src/diazo/tests/multi-replace-1/rules.xml
A src/diazo/tests/multi-replace-1/theme.html
A src/diazo/tests/multi-replace-1/xpaths.txt
A src/diazo/tests/multi-replace-2/content.html
A src/diazo/tests/multi-replace-2/rules.xml
A src/diazo/tests/multi-replace-2/theme.html
A src/diazo/tests/multi-replace-2/xpaths.txt
A src/diazo/tests/multi-replace-3/content.html
A src/diazo/tests/multi-replace-3/rules.xml
A src/diazo/tests/multi-replace-3/theme.html
A src/diazo/tests/multi-replace-3/xpaths.txt
A src/diazo/tests/multi-replace-4/content.html
A src/diazo/tests/multi-replace-4/rules.xml
A src/diazo/tests/multi-replace-4/theme.html
A src/diazo/tests/multi-replace-4/xpaths.txt
A src/diazo/tests/multi-theme-1/content.html
A src/diazo/tests/multi-theme-1/options.cfg
A src/diazo/tests/multi-theme-1/output.html
A src/diazo/tests/multi-theme-1/rules.xml
A src/diazo/tests/multi-theme-1/theme1.html
A src/diazo/tests/multi-theme-1/theme2.html
A src/diazo/tests/multi-theme-2/content.html
A src/diazo/tests/multi-theme-2/options.cfg
A src/diazo/tests/multi-theme-2/output.html
A src/diazo/tests/multi-theme-2/rules.xml
A src/diazo/tests/multi-theme-2/theme1.html
A src/diazo/tests/multi-theme-2/theme2.html
A src/diazo/tests/multi-theme-3/content.html
A src/diazo/tests/multi-theme-3/options.cfg
A src/diazo/tests/multi-theme-3/output.html
A src/diazo/tests/multi-theme-3/rules.xml
A src/diazo/tests/multi-theme-3/theme1.html
A src/diazo/tests/multi-theme-3/theme2.html
A src/diazo/tests/multi-theme-4/content.html
A src/diazo/tests/multi-theme-4/options.cfg
A src/diazo/tests/multi-theme-4/output.html
A src/diazo/tests/multi-theme-4/rules.xml
A src/diazo/tests/multi-theme-4/theme1.html
A src/diazo/tests/multi-theme-4/theme2.html
A src/diazo/tests/multi-theme-5/content.html
A src/diazo/tests/multi-theme-5/options.cfg
A src/diazo/tests/multi-theme-5/output.html
A src/diazo/tests/multi-theme-5/rules.xml
A src/diazo/tests/multi-theme-5/theme1.html
A src/diazo/tests/multi-theme-5/theme2.html
A src/diazo/tests/multi-theme-variable-1/content.html
A src/diazo/tests/multi-theme-variable-1/options.cfg
A src/diazo/tests/multi-theme-variable-1/output.html
A src/diazo/tests/multi-theme-variable-1/rules.xml
A src/diazo/tests/multi-theme-variable-1/theme1.html
A src/diazo/tests/multi-theme-variable-1/theme2.html
A src/diazo/tests/nested-conditions-1/content.html
A src/diazo/tests/nested-conditions-1/output.html
A src/diazo/tests/nested-conditions-1/rules.xml
A src/diazo/tests/nested-conditions-1/theme.html
A src/diazo/tests/nested-conditions-2/content.html
A src/diazo/tests/nested-conditions-2/output.html
A src/diazo/tests/nested-conditions-2/rules.xml
A src/diazo/tests/nested-conditions-2/theme.html
A src/diazo/tests/nested-conditions-3/content.html
A src/diazo/tests/nested-conditions-3/output.html
A src/diazo/tests/nested-conditions-3/rules.xml
A src/diazo/tests/nested-conditions-3/theme.html
A src/diazo/tests/nested-rules-for-xinclude/content.html
A src/diazo/tests/nested-rules-for-xinclude/output.html
A src/diazo/tests/nested-rules-for-xinclude/rules.xml
A src/diazo/tests/nested-rules-for-xinclude/theme.html
A src/diazo/tests/notheme-xmlns/content.html
A src/diazo/tests/notheme-xmlns/output.html
A src/diazo/tests/notheme-xmlns/rules.xml
A src/diazo/tests/notheme-xmlns/theme.html
A src/diazo/tests/null-if-content/content.html
A src/diazo/tests/null-if-content/rules.xml
A src/diazo/tests/null-if-content/theme.html
A src/diazo/tests/null-if-content/xpaths.txt
A src/diazo/tests/path-param-1/content.html
A src/diazo/tests/path-param-1/options.cfg
A src/diazo/tests/path-param-1/output.html
A src/diazo/tests/path-param-1/rules.xml
A src/diazo/tests/path-param-1/theme.html
A src/diazo/tests/path-param-2/content.html
A src/diazo/tests/path-param-2/options.cfg
A src/diazo/tests/path-param-2/output.html
A src/diazo/tests/path-param-2/rules.xml
A src/diazo/tests/path-param-2/theme.html
A src/diazo/tests/pre-line-endings/content.html
A src/diazo/tests/pre-line-endings/extra.html
A src/diazo/tests/pre-line-endings/output.html
A src/diazo/tests/pre-line-endings/rules.xml
A src/diazo/tests/pre-line-endings/theme.html
A src/diazo/tests/prepend-append/content.html
A src/diazo/tests/prepend-append/output.html
A src/diazo/tests/prepend-append/rules.xml
A src/diazo/tests/prepend-append/theme.html
A src/diazo/tests/prepend-append/xpaths.txt
A src/diazo/tests/prepend/content.html
A src/diazo/tests/prepend/output.html
A src/diazo/tests/prepend/rules.xml
A src/diazo/tests/prepend/theme.html
A src/diazo/tests/prepend/xpaths.txt
A src/diazo/tests/replace-after/content.html
A src/diazo/tests/replace-after/output.html
A src/diazo/tests/replace-after/rules.xml
A src/diazo/tests/replace-after/theme.html
A src/diazo/tests/replace-after/xpaths.txt
A src/diazo/tests/replace/README.rst
A src/diazo/tests/replace/content.html
A src/diazo/tests/replace/output.html
A src/diazo/tests/replace/rules.xml
A src/diazo/tests/replace/theme.html
A src/diazo/tests/replace/xpaths.txt
A src/diazo/tests/ssi/content.html
A src/diazo/tests/ssi/output.html
A src/diazo/tests/ssi/rules.xml
A src/diazo/tests/ssi/theme.html
A src/diazo/tests/ssi/xpaths.txt
A src/diazo/tests/ssiwait/content.html
A src/diazo/tests/ssiwait/output.html
A src/diazo/tests/ssiwait/rules.xml
A src/diazo/tests/ssiwait/theme.html
A src/diazo/tests/ssiwait/xpaths.txt
A src/diazo/tests/style-script-quoting-1/content.html
A src/diazo/tests/style-script-quoting-1/output.html
A src/diazo/tests/style-script-quoting-1/rules.xml
A src/diazo/tests/style-script-quoting-1/theme.html
A src/diazo/tests/style-script-quoting-1/xpaths.txt
A src/diazo/tests/style-script-quoting-2/content.html
A src/diazo/tests/style-script-quoting-2/output.html
A src/diazo/tests/style-script-quoting-2/rules.xml
A src/diazo/tests/style-script-quoting-2/theme.html
A src/diazo/tests/test_diazo.py
A src/diazo/tests/test_trace.py
A src/diazo/tests/test_wsgi.py
A src/diazo/tests/test_wsgi_files/custom_param.xml
A src/diazo/tests/test_wsgi_files/esi.xml
A src/diazo/tests/test_wsgi_files/explicit_theme.xml
A src/diazo/tests/test_wsgi_files/path_param.xml
A src/diazo/tests/test_wsgi_files/simple_transform.xml
A src/diazo/tests/test_wsgi_files/subrequest.xml
A src/diazo/tests/test_wsgi_files/theme.html
A src/diazo/tests/update-namespace-1/content.html
A src/diazo/tests/update-namespace-1/rules.xml
A src/diazo/tests/update-namespace-1/theme.html
A src/diazo/tests/update-namespace-1/xpaths.txt
A src/diazo/tests/update-namespace-2/content.html
A src/diazo/tests/update-namespace-2/output.html
A src/diazo/tests/update-namespace-2/rules.xml
A src/diazo/tests/update-namespace-2/theme.html
A src/diazo/tests/update-namespace-3/content.html
A src/diazo/tests/update-namespace-3/output.html
A src/diazo/tests/update-namespace-3/rules.xml
A src/diazo/tests/update-namespace-3/theme.html
A src/diazo/tests/v1-after-both-children/content.html
A src/diazo/tests/v1-after-both-children/output.html
A src/diazo/tests/v1-after-both-children/rules.xml
A src/diazo/tests/v1-after-both-children/theme.html
A src/diazo/tests/v1-after-content-children/content.html
A src/diazo/tests/v1-after-content-children/output.html
A src/diazo/tests/v1-after-content-children/rules.xml
A src/diazo/tests/v1-after-content-children/theme.html
A src/diazo/tests/v1-after-theme-children/content.html
A src/diazo/tests/v1-after-theme-children/output.html
A src/diazo/tests/v1-after-theme-children/rules.xml
A src/diazo/tests/v1-after-theme-children/theme.html
A src/diazo/tests/v1-after/content.html
A src/diazo/tests/v1-after/output.html
A src/diazo/tests/v1-after/rules.xml
A src/diazo/tests/v1-after/theme.html
A src/diazo/tests/v1-before-both-children/content.html
A src/diazo/tests/v1-before-both-children/output.html
A src/diazo/tests/v1-before-both-children/rules.xml
A src/diazo/tests/v1-before-both-children/theme.html
A src/diazo/tests/v1-before-content-children/content.html
A src/diazo/tests/v1-before-content-children/output.html
A src/diazo/tests/v1-before-content-children/rules.xml
A src/diazo/tests/v1-before-content-children/theme.html
A src/diazo/tests/v1-before-content-content-children/content.html
A src/diazo/tests/v1-before-content-content-children/output.html
A src/diazo/tests/v1-before-content-content-children/rules.xml
A src/diazo/tests/v1-before-content-content-children/theme.html
A src/diazo/tests/v1-before-replace-after-content/content.html
A src/diazo/tests/v1-before-replace-after-content/output.html
A src/diazo/tests/v1-before-replace-after-content/rules.xml
A src/diazo/tests/v1-before-replace-after-content/theme.html
A src/diazo/tests/v1-before-theme-children/content.html
A src/diazo/tests/v1-before-theme-children/output.html
A src/diazo/tests/v1-before-theme-children/rules.xml
A src/diazo/tests/v1-before-theme-children/theme.html
A src/diazo/tests/v1-before/content.html
A src/diazo/tests/v1-before/output.html
A src/diazo/tests/v1-before/rules.xml
A src/diazo/tests/v1-before/theme.html
A src/diazo/tests/v1-copy-all-attributes-conditional-1/content.html
A src/diazo/tests/v1-copy-all-attributes-conditional-1/output.html
A src/diazo/tests/v1-copy-all-attributes-conditional-1/rules.xml
A src/diazo/tests/v1-copy-all-attributes-conditional-1/theme.html
A src/diazo/tests/v1-copy-all-attributes-conditional-2/content.html
A src/diazo/tests/v1-copy-all-attributes-conditional-2/output.html
A src/diazo/tests/v1-copy-all-attributes-conditional-2/rules.xml
A src/diazo/tests/v1-copy-all-attributes-conditional-2/theme.html
A src/diazo/tests/v1-copy-all-attributes-conditional-3/content.html
A src/diazo/tests/v1-copy-all-attributes-conditional-3/output.html
A src/diazo/tests/v1-copy-all-attributes-conditional-3/rules.xml
A src/diazo/tests/v1-copy-all-attributes-conditional-3/theme.html
A src/diazo/tests/v1-copy-all-attributes-href/content.html
A src/diazo/tests/v1-copy-all-attributes-href/include.html
A src/diazo/tests/v1-copy-all-attributes-href/output.html
A src/diazo/tests/v1-copy-all-attributes-href/rules.xml
A src/diazo/tests/v1-copy-all-attributes-href/theme.html
A src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/content.html
A src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/output.html
A src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/rules.xml
A src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/theme.html
A src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/content.html
A src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/output.html
A src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/rules.xml
A src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/theme.html
A src/diazo/tests/v1-copy-all-attributes/content.html
A src/diazo/tests/v1-copy-all-attributes/output.html
A src/diazo/tests/v1-copy-all-attributes/rules.xml
A src/diazo/tests/v1-copy-all-attributes/theme.html
A src/diazo/tests/v1-copy-attribute-exists/content.html
A src/diazo/tests/v1-copy-attribute-exists/output.html
A src/diazo/tests/v1-copy-attribute-exists/rules.xml
A src/diazo/tests/v1-copy-attribute-exists/theme.html
A src/diazo/tests/v1-copy-attribute-not-exists/content.html
A src/diazo/tests/v1-copy-attribute-not-exists/output.html
A src/diazo/tests/v1-copy-attribute-not-exists/rules.xml
A src/diazo/tests/v1-copy-attribute-not-exists/theme.html
A src/diazo/tests/v1-copy-multi-attribute/content.html
A src/diazo/tests/v1-copy-multi-attribute/output.html
A src/diazo/tests/v1-copy-multi-attribute/rules.xml
A src/diazo/tests/v1-copy-multi-attribute/theme.html
A src/diazo/tests/v1-drop-all-attributes-content/content.html
A src/diazo/tests/v1-drop-all-attributes-content/output.html
A src/diazo/tests/v1-drop-all-attributes-content/rules.xml
A src/diazo/tests/v1-drop-all-attributes-content/theme.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/content.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/output.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/rules.xml
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/theme.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/content.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/output.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/rules.xml
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/theme.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/content.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/output.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/rules.xml
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/theme.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/content.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/output.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/rules.xml
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/theme.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/content.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/output.html
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/rules.xml
A src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/theme.html
A src/diazo/tests/v1-drop-all-attributes-theme/content.html
A src/diazo/tests/v1-drop-all-attributes-theme/output.html
A src/diazo/tests/v1-drop-all-attributes-theme/rules.xml
A src/diazo/tests/v1-drop-all-attributes-theme/theme.html
A src/diazo/tests/v1-drop-and-replace-messages/content.html
A src/diazo/tests/v1-drop-and-replace-messages/output.html
A src/diazo/tests/v1-drop-and-replace-messages/rules.xml
A src/diazo/tests/v1-drop-and-replace-messages/theme.html
A src/diazo/tests/v1-drop-and-replace-portlets/content.html
A src/diazo/tests/v1-drop-and-replace-portlets/output.html
A src/diazo/tests/v1-drop-and-replace-portlets/rules.xml
A src/diazo/tests/v1-drop-and-replace-portlets/theme.html
A src/diazo/tests/v1-drop-attribute-content/content.html
A src/diazo/tests/v1-drop-attribute-content/output.html
A src/diazo/tests/v1-drop-attribute-content/rules.xml
A src/diazo/tests/v1-drop-attribute-content/theme.html
A src/diazo/tests/v1-drop-attribute-theme-conditional-1/content.html
A src/diazo/tests/v1-drop-attribute-theme-conditional-1/output.html
A src/diazo/tests/v1-drop-attribute-theme-conditional-1/rules.xml
A src/diazo/tests/v1-drop-attribute-theme-conditional-1/theme.html
A src/diazo/tests/v1-drop-attribute-theme-conditional-2/content.html
A src/diazo/tests/v1-drop-attribute-theme-conditional-2/output.html
A src/diazo/tests/v1-drop-attribute-theme-conditional-2/rules.xml
A src/diazo/tests/v1-drop-attribute-theme-conditional-2/theme.html
A src/diazo/tests/v1-drop-attribute-theme/content.html
A src/diazo/tests/v1-drop-attribute-theme/output.html
A src/diazo/tests/v1-drop-attribute-theme/rules.xml
A src/diazo/tests/v1-drop-attribute-theme/theme.html
A src/diazo/tests/v1-drop-multi-attributes-content/content.html
A src/diazo/tests/v1-drop-multi-attributes-content/output.html
A src/diazo/tests/v1-drop-multi-attributes-content/rules.xml
A src/diazo/tests/v1-drop-multi-attributes-content/theme.html
A src/diazo/tests/v1-drop-multi-attributes-theme/content.html
A src/diazo/tests/v1-drop-multi-attributes-theme/output.html
A src/diazo/tests/v1-drop-multi-attributes-theme/rules.xml
A src/diazo/tests/v1-drop-multi-attributes-theme/theme.html
A src/diazo/tests/v1-if-content/content.html
A src/diazo/tests/v1-if-content/output.html
A src/diazo/tests/v1-if-content/rules.xml
A src/diazo/tests/v1-if-content/theme.html
A src/diazo/tests/v1-if-custom-param/content.html
A src/diazo/tests/v1-if-custom-param/options.cfg
A src/diazo/tests/v1-if-custom-param/output.html
A src/diazo/tests/v1-if-custom-param/rules.xml
A src/diazo/tests/v1-if-custom-param/theme.html
A src/diazo/tests/v1-if-merge/content.html
A src/diazo/tests/v1-if-merge/output.html
A src/diazo/tests/v1-if-merge/rules.xml
A src/diazo/tests/v1-if-merge/theme.html
A src/diazo/tests/v1-if-not-content/content.html
A src/diazo/tests/v1-if-not-content/output.html
A src/diazo/tests/v1-if-not-content/rules.xml
A src/diazo/tests/v1-if-not-content/theme.html
A src/diazo/tests/v1-if-not-path/content.html
A src/diazo/tests/v1-if-not-path/options.cfg
A src/diazo/tests/v1-if-not-path/output.html
A src/diazo/tests/v1-if-not-path/rules.xml
A src/diazo/tests/v1-if-not-path/theme.html
A src/diazo/tests/v1-if-not/content.html
A src/diazo/tests/v1-if-not/output.html
A src/diazo/tests/v1-if-not/rules.xml
A src/diazo/tests/v1-if-not/theme.html
A src/diazo/tests/v1-if-path/content.html
A src/diazo/tests/v1-if-path/options.cfg
A src/diazo/tests/v1-if-path/output.html
A src/diazo/tests/v1-if-path/rules.xml
A src/diazo/tests/v1-if-path/theme.html
A src/diazo/tests/v1-if/content.html
A src/diazo/tests/v1-if/output.html
A src/diazo/tests/v1-if/rules.xml
A src/diazo/tests/v1-if/theme.html
A src/diazo/tests/v1-merge-multiple-if-true/content.html
A src/diazo/tests/v1-merge-multiple-if-true/output.html
A src/diazo/tests/v1-merge-multiple-if-true/rules.xml
A src/diazo/tests/v1-merge-multiple-if-true/theme.html
A src/diazo/tests/v1-merge-multiple/content.html
A src/diazo/tests/v1-merge-multiple/output.html
A src/diazo/tests/v1-merge-multiple/rules.xml
A src/diazo/tests/v1-merge-multiple/theme.html
A src/diazo/tests/v1-merge-separator/content.html
A src/diazo/tests/v1-merge-separator/output.html
A src/diazo/tests/v1-merge-separator/rules.xml
A src/diazo/tests/v1-merge-separator/theme.html
A src/diazo/tests/v1-merge/content.html
A src/diazo/tests/v1-merge/output.html
A src/diazo/tests/v1-merge/rules.xml
A src/diazo/tests/v1-merge/theme.html
A src/diazo/tests/v1-notheme-if-content/content.html
A src/diazo/tests/v1-notheme-if-content/output.html
A src/diazo/tests/v1-notheme-if-content/rules.xml
A src/diazo/tests/v1-notheme-if-content/theme.html
A src/diazo/tests/v1-notheme-if-merge/content.html
A src/diazo/tests/v1-notheme-if-merge/output.html
A src/diazo/tests/v1-notheme-if-merge/rules.xml
A src/diazo/tests/v1-notheme-if-merge/theme.html
A src/diazo/tests/v1-notheme-if-path/content.html
A src/diazo/tests/v1-notheme-if-path/options.cfg
A src/diazo/tests/v1-notheme-if-path/output.html
A src/diazo/tests/v1-notheme-if-path/rules.xml
A src/diazo/tests/v1-notheme-if-path/theme.html
A src/diazo/tests/v1-notheme-if/content.html
A src/diazo/tests/v1-notheme-if/output.html
A src/diazo/tests/v1-notheme-if/rules.xml
A src/diazo/tests/v1-notheme-if/theme.html
A src/diazo/tests/v1-notheme-nomatch/content.html
A src/diazo/tests/v1-notheme-nomatch/output.html
A src/diazo/tests/v1-notheme-nomatch/rules.xml
A src/diazo/tests/v1-notheme-nomatch/theme.html
A src/diazo/tests/v1-notheme-theme-precedence/content.html
A src/diazo/tests/v1-notheme-theme-precedence/options.cfg
A src/diazo/tests/v1-notheme-theme-precedence/output.html
A src/diazo/tests/v1-notheme-theme-precedence/rules.xml
A src/diazo/tests/v1-notheme-theme-precedence/theme.html
A src/diazo/tests/v1-replace-both-children/content.html
A src/diazo/tests/v1-replace-both-children/output.html
A src/diazo/tests/v1-replace-both-children/rules.xml
A src/diazo/tests/v1-replace-both-children/theme.html
A src/diazo/tests/v1-replace-content-children/content.html
A src/diazo/tests/v1-replace-content-children/output.html
A src/diazo/tests/v1-replace-content-children/rules.xml
A src/diazo/tests/v1-replace-content-children/theme.html
A src/diazo/tests/v1-replace-content-conditional-1/content.html
A src/diazo/tests/v1-replace-content-conditional-1/output.html
A src/diazo/tests/v1-replace-content-conditional-1/rules.xml
A src/diazo/tests/v1-replace-content-conditional-1/theme.html
A src/diazo/tests/v1-replace-content-conditional-2/content.html
A src/diazo/tests/v1-replace-content-conditional-2/output.html
A src/diazo/tests/v1-replace-content-conditional-2/rules.xml
A src/diazo/tests/v1-replace-content-conditional-2/theme.html
A src/diazo/tests/v1-replace-content-content-children-conditional-1/content.html
A src/diazo/tests/v1-replace-content-content-children-conditional-1/output.html
A src/diazo/tests/v1-replace-content-content-children-conditional-1/rules.xml
A src/diazo/tests/v1-replace-content-content-children-conditional-1/theme.html
A src/diazo/tests/v1-replace-content-content-children-conditional-2/content.html
A src/diazo/tests/v1-replace-content-content-children-conditional-2/output.html
A src/diazo/tests/v1-replace-content-content-children-conditional-2/rules.xml
A src/diazo/tests/v1-replace-content-content-children-conditional-2/theme.html
A src/diazo/tests/v1-replace-content-content-children/content.html
A src/diazo/tests/v1-replace-content-content-children/output.html
A src/diazo/tests/v1-replace-content-content-children/rules.xml
A src/diazo/tests/v1-replace-content-content-children/theme.html
A src/diazo/tests/v1-replace-content/content.html
A src/diazo/tests/v1-replace-content/output.html
A src/diazo/tests/v1-replace-content/rules.xml
A src/diazo/tests/v1-replace-content/theme.html
A src/diazo/tests/v1-replace-theme-children/content.html
A src/diazo/tests/v1-replace-theme-children/output.html
A src/diazo/tests/v1-replace-theme-children/rules.xml
A src/diazo/tests/v1-replace-theme-children/theme.html
A src/diazo/tests/v1-replace/content.html
A src/diazo/tests/v1-replace/output.html
A src/diazo/tests/v1-replace/rules.xml
A src/diazo/tests/v1-replace/theme.html
A src/diazo/tests/v1-strip-content/content.html
A src/diazo/tests/v1-strip-content/output.html
A src/diazo/tests/v1-strip-content/rules.xml
A src/diazo/tests/v1-strip-content/theme.html
A src/diazo/tests/v1-strip-if-content/content.html
A src/diazo/tests/v1-strip-if-content/output.html
A src/diazo/tests/v1-strip-if-content/rules.xml
A src/diazo/tests/v1-strip-if-content/theme.html
A src/diazo/tests/v1-strip-if-theme/content.html
A src/diazo/tests/v1-strip-if-theme/output.html
A src/diazo/tests/v1-strip-if-theme/rules.xml
A src/diazo/tests/v1-strip-if-theme/theme.html
A src/diazo/tests/v1-strip-theme/content.html
A src/diazo/tests/v1-strip-theme/output.html
A src/diazo/tests/v1-strip-theme/rules.xml
A src/diazo/tests/v1-strip-theme/theme.html
A src/diazo/tests/without-theme/content.html
A src/diazo/tests/without-theme/options.cfg
A src/diazo/tests/without-theme/output.html
A src/diazo/tests/without-theme/rules.xml
A src/diazo/tests/xinclude/content.html
A src/diazo/tests/xinclude/included-rules.xml
A src/diazo/tests/xinclude/output.html
A src/diazo/tests/xinclude/rules.xml
A src/diazo/tests/xinclude/theme.html
A src/diazo/update-namespace.xsl
A src/diazo/utils.py
A src/diazo/wsgi.py
M .gitignore
M MANIFEST.in
M docs/advanced.rst
M docs/conf.py
M docs/deployment.rst
M docs/introduction.rst
M pyproject.toml
M setup.cfg
M setup.py
M tox.ini
D .github/workflows/test.yml
D bootstrap.py
D buildout.cfg
D checkdocs.cfg
D constraints.txt
D lib/diazo/__init__.py
D lib/diazo/annotate-rules.xsl
D lib/diazo/annotate-themes.xsl
D lib/diazo/apply-conditions.xsl
D lib/diazo/apply-rules.xsl
D lib/diazo/compiler.py
D lib/diazo/cssrules.py
D lib/diazo/debug_resources/diazo-debug.css
D lib/diazo/debug_resources/diazo-debug.js
D lib/diazo/debug_resources/iframe.js
D lib/diazo/debug_resources/jquery-1.8.3.min.js
D lib/diazo/defaults.xsl
D lib/diazo/diazo-debug.zcml
D lib/diazo/dummy.html
D lib/diazo/emit-stylesheet.xsl
D lib/diazo/filter.xsl
D lib/diazo/filter_html.xsl
D lib/diazo/filter_xhtml.xsl
D lib/diazo/fixup-themes.xsl
D lib/diazo/identity.xsl
D lib/diazo/include.xsl
D lib/diazo/merge-conditions.xsl
D lib/diazo/normalize-rules.xsl
D lib/diazo/rules.py
D lib/diazo/run.py
D lib/diazo/runtrace.py
D lib/diazo/runtrace_to_html.xsl
D lib/diazo/tests/__init__.py
D lib/diazo/tests/absolute-prefix-disabled/content.html
D lib/diazo/tests/absolute-prefix-disabled/options.cfg
D lib/diazo/tests/absolute-prefix-disabled/output.html
D lib/diazo/tests/absolute-prefix-disabled/rules.xml
D lib/diazo/tests/absolute-prefix-disabled/theme.html
D lib/diazo/tests/absolute-prefix-ie-conditional-comments/content.html
D lib/diazo/tests/absolute-prefix-ie-conditional-comments/options.cfg
D lib/diazo/tests/absolute-prefix-ie-conditional-comments/output.html
D lib/diazo/tests/absolute-prefix-ie-conditional-comments/rules.xml
D lib/diazo/tests/absolute-prefix-ie-conditional-comments/theme.html
D lib/diazo/tests/absolute-prefix/content.html
D lib/diazo/tests/absolute-prefix/options.cfg
D lib/diazo/tests/absolute-prefix/output.html
D lib/diazo/tests/absolute-prefix/rules.xml
D lib/diazo/tests/absolute-prefix/theme.html
D lib/diazo/tests/allow-curly-brackets/README.rst
D lib/diazo/tests/allow-curly-brackets/content.html
D lib/diazo/tests/allow-curly-brackets/output.html
D lib/diazo/tests/allow-curly-brackets/rules.xml
D lib/diazo/tests/allow-curly-brackets/theme.html
D lib/diazo/tests/append/content.html
D lib/diazo/tests/append/output.html
D lib/diazo/tests/append/rules.xml
D lib/diazo/tests/append/theme.html
D lib/diazo/tests/append/xpaths.txt
D lib/diazo/tests/before-content-conditional/content.html
D lib/diazo/tests/before-content-conditional/output.html
D lib/diazo/tests/before-content-conditional/rules.xml
D lib/diazo/tests/before-content-conditional/theme.html
D lib/diazo/tests/before-prepend-append-after/content.html
D lib/diazo/tests/before-prepend-append-after/output.html
D lib/diazo/tests/before-prepend-append-after/rules.xml
D lib/diazo/tests/before-prepend-append-after/theme.html
D lib/diazo/tests/comments-outside-root-tag/content.html
D lib/diazo/tests/comments-outside-root-tag/output.html
D lib/diazo/tests/comments-outside-root-tag/rules.xml
D lib/diazo/tests/comments-outside-root-tag/theme.html
D lib/diazo/tests/comments/content.html
D lib/diazo/tests/comments/output.html
D lib/diazo/tests/comments/rules.xml
D lib/diazo/tests/comments/theme.html
D lib/diazo/tests/comments/xpaths.txt
D lib/diazo/tests/conditional-content-rules-with-variable/content.html
D lib/diazo/tests/conditional-content-rules-with-variable/output.html
D lib/diazo/tests/conditional-content-rules-with-variable/rules.xml
D lib/diazo/tests/conditional-content-rules-with-variable/theme.html
D lib/diazo/tests/conditional-drop-in-append-1/content.html
D lib/diazo/tests/conditional-drop-in-append-1/output.html
D lib/diazo/tests/conditional-drop-in-append-1/rules.xml
D lib/diazo/tests/conditional-drop-in-append-1/theme.html
D lib/diazo/tests/conditional-drop-in-append-2/content.html
D lib/diazo/tests/conditional-drop-in-append-2/output.html
D lib/diazo/tests/conditional-drop-in-append-2/rules.xml
D lib/diazo/tests/conditional-drop-in-append-2/theme.html
D lib/diazo/tests/conditional-include-content/content.html
D lib/diazo/tests/conditional-include-content/output.html
D lib/diazo/tests/conditional-include-content/rules.xml
D lib/diazo/tests/conditional-include-content/theme.html
D lib/diazo/tests/conditional-rules-1/content.html
D lib/diazo/tests/conditional-rules-1/output.html
D lib/diazo/tests/conditional-rules-1/rules.xml
D lib/diazo/tests/conditional-rules-1/theme.html
D lib/diazo/tests/conditional-rules-1/xpaths.txt
D lib/diazo/tests/conditional-rules-2/content.html
D lib/diazo/tests/conditional-rules-2/output.html
D lib/diazo/tests/conditional-rules-2/rules.xml
D lib/diazo/tests/conditional-rules-2/theme.html
D lib/diazo/tests/conditional-rules-2/xpaths.txt
D lib/diazo/tests/copy-xsl/content.html
D lib/diazo/tests/copy-xsl/output.html
D lib/diazo/tests/copy-xsl/rules.xml
D lib/diazo/tests/copy-xsl/theme.html
D lib/diazo/tests/copy/README.rst
D lib/diazo/tests/copy/content.html
D lib/diazo/tests/copy/output.html
D lib/diazo/tests/copy/rules.xml
D lib/diazo/tests/copy/theme.html
D lib/diazo/tests/copy/xpaths.txt
D lib/diazo/tests/css-prefix/content.html
D lib/diazo/tests/css-prefix/output.html
D lib/diazo/tests/css-prefix/rules.xml
D lib/diazo/tests/css-prefix/theme.html
D lib/diazo/tests/css-xpath-child-selectors/content.html
D lib/diazo/tests/css-xpath-child-selectors/output.html
D lib/diazo/tests/css-xpath-child-selectors/rules.xml
D lib/diazo/tests/css-xpath-child-selectors/theme.html
D lib/diazo/tests/css-xsl-template/content.html
D lib/diazo/tests/css-xsl-template/output.html
D lib/diazo/tests/css-xsl-template/rules.xml
D lib/diazo/tests/css-xsl-template/theme.html
D lib/diazo/tests/default-options.cfg
D lib/diazo/tests/document-includes/content.html
D lib/diazo/tests/document-includes/extra.html
D lib/diazo/tests/document-includes/output.html
D lib/diazo/tests/document-includes/rules.xml
D lib/diazo/tests/document-includes/theme.html
D lib/diazo/tests/document-includes/xpaths.txt
D lib/diazo/tests/drop-content-comment/content.html
D lib/diazo/tests/drop-content-comment/output.html
D lib/diazo/tests/drop-content-comment/rules.xml
D lib/diazo/tests/drop-content-comment/theme.html
D lib/diazo/tests/drop-content/content.html
D lib/diazo/tests/drop-content/output.html
D lib/diazo/tests/drop-content/rules.xml
D lib/diazo/tests/drop-content/theme.html
D lib/diazo/tests/drop-content/xpaths.txt
D lib/diazo/tests/drop-replace/content.html
D lib/diazo/tests/drop-replace/output.html
D lib/diazo/tests/drop-replace/rules.xml
D lib/diazo/tests/drop-replace/theme.html
D lib/diazo/tests/drop-theme-children/content.html
D lib/diazo/tests/drop-theme-children/output.html
D lib/diazo/tests/drop-theme-children/rules.xml
D lib/diazo/tests/drop-theme-children/theme.html
D lib/diazo/tests/drop-theme-comment/content.html
D lib/diazo/tests/drop-theme-comment/output.html
D lib/diazo/tests/drop-theme-comment/rules.xml
D lib/diazo/tests/drop-theme-comment/theme.html
D lib/diazo/tests/empty-xmlns/README.txt
D lib/diazo/tests/empty-xmlns/content.html
D lib/diazo/tests/empty-xmlns/output.html
D lib/diazo/tests/empty-xmlns/rules.xml
D lib/diazo/tests/empty-xmlns/theme.html
D lib/diazo/tests/entities/content.html
D lib/diazo/tests/entities/output.html
D lib/diazo/tests/entities/rules.xml
D lib/diazo/tests/entities/theme.html
D lib/diazo/tests/esi/content.html
D lib/diazo/tests/esi/output.html
D lib/diazo/tests/esi/rules.xml
D lib/diazo/tests/esi/theme.html
D lib/diazo/tests/esi/xpaths.txt
D lib/diazo/tests/html-attributes/content.html
D lib/diazo/tests/html-attributes/output.html
D lib/diazo/tests/html-attributes/rules.xml
D lib/diazo/tests/html-attributes/theme.html
D lib/diazo/tests/html-xml-lang-2/content.html
D lib/diazo/tests/html-xml-lang-2/output.html
D lib/diazo/tests/html-xml-lang-2/rules.xml
D lib/diazo/tests/html-xml-lang-2/theme.html
D lib/diazo/tests/html-xml-lang-3/content.html
D lib/diazo/tests/html-xml-lang-3/output.html
D lib/diazo/tests/html-xml-lang-3/rules.xml
D lib/diazo/tests/html-xml-lang-3/theme.html
D lib/diazo/tests/html-xml-lang/content.html
D lib/diazo/tests/html-xml-lang/output.html
D lib/diazo/tests/html-xml-lang/rules.xml
D lib/diazo/tests/html-xml-lang/theme.html
D lib/diazo/tests/if-path-1/content.html
D lib/diazo/tests/if-path-1/options.cfg
D lib/diazo/tests/if-path-1/output.html
D lib/diazo/tests/if-path-1/rules.xml
D lib/diazo/tests/if-path-1/theme.html
D lib/diazo/tests/if-path-2/content.html
D lib/diazo/tests/if-path-2/options.cfg
D lib/diazo/tests/if-path-2/output.html
D lib/diazo/tests/if-path-2/rules.xml
D lib/diazo/tests/if-path-2/theme.html
D lib/diazo/tests/if-path-3/content.html
D lib/diazo/tests/if-path-3/options.cfg
D lib/diazo/tests/if-path-3/output.html
D lib/diazo/tests/if-path-3/rules.xml
D lib/diazo/tests/if-path-3/theme.html
D lib/diazo/tests/if-path-4/content.html
D lib/diazo/tests/if-path-4/options.cfg
D lib/diazo/tests/if-path-4/output.html
D lib/diazo/tests/if-path-4/rules.xml
D lib/diazo/tests/if-path-4/theme.html
D lib/diazo/tests/if-path-5/content.html
D lib/diazo/tests/if-path-5/options.cfg
D lib/diazo/tests/if-path-5/output.html
D lib/diazo/tests/if-path-5/rules.xml
D lib/diazo/tests/if-path-5/theme.html
D lib/diazo/tests/if-path-6/content.html
D lib/diazo/tests/if-path-6/options.cfg
D lib/diazo/tests/if-path-6/output.html
D lib/diazo/tests/if-path-6/rules.xml
D lib/diazo/tests/if-path-6/theme.html
D lib/diazo/tests/if-path-7/content.html
D lib/diazo/tests/if-path-7/options.cfg
D lib/diazo/tests/if-path-7/output.html
D lib/diazo/tests/if-path-7/rules.xml
D lib/diazo/tests/if-path-7/theme.html
D lib/diazo/tests/if-path-8/content.html
D lib/diazo/tests/if-path-8/options.cfg
D lib/diazo/tests/if-path-8/output.html
D lib/diazo/tests/if-path-8/rules.xml
D lib/diazo/tests/if-path-8/theme.html
D lib/diazo/tests/include-content/content.html
D lib/diazo/tests/include-content/extra.html
D lib/diazo/tests/include-content/output.html
D lib/diazo/tests/include-content/rules.xml
D lib/diazo/tests/include-content/theme.html
D lib/diazo/tests/indent-off/content.html
D lib/diazo/tests/indent-off/options.cfg
D lib/diazo/tests/indent-off/output.html
D lib/diazo/tests/indent-off/rules.xml
D lib/diazo/tests/indent-off/theme.html
D lib/diazo/tests/inline-xsl-apply-templates/content.html
D lib/diazo/tests/inline-xsl-apply-templates/output.html
D lib/diazo/tests/inline-xsl-apply-templates/rules.xml
D lib/diazo/tests/inline-xsl-apply-templates/theme.html
D lib/diazo/tests/inline-xsl-directives/content.html
D lib/diazo/tests/inline-xsl-directives/output.html
D lib/diazo/tests/inline-xsl-directives/rules.xml
D lib/diazo/tests/inline-xsl-directives/theme.html
D lib/diazo/tests/modify-theme/content.html
D lib/diazo/tests/modify-theme/output.html
D lib/diazo/tests/modify-theme/rules.xml
D lib/diazo/tests/modify-theme/theme.html
D lib/diazo/tests/modify-theme/xpaths.txt
D lib/diazo/tests/multi-copy-1/content.html
D lib/diazo/tests/multi-copy-1/rules.xml
D lib/diazo/tests/multi-copy-1/theme.html
D lib/diazo/tests/multi-copy-1/xpaths.txt
D lib/diazo/tests/multi-copy-2/content.html
D lib/diazo/tests/multi-copy-2/rules.xml
D lib/diazo/tests/multi-copy-2/theme.html
D lib/diazo/tests/multi-copy-2/xpaths.txt
D lib/diazo/tests/multi-copy-3/content.html
D lib/diazo/tests/multi-copy-3/rules.xml
D lib/diazo/tests/multi-copy-3/theme.html
D lib/diazo/tests/multi-copy-3/xpaths.txt
D lib/diazo/tests/multi-copy-4/content.html
D lib/diazo/tests/multi-copy-4/rules.xml
D lib/diazo/tests/multi-copy-4/theme.html
D lib/diazo/tests/multi-copy-4/xpaths.txt
D lib/diazo/tests/multi-replace-1/content.html
D lib/diazo/tests/multi-replace-1/rules.xml
D lib/diazo/tests/multi-replace-1/theme.html
D lib/diazo/tests/multi-replace-1/xpaths.txt
D lib/diazo/tests/multi-replace-2/content.html
D lib/diazo/tests/multi-replace-2/rules.xml
D lib/diazo/tests/multi-replace-2/theme.html
D lib/diazo/tests/multi-replace-2/xpaths.txt
D lib/diazo/tests/multi-replace-3/content.html
D lib/diazo/tests/multi-replace-3/rules.xml
D lib/diazo/tests/multi-replace-3/theme.html
D lib/diazo/tests/multi-replace-3/xpaths.txt
D lib/diazo/tests/multi-replace-4/content.html
D lib/diazo/tests/multi-replace-4/rules.xml
D lib/diazo/tests/multi-replace-4/theme.html
D lib/diazo/tests/multi-replace-4/xpaths.txt
D lib/diazo/tests/multi-theme-1/content.html
D lib/diazo/tests/multi-theme-1/options.cfg
D lib/diazo/tests/multi-theme-1/output.html
D lib/diazo/tests/multi-theme-1/rules.xml
D lib/diazo/tests/multi-theme-1/theme1.html
D lib/diazo/tests/multi-theme-1/theme2.html
D lib/diazo/tests/multi-theme-2/content.html
D lib/diazo/tests/multi-theme-2/options.cfg
D lib/diazo/tests/multi-theme-2/output.html
D lib/diazo/tests/multi-theme-2/rules.xml
D lib/diazo/tests/multi-theme-2/theme1.html
D lib/diazo/tests/multi-theme-2/theme2.html
D lib/diazo/tests/multi-theme-3/content.html
D lib/diazo/tests/multi-theme-3/options.cfg
D lib/diazo/tests/multi-theme-3/output.html
D lib/diazo/tests/multi-theme-3/rules.xml
D lib/diazo/tests/multi-theme-3/theme1.html
D lib/diazo/tests/multi-theme-3/theme2.html
D lib/diazo/tests/multi-theme-4/content.html
D lib/diazo/tests/multi-theme-4/options.cfg
D lib/diazo/tests/multi-theme-4/output.html
D lib/diazo/tests/multi-theme-4/rules.xml
D lib/diazo/tests/multi-theme-4/theme1.html
D lib/diazo/tests/multi-theme-4/theme2.html
D lib/diazo/tests/multi-theme-5/content.html
D lib/diazo/tests/multi-theme-5/options.cfg
D lib/diazo/tests/multi-theme-5/output.html
D lib/diazo/tests/multi-theme-5/rules.xml
D lib/diazo/tests/multi-theme-5/theme1.html
D lib/diazo/tests/multi-theme-5/theme2.html
D lib/diazo/tests/multi-theme-variable-1/content.html
D lib/diazo/tests/multi-theme-variable-1/options.cfg
D lib/diazo/tests/multi-theme-variable-1/output.html
D lib/diazo/tests/multi-theme-variable-1/rules.xml
D lib/diazo/tests/multi-theme-variable-1/theme1.html
D lib/diazo/tests/multi-theme-variable-1/theme2.html
D lib/diazo/tests/nested-conditions-1/content.html
D lib/diazo/tests/nested-conditions-1/output.html
D lib/diazo/tests/nested-conditions-1/rules.xml
D lib/diazo/tests/nested-conditions-1/theme.html
D lib/diazo/tests/nested-conditions-2/content.html
D lib/diazo/tests/nested-conditions-2/output.html
D lib/diazo/tests/nested-conditions-2/rules.xml
D lib/diazo/tests/nested-conditions-2/theme.html
D lib/diazo/tests/nested-conditions-3/content.html
D lib/diazo/tests/nested-conditions-3/output.html
D lib/diazo/tests/nested-conditions-3/rules.xml
D lib/diazo/tests/nested-conditions-3/theme.html
D lib/diazo/tests/nested-rules-for-xinclude/content.html
D lib/diazo/tests/nested-rules-for-xinclude/output.html
D lib/diazo/tests/nested-rules-for-xinclude/rules.xml
D lib/diazo/tests/nested-rules-for-xinclude/theme.html
D lib/diazo/tests/notheme-xmlns/content.html
D lib/diazo/tests/notheme-xmlns/output.html
D lib/diazo/tests/notheme-xmlns/rules.xml
D lib/diazo/tests/notheme-xmlns/theme.html
D lib/diazo/tests/null-if-content/content.html
D lib/diazo/tests/null-if-content/rules.xml
D lib/diazo/tests/null-if-content/theme.html
D lib/diazo/tests/null-if-content/xpaths.txt
D lib/diazo/tests/path-param-1/content.html
D lib/diazo/tests/path-param-1/options.cfg
D lib/diazo/tests/path-param-1/output.html
D lib/diazo/tests/path-param-1/rules.xml
D lib/diazo/tests/path-param-1/theme.html
D lib/diazo/tests/path-param-2/content.html
D lib/diazo/tests/path-param-2/options.cfg
D lib/diazo/tests/path-param-2/output.html
D lib/diazo/tests/path-param-2/rules.xml
D lib/diazo/tests/path-param-2/theme.html
D lib/diazo/tests/pre-line-endings/content.html
D lib/diazo/tests/pre-line-endings/extra.html
D lib/diazo/tests/pre-line-endings/output.html
D lib/diazo/tests/pre-line-endings/rules.xml
D lib/diazo/tests/pre-line-endings/theme.html
D lib/diazo/tests/prepend-append/content.html
D lib/diazo/tests/prepend-append/output.html
D lib/diazo/tests/prepend-append/rules.xml
D lib/diazo/tests/prepend-append/theme.html
D lib/diazo/tests/prepend-append/xpaths.txt
D lib/diazo/tests/prepend/content.html
D lib/diazo/tests/prepend/output.html
D lib/diazo/tests/prepend/rules.xml
D lib/diazo/tests/prepend/theme.html
D lib/diazo/tests/prepend/xpaths.txt
D lib/diazo/tests/replace-after/content.html
D lib/diazo/tests/replace-after/output.html
D lib/diazo/tests/replace-after/rules.xml
D lib/diazo/tests/replace-after/theme.html
D lib/diazo/tests/replace-after/xpaths.txt
D lib/diazo/tests/replace/README.rst
D lib/diazo/tests/replace/content.html
D lib/diazo/tests/replace/output.html
D lib/diazo/tests/replace/rules.xml
D lib/diazo/tests/replace/theme.html
D lib/diazo/tests/replace/xpaths.txt
D lib/diazo/tests/ssi/content.html
D lib/diazo/tests/ssi/output.html
D lib/diazo/tests/ssi/rules.xml
D lib/diazo/tests/ssi/theme.html
D lib/diazo/tests/ssi/xpaths.txt
D lib/diazo/tests/ssiwait/content.html
D lib/diazo/tests/ssiwait/output.html
D lib/diazo/tests/ssiwait/rules.xml
D lib/diazo/tests/ssiwait/theme.html
D lib/diazo/tests/ssiwait/xpaths.txt
D lib/diazo/tests/style-script-quoting-1/content.html
D lib/diazo/tests/style-script-quoting-1/output.html
D lib/diazo/tests/style-script-quoting-1/rules.xml
D lib/diazo/tests/style-script-quoting-1/theme.html
D lib/diazo/tests/style-script-quoting-1/xpaths.txt
D lib/diazo/tests/style-script-quoting-2/content.html
D lib/diazo/tests/style-script-quoting-2/output.html
D lib/diazo/tests/style-script-quoting-2/rules.xml
D lib/diazo/tests/style-script-quoting-2/theme.html
D lib/diazo/tests/test_diazo.py
D lib/diazo/tests/test_trace.py
D lib/diazo/tests/test_wsgi.py
D lib/diazo/tests/test_wsgi_files/custom_param.xml
D lib/diazo/tests/test_wsgi_files/esi.xml
D lib/diazo/tests/test_wsgi_files/explicit_theme.xml
D lib/diazo/tests/test_wsgi_files/path_param.xml
D lib/diazo/tests/test_wsgi_files/simple_transform.xml
D lib/diazo/tests/test_wsgi_files/subrequest.xml
D lib/diazo/tests/test_wsgi_files/theme.html
D lib/diazo/tests/update-namespace-1/content.html
D lib/diazo/tests/update-namespace-1/rules.xml
D lib/diazo/tests/update-namespace-1/theme.html
D lib/diazo/tests/update-namespace-1/xpaths.txt
D lib/diazo/tests/update-namespace-2/content.html
D lib/diazo/tests/update-namespace-2/output.html
D lib/diazo/tests/update-namespace-2/rules.xml
D lib/diazo/tests/update-namespace-2/theme.html
D lib/diazo/tests/update-namespace-3/content.html
D lib/diazo/tests/update-namespace-3/output.html
D lib/diazo/tests/update-namespace-3/rules.xml
D lib/diazo/tests/update-namespace-3/theme.html
D lib/diazo/tests/v1-after-both-children/content.html
D lib/diazo/tests/v1-after-both-children/output.html
D lib/diazo/tests/v1-after-both-children/rules.xml
D lib/diazo/tests/v1-after-both-children/theme.html
D lib/diazo/tests/v1-after-content-children/content.html
D lib/diazo/tests/v1-after-content-children/output.html
D lib/diazo/tests/v1-after-content-children/rules.xml
D lib/diazo/tests/v1-after-content-children/theme.html
D lib/diazo/tests/v1-after-theme-children/content.html
D lib/diazo/tests/v1-after-theme-children/output.html
D lib/diazo/tests/v1-after-theme-children/rules.xml
D lib/diazo/tests/v1-after-theme-children/theme.html
D lib/diazo/tests/v1-after/content.html
D lib/diazo/tests/v1-after/output.html
D lib/diazo/tests/v1-after/rules.xml
D lib/diazo/tests/v1-after/theme.html
D lib/diazo/tests/v1-before-both-children/content.html
D lib/diazo/tests/v1-before-both-children/output.html
D lib/diazo/tests/v1-before-both-children/rules.xml
D lib/diazo/tests/v1-before-both-children/theme.html
D lib/diazo/tests/v1-before-content-children/content.html
D lib/diazo/tests/v1-before-content-children/output.html
D lib/diazo/tests/v1-before-content-children/rules.xml
D lib/diazo/tests/v1-before-content-children/theme.html
D lib/diazo/tests/v1-before-content-content-children/content.html
D lib/diazo/tests/v1-before-content-content-children/output.html
D lib/diazo/tests/v1-before-content-content-children/rules.xml
D lib/diazo/tests/v1-before-content-content-children/theme.html
D lib/diazo/tests/v1-before-replace-after-content/content.html
D lib/diazo/tests/v1-before-replace-after-content/output.html
D lib/diazo/tests/v1-before-replace-after-content/rules.xml
D lib/diazo/tests/v1-before-replace-after-content/theme.html
D lib/diazo/tests/v1-before-theme-children/content.html
D lib/diazo/tests/v1-before-theme-children/output.html
D lib/diazo/tests/v1-before-theme-children/rules.xml
D lib/diazo/tests/v1-before-theme-children/theme.html
D lib/diazo/tests/v1-before/content.html
D lib/diazo/tests/v1-before/output.html
D lib/diazo/tests/v1-before/rules.xml
D lib/diazo/tests/v1-before/theme.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-1/content.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-1/output.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-1/rules.xml
D lib/diazo/tests/v1-copy-all-attributes-conditional-1/theme.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-2/content.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-2/output.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-2/rules.xml
D lib/diazo/tests/v1-copy-all-attributes-conditional-2/theme.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-3/content.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-3/output.html
D lib/diazo/tests/v1-copy-all-attributes-conditional-3/rules.xml
D lib/diazo/tests/v1-copy-all-attributes-conditional-3/theme.html
D lib/diazo/tests/v1-copy-all-attributes-href/content.html
D lib/diazo/tests/v1-copy-all-attributes-href/include.html
D lib/diazo/tests/v1-copy-all-attributes-href/output.html
D lib/diazo/tests/v1-copy-all-attributes-href/rules.xml
D lib/diazo/tests/v1-copy-all-attributes-href/theme.html
D lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/content.html
D lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/output.html
D lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/rules.xml
D lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/theme.html
D lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/content.html
D lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/output.html
D lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/rules.xml
D lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/theme.html
D lib/diazo/tests/v1-copy-all-attributes/content.html
D lib/diazo/tests/v1-copy-all-attributes/output.html
D lib/diazo/tests/v1-copy-all-attributes/rules.xml
D lib/diazo/tests/v1-copy-all-attributes/theme.html
D lib/diazo/tests/v1-copy-attribute-exists/content.html
D lib/diazo/tests/v1-copy-attribute-exists/output.html
D lib/diazo/tests/v1-copy-attribute-exists/rules.xml
D lib/diazo/tests/v1-copy-attribute-exists/theme.html
D lib/diazo/tests/v1-copy-attribute-not-exists/content.html
D lib/diazo/tests/v1-copy-attribute-not-exists/output.html
D lib/diazo/tests/v1-copy-attribute-not-exists/rules.xml
D lib/diazo/tests/v1-copy-attribute-not-exists/theme.html
D lib/diazo/tests/v1-copy-multi-attribute/content.html
D lib/diazo/tests/v1-copy-multi-attribute/output.html
D lib/diazo/tests/v1-copy-multi-attribute/rules.xml
D lib/diazo/tests/v1-copy-multi-attribute/theme.html
D lib/diazo/tests/v1-drop-all-attributes-content/content.html
D lib/diazo/tests/v1-drop-all-attributes-content/output.html
D lib/diazo/tests/v1-drop-all-attributes-content/rules.xml
D lib/diazo/tests/v1-drop-all-attributes-content/theme.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/content.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/output.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/rules.xml
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/theme.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/content.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/output.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/rules.xml
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/theme.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/content.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/output.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/rules.xml
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/theme.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/content.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/output.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/rules.xml
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/theme.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/content.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/output.html
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/rules.xml
D lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/theme.html
D lib/diazo/tests/v1-drop-all-attributes-theme/content.html
D lib/diazo/tests/v1-drop-all-attributes-theme/output.html
D lib/diazo/tests/v1-drop-all-attributes-theme/rules.xml
D lib/diazo/tests/v1-drop-all-attributes-theme/theme.html
D lib/diazo/tests/v1-drop-and-replace-messages/content.html
D lib/diazo/tests/v1-drop-and-replace-messages/output.html
D lib/diazo/tests/v1-drop-and-replace-messages/rules.xml
D lib/diazo/tests/v1-drop-and-replace-messages/theme.html
D lib/diazo/tests/v1-drop-and-replace-portlets/content.html
D lib/diazo/tests/v1-drop-and-replace-portlets/output.html
D lib/diazo/tests/v1-drop-and-replace-portlets/rules.xml
D lib/diazo/tests/v1-drop-and-replace-portlets/theme.html
D lib/diazo/tests/v1-drop-attribute-content/content.html
D lib/diazo/tests/v1-drop-attribute-content/output.html
D lib/diazo/tests/v1-drop-attribute-content/rules.xml
D lib/diazo/tests/v1-drop-attribute-content/theme.html
D lib/diazo/tests/v1-drop-attribute-theme-conditional-1/content.html
D lib/diazo/tests/v1-drop-attribute-theme-conditional-1/output.html
D lib/diazo/tests/v1-drop-attribute-theme-conditional-1/rules.xml
D lib/diazo/tests/v1-drop-attribute-theme-conditional-1/theme.html
D lib/diazo/tests/v1-drop-attribute-theme-conditional-2/content.html
D lib/diazo/tests/v1-drop-attribute-theme-conditional-2/output.html
D lib/diazo/tests/v1-drop-attribute-theme-conditional-2/rules.xml
D lib/diazo/tests/v1-drop-attribute-theme-conditional-2/theme.html
D lib/diazo/tests/v1-drop-attribute-theme/content.html
D lib/diazo/tests/v1-drop-attribute-theme/output.html
D lib/diazo/tests/v1-drop-attribute-theme/rules.xml
D lib/diazo/tests/v1-drop-attribute-theme/theme.html
D lib/diazo/tests/v1-drop-multi-attributes-content/content.html
D lib/diazo/tests/v1-drop-multi-attributes-content/output.html
D lib/diazo/tests/v1-drop-multi-attributes-content/rules.xml
D lib/diazo/tests/v1-drop-multi-attributes-content/theme.html
D lib/diazo/tests/v1-drop-multi-attributes-theme/content.html
D lib/diazo/tests/v1-drop-multi-attributes-theme/output.html
D lib/diazo/tests/v1-drop-multi-attributes-theme/rules.xml
D lib/diazo/tests/v1-drop-multi-attributes-theme/theme.html
D lib/diazo/tests/v1-if-content/content.html
D lib/diazo/tests/v1-if-content/output.html
D lib/diazo/tests/v1-if-content/rules.xml
D lib/diazo/tests/v1-if-content/theme.html
D lib/diazo/tests/v1-if-custom-param/content.html
D lib/diazo/tests/v1-if-custom-param/options.cfg
D lib/diazo/tests/v1-if-custom-param/output.html
D lib/diazo/tests/v1-if-custom-param/rules.xml
D lib/diazo/tests/v1-if-custom-param/theme.html
D lib/diazo/tests/v1-if-merge/content.html
D lib/diazo/tests/v1-if-merge/output.html
D lib/diazo/tests/v1-if-merge/rules.xml
D lib/diazo/tests/v1-if-merge/theme.html
D lib/diazo/tests/v1-if-not-content/content.html
D lib/diazo/tests/v1-if-not-content/output.html
D lib/diazo/tests/v1-if-not-content/rules.xml
D lib/diazo/tests/v1-if-not-content/theme.html
D lib/diazo/tests/v1-if-not-path/content.html
D lib/diazo/tests/v1-if-not-path/options.cfg
D lib/diazo/tests/v1-if-not-path/output.html
D lib/diazo/tests/v1-if-not-path/rules.xml
D lib/diazo/tests/v1-if-not-path/theme.html
D lib/diazo/tests/v1-if-not/content.html
D lib/diazo/tests/v1-if-not/output.html
D lib/diazo/tests/v1-if-not/rules.xml
D lib/diazo/tests/v1-if-not/theme.html
D lib/diazo/tests/v1-if-path/content.html
D lib/diazo/tests/v1-if-path/options.cfg
D lib/diazo/tests/v1-if-path/output.html
D lib/diazo/tests/v1-if-path/rules.xml
D lib/diazo/tests/v1-if-path/theme.html
D lib/diazo/tests/v1-if/content.html
D lib/diazo/tests/v1-if/output.html
D lib/diazo/tests/v1-if/rules.xml
D lib/diazo/tests/v1-if/theme.html
D lib/diazo/tests/v1-merge-multiple-if-true/content.html
D lib/diazo/tests/v1-merge-multiple-if-true/output.html
D lib/diazo/tests/v1-merge-multiple-if-true/rules.xml
D lib/diazo/tests/v1-merge-multiple-if-true/theme.html
D lib/diazo/tests/v1-merge-multiple/content.html
D lib/diazo/tests/v1-merge-multiple/output.html
D lib/diazo/tests/v1-merge-multiple/rules.xml
D lib/diazo/tests/v1-merge-multiple/theme.html
D lib/diazo/tests/v1-merge-separator/content.html
D lib/diazo/tests/v1-merge-separator/output.html
D lib/diazo/tests/v1-merge-separator/rules.xml
D lib/diazo/tests/v1-merge-separator/theme.html
D lib/diazo/tests/v1-merge/content.html
D lib/diazo/tests/v1-merge/output.html
D lib/diazo/tests/v1-merge/rules.xml
D lib/diazo/tests/v1-merge/theme.html
D lib/diazo/tests/v1-notheme-if-content/content.html
D lib/diazo/tests/v1-notheme-if-content/output.html
D lib/diazo/tests/v1-notheme-if-content/rules.xml
D lib/diazo/tests/v1-notheme-if-content/theme.html
D lib/diazo/tests/v1-notheme-if-merge/content.html
D lib/diazo/tests/v1-notheme-if-merge/output.html
D lib/diazo/tests/v1-notheme-if-merge/rules.xml
D lib/diazo/tests/v1-notheme-if-merge/theme.html
D lib/diazo/tests/v1-notheme-if-path/content.html
D lib/diazo/tests/v1-notheme-if-path/options.cfg
D lib/diazo/tests/v1-notheme-if-path/output.html
D lib/diazo/tests/v1-notheme-if-path/rules.xml
D lib/diazo/tests/v1-notheme-if-path/theme.html
D lib/diazo/tests/v1-notheme-if/content.html
D lib/diazo/tests/v1-notheme-if/output.html
D lib/diazo/tests/v1-notheme-if/rules.xml
D lib/diazo/tests/v1-notheme-if/theme.html
D lib/diazo/tests/v1-notheme-nomatch/content.html
D lib/diazo/tests/v1-notheme-nomatch/output.html
D lib/diazo/tests/v1-notheme-nomatch/rules.xml
D lib/diazo/tests/v1-notheme-nomatch/theme.html
D lib/diazo/tests/v1-notheme-theme-precedence/content.html
D lib/diazo/tests/v1-notheme-theme-precedence/options.cfg
D lib/diazo/tests/v1-notheme-theme-precedence/output.html
D lib/diazo/tests/v1-notheme-theme-precedence/rules.xml
D lib/diazo/tests/v1-notheme-theme-precedence/theme.html
D lib/diazo/tests/v1-replace-both-children/content.html
D lib/diazo/tests/v1-replace-both-children/output.html
D lib/diazo/tests/v1-replace-both-children/rules.xml
D lib/diazo/tests/v1-replace-both-children/theme.html
D lib/diazo/tests/v1-replace-content-children/content.html
D lib/diazo/tests/v1-replace-content-children/output.html
D lib/diazo/tests/v1-replace-content-children/rules.xml
D lib/diazo/tests/v1-replace-content-children/theme.html
D lib/diazo/tests/v1-replace-content-conditional-1/content.html
D lib/diazo/tests/v1-replace-content-conditional-1/output.html
D lib/diazo/tests/v1-replace-content-conditional-1/rules.xml
D lib/diazo/tests/v1-replace-content-conditional-1/theme.html
D lib/diazo/tests/v1-replace-content-conditional-2/content.html
D lib/diazo/tests/v1-replace-content-conditional-2/output.html
D lib/diazo/tests/v1-replace-content-conditional-2/rules.xml
D lib/diazo/tests/v1-replace-content-conditional-2/theme.html
D lib/diazo/tests/v1-replace-content-content-children-conditional-1/content.html
D lib/diazo/tests/v1-replace-content-content-children-conditional-1/output.html
D lib/diazo/tests/v1-replace-content-content-children-conditional-1/rules.xml
D lib/diazo/tests/v1-replace-content-content-children-conditional-1/theme.html
D lib/diazo/tests/v1-replace-content-content-children-conditional-2/content.html
D lib/diazo/tests/v1-replace-content-content-children-conditional-2/output.html
D lib/diazo/tests/v1-replace-content-content-children-conditional-2/rules.xml
D lib/diazo/tests/v1-replace-content-content-children-conditional-2/theme.html
D lib/diazo/tests/v1-replace-content-content-children/content.html
D lib/diazo/tests/v1-replace-content-content-children/output.html
D lib/diazo/tests/v1-replace-content-content-children/rules.xml
D lib/diazo/tests/v1-replace-content-content-children/theme.html
D lib/diazo/tests/v1-replace-content/content.html
D lib/diazo/tests/v1-replace-content/output.html
D lib/diazo/tests/v1-replace-content/rules.xml
D lib/diazo/tests/v1-replace-content/theme.html
D lib/diazo/tests/v1-replace-theme-children/content.html
D lib/diazo/tests/v1-replace-theme-children/output.html
D lib/diazo/tests/v1-replace-theme-children/rules.xml
D lib/diazo/tests/v1-replace-theme-children/theme.html
D lib/diazo/tests/v1-replace/content.html
D lib/diazo/tests/v1-replace/output.html
D lib/diazo/tests/v1-replace/rules.xml
D lib/diazo/tests/v1-replace/theme.html
D lib/diazo/tests/v1-strip-content/content.html
D lib/diazo/tests/v1-strip-content/output.html
D lib/diazo/tests/v1-strip-content/rules.xml
D lib/diazo/tests/v1-strip-content/theme.html
D lib/diazo/tests/v1-strip-if-content/content.html
D lib/diazo/tests/v1-strip-if-content/output.html
D lib/diazo/tests/v1-strip-if-content/rules.xml
D lib/diazo/tests/v1-strip-if-content/theme.html
D lib/diazo/tests/v1-strip-if-theme/content.html
D lib/diazo/tests/v1-strip-if-theme/output.html
D lib/diazo/tests/v1-strip-if-theme/rules.xml
D lib/diazo/tests/v1-strip-if-theme/theme.html
D lib/diazo/tests/v1-strip-theme/content.html
D lib/diazo/tests/v1-strip-theme/output.html
D lib/diazo/tests/v1-strip-theme/rules.xml
D lib/diazo/tests/v1-strip-theme/theme.html
D lib/diazo/tests/without-theme/content.html
D lib/diazo/tests/without-theme/options.cfg
D lib/diazo/tests/without-theme/output.html
D lib/diazo/tests/without-theme/rules.xml
D lib/diazo/tests/xinclude/content.html
D lib/diazo/tests/xinclude/included-rules.xml
D lib/diazo/tests/xinclude/output.html
D lib/diazo/tests/xinclude/rules.xml
D lib/diazo/tests/xinclude/theme.html
D lib/diazo/update-namespace.xsl
D lib/diazo/utils.py
D lib/diazo/wsgi.py
D lxml.cfg
D nginx.cfg
D templates/nginx.conf.in
D templates/varnish.vcl.in
D varnish.cfg
D versions.cfg

b'diff --git a/.editorconfig b/.editorconfig\nnew file mode 100644\nindex 0000000..fa698fb\n--- /dev/null\n+++ b/.editorconfig\n@@ -0,0 +1,54 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/main/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+#\n+# EditorConfig Configuration file, for more details see:\n+# http://EditorConfig.org\n+# EditorConfig is a convention description, that could be interpreted\n+# by multiple editors to enforce common coding conventions for specific\n+# file types\n+\n+# top-most EditorConfig file:\n+# Will ignore other EditorConfig files in Home directory or upper tree level.\n+root = true\n+\n+\n+[*]  # For All Files\n+# Unix-style newlines with a newline ending every file\n+end_of_line = lf\n+insert_final_newline = true\n+trim_trailing_whitespace = true\n+# Set default charset\n+charset = utf-8\n+# Indent style default\n+indent_style = space\n+# Max Line Length - a hard line wrap, should be disabled\n+max_line_length = off\n+\n+[*.{py,cfg,ini}]\n+# 4 space indentation\n+indent_size = 4\n+\n+[*.{yml,zpt,pt,dtml,zcml,html,xml}]\n+# 2 space indentation\n+indent_size = 2\n+\n+[*.{json,jsonl,js,jsx,ts,tsx,css,less,scss}]  # Frontend development\n+# 2 space indentation\n+indent_size = 2\n+max_line_length = 80\n+\n+[{Makefile,.gitmodules}]\n+# Tab indentation (no size specified, but view as 4 spaces)\n+indent_style = tab\n+indent_size = unset\n+tab_width = unset\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [editorconfig]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/.flake8 b/.flake8\nnew file mode 100644\nindex 0000000..38918f4\n--- /dev/null\n+++ b/.flake8\n@@ -0,0 +1,22 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/main/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+[flake8]\n+doctests = 1\n+ignore =\n+    # black takes care of line length\n+    E501,\n+    # black takes care of where to break lines\n+    W503,\n+    # black takes care of spaces within slicing (list[:])\n+    E203,\n+    # black takes care of spaces after commas\n+    E231,\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [flake8]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/.github/workflows/meta.yml b/.github/workflows/meta.yml\nnew file mode 100644\nindex 0000000..1e44406\n--- /dev/null\n+++ b/.github/workflows/meta.yml\n@@ -0,0 +1,66 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/main/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+name: Meta\n+on:\n+  push:\n+    branches:\n+      - master\n+      - main\n+  pull_request:\n+    branches:\n+      - master\n+      - main\n+  workflow_dispatch:\n+\n+##\n+# To set environment variables for all jobs, add in .meta.toml:\n+# [github]\n+# env = """\n+#     debug: 1\n+#     image-name: \'org/image\'\n+#     image-tag: \'latest\'\n+# """\n+##\n+\n+jobs:\n+  qa:\n+    uses: plone/meta/.github/workflows/qa.yml@main\n+  test:\n+    uses: plone/meta/.github/workflows/test.yml@main\n+  coverage:\n+    uses: plone/meta/.github/workflows/coverage.yml@main\n+  release_ready:\n+    uses: plone/meta/.github/workflows/release_ready.yml@main\n+  circular:\n+    uses: plone/meta/.github/workflows/circular.yml@main\n+\n+##\n+# To modify the list of default jobs being created add in .meta.toml:\n+# [github]\n+# jobs = [\n+#    "qa",\n+#    "test",\n+#    "coverage",\n+#    "dependencies",\n+#    "release_ready",\n+#    "circular",\n+#    ]\n+##\n+\n+##\n+# To request that some OS level dependencies get installed\n+# when running tests/coverage jobs, add in .meta.toml:\n+# [github]\n+# os_dependencies = "git libxml2 libxslt"\n+##\n+\n+\n+##\n+# Specify additional jobs in .meta.toml:\n+#  [github]\n+#  extra_lines = """\n+#  another:\n+#    uses: org/repo/.github/workflows/file.yml@main\n+#  """\n+##\ndiff --git a/.github/workflows/test.yml b/.github/workflows/test.yml\ndeleted file mode 100644\nindex 7d8005d..0000000\n--- a/.github/workflows/test.yml\n+++ /dev/null\n@@ -1,46 +0,0 @@\n-name: Test\n-\n-on:\n-  push:\n-    branches-ignore:\n-      - "master"\n-\n-jobs:\n-  build:\n-    runs-on: ubuntu-latest\n-    strategy:\n-      fail-fast: false\n-      matrix:\n-        python-version:\n-          - "2.7"\n-          - "3.5"\n-          - "3.6"\n-          - "3.7"\n-          - "3.8"\n-          - "3.9"\n-          - "3.10"\n-\n-    steps:\n-      - uses: actions/checkout@v2\n-\n-      - name: Setup Python ${{ matrix.python-version }}\n-        id: setup\n-        uses: actions/setup-python@v2\n-        with:\n-          python-version: ${{ matrix.python-version }}\n-\n-      - name: Install package\n-        run: |\n-          pip install -c constraints.txt tox coverage\n-\n-      - name: Run tests\n-        env:\n-          TOXENV: py${{ matrix.python-version }}\n-        run: |\n-          tox\n-\n-      - name: Run coverage\n-        env:\n-          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n-        run: |\n-          coverage combine\ndiff --git a/.gitignore b/.gitignore\nindex 282e164..486392f 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -1,20 +1,56 @@\n-bin\n-develop-eggs\n-docs/_build\n-parts/\n-build/\n-_build/\n-reports/\n-dist/\n+# Generated from:\n+# https://github.com/plone/meta/tree/main/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+# python related\n+*.egg-info\n *.pyc\n *.pyo\n-*.egg-info\n+\n+# translation related\n+*.mo\n+\n+# tools related\n+build/\n+.coverage\n+.*project\n+coverage.xml\n+dist/\n+docs/_build\n+__pycache__/\n+.tox\n+.vscode/\n+node_modules/\n+\n+# venv / buildout related\n+bin/\n+develop-eggs/\n+eggs/\n .eggs/\n+etc/\n .installed.cfg\n-.tox/\n-include\n-lib/python2.7\n-.python-version\n-.cache/\n-coverage*\n-.coverage*\n+include/\n+lib/\n+lib64\n+.mr.developer.cfg\n+parts/\n+pyvenv.cfg\n+var/\n+local.cfg\n+\n+# mxdev\n+/instance/\n+/.make-sentinels/\n+/*-mxdev.txt\n+/reports/\n+/sources/\n+/venv/\n+.installed.txt\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [gitignore]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/.meta.toml b/.meta.toml\nnew file mode 100644\nindex 0000000..5978838\n--- /dev/null\n+++ b/.meta.toml\n@@ -0,0 +1,24 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/main/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+[meta]\n+template = "default"\n+commit-id = "5d3e918e"\n+\n+[github]\n+jobs = [\n+    "qa",\n+    "test",\n+    "coverage",\n+    "release_ready",\n+    "circular",\n+    ]\n+\n+[pre_commit]\n+zpretty_extra_lines = """\n+        # Various test failures when we change xml and html.\n+        files: ".*.(zcml)$"\n+"""\n+\n+[pyproject]\n+codespell_skip = "*.po,*.min.js,*.graffle,src/diazo/tests/conditional-drop-in-append*"\ndiff --git a/.pre-commit-config.yaml b/.pre-commit-config.yaml\nnew file mode 100644\nindex 0000000..68017b1\n--- /dev/null\n+++ b/.pre-commit-config.yaml\n@@ -0,0 +1,96 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/main/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+ci:\n+    autofix_prs: false\n+    autoupdate_schedule: monthly\n+\n+repos:\n+-   repo: https://github.com/asottile/pyupgrade\n+    rev: v3.15.0\n+    hooks:\n+    -   id: pyupgrade\n+        args: [--py38-plus]\n+-   repo: https://github.com/pycqa/isort\n+    rev: 5.13.2\n+    hooks:\n+    -   id: isort\n+-   repo: https://github.com/psf/black\n+    rev: 24.1.1\n+    hooks:\n+    -   id: black\n+-   repo: https://github.com/collective/zpretty\n+    rev: 3.1.0\n+    hooks:\n+    -   id: zpretty\n+        # Various test failures when we change xml and html.\n+        files: ".*.(zcml)$"\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  zpretty_extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n+-   repo: https://github.com/PyCQA/flake8\n+    rev: 7.0.0\n+    hooks:\n+    -   id: flake8\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  flake8_extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n+-   repo: https://github.com/codespell-project/codespell\n+    rev: v2.2.6\n+    hooks:\n+    -   id: codespell\n+        additional_dependencies:\n+          - tomli\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  codespell_extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n+-   repo: https://github.com/mgedmin/check-manifest\n+    rev: "0.49"\n+    hooks:\n+    -   id: check-manifest\n+-   repo: https://github.com/regebro/pyroma\n+    rev: "4.2"\n+    hooks:\n+    -   id: pyroma\n+-   repo: https://github.com/mgedmin/check-python-versions\n+    rev: "0.22.0"\n+    hooks:\n+    -   id: check-python-versions\n+        args: [\'--only\', \'setup.py,pyproject.toml\']\n+-   repo: https://github.com/collective/i18ndude\n+    rev: "6.1.0"\n+    hooks:\n+    -   id: i18ndude\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  i18ndude_extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pre_commit]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/MANIFEST.in b/MANIFEST.in\nindex 86944be..5d5589d 100644\n--- a/MANIFEST.in\n+++ b/MANIFEST.in\n@@ -1,28 +1,16 @@\n # MANIFEST.in - Definition which files should be included in a release:\n \n # Files to include:\n-include *.txt\n-global-include *.rst\n-global-include *.cfg\n-global-include *.xsl\n-global-include *.py\n-global-include *.xsl\n-global-include *.zcml\n-global-include *.html\n-global-include *.css\n-global-include *.js\n-global-include *.cfg\n-global-include *.xml\n+include *.rst\n \n # Whitelist / Include Path completely:\n graft docs\n graft examples\n-graft lib\n-graft lib*\n-graft templates\n+graft src\n \n # Blacklist / Exclude Files and Path\n prune docs/_build\n+prune .tox\n global-exclude *pyc\n global-exclude *pyo\n global-exclude *pydinclude pyproject.toml\ndiff --git a/bootstrap.py b/bootstrap.py\ndeleted file mode 100755\nindex ed57894..0000000\n--- a/bootstrap.py\n+++ /dev/null\n@@ -1,178 +0,0 @@\n-##############################################################################\n-#\n-# Copyright (c) 2006 Zope Foundation and Contributors.\n-# All Rights Reserved.\n-#\n-# This software is subject to the provisions of the Zope Public License,\n-# Version 2.1 (ZPL).  A copy of the ZPL should accompany this distribution.\n-# THIS SOFTWARE IS PROVIDED "AS IS" AND ANY AND ALL EXPRESS OR IMPLIED\n-# WARRANTIES ARE DISCLAIMED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n-# WARRANTIES OF TITLE, MERCHANTABILITY, AGAINST INFRINGEMENT, AND FITNESS\n-# FOR A PARTICULAR PURPOSE.\n-#\n-##############################################################################\n-"""Bootstrap a buildout-based project\n-\n-Simply run this script in a directory containing a buildout.cfg.\n-The script accepts buildout command-line options, so you can\n-use the -c option to specify an alternate configuration file.\n-"""\n-\n-import os\n-import shutil\n-import sys\n-import tempfile\n-\n-from optparse import OptionParser\n-\n-tmpeggs = tempfile.mkdtemp()\n-\n-usage = \'\'\'\\\n-[DESIRED PYTHON FOR BUILDOUT] bootstrap.py [options]\n-\n-Bootstraps a buildout-based project.\n-\n-Simply run this script in a directory containing a buildout.cfg, using the\n-Python that you want bin/buildout to use.\n-\n-Note that by using --find-links to point to local resources, you can keep \n-this script from going over the network.\n-\'\'\'\n-\n-parser = OptionParser(usage=usage)\n-parser.add_option("-v", "--version", help="use a specific zc.buildout version")\n-\n-parser.add_option("-t", "--accept-buildout-test-releases",\n-                  dest=\'accept_buildout_test_releases\',\n-                  action="store_true", default=False,\n-                  help=("Normally, if you do not specify a --version, the "\n-                        "bootstrap script and buildout gets the newest "\n-                        "*final* versions of zc.buildout and its recipes and "\n-                        "extensions for you.  If you use this flag, "\n-                        "bootstrap and buildout will get the newest releases "\n-                        "even if they are alphas or betas."))\n-parser.add_option("-c", "--config-file",\n-                  help=("Specify the path to the buildout configuration "\n-                        "file to be used."))\n-parser.add_option("-f", "--find-links",\n-                  help=("Specify a URL to search for buildout releases"))\n-parser.add_option("--allow-site-packages",\n-                  action="store_true", default=False,\n-                  help=("Let bootstrap.py use existing site packages"))\n-\n-\n-options, args = parser.parse_args()\n-\n-######################################################################\n-# load/install setuptools\n-\n-try:\n-    if options.allow_site_packages:\n-        import setuptools\n-        import pkg_resources\n-    from urllib.request import urlopen\n-except ImportError:\n-    from urllib2 import urlopen\n-\n-ez = {}\n-exec(urlopen(\'https://bootstrap.pypa.io/ez_setup.py\').read(), ez)\n-\n-if not options.allow_site_packages:\n-    # ez_setup imports site, which adds site packages\n-    # this will remove them from the path to ensure that incompatible versions \n-    # of setuptools are not in the path\n-    import site\n-    # inside a virtualenv, there is no \'getsitepackages\'. \n-    # We can\'t remove these reliably\n-    if hasattr(site, \'getsitepackages\'):\n-        for sitepackage_path in site.getsitepackages():\n-            sys.path[:] = [x for x in sys.path if sitepackage_path not in x]\n-\n-setup_args = dict(to_dir=tmpeggs, download_delay=0)\n-ez[\'use_setuptools\'](**setup_args)\n-import setuptools\n-import pkg_resources\n-\n-# This does not (always?) update the default working set.  We will\n-# do it.\n-for path in sys.path:\n-    if path not in pkg_resources.working_set.entries:\n-        pkg_resources.working_set.add_entry(path)\n-\n-######################################################################\n-# Install buildout\n-\n-ws = pkg_resources.working_set\n-\n-cmd = [sys.executable, \'-c\',\n-       \'from setuptools.command.easy_install import main; main()\',\n-       \'-mZqNxd\', tmpeggs]\n-\n-find_links = os.environ.get(\n-    \'bootstrap-testing-find-links\',\n-    options.find_links or\n-    (\'http://downloads.buildout.org/\'\n-     if options.accept_buildout_test_releases else None)\n-    )\n-if find_links:\n-    cmd.extend([\'-f\', find_links])\n-\n-setuptools_path = ws.find(\n-    pkg_resources.Requirement.parse(\'setuptools\')).location\n-\n-requirement = \'zc.buildout\'\n-version = options.version\n-if version is None and not options.accept_buildout_test_releases:\n-    # Figure out the most recent final version of zc.buildout.\n-    import setuptools.package_index\n-    _final_parts = \'*final-\', \'*final\'\n-\n-    def _final_version(parsed_version):\n-        for part in parsed_version:\n-            if (part[:1] == \'*\') and (part not in _final_parts):\n-                return False\n-        return True\n-    index = setuptools.package_index.PackageIndex(\n-        search_path=[setuptools_path])\n-    if find_links:\n-        index.add_find_links((find_links,))\n-    req = pkg_resources.Requirement.parse(requirement)\n-    if index.obtain(req) is not None:\n-        best = []\n-        bestv = None\n-        for dist in index[req.project_name]:\n-            distv = dist.parsed_version\n-            if _final_version(distv):\n-                if bestv is None or distv > bestv:\n-                    best = [dist]\n-                    bestv = distv\n-                elif distv == bestv:\n-                    best.append(dist)\n-        if best:\n-            best.sort()\n-            version = best[-1].version\n-if version:\n-    requirement = \'==\'.join((requirement, version))\n-cmd.append(requirement)\n-\n-import subprocess\n-if subprocess.call(cmd, env=dict(os.environ, PYTHONPATH=setuptools_path)) != 0:\n-    raise Exception(\n-        "Failed to execute command:\\n%s" % repr(cmd)[1:-1])\n-\n-######################################################################\n-# Import and run buildout\n-\n-ws.add_entry(tmpeggs)\n-ws.require(requirement)\n-import zc.buildout.buildout\n-\n-if not [a for a in args if \'=\' not in a]:\n-    args.append(\'bootstrap\')\n-\n-# if -c was provided, we push it back into args for buildout\' main function\n-if options.config_file is not None:\n-    args[0:0] = [\'-c\', options.config_file]\n-\n-zc.buildout.buildout.main(args)\n-shutil.rmtree(tmpeggs)\ndiff --git a/buildout.cfg b/buildout.cfg\ndeleted file mode 100644\nindex 3812ad2..0000000\n--- a/buildout.cfg\n+++ /dev/null\n@@ -1,28 +0,0 @@\n-[buildout]\n-extends = versions.cfg\n-parts =\n-    diazo\n-    test\n-    wsgi\n-    sphinx\n-develop = .\n-\n-[diazo]\n-recipe = zc.recipe.egg\n-eggs = diazo\n-interpreter = py\n-\n-[test]\n-recipe = zc.recipe.testrunner\n-eggs = diazo [test]\n-defaults = [\'--auto-color\']\n-\n-[wsgi]\n-recipe = zc.recipe.egg\n-eggs =\n-    diazo [wsgi]\n-    gearbox\n-scripts = gearbox\n-\n-[sphinx]\n-recipe = zc.recipe.egg\ndiff --git a/checkdocs.cfg b/checkdocs.cfg\ndeleted file mode 100644\nindex 18afe5a..0000000\n--- a/checkdocs.cfg\n+++ /dev/null\n@@ -1,6 +0,0 @@\n-[buildout]\n-extends = buildout.cfg\n-\n-[diazo]\n-eggs +=\n-    collective.checkdocs\ndiff --git a/constraints.txt b/constraints.txt\ndeleted file mode 100644\nindex c6ad05a..0000000\n--- a/constraints.txt\n+++ /dev/null\n@@ -1,3 +0,0 @@\n-# Constrains for testing Diazo / Plone Packages\n-# ---------------------------------------------\n-\ndiff --git a/docs/advanced.rst b/docs/advanced.rst\nindex a14c0ab..b7dd2cb 100644\n--- a/docs/advanced.rst\n+++ b/docs/advanced.rst\n@@ -127,7 +127,7 @@ For example, if the transform is set up to receive a string parameter\n \n     <drop css:theme=".test-site-warning" if="$mode = \'live\'" />\n \n-Use the ``if-not`` attribute to negate the conditon, for example::\n+Use the ``if-not`` attribute to negate the condition, for example::\n \n     <drop css:theme=".test-site-warning" if-not="$mode = \'live\'" />\n \n@@ -344,7 +344,7 @@ the included WSGI middleware include a ``doctype`` option which may be set to\n XInclude\n --------\n \n-You may wish to re-use elements of your rules file across multiple themes.\n+You may wish to reuse elements of your rules file across multiple themes.\n This is particularly useful if you have multiple variations on the same theme\n used to style different pages on a particular website.\n \ndiff --git a/docs/conf.py b/docs/conf.py\nindex bb2cc95..ae789c7 100644\n--- a/docs/conf.py\n+++ b/docs/conf.py\n@@ -1,4 +1,3 @@\n-# -*- coding: utf-8 -*-\n #\n # Diazo documentation build configuration file, created by\n # sphinx-quickstart on Tue Nov  2 18:58:07 2010.\n@@ -11,102 +10,100 @@\n # All configuration values have a default; values that are commented out\n # serve to show the default.\n \n-import sys, os\n-\n # If extensions (or modules to document with autodoc) are in another directory,\n # add these directories to sys.path here. If the directory is relative to the\n # documentation root, use os.path.abspath to make it absolute, like shown here.\n-#sys.path.insert(0, os.path.abspath(\'.\'))\n+# sys.path.insert(0, os.path.abspath(\'.\'))\n \n # -- General configuration -----------------------------------------------------\n \n # If your documentation needs a minimal Sphinx version, state it here.\n-#needs_sphinx = \'1.0\'\n+# needs_sphinx = \'1.0\'\n \n # Add any Sphinx extension module names here, as strings. They can be extensions\n # coming with Sphinx (named \'sphinx.ext.*\') or your custom ones.\n extensions = []\n \n # Add any paths that contain templates here, relative to this directory.\n-templates_path = [\'_templates\']\n+templates_path = ["_templates"]\n \n # The suffix of source filenames.\n-source_suffix = \'.rst\'\n+source_suffix = ".rst"\n \n # The encoding of source files.\n-#source_encoding = \'utf-8-sig\'\n+# source_encoding = \'utf-8-sig\'\n \n # The master toctree document.\n-master_doc = \'index\'\n+master_doc = "index"\n \n # General information about the project.\n-project = u\'Diazo\'\n-copyright = u\'2011, Plone Foundation\'\n+project = "Diazo"\n+copyright = "2011, Plone Foundation"\n \n # The version info for the project you\'re documenting, acts as replacement for\n # |version| and |release|, also used in various other places throughout the\n # built documents.\n #\n # The short X.Y version.\n-version = \'1.0b1\'\n+version = "1.0b1"\n # The full version, including alpha/beta/rc tags.\n-release = \'1.0b1\'\n+release = "1.0b1"\n \n # The language for content autogenerated by Sphinx. Refer to documentation\n # for a list of supported languages.\n-#language = None\n+# language = None\n \n # There are two options for replacing |today|: either, you set today to some\n # non-false value, then it is used:\n-#today = \'\'\n+# today = \'\'\n # Else, today_fmt is used as the format for a strftime call.\n-#today_fmt = \'%B %d, %Y\'\n+# today_fmt = \'%B %d, %Y\'\n \n # List of patterns, relative to source directory, that match files and\n # directories to ignore when looking for source files.\n-exclude_patterns = [\'_build\']\n+exclude_patterns = ["_build"]\n \n # The reST default role (used for this markup: `text`) to use for all documents.\n-#default_role = None\n+# default_role = None\n \n # If true, \'()\' will be appended to :func: etc. cross-reference text.\n-#add_function_parentheses = True\n+# add_function_parentheses = True\n \n # If true, the current module name will be prepended to all description\n # unit titles (such as .. function::).\n-#add_module_names = True\n+# add_module_names = True\n \n # If true, sectionauthor and moduleauthor directives will be shown in the\n # output. They are ignored by default.\n-#show_authors = False\n+# show_authors = False\n \n # The name of the Pygments (syntax highlighting) style to use.\n-pygments_style = \'sphinx\'\n+pygments_style = "sphinx"\n \n # A list of ignored prefixes for module index sorting.\n-#modindex_common_prefix = []\n+# modindex_common_prefix = []\n \n \n # -- Options for HTML output ---------------------------------------------------\n \n # The theme to use for HTML and HTML Help pages.  See the documentation for\n # a list of builtin themes.\n-html_theme = \'haiku\'\n+html_theme = "haiku"\n \n # Theme options are theme-specific and customize the look and feel of a theme\n # further.  For a list of options available for each theme, see the\n # documentation.\n-#html_theme_options = {}\n+# html_theme_options = {}\n \n # Add any paths that contain custom themes here, relative to this directory.\n-#html_theme_path = []\n+# html_theme_path = []\n \n # The name for this set of Sphinx documents.  If None, it defaults to\n # "<project> v<release> documentation".\n html_title = "Diazo"\n \n # A shorter title for the navigation bar.  Default is the same as html_title.\n-#html_short_title = None\n+# html_short_title = None\n \n # The name of an image file (relative to this directory) to place at the top\n # of the sidebar.\n@@ -115,102 +112,98 @@\n # The name of an image file (within the static path) to use as favicon of the\n # docs.  This file should be a Windows icon file (.ico) being 16x16 or 32x32\n # pixels large.\n-#html_favicon = None\n+# html_favicon = None\n \n # Add any paths that contain custom static files (such as style sheets) here,\n # relative to this directory. They are copied after the builtin static files,\n # so a file named "default.css" will overwrite the builtin "default.css".\n-html_static_path = [\'_static\']\n+html_static_path = ["_static"]\n \n # If not \'\', a \'Last updated on:\' timestamp is inserted at every page bottom,\n # using the given strftime format.\n-#html_last_updated_fmt = \'%b %d, %Y\'\n+# html_last_updated_fmt = \'%b %d, %Y\'\n \n # If true, SmartyPants will be used to convert quotes and dashes to\n # typographically correct entities.\n-#html_use_smartypants = True\n+# html_use_smartypants = True\n \n # Custom sidebar templates, maps document names to template names.\n-#html_sidebars = {}\n+# html_sidebars = {}\n \n # Additional templates that should be rendered to pages, maps page names to\n # template names.\n-#html_additional_pages = {}\n+# html_additional_pages = {}\n \n # If false, no module index is generated.\n-#html_domain_indices = True\n+# html_domain_indices = True\n \n # If false, no index is generated.\n-#html_use_index = True\n+# html_use_index = True\n \n # If true, the index is split into individual pages for each letter.\n-#html_split_index = False\n+# html_split_index = False\n \n # If true, links to the reST sources are added to the pages.\n-#html_show_sourcelink = True\n+# html_show_sourcelink = True\n \n # If true, "Created using Sphinx" is shown in the HTML footer. Default is True.\n-#html_show_sphinx = True\n+# html_show_sphinx = True\n \n # If true, "(C) Copyright ..." is shown in the HTML footer. Default is True.\n-#html_show_copyright = True\n+# html_show_copyright = True\n \n # If true, an OpenSearch description file will be output, and all pages will\n # contain a <link> tag referring to it.  The value of this option must be the\n # base URL from which the finished HTML is served.\n-#html_use_opensearch = \'\'\n+# html_use_opensearch = \'\'\n \n # This is the file name suffix for HTML files (e.g. ".xhtml").\n-#html_file_suffix = None\n+# html_file_suffix = None\n \n # Output file base name for HTML help builder.\n-htmlhelp_basename = \'Diazodoc\'\n+htmlhelp_basename = "Diazodoc"\n \n \n # -- Options for LaTeX output --------------------------------------------------\n \n # The paper size (\'letter\' or \'a4\').\n-#latex_paper_size = \'letter\'\n+# latex_paper_size = \'letter\'\n \n # The font size (\'10pt\', \'11pt\' or \'12pt\').\n-#latex_font_size = \'10pt\'\n+# latex_font_size = \'10pt\'\n \n # Grouping the document tree into LaTeX files. List of tuples\n # (source start file, target name, title, author, documentclass [howto/manual]).\n latex_documents = [\n-  (\'index\', \'Diazo.tex\', u\'Diazo Documentation\',\n-   u\'Plone Foundation\', \'manual\'),\n+    ("index", "Diazo.tex", "Diazo Documentation", "Plone Foundation", "manual"),\n ]\n \n # The name of an image file (relative to this directory) to place at the top of\n # the title page.\n-#latex_logo = None\n+# latex_logo = None\n \n # For "manual" documents, if this is true, then toplevel headings are parts,\n # not chapters.\n-#latex_use_parts = False\n+# latex_use_parts = False\n \n # If true, show page references after internal links.\n-#latex_show_pagerefs = False\n+# latex_show_pagerefs = False\n \n # If true, show URL addresses after external links.\n-#latex_show_urls = False\n+# latex_show_urls = False\n \n # Additional stuff for the LaTeX preamble.\n-#latex_preamble = \'\'\n+# latex_preamble = \'\'\n \n # Documents to append as an appendix to all manuals.\n-#latex_appendices = []\n+# latex_appendices = []\n \n # If false, no module index is generated.\n-#latex_domain_indices = True\n+# latex_domain_indices = True\n \n \n # -- Options for manual page output --------------------------------------------\n \n # One entry per manual page. List of tuples\n # (source start file, name, description, authors, manual section).\n-man_pages = [\n-    (\'index\', \'diazo\', u\'Diazo Documentation\',\n-     [u\'Plone Foundation\'], 1)\n-]\n+man_pages = [("index", "diazo", "Diazo Documentation", ["Plone Foundation"], 1)]\ndiff --git a/docs/deployment.rst b/docs/deployment.rst\nindex 2615649..ff518a9 100644\n--- a/docs/deployment.rst\n+++ b/docs/deployment.rst\n@@ -142,12 +142,12 @@ will need to compile Nginx with a special version of the XSLT module that\n can (optionally) use the HTML parser from libxml2.\n \n If you expect the source content to be xhtml well-formed and valid, then you\n-should be able to avoid the ``xslt_html_parser on;`` directive. You can \n+should be able to avoid the ``xslt_html_parser on;`` directive. You can\n achieve this if you generate the source content.\n \n-Otherwise, if you expect non-xhtml compliant html, you need to compile Nginx \n-from source. At the time of this writing, the html-xslt_ project proposes \n-full Nginx sources for Nginx 0.7 and 0.8, whereas Nginx is now 1.6 and 1.7. \n+Otherwise, if you expect non-xhtml compliant html, you need to compile Nginx\n+from source. At the time of this writing, the html-xslt_ project proposes\n+full Nginx sources for Nginx 0.7 and 0.8, whereas Nginx is now 1.6 and 1.7.\n Here is an alternative `patch\n <https://github.com/jcu-eresearch/nginx-custom-build/blob/master/nginx-xslt-html-parser.patch>`_\n you should be able to apply to any Nginx source code with the command-line\n@@ -155,7 +155,7 @@ you should be able to apply to any Nginx source code with the command-line\n \n In the future, the necessary patches to enable HTML mode parsing will\n hopefully be part of the standard Nginx distribution. There also is a\n-`Nginx ticket <http://trac.nginx.org/nginx/ticket/609>`_ asking for the \n+`Nginx ticket <http://trac.nginx.org/nginx/ticket/609>`_ asking for the\n xslt_html_parser in the http_xslt_module.\n \n Using a properly patched Nginx, you can configure it with XSLT support like\n@@ -301,7 +301,7 @@ below uses this parameter to apply a filter::\n     }\n \n In this example the sub-request is set to loop back on itself, so the include\n-is taken from a themed page. ``filter.xsl`` (in the lib/diazo directory) and\n+is taken from a themed page. ``filter.xsl`` (in the src/diazo directory) and\n ``theme.xsl`` should both be placed in the same directory as ``Nginx.conf``.\n \n An example buildout is available in ``Nginx.cfg`` in this package.\ndiff --git a/docs/introduction.rst b/docs/introduction.rst\nindex 74655e6..7c3b35a 100644\n--- a/docs/introduction.rst\n+++ b/docs/introduction.rst\n@@ -42,7 +42,7 @@ Bear in mind that:\n   be served from a static webserver, which is normally much faster than\n   serving them from a dynamic application.\n * You can leave the original theme HTML untouched, which makes it easier to\n-  re-use for other scenarios. For example, you can stitch two unrelated\n+  reuse for other scenarios. For example, you can stitch two unrelated\n   applications together by using a single theme file with separate rules\n   files. This would result in two compiled XSLT files. You could use location\n   match rules or similar techniques to choose which one to invoke for a given\ndiff --git a/lib/diazo/runtrace.py b/lib/diazo/runtrace.py\ndeleted file mode 100644\nindex 44a50c6..0000000\n--- a/lib/diazo/runtrace.py\n+++ /dev/null\n@@ -1,137 +0,0 @@\n-#!/usr/bin/env python\n-# -*- coding: utf-8 -*-\n-\n-from diazo.rules import process_rules\n-from diazo.utils import pkg_xsl\n-from lxml import etree\n-\n-import logging\n-\n-\n-logger = logging.getLogger(\'diazo\')\n-\n-_runtrace_to_html = pkg_xsl(\'runtrace_to_html.xsl\')\n-\n-\n-def log_to_xml_string(error_log):\n-    msgs = [l.message for l in error_log if l.message.startswith(\'<runtrace \')]\n-    return """\n-<runtrace xmlns:css="http://namespaces.plone.org/diazo/css">\n-    {message:s}\n-</runtrace>\n-""".format(message=\'\'.join(msgs))\n-\n-\n-def generate_runtrace(rules, error_log, rules_parser=None):\n-    """Annotate a rules file with the results of a transformation"""\n-    def condition_name(trace):\n-        """Generate attribute name for this entry"""\n-        for k in trace.attrib.keys():\n-            if(k == \'theme_xmlid\'):\n-                continue\n-            if(k.startswith(\'{http://namespaces.plone.org/diazo/css}\')):\n-                continue\n-            return \'runtrace-\' + k\n-\n-    rules_doc = process_rules(\n-        rules,\n-        rules_parser=rules_parser,\n-        stop=\'add_identifiers\',\n-    )\n-    trace_doc = etree.XML(log_to_xml_string(error_log))\n-\n-    for trace in trace_doc.xpath(\'/runtrace/runtrace\'):\n-        for el in rules_doc.xpath("id(\'" + trace.attrib[\'theme_xmlid\'] + "\')"):\n-            el.set(condition_name(trace), trace.text or \'\')\n-    return rules_doc\n-\n-\n-def runtrace_to_html(runtrace_doc):\n-    """Convert the runtrace document into HTML"""\n-    return _runtrace_to_html(runtrace_doc)\n-\n-\n-def error_log_to_html(error_log):\n-    """Convert an error log into an HTML representation"""\n-    doc = etree.Element(\'ul\')\n-    for l in error_log:\n-        if l.message.startswith(\'<runtrace \'):\n-            continue\n-        el = etree.Element(\'li\')\n-        el.attrib[\'class\'] = \'domain_{domain_name} level_{level_name} type_{type_name}\'.format(  # NOQA: E501\n-            domain_name=l.domain_name,\n-            level_name=l.level_name,\n-            type_name=l.type_name,\n-        )\n-        el.text = \'{msg:s} [{line:d}:{column:d}]\'.format(\n-            msg=l.message,\n-            line=l.line,\n-            column=l.column,\n-        )\n-        doc.append(el)\n-    return doc\n-\n-\n-def generate_debug_html(\n-    base_url,\n-    rules=None,\n-    error_log=None,\n-    rules_parser=None,\n-):\n-    """Generate an HTML node with debug info"""\n-    def newElement(tag, content, **kwargs):\n-        n = etree.Element(tag, **kwargs)\n-        if getattr(content, \'tag\', None):\n-            n.append(content)\n-        else:\n-            n.text = content\n-        return n\n-\n-    debug_output_iframe = etree.Element(\'div\', id=\'diazo-debug-iframe\')\n-    debug_output_iframe.attrib[\'style\'] = \'display:none\'\n-    debug_output_iframe.attrib[\'data-iframe\'] = \'diazo-debug\'\n-    debug_output_iframe.attrib[\'data-iframe-style\'] = \'\'\n-    debug_output_iframe.attrib[\'data-iframe-position\'] = \'bottom\'\n-    debug_output_iframe.attrib[\'data-iframe-resources\'] = \\\n-        base_url + \'/diazo-debug.css;\' + \\\n-        base_url + \'/jquery-1.8.3.min.js;\' + \\\n-        base_url + \'/diazo-debug.js\'\n-    debug_output = etree.Element(\'div\', id=\'diazo-debug\')\n-\n-    if error_log:\n-        debug_output.append(\n-            newElement(\n-                \'section\',\n-                error_log_to_html(error_log),\n-                id=\'diazo_error_log\',\n-            ),\n-        )\n-\n-    try:\n-        runtrace_doc = generate_runtrace(rules, error_log, rules_parser)\n-        debug_output.append(\n-            newElement(\n-                \'section\',\n-                runtrace_to_html(runtrace_doc).getroot(),\n-                id=\'diazo_runtrace\',\n-            ),\n-        )\n-    except etree.XMLSyntaxError:\n-        debug_output.append(\n-            newElement(\n-                \'section\',\n-                \'Rules document could not be parsed!\',\n-                id=\'diazo_runtrace\',\n-            ),\n-        )\n-\n-    debug_output_iframe.append(debug_output)\n-    debug_output_iframe.append(\n-        newElement(\n-            \'script\',\n-            \' \',\n-            text=\'text/javascript\',\n-            src=base_url + \'/iframe.js\',\n-        ),\n-    )\n-    return debug_output_iframe\ndiff --git a/lib/diazo/utils.py b/lib/diazo/utils.py\ndeleted file mode 100644\nindex 5da81f4..0000000\n--- a/lib/diazo/utils.py\n+++ /dev/null\n@@ -1,215 +0,0 @@\n-# -*- coding: utf-8 -*-\n-\n-from lxml import etree\n-from optparse import OptionParser\n-from six import integer_types\n-from six import PY3\n-from six import string_types\n-\n-import logging\n-import pkg_resources\n-import sys\n-\n-\n-if PY3:\n-    try:\n-        stdout = sys.stdout.buffer\n-    except AttributeError:\n-        # This can happen in (doc-)tests e. g. in plone.app.testing:\n-        stdout = None\n-else:\n-    stdout = sys.stdout\n-\n-strparam = etree.XSLT.strparam\n-\n-logger = logging.getLogger(\'diazo\')\n-\n-namespaces = dict(\n-    diazo=\'http://namespaces.plone.org/diazo\',\n-    css=\'http://namespaces.plone.org/diazo/css\',\n-    old1=\'http://openplans.org/deliverance\',\n-    old2=\'http://namespaces.plone.org/xdv\',\n-    oldcss1=\'http://namespaces.plone.org/xdv+css\',\n-    oldcss2=\'http://namespaces.plone.org/diazo+css\',\n-    xml=\'http://www.w3.org/XML/1998/namespace\',\n-    xsl=\'http://www.w3.org/1999/XSL/Transform\',\n-)\n-\n-\n-def localname(name):\n-    return name.rsplit(\'}\', 1)[1]\n-\n-\n-def namespace(name):\n-    return name.rsplit(\'}\', 1)[0][1:]\n-\n-\n-def fullname(namespace, name):\n-    return \'{%s}%s\' % (namespace, name)  # NOQA: S001\n-\n-\n-AC_READ_FILE = etree.XSLTAccessControl(\n-    read_file=True,\n-    write_file=False,\n-    create_dir=False,\n-    read_network=False,\n-    write_network=False,\n-)\n-AC_READ_NET = etree.XSLTAccessControl(\n-    read_file=True,\n-    write_file=False,\n-    create_dir=False,\n-    read_network=True,\n-    write_network=False,\n-)\n-\n-\n-class CustomResolver(etree.Resolver):\n-    def __init__(self, data):\n-        self.data = data\n-\n-    def resolve(self, url, pubid, context):\n-        output = self.data.get(url)\n-        if output is not None:\n-            return self.resolve_string(output, context)\n-\n-\n-class LoggingXSLTWrapper:\n-    def __init__(self, xslt, logger):\n-        self.xslt = xslt\n-        self.logger = logger\n-\n-    def __call__(self, *args, **kw):\n-        result = self.xslt(*args, **kw)\n-        for msg in self.xslt.error_log:\n-            if msg.type == etree.ErrorTypes.ERR_OK:\n-                self.logger.debug(msg.message)\n-            else:\n-                self.logger.debug(msg)\n-        return result\n-\n-\n-def pkg_parse(name, parser=None):\n-    with open(pkg_resources.resource_filename(\'diazo\', name)) as f:\n-        return etree.parse(f, parser=parser)\n-\n-\n-def pkg_xsl(name, parser=None):\n-    return LoggingXSLTWrapper(etree.XSLT(pkg_parse(name, parser)), logger)\n-\n-\n-def quote_param(value):\n-    """Quote for passing as an XSL parameter.\n-\n-    Works with strings, booleans, numbers and None.\n-    """\n-\n-    if isinstance(value, string_types):\n-        return strparam(value)\n-    elif isinstance(value, bool):\n-        return value and \'true()\' or \'false()\'\n-    elif isinstance(value, integer_types + (float,)):\n-        value = repr(value)\n-    elif value is None:\n-        return \'/..\'\n-    else:\n-        raise ValueError(\'Cannot convert %s\', value)\n-\n-\n-def split_params(s):\n-    """Turn foo,bar=baz into {\'foo\': None, \'bar\': \'baz\'}\n-    """\n-\n-    xsl_params = {}\n-    for param in s.split(\',\'):\n-        tokens = [t.strip() for t in param.split(\'=\')]\n-        xsl_params[tokens[0]] = len(tokens) > 1 and tokens[1] or None\n-    return xsl_params\n-\n-\n-def _createOptionParser(usage):\n-    parser = OptionParser(usage=usage)\n-    parser.add_option(\n-        \'-o\',\n-        \'--output\',\n-        metavar=\'output.xsl\',\n-        help=\'Output filename (instead of stdout)\',\n-        dest=\'output\',\n-        default=stdout,\n-    )\n-    parser.add_option(\n-        \'-p\',\n-        \'--pretty-print\',\n-        action=\'store_true\',\n-        help=\'Pretty print output (may alter rendering in browser)\',\n-        dest=\'pretty_print\',\n-        default=False,\n-    )\n-    parser.add_option(\n-        \'--trace\',\n-        action=\'store_true\',\n-        help=\'Compiler trace logging\',\n-        dest=\'trace\',\n-        default=False,\n-    )\n-    parser.add_option(\n-        \'-a\',\n-        \'--absolute-prefix\',\n-        metavar=\'/\',\n-        help=\'relative urls in the theme file will be made into absolute \'\n-             \'links with this prefix.\',\n-        dest=\'absolute_prefix\',\n-        default=None,\n-    )\n-    parser.add_option(\n-        \'-i\',\n-        \'--includemode\',\n-        metavar=\'INC\',\n-        help=\'include mode (document, ssi, ssiwait or esi)\',\n-        dest=\'includemode\',\n-        default=None,\n-    )\n-    parser.add_option(\n-        \'-n\',\n-        \'--network\',\n-        action=\'store_true\',\n-        help=\'Allow reads to the network to fetch resources\',\n-        dest=\'read_network\',\n-        default=False,\n-    )\n-    parser.add_option(\n-        \'-t\',\n-        \'--theme\',\n-        metavar=\'theme.html\',\n-        help=\'Theme file\',\n-        dest=\'theme\',\n-        default=None,\n-    )\n-    parser.add_option(\n-        \'-r\',\n-        \'--rules\',\n-        metavar=\'rules.xml\',\n-        help=\'Diazo rules file\',\n-        dest=\'rules\',\n-        default=None,\n-    )\n-    parser.add_option(\n-        \'-c\',\n-        \'--custom-parameters\',\n-        metavar=\'param1,param2=defaultval\',\n-        help=\'Comma-separated list of custom parameter names with optional \'\n-             \'default values that the compiled theme will be able accept \'\n-             \'when run\',\n-        dest=\'xsl_params\',\n-        default=None,\n-    )\n-    parser.add_option(\n-        \'-e\',\n-        \'--extra\',\n-        metavar=\'extra.xsl\',\n-        help=\'Extra XSL to be included in the transform \'\n-             \'(depracated, use inline xsl in the rules instead)\',\n-        dest=\'extra\',\n-        default=None,\n-    )\n-    return parser\ndiff --git a/lxml.cfg b/lxml.cfg\ndeleted file mode 100644\nindex ebe1c1b..0000000\n--- a/lxml.cfg\n+++ /dev/null\n@@ -1,14 +0,0 @@\n-[buildout]\n-extends = buildout.cfg\n-\n-# lxml must be first in parts.\n-parts =\n-    lxml\n-    diazo\n-    test\n-\n-[lxml]\n-recipe = z3c.recipe.staticlxml\n-egg = lxml\n-libxml2-url = http://xmlsoft.org/sources/libxml2-2.7.7.tar.gz\n-libxslt-url = http://xmlsoft.org/sources/libxslt-1.1.26.tar.gz\ndiff --git a/news/23.breaking b/news/23.breaking\nnew file mode 100644\nindex 0000000..f7b5432\n--- /dev/null\n+++ b/news/23.breaking\n@@ -0,0 +1,3 @@\n+Drop support for Pythons that are end of life.\n+Support Python 3.8-3.12.\n+[maurits]\ndiff --git a/news/5d3e918e.internal b/news/5d3e918e.internal\nnew file mode 100644\nindex 0000000..c08f539\n--- /dev/null\n+++ b/news/5d3e918e.internal\n@@ -0,0 +1,2 @@\n+Update configuration files.\n+[plone devs]\ndiff --git a/nginx.cfg b/nginx.cfg\ndeleted file mode 100644\nindex aa1e9ac..0000000\n--- a/nginx.cfg\n+++ /dev/null\n@@ -1,67 +0,0 @@\n-[buildout]\n-extends = lxml.cfg\n-parts +=\n-    nginx\n-    nginx.conf\n-    example-theme\n-    ploneorg-theme\n-    rebuild-themes\n-\n-[nginx]\n-recipe = zc.recipe.cmmi\n-url = http://html-xslt.googlecode.com/files/nginx-0.7.67-html-xslt-4.tar.gz\n-# The SSI bug was fixed in nginx-0.7.65-html-xslt-2.tar.gz\n-extra_options =\n-    --conf-path=${buildout:directory}/etc/nginx.conf\n-    --sbin-path=${buildout:directory}/bin\n-    --error-log-path=${buildout:directory}/var/log/nginx-error.log\n-    --http-log-path=${buildout:directory}/var/log/nginx-access.log\n-    --pid-path=${buildout:directory}/var/nginx.pid\n-    --lock-path=${buildout:directory}/var/nginx.lock\n-    --with-http_stub_status_module\n-    --with-http_xslt_module\n-    --with-libxml2=${buildout:directory}/parts/lxml/libxml2\n-    --with-libxslt=${buildout:directory}/parts/lxml/libxslt\n-#    --with-debug --with-cc-opt="-O0" # helps debugging with gdb\n-\n-[nginx.conf]\n-recipe = collective.recipe.template\n-port = 8000\n-root = ${buildout:directory}/examples\n-filter.xsl = ${buildout:directory}/lib/diazo/filter.xsl\n-example.xsl = ${buildout:directory}/etc/example.xsl\n-ploneorg.xsl = ${buildout:directory}/etc/ploneorg.xsl\n-input = ${buildout:directory}/templates/nginx.conf.in\n-output = ${buildout:directory}/etc/nginx.conf\n-\n-[example-theme]\n-recipe = plone.recipe.command\n-includemode = ssi\n-command =\n-    ${buildout:directory}/bin/diazocompiler \\\n-        --includemode=${:includemode}  --output=${nginx.conf:example.xsl} \\\n-        ${nginx.conf:root}/rules.xml ${nginx.conf:root}/theme.html\n-update-command = ${:command}\n-\n-[ploneorg-theme]\n-recipe = plone.recipe.command\n-includemode = ssi\n-command =\n-    ${buildout:directory}/bin/diazocompiler \\\n-        --includemode=${:includemode}  --output=${nginx.conf:ploneorg.xsl} \\\n-        --extra=${nginx.conf:root}/ploneorg/default-extra.xsl \\\n-        ${nginx.conf:root}/ploneorg/default.xml ${nginx.conf:root}/ploneorg/plone.html\n-update-command = ${:command}\n-\n-[rebuild-themes]\n-recipe = collective.recipe.template\n-library-path = ${buildout:directory}/parts/lxml/libxml2/lib:${buildout:directory}/parts/lxml/libxslt/lib\n-inline =\n-    #!/bin/sh\n-    export LD_LIBRARY_PATH=${:library-path}\n-    export DYLD_LIBRARY_PATH=${:library-path}\n-    ${example-theme:command} && echo example theme rebuilt\n-    ${ploneorg-theme:command} && echo ploneorg theme rebuilt\n-    ${buildout:directory}/bin/nginx -s reload && echo nginx reloaded.\n-output = ${buildout:directory}/bin/rebuild-themes\n-mode = 755\ndiff --git a/pyproject.toml b/pyproject.toml\nindex 05b615d..a472155 100644\n--- a/pyproject.toml\n+++ b/pyproject.toml\n@@ -1,6 +1,12 @@\n+# Generated from:\n+# https://github.com/plone/meta/tree/main/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n+[build-system]\n+requires = ["setuptools>=68.2"]\n+\n [tool.towncrier]\n-filename = "CHANGES.rst"\n directory = "news/"\n+filename = "CHANGES.rst"\n title_format = "{version} ({project_date})"\n underlines = ["-", ""]\n \n@@ -18,3 +24,136 @@ showcontent = true\n directory = "bugfix"\n name = "Bug fixes:"\n showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "internal"\n+name = "Internal:"\n+showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "documentation"\n+name = "Documentation:"\n+showcontent = true\n+\n+[[tool.towncrier.type]]\n+directory = "tests"\n+name = "Tests"\n+showcontent = true\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  towncrier_extra_lines = """\n+#  extra_configuration\n+#  """\n+##\n+\n+[tool.isort]\n+profile = "plone"\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  isort_extra_lines = """\n+#  extra_configuration\n+#  """\n+##\n+\n+[tool.black]\n+target-version = ["py38"]\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  black_extra_lines = """\n+#  extra_configuration\n+#  """\n+##\n+\n+[tool.codespell]\n+ignore-words-list = "discreet,"\n+skip = "*.po,*.po,*.min.js,*.graffle,src/diazo/tests/conditional-drop-in-append*"\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  codespell_ignores = "foo,bar"\n+#  codespell_skip = "*.po,*.map,package-lock.json"\n+##\n+\n+[tool.dependencychecker]\n+Zope = [\n+  # Zope own provided namespaces\n+  \'App\', \'OFS\', \'Products.Five\', \'Products.OFSP\', \'Products.PageTemplates\',\n+  \'Products.SiteAccess\', \'Shared\', \'Testing\', \'ZPublisher\', \'ZTUtils\',\n+  \'Zope2\', \'webdav\', \'zmi\',\n+  # ExtensionClass own provided namespaces\n+  \'ExtensionClass\', \'ComputedAttribute\', \'MethodObject\',\n+  # Zope dependencies\n+  \'AccessControl\', \'Acquisition\', \'AuthEncoding\', \'beautifulsoup4\', \'BTrees\',\n+  \'cffi\', \'Chameleon\', \'DateTime\', \'DocumentTemplate\',\n+  \'MultiMapping\', \'multipart\', \'PasteDeploy\', \'Persistence\', \'persistent\',\n+  \'pycparser\', \'python-gettext\', \'pytz\', \'RestrictedPython\', \'roman\',\n+  \'soupsieve\', \'transaction\', \'waitress\', \'WebOb\', \'WebTest\', \'WSGIProxy2\',\n+  \'z3c.pt\', \'zc.lockfile\', \'ZConfig\', \'zExceptions\', \'ZODB\', \'zodbpickle\',\n+  \'zope.annotation\', \'zope.browser\', \'zope.browsermenu\', \'zope.browserpage\',\n+  \'zope.browserresource\', \'zope.cachedescriptors\', \'zope.component\',\n+  \'zope.configuration\', \'zope.container\', \'zope.contentprovider\',\n+  \'zope.contenttype\', \'zope.datetime\', \'zope.deferredimport\',\n+  \'zope.deprecation\', \'zope.dottedname\', \'zope.event\', \'zope.exceptions\',\n+  \'zope.filerepresentation\', \'zope.globalrequest\', \'zope.hookable\',\n+  \'zope.i18n\', \'zope.i18nmessageid\', \'zope.interface\', \'zope.lifecycleevent\',\n+  \'zope.location\', \'zope.pagetemplate\', \'zope.processlifetime\', \'zope.proxy\',\n+  \'zope.ptresource\', \'zope.publisher\', \'zope.schema\', \'zope.security\',\n+  \'zope.sequencesort\', \'zope.site\', \'zope.size\', \'zope.structuredtext\',\n+  \'zope.tal\', \'zope.tales\', \'zope.testbrowser\', \'zope.testing\',\n+  \'zope.traversing\', \'zope.viewlet\'\n+]\n+\'Products.CMFCore\' = [\n+  \'docutils\', \'five.localsitemanager\', \'Missing\', \'Products.BTreeFolder2\',\n+  \'Products.GenericSetup\', \'Products.MailHost\', \'Products.PythonScripts\',\n+  \'Products.StandardCacheManagers\', \'Products.ZCatalog\', \'Record\',\n+  \'zope.sendmail\', \'Zope\'\n+]\n+\'plone.base\' = [\n+  \'plone.batching\', \'plone.registry\', \'plone.schema\',\'plone.z3cform\',\n+  \'Products.CMFCore\', \'Products.CMFDynamicViewFTI\',\n+]\n+python-dateutil = [\'dateutil\']\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  dependencies_ignores = "[\'zestreleaser.towncrier\']"\n+#  dependencies_mappings = [\n+#    "gitpython = [\'git\']",\n+#    "pygithub = [\'github\']",\n+#  ]\n+##\n+\n+[tool.check-manifest]\n+ignore = [\n+    ".editorconfig",\n+    ".meta.toml",\n+    ".pre-commit-config.yaml",\n+    "tox.ini",\n+    ".flake8",\n+    "mx.ini",\n+\n+]\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  check_manifest_ignores = """\n+#      "*.map.js",\n+#      "*.pyc",\n+#  """\n+##\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [pyproject]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/setup.cfg b/setup.cfg\nindex fc83f1e..1adbac3 100644\n--- a/setup.cfg\n+++ b/setup.cfg\n@@ -1,41 +1,15 @@\n-[check-manifest]\n-ignore =\n-    *.cfg\n-    bootstrap.py\n-    tox.ini\n-\n-[isort]\n-# for details see\n-# http://docs.plone.org/develop/styleguide/python.html#grouping-and-sorting\n-force_alphabetical_sort = True\n-force_single_line = True\n-lines_after_imports = 2\n-line_length = 200\n-\n-[flake8]\n-exclude =\n-\n-ignore =\n-\n [tool:pytest]\n addopts = -ra\n \n testpaths =\n #    package-tests/\n \n-norecursedirs = fixures\n-\n [coverage:run]\n branch = True\n-source = lib\n-omit =\n-    bootstrap.py\n+source = src\n \n [coverage:report]\n precision = 2\n \n [coverage:html]\n directory = reports/coverage\n-\n-[bdist_wheel]\n-universal = 1\ndiff --git a/setup.py b/setup.py\nindex 28c732a..4e91349 100644\n--- a/setup.py\n+++ b/setup.py\n@@ -1,71 +1,64 @@\n-# -*- coding: utf-8 -*-\n-\n from setuptools import find_packages\n from setuptools import setup\n \n \n extras_require = {\n-    \'wsgi\': [\n-        \'repoze.xmliter\',\n-        \'WebOb\',\n+    "wsgi": [\n+        "repoze.xmliter",\n+        "WebOb",\n     ],\n-    \'test\': [\n-        \'repoze.xmliter\',\n-        \'WebOb\',\n-        \'py\',\n+    "test": [\n+        "repoze.xmliter",\n+        "WebOb",\n     ],\n }\n \n \n-readme = open(\'README.rst\').read()\n-changes = open(\'CHANGES.rst\').read()\n-long_desc = readme + \'\\n\\n\' + changes\n+readme = open("README.rst").read()\n+changes = open("CHANGES.rst").read()\n+long_desc = readme + "\\n\\n" + changes\n \n setup(\n-    name=\'diazo\',\n-    version=\'1.5.1.dev0\',\n+    name="diazo",\n+    version="1.5.1.dev0",\n     description="""Diazo implements a Deliverance like language using a pure\n         XSLT engine. With Diazo, you "compile" your theme and ruleset in one\n         step, then use a superfast/simple transform on each request thereafter.\n         Alternatively, compile your theme during development, check it into\n         version control, and not touch Diazo during deployment.""",\n-    keywords=\'web theming\',\n+    keywords="web theming",\n     long_description=long_desc,\n-    packages=find_packages(\'lib\'),\n-    package_dir={\'\': \'lib\'},\n+    packages=find_packages("src"),\n+    package_dir={"": "src"},\n     include_package_data=True,\n     zip_safe=False,\n-    author=\'Paul Everitt, Laurence Rowe and Martin Aspeli.\',\n-    author_email=\'laurence@lrowe.co.uk\',\n-    url=\'http://diazo.org\',\n-    license=\'New BSD\',\n+    author="Paul Everitt, Laurence Rowe and Martin Aspeli.",\n+    author_email="laurence@lrowe.co.uk",\n+    url="http://diazo.org",\n+    license="New BSD",\n     classifiers=[\n-        \'Development Status :: 6 - Mature\',\n-        \'License :: OSI Approved :: BSD License\',\n-        \'Programming Language :: Python\',\n-        \'Programming Language :: Python :: 2\',\n-        \'Programming Language :: Python :: 2.7\',\n-        \'Programming Language :: Python :: 3\',\n-        \'Programming Language :: Python :: 3.5\',\n-        \'Programming Language :: Python :: 3.6\',\n-        \'Programming Language :: Python :: 3.7\',\n-        \'Programming Language :: Python :: 3.8\',\n-        \'Programming Language :: Python :: 3.9\',\n-        \'Programming Language :: Python :: 3.10\',\n-        \'Topic :: Internet :: WWW/HTTP\',\n-        \'Topic :: Internet :: WWW/HTTP :: WSGI\',\n-        \'Topic :: Internet :: WWW/HTTP :: WSGI :: Middleware\',\n-        \'Topic :: Text Processing :: Markup :: XML\',\n+        "Development Status :: 6 - Mature",\n+        "License :: OSI Approved :: BSD License",\n+        "Programming Language :: Python",\n+        "Programming Language :: Python :: 3.8",\n+        "Programming Language :: Python :: 3.9",\n+        "Programming Language :: Python :: 3.10",\n+        "Programming Language :: Python :: 3.11",\n+        "Programming Language :: Python :: 3.12",\n+        "Topic :: Internet :: WWW/HTTP",\n+        "Topic :: Internet :: WWW/HTTP :: WSGI",\n+        "Topic :: Internet :: WWW/HTTP :: WSGI :: Middleware",\n+        "Topic :: Text Processing :: Markup :: XML",\n     ],\n+    python_requires=">=3.8",\n     install_requires=[\n-    #    \'setuptools\',\n-        \'lxml\',\n-        \'cssselect\',\n-        \'six\',\n+        #    \'setuptools\',\n+        "lxml",\n+        "cssselect",\n     ],\n     extras_require=extras_require,\n-    test_suite=\'diazo.tests.alltests\',\n-    tests_require=extras_require[\'test\'],\n+    test_suite="diazo.tests.alltests",\n+    tests_require=extras_require["test"],\n     entry_points="""\n         [console_scripts]\n         diazocompiler = diazo.compiler:main\ndiff --git a/lib/diazo/__init__.py b/src/diazo/__init__.py\nsimilarity index 60%\nrename from lib/diazo/__init__.py\nrename to src/diazo/__init__.py\nindex f442168..861028b 100644\n--- a/lib/diazo/__init__.py\n+++ b/src/diazo/__init__.py\n@@ -1,5 +1,3 @@\n-# -*- coding: utf-8 -*-\n-\n import logging\n \n \ndiff --git a/lib/diazo/annotate-rules.xsl b/src/diazo/annotate-rules.xsl\nsimilarity index 100%\nrename from lib/diazo/annotate-rules.xsl\nrename to src/diazo/annotate-rules.xsl\ndiff --git a/lib/diazo/annotate-themes.xsl b/src/diazo/annotate-themes.xsl\nsimilarity index 100%\nrename from lib/diazo/annotate-themes.xsl\nrename to src/diazo/annotate-themes.xsl\ndiff --git a/lib/diazo/apply-conditions.xsl b/src/diazo/apply-conditions.xsl\nsimilarity index 100%\nrename from lib/diazo/apply-conditions.xsl\nrename to src/diazo/apply-conditions.xsl\ndiff --git a/lib/diazo/apply-rules.xsl b/src/diazo/apply-rules.xsl\nsimilarity index 100%\nrename from lib/diazo/apply-rules.xsl\nrename to src/diazo/apply-rules.xsl\ndiff --git a/lib/diazo/compiler.py b/src/diazo/compiler.py\nsimilarity index 81%\nrename from lib/diazo/compiler.py\nrename to src/diazo/compiler.py\nindex 14e692b..78e63e9 100644\n--- a/lib/diazo/compiler.py\n+++ b/src/diazo/compiler.py\n@@ -1,5 +1,4 @@\n #!/usr/bin/env python\n-# -*- coding: utf-8 -*-\n """\\\n Usage: %prog [options] [-r] RULES [-t] THEME\n \n@@ -18,30 +17,29 @@\n from diazo.utils import quote_param\n from diazo.utils import split_params\n from lxml import etree\n-from six import string_types\n \n import logging\n import pkg_resources\n \n \n-logger = logging.getLogger(\'diazo\')\n+logger = logging.getLogger("diazo")\n usage = __doc__\n \n \n def set_parser(stylesheet, parser, compiler_parser=None):\n-    file_obj = pkg_resources.resource_filename(\'diazo\', \'dummy.html\')\n+    file_obj = pkg_resources.resource_filename("diazo", "dummy.html")\n     with open(file_obj) as file_handler:\n         dummy_doc = etree.parse(\n             file_handler,\n             parser=parser,\n         )\n-    name = \'file:///__diazo__\'\n+    name = "file:///__diazo__"\n     resolver = CustomResolver({name: stylesheet})\n     if compiler_parser is None:\n         compiler_parser = etree.XMLParser()\n     compiler_parser.resolvers.add(resolver)\n-    identity = pkg_xsl(\'identity.xsl\', compiler_parser)\n-    output_doc = identity(dummy_doc, docurl="\'{name}\'".format(name=name))\n+    identity = pkg_xsl("identity.xsl", compiler_parser)\n+    output_doc = identity(dummy_doc, docurl=f"\'{name}\'")\n     compiler_parser.resolvers.remove(resolver)\n     return output_doc\n \n@@ -49,8 +47,8 @@ def set_parser(stylesheet, parser, compiler_parser=None):\n def build_xsl_params_document(xsl_params):\n     if xsl_params is None:\n         xsl_params = {}\n-    if \'path\' not in xsl_params:\n-        xsl_params[\'path\'] = \'\'\n+    if "path" not in xsl_params:\n+        xsl_params["path"] = ""\n     known_params = etree.XML(\n         \'<xsl:stylesheet version="1.0" \'\n         \'xmlns:xsl="http://www.w3.org/1999/XSL/Transform" />\',\n@@ -58,14 +56,14 @@ def build_xsl_params_document(xsl_params):\n     for param_name, param_value in xsl_params.items():\n         param_element = etree.SubElement(\n             known_params,\n-            \'{http://www.w3.org/1999/XSL/Transform}param\',\n+            "{http://www.w3.org/1999/XSL/Transform}param",\n         )\n-        param_element.attrib[\'name\'] = param_name\n-        if isinstance(param_value, string_types):\n+        param_element.attrib["name"] = param_name\n+        if isinstance(param_value, str):\n             param_element.text = param_value\n         else:\n-            param_element.attrib[\'select\'] = str(quote_param(param_value))\n-        param_element.tail = \'\\n\'\n+            param_element.attrib["select"] = str(quote_param(param_value))\n+        param_element.tail = "\\n"\n \n     return known_params\n \n@@ -93,7 +91,7 @@ def compile_theme(\n \n     * ``rules`` is the rules file\n     * ``theme`` is the theme file\n-    * ``extra`` is an optional XSLT file with Diazo extensions (depracated, use\n+    * ``extra`` is an optional XSLT file with Diazo extensions (deprecated, use\n       inline xsl in the rules instead)\n     * ``css``   can be set to False to disable CSS syntax support (providing a\n       moderate speed gain)\n@@ -125,7 +123,7 @@ def compile_theme(\n       names. Values are default values.\n     """\n     if access_control is not None:\n-        read_network = access_control.options[\'read_network\']\n+        read_network = access_control.options["read_network"]\n     rules_doc = process_rules(\n         rules=rules,\n         theme=theme,\n@@ -146,23 +144,25 @@ def compile_theme(\n     known_params = build_xsl_params_document(xsl_params)\n \n     # Create a pseudo resolver for this\n-    known_params_url = \'file:///__diazo_known_params__\'\n-    emit_stylesheet_resolver = CustomResolver({\n-        known_params_url: etree.tostring(known_params),\n-    })\n+    known_params_url = "file:///__diazo_known_params__"\n+    emit_stylesheet_resolver = CustomResolver(\n+        {\n+            known_params_url: etree.tostring(known_params),\n+        }\n+    )\n     emit_stylesheet_parser = etree.XMLParser()\n     emit_stylesheet_parser.resolvers.add(emit_stylesheet_resolver)\n \n     # Set up parameters\n     params = {}\n     if indent is not None:\n-        params[\'indent\'] = indent and "\'yes\'" or "\'no\'"\n-    params[\'known_params_url\'] = quote_param(known_params_url)\n-    params[\'runtrace\'] = \'1\' if runtrace else \'0\'\n+        params["indent"] = indent and "\'yes\'" or "\'no\'"\n+    params["known_params_url"] = quote_param(known_params_url)\n+    params["runtrace"] = "1" if runtrace else "0"\n \n     # Run the final stage compiler\n     emit_stylesheet = pkg_xsl(\n-        \'emit-stylesheet.xsl\',\n+        "emit-stylesheet.xsl",\n         parser=emit_stylesheet_parser,\n     )\n     compiled_doc = emit_stylesheet(rules_doc, **params)\n@@ -176,8 +176,7 @@ def compile_theme(\n \n \n def main():\n-    """Called from console script\n-    """\n+    """Called from console script"""\n     parser = _createOptionParser(usage=usage)\n     (options, args) = parser.parse_args()\n \n@@ -185,11 +184,11 @@ def main():\n         if len(args) == 2 and options.theme is None:\n             options.rules, options.theme = args\n         elif len(args) == 1:\n-            options.rules, = args\n+            (options.rules,) = args\n         else:\n-            parser.error(\'Wrong number of arguments.\')\n+            parser.error("Wrong number of arguments.")\n     elif args:\n-        parser.error(\'Wrong number of arguments.\')\n+        parser.error("Wrong number of arguments.")\n \n     if options.trace:\n         logger.setLevel(logging.DEBUG)\n@@ -210,13 +209,13 @@ def main():\n     )\n     root = output_xslt.getroot()\n     if not root.tail:\n-        root.tail = \'\\n\'\n+        root.tail = "\\n"\n     output_xslt.write(\n         options.output,\n-        encoding=\'utf-8\',\n+        encoding="utf-8",\n         pretty_print=options.pretty_print,\n     )\n \n \n-if __name__ == \'__main__\':\n+if __name__ == "__main__":\n     main()\ndiff --git a/lib/diazo/cssrules.py b/src/diazo/cssrules.py\nsimilarity index 61%\nrename from lib/diazo/cssrules.py\nrename to src/diazo/cssrules.py\nindex 34f55ce..c651c50 100644\n--- a/lib/diazo/cssrules.py\n+++ b/src/diazo/cssrules.py\n@@ -1,5 +1,4 @@\n #!/usr/bin/env python\n-# -*- coding: utf-8 -*-\n """\\\n Usage: %prog RULES\n \n@@ -11,7 +10,6 @@\n </rules>\\\n """\n \n-from __future__ import absolute_import\n \n from cssselect import GenericTranslator\n from diazo import utils\n@@ -22,14 +20,14 @@\n import sys\n \n \n-logger = logging.getLogger(\'diazo\')\n+logger = logging.getLogger("diazo")\n usage = __doc__\n \n \n class LocationPathTranslator(GenericTranslator):\n     def xpath_descendant_combinator(self, left, right):\n         """right is a child, grand-child or further descendant of left"""\n-        return left.join(\'//\', right)\n+        return left.join("//", right)\n \n \n _generic_translator = GenericTranslator()\n@@ -37,50 +35,49 @@ def xpath_descendant_combinator(self, left, right):\n \n \n def convert_css_selectors(rules):\n-    """Convert css rules to xpath rules element tree in place\n-    """\n+    """Convert css rules to xpath rules element tree in place"""\n     # XXX: There is a :root pseudo-class  # NOQA: T000\n     # http://www.w3.org/TR/css3-selectors/#root-pseudo\n     # We may wish to add support to lxml.cssselect for it some day.\n     for element in rules.xpath(\n-        "//@*[namespace-uri()=\'{nsp}\']/..".format(nsp=utils.namespaces[\'css\']),\n+        "//@*[namespace-uri()=\'{nsp}\']/..".format(nsp=utils.namespaces["css"]),\n     ):\n         tag_namespace = utils.namespace(element.tag)\n         css_prefix = element.attrib.get(\n             utils.fullname(\n-                utils.namespaces[\'css\'],\n-                \'prefix\',\n+                utils.namespaces["css"],\n+                "prefix",\n             ),\n             None,\n         )\n         for name, value in element.attrib.items():\n             if not name.startswith(\n-                \'{%s}\' % utils.namespaces[\'css\'],  # NOQA: S001\n+                "{%s}" % utils.namespaces["css"],  # NOQA: S001\n             ):\n                 continue\n             localname = utils.localname(name)\n-            if localname == \'prefix\':\n+            if localname == "prefix":\n                 continue\n             if not value:\n-                element.attrib[localname] = \'\'\n+                element.attrib[localname] = ""\n                 continue\n             if (\n-                tag_namespace == utils.namespaces[\'diazo\'] and\n-                localname in\n-                (\n-                    \'content\',\n-                    \'content-children\',\n-                    \'if-content\',\n-                    \'if-not-content\',\n-                ) or (\n-                    tag_namespace == utils.namespaces[\'xsl\'] and\n-                    localname in (\'match\',)\n+                tag_namespace == utils.namespaces["diazo"]\n+                and localname\n+                in (\n+                    "content",\n+                    "content-children",\n+                    "if-content",\n+                    "if-not-content",\n+                )\n+                or (\n+                    tag_namespace == utils.namespaces["xsl"] and localname in ("match",)\n                 )\n             ):\n-                prefix = css_prefix or \'//\'\n+                prefix = css_prefix or "//"\n                 tr = _location_path_translator\n             else:\n-                prefix = css_prefix or \'descendant-or-self::\'\n+                prefix = css_prefix or "descendant-or-self::"\n                 tr = _generic_translator\n             element.attrib[localname] = tr.css_to_xpath(value, prefix=prefix)\n \n@@ -88,33 +85,32 @@ def convert_css_selectors(rules):\n \n \n def main():\n-    """Called from console script\n-    """\n+    """Called from console script"""\n     parser = OptionParser(usage=usage)\n     parser.add_option(\n-        \'-o\',\n-        \'--output\',\n-        metavar=\'output.html\',\n-        help=\'Output filename (instead of stdout)\',\n-        dest=\'output\',\n+        "-o",\n+        "--output",\n+        metavar="output.html",\n+        help="Output filename (instead of stdout)",\n+        dest="output",\n         default=sys.stdout,\n     )\n     parser.add_option(\n-        \'-p\',\n-        \'--pretty-print\',\n-        action=\'store_true\',\n-        help=\'Pretty print output\',\n-        dest=\'pretty_print\',\n+        "-p",\n+        "--pretty-print",\n+        action="store_true",\n+        help="Pretty print output",\n+        dest="pretty_print",\n         default=False,\n     )\n     (options, args) = parser.parse_args()\n \n     if len(args) != 1:\n-        parser.error(\'Invalid number of arguments\')\n+        parser.error("Invalid number of arguments")\n     rules = etree.parse(args[0])\n     convert_css_selectors(rules)\n     rules.write(options.output, pretty_print=options.pretty_print)\n \n \n-if __name__ == \'__main__\':\n+if __name__ == "__main__":\n     main()\ndiff --git a/lib/diazo/debug_resources/diazo-debug.css b/src/diazo/debug_resources/diazo-debug.css\nsimilarity index 100%\nrename from lib/diazo/debug_resources/diazo-debug.css\nrename to src/diazo/debug_resources/diazo-debug.css\ndiff --git a/lib/diazo/debug_resources/diazo-debug.js b/src/diazo/debug_resources/diazo-debug.js\nsimilarity index 100%\nrename from lib/diazo/debug_resources/diazo-debug.js\nrename to src/diazo/debug_resources/diazo-debug.js\ndiff --git a/lib/diazo/debug_resources/iframe.js b/src/diazo/debug_resources/iframe.js\nsimilarity index 100%\nrename from lib/diazo/debug_resources/iframe.js\nrename to src/diazo/debug_resources/iframe.js\ndiff --git a/lib/diazo/debug_resources/jquery-1.8.3.min.js b/src/diazo/debug_resources/jquery-1.8.3.min.js\nsimilarity index 100%\nrename from lib/diazo/debug_resources/jquery-1.8.3.min.js\nrename to src/diazo/debug_resources/jquery-1.8.3.min.js\ndiff --git a/lib/diazo/defaults.xsl b/src/diazo/defaults.xsl\nsimilarity index 100%\nrename from lib/diazo/defaults.xsl\nrename to src/diazo/defaults.xsl\ndiff --git a/lib/diazo/diazo-debug.zcml b/src/diazo/diazo-debug.zcml\nsimilarity index 68%\nrename from lib/diazo/diazo-debug.zcml\nrename to src/diazo/diazo-debug.zcml\nindex 285694a..189dfd8 100644\n--- a/lib/diazo/diazo-debug.zcml\n+++ b/src/diazo/diazo-debug.zcml\n@@ -2,14 +2,16 @@\n     xmlns="http://namespaces.zope.org/zope"\n     xmlns:browser="http://namespaces.zope.org/browser"\n     xmlns:gs="http://namespaces.zope.org/genericsetup"\n-    xmlns:zcml="http://namespaces.zope.org/zcml"\n     xmlns:i18n="http://namespaces.zope.org/i18n"\n     xmlns:plone="http://namespaces.plone.org/plone"\n-    i18n_domain="plone">\n+    xmlns:zcml="http://namespaces.zope.org/zcml"\n+    i18n_domain="plone"\n+    >\n \n-    <!-- Static resources -->\n-    <browser:resourceDirectory\n-        name="diazo-debug"\n-        directory="debug_resources" />\n+  <!-- Static resources -->\n+  <browser:resourceDirectory\n+      name="diazo-debug"\n+      directory="debug_resources"\n+      />\n \n </configure>\ndiff --git a/lib/diazo/dummy.html b/src/diazo/dummy.html\nsimilarity index 100%\nrename from lib/diazo/dummy.html\nrename to src/diazo/dummy.html\ndiff --git a/lib/diazo/emit-stylesheet.xsl b/src/diazo/emit-stylesheet.xsl\nsimilarity index 100%\nrename from lib/diazo/emit-stylesheet.xsl\nrename to src/diazo/emit-stylesheet.xsl\ndiff --git a/lib/diazo/filter.xsl b/src/diazo/filter.xsl\nsimilarity index 100%\nrename from lib/diazo/filter.xsl\nrename to src/diazo/filter.xsl\ndiff --git a/lib/diazo/filter_html.xsl b/src/diazo/filter_html.xsl\nsimilarity index 100%\nrename from lib/diazo/filter_html.xsl\nrename to src/diazo/filter_html.xsl\ndiff --git a/lib/diazo/filter_xhtml.xsl b/src/diazo/filter_xhtml.xsl\nsimilarity index 100%\nrename from lib/diazo/filter_xhtml.xsl\nrename to src/diazo/filter_xhtml.xsl\ndiff --git a/lib/diazo/fixup-themes.xsl b/src/diazo/fixup-themes.xsl\nsimilarity index 100%\nrename from lib/diazo/fixup-themes.xsl\nrename to src/diazo/fixup-themes.xsl\ndiff --git a/lib/diazo/identity.xsl b/src/diazo/identity.xsl\nsimilarity index 100%\nrename from lib/diazo/identity.xsl\nrename to src/diazo/identity.xsl\ndiff --git a/lib/diazo/include.xsl b/src/diazo/include.xsl\nsimilarity index 100%\nrename from lib/diazo/include.xsl\nrename to src/diazo/include.xsl\ndiff --git a/lib/diazo/merge-conditions.xsl b/src/diazo/merge-conditions.xsl\nsimilarity index 100%\nrename from lib/diazo/merge-conditions.xsl\nrename to src/diazo/merge-conditions.xsl\ndiff --git a/lib/diazo/normalize-rules.xsl b/src/diazo/normalize-rules.xsl\nsimilarity index 100%\nrename from lib/diazo/normalize-rules.xsl\nrename to src/diazo/normalize-rules.xsl\ndiff --git a/lib/diazo/rules.py b/src/diazo/rules.py\nsimilarity index 65%\nrename from lib/diazo/rules.py\nrename to src/diazo/rules.py\nindex a42cd42..dfab0e3 100644\n--- a/lib/diazo/rules.py\n+++ b/src/diazo/rules.py\n@@ -1,5 +1,4 @@\n #!/usr/bin/env python\n-# -*- coding: utf-8 -*-\n """\\\n Usage: %prog [-r] RULES\n \n@@ -12,15 +11,14 @@\n from diazo.utils import namespaces\n from diazo.utils import pkg_xsl\n from lxml import etree\n-from six import string_types\n-from six.moves.urllib.parse import urljoin\n-from six.moves.urllib.request import urlopen\n+from urllib.parse import urljoin\n+from urllib.request import urlopen\n \n import logging\n import re\n \n \n-logger = logging.getLogger(\'diazo\')\n+logger = logging.getLogger("diazo")\n usage = __doc__\n \n IMPORT_STYLESHEET = re.compile(\n@@ -33,23 +31,23 @@\n     r"""(?P<url>[^ \\t\\n\\r\\f\\v>]+)(?P<after>(?P=quote)[^>]*?>)""",\n     re.IGNORECASE,\n )\n-SRCSET = re.compile(r\'(?P<descriptors>^\\s*|\\s*,\\s*)(?P<url>[^\\s]*)\')\n+SRCSET = re.compile(r"(?P<descriptors>^\\s*|\\s*,\\s*)(?P<url>[^\\s]*)")\n \n \n-update_transform = pkg_xsl(\'update-namespace.xsl\')\n-normalize_rules = pkg_xsl(\'normalize-rules.xsl\')\n-include = pkg_xsl(\'include.xsl\')\n-apply_conditions = pkg_xsl(\'apply-conditions.xsl\')\n-merge_conditions = pkg_xsl(\'merge-conditions.xsl\')\n-annotate_themes = pkg_xsl(\'annotate-themes.xsl\')\n-annotate_rules = pkg_xsl(\'annotate-rules.xsl\')\n-apply_rules = pkg_xsl(\'apply-rules.xsl\')\n-fixup_themes = pkg_xsl(\'fixup-themes.xsl\')\n+update_transform = pkg_xsl("update-namespace.xsl")\n+normalize_rules = pkg_xsl("normalize-rules.xsl")\n+include = pkg_xsl("include.xsl")\n+apply_conditions = pkg_xsl("apply-conditions.xsl")\n+merge_conditions = pkg_xsl("merge-conditions.xsl")\n+annotate_themes = pkg_xsl("annotate-themes.xsl")\n+annotate_rules = pkg_xsl("annotate-rules.xsl")\n+apply_rules = pkg_xsl("apply-rules.xsl")\n+fixup_themes = pkg_xsl("fixup-themes.xsl")\n \n \n def anchor_safe_urljoin(base, url):\n     """Join the base with the url only when the url doesn\'t start with \'#\'"""\n-    if url.startswith(\'#\'):\n+    if url.startswith("#"):\n         return url\n     else:\n         return urljoin(base, url)\n@@ -59,40 +57,39 @@ def add_identifiers(rules_doc):\n     """Add identifiers to the rules for debugging"""\n     for index, elem in enumerate(\n         rules_doc.xpath(\n-            \'//diazo:rules | //diazo:rules/diazo:*\'\n-            \' | //old1:rules | //old1:rules/old1:*\'\n-            \' | //old2:rules | //old2:rules/old1:*\',\n+            "//diazo:rules | //diazo:rules/diazo:*"\n+            " | //old1:rules | //old1:rules/old1:*"\n+            " | //old2:rules | //old2:rules/old1:*",\n             namespaces=namespaces,\n         ),\n     ):\n         elem.set(\n             fullname(\n-                namespaces[\'xml\'],\n-                \'id\',\n+                namespaces["xml"],\n+                "id",\n             ),\n-            \'r{index}\'.format(index=index),\n+            f"r{index}",\n         )\n     return rules_doc\n \n \n def update_namespace(rules_doc):\n-    """Convert old namespace to new namespace in place\n-    """\n+    """Convert old namespace to new namespace in place"""\n     update = False\n-    for ns in (namespaces[\'old1\'], namespaces[\'old2\']):\n-        if rules_doc.xpath("//*[namespace-uri()=\'{ns:s}\']".format(ns=ns)):\n+    for ns in (namespaces["old1"], namespaces["old2"]):\n+        if rules_doc.xpath(f"//*[namespace-uri()=\'{ns:s}\']"):\n             logger.warning(\n-                \'The %s namespace is deprecated, use %s instead.\',\n+                "The %s namespace is deprecated, use %s instead.",\n                 ns,\n-                namespaces[\'diazo\'],\n+                namespaces["diazo"],\n             )\n             update = True\n-    for ns in (namespaces[\'oldcss1\'], namespaces[\'oldcss2\']):\n-        if rules_doc.xpath("//@*[namespace-uri()=\'{ns:s}\']".format(ns=ns)):\n+    for ns in (namespaces["oldcss1"], namespaces["oldcss2"]):\n+        if rules_doc.xpath(f"//@*[namespace-uri()=\'{ns:s}\']"):\n             logger.warning(\n-                \'The %s namespace is deprecated, use %s instead.\',\n+                "The %s namespace is deprecated, use %s instead.",\n                 ns,\n-                namespaces[\'css\'],\n+                namespaces["css"],\n             )\n             update = True\n     if update:\n@@ -113,14 +110,14 @@ def update_namespace(rules_doc):\n def escape_curly_brackets(theme_doc):\n     for node in theme_doc.iter():\n         for attr in node.attrib:\n-            if \'{\' in node.attrib[attr]:\n-                node.attrib[attr] = node.attrib[attr].replace(\'{\', \'{{\')\n-            if \'}\' in node.attrib[attr]:\n-                node.attrib[attr] = node.attrib[attr].replace(\'}\', \'}}\')\n+            if "{" in node.attrib[attr]:\n+                node.attrib[attr] = node.attrib[attr].replace("{", "{{")\n+            if "}" in node.attrib[attr]:\n+                node.attrib[attr] = node.attrib[attr].replace("}", "}}")\n \n \n def expand_theme(element, theme_doc, absolute_prefix):\n-    prefix = urljoin(absolute_prefix, element.get(\'prefix\', \'\'))\n+    prefix = urljoin(absolute_prefix, element.get("prefix", ""))\n     apply_absolute_prefix(theme_doc, prefix)\n     escape_curly_brackets(theme_doc)\n     theme_root = theme_doc.getroot()\n@@ -138,27 +135,28 @@ def expand_themes(\n     absolute_prefix=None,\n     read_network=False,\n ):\n-    """Expand <theme href=\'...\'/> nodes with the theme html.\n-    """\n+    """Expand <theme href=\'...\'/> nodes with the theme html."""\n     if absolute_prefix is None:\n-        absolute_prefix = \'\'\n+        absolute_prefix = ""\n     base = rules_doc.docinfo.URL\n     if parser is None:\n         parser = etree.HTMLParser()\n     for element in rules_doc.xpath(\n-        \'//diazo:theme[@href]\',\n+        "//diazo:theme[@href]",\n         namespaces=namespaces,\n     ):\n-        url = urljoin(base, element.get(\'href\'))\n-        if not read_network and \\\n-                url.startswith((\'ftp://\', \'ftps://\', \'http://\', \'https://\')):\n+        url = urljoin(base, element.get("href"))\n+        if not read_network and url.startswith(\n+            ("ftp://", "ftps://", "http://", "https://")\n+        ):\n             raise ValueError(\n                 "Supplied theme \'{url}\', but network access denied.".format(\n                     url=url,\n                 ),\n             )\n-        elif read_network and \\\n-                url.startswith((\'ftp://\', \'ftps://\', \'http://\', \'https://\')):\n+        elif read_network and url.startswith(\n+            ("ftp://", "ftps://", "http://", "https://")\n+        ):\n             theme = urlopen(url)\n         else:\n             theme = url\n@@ -170,51 +168,58 @@ def expand_themes(\n def apply_absolute_prefix(theme_doc, absolute_prefix):\n     if not absolute_prefix:\n         return\n-    if not absolute_prefix.endswith(\'/\'):\n-        absolute_prefix = absolute_prefix + \'/\'\n-    for node in theme_doc.xpath(\'//*[@src]\'):\n-        url = urljoin(absolute_prefix, node.get(\'src\'))\n-        node.set(\'src\', url)\n+    if not absolute_prefix.endswith("/"):\n+        absolute_prefix = absolute_prefix + "/"\n+    for node in theme_doc.xpath("//*[@src]"):\n+        url = urljoin(absolute_prefix, node.get("src"))\n+        node.set("src", url)\n     for xlink_attr in theme_doc.xpath(\'//@*[local-name()="xlink:href"]\'):\n         node = xlink_attr.getparent()\n-        url = anchor_safe_urljoin(absolute_prefix, node.get(\'xlink:href\'))\n-        node.set(\'xlink:href\', url)\n-    for node in theme_doc.xpath(\'//*[@srcset]\'):\n-        srcset = node.get(\'srcset\')\n+        url = anchor_safe_urljoin(absolute_prefix, node.get("xlink:href"))\n+        node.set("xlink:href", url)\n+    for node in theme_doc.xpath("//*[@srcset]"):\n+        srcset = node.get("srcset")\n         srcset = SRCSET.sub(\n-            lambda match: match.group(\'descriptors\') + urljoin(\n+            lambda match: match.group("descriptors")\n+            + urljoin(\n                 absolute_prefix,\n-                match.group(\'url\'),\n+                match.group("url"),\n             ),\n             srcset,\n         )\n-        node.set(\'srcset\', srcset)\n-    for node in theme_doc.xpath(\'//*[@href]\'):\n-        url = anchor_safe_urljoin(absolute_prefix, node.get(\'href\'))\n-        node.set(\'href\', url)\n-    for node in theme_doc.xpath(\'//style\'):\n+        node.set("srcset", srcset)\n+    for node in theme_doc.xpath("//*[@href]"):\n+        url = anchor_safe_urljoin(absolute_prefix, node.get("href"))\n+        node.set("href", url)\n+    for node in theme_doc.xpath("//style"):\n         if node.text is None:\n             continue\n         node.text = IMPORT_STYLESHEET.sub(\n-            lambda match: match.group(\'before\') + urljoin(\n+            lambda match: match.group("before")\n+            + urljoin(\n                 absolute_prefix,\n-                match.group(\'url\'),\n-            ) + match.group(\'after\'),\n+                match.group("url"),\n+            )\n+            + match.group("after"),\n             node.text,\n         )\n     for node in theme_doc.xpath(\'//comment()[starts-with(., "[if")]\'):\n         node.text = IMPORT_STYLESHEET.sub(\n-            lambda match: match.group(\'before\') + urljoin(\n+            lambda match: match.group("before")\n+            + urljoin(\n                 absolute_prefix,\n-                match.group(\'url\'),\n-            ) + match.group(\'after\'),\n+                match.group("url"),\n+            )\n+            + match.group("after"),\n             node.text,\n         )\n         node.text = CONDITIONAL_SRC.sub(\n-            lambda match: match.group(\'before\') + urljoin(\n+            lambda match: match.group("before")\n+            + urljoin(\n                 absolute_prefix,\n-                match.group(\'url\'),\n-            ) + match.group(\'after\'),\n+                match.group("url"),\n+            )\n+            + match.group("after"),\n             node.text,\n         )\n \n@@ -222,7 +227,7 @@ def apply_absolute_prefix(theme_doc, absolute_prefix):\n def add_extra(rules_doc, extra):\n     root = rules_doc.getroot()\n     extra_elements = extra.xpath(\n-        \'/xsl:stylesheet/xsl:*\',\n+        "/xsl:stylesheet/xsl:*",\n         namespaces=namespaces,\n     )\n     root.extend(extra_elements)\n@@ -236,20 +241,22 @@ def add_theme(\n     absolute_prefix=None,\n     read_network=False,\n ):\n-    if not read_network and \\\n-            isinstance(theme, string_types) and \\\n-            theme[:6] in (\'ftp://\', \'http:/\', \'https:\'):\n+    if (\n+        not read_network\n+        and isinstance(theme, str)\n+        and theme[:6] in ("ftp://", "http:/", "https:")\n+    ):\n         raise ValueError(\n             "Supplied theme \'{theme}\', but network access denied.".format(\n                 theme=theme,\n             ),\n         )\n     if absolute_prefix is None:\n-        absolute_prefix = \'\'\n+        absolute_prefix = ""\n     if parser is None:\n         parser = etree.HTMLParser()\n     root = rules_doc.getroot()\n-    element = root.makeelement(fullname(namespaces[\'diazo\'], \'theme\'))\n+    element = root.makeelement(fullname(namespaces["diazo"], "theme"))\n     root.append(element)\n     theme_doc = etree.parse(theme, parser=parser)\n     expand_theme(element, theme_doc, absolute_prefix)\n@@ -262,9 +269,9 @@ def fixup_theme_comment_selectors(rules):\n     selector needs rewriting to replace comment() with xsl:comment\n     """\n     for element in rules.xpath("//@theme[contains(., \'comment()\')]/.."):\n-        element.attrib[\'theme\'] = element.attrib[\'theme\'].replace(\n-            \'comment()\',\n-            \'xsl:comment\',\n+        element.attrib["theme"] = element.attrib["theme"].replace(\n+            "comment()",\n+            "xsl:comment",\n         )\n     return rules\n \n@@ -285,9 +292,9 @@ def process_rules(\n     stop=None,\n ):\n     if trace:\n-        trace = \'1\'\n+        trace = "1"\n     else:\n-        trace = \'0\'\n+        trace = "0"\n     if rules_parser is None:\n         rules_parser = etree.XMLParser(recover=False)\n     rules_doc = etree.parse(rules, parser=rules_parser)\n@@ -302,7 +309,7 @@ def process_rules(\n     if stop == 1:\n         return rules_doc\n     rules_doc = add_identifiers(rules_doc)\n-    if stop == 2 or stop == \'add_identifiers\':\n+    if stop == 2 or stop == "add_identifiers":\n         return rules_doc\n     if update:\n         rules_doc = update_namespace(rules_doc)\n@@ -327,8 +334,8 @@ def process_rules(\n     if stop == 6:\n         return rules_doc\n     if includemode is None:\n-        includemode = \'document\'\n-    includemode = "\'{mode:s}\'".format(mode=includemode)\n+        includemode = "document"\n+    includemode = f"\'{includemode:s}\'"\n     rules_doc = normalize_rules(rules_doc, includemode=includemode)\n     if stop == 7:\n         return rules_doc\n@@ -355,16 +362,15 @@ def process_rules(\n \n \n def main():\n-    """Called from console script\n-    """\n+    """Called from console script"""\n     parser = _createOptionParser(usage=usage)\n     parser.add_option(\n-        \'-s\',\n-        \'--stop\',\n-        metavar=\'n\',\n-        type=\'int\',\n-        help=\'Stop preprocessing at stage n\',\n-        dest=\'stop\',\n+        "-s",\n+        "--stop",\n+        metavar="n",\n+        type="int",\n+        help="Stop preprocessing at stage n",\n+        dest="stop",\n         default=None,\n     )\n     (options, args) = parser.parse_args()\n@@ -373,11 +379,11 @@ def main():\n         if len(args) == 2 and options.theme is None:\n             options.rules, options.theme = args\n         elif len(args) == 1:\n-            options.rules, = args\n+            (options.rules,) = args\n         else:\n-            parser.error(\'Wrong number of arguments.\')\n+            parser.error("Wrong number of arguments.")\n     elif args:\n-        parser.error(\'Wrong number of arguments.\')\n+        parser.error("Wrong number of arguments.")\n \n     if options.trace:\n         logger.setLevel(logging.DEBUG)\n@@ -394,9 +400,9 @@ def main():\n     )\n     root = rules_doc.getroot()\n     if not root.tail:\n-        root.tail = \'\\n\'\n+        root.tail = "\\n"\n     rules_doc.write(options.output, pretty_print=options.pretty_print)\n \n \n-if __name__ == \'__main__\':\n+if __name__ == "__main__":\n     main()\ndiff --git a/lib/diazo/run.py b/src/diazo/run.py\nsimilarity index 70%\nrename from lib/diazo/run.py\nrename to src/diazo/run.py\nindex 62264a7..5d1a9f5 100644\n--- a/lib/diazo/run.py\n+++ b/src/diazo/run.py\n@@ -1,5 +1,4 @@\n #!/usr/bin/env python\n-# -*- coding: utf-8 -*-\n """\\\n Usage: %prog -x TRANSFORM CONTENT\n \n@@ -16,7 +15,6 @@\n from diazo.utils import quote_param\n from diazo.utils import split_params\n from lxml import etree\n-from six import string_types\n \n import diazo.runtrace\n import logging\n@@ -24,7 +22,7 @@\n import sys\n \n \n-logger = logging.getLogger(\'diazo\')\n+logger = logging.getLogger("diazo")\n usage = __doc__\n \n \n@@ -35,7 +33,7 @@ def __init__(self, directory):\n     def resolve(self, url, id, context):\n         # libxml2 does not do this correctly on it\'s own with the HTMLParser\n         # but it does work in Apache\n-        if \'://\' in url or url.startswith(\'/\'):\n+        if "://" in url or url.startswith("/"):\n             # It seems we must explicitly resolve the url here\n             return self.resolve_filename(url, context)\n         url = os.path.join(self.directory, url)\n@@ -43,63 +41,62 @@ def resolve(self, url, id, context):\n \n \n def main():\n-    """Called from console script\n-    """\n+    """Called from console script"""\n     op = _createOptionParser(usage=usage)\n     op.add_option(\n-        \'-x\',\n-        \'--xsl\',\n-        metavar=\'transform.xsl\',\n-        help=\'XSL transform\',\n-        dest=\'xsl\',\n+        "-x",\n+        "--xsl",\n+        metavar="transform.xsl",\n+        help="XSL transform",\n+        dest="xsl",\n         default=None,\n     )\n     op.add_option(\n-        \'--path\',\n-        metavar=\'PATH\',\n-        help=\'URI path\',\n-        dest=\'path\',\n+        "--path",\n+        metavar="PATH",\n+        help="URI path",\n+        dest="path",\n         default=None,\n     )\n     op.add_option(\n-        \'--parameters\',\n-        metavar=\'param1=val1,param2=val2\',\n-        help=\'Set the values of arbitrary parameters\',\n-        dest=\'parameters\',\n+        "--parameters",\n+        metavar="param1=val1,param2=val2",\n+        help="Set the values of arbitrary parameters",\n+        dest="parameters",\n         default=None,\n     )\n     op.add_option(\n-        \'--runtrace-xml\',\n-        metavar=\'runtrace.xml\',\n-        help=\'Write an xml format runtrace to file\',\n-        dest=\'runtrace_xml\',\n+        "--runtrace-xml",\n+        metavar="runtrace.xml",\n+        help="Write an xml format runtrace to file",\n+        dest="runtrace_xml",\n         default=None,\n     )\n     op.add_option(\n-        \'--runtrace-html\',\n-        metavar=\'runtrace.html\',\n-        help=\'Write an html format runtrace to file\',\n-        dest=\'runtrace_html\',\n+        "--runtrace-html",\n+        metavar="runtrace.html",\n+        help="Write an html format runtrace to file",\n+        dest="runtrace_html",\n         default=None,\n     )\n     (options, args) = op.parse_args()\n \n     if len(args) > 2:\n-        op.error(\'Wrong number of arguments.\')\n+        op.error("Wrong number of arguments.")\n     elif len(args) == 2:\n         if options.xsl or options.rules:\n-            op.error(\'Wrong number of arguments.\')\n+            op.error("Wrong number of arguments.")\n         path, content = args\n-        if path.lower().endswith(\'.xsl\'):\n+        if path.lower().endswith(".xsl"):\n             options.xsl = path\n         else:\n             options.rules = path\n     elif len(args) == 1:\n-        content, = args\n+        (content,) = args\n     else:\n-        op.error(\'Wrong number of arguments.\')\n+        op.error("Wrong number of arguments.")\n     if options.rules is None and options.xsl is None:\n-        op.error(\'Must supply either options or rules\')\n+        op.error("Must supply either options or rules")\n \n     if options.trace:\n         logger.setLevel(logging.DEBUG)\n@@ -131,7 +128,7 @@ def main():\n             runtrace=runtrace,\n         )\n \n-    if content == \'-\':\n+    if content == "-":\n         content = sys.stdin\n \n     if options.read_network:\n@@ -143,15 +140,15 @@ def main():\n     content_doc = etree.parse(content, parser=parser)\n     params = {}\n     if options.path is not None:\n-        params[\'path\'] = "\'{path}\'".format(path=options.path)\n+        params["path"] = f"\'{options.path}\'"\n \n     if options.parameters:\n         for key, value in split_params(options.parameters).items():\n             params[key] = quote_param(value)\n \n     output_html = transform(content_doc, **params)\n-    if isinstance(options.output, string_types):\n-        out = open(options.output, \'wt\')\n+    if isinstance(options.output, str):\n+        out = open(options.output, "w")\n     else:\n         out = options.output\n     out.write(str(output_html))\n@@ -162,26 +159,26 @@ def main():\n             error_log=transform.error_log,\n         )\n         if options.runtrace_xml:\n-            if options.runtrace_xml == \'-\':\n+            if options.runtrace_xml == "-":\n                 out = sys.stdout\n             else:\n-                out = open(options.runtrace_xml, \'wt\')\n+                out = open(options.runtrace_xml, "w")\n             runtrace_doc.write(\n                 out,\n-                encoding=\'utf-8\',\n+                encoding="utf-8",\n                 pretty_print=options.pretty_print,\n             )\n         if options.runtrace_html:\n-            if options.runtrace_html == \'-\':\n+            if options.runtrace_html == "-":\n                 out = sys.stdout\n             else:\n-                out = open(options.runtrace_html, \'wt\')\n+                out = open(options.runtrace_html, "w")\n             out.write(str(diazo.runtrace.runtrace_to_html(runtrace_doc)))\n \n     for msg in transform.error_log:\n-        if not msg.message.startswith(\'<runtrace \'):\n+        if not msg.message.startswith("<runtrace "):\n             logger.warn(msg)\n \n \n-if __name__ == \'__main__\':\n+if __name__ == "__main__":\n     main()\ndiff --git a/src/diazo/runtrace.py b/src/diazo/runtrace.py\nnew file mode 100644\nindex 0000000..ec3de65\n--- /dev/null\n+++ b/src/diazo/runtrace.py\n@@ -0,0 +1,146 @@\n+#!/usr/bin/env python\n+\n+from diazo.rules import process_rules\n+from diazo.utils import pkg_xsl\n+from lxml import etree\n+\n+import logging\n+\n+\n+logger = logging.getLogger("diazo")\n+\n+_runtrace_to_html = pkg_xsl("runtrace_to_html.xsl")\n+\n+\n+def log_to_xml_string(error_log):\n+    msgs = [log.message for log in error_log if log.message.startswith("<runtrace ")]\n+    return """\n+<runtrace xmlns:css="http://namespaces.plone.org/diazo/css">\n+    {message:s}\n+</runtrace>\n+""".format(\n+        message="".join(msgs)\n+    )\n+\n+\n+def generate_runtrace(rules, error_log, rules_parser=None):\n+    """Annotate a rules file with the results of a transformation"""\n+\n+    def condition_name(trace):\n+        """Generate attribute name for this entry"""\n+        for k in trace.attrib.keys():\n+            if k == "theme_xmlid":\n+                continue\n+            if k.startswith("{http://namespaces.plone.org/diazo/css}"):\n+                continue\n+            return "runtrace-" + k\n+\n+    rules_doc = process_rules(\n+        rules,\n+        rules_parser=rules_parser,\n+        stop="add_identifiers",\n+    )\n+    trace_doc = etree.XML(log_to_xml_string(error_log))\n+\n+    for trace in trace_doc.xpath("/runtrace/runtrace"):\n+        for el in rules_doc.xpath("id(\'" + trace.attrib["theme_xmlid"] + "\')"):\n+            el.set(condition_name(trace), trace.text or "")\n+    return rules_doc\n+\n+\n+def runtrace_to_html(runtrace_doc):\n+    """Convert the runtrace document into HTML"""\n+    return _runtrace_to_html(runtrace_doc)\n+\n+\n+def error_log_to_html(error_log):\n+    """Convert an error log into an HTML representation"""\n+    doc = etree.Element("ul")\n+    for log in error_log:\n+        if log.message.startswith("<runtrace "):\n+            continue\n+        el = etree.Element("li")\n+        el.attrib["class"] = (\n+            "domain_{domain_name} level_{level_name} type_{type_name}".format(  # NOQA: E501\n+                domain_name=log.domain_name,\n+                level_name=log.level_name,\n+                type_name=log.type_name,\n+            )\n+        )\n+        el.text = "{msg:s} [{line:d}:{column:d}]".format(\n+            msg=log.message,\n+            line=log.line,\n+            column=log.column,\n+        )\n+        doc.append(el)\n+    return doc\n+\n+\n+def generate_debug_html(\n+    base_url,\n+    rules=None,\n+    error_log=None,\n+    rules_parser=None,\n+):\n+    """Generate an HTML node with debug info"""\n+\n+    def newElement(tag, content, **kwargs):\n+        n = etree.Element(tag, **kwargs)\n+        if getattr(content, "tag", None):\n+            n.append(content)\n+        else:\n+            n.text = content\n+        return n\n+\n+    debug_output_iframe = etree.Element("div", id="diazo-debug-iframe")\n+    debug_output_iframe.attrib["style"] = "display:none"\n+    debug_output_iframe.attrib["data-iframe"] = "diazo-debug"\n+    debug_output_iframe.attrib["data-iframe-style"] = ""\n+    debug_output_iframe.attrib["data-iframe-position"] = "bottom"\n+    debug_output_iframe.attrib["data-iframe-resources"] = (\n+        base_url\n+        + "/diazo-debug.css;"\n+        + base_url\n+        + "/jquery-1.8.3.min.js;"\n+        + base_url\n+        + "/diazo-debug.js"\n+    )\n+    debug_output = etree.Element("div", id="diazo-debug")\n+\n+    if error_log:\n+        debug_output.append(\n+            newElement(\n+                "section",\n+                error_log_to_html(error_log),\n+                id="diazo_error_log",\n+            ),\n+        )\n+\n+    try:\n+        runtrace_doc = generate_runtrace(rules, error_log, rules_parser)\n+        debug_output.append(\n+            newElement(\n+                "section",\n+                runtrace_to_html(runtrace_doc).getroot(),\n+                id="diazo_runtrace",\n+            ),\n+        )\n+    except etree.XMLSyntaxError:\n+        debug_output.append(\n+            newElement(\n+                "section",\n+                "Rules document could not be parsed!",\n+                id="diazo_runtrace",\n+            ),\n+        )\n+\n+    debug_output_iframe.append(debug_output)\n+    debug_output_iframe.append(\n+        newElement(\n+            "script",\n+            " ",\n+            text="text/javascript",\n+            src=base_url + "/iframe.js",\n+        ),\n+    )\n+    return debug_output_iframe\ndiff --git a/lib/diazo/runtrace_to_html.xsl b/src/diazo/runtrace_to_html.xsl\nsimilarity index 100%\nrename from lib/diazo/runtrace_to_html.xsl\nrename to src/diazo/runtrace_to_html.xsl\ndiff --git a/lib/diazo/tests/__init__.py b/src/diazo/tests/__init__.py\nsimilarity index 92%\nrename from lib/diazo/tests/__init__.py\nrename to src/diazo/tests/__init__.py\nindex c77d1f7..c7fd5ab 100644\n--- a/lib/diazo/tests/__init__.py\n+++ b/src/diazo/tests/__init__.py\n@@ -1,12 +1,10 @@\n-# -*- coding: utf-8 -*-\n-\n-\n def alltests():\n     from diazo.tests import test_diazo\n     from diazo.tests import test_trace\n     from diazo.tests import test_wsgi\n \n     import unittest\n+\n     modules = [\n         test_trace,\n         test_wsgi,\ndiff --git a/lib/diazo/tests/absolute-prefix-disabled/content.html b/src/diazo/tests/absolute-prefix-disabled/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-disabled/content.html\nrename to src/diazo/tests/absolute-prefix-disabled/content.html\ndiff --git a/lib/diazo/tests/absolute-prefix-disabled/options.cfg b/src/diazo/tests/absolute-prefix-disabled/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-disabled/options.cfg\nrename to src/diazo/tests/absolute-prefix-disabled/options.cfg\ndiff --git a/lib/diazo/tests/absolute-prefix-disabled/output.html b/src/diazo/tests/absolute-prefix-disabled/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-disabled/output.html\nrename to src/diazo/tests/absolute-prefix-disabled/output.html\ndiff --git a/lib/diazo/tests/absolute-prefix-disabled/rules.xml b/src/diazo/tests/absolute-prefix-disabled/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-disabled/rules.xml\nrename to src/diazo/tests/absolute-prefix-disabled/rules.xml\ndiff --git a/lib/diazo/tests/absolute-prefix-disabled/theme.html b/src/diazo/tests/absolute-prefix-disabled/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-disabled/theme.html\nrename to src/diazo/tests/absolute-prefix-disabled/theme.html\ndiff --git a/lib/diazo/tests/absolute-prefix-ie-conditional-comments/content.html b/src/diazo/tests/absolute-prefix-ie-conditional-comments/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-ie-conditional-comments/content.html\nrename to src/diazo/tests/absolute-prefix-ie-conditional-comments/content.html\ndiff --git a/lib/diazo/tests/absolute-prefix-ie-conditional-comments/options.cfg b/src/diazo/tests/absolute-prefix-ie-conditional-comments/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-ie-conditional-comments/options.cfg\nrename to src/diazo/tests/absolute-prefix-ie-conditional-comments/options.cfg\ndiff --git a/lib/diazo/tests/absolute-prefix-ie-conditional-comments/output.html b/src/diazo/tests/absolute-prefix-ie-conditional-comments/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-ie-conditional-comments/output.html\nrename to src/diazo/tests/absolute-prefix-ie-conditional-comments/output.html\ndiff --git a/lib/diazo/tests/absolute-prefix-ie-conditional-comments/rules.xml b/src/diazo/tests/absolute-prefix-ie-conditional-comments/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-ie-conditional-comments/rules.xml\nrename to src/diazo/tests/absolute-prefix-ie-conditional-comments/rules.xml\ndiff --git a/lib/diazo/tests/absolute-prefix-ie-conditional-comments/theme.html b/src/diazo/tests/absolute-prefix-ie-conditional-comments/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix-ie-conditional-comments/theme.html\nrename to src/diazo/tests/absolute-prefix-ie-conditional-comments/theme.html\ndiff --git a/lib/diazo/tests/absolute-prefix/content.html b/src/diazo/tests/absolute-prefix/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix/content.html\nrename to src/diazo/tests/absolute-prefix/content.html\ndiff --git a/lib/diazo/tests/absolute-prefix/options.cfg b/src/diazo/tests/absolute-prefix/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix/options.cfg\nrename to src/diazo/tests/absolute-prefix/options.cfg\ndiff --git a/lib/diazo/tests/absolute-prefix/output.html b/src/diazo/tests/absolute-prefix/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix/output.html\nrename to src/diazo/tests/absolute-prefix/output.html\ndiff --git a/lib/diazo/tests/absolute-prefix/rules.xml b/src/diazo/tests/absolute-prefix/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix/rules.xml\nrename to src/diazo/tests/absolute-prefix/rules.xml\ndiff --git a/lib/diazo/tests/absolute-prefix/theme.html b/src/diazo/tests/absolute-prefix/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/absolute-prefix/theme.html\nrename to src/diazo/tests/absolute-prefix/theme.html\ndiff --git a/lib/diazo/tests/allow-curly-brackets/README.rst b/src/diazo/tests/allow-curly-brackets/README.rst\nsimilarity index 100%\nrename from lib/diazo/tests/allow-curly-brackets/README.rst\nrename to src/diazo/tests/allow-curly-brackets/README.rst\ndiff --git a/lib/diazo/tests/allow-curly-brackets/content.html b/src/diazo/tests/allow-curly-brackets/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/allow-curly-brackets/content.html\nrename to src/diazo/tests/allow-curly-brackets/content.html\ndiff --git a/lib/diazo/tests/allow-curly-brackets/output.html b/src/diazo/tests/allow-curly-brackets/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/allow-curly-brackets/output.html\nrename to src/diazo/tests/allow-curly-brackets/output.html\ndiff --git a/lib/diazo/tests/allow-curly-brackets/rules.xml b/src/diazo/tests/allow-curly-brackets/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/allow-curly-brackets/rules.xml\nrename to src/diazo/tests/allow-curly-brackets/rules.xml\ndiff --git a/lib/diazo/tests/allow-curly-brackets/theme.html b/src/diazo/tests/allow-curly-brackets/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/allow-curly-brackets/theme.html\nrename to src/diazo/tests/allow-curly-brackets/theme.html\ndiff --git a/lib/diazo/tests/append/content.html b/src/diazo/tests/append/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/append/content.html\nrename to src/diazo/tests/append/content.html\ndiff --git a/lib/diazo/tests/append/output.html b/src/diazo/tests/append/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/append/output.html\nrename to src/diazo/tests/append/output.html\ndiff --git a/lib/diazo/tests/append/rules.xml b/src/diazo/tests/append/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/append/rules.xml\nrename to src/diazo/tests/append/rules.xml\ndiff --git a/lib/diazo/tests/append/theme.html b/src/diazo/tests/append/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/append/theme.html\nrename to src/diazo/tests/append/theme.html\ndiff --git a/lib/diazo/tests/append/xpaths.txt b/src/diazo/tests/append/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/append/xpaths.txt\nrename to src/diazo/tests/append/xpaths.txt\ndiff --git a/lib/diazo/tests/before-content-conditional/content.html b/src/diazo/tests/before-content-conditional/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/before-content-conditional/content.html\nrename to src/diazo/tests/before-content-conditional/content.html\ndiff --git a/lib/diazo/tests/before-content-conditional/output.html b/src/diazo/tests/before-content-conditional/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/before-content-conditional/output.html\nrename to src/diazo/tests/before-content-conditional/output.html\ndiff --git a/lib/diazo/tests/before-content-conditional/rules.xml b/src/diazo/tests/before-content-conditional/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/before-content-conditional/rules.xml\nrename to src/diazo/tests/before-content-conditional/rules.xml\ndiff --git a/lib/diazo/tests/before-content-conditional/theme.html b/src/diazo/tests/before-content-conditional/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/before-content-conditional/theme.html\nrename to src/diazo/tests/before-content-conditional/theme.html\ndiff --git a/lib/diazo/tests/before-prepend-append-after/content.html b/src/diazo/tests/before-prepend-append-after/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/before-prepend-append-after/content.html\nrename to src/diazo/tests/before-prepend-append-after/content.html\ndiff --git a/lib/diazo/tests/before-prepend-append-after/output.html b/src/diazo/tests/before-prepend-append-after/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/before-prepend-append-after/output.html\nrename to src/diazo/tests/before-prepend-append-after/output.html\ndiff --git a/lib/diazo/tests/before-prepend-append-after/rules.xml b/src/diazo/tests/before-prepend-append-after/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/before-prepend-append-after/rules.xml\nrename to src/diazo/tests/before-prepend-append-after/rules.xml\ndiff --git a/lib/diazo/tests/before-prepend-append-after/theme.html b/src/diazo/tests/before-prepend-append-after/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/before-prepend-append-after/theme.html\nrename to src/diazo/tests/before-prepend-append-after/theme.html\ndiff --git a/lib/diazo/tests/comments-outside-root-tag/content.html b/src/diazo/tests/comments-outside-root-tag/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/comments-outside-root-tag/content.html\nrename to src/diazo/tests/comments-outside-root-tag/content.html\ndiff --git a/lib/diazo/tests/comments-outside-root-tag/output.html b/src/diazo/tests/comments-outside-root-tag/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/comments-outside-root-tag/output.html\nrename to src/diazo/tests/comments-outside-root-tag/output.html\ndiff --git a/lib/diazo/tests/comments-outside-root-tag/rules.xml b/src/diazo/tests/comments-outside-root-tag/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/comments-outside-root-tag/rules.xml\nrename to src/diazo/tests/comments-outside-root-tag/rules.xml\ndiff --git a/lib/diazo/tests/comments-outside-root-tag/theme.html b/src/diazo/tests/comments-outside-root-tag/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/comments-outside-root-tag/theme.html\nrename to src/diazo/tests/comments-outside-root-tag/theme.html\ndiff --git a/lib/diazo/tests/comments/content.html b/src/diazo/tests/comments/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/comments/content.html\nrename to src/diazo/tests/comments/content.html\ndiff --git a/lib/diazo/tests/comments/output.html b/src/diazo/tests/comments/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/comments/output.html\nrename to src/diazo/tests/comments/output.html\ndiff --git a/lib/diazo/tests/comments/rules.xml b/src/diazo/tests/comments/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/comments/rules.xml\nrename to src/diazo/tests/comments/rules.xml\ndiff --git a/lib/diazo/tests/comments/theme.html b/src/diazo/tests/comments/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/comments/theme.html\nrename to src/diazo/tests/comments/theme.html\ndiff --git a/lib/diazo/tests/comments/xpaths.txt b/src/diazo/tests/comments/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/comments/xpaths.txt\nrename to src/diazo/tests/comments/xpaths.txt\ndiff --git a/lib/diazo/tests/conditional-content-rules-with-variable/content.html b/src/diazo/tests/conditional-content-rules-with-variable/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-content-rules-with-variable/content.html\nrename to src/diazo/tests/conditional-content-rules-with-variable/content.html\ndiff --git a/lib/diazo/tests/conditional-content-rules-with-variable/output.html b/src/diazo/tests/conditional-content-rules-with-variable/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-content-rules-with-variable/output.html\nrename to src/diazo/tests/conditional-content-rules-with-variable/output.html\ndiff --git a/lib/diazo/tests/conditional-content-rules-with-variable/rules.xml b/src/diazo/tests/conditional-content-rules-with-variable/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-content-rules-with-variable/rules.xml\nrename to src/diazo/tests/conditional-content-rules-with-variable/rules.xml\ndiff --git a/lib/diazo/tests/conditional-content-rules-with-variable/theme.html b/src/diazo/tests/conditional-content-rules-with-variable/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-content-rules-with-variable/theme.html\nrename to src/diazo/tests/conditional-content-rules-with-variable/theme.html\ndiff --git a/lib/diazo/tests/conditional-drop-in-append-1/content.html b/src/diazo/tests/conditional-drop-in-append-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-drop-in-append-1/content.html\nrename to src/diazo/tests/conditional-drop-in-append-1/content.html\ndiff --git a/lib/diazo/tests/conditional-drop-in-append-1/output.html b/src/diazo/tests/conditional-drop-in-append-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-drop-in-append-1/output.html\nrename to src/diazo/tests/conditional-drop-in-append-1/output.html\ndiff --git a/lib/diazo/tests/conditional-drop-in-append-1/rules.xml b/src/diazo/tests/conditional-drop-in-append-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-drop-in-append-1/rules.xml\nrename to src/diazo/tests/conditional-drop-in-append-1/rules.xml\ndiff --git a/lib/diazo/tests/conditional-drop-in-append-1/theme.html b/src/diazo/tests/conditional-drop-in-append-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-drop-in-append-1/theme.html\nrename to src/diazo/tests/conditional-drop-in-append-1/theme.html\ndiff --git a/lib/diazo/tests/conditional-drop-in-append-2/content.html b/src/diazo/tests/conditional-drop-in-append-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-drop-in-append-2/content.html\nrename to src/diazo/tests/conditional-drop-in-append-2/content.html\ndiff --git a/lib/diazo/tests/conditional-drop-in-append-2/output.html b/src/diazo/tests/conditional-drop-in-append-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-drop-in-append-2/output.html\nrename to src/diazo/tests/conditional-drop-in-append-2/output.html\ndiff --git a/lib/diazo/tests/conditional-drop-in-append-2/rules.xml b/src/diazo/tests/conditional-drop-in-append-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-drop-in-append-2/rules.xml\nrename to src/diazo/tests/conditional-drop-in-append-2/rules.xml\ndiff --git a/lib/diazo/tests/conditional-drop-in-append-2/theme.html b/src/diazo/tests/conditional-drop-in-append-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-drop-in-append-2/theme.html\nrename to src/diazo/tests/conditional-drop-in-append-2/theme.html\ndiff --git a/lib/diazo/tests/conditional-include-content/content.html b/src/diazo/tests/conditional-include-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-include-content/content.html\nrename to src/diazo/tests/conditional-include-content/content.html\ndiff --git a/lib/diazo/tests/conditional-include-content/output.html b/src/diazo/tests/conditional-include-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-include-content/output.html\nrename to src/diazo/tests/conditional-include-content/output.html\ndiff --git a/lib/diazo/tests/conditional-include-content/rules.xml b/src/diazo/tests/conditional-include-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-include-content/rules.xml\nrename to src/diazo/tests/conditional-include-content/rules.xml\ndiff --git a/lib/diazo/tests/conditional-include-content/theme.html b/src/diazo/tests/conditional-include-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-include-content/theme.html\nrename to src/diazo/tests/conditional-include-content/theme.html\ndiff --git a/lib/diazo/tests/conditional-rules-1/content.html b/src/diazo/tests/conditional-rules-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-1/content.html\nrename to src/diazo/tests/conditional-rules-1/content.html\ndiff --git a/lib/diazo/tests/conditional-rules-1/output.html b/src/diazo/tests/conditional-rules-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-1/output.html\nrename to src/diazo/tests/conditional-rules-1/output.html\ndiff --git a/lib/diazo/tests/conditional-rules-1/rules.xml b/src/diazo/tests/conditional-rules-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-1/rules.xml\nrename to src/diazo/tests/conditional-rules-1/rules.xml\ndiff --git a/lib/diazo/tests/conditional-rules-1/theme.html b/src/diazo/tests/conditional-rules-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-1/theme.html\nrename to src/diazo/tests/conditional-rules-1/theme.html\ndiff --git a/lib/diazo/tests/conditional-rules-1/xpaths.txt b/src/diazo/tests/conditional-rules-1/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-1/xpaths.txt\nrename to src/diazo/tests/conditional-rules-1/xpaths.txt\ndiff --git a/lib/diazo/tests/conditional-rules-2/content.html b/src/diazo/tests/conditional-rules-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-2/content.html\nrename to src/diazo/tests/conditional-rules-2/content.html\ndiff --git a/lib/diazo/tests/conditional-rules-2/output.html b/src/diazo/tests/conditional-rules-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-2/output.html\nrename to src/diazo/tests/conditional-rules-2/output.html\ndiff --git a/lib/diazo/tests/conditional-rules-2/rules.xml b/src/diazo/tests/conditional-rules-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-2/rules.xml\nrename to src/diazo/tests/conditional-rules-2/rules.xml\ndiff --git a/lib/diazo/tests/conditional-rules-2/theme.html b/src/diazo/tests/conditional-rules-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-2/theme.html\nrename to src/diazo/tests/conditional-rules-2/theme.html\ndiff --git a/lib/diazo/tests/conditional-rules-2/xpaths.txt b/src/diazo/tests/conditional-rules-2/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/conditional-rules-2/xpaths.txt\nrename to src/diazo/tests/conditional-rules-2/xpaths.txt\ndiff --git a/lib/diazo/tests/copy-xsl/content.html b/src/diazo/tests/copy-xsl/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/copy-xsl/content.html\nrename to src/diazo/tests/copy-xsl/content.html\ndiff --git a/lib/diazo/tests/copy-xsl/output.html b/src/diazo/tests/copy-xsl/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/copy-xsl/output.html\nrename to src/diazo/tests/copy-xsl/output.html\ndiff --git a/lib/diazo/tests/copy-xsl/rules.xml b/src/diazo/tests/copy-xsl/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/copy-xsl/rules.xml\nrename to src/diazo/tests/copy-xsl/rules.xml\ndiff --git a/lib/diazo/tests/copy-xsl/theme.html b/src/diazo/tests/copy-xsl/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/copy-xsl/theme.html\nrename to src/diazo/tests/copy-xsl/theme.html\ndiff --git a/lib/diazo/tests/copy/README.rst b/src/diazo/tests/copy/README.rst\nsimilarity index 100%\nrename from lib/diazo/tests/copy/README.rst\nrename to src/diazo/tests/copy/README.rst\ndiff --git a/lib/diazo/tests/copy/content.html b/src/diazo/tests/copy/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/copy/content.html\nrename to src/diazo/tests/copy/content.html\ndiff --git a/lib/diazo/tests/copy/output.html b/src/diazo/tests/copy/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/copy/output.html\nrename to src/diazo/tests/copy/output.html\ndiff --git a/lib/diazo/tests/copy/rules.xml b/src/diazo/tests/copy/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/copy/rules.xml\nrename to src/diazo/tests/copy/rules.xml\ndiff --git a/lib/diazo/tests/copy/theme.html b/src/diazo/tests/copy/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/copy/theme.html\nrename to src/diazo/tests/copy/theme.html\ndiff --git a/lib/diazo/tests/copy/xpaths.txt b/src/diazo/tests/copy/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/copy/xpaths.txt\nrename to src/diazo/tests/copy/xpaths.txt\ndiff --git a/lib/diazo/tests/css-prefix/content.html b/src/diazo/tests/css-prefix/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/css-prefix/content.html\nrename to src/diazo/tests/css-prefix/content.html\ndiff --git a/lib/diazo/tests/css-prefix/output.html b/src/diazo/tests/css-prefix/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/css-prefix/output.html\nrename to src/diazo/tests/css-prefix/output.html\ndiff --git a/lib/diazo/tests/css-prefix/rules.xml b/src/diazo/tests/css-prefix/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/css-prefix/rules.xml\nrename to src/diazo/tests/css-prefix/rules.xml\ndiff --git a/lib/diazo/tests/css-prefix/theme.html b/src/diazo/tests/css-prefix/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/css-prefix/theme.html\nrename to src/diazo/tests/css-prefix/theme.html\ndiff --git a/lib/diazo/tests/css-xpath-child-selectors/content.html b/src/diazo/tests/css-xpath-child-selectors/content.html\nsimilarity index 84%\nrename from lib/diazo/tests/css-xpath-child-selectors/content.html\nrename to src/diazo/tests/css-xpath-child-selectors/content.html\nindex 83787c9..f1fb295 100644\n--- a/lib/diazo/tests/css-xpath-child-selectors/content.html\n+++ b/src/diazo/tests/css-xpath-child-selectors/content.html\n@@ -10,6 +10,6 @@ <h2>Smaller Title</h2>\n             <p>content</p>\n             <span class="replace">new item from content</span>\n         </div>\n-        <div class="replace">Someting very great from last content\'s DIV</div>\n+        <div class="replace">Something very great from last content\'s DIV</div>\n     </body>\n </html>\ndiff --git a/lib/diazo/tests/css-xpath-child-selectors/output.html b/src/diazo/tests/css-xpath-child-selectors/output.html\nsimilarity index 89%\nrename from lib/diazo/tests/css-xpath-child-selectors/output.html\nrename to src/diazo/tests/css-xpath-child-selectors/output.html\nindex 3352e84..a910a37 100644\n--- a/lib/diazo/tests/css-xpath-child-selectors/output.html\n+++ b/src/diazo/tests/css-xpath-child-selectors/output.html\n@@ -6,7 +6,7 @@\n   </head>\n   <body>\n     <div>\n-      <div class="replace">Someting very great from last content\'s DIV</div>\n+      <div class="replace">Something very great from last content\'s DIV</div>\n     </div>\n     <div>\n             <span>Third Marker</span>\ndiff --git a/lib/diazo/tests/css-xpath-child-selectors/rules.xml b/src/diazo/tests/css-xpath-child-selectors/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/css-xpath-child-selectors/rules.xml\nrename to src/diazo/tests/css-xpath-child-selectors/rules.xml\ndiff --git a/lib/diazo/tests/css-xpath-child-selectors/theme.html b/src/diazo/tests/css-xpath-child-selectors/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/css-xpath-child-selectors/theme.html\nrename to src/diazo/tests/css-xpath-child-selectors/theme.html\ndiff --git a/lib/diazo/tests/css-xsl-template/content.html b/src/diazo/tests/css-xsl-template/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/css-xsl-template/content.html\nrename to src/diazo/tests/css-xsl-template/content.html\ndiff --git a/lib/diazo/tests/css-xsl-template/output.html b/src/diazo/tests/css-xsl-template/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/css-xsl-template/output.html\nrename to src/diazo/tests/css-xsl-template/output.html\ndiff --git a/lib/diazo/tests/css-xsl-template/rules.xml b/src/diazo/tests/css-xsl-template/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/css-xsl-template/rules.xml\nrename to src/diazo/tests/css-xsl-template/rules.xml\ndiff --git a/lib/diazo/tests/css-xsl-template/theme.html b/src/diazo/tests/css-xsl-template/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/css-xsl-template/theme.html\nrename to src/diazo/tests/css-xsl-template/theme.html\ndiff --git a/lib/diazo/tests/default-options.cfg b/src/diazo/tests/default-options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/default-options.cfg\nrename to src/diazo/tests/default-options.cfg\ndiff --git a/lib/diazo/tests/document-includes/content.html b/src/diazo/tests/document-includes/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/document-includes/content.html\nrename to src/diazo/tests/document-includes/content.html\ndiff --git a/lib/diazo/tests/document-includes/extra.html b/src/diazo/tests/document-includes/extra.html\nsimilarity index 100%\nrename from lib/diazo/tests/document-includes/extra.html\nrename to src/diazo/tests/document-includes/extra.html\ndiff --git a/lib/diazo/tests/document-includes/output.html b/src/diazo/tests/document-includes/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/document-includes/output.html\nrename to src/diazo/tests/document-includes/output.html\ndiff --git a/lib/diazo/tests/document-includes/rules.xml b/src/diazo/tests/document-includes/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/document-includes/rules.xml\nrename to src/diazo/tests/document-includes/rules.xml\ndiff --git a/lib/diazo/tests/document-includes/theme.html b/src/diazo/tests/document-includes/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/document-includes/theme.html\nrename to src/diazo/tests/document-includes/theme.html\ndiff --git a/lib/diazo/tests/document-includes/xpaths.txt b/src/diazo/tests/document-includes/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/document-includes/xpaths.txt\nrename to src/diazo/tests/document-includes/xpaths.txt\ndiff --git a/lib/diazo/tests/drop-content-comment/content.html b/src/diazo/tests/drop-content-comment/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content-comment/content.html\nrename to src/diazo/tests/drop-content-comment/content.html\ndiff --git a/lib/diazo/tests/drop-content-comment/output.html b/src/diazo/tests/drop-content-comment/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content-comment/output.html\nrename to src/diazo/tests/drop-content-comment/output.html\ndiff --git a/lib/diazo/tests/drop-content-comment/rules.xml b/src/diazo/tests/drop-content-comment/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content-comment/rules.xml\nrename to src/diazo/tests/drop-content-comment/rules.xml\ndiff --git a/lib/diazo/tests/drop-content-comment/theme.html b/src/diazo/tests/drop-content-comment/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content-comment/theme.html\nrename to src/diazo/tests/drop-content-comment/theme.html\ndiff --git a/lib/diazo/tests/drop-content/content.html b/src/diazo/tests/drop-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content/content.html\nrename to src/diazo/tests/drop-content/content.html\ndiff --git a/lib/diazo/tests/drop-content/output.html b/src/diazo/tests/drop-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content/output.html\nrename to src/diazo/tests/drop-content/output.html\ndiff --git a/lib/diazo/tests/drop-content/rules.xml b/src/diazo/tests/drop-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content/rules.xml\nrename to src/diazo/tests/drop-content/rules.xml\ndiff --git a/lib/diazo/tests/drop-content/theme.html b/src/diazo/tests/drop-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content/theme.html\nrename to src/diazo/tests/drop-content/theme.html\ndiff --git a/lib/diazo/tests/drop-content/xpaths.txt b/src/diazo/tests/drop-content/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/drop-content/xpaths.txt\nrename to src/diazo/tests/drop-content/xpaths.txt\ndiff --git a/lib/diazo/tests/drop-replace/content.html b/src/diazo/tests/drop-replace/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-replace/content.html\nrename to src/diazo/tests/drop-replace/content.html\ndiff --git a/lib/diazo/tests/drop-replace/output.html b/src/diazo/tests/drop-replace/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-replace/output.html\nrename to src/diazo/tests/drop-replace/output.html\ndiff --git a/lib/diazo/tests/drop-replace/rules.xml b/src/diazo/tests/drop-replace/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/drop-replace/rules.xml\nrename to src/diazo/tests/drop-replace/rules.xml\ndiff --git a/lib/diazo/tests/drop-replace/theme.html b/src/diazo/tests/drop-replace/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-replace/theme.html\nrename to src/diazo/tests/drop-replace/theme.html\ndiff --git a/lib/diazo/tests/drop-theme-children/content.html b/src/diazo/tests/drop-theme-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-theme-children/content.html\nrename to src/diazo/tests/drop-theme-children/content.html\ndiff --git a/lib/diazo/tests/drop-theme-children/output.html b/src/diazo/tests/drop-theme-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-theme-children/output.html\nrename to src/diazo/tests/drop-theme-children/output.html\ndiff --git a/lib/diazo/tests/drop-theme-children/rules.xml b/src/diazo/tests/drop-theme-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/drop-theme-children/rules.xml\nrename to src/diazo/tests/drop-theme-children/rules.xml\ndiff --git a/lib/diazo/tests/drop-theme-children/theme.html b/src/diazo/tests/drop-theme-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-theme-children/theme.html\nrename to src/diazo/tests/drop-theme-children/theme.html\ndiff --git a/lib/diazo/tests/drop-theme-comment/content.html b/src/diazo/tests/drop-theme-comment/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-theme-comment/content.html\nrename to src/diazo/tests/drop-theme-comment/content.html\ndiff --git a/lib/diazo/tests/drop-theme-comment/output.html b/src/diazo/tests/drop-theme-comment/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-theme-comment/output.html\nrename to src/diazo/tests/drop-theme-comment/output.html\ndiff --git a/lib/diazo/tests/drop-theme-comment/rules.xml b/src/diazo/tests/drop-theme-comment/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/drop-theme-comment/rules.xml\nrename to src/diazo/tests/drop-theme-comment/rules.xml\ndiff --git a/lib/diazo/tests/drop-theme-comment/theme.html b/src/diazo/tests/drop-theme-comment/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/drop-theme-comment/theme.html\nrename to src/diazo/tests/drop-theme-comment/theme.html\ndiff --git a/lib/diazo/tests/empty-xmlns/README.txt b/src/diazo/tests/empty-xmlns/README.txt\nsimilarity index 100%\nrename from lib/diazo/tests/empty-xmlns/README.txt\nrename to src/diazo/tests/empty-xmlns/README.txt\ndiff --git a/lib/diazo/tests/empty-xmlns/content.html b/src/diazo/tests/empty-xmlns/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/empty-xmlns/content.html\nrename to src/diazo/tests/empty-xmlns/content.html\ndiff --git a/lib/diazo/tests/empty-xmlns/output.html b/src/diazo/tests/empty-xmlns/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/empty-xmlns/output.html\nrename to src/diazo/tests/empty-xmlns/output.html\ndiff --git a/lib/diazo/tests/empty-xmlns/rules.xml b/src/diazo/tests/empty-xmlns/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/empty-xmlns/rules.xml\nrename to src/diazo/tests/empty-xmlns/rules.xml\ndiff --git a/lib/diazo/tests/empty-xmlns/theme.html b/src/diazo/tests/empty-xmlns/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/empty-xmlns/theme.html\nrename to src/diazo/tests/empty-xmlns/theme.html\ndiff --git a/lib/diazo/tests/entities/content.html b/src/diazo/tests/entities/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/entities/content.html\nrename to src/diazo/tests/entities/content.html\ndiff --git a/lib/diazo/tests/entities/output.html b/src/diazo/tests/entities/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/entities/output.html\nrename to src/diazo/tests/entities/output.html\ndiff --git a/lib/diazo/tests/entities/rules.xml b/src/diazo/tests/entities/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/entities/rules.xml\nrename to src/diazo/tests/entities/rules.xml\ndiff --git a/lib/diazo/tests/entities/theme.html b/src/diazo/tests/entities/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/entities/theme.html\nrename to src/diazo/tests/entities/theme.html\ndiff --git a/lib/diazo/tests/esi/content.html b/src/diazo/tests/esi/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/esi/content.html\nrename to src/diazo/tests/esi/content.html\ndiff --git a/lib/diazo/tests/esi/output.html b/src/diazo/tests/esi/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/esi/output.html\nrename to src/diazo/tests/esi/output.html\ndiff --git a/lib/diazo/tests/esi/rules.xml b/src/diazo/tests/esi/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/esi/rules.xml\nrename to src/diazo/tests/esi/rules.xml\ndiff --git a/lib/diazo/tests/esi/theme.html b/src/diazo/tests/esi/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/esi/theme.html\nrename to src/diazo/tests/esi/theme.html\ndiff --git a/lib/diazo/tests/esi/xpaths.txt b/src/diazo/tests/esi/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/esi/xpaths.txt\nrename to src/diazo/tests/esi/xpaths.txt\ndiff --git a/lib/diazo/tests/html-attributes/content.html b/src/diazo/tests/html-attributes/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-attributes/content.html\nrename to src/diazo/tests/html-attributes/content.html\ndiff --git a/lib/diazo/tests/html-attributes/output.html b/src/diazo/tests/html-attributes/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-attributes/output.html\nrename to src/diazo/tests/html-attributes/output.html\ndiff --git a/lib/diazo/tests/html-attributes/rules.xml b/src/diazo/tests/html-attributes/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/html-attributes/rules.xml\nrename to src/diazo/tests/html-attributes/rules.xml\ndiff --git a/lib/diazo/tests/html-attributes/theme.html b/src/diazo/tests/html-attributes/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-attributes/theme.html\nrename to src/diazo/tests/html-attributes/theme.html\ndiff --git a/lib/diazo/tests/html-xml-lang-2/content.html b/src/diazo/tests/html-xml-lang-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang-2/content.html\nrename to src/diazo/tests/html-xml-lang-2/content.html\ndiff --git a/lib/diazo/tests/html-xml-lang-2/output.html b/src/diazo/tests/html-xml-lang-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang-2/output.html\nrename to src/diazo/tests/html-xml-lang-2/output.html\ndiff --git a/lib/diazo/tests/html-xml-lang-2/rules.xml b/src/diazo/tests/html-xml-lang-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang-2/rules.xml\nrename to src/diazo/tests/html-xml-lang-2/rules.xml\ndiff --git a/lib/diazo/tests/html-xml-lang-2/theme.html b/src/diazo/tests/html-xml-lang-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang-2/theme.html\nrename to src/diazo/tests/html-xml-lang-2/theme.html\ndiff --git a/lib/diazo/tests/html-xml-lang-3/content.html b/src/diazo/tests/html-xml-lang-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang-3/content.html\nrename to src/diazo/tests/html-xml-lang-3/content.html\ndiff --git a/lib/diazo/tests/html-xml-lang-3/output.html b/src/diazo/tests/html-xml-lang-3/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang-3/output.html\nrename to src/diazo/tests/html-xml-lang-3/output.html\ndiff --git a/lib/diazo/tests/html-xml-lang-3/rules.xml b/src/diazo/tests/html-xml-lang-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang-3/rules.xml\nrename to src/diazo/tests/html-xml-lang-3/rules.xml\ndiff --git a/lib/diazo/tests/html-xml-lang-3/theme.html b/src/diazo/tests/html-xml-lang-3/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang-3/theme.html\nrename to src/diazo/tests/html-xml-lang-3/theme.html\ndiff --git a/lib/diazo/tests/html-xml-lang/content.html b/src/diazo/tests/html-xml-lang/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang/content.html\nrename to src/diazo/tests/html-xml-lang/content.html\ndiff --git a/lib/diazo/tests/html-xml-lang/output.html b/src/diazo/tests/html-xml-lang/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang/output.html\nrename to src/diazo/tests/html-xml-lang/output.html\ndiff --git a/lib/diazo/tests/html-xml-lang/rules.xml b/src/diazo/tests/html-xml-lang/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang/rules.xml\nrename to src/diazo/tests/html-xml-lang/rules.xml\ndiff --git a/lib/diazo/tests/html-xml-lang/theme.html b/src/diazo/tests/html-xml-lang/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/html-xml-lang/theme.html\nrename to src/diazo/tests/html-xml-lang/theme.html\ndiff --git a/lib/diazo/tests/if-path-1/content.html b/src/diazo/tests/if-path-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-1/content.html\nrename to src/diazo/tests/if-path-1/content.html\ndiff --git a/lib/diazo/tests/if-path-1/options.cfg b/src/diazo/tests/if-path-1/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-1/options.cfg\nrename to src/diazo/tests/if-path-1/options.cfg\ndiff --git a/lib/diazo/tests/if-path-1/output.html b/src/diazo/tests/if-path-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-1/output.html\nrename to src/diazo/tests/if-path-1/output.html\ndiff --git a/lib/diazo/tests/if-path-1/rules.xml b/src/diazo/tests/if-path-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-1/rules.xml\nrename to src/diazo/tests/if-path-1/rules.xml\ndiff --git a/lib/diazo/tests/if-path-1/theme.html b/src/diazo/tests/if-path-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-1/theme.html\nrename to src/diazo/tests/if-path-1/theme.html\ndiff --git a/lib/diazo/tests/if-path-2/content.html b/src/diazo/tests/if-path-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-2/content.html\nrename to src/diazo/tests/if-path-2/content.html\ndiff --git a/lib/diazo/tests/if-path-2/options.cfg b/src/diazo/tests/if-path-2/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-2/options.cfg\nrename to src/diazo/tests/if-path-2/options.cfg\ndiff --git a/lib/diazo/tests/if-path-2/output.html b/src/diazo/tests/if-path-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-2/output.html\nrename to src/diazo/tests/if-path-2/output.html\ndiff --git a/lib/diazo/tests/if-path-2/rules.xml b/src/diazo/tests/if-path-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-2/rules.xml\nrename to src/diazo/tests/if-path-2/rules.xml\ndiff --git a/lib/diazo/tests/if-path-2/theme.html b/src/diazo/tests/if-path-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-2/theme.html\nrename to src/diazo/tests/if-path-2/theme.html\ndiff --git a/lib/diazo/tests/if-path-3/content.html b/src/diazo/tests/if-path-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-3/content.html\nrename to src/diazo/tests/if-path-3/content.html\ndiff --git a/lib/diazo/tests/if-path-3/options.cfg b/src/diazo/tests/if-path-3/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-3/options.cfg\nrename to src/diazo/tests/if-path-3/options.cfg\ndiff --git a/lib/diazo/tests/if-path-3/output.html b/src/diazo/tests/if-path-3/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-3/output.html\nrename to src/diazo/tests/if-path-3/output.html\ndiff --git a/lib/diazo/tests/if-path-3/rules.xml b/src/diazo/tests/if-path-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-3/rules.xml\nrename to src/diazo/tests/if-path-3/rules.xml\ndiff --git a/lib/diazo/tests/if-path-3/theme.html b/src/diazo/tests/if-path-3/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-3/theme.html\nrename to src/diazo/tests/if-path-3/theme.html\ndiff --git a/lib/diazo/tests/if-path-4/content.html b/src/diazo/tests/if-path-4/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-4/content.html\nrename to src/diazo/tests/if-path-4/content.html\ndiff --git a/lib/diazo/tests/if-path-4/options.cfg b/src/diazo/tests/if-path-4/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-4/options.cfg\nrename to src/diazo/tests/if-path-4/options.cfg\ndiff --git a/lib/diazo/tests/if-path-4/output.html b/src/diazo/tests/if-path-4/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-4/output.html\nrename to src/diazo/tests/if-path-4/output.html\ndiff --git a/lib/diazo/tests/if-path-4/rules.xml b/src/diazo/tests/if-path-4/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-4/rules.xml\nrename to src/diazo/tests/if-path-4/rules.xml\ndiff --git a/lib/diazo/tests/if-path-4/theme.html b/src/diazo/tests/if-path-4/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-4/theme.html\nrename to src/diazo/tests/if-path-4/theme.html\ndiff --git a/lib/diazo/tests/if-path-5/content.html b/src/diazo/tests/if-path-5/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-5/content.html\nrename to src/diazo/tests/if-path-5/content.html\ndiff --git a/lib/diazo/tests/if-path-5/options.cfg b/src/diazo/tests/if-path-5/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-5/options.cfg\nrename to src/diazo/tests/if-path-5/options.cfg\ndiff --git a/lib/diazo/tests/if-path-5/output.html b/src/diazo/tests/if-path-5/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-5/output.html\nrename to src/diazo/tests/if-path-5/output.html\ndiff --git a/lib/diazo/tests/if-path-5/rules.xml b/src/diazo/tests/if-path-5/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-5/rules.xml\nrename to src/diazo/tests/if-path-5/rules.xml\ndiff --git a/lib/diazo/tests/if-path-5/theme.html b/src/diazo/tests/if-path-5/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-5/theme.html\nrename to src/diazo/tests/if-path-5/theme.html\ndiff --git a/lib/diazo/tests/if-path-6/content.html b/src/diazo/tests/if-path-6/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-6/content.html\nrename to src/diazo/tests/if-path-6/content.html\ndiff --git a/lib/diazo/tests/if-path-6/options.cfg b/src/diazo/tests/if-path-6/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-6/options.cfg\nrename to src/diazo/tests/if-path-6/options.cfg\ndiff --git a/lib/diazo/tests/if-path-6/output.html b/src/diazo/tests/if-path-6/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-6/output.html\nrename to src/diazo/tests/if-path-6/output.html\ndiff --git a/lib/diazo/tests/if-path-6/rules.xml b/src/diazo/tests/if-path-6/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-6/rules.xml\nrename to src/diazo/tests/if-path-6/rules.xml\ndiff --git a/lib/diazo/tests/if-path-6/theme.html b/src/diazo/tests/if-path-6/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-6/theme.html\nrename to src/diazo/tests/if-path-6/theme.html\ndiff --git a/lib/diazo/tests/if-path-7/content.html b/src/diazo/tests/if-path-7/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-7/content.html\nrename to src/diazo/tests/if-path-7/content.html\ndiff --git a/lib/diazo/tests/if-path-7/options.cfg b/src/diazo/tests/if-path-7/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-7/options.cfg\nrename to src/diazo/tests/if-path-7/options.cfg\ndiff --git a/lib/diazo/tests/if-path-7/output.html b/src/diazo/tests/if-path-7/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-7/output.html\nrename to src/diazo/tests/if-path-7/output.html\ndiff --git a/lib/diazo/tests/if-path-7/rules.xml b/src/diazo/tests/if-path-7/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-7/rules.xml\nrename to src/diazo/tests/if-path-7/rules.xml\ndiff --git a/lib/diazo/tests/if-path-7/theme.html b/src/diazo/tests/if-path-7/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-7/theme.html\nrename to src/diazo/tests/if-path-7/theme.html\ndiff --git a/lib/diazo/tests/if-path-8/content.html b/src/diazo/tests/if-path-8/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-8/content.html\nrename to src/diazo/tests/if-path-8/content.html\ndiff --git a/lib/diazo/tests/if-path-8/options.cfg b/src/diazo/tests/if-path-8/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-8/options.cfg\nrename to src/diazo/tests/if-path-8/options.cfg\ndiff --git a/lib/diazo/tests/if-path-8/output.html b/src/diazo/tests/if-path-8/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-8/output.html\nrename to src/diazo/tests/if-path-8/output.html\ndiff --git a/lib/diazo/tests/if-path-8/rules.xml b/src/diazo/tests/if-path-8/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-8/rules.xml\nrename to src/diazo/tests/if-path-8/rules.xml\ndiff --git a/lib/diazo/tests/if-path-8/theme.html b/src/diazo/tests/if-path-8/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/if-path-8/theme.html\nrename to src/diazo/tests/if-path-8/theme.html\ndiff --git a/lib/diazo/tests/include-content/content.html b/src/diazo/tests/include-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/include-content/content.html\nrename to src/diazo/tests/include-content/content.html\ndiff --git a/lib/diazo/tests/include-content/extra.html b/src/diazo/tests/include-content/extra.html\nsimilarity index 100%\nrename from lib/diazo/tests/include-content/extra.html\nrename to src/diazo/tests/include-content/extra.html\ndiff --git a/lib/diazo/tests/include-content/output.html b/src/diazo/tests/include-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/include-content/output.html\nrename to src/diazo/tests/include-content/output.html\ndiff --git a/lib/diazo/tests/include-content/rules.xml b/src/diazo/tests/include-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/include-content/rules.xml\nrename to src/diazo/tests/include-content/rules.xml\ndiff --git a/lib/diazo/tests/include-content/theme.html b/src/diazo/tests/include-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/include-content/theme.html\nrename to src/diazo/tests/include-content/theme.html\ndiff --git a/lib/diazo/tests/indent-off/content.html b/src/diazo/tests/indent-off/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/indent-off/content.html\nrename to src/diazo/tests/indent-off/content.html\ndiff --git a/lib/diazo/tests/indent-off/options.cfg b/src/diazo/tests/indent-off/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/indent-off/options.cfg\nrename to src/diazo/tests/indent-off/options.cfg\ndiff --git a/lib/diazo/tests/indent-off/output.html b/src/diazo/tests/indent-off/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/indent-off/output.html\nrename to src/diazo/tests/indent-off/output.html\ndiff --git a/lib/diazo/tests/indent-off/rules.xml b/src/diazo/tests/indent-off/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/indent-off/rules.xml\nrename to src/diazo/tests/indent-off/rules.xml\ndiff --git a/lib/diazo/tests/indent-off/theme.html b/src/diazo/tests/indent-off/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/indent-off/theme.html\nrename to src/diazo/tests/indent-off/theme.html\ndiff --git a/lib/diazo/tests/inline-xsl-apply-templates/content.html b/src/diazo/tests/inline-xsl-apply-templates/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/inline-xsl-apply-templates/content.html\nrename to src/diazo/tests/inline-xsl-apply-templates/content.html\ndiff --git a/lib/diazo/tests/inline-xsl-apply-templates/output.html b/src/diazo/tests/inline-xsl-apply-templates/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/inline-xsl-apply-templates/output.html\nrename to src/diazo/tests/inline-xsl-apply-templates/output.html\ndiff --git a/lib/diazo/tests/inline-xsl-apply-templates/rules.xml b/src/diazo/tests/inline-xsl-apply-templates/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/inline-xsl-apply-templates/rules.xml\nrename to src/diazo/tests/inline-xsl-apply-templates/rules.xml\ndiff --git a/lib/diazo/tests/inline-xsl-apply-templates/theme.html b/src/diazo/tests/inline-xsl-apply-templates/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/inline-xsl-apply-templates/theme.html\nrename to src/diazo/tests/inline-xsl-apply-templates/theme.html\ndiff --git a/lib/diazo/tests/inline-xsl-directives/content.html b/src/diazo/tests/inline-xsl-directives/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/inline-xsl-directives/content.html\nrename to src/diazo/tests/inline-xsl-directives/content.html\ndiff --git a/lib/diazo/tests/inline-xsl-directives/output.html b/src/diazo/tests/inline-xsl-directives/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/inline-xsl-directives/output.html\nrename to src/diazo/tests/inline-xsl-directives/output.html\ndiff --git a/lib/diazo/tests/inline-xsl-directives/rules.xml b/src/diazo/tests/inline-xsl-directives/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/inline-xsl-directives/rules.xml\nrename to src/diazo/tests/inline-xsl-directives/rules.xml\ndiff --git a/lib/diazo/tests/inline-xsl-directives/theme.html b/src/diazo/tests/inline-xsl-directives/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/inline-xsl-directives/theme.html\nrename to src/diazo/tests/inline-xsl-directives/theme.html\ndiff --git a/lib/diazo/tests/modify-theme/content.html b/src/diazo/tests/modify-theme/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/modify-theme/content.html\nrename to src/diazo/tests/modify-theme/content.html\ndiff --git a/lib/diazo/tests/modify-theme/output.html b/src/diazo/tests/modify-theme/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/modify-theme/output.html\nrename to src/diazo/tests/modify-theme/output.html\ndiff --git a/lib/diazo/tests/modify-theme/rules.xml b/src/diazo/tests/modify-theme/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/modify-theme/rules.xml\nrename to src/diazo/tests/modify-theme/rules.xml\ndiff --git a/lib/diazo/tests/modify-theme/theme.html b/src/diazo/tests/modify-theme/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/modify-theme/theme.html\nrename to src/diazo/tests/modify-theme/theme.html\ndiff --git a/lib/diazo/tests/modify-theme/xpaths.txt b/src/diazo/tests/modify-theme/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/modify-theme/xpaths.txt\nrename to src/diazo/tests/modify-theme/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-copy-1/content.html b/src/diazo/tests/multi-copy-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-1/content.html\nrename to src/diazo/tests/multi-copy-1/content.html\ndiff --git a/lib/diazo/tests/multi-copy-1/rules.xml b/src/diazo/tests/multi-copy-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-1/rules.xml\nrename to src/diazo/tests/multi-copy-1/rules.xml\ndiff --git a/lib/diazo/tests/multi-copy-1/theme.html b/src/diazo/tests/multi-copy-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-1/theme.html\nrename to src/diazo/tests/multi-copy-1/theme.html\ndiff --git a/lib/diazo/tests/multi-copy-1/xpaths.txt b/src/diazo/tests/multi-copy-1/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-1/xpaths.txt\nrename to src/diazo/tests/multi-copy-1/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-copy-2/content.html b/src/diazo/tests/multi-copy-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-2/content.html\nrename to src/diazo/tests/multi-copy-2/content.html\ndiff --git a/lib/diazo/tests/multi-copy-2/rules.xml b/src/diazo/tests/multi-copy-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-2/rules.xml\nrename to src/diazo/tests/multi-copy-2/rules.xml\ndiff --git a/lib/diazo/tests/multi-copy-2/theme.html b/src/diazo/tests/multi-copy-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-2/theme.html\nrename to src/diazo/tests/multi-copy-2/theme.html\ndiff --git a/lib/diazo/tests/multi-copy-2/xpaths.txt b/src/diazo/tests/multi-copy-2/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-2/xpaths.txt\nrename to src/diazo/tests/multi-copy-2/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-copy-3/content.html b/src/diazo/tests/multi-copy-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-3/content.html\nrename to src/diazo/tests/multi-copy-3/content.html\ndiff --git a/lib/diazo/tests/multi-copy-3/rules.xml b/src/diazo/tests/multi-copy-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-3/rules.xml\nrename to src/diazo/tests/multi-copy-3/rules.xml\ndiff --git a/lib/diazo/tests/multi-copy-3/theme.html b/src/diazo/tests/multi-copy-3/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-3/theme.html\nrename to src/diazo/tests/multi-copy-3/theme.html\ndiff --git a/lib/diazo/tests/multi-copy-3/xpaths.txt b/src/diazo/tests/multi-copy-3/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-3/xpaths.txt\nrename to src/diazo/tests/multi-copy-3/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-copy-4/content.html b/src/diazo/tests/multi-copy-4/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-4/content.html\nrename to src/diazo/tests/multi-copy-4/content.html\ndiff --git a/lib/diazo/tests/multi-copy-4/rules.xml b/src/diazo/tests/multi-copy-4/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-4/rules.xml\nrename to src/diazo/tests/multi-copy-4/rules.xml\ndiff --git a/lib/diazo/tests/multi-copy-4/theme.html b/src/diazo/tests/multi-copy-4/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-4/theme.html\nrename to src/diazo/tests/multi-copy-4/theme.html\ndiff --git a/lib/diazo/tests/multi-copy-4/xpaths.txt b/src/diazo/tests/multi-copy-4/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/multi-copy-4/xpaths.txt\nrename to src/diazo/tests/multi-copy-4/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-replace-1/content.html b/src/diazo/tests/multi-replace-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-1/content.html\nrename to src/diazo/tests/multi-replace-1/content.html\ndiff --git a/lib/diazo/tests/multi-replace-1/rules.xml b/src/diazo/tests/multi-replace-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-1/rules.xml\nrename to src/diazo/tests/multi-replace-1/rules.xml\ndiff --git a/lib/diazo/tests/multi-replace-1/theme.html b/src/diazo/tests/multi-replace-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-1/theme.html\nrename to src/diazo/tests/multi-replace-1/theme.html\ndiff --git a/lib/diazo/tests/multi-replace-1/xpaths.txt b/src/diazo/tests/multi-replace-1/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-1/xpaths.txt\nrename to src/diazo/tests/multi-replace-1/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-replace-2/content.html b/src/diazo/tests/multi-replace-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-2/content.html\nrename to src/diazo/tests/multi-replace-2/content.html\ndiff --git a/lib/diazo/tests/multi-replace-2/rules.xml b/src/diazo/tests/multi-replace-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-2/rules.xml\nrename to src/diazo/tests/multi-replace-2/rules.xml\ndiff --git a/lib/diazo/tests/multi-replace-2/theme.html b/src/diazo/tests/multi-replace-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-2/theme.html\nrename to src/diazo/tests/multi-replace-2/theme.html\ndiff --git a/lib/diazo/tests/multi-replace-2/xpaths.txt b/src/diazo/tests/multi-replace-2/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-2/xpaths.txt\nrename to src/diazo/tests/multi-replace-2/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-replace-3/content.html b/src/diazo/tests/multi-replace-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-3/content.html\nrename to src/diazo/tests/multi-replace-3/content.html\ndiff --git a/lib/diazo/tests/multi-replace-3/rules.xml b/src/diazo/tests/multi-replace-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-3/rules.xml\nrename to src/diazo/tests/multi-replace-3/rules.xml\ndiff --git a/lib/diazo/tests/multi-replace-3/theme.html b/src/diazo/tests/multi-replace-3/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-3/theme.html\nrename to src/diazo/tests/multi-replace-3/theme.html\ndiff --git a/lib/diazo/tests/multi-replace-3/xpaths.txt b/src/diazo/tests/multi-replace-3/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-3/xpaths.txt\nrename to src/diazo/tests/multi-replace-3/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-replace-4/content.html b/src/diazo/tests/multi-replace-4/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-4/content.html\nrename to src/diazo/tests/multi-replace-4/content.html\ndiff --git a/lib/diazo/tests/multi-replace-4/rules.xml b/src/diazo/tests/multi-replace-4/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-4/rules.xml\nrename to src/diazo/tests/multi-replace-4/rules.xml\ndiff --git a/lib/diazo/tests/multi-replace-4/theme.html b/src/diazo/tests/multi-replace-4/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-4/theme.html\nrename to src/diazo/tests/multi-replace-4/theme.html\ndiff --git a/lib/diazo/tests/multi-replace-4/xpaths.txt b/src/diazo/tests/multi-replace-4/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/multi-replace-4/xpaths.txt\nrename to src/diazo/tests/multi-replace-4/xpaths.txt\ndiff --git a/lib/diazo/tests/multi-theme-1/content.html b/src/diazo/tests/multi-theme-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-1/content.html\nrename to src/diazo/tests/multi-theme-1/content.html\ndiff --git a/lib/diazo/tests/multi-theme-1/options.cfg b/src/diazo/tests/multi-theme-1/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-1/options.cfg\nrename to src/diazo/tests/multi-theme-1/options.cfg\ndiff --git a/lib/diazo/tests/multi-theme-1/output.html b/src/diazo/tests/multi-theme-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-1/output.html\nrename to src/diazo/tests/multi-theme-1/output.html\ndiff --git a/lib/diazo/tests/multi-theme-1/rules.xml b/src/diazo/tests/multi-theme-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-1/rules.xml\nrename to src/diazo/tests/multi-theme-1/rules.xml\ndiff --git a/lib/diazo/tests/multi-theme-1/theme1.html b/src/diazo/tests/multi-theme-1/theme1.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-1/theme1.html\nrename to src/diazo/tests/multi-theme-1/theme1.html\ndiff --git a/lib/diazo/tests/multi-theme-1/theme2.html b/src/diazo/tests/multi-theme-1/theme2.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-1/theme2.html\nrename to src/diazo/tests/multi-theme-1/theme2.html\ndiff --git a/lib/diazo/tests/multi-theme-2/content.html b/src/diazo/tests/multi-theme-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-2/content.html\nrename to src/diazo/tests/multi-theme-2/content.html\ndiff --git a/lib/diazo/tests/multi-theme-2/options.cfg b/src/diazo/tests/multi-theme-2/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-2/options.cfg\nrename to src/diazo/tests/multi-theme-2/options.cfg\ndiff --git a/lib/diazo/tests/multi-theme-2/output.html b/src/diazo/tests/multi-theme-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-2/output.html\nrename to src/diazo/tests/multi-theme-2/output.html\ndiff --git a/lib/diazo/tests/multi-theme-2/rules.xml b/src/diazo/tests/multi-theme-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-2/rules.xml\nrename to src/diazo/tests/multi-theme-2/rules.xml\ndiff --git a/lib/diazo/tests/multi-theme-2/theme1.html b/src/diazo/tests/multi-theme-2/theme1.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-2/theme1.html\nrename to src/diazo/tests/multi-theme-2/theme1.html\ndiff --git a/lib/diazo/tests/multi-theme-2/theme2.html b/src/diazo/tests/multi-theme-2/theme2.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-2/theme2.html\nrename to src/diazo/tests/multi-theme-2/theme2.html\ndiff --git a/lib/diazo/tests/multi-theme-3/content.html b/src/diazo/tests/multi-theme-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-3/content.html\nrename to src/diazo/tests/multi-theme-3/content.html\ndiff --git a/lib/diazo/tests/multi-theme-3/options.cfg b/src/diazo/tests/multi-theme-3/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-3/options.cfg\nrename to src/diazo/tests/multi-theme-3/options.cfg\ndiff --git a/lib/diazo/tests/multi-theme-3/output.html b/src/diazo/tests/multi-theme-3/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-3/output.html\nrename to src/diazo/tests/multi-theme-3/output.html\ndiff --git a/lib/diazo/tests/multi-theme-3/rules.xml b/src/diazo/tests/multi-theme-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-3/rules.xml\nrename to src/diazo/tests/multi-theme-3/rules.xml\ndiff --git a/lib/diazo/tests/multi-theme-3/theme1.html b/src/diazo/tests/multi-theme-3/theme1.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-3/theme1.html\nrename to src/diazo/tests/multi-theme-3/theme1.html\ndiff --git a/lib/diazo/tests/multi-theme-3/theme2.html b/src/diazo/tests/multi-theme-3/theme2.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-3/theme2.html\nrename to src/diazo/tests/multi-theme-3/theme2.html\ndiff --git a/lib/diazo/tests/multi-theme-4/content.html b/src/diazo/tests/multi-theme-4/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-4/content.html\nrename to src/diazo/tests/multi-theme-4/content.html\ndiff --git a/lib/diazo/tests/multi-theme-4/options.cfg b/src/diazo/tests/multi-theme-4/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-4/options.cfg\nrename to src/diazo/tests/multi-theme-4/options.cfg\ndiff --git a/lib/diazo/tests/multi-theme-4/output.html b/src/diazo/tests/multi-theme-4/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-4/output.html\nrename to src/diazo/tests/multi-theme-4/output.html\ndiff --git a/lib/diazo/tests/multi-theme-4/rules.xml b/src/diazo/tests/multi-theme-4/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-4/rules.xml\nrename to src/diazo/tests/multi-theme-4/rules.xml\ndiff --git a/lib/diazo/tests/multi-theme-4/theme1.html b/src/diazo/tests/multi-theme-4/theme1.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-4/theme1.html\nrename to src/diazo/tests/multi-theme-4/theme1.html\ndiff --git a/lib/diazo/tests/multi-theme-4/theme2.html b/src/diazo/tests/multi-theme-4/theme2.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-4/theme2.html\nrename to src/diazo/tests/multi-theme-4/theme2.html\ndiff --git a/lib/diazo/tests/multi-theme-5/content.html b/src/diazo/tests/multi-theme-5/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-5/content.html\nrename to src/diazo/tests/multi-theme-5/content.html\ndiff --git a/lib/diazo/tests/multi-theme-5/options.cfg b/src/diazo/tests/multi-theme-5/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-5/options.cfg\nrename to src/diazo/tests/multi-theme-5/options.cfg\ndiff --git a/lib/diazo/tests/multi-theme-5/output.html b/src/diazo/tests/multi-theme-5/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-5/output.html\nrename to src/diazo/tests/multi-theme-5/output.html\ndiff --git a/lib/diazo/tests/multi-theme-5/rules.xml b/src/diazo/tests/multi-theme-5/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-5/rules.xml\nrename to src/diazo/tests/multi-theme-5/rules.xml\ndiff --git a/lib/diazo/tests/multi-theme-5/theme1.html b/src/diazo/tests/multi-theme-5/theme1.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-5/theme1.html\nrename to src/diazo/tests/multi-theme-5/theme1.html\ndiff --git a/lib/diazo/tests/multi-theme-5/theme2.html b/src/diazo/tests/multi-theme-5/theme2.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-5/theme2.html\nrename to src/diazo/tests/multi-theme-5/theme2.html\ndiff --git a/lib/diazo/tests/multi-theme-variable-1/content.html b/src/diazo/tests/multi-theme-variable-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-variable-1/content.html\nrename to src/diazo/tests/multi-theme-variable-1/content.html\ndiff --git a/lib/diazo/tests/multi-theme-variable-1/options.cfg b/src/diazo/tests/multi-theme-variable-1/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-variable-1/options.cfg\nrename to src/diazo/tests/multi-theme-variable-1/options.cfg\ndiff --git a/lib/diazo/tests/multi-theme-variable-1/output.html b/src/diazo/tests/multi-theme-variable-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-variable-1/output.html\nrename to src/diazo/tests/multi-theme-variable-1/output.html\ndiff --git a/lib/diazo/tests/multi-theme-variable-1/rules.xml b/src/diazo/tests/multi-theme-variable-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-variable-1/rules.xml\nrename to src/diazo/tests/multi-theme-variable-1/rules.xml\ndiff --git a/lib/diazo/tests/multi-theme-variable-1/theme1.html b/src/diazo/tests/multi-theme-variable-1/theme1.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-variable-1/theme1.html\nrename to src/diazo/tests/multi-theme-variable-1/theme1.html\ndiff --git a/lib/diazo/tests/multi-theme-variable-1/theme2.html b/src/diazo/tests/multi-theme-variable-1/theme2.html\nsimilarity index 100%\nrename from lib/diazo/tests/multi-theme-variable-1/theme2.html\nrename to src/diazo/tests/multi-theme-variable-1/theme2.html\ndiff --git a/lib/diazo/tests/nested-conditions-1/content.html b/src/diazo/tests/nested-conditions-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-1/content.html\nrename to src/diazo/tests/nested-conditions-1/content.html\ndiff --git a/lib/diazo/tests/nested-conditions-1/output.html b/src/diazo/tests/nested-conditions-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-1/output.html\nrename to src/diazo/tests/nested-conditions-1/output.html\ndiff --git a/lib/diazo/tests/nested-conditions-1/rules.xml b/src/diazo/tests/nested-conditions-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-1/rules.xml\nrename to src/diazo/tests/nested-conditions-1/rules.xml\ndiff --git a/lib/diazo/tests/nested-conditions-1/theme.html b/src/diazo/tests/nested-conditions-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-1/theme.html\nrename to src/diazo/tests/nested-conditions-1/theme.html\ndiff --git a/lib/diazo/tests/nested-conditions-2/content.html b/src/diazo/tests/nested-conditions-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-2/content.html\nrename to src/diazo/tests/nested-conditions-2/content.html\ndiff --git a/lib/diazo/tests/nested-conditions-2/output.html b/src/diazo/tests/nested-conditions-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-2/output.html\nrename to src/diazo/tests/nested-conditions-2/output.html\ndiff --git a/lib/diazo/tests/nested-conditions-2/rules.xml b/src/diazo/tests/nested-conditions-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-2/rules.xml\nrename to src/diazo/tests/nested-conditions-2/rules.xml\ndiff --git a/lib/diazo/tests/nested-conditions-2/theme.html b/src/diazo/tests/nested-conditions-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-2/theme.html\nrename to src/diazo/tests/nested-conditions-2/theme.html\ndiff --git a/lib/diazo/tests/nested-conditions-3/content.html b/src/diazo/tests/nested-conditions-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-3/content.html\nrename to src/diazo/tests/nested-conditions-3/content.html\ndiff --git a/lib/diazo/tests/nested-conditions-3/output.html b/src/diazo/tests/nested-conditions-3/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-3/output.html\nrename to src/diazo/tests/nested-conditions-3/output.html\ndiff --git a/lib/diazo/tests/nested-conditions-3/rules.xml b/src/diazo/tests/nested-conditions-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-3/rules.xml\nrename to src/diazo/tests/nested-conditions-3/rules.xml\ndiff --git a/lib/diazo/tests/nested-conditions-3/theme.html b/src/diazo/tests/nested-conditions-3/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-conditions-3/theme.html\nrename to src/diazo/tests/nested-conditions-3/theme.html\ndiff --git a/lib/diazo/tests/nested-rules-for-xinclude/content.html b/src/diazo/tests/nested-rules-for-xinclude/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-rules-for-xinclude/content.html\nrename to src/diazo/tests/nested-rules-for-xinclude/content.html\ndiff --git a/lib/diazo/tests/nested-rules-for-xinclude/output.html b/src/diazo/tests/nested-rules-for-xinclude/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-rules-for-xinclude/output.html\nrename to src/diazo/tests/nested-rules-for-xinclude/output.html\ndiff --git a/lib/diazo/tests/nested-rules-for-xinclude/rules.xml b/src/diazo/tests/nested-rules-for-xinclude/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/nested-rules-for-xinclude/rules.xml\nrename to src/diazo/tests/nested-rules-for-xinclude/rules.xml\ndiff --git a/lib/diazo/tests/nested-rules-for-xinclude/theme.html b/src/diazo/tests/nested-rules-for-xinclude/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/nested-rules-for-xinclude/theme.html\nrename to src/diazo/tests/nested-rules-for-xinclude/theme.html\ndiff --git a/lib/diazo/tests/notheme-xmlns/content.html b/src/diazo/tests/notheme-xmlns/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/notheme-xmlns/content.html\nrename to src/diazo/tests/notheme-xmlns/content.html\ndiff --git a/lib/diazo/tests/notheme-xmlns/output.html b/src/diazo/tests/notheme-xmlns/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/notheme-xmlns/output.html\nrename to src/diazo/tests/notheme-xmlns/output.html\ndiff --git a/lib/diazo/tests/notheme-xmlns/rules.xml b/src/diazo/tests/notheme-xmlns/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/notheme-xmlns/rules.xml\nrename to src/diazo/tests/notheme-xmlns/rules.xml\ndiff --git a/lib/diazo/tests/notheme-xmlns/theme.html b/src/diazo/tests/notheme-xmlns/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/notheme-xmlns/theme.html\nrename to src/diazo/tests/notheme-xmlns/theme.html\ndiff --git a/lib/diazo/tests/null-if-content/content.html b/src/diazo/tests/null-if-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/null-if-content/content.html\nrename to src/diazo/tests/null-if-content/content.html\ndiff --git a/lib/diazo/tests/null-if-content/rules.xml b/src/diazo/tests/null-if-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/null-if-content/rules.xml\nrename to src/diazo/tests/null-if-content/rules.xml\ndiff --git a/lib/diazo/tests/null-if-content/theme.html b/src/diazo/tests/null-if-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/null-if-content/theme.html\nrename to src/diazo/tests/null-if-content/theme.html\ndiff --git a/lib/diazo/tests/null-if-content/xpaths.txt b/src/diazo/tests/null-if-content/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/null-if-content/xpaths.txt\nrename to src/diazo/tests/null-if-content/xpaths.txt\ndiff --git a/lib/diazo/tests/path-param-1/content.html b/src/diazo/tests/path-param-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-1/content.html\nrename to src/diazo/tests/path-param-1/content.html\ndiff --git a/lib/diazo/tests/path-param-1/options.cfg b/src/diazo/tests/path-param-1/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-1/options.cfg\nrename to src/diazo/tests/path-param-1/options.cfg\ndiff --git a/lib/diazo/tests/path-param-1/output.html b/src/diazo/tests/path-param-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-1/output.html\nrename to src/diazo/tests/path-param-1/output.html\ndiff --git a/lib/diazo/tests/path-param-1/rules.xml b/src/diazo/tests/path-param-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-1/rules.xml\nrename to src/diazo/tests/path-param-1/rules.xml\ndiff --git a/lib/diazo/tests/path-param-1/theme.html b/src/diazo/tests/path-param-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-1/theme.html\nrename to src/diazo/tests/path-param-1/theme.html\ndiff --git a/lib/diazo/tests/path-param-2/content.html b/src/diazo/tests/path-param-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-2/content.html\nrename to src/diazo/tests/path-param-2/content.html\ndiff --git a/lib/diazo/tests/path-param-2/options.cfg b/src/diazo/tests/path-param-2/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-2/options.cfg\nrename to src/diazo/tests/path-param-2/options.cfg\ndiff --git a/lib/diazo/tests/path-param-2/output.html b/src/diazo/tests/path-param-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-2/output.html\nrename to src/diazo/tests/path-param-2/output.html\ndiff --git a/lib/diazo/tests/path-param-2/rules.xml b/src/diazo/tests/path-param-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-2/rules.xml\nrename to src/diazo/tests/path-param-2/rules.xml\ndiff --git a/lib/diazo/tests/path-param-2/theme.html b/src/diazo/tests/path-param-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/path-param-2/theme.html\nrename to src/diazo/tests/path-param-2/theme.html\ndiff --git a/lib/diazo/tests/pre-line-endings/content.html b/src/diazo/tests/pre-line-endings/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/pre-line-endings/content.html\nrename to src/diazo/tests/pre-line-endings/content.html\ndiff --git a/lib/diazo/tests/pre-line-endings/extra.html b/src/diazo/tests/pre-line-endings/extra.html\nsimilarity index 100%\nrename from lib/diazo/tests/pre-line-endings/extra.html\nrename to src/diazo/tests/pre-line-endings/extra.html\ndiff --git a/lib/diazo/tests/pre-line-endings/output.html b/src/diazo/tests/pre-line-endings/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/pre-line-endings/output.html\nrename to src/diazo/tests/pre-line-endings/output.html\ndiff --git a/lib/diazo/tests/pre-line-endings/rules.xml b/src/diazo/tests/pre-line-endings/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/pre-line-endings/rules.xml\nrename to src/diazo/tests/pre-line-endings/rules.xml\ndiff --git a/lib/diazo/tests/pre-line-endings/theme.html b/src/diazo/tests/pre-line-endings/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/pre-line-endings/theme.html\nrename to src/diazo/tests/pre-line-endings/theme.html\ndiff --git a/lib/diazo/tests/prepend-append/content.html b/src/diazo/tests/prepend-append/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/prepend-append/content.html\nrename to src/diazo/tests/prepend-append/content.html\ndiff --git a/lib/diazo/tests/prepend-append/output.html b/src/diazo/tests/prepend-append/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/prepend-append/output.html\nrename to src/diazo/tests/prepend-append/output.html\ndiff --git a/lib/diazo/tests/prepend-append/rules.xml b/src/diazo/tests/prepend-append/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/prepend-append/rules.xml\nrename to src/diazo/tests/prepend-append/rules.xml\ndiff --git a/lib/diazo/tests/prepend-append/theme.html b/src/diazo/tests/prepend-append/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/prepend-append/theme.html\nrename to src/diazo/tests/prepend-append/theme.html\ndiff --git a/lib/diazo/tests/prepend-append/xpaths.txt b/src/diazo/tests/prepend-append/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/prepend-append/xpaths.txt\nrename to src/diazo/tests/prepend-append/xpaths.txt\ndiff --git a/lib/diazo/tests/prepend/content.html b/src/diazo/tests/prepend/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/prepend/content.html\nrename to src/diazo/tests/prepend/content.html\ndiff --git a/lib/diazo/tests/prepend/output.html b/src/diazo/tests/prepend/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/prepend/output.html\nrename to src/diazo/tests/prepend/output.html\ndiff --git a/lib/diazo/tests/prepend/rules.xml b/src/diazo/tests/prepend/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/prepend/rules.xml\nrename to src/diazo/tests/prepend/rules.xml\ndiff --git a/lib/diazo/tests/prepend/theme.html b/src/diazo/tests/prepend/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/prepend/theme.html\nrename to src/diazo/tests/prepend/theme.html\ndiff --git a/lib/diazo/tests/prepend/xpaths.txt b/src/diazo/tests/prepend/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/prepend/xpaths.txt\nrename to src/diazo/tests/prepend/xpaths.txt\ndiff --git a/lib/diazo/tests/replace-after/content.html b/src/diazo/tests/replace-after/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/replace-after/content.html\nrename to src/diazo/tests/replace-after/content.html\ndiff --git a/lib/diazo/tests/replace-after/output.html b/src/diazo/tests/replace-after/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/replace-after/output.html\nrename to src/diazo/tests/replace-after/output.html\ndiff --git a/lib/diazo/tests/replace-after/rules.xml b/src/diazo/tests/replace-after/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/replace-after/rules.xml\nrename to src/diazo/tests/replace-after/rules.xml\ndiff --git a/lib/diazo/tests/replace-after/theme.html b/src/diazo/tests/replace-after/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/replace-after/theme.html\nrename to src/diazo/tests/replace-after/theme.html\ndiff --git a/lib/diazo/tests/replace-after/xpaths.txt b/src/diazo/tests/replace-after/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/replace-after/xpaths.txt\nrename to src/diazo/tests/replace-after/xpaths.txt\ndiff --git a/lib/diazo/tests/replace/README.rst b/src/diazo/tests/replace/README.rst\nsimilarity index 100%\nrename from lib/diazo/tests/replace/README.rst\nrename to src/diazo/tests/replace/README.rst\ndiff --git a/lib/diazo/tests/replace/content.html b/src/diazo/tests/replace/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/replace/content.html\nrename to src/diazo/tests/replace/content.html\ndiff --git a/lib/diazo/tests/replace/output.html b/src/diazo/tests/replace/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/replace/output.html\nrename to src/diazo/tests/replace/output.html\ndiff --git a/lib/diazo/tests/replace/rules.xml b/src/diazo/tests/replace/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/replace/rules.xml\nrename to src/diazo/tests/replace/rules.xml\ndiff --git a/lib/diazo/tests/replace/theme.html b/src/diazo/tests/replace/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/replace/theme.html\nrename to src/diazo/tests/replace/theme.html\ndiff --git a/lib/diazo/tests/replace/xpaths.txt b/src/diazo/tests/replace/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/replace/xpaths.txt\nrename to src/diazo/tests/replace/xpaths.txt\ndiff --git a/lib/diazo/tests/ssi/content.html b/src/diazo/tests/ssi/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/ssi/content.html\nrename to src/diazo/tests/ssi/content.html\ndiff --git a/lib/diazo/tests/ssi/output.html b/src/diazo/tests/ssi/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/ssi/output.html\nrename to src/diazo/tests/ssi/output.html\ndiff --git a/lib/diazo/tests/ssi/rules.xml b/src/diazo/tests/ssi/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/ssi/rules.xml\nrename to src/diazo/tests/ssi/rules.xml\ndiff --git a/lib/diazo/tests/ssi/theme.html b/src/diazo/tests/ssi/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/ssi/theme.html\nrename to src/diazo/tests/ssi/theme.html\ndiff --git a/lib/diazo/tests/ssi/xpaths.txt b/src/diazo/tests/ssi/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/ssi/xpaths.txt\nrename to src/diazo/tests/ssi/xpaths.txt\ndiff --git a/lib/diazo/tests/ssiwait/content.html b/src/diazo/tests/ssiwait/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/ssiwait/content.html\nrename to src/diazo/tests/ssiwait/content.html\ndiff --git a/lib/diazo/tests/ssiwait/output.html b/src/diazo/tests/ssiwait/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/ssiwait/output.html\nrename to src/diazo/tests/ssiwait/output.html\ndiff --git a/lib/diazo/tests/ssiwait/rules.xml b/src/diazo/tests/ssiwait/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/ssiwait/rules.xml\nrename to src/diazo/tests/ssiwait/rules.xml\ndiff --git a/lib/diazo/tests/ssiwait/theme.html b/src/diazo/tests/ssiwait/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/ssiwait/theme.html\nrename to src/diazo/tests/ssiwait/theme.html\ndiff --git a/lib/diazo/tests/ssiwait/xpaths.txt b/src/diazo/tests/ssiwait/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/ssiwait/xpaths.txt\nrename to src/diazo/tests/ssiwait/xpaths.txt\ndiff --git a/lib/diazo/tests/style-script-quoting-1/content.html b/src/diazo/tests/style-script-quoting-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-1/content.html\nrename to src/diazo/tests/style-script-quoting-1/content.html\ndiff --git a/lib/diazo/tests/style-script-quoting-1/output.html b/src/diazo/tests/style-script-quoting-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-1/output.html\nrename to src/diazo/tests/style-script-quoting-1/output.html\ndiff --git a/lib/diazo/tests/style-script-quoting-1/rules.xml b/src/diazo/tests/style-script-quoting-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-1/rules.xml\nrename to src/diazo/tests/style-script-quoting-1/rules.xml\ndiff --git a/lib/diazo/tests/style-script-quoting-1/theme.html b/src/diazo/tests/style-script-quoting-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-1/theme.html\nrename to src/diazo/tests/style-script-quoting-1/theme.html\ndiff --git a/lib/diazo/tests/style-script-quoting-1/xpaths.txt b/src/diazo/tests/style-script-quoting-1/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-1/xpaths.txt\nrename to src/diazo/tests/style-script-quoting-1/xpaths.txt\ndiff --git a/lib/diazo/tests/style-script-quoting-2/content.html b/src/diazo/tests/style-script-quoting-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-2/content.html\nrename to src/diazo/tests/style-script-quoting-2/content.html\ndiff --git a/lib/diazo/tests/style-script-quoting-2/output.html b/src/diazo/tests/style-script-quoting-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-2/output.html\nrename to src/diazo/tests/style-script-quoting-2/output.html\ndiff --git a/lib/diazo/tests/style-script-quoting-2/rules.xml b/src/diazo/tests/style-script-quoting-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-2/rules.xml\nrename to src/diazo/tests/style-script-quoting-2/rules.xml\ndiff --git a/lib/diazo/tests/style-script-quoting-2/theme.html b/src/diazo/tests/style-script-quoting-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/style-script-quoting-2/theme.html\nrename to src/diazo/tests/style-script-quoting-2/theme.html\ndiff --git a/lib/diazo/tests/test_diazo.py b/src/diazo/tests/test_diazo.py\nsimilarity index 70%\nrename from lib/diazo/tests/test_diazo.py\nrename to src/diazo/tests/test_diazo.py\nindex 6c5fd41..08e5ef4 100644\n--- a/lib/diazo/tests/test_diazo.py\n+++ b/src/diazo/tests/test_diazo.py\n@@ -1,20 +1,14 @@\n-# -*- coding: utf-8 -*-\n-\n-from __future__ import print_function\n-\n-from builtins import str\n from diazo.utils import quote_param\n from io import BytesIO\n-from io import open\n from io import StringIO\n from lxml import etree\n \n+import configparser\n import diazo.compiler\n import diazo.run\n import difflib\n import os\n import pkg_resources\n-import six\n import sys\n import unittest\n \n@@ -23,19 +17,13 @@\n # Simple test runner for validating different diazo scenarios\n #\n \n-try:\n-    import configparser\n-except ImportError:\n-    import ConfigParser as configparser\n-\n-\n-if __name__ == \'__main__\':\n+if __name__ == "__main__":\n     __file__ = sys.argv[0]\n \n \n defaultsfn = pkg_resources.resource_filename(\n-    \'diazo.tests\',\n-    \'default-options.cfg\',\n+    "diazo.tests",\n+    "default-options.cfg",\n )\n \n \n@@ -44,9 +32,9 @@ def text_compare(t1, t2):\n     # See note in xml_compare below.\n     if not t1 and not t2:\n         return True\n-    if t1 == \'*\' or t2 == \'*\':\n+    if t1 == "*" or t2 == "*":\n         return True\n-    return (t1 or \'\').strip() == (t2 or \'\').strip()\n+    return (t1 or "").strip() == (t2 or "").strip()\n \n \n def xml_compare(x1, x2):\n@@ -79,7 +67,7 @@ def xml_compare(x1, x2):\n     """\n     if x1.tag != x2.tag:\n         return False\n-    for name, value in six.iteritems(x1.attrib):\n+    for name, value in x1.attrib.items():\n         if x2.attrib.get(name) != value:\n             return False\n     for name in x2.attrib:\n@@ -102,66 +90,65 @@ def xml_compare(x1, x2):\n \n \n class DiazoTestCase(unittest.TestCase):\n-\n-    writefiles = os.environ.get(\'DiazoTESTS_WRITE_FILES\', False)\n+    writefiles = os.environ.get("DiazoTESTS_WRITE_FILES", False)\n     warnings = os.environ.get(\n-        \'DiazoTESTS_WARN\',\n-        \'1\',\n-    ).lower() not in (\'0\', \'false\', \'off\')\n+        "DiazoTESTS_WARN",\n+        "1",\n+    ).lower() not in ("0", "false", "off")\n \n     testdir = os.path.realpath(__file__)\n \n     @classmethod\n     def suiteForParent(cls, parent, prefix):\n-        """Return a suite of diazo tests, one for each directory in parent.\n-        """\n+        """Return a suite of diazo tests, one for each directory in parent."""\n         suite = unittest.TestSuite()\n         for name in os.listdir(parent):\n-            if name.startswith(\'.\'):\n+            if name.startswith("."):\n                 continue\n             path = os.path.join(parent, name)\n             if not os.path.isdir(path):\n                 continue\n \n-            contentpath = os.path.join(path, \'content.html\')\n+            contentpath = os.path.join(path, "content.html")\n             if not os.path.isfile(contentpath):\n                 continue\n \n             test_cls = type(\n-                \'{prefix:s}-{name:s}\'.format(\n+                "{prefix:s}-{name:s}".format(\n                     prefix=prefix,\n                     name=name,\n                 ),\n                 (DiazoTestCase,),\n                 dict(testdir=path),\n             )\n-            suite.addTest(unittest.makeSuite(test_cls))\n+            suite.addTest(unittest.defaultTestLoader.loadTestsFromTestCase(test_cls))\n         return suite\n \n     def testAll(self):\n         self.errors = BytesIO()\n         config = configparser.ConfigParser()\n-        config.read([defaultsfn, os.path.join(self.testdir, \'options.cfg\')])\n+        config.read([defaultsfn, os.path.join(self.testdir, "options.cfg")])\n \n         themefn = None\n-        if config.get(\'diazotest\', \'theme\'):\n+        if config.get("diazotest", "theme"):\n             themefn = os.path.join(\n                 self.testdir,\n-                config.get(\'diazotest\', \'theme\'),\n+                config.get("diazotest", "theme"),\n             )\n-        contentfn = os.path.join(self.testdir, \'content.html\')\n-        rulesfn = os.path.join(self.testdir, \'rules.xml\')\n-        xpathsfn = os.path.join(self.testdir, \'xpaths.txt\')\n-        xslfn = os.path.join(self.testdir, \'compiled.xsl\')\n-        outputfn = os.path.join(self.testdir, \'output.html\')\n+        contentfn = os.path.join(self.testdir, "content.html")\n+        rulesfn = os.path.join(self.testdir, "rules.xml")\n+        xpathsfn = os.path.join(self.testdir, "xpaths.txt")\n+        xslfn = os.path.join(self.testdir, "compiled.xsl")\n+        outputfn = os.path.join(self.testdir, "output.html")\n \n         xsl_params = {}\n-        extra_params = config.get(\'diazotest\', \'extra-params\')\n+        extra_params = config.get("diazotest", "extra-params")\n         if extra_params:\n-            for token in extra_params.split(\' \'):\n-                token_split = token.split(\':\')\n-                xsl_params[token_split[0]] = len(token_split) > 1 and \\\n-                    token_split[1] or None\n+            for token in extra_params.split(" "):\n+                token_split = token.split(":")\n+                xsl_params[token_split[0]] = (\n+                    len(token_split) > 1 and token_split[1] or None\n+                )\n \n         if not os.path.exists(rulesfn):\n             return\n@@ -178,13 +165,13 @@ def testAll(self):\n             rules=rulesfn,\n             theme=themefn,\n             parser=theme_parser,\n-            absolute_prefix=config.get(\'diazotest\', \'absolute-prefix\'),\n-            indent=config.getboolean(\'diazotest\', \'pretty-print\'),\n+            absolute_prefix=config.get("diazotest", "absolute-prefix"),\n+            indent=config.getboolean("diazotest", "pretty-print"),\n             xsl_params=xsl_params,\n         )\n \n         # Serialize / parse the theme - this can catch problems with escaping.\n-        cts = etree.tostring(ct, encoding=\'unicode\')\n+        cts = etree.tostring(ct, encoding="unicode")\n         parser = etree.XMLParser()\n         etree.fromstring(cts, parser=parser)\n \n@@ -195,34 +182,34 @@ def testAll(self):\n             new = cts\n             if old != new:\n                 if self.writefiles:\n-                    with open(xslfn + \'.old\', \'w\') as f:\n+                    with open(xslfn + ".old", "w") as f:\n                         f.write(old)\n                 if self.warnings:\n-                    print(\'WARNING:\', \'compiled.xsl has CHANGED\')\n+                    print("WARNING:", "compiled.xsl has CHANGED")\n                     for line in difflib.unified_diff(\n-                        old.split(u\'\\n\'),\n-                        new.split(u\'\\n\'),\n+                        old.split("\\n"),\n+                        new.split("\\n"),\n                         xslfn,\n-                        \'now\',\n+                        "now",\n                     ):\n                         print(line)\n \n         # Write the compiled xsl out to catch unexpected changes\n         if self.writefiles:\n-            with open(xslfn, \'w\') as f:\n+            with open(xslfn, "w") as f:\n                 f.write(cts)\n \n         # Apply the compiled version, then test against desired output\n         theme_parser.resolvers.add(diazo.run.RunResolver(self.testdir))\n         processor = etree.XSLT(ct)\n         params = {}\n-        params[\'path\'] = "\'{path:s}\'".format(\n-            path=config.get(\'diazotest\', \'path\'),\n+        params["path"] = "\'{path:s}\'".format(\n+            path=config.get("diazotest", "path"),\n         )\n \n         for key in xsl_params:\n             try:\n-                params[key] = quote_param(config.get(\'diazotest\', key))\n+                params[key] = quote_param(config.get("diazotest", key))\n             except configparser.NoOptionError:\n                 pass\n \n@@ -238,8 +225,7 @@ def testAll(self):\n \n         # remove the extra meta content type\n \n-        metas = self.themed_content.xpath(\n-            "/html/head/meta[@http-equiv=\'Content-Type\']")\n+        metas = self.themed_content.xpath("/html/head/meta[@http-equiv=\'Content-Type\']")\n         if metas:\n             meta = metas[0]\n             meta.getparent().remove(meta)\n@@ -250,16 +236,18 @@ def testAll(self):\n                     # Read the XPaths from the file, skipping blank lines and\n                     # comments\n                     this_xpath = xpath.strip()\n-                    if not this_xpath or this_xpath[0] == \'#\':\n+                    if not this_xpath or this_xpath[0] == "#":\n                         continue\n-                    assert self.themed_content.xpath(this_xpath), \'{key:s}: {value:s}\'.format(  # NOQA: E501\n+                    assert self.themed_content.xpath(\n+                        this_xpath\n+                    ), "{key:s}: {value:s}".format(  # NOQA: E501\n                         key=xpathsfn,\n                         value=this_xpath,\n                     )\n \n         # Compare to previous version\n         if os.path.exists(outputfn):\n-            with open(outputfn, \'rb\') as f:\n+            with open(outputfn, "rb") as f:\n                 old = f.read()\n             new = self.themed_string\n             if not xml_compare(\n@@ -269,30 +257,30 @@ def testAll(self):\n                 # if self.writefiles:\n                 #    open(outputfn + \'.old\', \'w\').write(old)\n                 for line in difflib.unified_diff(\n-                    old.split(u\'\\n\'),\n-                    new.split(u\'\\n\'),\n+                    old.split("\\n"),\n+                    new.split("\\n"),\n                     outputfn,\n-                    \'now\',\n+                    "now",\n                 ):\n                     print(line)\n-                assert old == new, \'output.html has CHANGED\'\n+                assert old == new, "output.html has CHANGED"\n \n         # Write out the result to catch unexpected changes\n         if self.writefiles:\n-            with open(outputfn, \'w\') as f:\n+            with open(outputfn, "w") as f:\n                 f.write(self.themed_string)\n \n \n def test_suite():\n     suite = unittest.TestSuite()\n     tests_dir = os.path.dirname(__file__)\n-    suite.addTest(DiazoTestCase.suiteForParent(tests_dir, \'Test\'))\n+    suite.addTest(DiazoTestCase.suiteForParent(tests_dir, "Test"))\n     recipes_dir = os.path.join(\n         tests_dir,\n         "../../..",\n         "docs/recipes",\n     )\n-    if os.path.exists(os.path.join(recipes_dir, \'diazo-tests-marker.txt\')):\n+    if os.path.exists(os.path.join(recipes_dir, "diazo-tests-marker.txt")):\n         # Could still be a \'System\' package.\n-        suite.addTest(DiazoTestCase.suiteForParent(recipes_dir, \'Recipe\'))\n+        suite.addTest(DiazoTestCase.suiteForParent(recipes_dir, "Recipe"))\n     return suite\ndiff --git a/lib/diazo/tests/test_trace.py b/src/diazo/tests/test_trace.py\nsimilarity index 77%\nrename from lib/diazo/tests/test_trace.py\nrename to src/diazo/tests/test_trace.py\nindex 619bf2a..244ba26 100644\n--- a/lib/diazo/tests/test_trace.py\n+++ b/src/diazo/tests/test_trace.py\n@@ -1,5 +1,3 @@\n-# -*- coding: utf-8 -*-\n-\n from io import BytesIO\n from lxml import etree\n \n@@ -11,14 +9,14 @@\n import unittest\n \n \n-if __name__ == \'__main__\':\n+if __name__ == "__main__":\n     __file__ = sys.argv[0]\n \n \n def _testfile(filename):\n     return os.path.join(\n         os.path.abspath(os.path.dirname(__file__)),\n-        \'test_wsgi_files\',\n+        "test_wsgi_files",\n         filename,\n     )\n \n@@ -93,93 +91,93 @@ def test_internal(self):\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:theme/@runtrace-if-content\',\n-            \'false\',\n+            "/d:rules/d:theme/@runtrace-if-content",\n+            "false",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/@runtrace-if-content\',\n-            \'true\',\n+            "/d:rules/d:rules/@runtrace-if-content",\n+            "true",\n         )\n         # <replace css:content="div.bovine"\n         #          css:theme="div.cow"\n         #          css:if-content="body.female" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[1]/@runtrace-if-content\',\n-            \'false\',\n+            "/d:rules/d:rules/d:replace[1]/@runtrace-if-content",\n+            "false",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[1]/@runtrace-content\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[1]/@runtrace-content",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[1]/@runtrace-theme\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[1]/@runtrace-theme",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[1]/@runtrace-merged-condition\',\n-            \'false\',\n+            "/d:rules/d:rules/d:replace[1]/@runtrace-merged-condition",\n+            "false",\n         )\n         # <replace css:content="div.bovine"\n         #          css:theme="div.bull"\n         #          css:if-content="body.male" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[2]/@runtrace-if-content\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[2]/@runtrace-if-content",\n+            "true",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[2]/@runtrace-content\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[2]/@runtrace-content",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[2]/@runtrace-theme\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[2]/@runtrace-theme",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[2]/@runtrace-merged-condition\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[2]/@runtrace-merged-condition",\n+            "true",\n         )\n         # <replace css:content="div.pig" css:theme="div.pig" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[3]/@runtrace-content\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[3]/@runtrace-content",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[3]/@runtrace-merged-condition\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[3]/@runtrace-merged-condition",\n+            "true",\n         )\n         # <replace css:content="div.antelope" css:theme="div.antelope" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[4]/@runtrace-content\',\n-            \'0\',\n+            "/d:rules/d:rules/d:replace[4]/@runtrace-content",\n+            "0",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[4]/@runtrace-merged-condition\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[4]/@runtrace-merged-condition",\n+            "true",\n         )\n         # <replace css:content="div.iguana" css:theme="div.bull"\n         #          css:if-not-content="body.male" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[6]/@runtrace-if-not-content\',\n-            \'false\',\n+            "/d:rules/d:rules/d:replace[6]/@runtrace-if-not-content",\n+            "false",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[6]/@runtrace-merged-condition\',\n-            \'false\',\n+            "/d:rules/d:rules/d:replace[6]/@runtrace-merged-condition",\n+            "false",\n         )\n \n     def test_external(self):\n@@ -201,36 +199,36 @@ def test_external(self):\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:theme/@runtrace-if-content\',\n-            \'true\',\n+            "/d:rules/d:theme/@runtrace-if-content",\n+            "true",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/@runtrace-if-content\',\n-            \'true\',\n+            "/d:rules/d:rules/@runtrace-if-content",\n+            "true",\n         )\n         # <replace css:content="div.bovine"\n         #          css:theme="div.cow"\n         #          css:if-content="body.female" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[1]/@runtrace-if-content\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[1]/@runtrace-if-content",\n+            "true",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[1]/@runtrace-content\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[1]/@runtrace-content",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[1]/@runtrace-theme\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[1]/@runtrace-theme",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[1]/@runtrace-merged-condition\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[1]/@runtrace-merged-condition",\n+            "true",\n         )\n         # <replace css:content="div.bovine"\n         #          css:theme="div.bull"\n@@ -238,57 +236,57 @@ def test_external(self):\n         # The external theme only has the cow slot\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[2]/@runtrace-if-content\',\n-            \'false\',\n+            "/d:rules/d:rules/d:replace[2]/@runtrace-if-content",\n+            "false",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[2]/@runtrace-content\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[2]/@runtrace-content",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[2]/@runtrace-theme\',\n-            \'0\',\n+            "/d:rules/d:rules/d:replace[2]/@runtrace-theme",\n+            "0",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[2]/@runtrace-merged-condition\',\n-            \'false\',\n+            "/d:rules/d:rules/d:replace[2]/@runtrace-merged-condition",\n+            "false",\n         )\n         # <replace css:content="div.pig" css:theme="div.pig" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[3]/@runtrace-content\',\n-            \'1\',\n+            "/d:rules/d:rules/d:replace[3]/@runtrace-content",\n+            "1",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[3]/@runtrace-merged-condition\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[3]/@runtrace-merged-condition",\n+            "true",\n         )\n         # <replace css:content="div.antelope" css:theme="div.antelope" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[4]/@runtrace-content\',\n-            \'0\',\n+            "/d:rules/d:rules/d:replace[4]/@runtrace-content",\n+            "0",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[4]/@runtrace-merged-condition\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[4]/@runtrace-merged-condition",\n+            "true",\n         )\n         # <replace css:content="div.iguana" css:theme="div.bull"\n         #          css:if-not-content="body.male" />\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[6]/@runtrace-if-not-content\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[6]/@runtrace-if-not-content",\n+            "true",\n         )\n         self.assertXPath(\n             runtrace_doc,\n-            \'/d:rules/d:rules/d:replace[6]/@runtrace-merged-condition\',\n-            \'true\',\n+            "/d:rules/d:rules/d:replace[6]/@runtrace-merged-condition",\n+            "true",\n         )\n \n     def test_htmlformat(self):\n@@ -385,7 +383,7 @@ def assertXPath(self, doc, xpath, expected):\n         self.assertEqual(\n             doc.xpath(\n                 xpath,\n-                namespaces=(dict(d=\'http://namespaces.plone.org/diazo\')),\n+                namespaces=(dict(d="http://namespaces.plone.org/diazo")),\n             )[0],\n             expected,\n         )\ndiff --git a/lib/diazo/tests/test_wsgi.py b/src/diazo/tests/test_wsgi.py\nsimilarity index 72%\nrename from lib/diazo/tests/test_wsgi.py\nrename to src/diazo/tests/test_wsgi.py\nindex de522dd..4e910fb 100644\n--- a/lib/diazo/tests/test_wsgi.py\n+++ b/src/diazo/tests/test_wsgi.py\n@@ -1,21 +1,24 @@\n-# -*- coding: utf-8 -*-\n-\n import os.path\n import sys\n import unittest\n \n \n-if __name__ == \'__main__\':\n+if __name__ == "__main__":\n     __file__ = sys.argv[0]\n \n \n def _testfile(filename):\n-    return \'/\'.join(\n-        (\'file://\',) + os.path.split(\n+    return "/".join(\n+        ("file://",)\n+        + os.path.split(\n             os.path.abspath(\n                 os.path.dirname(__file__),\n             ),\n-        ) + (\'test_wsgi_files\', filename,),\n+        )\n+        + (\n+            "test_wsgi_files",\n+            filename,\n+        ),\n     )\n \n \n@@ -152,7 +155,6 @@ def _testfile(filename):\n \n \n class TestXSLTMiddleware(unittest.TestCase):\n-\n     def test_transform_filename(self):\n         from diazo.wsgi import XSLTMiddleware\n         from webob import Request\n@@ -161,12 +163,12 @@ def test_transform_filename(self):\n         import tempfile\n \n         _, filename = tempfile.mkstemp()\n-        with open(filename, \'wb\') as fp:\n+        with open(filename, "wb") as fp:\n             fp.write(XSLT)\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -177,17 +179,17 @@ def application(environ, start_response):\n         )\n         os.unlink(filename)\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(\n-            response.headers[\'Content-Type\'],\n-            \'text/html; charset=UTF-8\',\n+            response.headers["Content-Type"],\n+            "text/html; charset=UTF-8",\n         )\n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_transform_tree(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -195,8 +197,8 @@ def test_transform_tree(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -206,17 +208,17 @@ def application(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(\n-            response.headers[\'Content-Type\'],\n-            \'text/html; charset=UTF-8\',\n+            response.headers["Content-Type"],\n+            "text/html; charset=UTF-8",\n         )\n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_head_request(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -224,13 +226,13 @@ def test_head_request(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'Content-Length\', str(len(HTML))),\n+                ("Content-Type", "text/html"),\n+                ("Content-Length", str(len(HTML))),\n             ]\n             start_response(status, response_headers)\n-            return [\'\']  # Empty response for HEAD request\n+            return [""]  # Empty response for HEAD request\n \n         app = XSLTMiddleware(\n             application,\n@@ -238,13 +240,13 @@ def application(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        env = dict(REQUEST_METHOD=\'HEAD\')\n-        request = Request.blank(\'/\', environ=env)\n+        env = dict(REQUEST_METHOD="HEAD")\n+        request = Request.blank("/", environ=env)\n         # The *real* test is whether or not an exception is raised here.\n         response = request.get_response(app)\n \n         # Response headers for HEAD request must be updated.\n-        self.assertEqual(response.headers.get(\'Content-Length\'), None)\n+        self.assertEqual(response.headers.get("Content-Length"), None)\n         self.assertFalse(response.body)\n \n     def test_update_content_length(self):\n@@ -253,10 +255,10 @@ def test_update_content_length(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'Content-Length\', str(len(HTML))),\n+                ("Content-Type", "text/html"),\n+                ("Content-Length", str(len(HTML))),\n             ]\n             start_response(status, response_headers)\n             return [HTML]\n@@ -268,10 +270,10 @@ def application(environ, start_response):\n             update_content_length=True,\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertEqual(response.headers[\'Content-Length\'], \'178\')\n+        self.assertEqual(response.headers["Content-Length"], "178")\n \n     def test_dont_update_content_length(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -279,10 +281,10 @@ def test_dont_update_content_length(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'Content-Length\', \'1\'),\n+                ("Content-Type", "text/html"),\n+                ("Content-Length", "1"),\n             ]\n             start_response(status, response_headers)\n             return [HTML]\n@@ -293,10 +295,10 @@ def application(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertEqual(response.headers.get(\'Content-Length\'), None)\n+        self.assertEqual(response.headers.get("Content-Length"), None)\n \n     def test_content_length_zero(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -304,13 +306,13 @@ def test_content_length_zero(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'Content-Length\', \'0\'),\n+                ("Content-Type", "text/html"),\n+                ("Content-Length", "0"),\n             ]\n             start_response(status, response_headers)\n-            return [\'\']\n+            return [""]\n \n         app = XSLTMiddleware(\n             application,\n@@ -319,10 +321,10 @@ def application(environ, start_response):\n             update_content_length=True,\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertEqual(response.headers[\'Content-Length\'], \'0\')\n+        self.assertEqual(response.headers["Content-Length"], "0")\n \n     def test_content_empty(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -330,13 +332,13 @@ def test_content_empty(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'Content-MD5\', \'d41d8cd98f00b204e9800998ecf8427e\'),\n+                ("Content-Type", "text/html"),\n+                ("Content-MD5", "d41d8cd98f00b204e9800998ecf8427e"),\n             ]\n             start_response(status, response_headers)\n-            return [b\'\']\n+            return [b""]\n \n         app = XSLTMiddleware(\n             application,\n@@ -345,12 +347,12 @@ def application(environ, start_response):\n             update_content_length=True,\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(\n-            response.headers[\'Content-MD5\'],\n-            \'d41d8cd98f00b204e9800998ecf8427e\',\n+            response.headers["Content-MD5"],\n+            "d41d8cd98f00b204e9800998ecf8427e",\n         )\n \n     def test_content_range(self):\n@@ -359,17 +361,17 @@ def test_content_range(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             content_length = len(HTML)\n-            content_range = \'bytes {start:d}-{end:d}/{length:d}\'.format(\n+            content_range = "bytes {start:d}-{end:d}/{length:d}".format(\n                 start=0,\n                 end=content_length - 1,\n                 length=content_length,\n             )\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'Content-Range\', content_range),\n-                (\'Content-Length\', str(content_length)),\n+                ("Content-Type", "text/html"),\n+                ("Content-Range", content_range),\n+                ("Content-Length", str(content_length)),\n             ]\n             start_response(status, response_headers)\n             return [HTML]\n@@ -380,10 +382,10 @@ def application(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertFalse(\'Content-Range\' in response.headers)\n+        self.assertFalse("Content-Range" in response.headers)\n \n     def test_no_content_length(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -391,8 +393,8 @@ def test_no_content_length(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -403,10 +405,10 @@ def application(environ, start_response):\n             set_content_length=False,\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertFalse(\'Content-Length\' in response.headers)\n+        self.assertFalse("Content-Length" in response.headers)\n \n     def test_doctype_html(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -414,8 +416,8 @@ def test_doctype_html(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -425,12 +427,12 @@ def application(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(\n-            response.headers[\'Content-Type\'],\n-            \'text/html; charset=UTF-8\',\n+            response.headers["Content-Type"],\n+            "text/html; charset=UTF-8",\n         )\n \n     def test_doctype_xhtml(self):\n@@ -439,8 +441,8 @@ def test_doctype_xhtml(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -450,12 +452,12 @@ def application(environ, start_response):\n             tree=etree.fromstring(XSLT_XHTML),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(\n-            response.headers[\'Content-Type\'],\n-            \'application/xhtml+xml; charset=UTF-8\',\n+            response.headers["Content-Type"],\n+            "application/xhtml+xml; charset=UTF-8",\n         )\n \n     def test_doctype_html5(self):\n@@ -464,8 +466,8 @@ def test_doctype_html5(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -473,13 +475,13 @@ def application(environ, start_response):\n             application,\n             {},\n             tree=etree.fromstring(XSLT_XHTML),\n-            doctype=\'<!DOCTYPE html>\',\n+            doctype="<!DOCTYPE html>",\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertTrue(response.body.startswith(b\'<!DOCTYPE html>\\n<html\'))\n+        self.assertTrue(response.body.startswith(b"<!DOCTYPE html>\\n<html"))\n \n     def test_ignored_extension(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -487,8 +489,8 @@ def test_ignored_extension(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -496,21 +498,21 @@ def application(environ, start_response):\n             application,\n             {},\n             tree=etree.fromstring(XSLT),\n-            ignored_extensions=(\'html\',),\n+            ignored_extensions=("html",),\n         )\n \n-        request = Request.blank(\'/index.html\')\n+        request = Request.blank("/index.html")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_diazo_off_request_header(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -518,8 +520,8 @@ def test_diazo_off_request_header(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -529,20 +531,20 @@ def application(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n-        request.headers[\'X-Diazo-Off\'] = \'yes\'\n+        request = Request.blank("/")\n+        request.headers["X-Diazo-Off"] = "yes"\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n-        request = Request.blank(\'/\')\n-        request.headers[\'X-Diazo-Off\'] = \'no\'\n+        request = Request.blank("/")\n+        request.headers["X-Diazo-Off"] = "no"\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_diazo_off_response_header(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -550,26 +552,26 @@ def test_diazo_off_response_header(self):\n         from webob import Request\n \n         def application1(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'X-Diazo-Off\', \'yes\'),\n+                ("Content-Type", "text/html"),\n+                ("X-Diazo-Off", "yes"),\n             ]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = XSLTMiddleware(application1, {}, tree=etree.fromstring(XSLT))\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n         def application2(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'X-Diazo-Off\', \'no\'),\n+                ("Content-Type", "text/html"),\n+                ("X-Diazo-Off", "no"),\n             ]\n             start_response(status, response_headers)\n             return [HTML]\n@@ -580,13 +582,13 @@ def application2(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_non_html_content_type(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -594,8 +596,8 @@ def test_non_html_content_type(self):\n         from webob import Request\n \n         def application1(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/plain\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/plain")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -605,14 +607,14 @@ def application1(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n         def application2(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -622,13 +624,13 @@ def application2(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_content_encoding(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -636,24 +638,24 @@ def test_content_encoding(self):\n         from webob import Request\n \n         def application1(environ, start_response):\n-            status = \'200 OK\'\n+            status = "200 OK"\n             response_headers = [\n-                (\'Content-Type\', \'text/html\'),\n-                (\'Content-Encoding\', \'zip\'),\n+                ("Content-Type", "text/html"),\n+                ("Content-Encoding", "zip"),\n             ]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = XSLTMiddleware(application1, {}, tree=etree.fromstring(XSLT))\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n         def application2(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -663,13 +665,13 @@ def application2(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_301(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -677,8 +679,8 @@ def test_301(self):\n         from webob import Request\n \n         def application1(environ, start_response):\n-            status = \'301 MOVED PERMANENTLY\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "301 MOVED PERMANENTLY"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -688,14 +690,14 @@ def application1(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n         def application2(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -705,13 +707,13 @@ def application2(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_302(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -719,8 +721,8 @@ def test_302(self):\n         from webob import Request\n \n         def application1(environ, start_response):\n-            status = \'302 MOVED\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "302 MOVED"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -730,14 +732,14 @@ def application1(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n         def application2(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -747,13 +749,13 @@ def application2(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_304(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -761,33 +763,33 @@ def test_304(self):\n         from webob import Request\n \n         def application1(environ, start_response):\n-            status = \'304 NOT MODIFIED\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "304 NOT MODIFIED"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = XSLTMiddleware(application1, {}, tree=etree.fromstring(XSLT))\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n         def application2(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = XSLTMiddleware(application2, {}, tree=etree.fromstring(XSLT))\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_204(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -795,33 +797,33 @@ def test_204(self):\n         from webob import Request\n \n         def application1(environ, start_response):\n-            status = \'204 NO CONTENT\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "204 NO CONTENT"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = XSLTMiddleware(application1, {}, tree=etree.fromstring(XSLT))\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n         def application2(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = XSLTMiddleware(application2, {}, tree=etree.fromstring(XSLT))\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_401(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -829,8 +831,8 @@ def test_401(self):\n         from webob import Request\n \n         def application1(environ, start_response):\n-            status = \'401 UNAUTHORIZED\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "401 UNAUTHORIZED"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -840,14 +842,14 @@ def application1(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertEqual(response.body, HTML)\n \n         def application2(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -857,13 +859,13 @@ def application2(environ, start_response):\n             tree=etree.fromstring(XSLT),\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n             b\'<div id="content">Content content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_html_serialization(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -871,13 +873,13 @@ def test_html_serialization(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = XSLTMiddleware(application, {}, tree=etree.fromstring(XSLT_HTML))\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         # HTML serialisation\n@@ -885,14 +887,14 @@ def application(environ, start_response):\n             b\'<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" \'\n             b\'"http://www.w3.org/TR/html4/strict.dtd">\' in response.body,\n         )\n-        self.assertTrue(b\'<br>\' in response.body)\n+        self.assertTrue(b"<br>" in response.body)\n \n         app = XSLTMiddleware(\n             application,\n             {},\n             tree=etree.fromstring(XSLT_XHTML),\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         # XHTML serialisation\n@@ -901,19 +903,19 @@ def application(environ, start_response):\n             b\'"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\'\n             in response.body,\n         )\n-        self.assertTrue(b\'<br />\' in response.body)\n+        self.assertTrue(b"<br />" in response.body)\n \n         app = XSLTMiddleware(\n             application,\n             {},\n             tree=etree.fromstring(XSLT_HTML5),\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         # HTML 5 serialisation\n-        self.assertTrue(b\'<!DOCTYPE html>\' in response.body)\n-        self.assertTrue(b\'<br/>\' in response.body)\n+        self.assertTrue(b"<!DOCTYPE html>" in response.body)\n+        self.assertTrue(b"<br/>" in response.body)\n \n     def test_environ_param(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -921,8 +923,8 @@ def test_environ_param(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -930,19 +932,19 @@ def application(environ, start_response):\n             application,\n             {},\n             tree=etree.fromstring(XSLT_PARAM),\n-            environ_param_map={\'test.param1\': \'someparam\'},\n+            environ_param_map={"test.param1": "someparam"},\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertTrue(b\'<p>defaultvalue</p>\' in response.body)\n+        self.assertTrue(b"<p>defaultvalue</p>" in response.body)\n \n-        request = Request.blank(\'/\')\n-        request.environ[\'test.param1\'] = \'value1\'\n+        request = Request.blank("/")\n+        request.environ["test.param1"] = "value1"\n         response = request.get_response(app)\n \n-        self.assertTrue(b\'<p>value1</p>\' in response.body)\n+        self.assertTrue(b"<p>value1</p>" in response.body)\n \n     def test_params(self):\n         from diazo.wsgi import XSLTMiddleware\n@@ -950,8 +952,8 @@ def test_params(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n@@ -960,41 +962,40 @@ def application(environ, start_response):\n             {},\n             tree=etree.fromstring(XSLT_PARAM),\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertTrue(b\'<p>defaultvalue</p>\' in response.body)\n+        self.assertTrue(b"<p>defaultvalue</p>" in response.body)\n \n         app = XSLTMiddleware(\n             application,\n             {},\n             tree=etree.fromstring(XSLT_PARAM),\n-            someparam=\'value1\',\n+            someparam="value1",\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertTrue(b\'<p>value1</p>\' in response.body)\n+        self.assertTrue(b"<p>value1</p>" in response.body)\n \n \n class TestDiazoMiddleware(unittest.TestCase):\n-\n     def test_simple_transform(self):\n         from diazo.wsgi import DiazoMiddleware\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = DiazoMiddleware(\n             application,\n             {},\n-            _testfile(\'simple_transform.xml\'),\n+            _testfile("simple_transform.xml"),\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1003,46 +1004,46 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_doctype_html5(self):\n         from diazo.wsgi import DiazoMiddleware\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = DiazoMiddleware(\n             application,\n             {},\n-            _testfile(\'simple_transform.xml\'),\n-            doctype=\'<!DOCTYPE html>\',\n+            _testfile("simple_transform.xml"),\n+            doctype="<!DOCTYPE html>",\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n-        self.assertTrue(response.body.startswith(b\'<!DOCTYPE html>\\n<html\'))\n+        self.assertTrue(response.body.startswith(b"<!DOCTYPE html>\\n<html"))\n \n     def test_with_theme(self):\n         from diazo.wsgi import DiazoMiddleware\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = DiazoMiddleware(\n             application,\n             {},\n-            _testfile(\'explicit_theme.xml\'),\n-            theme=_testfile(\'theme.html\'),\n+            _testfile("explicit_theme.xml"),\n+            theme=_testfile("theme.html"),\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1051,24 +1052,24 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_absolute_prefix(self):\n         from diazo.wsgi import DiazoMiddleware\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = DiazoMiddleware(\n             application,\n             {},\n-            _testfile(\'simple_transform.xml\'),\n+            _testfile("simple_transform.xml"),\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1077,17 +1078,18 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n         self.assertTrue(\n             b\'<link rel="stylesheet" href="./theme.css" />\' in response.body,\n         )\n \n         app = DiazoMiddleware(\n-            application, {},\n-            _testfile(\'simple_transform.xml\'),\n-            prefix=\'/static\',\n+            application,\n+            {},\n+            _testfile("simple_transform.xml"),\n+            prefix="/static",\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1096,10 +1098,9 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n         self.assertTrue(\n-            b\'<link rel="stylesheet" href="/static/theme.css" />\'\n-            in response.body,\n+            b\'<link rel="stylesheet" href="/static/theme.css" />\' in response.body,\n         )\n \n     def test_path_param(self):\n@@ -1107,13 +1108,13 @@ def test_path_param(self):\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n-        app = DiazoMiddleware(application, {}, _testfile(\'path_param.xml\'))\n-        request = Request.blank(\'/\')\n+        app = DiazoMiddleware(application, {}, _testfile("path_param.xml"))\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertFalse(\n@@ -1122,9 +1123,9 @@ def application(environ, start_response):\n         self.assertTrue(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n-        request = Request.blank(\'/index.html\')\n+        request = Request.blank("/index.html")\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1133,26 +1134,26 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_custom_environ_param(self):\n         from diazo.wsgi import DiazoMiddleware\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = DiazoMiddleware(\n             application,\n             {},\n-            _testfile(\'custom_param.xml\'),\n-            environ_param_map={\'test.param1\': \'someparam\'},\n+            _testfile("custom_param.xml"),\n+            environ_param_map={"test.param1": "someparam"},\n         )\n \n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertFalse(\n@@ -1161,10 +1162,10 @@ def application(environ, start_response):\n         self.assertTrue(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n-        request = Request.blank(\'/\')\n-        request.environ[\'test.param1\'] = \'value1\'\n+        request = Request.blank("/")\n+        request.environ["test.param1"] = "value1"\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1173,10 +1174,10 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n-        request = Request.blank(\'/\')\n-        request.environ[\'test.param1\'] = \'value2\'\n+        request = Request.blank("/")\n+        request.environ["test.param1"] = "value2"\n         response = request.get_response(app)\n \n         self.assertFalse(\n@@ -1185,25 +1186,25 @@ def application(environ, start_response):\n         self.assertTrue(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_custom_param(self):\n         from diazo.wsgi import DiazoMiddleware\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n             return [HTML]\n \n         app = DiazoMiddleware(\n             application,\n             {},\n-            _testfile(\'custom_param.xml\'),\n-            someparam=\'value1\',\n+            _testfile("custom_param.xml"),\n+            someparam="value1",\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1212,15 +1213,15 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n         app = DiazoMiddleware(\n             application,\n             {},\n-            _testfile(\'custom_param.xml\'),\n-            someparam=\'value2\',\n+            _testfile("custom_param.xml"),\n+            someparam="value2",\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertFalse(\n@@ -1229,25 +1230,25 @@ def application(environ, start_response):\n         self.assertTrue(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_subrequest(self):\n         from diazo.wsgi import DiazoMiddleware\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n \n             request = Request(environ)\n-            if request.path.endswith(\'/other.html\'):\n+            if request.path.endswith("/other.html"):\n                 return [HTML_ALTERNATIVE]\n             else:\n                 return [HTML]\n \n-        app = DiazoMiddleware(application, {}, _testfile(\'subrequest.xml\'))\n-        request = Request.blank(\'/\')\n+        app = DiazoMiddleware(application, {}, _testfile("subrequest.xml"))\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1256,19 +1257,19 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n     def test_esi(self):\n         from diazo.wsgi import DiazoMiddleware\n         from webob import Request\n \n         def application(environ, start_response):\n-            status = \'200 OK\'\n-            response_headers = [(\'Content-Type\', \'text/html\')]\n+            status = "200 OK"\n+            response_headers = [("Content-Type", "text/html")]\n             start_response(status, response_headers)\n \n             request = Request(environ)\n-            if request.path.endswith(\'/other.html\'):\n+            if request.path.endswith("/other.html"):\n                 return [HTML_ALTERNATIVE]\n             else:\n                 return [HTML]\n@@ -1276,10 +1277,10 @@ def application(environ, start_response):\n         app = DiazoMiddleware(\n             application,\n             {},\n-            _testfile(\'esi.xml\'),\n+            _testfile("esi.xml"),\n             filter_xpath=True,\n         )\n-        request = Request.blank(\'/\')\n+        request = Request.blank("/")\n         response = request.get_response(app)\n \n         self.assertTrue(\n@@ -1290,7 +1291,7 @@ def application(environ, start_response):\n         self.assertFalse(\n             b\'<div id="content">Theme content</div>\' in response.body,\n         )\n-        self.assertTrue(b\'<title>Transformed</title>\' in response.body)\n+        self.assertTrue(b"<title>Transformed</title>" in response.body)\n \n         request = Request.blank(\n             """/other.html?;filter_xpath=//*[@id%20=%20\'content\']""",\ndiff --git a/lib/diazo/tests/test_wsgi_files/custom_param.xml b/src/diazo/tests/test_wsgi_files/custom_param.xml\nsimilarity index 100%\nrename from lib/diazo/tests/test_wsgi_files/custom_param.xml\nrename to src/diazo/tests/test_wsgi_files/custom_param.xml\ndiff --git a/lib/diazo/tests/test_wsgi_files/esi.xml b/src/diazo/tests/test_wsgi_files/esi.xml\nsimilarity index 100%\nrename from lib/diazo/tests/test_wsgi_files/esi.xml\nrename to src/diazo/tests/test_wsgi_files/esi.xml\ndiff --git a/lib/diazo/tests/test_wsgi_files/explicit_theme.xml b/src/diazo/tests/test_wsgi_files/explicit_theme.xml\nsimilarity index 100%\nrename from lib/diazo/tests/test_wsgi_files/explicit_theme.xml\nrename to src/diazo/tests/test_wsgi_files/explicit_theme.xml\ndiff --git a/lib/diazo/tests/test_wsgi_files/path_param.xml b/src/diazo/tests/test_wsgi_files/path_param.xml\nsimilarity index 100%\nrename from lib/diazo/tests/test_wsgi_files/path_param.xml\nrename to src/diazo/tests/test_wsgi_files/path_param.xml\ndiff --git a/lib/diazo/tests/test_wsgi_files/simple_transform.xml b/src/diazo/tests/test_wsgi_files/simple_transform.xml\nsimilarity index 100%\nrename from lib/diazo/tests/test_wsgi_files/simple_transform.xml\nrename to src/diazo/tests/test_wsgi_files/simple_transform.xml\ndiff --git a/lib/diazo/tests/test_wsgi_files/subrequest.xml b/src/diazo/tests/test_wsgi_files/subrequest.xml\nsimilarity index 100%\nrename from lib/diazo/tests/test_wsgi_files/subrequest.xml\nrename to src/diazo/tests/test_wsgi_files/subrequest.xml\ndiff --git a/lib/diazo/tests/test_wsgi_files/theme.html b/src/diazo/tests/test_wsgi_files/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/test_wsgi_files/theme.html\nrename to src/diazo/tests/test_wsgi_files/theme.html\ndiff --git a/lib/diazo/tests/update-namespace-1/content.html b/src/diazo/tests/update-namespace-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-1/content.html\nrename to src/diazo/tests/update-namespace-1/content.html\ndiff --git a/lib/diazo/tests/update-namespace-1/rules.xml b/src/diazo/tests/update-namespace-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-1/rules.xml\nrename to src/diazo/tests/update-namespace-1/rules.xml\ndiff --git a/lib/diazo/tests/update-namespace-1/theme.html b/src/diazo/tests/update-namespace-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-1/theme.html\nrename to src/diazo/tests/update-namespace-1/theme.html\ndiff --git a/lib/diazo/tests/update-namespace-1/xpaths.txt b/src/diazo/tests/update-namespace-1/xpaths.txt\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-1/xpaths.txt\nrename to src/diazo/tests/update-namespace-1/xpaths.txt\ndiff --git a/lib/diazo/tests/update-namespace-2/content.html b/src/diazo/tests/update-namespace-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-2/content.html\nrename to src/diazo/tests/update-namespace-2/content.html\ndiff --git a/lib/diazo/tests/update-namespace-2/output.html b/src/diazo/tests/update-namespace-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-2/output.html\nrename to src/diazo/tests/update-namespace-2/output.html\ndiff --git a/lib/diazo/tests/update-namespace-2/rules.xml b/src/diazo/tests/update-namespace-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-2/rules.xml\nrename to src/diazo/tests/update-namespace-2/rules.xml\ndiff --git a/lib/diazo/tests/update-namespace-2/theme.html b/src/diazo/tests/update-namespace-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-2/theme.html\nrename to src/diazo/tests/update-namespace-2/theme.html\ndiff --git a/lib/diazo/tests/update-namespace-3/content.html b/src/diazo/tests/update-namespace-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-3/content.html\nrename to src/diazo/tests/update-namespace-3/content.html\ndiff --git a/lib/diazo/tests/update-namespace-3/output.html b/src/diazo/tests/update-namespace-3/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-3/output.html\nrename to src/diazo/tests/update-namespace-3/output.html\ndiff --git a/lib/diazo/tests/update-namespace-3/rules.xml b/src/diazo/tests/update-namespace-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-3/rules.xml\nrename to src/diazo/tests/update-namespace-3/rules.xml\ndiff --git a/lib/diazo/tests/update-namespace-3/theme.html b/src/diazo/tests/update-namespace-3/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/update-namespace-3/theme.html\nrename to src/diazo/tests/update-namespace-3/theme.html\ndiff --git a/lib/diazo/tests/v1-after-both-children/content.html b/src/diazo/tests/v1-after-both-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-both-children/content.html\nrename to src/diazo/tests/v1-after-both-children/content.html\ndiff --git a/lib/diazo/tests/v1-after-both-children/output.html b/src/diazo/tests/v1-after-both-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-both-children/output.html\nrename to src/diazo/tests/v1-after-both-children/output.html\ndiff --git a/lib/diazo/tests/v1-after-both-children/rules.xml b/src/diazo/tests/v1-after-both-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-both-children/rules.xml\nrename to src/diazo/tests/v1-after-both-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-after-both-children/theme.html b/src/diazo/tests/v1-after-both-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-both-children/theme.html\nrename to src/diazo/tests/v1-after-both-children/theme.html\ndiff --git a/lib/diazo/tests/v1-after-content-children/content.html b/src/diazo/tests/v1-after-content-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-content-children/content.html\nrename to src/diazo/tests/v1-after-content-children/content.html\ndiff --git a/lib/diazo/tests/v1-after-content-children/output.html b/src/diazo/tests/v1-after-content-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-content-children/output.html\nrename to src/diazo/tests/v1-after-content-children/output.html\ndiff --git a/lib/diazo/tests/v1-after-content-children/rules.xml b/src/diazo/tests/v1-after-content-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-content-children/rules.xml\nrename to src/diazo/tests/v1-after-content-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-after-content-children/theme.html b/src/diazo/tests/v1-after-content-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-content-children/theme.html\nrename to src/diazo/tests/v1-after-content-children/theme.html\ndiff --git a/lib/diazo/tests/v1-after-theme-children/content.html b/src/diazo/tests/v1-after-theme-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-theme-children/content.html\nrename to src/diazo/tests/v1-after-theme-children/content.html\ndiff --git a/lib/diazo/tests/v1-after-theme-children/output.html b/src/diazo/tests/v1-after-theme-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-theme-children/output.html\nrename to src/diazo/tests/v1-after-theme-children/output.html\ndiff --git a/lib/diazo/tests/v1-after-theme-children/rules.xml b/src/diazo/tests/v1-after-theme-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-theme-children/rules.xml\nrename to src/diazo/tests/v1-after-theme-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-after-theme-children/theme.html b/src/diazo/tests/v1-after-theme-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after-theme-children/theme.html\nrename to src/diazo/tests/v1-after-theme-children/theme.html\ndiff --git a/lib/diazo/tests/v1-after/content.html b/src/diazo/tests/v1-after/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after/content.html\nrename to src/diazo/tests/v1-after/content.html\ndiff --git a/lib/diazo/tests/v1-after/output.html b/src/diazo/tests/v1-after/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after/output.html\nrename to src/diazo/tests/v1-after/output.html\ndiff --git a/lib/diazo/tests/v1-after/rules.xml b/src/diazo/tests/v1-after/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after/rules.xml\nrename to src/diazo/tests/v1-after/rules.xml\ndiff --git a/lib/diazo/tests/v1-after/theme.html b/src/diazo/tests/v1-after/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-after/theme.html\nrename to src/diazo/tests/v1-after/theme.html\ndiff --git a/lib/diazo/tests/v1-before-both-children/content.html b/src/diazo/tests/v1-before-both-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-both-children/content.html\nrename to src/diazo/tests/v1-before-both-children/content.html\ndiff --git a/lib/diazo/tests/v1-before-both-children/output.html b/src/diazo/tests/v1-before-both-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-both-children/output.html\nrename to src/diazo/tests/v1-before-both-children/output.html\ndiff --git a/lib/diazo/tests/v1-before-both-children/rules.xml b/src/diazo/tests/v1-before-both-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-both-children/rules.xml\nrename to src/diazo/tests/v1-before-both-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-before-both-children/theme.html b/src/diazo/tests/v1-before-both-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-both-children/theme.html\nrename to src/diazo/tests/v1-before-both-children/theme.html\ndiff --git a/lib/diazo/tests/v1-before-content-children/content.html b/src/diazo/tests/v1-before-content-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-content-children/content.html\nrename to src/diazo/tests/v1-before-content-children/content.html\ndiff --git a/lib/diazo/tests/v1-before-content-children/output.html b/src/diazo/tests/v1-before-content-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-content-children/output.html\nrename to src/diazo/tests/v1-before-content-children/output.html\ndiff --git a/lib/diazo/tests/v1-before-content-children/rules.xml b/src/diazo/tests/v1-before-content-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-content-children/rules.xml\nrename to src/diazo/tests/v1-before-content-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-before-content-children/theme.html b/src/diazo/tests/v1-before-content-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-content-children/theme.html\nrename to src/diazo/tests/v1-before-content-children/theme.html\ndiff --git a/lib/diazo/tests/v1-before-content-content-children/content.html b/src/diazo/tests/v1-before-content-content-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-content-content-children/content.html\nrename to src/diazo/tests/v1-before-content-content-children/content.html\ndiff --git a/lib/diazo/tests/v1-before-content-content-children/output.html b/src/diazo/tests/v1-before-content-content-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-content-content-children/output.html\nrename to src/diazo/tests/v1-before-content-content-children/output.html\ndiff --git a/lib/diazo/tests/v1-before-content-content-children/rules.xml b/src/diazo/tests/v1-before-content-content-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-content-content-children/rules.xml\nrename to src/diazo/tests/v1-before-content-content-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-before-content-content-children/theme.html b/src/diazo/tests/v1-before-content-content-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-content-content-children/theme.html\nrename to src/diazo/tests/v1-before-content-content-children/theme.html\ndiff --git a/lib/diazo/tests/v1-before-replace-after-content/content.html b/src/diazo/tests/v1-before-replace-after-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-replace-after-content/content.html\nrename to src/diazo/tests/v1-before-replace-after-content/content.html\ndiff --git a/lib/diazo/tests/v1-before-replace-after-content/output.html b/src/diazo/tests/v1-before-replace-after-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-replace-after-content/output.html\nrename to src/diazo/tests/v1-before-replace-after-content/output.html\ndiff --git a/lib/diazo/tests/v1-before-replace-after-content/rules.xml b/src/diazo/tests/v1-before-replace-after-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-replace-after-content/rules.xml\nrename to src/diazo/tests/v1-before-replace-after-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-before-replace-after-content/theme.html b/src/diazo/tests/v1-before-replace-after-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-replace-after-content/theme.html\nrename to src/diazo/tests/v1-before-replace-after-content/theme.html\ndiff --git a/lib/diazo/tests/v1-before-theme-children/content.html b/src/diazo/tests/v1-before-theme-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-theme-children/content.html\nrename to src/diazo/tests/v1-before-theme-children/content.html\ndiff --git a/lib/diazo/tests/v1-before-theme-children/output.html b/src/diazo/tests/v1-before-theme-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-theme-children/output.html\nrename to src/diazo/tests/v1-before-theme-children/output.html\ndiff --git a/lib/diazo/tests/v1-before-theme-children/rules.xml b/src/diazo/tests/v1-before-theme-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-theme-children/rules.xml\nrename to src/diazo/tests/v1-before-theme-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-before-theme-children/theme.html b/src/diazo/tests/v1-before-theme-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before-theme-children/theme.html\nrename to src/diazo/tests/v1-before-theme-children/theme.html\ndiff --git a/lib/diazo/tests/v1-before/content.html b/src/diazo/tests/v1-before/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before/content.html\nrename to src/diazo/tests/v1-before/content.html\ndiff --git a/lib/diazo/tests/v1-before/output.html b/src/diazo/tests/v1-before/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before/output.html\nrename to src/diazo/tests/v1-before/output.html\ndiff --git a/lib/diazo/tests/v1-before/rules.xml b/src/diazo/tests/v1-before/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before/rules.xml\nrename to src/diazo/tests/v1-before/rules.xml\ndiff --git a/lib/diazo/tests/v1-before/theme.html b/src/diazo/tests/v1-before/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-before/theme.html\nrename to src/diazo/tests/v1-before/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-1/content.html b/src/diazo/tests/v1-copy-all-attributes-conditional-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-1/content.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-1/content.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-1/output.html b/src/diazo/tests/v1-copy-all-attributes-conditional-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-1/output.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-1/output.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-1/rules.xml b/src/diazo/tests/v1-copy-all-attributes-conditional-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-1/rules.xml\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-1/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-1/theme.html b/src/diazo/tests/v1-copy-all-attributes-conditional-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-1/theme.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-1/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-2/content.html b/src/diazo/tests/v1-copy-all-attributes-conditional-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-2/content.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-2/content.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-2/output.html b/src/diazo/tests/v1-copy-all-attributes-conditional-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-2/output.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-2/output.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-2/rules.xml b/src/diazo/tests/v1-copy-all-attributes-conditional-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-2/rules.xml\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-2/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-2/theme.html b/src/diazo/tests/v1-copy-all-attributes-conditional-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-2/theme.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-2/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-3/content.html b/src/diazo/tests/v1-copy-all-attributes-conditional-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-3/content.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-3/content.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-3/output.html b/src/diazo/tests/v1-copy-all-attributes-conditional-3/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-3/output.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-3/output.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-3/rules.xml b/src/diazo/tests/v1-copy-all-attributes-conditional-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-3/rules.xml\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-3/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-conditional-3/theme.html b/src/diazo/tests/v1-copy-all-attributes-conditional-3/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-conditional-3/theme.html\nrename to src/diazo/tests/v1-copy-all-attributes-conditional-3/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-href/content.html b/src/diazo/tests/v1-copy-all-attributes-href/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-href/content.html\nrename to src/diazo/tests/v1-copy-all-attributes-href/content.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-href/include.html b/src/diazo/tests/v1-copy-all-attributes-href/include.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-href/include.html\nrename to src/diazo/tests/v1-copy-all-attributes-href/include.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-href/output.html b/src/diazo/tests/v1-copy-all-attributes-href/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-href/output.html\nrename to src/diazo/tests/v1-copy-all-attributes-href/output.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-href/rules.xml b/src/diazo/tests/v1-copy-all-attributes-href/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-href/rules.xml\nrename to src/diazo/tests/v1-copy-all-attributes-href/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-href/theme.html b/src/diazo/tests/v1-copy-all-attributes-href/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-href/theme.html\nrename to src/diazo/tests/v1-copy-all-attributes-href/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/content.html b/src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/content.html\nrename to src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/content.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/output.html b/src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/output.html\nrename to src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/output.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/rules.xml b/src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/rules.xml\nrename to src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/theme.html b/src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/theme.html\nrename to src/diazo/tests/v1-copy-all-attributes-multiple-rules-conditional-1/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/content.html b/src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/content.html\nrename to src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/content.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/output.html b/src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/output.html\nrename to src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/output.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/rules.xml b/src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/rules.xml\nrename to src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/theme.html b/src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/theme.html\nrename to src/diazo/tests/v1-copy-all-attributes-multiple-rules-unconditional/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes/content.html b/src/diazo/tests/v1-copy-all-attributes/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes/content.html\nrename to src/diazo/tests/v1-copy-all-attributes/content.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes/output.html b/src/diazo/tests/v1-copy-all-attributes/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes/output.html\nrename to src/diazo/tests/v1-copy-all-attributes/output.html\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes/rules.xml b/src/diazo/tests/v1-copy-all-attributes/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes/rules.xml\nrename to src/diazo/tests/v1-copy-all-attributes/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-all-attributes/theme.html b/src/diazo/tests/v1-copy-all-attributes/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-all-attributes/theme.html\nrename to src/diazo/tests/v1-copy-all-attributes/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-attribute-exists/content.html b/src/diazo/tests/v1-copy-attribute-exists/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-attribute-exists/content.html\nrename to src/diazo/tests/v1-copy-attribute-exists/content.html\ndiff --git a/lib/diazo/tests/v1-copy-attribute-exists/output.html b/src/diazo/tests/v1-copy-attribute-exists/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-attribute-exists/output.html\nrename to src/diazo/tests/v1-copy-attribute-exists/output.html\ndiff --git a/lib/diazo/tests/v1-copy-attribute-exists/rules.xml b/src/diazo/tests/v1-copy-attribute-exists/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-attribute-exists/rules.xml\nrename to src/diazo/tests/v1-copy-attribute-exists/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-attribute-exists/theme.html b/src/diazo/tests/v1-copy-attribute-exists/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-attribute-exists/theme.html\nrename to src/diazo/tests/v1-copy-attribute-exists/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-attribute-not-exists/content.html b/src/diazo/tests/v1-copy-attribute-not-exists/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-attribute-not-exists/content.html\nrename to src/diazo/tests/v1-copy-attribute-not-exists/content.html\ndiff --git a/lib/diazo/tests/v1-copy-attribute-not-exists/output.html b/src/diazo/tests/v1-copy-attribute-not-exists/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-attribute-not-exists/output.html\nrename to src/diazo/tests/v1-copy-attribute-not-exists/output.html\ndiff --git a/lib/diazo/tests/v1-copy-attribute-not-exists/rules.xml b/src/diazo/tests/v1-copy-attribute-not-exists/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-attribute-not-exists/rules.xml\nrename to src/diazo/tests/v1-copy-attribute-not-exists/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-attribute-not-exists/theme.html b/src/diazo/tests/v1-copy-attribute-not-exists/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-attribute-not-exists/theme.html\nrename to src/diazo/tests/v1-copy-attribute-not-exists/theme.html\ndiff --git a/lib/diazo/tests/v1-copy-multi-attribute/content.html b/src/diazo/tests/v1-copy-multi-attribute/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-multi-attribute/content.html\nrename to src/diazo/tests/v1-copy-multi-attribute/content.html\ndiff --git a/lib/diazo/tests/v1-copy-multi-attribute/output.html b/src/diazo/tests/v1-copy-multi-attribute/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-multi-attribute/output.html\nrename to src/diazo/tests/v1-copy-multi-attribute/output.html\ndiff --git a/lib/diazo/tests/v1-copy-multi-attribute/rules.xml b/src/diazo/tests/v1-copy-multi-attribute/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-multi-attribute/rules.xml\nrename to src/diazo/tests/v1-copy-multi-attribute/rules.xml\ndiff --git a/lib/diazo/tests/v1-copy-multi-attribute/theme.html b/src/diazo/tests/v1-copy-multi-attribute/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-copy-multi-attribute/theme.html\nrename to src/diazo/tests/v1-copy-multi-attribute/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-content/content.html b/src/diazo/tests/v1-drop-all-attributes-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-content/content.html\nrename to src/diazo/tests/v1-drop-all-attributes-content/content.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-content/output.html b/src/diazo/tests/v1-drop-all-attributes-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-content/output.html\nrename to src/diazo/tests/v1-drop-all-attributes-content/output.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-content/rules.xml b/src/diazo/tests/v1-drop-all-attributes-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-content/rules.xml\nrename to src/diazo/tests/v1-drop-all-attributes-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-content/theme.html b/src/diazo/tests/v1-drop-all-attributes-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-content/theme.html\nrename to src/diazo/tests/v1-drop-all-attributes-content/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/content.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/content.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/content.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/output.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/output.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/output.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/rules.xml b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/rules.xml\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/theme.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-1/theme.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-1/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/content.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/content.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/content.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/output.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/output.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/output.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/rules.xml b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/rules.xml\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/theme.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-2/theme.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-2/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/content.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/content.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/content.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/output.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/output.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/output.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/rules.xml b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/rules.xml\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/theme.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-3/theme.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-3/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/content.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/content.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/content.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/output.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/output.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/output.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/rules.xml b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/rules.xml\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/theme.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-4/theme.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-4/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/content.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/content.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/content.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/output.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/output.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/output.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/rules.xml b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/rules.xml\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/theme.html b/src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme-conditional-5/theme.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme-conditional-5/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme/content.html b/src/diazo/tests/v1-drop-all-attributes-theme/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme/content.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme/content.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme/output.html b/src/diazo/tests/v1-drop-all-attributes-theme/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme/output.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme/output.html\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme/rules.xml b/src/diazo/tests/v1-drop-all-attributes-theme/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme/rules.xml\nrename to src/diazo/tests/v1-drop-all-attributes-theme/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-all-attributes-theme/theme.html b/src/diazo/tests/v1-drop-all-attributes-theme/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-all-attributes-theme/theme.html\nrename to src/diazo/tests/v1-drop-all-attributes-theme/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-and-replace-messages/content.html b/src/diazo/tests/v1-drop-and-replace-messages/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-and-replace-messages/content.html\nrename to src/diazo/tests/v1-drop-and-replace-messages/content.html\ndiff --git a/lib/diazo/tests/v1-drop-and-replace-messages/output.html b/src/diazo/tests/v1-drop-and-replace-messages/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-and-replace-messages/output.html\nrename to src/diazo/tests/v1-drop-and-replace-messages/output.html\ndiff --git a/lib/diazo/tests/v1-drop-and-replace-messages/rules.xml b/src/diazo/tests/v1-drop-and-replace-messages/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-and-replace-messages/rules.xml\nrename to src/diazo/tests/v1-drop-and-replace-messages/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-and-replace-messages/theme.html b/src/diazo/tests/v1-drop-and-replace-messages/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-and-replace-messages/theme.html\nrename to src/diazo/tests/v1-drop-and-replace-messages/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-and-replace-portlets/content.html b/src/diazo/tests/v1-drop-and-replace-portlets/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-and-replace-portlets/content.html\nrename to src/diazo/tests/v1-drop-and-replace-portlets/content.html\ndiff --git a/lib/diazo/tests/v1-drop-and-replace-portlets/output.html b/src/diazo/tests/v1-drop-and-replace-portlets/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-and-replace-portlets/output.html\nrename to src/diazo/tests/v1-drop-and-replace-portlets/output.html\ndiff --git a/lib/diazo/tests/v1-drop-and-replace-portlets/rules.xml b/src/diazo/tests/v1-drop-and-replace-portlets/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-and-replace-portlets/rules.xml\nrename to src/diazo/tests/v1-drop-and-replace-portlets/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-and-replace-portlets/theme.html b/src/diazo/tests/v1-drop-and-replace-portlets/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-and-replace-portlets/theme.html\nrename to src/diazo/tests/v1-drop-and-replace-portlets/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-content/content.html b/src/diazo/tests/v1-drop-attribute-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-content/content.html\nrename to src/diazo/tests/v1-drop-attribute-content/content.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-content/output.html b/src/diazo/tests/v1-drop-attribute-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-content/output.html\nrename to src/diazo/tests/v1-drop-attribute-content/output.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-content/rules.xml b/src/diazo/tests/v1-drop-attribute-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-content/rules.xml\nrename to src/diazo/tests/v1-drop-attribute-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-attribute-content/theme.html b/src/diazo/tests/v1-drop-attribute-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-content/theme.html\nrename to src/diazo/tests/v1-drop-attribute-content/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme-conditional-1/content.html b/src/diazo/tests/v1-drop-attribute-theme-conditional-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme-conditional-1/content.html\nrename to src/diazo/tests/v1-drop-attribute-theme-conditional-1/content.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme-conditional-1/output.html b/src/diazo/tests/v1-drop-attribute-theme-conditional-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme-conditional-1/output.html\nrename to src/diazo/tests/v1-drop-attribute-theme-conditional-1/output.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme-conditional-1/rules.xml b/src/diazo/tests/v1-drop-attribute-theme-conditional-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme-conditional-1/rules.xml\nrename to src/diazo/tests/v1-drop-attribute-theme-conditional-1/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme-conditional-1/theme.html b/src/diazo/tests/v1-drop-attribute-theme-conditional-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme-conditional-1/theme.html\nrename to src/diazo/tests/v1-drop-attribute-theme-conditional-1/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme-conditional-2/content.html b/src/diazo/tests/v1-drop-attribute-theme-conditional-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme-conditional-2/content.html\nrename to src/diazo/tests/v1-drop-attribute-theme-conditional-2/content.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme-conditional-2/output.html b/src/diazo/tests/v1-drop-attribute-theme-conditional-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme-conditional-2/output.html\nrename to src/diazo/tests/v1-drop-attribute-theme-conditional-2/output.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme-conditional-2/rules.xml b/src/diazo/tests/v1-drop-attribute-theme-conditional-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme-conditional-2/rules.xml\nrename to src/diazo/tests/v1-drop-attribute-theme-conditional-2/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme-conditional-2/theme.html b/src/diazo/tests/v1-drop-attribute-theme-conditional-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme-conditional-2/theme.html\nrename to src/diazo/tests/v1-drop-attribute-theme-conditional-2/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme/content.html b/src/diazo/tests/v1-drop-attribute-theme/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme/content.html\nrename to src/diazo/tests/v1-drop-attribute-theme/content.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme/output.html b/src/diazo/tests/v1-drop-attribute-theme/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme/output.html\nrename to src/diazo/tests/v1-drop-attribute-theme/output.html\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme/rules.xml b/src/diazo/tests/v1-drop-attribute-theme/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme/rules.xml\nrename to src/diazo/tests/v1-drop-attribute-theme/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-attribute-theme/theme.html b/src/diazo/tests/v1-drop-attribute-theme/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-attribute-theme/theme.html\nrename to src/diazo/tests/v1-drop-attribute-theme/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-multi-attributes-content/content.html b/src/diazo/tests/v1-drop-multi-attributes-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-multi-attributes-content/content.html\nrename to src/diazo/tests/v1-drop-multi-attributes-content/content.html\ndiff --git a/lib/diazo/tests/v1-drop-multi-attributes-content/output.html b/src/diazo/tests/v1-drop-multi-attributes-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-multi-attributes-content/output.html\nrename to src/diazo/tests/v1-drop-multi-attributes-content/output.html\ndiff --git a/lib/diazo/tests/v1-drop-multi-attributes-content/rules.xml b/src/diazo/tests/v1-drop-multi-attributes-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-multi-attributes-content/rules.xml\nrename to src/diazo/tests/v1-drop-multi-attributes-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-multi-attributes-content/theme.html b/src/diazo/tests/v1-drop-multi-attributes-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-multi-attributes-content/theme.html\nrename to src/diazo/tests/v1-drop-multi-attributes-content/theme.html\ndiff --git a/lib/diazo/tests/v1-drop-multi-attributes-theme/content.html b/src/diazo/tests/v1-drop-multi-attributes-theme/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-multi-attributes-theme/content.html\nrename to src/diazo/tests/v1-drop-multi-attributes-theme/content.html\ndiff --git a/lib/diazo/tests/v1-drop-multi-attributes-theme/output.html b/src/diazo/tests/v1-drop-multi-attributes-theme/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-multi-attributes-theme/output.html\nrename to src/diazo/tests/v1-drop-multi-attributes-theme/output.html\ndiff --git a/lib/diazo/tests/v1-drop-multi-attributes-theme/rules.xml b/src/diazo/tests/v1-drop-multi-attributes-theme/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-multi-attributes-theme/rules.xml\nrename to src/diazo/tests/v1-drop-multi-attributes-theme/rules.xml\ndiff --git a/lib/diazo/tests/v1-drop-multi-attributes-theme/theme.html b/src/diazo/tests/v1-drop-multi-attributes-theme/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-drop-multi-attributes-theme/theme.html\nrename to src/diazo/tests/v1-drop-multi-attributes-theme/theme.html\ndiff --git a/lib/diazo/tests/v1-if-content/content.html b/src/diazo/tests/v1-if-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-content/content.html\nrename to src/diazo/tests/v1-if-content/content.html\ndiff --git a/lib/diazo/tests/v1-if-content/output.html b/src/diazo/tests/v1-if-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-content/output.html\nrename to src/diazo/tests/v1-if-content/output.html\ndiff --git a/lib/diazo/tests/v1-if-content/rules.xml b/src/diazo/tests/v1-if-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-content/rules.xml\nrename to src/diazo/tests/v1-if-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-if-content/theme.html b/src/diazo/tests/v1-if-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-content/theme.html\nrename to src/diazo/tests/v1-if-content/theme.html\ndiff --git a/lib/diazo/tests/v1-if-custom-param/content.html b/src/diazo/tests/v1-if-custom-param/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-custom-param/content.html\nrename to src/diazo/tests/v1-if-custom-param/content.html\ndiff --git a/lib/diazo/tests/v1-if-custom-param/options.cfg b/src/diazo/tests/v1-if-custom-param/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-custom-param/options.cfg\nrename to src/diazo/tests/v1-if-custom-param/options.cfg\ndiff --git a/lib/diazo/tests/v1-if-custom-param/output.html b/src/diazo/tests/v1-if-custom-param/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-custom-param/output.html\nrename to src/diazo/tests/v1-if-custom-param/output.html\ndiff --git a/lib/diazo/tests/v1-if-custom-param/rules.xml b/src/diazo/tests/v1-if-custom-param/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-custom-param/rules.xml\nrename to src/diazo/tests/v1-if-custom-param/rules.xml\ndiff --git a/lib/diazo/tests/v1-if-custom-param/theme.html b/src/diazo/tests/v1-if-custom-param/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-custom-param/theme.html\nrename to src/diazo/tests/v1-if-custom-param/theme.html\ndiff --git a/lib/diazo/tests/v1-if-merge/content.html b/src/diazo/tests/v1-if-merge/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-merge/content.html\nrename to src/diazo/tests/v1-if-merge/content.html\ndiff --git a/lib/diazo/tests/v1-if-merge/output.html b/src/diazo/tests/v1-if-merge/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-merge/output.html\nrename to src/diazo/tests/v1-if-merge/output.html\ndiff --git a/lib/diazo/tests/v1-if-merge/rules.xml b/src/diazo/tests/v1-if-merge/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-merge/rules.xml\nrename to src/diazo/tests/v1-if-merge/rules.xml\ndiff --git a/lib/diazo/tests/v1-if-merge/theme.html b/src/diazo/tests/v1-if-merge/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-merge/theme.html\nrename to src/diazo/tests/v1-if-merge/theme.html\ndiff --git a/lib/diazo/tests/v1-if-not-content/content.html b/src/diazo/tests/v1-if-not-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-content/content.html\nrename to src/diazo/tests/v1-if-not-content/content.html\ndiff --git a/lib/diazo/tests/v1-if-not-content/output.html b/src/diazo/tests/v1-if-not-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-content/output.html\nrename to src/diazo/tests/v1-if-not-content/output.html\ndiff --git a/lib/diazo/tests/v1-if-not-content/rules.xml b/src/diazo/tests/v1-if-not-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-content/rules.xml\nrename to src/diazo/tests/v1-if-not-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-if-not-content/theme.html b/src/diazo/tests/v1-if-not-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-content/theme.html\nrename to src/diazo/tests/v1-if-not-content/theme.html\ndiff --git a/lib/diazo/tests/v1-if-not-path/content.html b/src/diazo/tests/v1-if-not-path/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-path/content.html\nrename to src/diazo/tests/v1-if-not-path/content.html\ndiff --git a/lib/diazo/tests/v1-if-not-path/options.cfg b/src/diazo/tests/v1-if-not-path/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-path/options.cfg\nrename to src/diazo/tests/v1-if-not-path/options.cfg\ndiff --git a/lib/diazo/tests/v1-if-not-path/output.html b/src/diazo/tests/v1-if-not-path/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-path/output.html\nrename to src/diazo/tests/v1-if-not-path/output.html\ndiff --git a/lib/diazo/tests/v1-if-not-path/rules.xml b/src/diazo/tests/v1-if-not-path/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-path/rules.xml\nrename to src/diazo/tests/v1-if-not-path/rules.xml\ndiff --git a/lib/diazo/tests/v1-if-not-path/theme.html b/src/diazo/tests/v1-if-not-path/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not-path/theme.html\nrename to src/diazo/tests/v1-if-not-path/theme.html\ndiff --git a/lib/diazo/tests/v1-if-not/content.html b/src/diazo/tests/v1-if-not/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not/content.html\nrename to src/diazo/tests/v1-if-not/content.html\ndiff --git a/lib/diazo/tests/v1-if-not/output.html b/src/diazo/tests/v1-if-not/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not/output.html\nrename to src/diazo/tests/v1-if-not/output.html\ndiff --git a/lib/diazo/tests/v1-if-not/rules.xml b/src/diazo/tests/v1-if-not/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not/rules.xml\nrename to src/diazo/tests/v1-if-not/rules.xml\ndiff --git a/lib/diazo/tests/v1-if-not/theme.html b/src/diazo/tests/v1-if-not/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-not/theme.html\nrename to src/diazo/tests/v1-if-not/theme.html\ndiff --git a/lib/diazo/tests/v1-if-path/content.html b/src/diazo/tests/v1-if-path/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-path/content.html\nrename to src/diazo/tests/v1-if-path/content.html\ndiff --git a/lib/diazo/tests/v1-if-path/options.cfg b/src/diazo/tests/v1-if-path/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-path/options.cfg\nrename to src/diazo/tests/v1-if-path/options.cfg\ndiff --git a/lib/diazo/tests/v1-if-path/output.html b/src/diazo/tests/v1-if-path/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-path/output.html\nrename to src/diazo/tests/v1-if-path/output.html\ndiff --git a/lib/diazo/tests/v1-if-path/rules.xml b/src/diazo/tests/v1-if-path/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-path/rules.xml\nrename to src/diazo/tests/v1-if-path/rules.xml\ndiff --git a/lib/diazo/tests/v1-if-path/theme.html b/src/diazo/tests/v1-if-path/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if-path/theme.html\nrename to src/diazo/tests/v1-if-path/theme.html\ndiff --git a/lib/diazo/tests/v1-if/content.html b/src/diazo/tests/v1-if/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if/content.html\nrename to src/diazo/tests/v1-if/content.html\ndiff --git a/lib/diazo/tests/v1-if/output.html b/src/diazo/tests/v1-if/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if/output.html\nrename to src/diazo/tests/v1-if/output.html\ndiff --git a/lib/diazo/tests/v1-if/rules.xml b/src/diazo/tests/v1-if/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if/rules.xml\nrename to src/diazo/tests/v1-if/rules.xml\ndiff --git a/lib/diazo/tests/v1-if/theme.html b/src/diazo/tests/v1-if/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-if/theme.html\nrename to src/diazo/tests/v1-if/theme.html\ndiff --git a/lib/diazo/tests/v1-merge-multiple-if-true/content.html b/src/diazo/tests/v1-merge-multiple-if-true/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-multiple-if-true/content.html\nrename to src/diazo/tests/v1-merge-multiple-if-true/content.html\ndiff --git a/lib/diazo/tests/v1-merge-multiple-if-true/output.html b/src/diazo/tests/v1-merge-multiple-if-true/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-multiple-if-true/output.html\nrename to src/diazo/tests/v1-merge-multiple-if-true/output.html\ndiff --git a/lib/diazo/tests/v1-merge-multiple-if-true/rules.xml b/src/diazo/tests/v1-merge-multiple-if-true/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-multiple-if-true/rules.xml\nrename to src/diazo/tests/v1-merge-multiple-if-true/rules.xml\ndiff --git a/lib/diazo/tests/v1-merge-multiple-if-true/theme.html b/src/diazo/tests/v1-merge-multiple-if-true/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-multiple-if-true/theme.html\nrename to src/diazo/tests/v1-merge-multiple-if-true/theme.html\ndiff --git a/lib/diazo/tests/v1-merge-multiple/content.html b/src/diazo/tests/v1-merge-multiple/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-multiple/content.html\nrename to src/diazo/tests/v1-merge-multiple/content.html\ndiff --git a/lib/diazo/tests/v1-merge-multiple/output.html b/src/diazo/tests/v1-merge-multiple/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-multiple/output.html\nrename to src/diazo/tests/v1-merge-multiple/output.html\ndiff --git a/lib/diazo/tests/v1-merge-multiple/rules.xml b/src/diazo/tests/v1-merge-multiple/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-multiple/rules.xml\nrename to src/diazo/tests/v1-merge-multiple/rules.xml\ndiff --git a/lib/diazo/tests/v1-merge-multiple/theme.html b/src/diazo/tests/v1-merge-multiple/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-multiple/theme.html\nrename to src/diazo/tests/v1-merge-multiple/theme.html\ndiff --git a/lib/diazo/tests/v1-merge-separator/content.html b/src/diazo/tests/v1-merge-separator/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-separator/content.html\nrename to src/diazo/tests/v1-merge-separator/content.html\ndiff --git a/lib/diazo/tests/v1-merge-separator/output.html b/src/diazo/tests/v1-merge-separator/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-separator/output.html\nrename to src/diazo/tests/v1-merge-separator/output.html\ndiff --git a/lib/diazo/tests/v1-merge-separator/rules.xml b/src/diazo/tests/v1-merge-separator/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-separator/rules.xml\nrename to src/diazo/tests/v1-merge-separator/rules.xml\ndiff --git a/lib/diazo/tests/v1-merge-separator/theme.html b/src/diazo/tests/v1-merge-separator/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge-separator/theme.html\nrename to src/diazo/tests/v1-merge-separator/theme.html\ndiff --git a/lib/diazo/tests/v1-merge/content.html b/src/diazo/tests/v1-merge/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge/content.html\nrename to src/diazo/tests/v1-merge/content.html\ndiff --git a/lib/diazo/tests/v1-merge/output.html b/src/diazo/tests/v1-merge/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge/output.html\nrename to src/diazo/tests/v1-merge/output.html\ndiff --git a/lib/diazo/tests/v1-merge/rules.xml b/src/diazo/tests/v1-merge/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge/rules.xml\nrename to src/diazo/tests/v1-merge/rules.xml\ndiff --git a/lib/diazo/tests/v1-merge/theme.html b/src/diazo/tests/v1-merge/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-merge/theme.html\nrename to src/diazo/tests/v1-merge/theme.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-content/content.html b/src/diazo/tests/v1-notheme-if-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-content/content.html\nrename to src/diazo/tests/v1-notheme-if-content/content.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-content/output.html b/src/diazo/tests/v1-notheme-if-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-content/output.html\nrename to src/diazo/tests/v1-notheme-if-content/output.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-content/rules.xml b/src/diazo/tests/v1-notheme-if-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-content/rules.xml\nrename to src/diazo/tests/v1-notheme-if-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-notheme-if-content/theme.html b/src/diazo/tests/v1-notheme-if-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-content/theme.html\nrename to src/diazo/tests/v1-notheme-if-content/theme.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-merge/content.html b/src/diazo/tests/v1-notheme-if-merge/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-merge/content.html\nrename to src/diazo/tests/v1-notheme-if-merge/content.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-merge/output.html b/src/diazo/tests/v1-notheme-if-merge/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-merge/output.html\nrename to src/diazo/tests/v1-notheme-if-merge/output.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-merge/rules.xml b/src/diazo/tests/v1-notheme-if-merge/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-merge/rules.xml\nrename to src/diazo/tests/v1-notheme-if-merge/rules.xml\ndiff --git a/lib/diazo/tests/v1-notheme-if-merge/theme.html b/src/diazo/tests/v1-notheme-if-merge/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-merge/theme.html\nrename to src/diazo/tests/v1-notheme-if-merge/theme.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-path/content.html b/src/diazo/tests/v1-notheme-if-path/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-path/content.html\nrename to src/diazo/tests/v1-notheme-if-path/content.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-path/options.cfg b/src/diazo/tests/v1-notheme-if-path/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-path/options.cfg\nrename to src/diazo/tests/v1-notheme-if-path/options.cfg\ndiff --git a/lib/diazo/tests/v1-notheme-if-path/output.html b/src/diazo/tests/v1-notheme-if-path/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-path/output.html\nrename to src/diazo/tests/v1-notheme-if-path/output.html\ndiff --git a/lib/diazo/tests/v1-notheme-if-path/rules.xml b/src/diazo/tests/v1-notheme-if-path/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-path/rules.xml\nrename to src/diazo/tests/v1-notheme-if-path/rules.xml\ndiff --git a/lib/diazo/tests/v1-notheme-if-path/theme.html b/src/diazo/tests/v1-notheme-if-path/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if-path/theme.html\nrename to src/diazo/tests/v1-notheme-if-path/theme.html\ndiff --git a/lib/diazo/tests/v1-notheme-if/content.html b/src/diazo/tests/v1-notheme-if/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if/content.html\nrename to src/diazo/tests/v1-notheme-if/content.html\ndiff --git a/lib/diazo/tests/v1-notheme-if/output.html b/src/diazo/tests/v1-notheme-if/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if/output.html\nrename to src/diazo/tests/v1-notheme-if/output.html\ndiff --git a/lib/diazo/tests/v1-notheme-if/rules.xml b/src/diazo/tests/v1-notheme-if/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if/rules.xml\nrename to src/diazo/tests/v1-notheme-if/rules.xml\ndiff --git a/lib/diazo/tests/v1-notheme-if/theme.html b/src/diazo/tests/v1-notheme-if/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-if/theme.html\nrename to src/diazo/tests/v1-notheme-if/theme.html\ndiff --git a/lib/diazo/tests/v1-notheme-nomatch/content.html b/src/diazo/tests/v1-notheme-nomatch/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-nomatch/content.html\nrename to src/diazo/tests/v1-notheme-nomatch/content.html\ndiff --git a/lib/diazo/tests/v1-notheme-nomatch/output.html b/src/diazo/tests/v1-notheme-nomatch/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-nomatch/output.html\nrename to src/diazo/tests/v1-notheme-nomatch/output.html\ndiff --git a/lib/diazo/tests/v1-notheme-nomatch/rules.xml b/src/diazo/tests/v1-notheme-nomatch/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-nomatch/rules.xml\nrename to src/diazo/tests/v1-notheme-nomatch/rules.xml\ndiff --git a/lib/diazo/tests/v1-notheme-nomatch/theme.html b/src/diazo/tests/v1-notheme-nomatch/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-nomatch/theme.html\nrename to src/diazo/tests/v1-notheme-nomatch/theme.html\ndiff --git a/lib/diazo/tests/v1-notheme-theme-precedence/content.html b/src/diazo/tests/v1-notheme-theme-precedence/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-theme-precedence/content.html\nrename to src/diazo/tests/v1-notheme-theme-precedence/content.html\ndiff --git a/lib/diazo/tests/v1-notheme-theme-precedence/options.cfg b/src/diazo/tests/v1-notheme-theme-precedence/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-theme-precedence/options.cfg\nrename to src/diazo/tests/v1-notheme-theme-precedence/options.cfg\ndiff --git a/lib/diazo/tests/v1-notheme-theme-precedence/output.html b/src/diazo/tests/v1-notheme-theme-precedence/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-theme-precedence/output.html\nrename to src/diazo/tests/v1-notheme-theme-precedence/output.html\ndiff --git a/lib/diazo/tests/v1-notheme-theme-precedence/rules.xml b/src/diazo/tests/v1-notheme-theme-precedence/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-theme-precedence/rules.xml\nrename to src/diazo/tests/v1-notheme-theme-precedence/rules.xml\ndiff --git a/lib/diazo/tests/v1-notheme-theme-precedence/theme.html b/src/diazo/tests/v1-notheme-theme-precedence/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-notheme-theme-precedence/theme.html\nrename to src/diazo/tests/v1-notheme-theme-precedence/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-both-children/content.html b/src/diazo/tests/v1-replace-both-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-both-children/content.html\nrename to src/diazo/tests/v1-replace-both-children/content.html\ndiff --git a/lib/diazo/tests/v1-replace-both-children/output.html b/src/diazo/tests/v1-replace-both-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-both-children/output.html\nrename to src/diazo/tests/v1-replace-both-children/output.html\ndiff --git a/lib/diazo/tests/v1-replace-both-children/rules.xml b/src/diazo/tests/v1-replace-both-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-both-children/rules.xml\nrename to src/diazo/tests/v1-replace-both-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-both-children/theme.html b/src/diazo/tests/v1-replace-both-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-both-children/theme.html\nrename to src/diazo/tests/v1-replace-both-children/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-content-children/content.html b/src/diazo/tests/v1-replace-content-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-children/content.html\nrename to src/diazo/tests/v1-replace-content-children/content.html\ndiff --git a/lib/diazo/tests/v1-replace-content-children/output.html b/src/diazo/tests/v1-replace-content-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-children/output.html\nrename to src/diazo/tests/v1-replace-content-children/output.html\ndiff --git a/lib/diazo/tests/v1-replace-content-children/rules.xml b/src/diazo/tests/v1-replace-content-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-children/rules.xml\nrename to src/diazo/tests/v1-replace-content-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-content-children/theme.html b/src/diazo/tests/v1-replace-content-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-children/theme.html\nrename to src/diazo/tests/v1-replace-content-children/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-content-conditional-1/content.html b/src/diazo/tests/v1-replace-content-conditional-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-conditional-1/content.html\nrename to src/diazo/tests/v1-replace-content-conditional-1/content.html\ndiff --git a/lib/diazo/tests/v1-replace-content-conditional-1/output.html b/src/diazo/tests/v1-replace-content-conditional-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-conditional-1/output.html\nrename to src/diazo/tests/v1-replace-content-conditional-1/output.html\ndiff --git a/lib/diazo/tests/v1-replace-content-conditional-1/rules.xml b/src/diazo/tests/v1-replace-content-conditional-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-conditional-1/rules.xml\nrename to src/diazo/tests/v1-replace-content-conditional-1/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-content-conditional-1/theme.html b/src/diazo/tests/v1-replace-content-conditional-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-conditional-1/theme.html\nrename to src/diazo/tests/v1-replace-content-conditional-1/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-content-conditional-2/content.html b/src/diazo/tests/v1-replace-content-conditional-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-conditional-2/content.html\nrename to src/diazo/tests/v1-replace-content-conditional-2/content.html\ndiff --git a/lib/diazo/tests/v1-replace-content-conditional-2/output.html b/src/diazo/tests/v1-replace-content-conditional-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-conditional-2/output.html\nrename to src/diazo/tests/v1-replace-content-conditional-2/output.html\ndiff --git a/lib/diazo/tests/v1-replace-content-conditional-2/rules.xml b/src/diazo/tests/v1-replace-content-conditional-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-conditional-2/rules.xml\nrename to src/diazo/tests/v1-replace-content-conditional-2/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-content-conditional-2/theme.html b/src/diazo/tests/v1-replace-content-conditional-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-conditional-2/theme.html\nrename to src/diazo/tests/v1-replace-content-conditional-2/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children-conditional-1/content.html b/src/diazo/tests/v1-replace-content-content-children-conditional-1/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children-conditional-1/content.html\nrename to src/diazo/tests/v1-replace-content-content-children-conditional-1/content.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children-conditional-1/output.html b/src/diazo/tests/v1-replace-content-content-children-conditional-1/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children-conditional-1/output.html\nrename to src/diazo/tests/v1-replace-content-content-children-conditional-1/output.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children-conditional-1/rules.xml b/src/diazo/tests/v1-replace-content-content-children-conditional-1/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children-conditional-1/rules.xml\nrename to src/diazo/tests/v1-replace-content-content-children-conditional-1/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children-conditional-1/theme.html b/src/diazo/tests/v1-replace-content-content-children-conditional-1/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children-conditional-1/theme.html\nrename to src/diazo/tests/v1-replace-content-content-children-conditional-1/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children-conditional-2/content.html b/src/diazo/tests/v1-replace-content-content-children-conditional-2/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children-conditional-2/content.html\nrename to src/diazo/tests/v1-replace-content-content-children-conditional-2/content.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children-conditional-2/output.html b/src/diazo/tests/v1-replace-content-content-children-conditional-2/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children-conditional-2/output.html\nrename to src/diazo/tests/v1-replace-content-content-children-conditional-2/output.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children-conditional-2/rules.xml b/src/diazo/tests/v1-replace-content-content-children-conditional-2/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children-conditional-2/rules.xml\nrename to src/diazo/tests/v1-replace-content-content-children-conditional-2/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children-conditional-2/theme.html b/src/diazo/tests/v1-replace-content-content-children-conditional-2/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children-conditional-2/theme.html\nrename to src/diazo/tests/v1-replace-content-content-children-conditional-2/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children/content.html b/src/diazo/tests/v1-replace-content-content-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children/content.html\nrename to src/diazo/tests/v1-replace-content-content-children/content.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children/output.html b/src/diazo/tests/v1-replace-content-content-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children/output.html\nrename to src/diazo/tests/v1-replace-content-content-children/output.html\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children/rules.xml b/src/diazo/tests/v1-replace-content-content-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children/rules.xml\nrename to src/diazo/tests/v1-replace-content-content-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-content-content-children/theme.html b/src/diazo/tests/v1-replace-content-content-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content-content-children/theme.html\nrename to src/diazo/tests/v1-replace-content-content-children/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-content/content.html b/src/diazo/tests/v1-replace-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content/content.html\nrename to src/diazo/tests/v1-replace-content/content.html\ndiff --git a/lib/diazo/tests/v1-replace-content/output.html b/src/diazo/tests/v1-replace-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content/output.html\nrename to src/diazo/tests/v1-replace-content/output.html\ndiff --git a/lib/diazo/tests/v1-replace-content/rules.xml b/src/diazo/tests/v1-replace-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content/rules.xml\nrename to src/diazo/tests/v1-replace-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-content/theme.html b/src/diazo/tests/v1-replace-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-content/theme.html\nrename to src/diazo/tests/v1-replace-content/theme.html\ndiff --git a/lib/diazo/tests/v1-replace-theme-children/content.html b/src/diazo/tests/v1-replace-theme-children/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-theme-children/content.html\nrename to src/diazo/tests/v1-replace-theme-children/content.html\ndiff --git a/lib/diazo/tests/v1-replace-theme-children/output.html b/src/diazo/tests/v1-replace-theme-children/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-theme-children/output.html\nrename to src/diazo/tests/v1-replace-theme-children/output.html\ndiff --git a/lib/diazo/tests/v1-replace-theme-children/rules.xml b/src/diazo/tests/v1-replace-theme-children/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-theme-children/rules.xml\nrename to src/diazo/tests/v1-replace-theme-children/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace-theme-children/theme.html b/src/diazo/tests/v1-replace-theme-children/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace-theme-children/theme.html\nrename to src/diazo/tests/v1-replace-theme-children/theme.html\ndiff --git a/lib/diazo/tests/v1-replace/content.html b/src/diazo/tests/v1-replace/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace/content.html\nrename to src/diazo/tests/v1-replace/content.html\ndiff --git a/lib/diazo/tests/v1-replace/output.html b/src/diazo/tests/v1-replace/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace/output.html\nrename to src/diazo/tests/v1-replace/output.html\ndiff --git a/lib/diazo/tests/v1-replace/rules.xml b/src/diazo/tests/v1-replace/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace/rules.xml\nrename to src/diazo/tests/v1-replace/rules.xml\ndiff --git a/lib/diazo/tests/v1-replace/theme.html b/src/diazo/tests/v1-replace/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-replace/theme.html\nrename to src/diazo/tests/v1-replace/theme.html\ndiff --git a/lib/diazo/tests/v1-strip-content/content.html b/src/diazo/tests/v1-strip-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-content/content.html\nrename to src/diazo/tests/v1-strip-content/content.html\ndiff --git a/lib/diazo/tests/v1-strip-content/output.html b/src/diazo/tests/v1-strip-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-content/output.html\nrename to src/diazo/tests/v1-strip-content/output.html\ndiff --git a/lib/diazo/tests/v1-strip-content/rules.xml b/src/diazo/tests/v1-strip-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-content/rules.xml\nrename to src/diazo/tests/v1-strip-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-strip-content/theme.html b/src/diazo/tests/v1-strip-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-content/theme.html\nrename to src/diazo/tests/v1-strip-content/theme.html\ndiff --git a/lib/diazo/tests/v1-strip-if-content/content.html b/src/diazo/tests/v1-strip-if-content/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-if-content/content.html\nrename to src/diazo/tests/v1-strip-if-content/content.html\ndiff --git a/lib/diazo/tests/v1-strip-if-content/output.html b/src/diazo/tests/v1-strip-if-content/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-if-content/output.html\nrename to src/diazo/tests/v1-strip-if-content/output.html\ndiff --git a/lib/diazo/tests/v1-strip-if-content/rules.xml b/src/diazo/tests/v1-strip-if-content/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-if-content/rules.xml\nrename to src/diazo/tests/v1-strip-if-content/rules.xml\ndiff --git a/lib/diazo/tests/v1-strip-if-content/theme.html b/src/diazo/tests/v1-strip-if-content/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-if-content/theme.html\nrename to src/diazo/tests/v1-strip-if-content/theme.html\ndiff --git a/lib/diazo/tests/v1-strip-if-theme/content.html b/src/diazo/tests/v1-strip-if-theme/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-if-theme/content.html\nrename to src/diazo/tests/v1-strip-if-theme/content.html\ndiff --git a/lib/diazo/tests/v1-strip-if-theme/output.html b/src/diazo/tests/v1-strip-if-theme/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-if-theme/output.html\nrename to src/diazo/tests/v1-strip-if-theme/output.html\ndiff --git a/lib/diazo/tests/v1-strip-if-theme/rules.xml b/src/diazo/tests/v1-strip-if-theme/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-if-theme/rules.xml\nrename to src/diazo/tests/v1-strip-if-theme/rules.xml\ndiff --git a/lib/diazo/tests/v1-strip-if-theme/theme.html b/src/diazo/tests/v1-strip-if-theme/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-if-theme/theme.html\nrename to src/diazo/tests/v1-strip-if-theme/theme.html\ndiff --git a/lib/diazo/tests/v1-strip-theme/content.html b/src/diazo/tests/v1-strip-theme/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-theme/content.html\nrename to src/diazo/tests/v1-strip-theme/content.html\ndiff --git a/lib/diazo/tests/v1-strip-theme/output.html b/src/diazo/tests/v1-strip-theme/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-theme/output.html\nrename to src/diazo/tests/v1-strip-theme/output.html\ndiff --git a/lib/diazo/tests/v1-strip-theme/rules.xml b/src/diazo/tests/v1-strip-theme/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-theme/rules.xml\nrename to src/diazo/tests/v1-strip-theme/rules.xml\ndiff --git a/lib/diazo/tests/v1-strip-theme/theme.html b/src/diazo/tests/v1-strip-theme/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/v1-strip-theme/theme.html\nrename to src/diazo/tests/v1-strip-theme/theme.html\ndiff --git a/lib/diazo/tests/without-theme/content.html b/src/diazo/tests/without-theme/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/without-theme/content.html\nrename to src/diazo/tests/without-theme/content.html\ndiff --git a/lib/diazo/tests/without-theme/options.cfg b/src/diazo/tests/without-theme/options.cfg\nsimilarity index 100%\nrename from lib/diazo/tests/without-theme/options.cfg\nrename to src/diazo/tests/without-theme/options.cfg\ndiff --git a/lib/diazo/tests/without-theme/output.html b/src/diazo/tests/without-theme/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/without-theme/output.html\nrename to src/diazo/tests/without-theme/output.html\ndiff --git a/lib/diazo/tests/without-theme/rules.xml b/src/diazo/tests/without-theme/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/without-theme/rules.xml\nrename to src/diazo/tests/without-theme/rules.xml\ndiff --git a/lib/diazo/tests/xinclude/content.html b/src/diazo/tests/xinclude/content.html\nsimilarity index 100%\nrename from lib/diazo/tests/xinclude/content.html\nrename to src/diazo/tests/xinclude/content.html\ndiff --git a/lib/diazo/tests/xinclude/included-rules.xml b/src/diazo/tests/xinclude/included-rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/xinclude/included-rules.xml\nrename to src/diazo/tests/xinclude/included-rules.xml\ndiff --git a/lib/diazo/tests/xinclude/output.html b/src/diazo/tests/xinclude/output.html\nsimilarity index 100%\nrename from lib/diazo/tests/xinclude/output.html\nrename to src/diazo/tests/xinclude/output.html\ndiff --git a/lib/diazo/tests/xinclude/rules.xml b/src/diazo/tests/xinclude/rules.xml\nsimilarity index 100%\nrename from lib/diazo/tests/xinclude/rules.xml\nrename to src/diazo/tests/xinclude/rules.xml\ndiff --git a/lib/diazo/tests/xinclude/theme.html b/src/diazo/tests/xinclude/theme.html\nsimilarity index 100%\nrename from lib/diazo/tests/xinclude/theme.html\nrename to src/diazo/tests/xinclude/theme.html\ndiff --git a/lib/diazo/update-namespace.xsl b/src/diazo/update-namespace.xsl\nsimilarity index 100%\nrename from lib/diazo/update-namespace.xsl\nrename to src/diazo/update-namespace.xsl\ndiff --git a/src/diazo/utils.py b/src/diazo/utils.py\nnew file mode 100644\nindex 0000000..d7e2e67\n--- /dev/null\n+++ b/src/diazo/utils.py\n@@ -0,0 +1,206 @@\n+from lxml import etree\n+from optparse import OptionParser\n+\n+import logging\n+import pkg_resources\n+import sys\n+\n+\n+try:\n+    stdout = sys.stdout.buffer\n+except AttributeError:\n+    # This can happen in (doc-)tests e. g. in plone.app.testing:\n+    stdout = None\n+\n+strparam = etree.XSLT.strparam\n+\n+logger = logging.getLogger("diazo")\n+\n+namespaces = dict(\n+    diazo="http://namespaces.plone.org/diazo",\n+    css="http://namespaces.plone.org/diazo/css",\n+    old1="http://openplans.org/deliverance",\n+    old2="http://namespaces.plone.org/xdv",\n+    oldcss1="http://namespaces.plone.org/xdv+css",\n+    oldcss2="http://namespaces.plone.org/diazo+css",\n+    xml="http://www.w3.org/XML/1998/namespace",\n+    xsl="http://www.w3.org/1999/XSL/Transform",\n+)\n+\n+\n+def localname(name):\n+    return name.rsplit("}", 1)[1]\n+\n+\n+def namespace(name):\n+    return name.rsplit("}", 1)[0][1:]\n+\n+\n+def fullname(namespace, name):\n+    return f"{{{namespace}}}{name}"  # NOQA: S001\n+\n+\n+AC_READ_FILE = etree.XSLTAccessControl(\n+    read_file=True,\n+    write_file=False,\n+    create_dir=False,\n+    read_network=False,\n+    write_network=False,\n+)\n+AC_READ_NET = etree.XSLTAccessControl(\n+    read_file=True,\n+    write_file=False,\n+    create_dir=False,\n+    read_network=True,\n+    write_network=False,\n+)\n+\n+\n+class CustomResolver(etree.Resolver):\n+    def __init__(self, data):\n+        self.data = data\n+\n+    def resolve(self, url, pubid, context):\n+        output = self.data.get(url)\n+        if output is not None:\n+            return self.resolve_string(output, context)\n+\n+\n+class LoggingXSLTWrapper:\n+    def __init__(self, xslt, logger):\n+        self.xslt = xslt\n+        self.logger = logger\n+\n+    def __call__(self, *args, **kw):\n+        result = self.xslt(*args, **kw)\n+        for msg in self.xslt.error_log:\n+            if msg.type == etree.ErrorTypes.ERR_OK:\n+                self.logger.debug(msg.message)\n+            else:\n+                self.logger.debug(msg)\n+        return result\n+\n+\n+def pkg_parse(name, parser=None):\n+    with open(pkg_resources.resource_filename("diazo", name)) as f:\n+        return etree.parse(f, parser=parser)\n+\n+\n+def pkg_xsl(name, parser=None):\n+    return LoggingXSLTWrapper(etree.XSLT(pkg_parse(name, parser)), logger)\n+\n+\n+def quote_param(value):\n+    """Quote for passing as an XSL parameter.\n+\n+    Works with strings, booleans, numbers and None.\n+    """\n+\n+    if isinstance(value, str):\n+        return strparam(value)\n+    elif isinstance(value, bool):\n+        return value and "true()" or "false()"\n+    elif isinstance(value, (int,) + (float,)):\n+        value = repr(value)\n+    elif value is None:\n+        return "/.."\n+    else:\n+        raise ValueError("Cannot convert %s", value)\n+\n+\n+def split_params(s):\n+    """Turn foo,bar=baz into {\'foo\': None, \'bar\': \'baz\'}"""\n+\n+    xsl_params = {}\n+    for param in s.split(","):\n+        tokens = [t.strip() for t in param.split("=")]\n+        xsl_params[tokens[0]] = len(tokens) > 1 and tokens[1] or None\n+    return xsl_params\n+\n+\n+def _createOptionParser(usage):\n+    parser = OptionParser(usage=usage)\n+    parser.add_option(\n+        "-o",\n+        "--output",\n+        metavar="output.xsl",\n+        help="Output filename (instead of stdout)",\n+        dest="output",\n+        default=stdout,\n+    )\n+    parser.add_option(\n+        "-p",\n+        "--pretty-print",\n+        action="store_true",\n+        help="Pretty print output (may alter rendering in browser)",\n+        dest="pretty_print",\n+        default=False,\n+    )\n+    parser.add_option(\n+        "--trace",\n+        action="store_true",\n+        help="Compiler trace logging",\n+        dest="trace",\n+        default=False,\n+    )\n+    parser.add_option(\n+        "-a",\n+        "--absolute-prefix",\n+        metavar="/",\n+        help="relative urls in the theme file will be made into absolute "\n+        "links with this prefix.",\n+        dest="absolute_prefix",\n+        default=None,\n+    )\n+    parser.add_option(\n+        "-i",\n+        "--includemode",\n+        metavar="INC",\n+        help="include mode (document, ssi, ssiwait or esi)",\n+        dest="includemode",\n+        default=None,\n+    )\n+    parser.add_option(\n+        "-n",\n+        "--network",\n+        action="store_true",\n+        help="Allow reads to the network to fetch resources",\n+        dest="read_network",\n+        default=False,\n+    )\n+    parser.add_option(\n+        "-t",\n+        "--theme",\n+        metavar="theme.html",\n+        help="Theme file",\n+        dest="theme",\n+        default=None,\n+    )\n+    parser.add_option(\n+        "-r",\n+        "--rules",\n+        metavar="rules.xml",\n+        help="Diazo rules file",\n+        dest="rules",\n+        default=None,\n+    )\n+    parser.add_option(\n+        "-c",\n+        "--custom-parameters",\n+        metavar="param1,param2=defaultval",\n+        help="Comma-separated list of custom parameter names with optional "\n+        "default values that the compiled theme will be able accept "\n+        "when run",\n+        dest="xsl_params",\n+        default=None,\n+    )\n+    parser.add_option(\n+        "-e",\n+        "--extra",\n+        metavar="extra.xsl",\n+        help="Extra XSL to be included in the transform "\n+        "(deprecated, use inline xsl in the rules instead)",\n+        dest="extra",\n+        default=None,\n+    )\n+    return parser\ndiff --git a/lib/diazo/wsgi.py b/src/diazo/wsgi.py\nsimilarity index 75%\nrename from lib/diazo/wsgi.py\nrename to src/diazo/wsgi.py\nindex 96b184e..60d9c8e 100644\n--- a/lib/diazo/wsgi.py\n+++ b/src/diazo/wsgi.py\n@@ -1,13 +1,10 @@\n-# -*- coding: utf-8 -*-\n-\n from diazo.compiler import compile_theme\n from diazo.utils import pkg_parse\n from diazo.utils import quote_param\n from lxml import etree\n from repoze.xmliter.serializer import XMLSerializer\n from repoze.xmliter.utils import getHTMLSerializer\n-from six import string_types\n-from six.moves.urllib.parse import unquote_plus\n+from urllib.parse import unquote_plus\n from webob import Request\n \n import os.path\n@@ -15,19 +12,33 @@\n import re\n \n \n-DIAZO_OFF_HEADER = \'X-Diazo-Off\'\n+DIAZO_OFF_HEADER = "X-Diazo-Off"\n \n \n def asbool(value):\n-    if isinstance(value, string_types):\n+    if isinstance(value, str):\n         value = value.strip().lower()\n-        if value in (\'true\', \'yes\', \'on\', \'y\', \'t\', \'1\', ):\n+        if value in (\n+            "true",\n+            "yes",\n+            "on",\n+            "y",\n+            "t",\n+            "1",\n+        ):\n             return True\n-        elif value in (\'false\', \'no\', \'off\', \'n\', \'f\', \'0\', ):\n+        elif value in (\n+            "false",\n+            "no",\n+            "off",\n+            "n",\n+            "f",\n+            "0",\n+        ):\n             return False\n         else:\n             raise ValueError(\n-                \'String is not true/false: {value:r}\'.format(\n+                "String is not true/false: {value:r}".format(\n                     value=value,\n                 ),\n             )\n@@ -37,8 +48,9 @@ def asbool(value):\n \n class FilesystemResolver(etree.Resolver):\n     """Resolver for filesystem paths"""\n+\n     def resolve(self, system_url, public_id, context):\n-        if \'://\' not in system_url and os.path.exists(system_url):\n+        if "://" not in system_url and os.path.exists(system_url):\n             return self.resolve_filename(system_url, context)\n         else:\n             return None\n@@ -46,8 +58,9 @@ def resolve(self, system_url, public_id, context):\n \n class NetworkResolver(etree.Resolver):\n     """Resolver for network urls"""\n+\n     def resolve(self, system_url, public_id, context):\n-        if \'://\' in system_url and system_url != \'file:///__diazo__\':\n+        if "://" in system_url and system_url != "file:///__diazo__":\n             return self.resolve_filename(system_url, context)\n         else:\n             return None\n@@ -57,11 +70,11 @@ class PythonResolver(etree.Resolver):\n     """Resolver for python:// urls"""\n \n     def resolve(self, system_url, public_id, context):\n-        if not system_url.lower().startswith(\'python://\'):\n+        if not system_url.lower().startswith("python://"):\n             return None\n \n         spec = system_url[9:]\n-        package, resource_name = spec.split(\'/\', 1)\n+        package, resource_name = spec.split("/", 1)\n         filename = pkg_resources.resource_filename(package, resource_name)\n \n         return self.resolve_filename(filename, context)\n@@ -75,47 +88,50 @@ def __init__(self, app):\n \n     def resolve(self, system_url, public_id, context):\n         # Ignore URLs with a scheme\n-        if \'://\' in system_url:\n+        if "://" in system_url:\n             return None\n \n         # Ignore the special \'diazo:\' resolvers\n-        if system_url.startswith(\'diazo:\'):\n+        if system_url.startswith("diazo:"):\n             return None\n \n         subrequest = Request.blank(system_url)\n         response = subrequest.get_response(self.app)\n \n         status_code, reason = response.status.split(None, 1)\n-        if not status_code == \'200\':\n+        if not status_code == "200":\n             return None\n \n         if response.charset is None:\n-            response.charset = \'UTF-8\'  # Maybe this should be latin1?\n+            response.charset = "UTF-8"  # Maybe this should be latin1?\n \n         result = response.text\n \n         if response.content_type in (\n-            \'text/javascript\',\n-            \'application/x-javascript\',\n+            "text/javascript",\n+            "application/x-javascript",\n         ):\n-            result = u\'\'.join([\n-                u\'<html><body><script type="text/javascript">\',\n-                result,\n-                u\'</script></body></html>\',\n-            ])\n-        elif response.content_type == \'text/css\':\n-            result = u\'\'.join([\n-                u\'<html><body><style type="text/css">\',\n-                result,\n-                u\'</style></body></html>\',\n-            ])\n+            result = "".join(\n+                [\n+                    \'<html><body><script type="text/javascript">\',\n+                    result,\n+                    "</script></body></html>",\n+                ]\n+            )\n+        elif response.content_type == "text/css":\n+            result = "".join(\n+                [\n+                    \'<html><body><style type="text/css">\',\n+                    result,\n+                    "</style></body></html>",\n+                ]\n+            )\n \n         return self.resolve_string(result, context)\n \n \n-class XSLTMiddleware(object):\n-    """Apply XSLT in middleware\n-    """\n+class XSLTMiddleware:\n+    """Apply XSLT in middleware"""\n \n     def __init__(\n         self,\n@@ -127,37 +143,37 @@ def __init__(\n         read_file=True,\n         update_content_length=False,\n         ignored_extensions=(\n-            \'js\',\n-            \'css\',\n-            \'gif\',\n-            \'jpg\',\n-            \'jpeg\',\n-            \'pdf\',\n-            \'ps\',\n-            \'doc\',\n-            \'png\',\n-            \'ico\',\n-            \'mov\',\n-            \'mpg\',\n-            \'mpeg\',\n-            \'mp3\',\n-            \'m4a\',\n-            \'txt\',\n-            \'rtf\',\n-            \'swf\',\n-            \'wav\',\n-            \'zip\',\n-            \'wmv\',\n-            \'ppt\',\n-            \'gz\',\n-            \'tgz\',\n-            \'jar\',\n-            \'xls\',\n-            \'bmp\',\n-            \'tif\',\n-            \'tga\',\n-            \'hqx\',\n-            \'avi\',\n+            "js",\n+            "css",\n+            "gif",\n+            "jpg",\n+            "jpeg",\n+            "pdf",\n+            "ps",\n+            "doc",\n+            "png",\n+            "ico",\n+            "mov",\n+            "mpg",\n+            "mpeg",\n+            "mp3",\n+            "m4a",\n+            "txt",\n+            "rtf",\n+            "swf",\n+            "wav",\n+            "zip",\n+            "wmv",\n+            "ppt",\n+            "gz",\n+            "tgz",\n+            "jar",\n+            "xls",\n+            "bmp",\n+            "tif",\n+            "tga",\n+            "hqx",\n+            "avi",\n         ),\n         environ_param_map=None,\n         unquoted_params=None,\n@@ -165,7 +181,7 @@ def __init__(\n         content_type=None,\n         charset=None,\n         remove_conditional_headers=False,\n-        **params  # NOQA: C816\n+        **params,  # NOQA: C816\n     ):\n         """Initialise, giving a filename or parsed XSLT tree.\n \n@@ -215,37 +231,37 @@ def __init__(\n \n         if content_type is None:\n             mediatype = tree.xpath(\n-                \'/xsl:stylesheet/xsl:output/@media-type\',\n-                namespaces=dict(xsl=\'http://www.w3.org/1999/XSL/Transform\'),\n+                "/xsl:stylesheet/xsl:output/@media-type",\n+                namespaces=dict(xsl="http://www.w3.org/1999/XSL/Transform"),\n             )\n             if mediatype:\n                 content_type = mediatype[-1]\n             else:\n                 method = tree.xpath(\n-                    \'/xsl:stylesheet/xsl:output/@method\',\n+                    "/xsl:stylesheet/xsl:output/@method",\n                     namespaces=dict(\n-                        xsl=\'http://www.w3.org/1999/XSL/Transform\',\n+                        xsl="http://www.w3.org/1999/XSL/Transform",\n                     ),\n                 )\n                 if method:\n                     method = method[-1]\n-                    if method.lower() == \'html\':\n-                        content_type = \'text/html\'\n-                    elif method.lower() == \'text\':\n-                        content_type = \'text/plain\'\n-                    elif method.lower() == \'xml\':\n-                        content_type = \'text/xml\'\n+                    if method.lower() == "html":\n+                        content_type = "text/html"\n+                    elif method.lower() == "text":\n+                        content_type = "text/plain"\n+                    elif method.lower() == "xml":\n+                        content_type = "text/xml"\n         self.content_type = content_type\n \n         if charset is None:\n             encoding = tree.xpath(\n-                \'/xsl:stylesheet/xsl:output/@encoding\',\n-                namespaces=dict(xsl=\'http://www.w3.org/1999/XSL/Transform\'),\n+                "/xsl:stylesheet/xsl:output/@encoding",\n+                namespaces=dict(xsl="http://www.w3.org/1999/XSL/Transform"),\n             )\n             if encoding:\n                 charset = encoding[-1]\n             else:\n-                charset = \'UTF-8\'\n+                charset = "UTF-8"\n         self.charset = charset\n \n         self.read_network = asbool(read_network)\n@@ -262,14 +278,13 @@ def __init__(\n         self.ignored_extensions = frozenset(ignored_extensions)\n \n         self.ignored_pattern = re.compile(\n-            \'^.*\\.({ext:s})$\'.format(ext=\'|\'.join(ignored_extensions)),\n+            r"^.*\\.({ext:s})$".format(ext="|".join(ignored_extensions)),\n         )\n \n         self.environ_param_map = environ_param_map or {}\n-        if isinstance(unquoted_params, string_types):\n+        if isinstance(unquoted_params, str):\n             unquoted_params = unquoted_params.split()\n-        self.unquoted_params = unquoted_params and \\\n-            frozenset(unquoted_params) or ()\n+        self.unquoted_params = unquoted_params and frozenset(unquoted_params) or ()\n         self.params = params\n         self.doctype = doctype\n         self.remove_conditional_headers = asbool(remove_conditional_headers)\n@@ -297,7 +312,7 @@ def __call__(self, environ, start_response):\n             input_encoding = response.charset\n \n             # Note, the Content-Length header will not be set\n-            if request.method == \'HEAD\':\n+            if request.method == "HEAD":\n                 self.reset_headers(response)\n                 return response(environ, start_response)\n \n@@ -312,7 +327,7 @@ def __call__(self, environ, start_response):\n                 # Headers should be left intact\n                 return response(environ, start_response)\n         finally:\n-            if getattr(response.app_iter, \'close\', None):\n+            if getattr(response.app_iter, "close", None):\n                 response.app_iter.close()\n \n         self.reset_headers(response)\n@@ -338,10 +353,10 @@ def __call__(self, environ, start_response):\n         # Set content type (normally inferred from stylesheet)\n         # Unfortunately lxml does not expose docinfo.mediaType\n         if self.content_type is None:\n-            if tree.getroot().tag == \'html\':\n-                response.content_type = \'text/html\'\n+            if tree.getroot().tag == "html":\n+                response.content_type = "text/html"\n             else:\n-                response.content_type = \'text/xml\'\n+                response.content_type = "text/xml"\n         response.charset = tree.docinfo.encoding or self.charset\n \n         # Return a repoze.xmliter XMLSerializer, which helps avoid re-parsing\n@@ -357,10 +372,9 @@ def __call__(self, environ, start_response):\n         return response(environ, start_response)\n \n     def should_ignore(self, request):\n-        """Determine if we should ignore the request\n-        """\n+        """Determine if we should ignore the request"""\n \n-        if asbool(request.headers.get(DIAZO_OFF_HEADER, \'no\')):\n+        if asbool(request.headers.get(DIAZO_OFF_HEADER, "no")):\n             return True\n \n         path = request.path_info\n@@ -370,29 +384,28 @@ def should_ignore(self, request):\n         return False\n \n     def should_transform(self, response):\n-        """Determine if we should transform the response\n-        """\n+        """Determine if we should transform the response"""\n \n-        if asbool(response.headers.get(DIAZO_OFF_HEADER, \'no\')):\n+        if asbool(response.headers.get(DIAZO_OFF_HEADER, "no")):\n             return False\n \n-        content_type = response.headers.get(\'Content-Type\')\n+        content_type = response.headers.get("Content-Type")\n         if not content_type or not (\n-            content_type.lower().startswith(\'text/html\') or\n-            content_type.lower().startswith(\'application/xhtml+xml\')\n+            content_type.lower().startswith("text/html")\n+            or content_type.lower().startswith("application/xhtml+xml")\n         ):\n             return False\n \n-        content_encoding = response.headers.get(\'Content-Encoding\')\n-        if content_encoding in (\'zip\', \'deflate\', \'compress\',):\n+        content_encoding = response.headers.get("Content-Encoding")\n+        if content_encoding in (\n+            "zip",\n+            "deflate",\n+            "compress",\n+        ):\n             return False\n \n         status_code, reason = response.status.split(None, 1)\n-        if (\n-            status_code.startswith(\'3\') or\n-            status_code == \'204\' or\n-            status_code == \'401\'\n-        ):\n+        if status_code.startswith("3") or status_code == "204" or status_code == "401":\n             return False\n \n         if response.content_length == 0:\n@@ -415,9 +428,8 @@ def reset_headers(self, response):\n             response.charset = self.charset\n \n \n-class DiazoMiddleware(object):\n-    """Invoke the Diazo transform as middleware\n-    """\n+class DiazoMiddleware:\n+    """Invoke the Diazo transform as middleware"""\n \n     def __init__(\n         self,\n@@ -426,50 +438,50 @@ def __init__(\n         rules,\n         theme=None,\n         prefix=None,\n-        includemode=\'document\',\n+        includemode="document",\n         debug=False,\n         read_network=False,\n         read_file=True,\n         update_content_length=False,\n         ignored_extensions=(\n-            \'js\',\n-            \'css\',\n-            \'gif\',\n-            \'jpg\',\n-            \'jpeg\',\n-            \'pdf\',\n-            \'ps\',\n-            \'doc\',\n-            \'png\',\n-            \'ico\',\n-            \'mov\',\n-            \'mpg\',\n-            \'mpeg\',\n-            \'mp3\',\n-            \'m4a\',\n-            \'txt\',\n-            \'rtf\',\n-            \'swf\',\n-            \'wav\',\n-            \'zip\',\n-            \'wmv\',\n-            \'ppt\',\n-            \'gz\',\n-            \'tgz\',\n-            \'jar\',\n-            \'xls\',\n-            \'bmp\',\n-            \'tif\',\n-            \'tga\',\n-            \'hqx\',\n-            \'avi\',\n+            "js",\n+            "css",\n+            "gif",\n+            "jpg",\n+            "jpeg",\n+            "pdf",\n+            "ps",\n+            "doc",\n+            "png",\n+            "ico",\n+            "mov",\n+            "mpg",\n+            "mpeg",\n+            "mp3",\n+            "m4a",\n+            "txt",\n+            "rtf",\n+            "swf",\n+            "wav",\n+            "zip",\n+            "wmv",\n+            "ppt",\n+            "gz",\n+            "tgz",\n+            "jar",\n+            "xls",\n+            "bmp",\n+            "tif",\n+            "tga",\n+            "hqx",\n+            "avi",\n         ),\n         environ_param_map=None,\n         unquoted_params=None,\n         doctype=None,\n         content_type=None,\n         filter_xpath=False,\n-        **params  # NOQA: C816\n+        **params,  # NOQA: C816\n     ):\n         """Create the middleware. The parameters are:\n \n@@ -546,12 +558,14 @@ def __init__(\n         self.filter_middleware = self.get_filter_middleware()\n \n         self.environ_param_map = environ_param_map or {}\n-        self.environ_param_map.update({\n-            \'diazo.path\': \'path\',\n-            \'diazo.query_string\': \'query_string\',\n-            \'diazo.host\': \'host\',\n-            \'diazo.scheme\': \'scheme\',\n-        })\n+        self.environ_param_map.update(\n+            {\n+                "diazo.path": "path",\n+                "diazo.query_string": "query_string",\n+                "diazo.host": "host",\n+                "diazo.scheme": "scheme",\n+            }\n+        )\n \n         self.params = params.copy()\n \n@@ -609,11 +623,11 @@ def get_transform_middleware(self):\n             doctype=self.doctype,\n             content_type=self.content_type,\n             unquoted_params=self.unquoted_params,\n-            **self.params  # NOQA: C815,S101\n+            **self.params,  # NOQA: C815,S101\n         )\n \n     def get_filter_middleware(self):\n-        tree = pkg_parse(\'filter_xhtml.xsl\')\n+        tree = pkg_parse("filter_xhtml.xsl")\n         return XSLTMiddleware(\n             self.app,\n             self.global_conf,\n@@ -622,22 +636,22 @@ def get_filter_middleware(self):\n             read_file=False,\n             update_content_length=self.update_content_length,\n             ignored_extensions=self.ignored_extensions,\n-            environ_param_map={\'diazo.filter_xpath\': \'xpath\'},\n-            doctype=\'\',\n+            environ_param_map={"diazo.filter_xpath": "xpath"},\n+            doctype="",\n             content_type=self.content_type,\n-            unquoted_params=[\'xpath\'],\n+            unquoted_params=["xpath"],\n         )\n \n     def __call__(self, environ, start_response):\n         if self.filter_xpath:\n-            filter_xpath = \';filter_xpath=\'\n-            query_string = environ.get(\'QUERY_STRING\', \'\')\n+            filter_xpath = ";filter_xpath="\n+            query_string = environ.get("QUERY_STRING", "")\n             if filter_xpath in query_string:\n-                environ[\'QUERY_STRING\'], xpath = query_string.rsplit(\n+                environ["QUERY_STRING"], xpath = query_string.rsplit(\n                     filter_xpath,\n                     1,\n                 )\n-                environ[\'diazo.filter_xpath\'] = unquote_plus(xpath)\n+                environ["diazo.filter_xpath"] = unquote_plus(xpath)\n                 return self.filter_middleware(environ, start_response)\n \n         transform_middleware = self.transform_middleware\n@@ -649,11 +663,11 @@ def __call__(self, environ, start_response):\n         # Set up variables, some of which are used as transform parameters\n         request = Request(environ)\n \n-        environ[\'diazo.rules\'] = self.rules\n-        environ[\'diazo.absolute_prefix\'] = self.absolute_prefix\n-        environ[\'diazo.path\'] = request.path\n-        environ[\'diazo.query_string\'] = request.query_string\n-        environ[\'diazo.host\'] = request.host\n-        environ[\'diazo.scheme\'] = request.scheme\n+        environ["diazo.rules"] = self.rules\n+        environ["diazo.absolute_prefix"] = self.absolute_prefix\n+        environ["diazo.path"] = request.path\n+        environ["diazo.query_string"] = request.query_string\n+        environ["diazo.host"] = request.host\n+        environ["diazo.scheme"] = request.scheme\n \n         return transform_middleware(environ, start_response)\ndiff --git a/templates/nginx.conf.in b/templates/nginx.conf.in\ndeleted file mode 100644\nindex d0aab53..0000000\n--- a/templates/nginx.conf.in\n+++ /dev/null\n@@ -1,78 +0,0 @@\n-worker_processes 1;\n-error_log ${buildout:directory}/var/log/nginx-error.log debug;\n-\n-events {\n-#    worker_connections  1024;\n-}\n-\n-http {\n-    include ${buildout:directory}/etc/mime.types;\n-#    gzip on;\n-    server {\n-        listen ${port};\n-        server_name localhost;\n-        root ${root};\n-        autoindex on;\n-\n-        # Decide if we need to filter\n-        if ($args ~ "^(.*);filter_xpath=(.*)$") {\n-            set $newargs $1;\n-            set $filter_xpath $2;\n-            # rewrite args to avoid looping\n-            rewrite    ^(.*)$    /_include$1?$newargs?;\n-        }\n-\n-        location @include500 { return 500; }\n-        location @include404 { return 404; }\n-\n-        location ^~ /_include {\n-            # Restrict to subrequests\n-            internal;\n-            error_page 404 = @include404;\n-\n-            # Cache in Varnish for 1h\n-            expires 1h;\n-\n-            # Proxy\n-            rewrite    ^/_include(.*)$    $1    break;\n-            proxy_pass http://127.0.0.1:${port};\n-\n-            # Our safety belt.\n-            proxy_set_header X-Loop 1$http_X_Loop; # unary count\n-            proxy_set_header Accept-Encoding "";\n-            error_page 500 = @include500;\n-            if ($http_X_Loop ~ "11111") {\n-                return 500;\n-            }\n-\n-            # Filter by xpath\n-            xslt_stylesheet ${filter.xsl}\n-                xpath=$filter_xpath\n-                ;\n-            xslt_html_parser on;\n-            xslt_types text/html;\n-        }\n-\n-        # Our styled location.\n-        location /styled {\n-            alias ${root};\n-            xslt_stylesheet ${example.xsl}\n-                path=\'$uri\'\n-                ;\n-            xslt_html_parser on;\n-            xslt_types text/html;\n-            # Switch on ssi here to enable external includes.\n-            ssi on;\n-        }\n-\n-        # Another styled location.\n-        location /styled/ploneorg {\n-            alias ${root}/ploneorg;\n-            xslt_stylesheet ${ploneorg.xsl}\n-                path=\'$uri\'\n-                ;\n-            xslt_html_parser on;\n-            xslt_types text/html;\n-        }\n-    }\n-}\ndiff --git a/templates/varnish.vcl.in b/templates/varnish.vcl.in\ndeleted file mode 100644\nindex 8378dae..0000000\n--- a/templates/varnish.vcl.in\n+++ /dev/null\n@@ -1,14 +0,0 @@\n-backend default {\n-    .host = "127.0.0.1";\n-    .port = "${nginx.conf:port}";\n-}\n-\n-sub vcl_recv {\n-    set req.backend = default;\n-}\n-\n-sub vcl_fetch {\n-    if (obj.http.Content-Type == "text/html; charset=utf-8") {\n-        esi;\n-    }\n-}\ndiff --git a/tox.ini b/tox.ini\nindex 642f24c..d6e347c 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -1,144 +1,216 @@\n-# Tox (http://tox.testrun.org/) is a tool for running tests in multiple virtualenvs.\n-# This configuration file will run the test suite on all supported python versions.\n-# To use it, "pip install -c constrains.txt tox" and then run "tox" from this directory.\n-\n+# Generated from:\n+# https://github.com/plone/meta/tree/main/config/default\n+# See the inline comments on how to expand/tweak this configuration file\n [tox]\n+# We need 4.4.0 for constrain_package_deps.\n+min_version = 4.4.0\n envlist =\n-    py2.7,\n-    py3.5,\n-    py3.6,\n-    py3.7,\n-    py3.8,\n-    py3.9,\n-    py3.10,\n-    docs,\n-    isort,\n-    lint,\n-    coverage-report\n-\n-[testenv]\n-usedevelop = True\n-extras =\n+    lint\n     test\n+    dependencies\n \n-commands =\n-    python -VV\n-    pip list\n-    mkdir -p {toxinidir}/reports/coverage {toxinidir}/reports/pytest\n-    pytest --cov=lib --cov-report=xml --html={toxinidir}/reports/pytest/report-{envname}.html --self-contained-html lib/diazo/tests {posargs}\n \n-setenv =\n-    COVERAGE_FILE=.coverage.{envname}\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [tox]\n+#  envlist_lines = """\n+#      my_other_environment\n+#  """\n+#  config_lines = """\n+#  my_extra_top_level_tox_configuration_lines\n+#  """\n+##\n \n-deps =\n-    -cconstraints.txt\n-    pdbpp\n-    pytest\n-    pytest-cov\n-    pytest-remove-stale-bytecode\n-    pytest-mock\n-    pytest-html\n-\n-whitelist_externals =\n-    mkdir\n-\n-[testenv:coverage-report]\n+[testenv]\n+skip_install = true\n+allowlist_externals =\n+    echo\n+    false\n+# Make sure typos like `tox -e formaat` are caught instead of silently doing nothing.\n+# See https://github.com/tox-dev/tox/issues/2858.\n+commands =\n+    echo "Unrecognized environment name {envname}"\n+    false\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [tox]\n+#  testenv_options = """\n+#  basepython = /usr/bin/python3.8\n+#  """\n+##\n+\n+[testenv:init]\n+description = Prepare environment\n skip_install = true\n+commands =\n+    echo "Initial setup complete"\n \n-depends =\n-    py2.7,\n-    py3.5,\n-    py3.6,\n-    py3.7,\n-    py3.8,\n-    py3.9,\n-    py3.10,\n \n+[testenv:format]\n+description = automatically reformat code\n+skip_install = true\n deps =\n-    -cconstraints.txt\n-    coverage\n-\n-setenv =\n-    COVERAGE_FILE=.coverage\n-\n+    pre-commit\n commands =\n-    coverage erase\n-    coverage combine\n-    coverage report\n-    coverage html\n-    coverage xml\n+    pre-commit run -a pyupgrade\n+    pre-commit run -a isort\n+    pre-commit run -a black\n+    pre-commit run -a zpretty\n \n-[testenv:isort-apply]\n+[testenv:lint]\n+description = run linters that will help improve the code style\n skip_install = true\n-deps = isort\n+deps =\n+    pre-commit\n commands =\n-    isort {toxinidir}/lib setup.py\n+    pre-commit run -a\n \n-[testenv:isort]\n+[testenv:dependencies]\n+description = check if the package defines all its dependencies\n skip_install = true\n-deps = isort\n+deps =\n+    build\n+    z3c.dependencychecker==2.14.3\n commands =\n-    isort --show-config\n-    isort --check-only --diff {toxinidir}/lib setup.py\n-\n-[lint]\n-skip_install = true\n-\n+    python -m build --sdist\n+    dependencychecker\n+\n+[testenv:dependencies-graph]\n+description = generate a graph out of the dependencies of the package\n+skip_install = false\n+allowlist_externals =\n+    sh\n deps =\n-    -cconstraints.txt\n-    flake8\n-    # helper to generate HTML reports:\n-    flake8-html\n-    # Useful flake8 plugins that are Python and Plone specific:\n-    flake8-blind-except\n-    flake8-coding\n-    flake8-commas\n-    flake8-debugger\n-    flake8-deprecated\n-    flake8-isort\n-    flake8-pep3101\n-    flake8-plone-hasattr\n-    flake8-print\n-    flake8-quotes\n-    flake8-string-format\n-    flake8-todo\n-    flake8_strict\n-\n+    pipdeptree==2.5.1\n+    graphviz  # optional dependency of pipdeptree\n commands =\n-    python -VV\n-    pip list\n-    mkdir -p {toxinidir}/_build/reports/flake8\n-    #- flake8 --format=html --htmldir={toxinidir}/_build/reports/flake8 --doctests src tests setup.py\n-    #flake8 src tests setup.py --doctests\n-    - flake8 --format=html --htmldir={toxinidir}/_build/reports/flake8 --doctests lib setup.py\n-    flake8 lib setup.py --doctests\n-\n-whitelist_externals =\n-    mkdir\n-\n-[testenv:docs]\n+    sh -c \'pipdeptree --exclude setuptools,wheel,pipdeptree,zope.interface,zope.component --graph-output svg > dependencies.svg\'\n+\n+[testenv:test]\n+description = run the distribution tests\n+use_develop = true\n+skip_install = false\n+constrain_package_deps = true\n+set_env =\n+    ROBOT_BROWSER=headlesschrome\n+\n+##\n+# Specify extra test environment variables in .meta.toml:\n+#  [tox]\n+#  test_environment_variables = """\n+#      PIP_EXTRA_INDEX_URL=https://my-pypi.my-server.com/\n+#  """\n+#\n+# Set constrain_package_deps .meta.toml:\n+#  [tox]\n+#  constrain_package_deps = "false"\n+##\n+deps =\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+    \n+##\n+# Specify additional deps in .meta.toml:\n+#  [tox]\n+#  test_deps_additional = "-esources/plonegovbr.portal_base[test]"\n+#\n+# Specify a custom constraints file in .meta.toml:\n+#  [tox]\n+#  constraints_file = "https://my-server.com/constraints.txt"\n+##\n commands =\n-    python -VV\n-    pip list\n-    mkdir -p {toxinidir}/_build/\n-    sphinx-build -b html -d {toxinidir}/_build/docs/doctrees docs {toxinidir}/_build/docs/html\n-    # The following line should be enabled if we do have testable code in the docs.\n-    #sphinx-build -b doctest docs build/docs/doctrees\n+    zope-testrunner --all --test-path={toxinidir}/src -s diazo {posargs}\n+extras =\n+    test\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [tox]\n+#  test_extras = """\n+#      tests\n+#      widgets\n+#  """\n+##\n+\n+[testenv:coverage]\n+description = get a test coverage report\n+use_develop = true\n+skip_install = false\n+constrain_package_deps = true\n+set_env =\n+    ROBOT_BROWSER=headlesschrome\n+\n+##\n+# Specify extra test environment variables in .meta.toml:\n+#  [tox]\n+#  test_environment_variables = """\n+#      PIP_EXTRA_INDEX_URL=https://my-pypi.my-server.com/\n+#  """\n+##\n deps =\n-    -cconstraints.txt\n-    Sphinx\n+    coverage\n+    zope.testrunner\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+    \n+commands =\n+    coverage run --branch --source diazo {envbindir}/zope-testrunner --quiet --all --test-path={toxinidir}/src -s diazo {posargs}\n+    coverage report -m --format markdown\n+    coverage xml\n+extras =\n+    test\n \n-whitelist_externals =\n-    mkdir\n \n-[testenv:release]\n+[testenv:release-check]\n+description = ensure that the distribution is ready to release\n skip_install = true\n-\n deps =\n-    -cconstraints.txt\n-    zest.releaser[recommended]\n-\n+    twine\n+    build\n+    towncrier\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+    \n+commands =\n+    # fake version to not have to install the package\n+    # we build the change log as news entries might break\n+    # the README that is displayed on PyPI\n+    towncrier build --version=100.0.0 --yes\n+    python -m build --sdist\n+    twine check dist/*\n+\n+[testenv:circular]\n+description = ensure there are no cyclic dependencies\n+use_develop = true\n+skip_install = false\n+set_env =\n+\n+##\n+# Specify extra test environment variables in .meta.toml:\n+#  [tox]\n+#  test_environment_variables = """\n+#      PIP_EXTRA_INDEX_URL=https://my-pypi.my-server.com/\n+#  """\n+##\n+allowlist_externals =\n+    sh\n+deps =\n+    pipdeptree\n+    pipforester\n+    -c https://dist.plone.org/release/6.0-dev/constraints.txt\n+    \n commands =\n-    python -VV\n-    pip list\n-    fullrelease --no-input -v\n+    # Generate the full dependency tree\n+    sh -c \'pipdeptree -j > forest.json\'\n+    # Generate a DOT graph with the circular dependencies, if any\n+    pipforester -i forest.json -o forest.dot --cycles\n+    # Report if there are any circular dependencies, i.e. error if there are any\n+    pipforester -i forest.json --check-cycles -o /dev/null\n+\n+\n+##\n+# Add extra configuration options in .meta.toml:\n+#  [tox]\n+#  extra_lines = """\n+#  _your own configuration lines_\n+#  """\n+##\ndiff --git a/varnish.cfg b/varnish.cfg\ndeleted file mode 100644\nindex 8a9ae98..0000000\n--- a/varnish.cfg\n+++ /dev/null\n@@ -1,25 +0,0 @@\n-[buildout]\n-extends = nginx.cfg\n-parts +=\n-    varnish-build\n-    varnish\n-    varnish.vcl\n-\n-[example-theme]\n-includemode = esi\n-\n-[varnish-build]\n-recipe= zc.recipe.cmmi\n-url = ${varnish:download-url}\n-\n-[varnish]\n-recipe = plone.recipe.varnish\n-daemon = ${buildout:parts-directory}/varnish-build/sbin/varnishd\n-bind = 127.0.0.1:8001\n-config = ${buildout:directory}/etc/varnish.vcl\n-cache-size = 10M\n-\n-[varnish.vcl]\n-recipe = collective.recipe.template\n-input = ${buildout:directory}/templates/varnish.vcl.in\n-output = ${buildout:directory}/etc/varnish.vcl\n\\ No newline at end of file\ndiff --git a/versions.cfg b/versions.cfg\ndeleted file mode 100644\nindex 0c6d2e4..0000000\n--- a/versions.cfg\n+++ /dev/null\n@@ -1,10 +0,0 @@\n-[buildout]\n-versions = versions\n-\n-[versions]\n-WebOb = 1.4\n-cssselect = 0.9.1\n-lxml = 3.3.5\n-repoze.xmliter = 0.6\n-FormEncode = 1.3.0a1\n-py = 1.11.0\n'

