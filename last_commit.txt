Repository: plone.app.event


Branch: refs/heads/master
Date: 2024-03-06T21:34:27+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.event/commit/a44933c00251fb84f3f614f6a76b407447024326

Conditionally load the zcml for our portlets.

Only load them when plone.app.portlets is available and Classic UI is wanted.
This is the default in Plone 6, but may be switched off in 6.1.
In Plone 7 this won't be the default.

See https://github.com/plone/Products.CMFPlone/issues/3923

Files changed:
A news/3923.bugfix
M plone/app/event/configure.zcml

b'diff --git a/news/3923.bugfix b/news/3923.bugfix\nnew file mode 100644\nindex 00000000..14de9d74\n--- /dev/null\n+++ b/news/3923.bugfix\n@@ -0,0 +1,2 @@\n+Conditionally load the zcml for our portlets.\n+[maurits]\ndiff --git a/plone/app/event/configure.zcml b/plone/app/event/configure.zcml\nindex d2ab79b4..e546895c 100644\n--- a/plone/app/event/configure.zcml\n+++ b/plone/app/event/configure.zcml\n@@ -12,7 +12,6 @@\n   <include package="plone.event" />\n   <include package="plone.resource" />\n   <include package="plone.formwidget.recurrence" />\n-  <include package="plone.app.portlets" />\n   <include package="plone.app.registry" />\n   <include package="plone.app.z3cform" />\n \n@@ -20,11 +19,16 @@\n   <include file="permissions.zcml" />\n   <include package=".dx" />\n   <include package=".browser" />\n-  <include package=".portlets" />\n   <include package=".ical" />\n   <include file="recurrence.zcml" />\n   <include package=".upgrades" />\n \n+  <configure zcml:condition="not-have disable-classic-ui">\n+    <configure zcml:condition="installed plone.app.portlets">\n+      <include package="plone.app.portlets" />\n+      <include package=".portlets" />\n+    </configure>\n+  </configure>\n   <utility\n       name="plone.app.event.SynchronizationStrategies"\n       component=".vocabularies.SynchronizationStrategies"\n'

Repository: plone.app.event


Branch: refs/heads/master
Date: 2024-05-07T14:14:24+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.event/commit/e248da7a4fdca292bd5331e8eb8d26597dd3226d

Merge pull request #389 from plone/maurits-conditional-portlets

Conditionally load the zcml for our portlets.

Files changed:
A news/3923.bugfix
M plone/app/event/configure.zcml

b'diff --git a/news/3923.bugfix b/news/3923.bugfix\nnew file mode 100644\nindex 000000000..14de9d74f\n--- /dev/null\n+++ b/news/3923.bugfix\n@@ -0,0 +1,2 @@\n+Conditionally load the zcml for our portlets.\n+[maurits]\ndiff --git a/plone/app/event/configure.zcml b/plone/app/event/configure.zcml\nindex d2ab79b46..e546895cb 100644\n--- a/plone/app/event/configure.zcml\n+++ b/plone/app/event/configure.zcml\n@@ -12,7 +12,6 @@\n   <include package="plone.event" />\n   <include package="plone.resource" />\n   <include package="plone.formwidget.recurrence" />\n-  <include package="plone.app.portlets" />\n   <include package="plone.app.registry" />\n   <include package="plone.app.z3cform" />\n \n@@ -20,11 +19,16 @@\n   <include file="permissions.zcml" />\n   <include package=".dx" />\n   <include package=".browser" />\n-  <include package=".portlets" />\n   <include package=".ical" />\n   <include file="recurrence.zcml" />\n   <include package=".upgrades" />\n \n+  <configure zcml:condition="not-have disable-classic-ui">\n+    <configure zcml:condition="installed plone.app.portlets">\n+      <include package="plone.app.portlets" />\n+      <include package=".portlets" />\n+    </configure>\n+  </configure>\n   <utility\n       name="plone.app.event.SynchronizationStrategies"\n       component=".vocabularies.SynchronizationStrategies"\n'

