Repository: plone.portlet.collection


Branch: refs/heads/3.3.x
Date: 2023-06-12T16:07:56+02:00
Author: Andreas Zeidler (witsch) <witsch@plone.org>
Commit: https://github.com/plone/plone.portlet.collection/commit/09b20d22d63fc49e51399fcd2bd621cc4fd6d9bf

fix: convert collection to list before randomizing it

`plone.batching` returns a `BaseBatch` object, which causes
`Population must be a sequence.  For dicts or sets, use sorted(d).`
when passed to `random.sample`.

Files changed:
A news/randomization.fix
M plone/portlet/collection/collection.py

b'diff --git a/news/randomization.fix b/news/randomization.fix\nnew file mode 100644\nindex 0000000..bf47f9e\n--- /dev/null\n+++ b/news/randomization.fix\n@@ -0,0 +1,2 @@\n+Convert collection to list before randomizing it\n+[witsch]\ndiff --git a/plone/portlet/collection/collection.py b/plone/portlet/collection/collection.py\nindex 2243674..c45921b 100644\n--- a/plone/portlet/collection/collection.py\n+++ b/plone/portlet/collection/collection.py\n@@ -255,7 +255,7 @@ def _random_results(self):\n                     if brain.getPath() != context_path]\n             if len(results) < limit:\n                 limit = len(results)\n-            results = random.sample(results, limit)\n+            results = random.sample(list(results), limit)\n \n         return results\n \n'

Repository: plone.portlet.collection


Branch: refs/heads/3.3.x
Date: 2023-07-13T17:54:45+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.portlet.collection/commit/3e067b2be5bf3dc9e0c8745d6dbf9a45f31cb68a

Renamed news snippet.

Files changed:
A news/42.bugfix
D news/randomization.fix

b'diff --git a/news/randomization.fix b/news/42.bugfix\nsimilarity index 100%\nrename from news/randomization.fix\nrename to news/42.bugfix\n'

Repository: plone.portlet.collection


Branch: refs/heads/3.3.x
Date: 2023-07-13T18:13:44+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.portlet.collection/commit/6e1534a3a0b980821f0cf4518956ed784ae34cc9

Merge pull request #42 from plone/fix-random-results

fix: convert collection to list before randomizing it

Files changed:
A news/42.bugfix
M plone/portlet/collection/collection.py

b'diff --git a/news/42.bugfix b/news/42.bugfix\nnew file mode 100644\nindex 0000000..bf47f9e\n--- /dev/null\n+++ b/news/42.bugfix\n@@ -0,0 +1,2 @@\n+Convert collection to list before randomizing it\n+[witsch]\ndiff --git a/plone/portlet/collection/collection.py b/plone/portlet/collection/collection.py\nindex 2243674..c45921b 100644\n--- a/plone/portlet/collection/collection.py\n+++ b/plone/portlet/collection/collection.py\n@@ -255,7 +255,7 @@ def _random_results(self):\n                     if brain.getPath() != context_path]\n             if len(results) < limit:\n                 limit = len(results)\n-            results = random.sample(results, limit)\n+            results = random.sample(list(results), limit)\n \n         return results\n \n'

