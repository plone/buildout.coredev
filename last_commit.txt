Repository: plone.app.content


Branch: refs/heads/master
Date: 2020-07-30T13:10:20+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.content/commit/d484bb812f817be5dda8028c2612789bfa29a6c3

Pass default_page_types to allow respecting default_pages_types in folder_contents.

Files changed:
A news/147.bugfix
M plone/app/content/browser/contents/__init__.py

b"diff --git a/news/147.bugfix b/news/147.bugfix\nnew file mode 100644\nindex 0000000..6cc1736\n--- /dev/null\n+++ b/news/147.bugfix\n@@ -0,0 +1,2 @@\n+Pass default_page_types to allow respecting default_pages_types.\n+[pbauer]\n\\ No newline at end of file\ndiff --git a/plone/app/content/browser/contents/__init__.py b/plone/app/content/browser/contents/__init__.py\nindex fbcee04..6b58731 100644\n--- a/plone/app/content/browser/contents/__init__.py\n+++ b/plone/app/content/browser/contents/__init__.py\n@@ -219,6 +219,10 @@ def get_thumb_scale(self):\n         thumb_scale_table = settings.thumb_scale_table\n         return thumb_scale_table\n \n+    def default_page_types(self):\n+        registry = getUtility(IRegistry)\n+        return registry.get('plone.default_page_types', [])\n+\n     @property\n     def ignored_indexes(self):\n         ignored = [\n@@ -291,6 +295,7 @@ def get_options(self):\n             'indexOptionsUrl': '%s/@@qsOptions' % base_url,\n             'contextInfoUrl': '%s{path}/@@fc-contextInfo' % base_url,\n             'setDefaultPageUrl': '%s{path}/@@fc-setDefaultPage' % base_url,\n+            'defaultPageTypes': self.default_page_types(),\n             'searchParam': 'Title',\n             'availableColumns': columns,\n             'attributes': ['Title', 'path', 'getURL', 'getIcon', 'getMimeIcon', 'portal_type'] + list(columns.keys()),  # noqa\n"

Repository: plone.app.content


Branch: refs/heads/master
Date: 2020-07-31T15:59:00+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.content/commit/dbecd6f90e55122d4275e58a65de8a34ed37243c

Merge pull request #208 from plone/fix_default_page_types_in_folder_contents

Pass default_page_types to allow respecting that in folder_contents

Files changed:
A news/147.bugfix
M plone/app/content/browser/contents/__init__.py

b"diff --git a/news/147.bugfix b/news/147.bugfix\nnew file mode 100644\nindex 0000000..6cc1736\n--- /dev/null\n+++ b/news/147.bugfix\n@@ -0,0 +1,2 @@\n+Pass default_page_types to allow respecting default_pages_types.\n+[pbauer]\n\\ No newline at end of file\ndiff --git a/plone/app/content/browser/contents/__init__.py b/plone/app/content/browser/contents/__init__.py\nindex fbcee04..6b58731 100644\n--- a/plone/app/content/browser/contents/__init__.py\n+++ b/plone/app/content/browser/contents/__init__.py\n@@ -219,6 +219,10 @@ def get_thumb_scale(self):\n         thumb_scale_table = settings.thumb_scale_table\n         return thumb_scale_table\n \n+    def default_page_types(self):\n+        registry = getUtility(IRegistry)\n+        return registry.get('plone.default_page_types', [])\n+\n     @property\n     def ignored_indexes(self):\n         ignored = [\n@@ -291,6 +295,7 @@ def get_options(self):\n             'indexOptionsUrl': '%s/@@qsOptions' % base_url,\n             'contextInfoUrl': '%s{path}/@@fc-contextInfo' % base_url,\n             'setDefaultPageUrl': '%s{path}/@@fc-setDefaultPage' % base_url,\n+            'defaultPageTypes': self.default_page_types(),\n             'searchParam': 'Title',\n             'availableColumns': columns,\n             'attributes': ['Title', 'path', 'getURL', 'getIcon', 'getMimeIcon', 'portal_type'] + list(columns.keys()),  # noqa\n"

