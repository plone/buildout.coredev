$ bin/alltests 
#### Running tests for group ATCT ####
Running Products.CMFTestCase.layer.CMFSite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up Products.CMFTestCase.layer.ZCML in # seconds.
  Set up Products.CMFTestCase.layer.CMFSite in # seconds.
  Running:
                  
  Ran 31 tests with 0 failures and 0 errors in # seconds.
Running Products.PloneTestCase.layer.PloneSite tests:
  Tear down Products.CMFTestCase.layer.CMFSite in # seconds.
  Tear down Products.CMFTestCase.layer.ZCML in # seconds.
  Set up Products.PloneTestCase.layer.ZCML in # seconds.
  Set up Products.PloneTestCase.layer.PloneSite in # seconds.
  Running:
                    
  Ran 701 tests with 0 failures and 0 errors in # minutes # seconds.
Tearing down left over layers:
  Tear down Products.PloneTestCase.layer.PloneSite in # seconds.
  Tear down Products.PloneTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
Total: 732 tests, 0 failures, 0 errors in # minutes # seconds.
#### Finished tests for group ATCT ####

#### Running tests for group Archetypes ####
Failed to import ZPsycopgDA
Failed to import ZMySQLDA
Running Testing.ZopeTestCase.layer.ZopeLite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Running:
                  
  Ran 36 tests with 0 failures and 0 errors in # seconds.
Running Products.Archetypes.tests.layer.ZCML tests:
  Set up Products.CMFCore.testing.FunctionalZCMLLayer in # seconds.
  Set up Products.Archetypes.tests.layer.ZCML in # seconds.
  Running:
                  
  Ran 39 tests with 0 failures and 0 errors in # seconds.
Running Products.Archetypes.tests.layer.ArchetypesSite tests:
  Set up Products.Archetypes.tests.layer.ArchetypesSite in # seconds.
  Running:
    1/511 (0.2%)/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/OFS/subscribers.py:73: DeprecationWarning: Products.Archetypes.tests.test_classgen.Dummy.manage_afterAdd is discouraged. You should use event subscribers instead.
  DeprecationWarning)
    6/511 (1.2%)/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/OFS/subscribers.py:73: DeprecationWarning: Products.Archetypes.tests.test_annotation.AnnDummy.manage_afterAdd is discouraged. You should use event subscribers instead.
  DeprecationWarning)
    122/511 (23.9%)/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/OFS/subscribers.py:73: DeprecationWarning: Products.Archetypes.tests.test_event.Dummy.manage_afterAdd is discouraged. You should use event subscribers instead.
  DeprecationWarning)
    436/511 (85.3%)

Failure in test testSame (Products.PortalTransforms.tests.test_transforms.TransformTestSubclass)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Products.PortalTransforms/Products/PortalTransforms/tests/test_transforms.py", line 68, in testSame
    self.do_convert(filename=self.input)
  File "/.../plone-coredev/src/Products.PortalTransforms/Products/PortalTransforms/tests/test_transforms.py", line 60, in do_convert
    got, expected, self.transform.name(), self.input))
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: [<A name=1></a>Chapter&nbsp;44<br>Writing&nbsp;Basic&nbsp;Unit&nbsp;Tests<br>Diﬃculty<br>Newcomer<br>Skills<br>•&nbsp;All&nbsp;you&nbsp;need&nbsp;to&nbsp;know&nbsp;is&nbsp;some&nbsp;Python.<br>Problem/Task<br>As&nbsp;you&nbsp;know&nbsp;by&nbsp;now,&nbsp;Zope&nbsp;3&nbsp;gains&nbsp;its&nbsp;incredible&nbsp;stability&nbsp;from&nbsp;testing&nbsp;any&nbsp;code&nbsp;in&nbsp;great&nbsp;detail.&nbsp;The<br>currently&nbsp;most&nbsp;common&nbsp;method&nbsp;is&nbsp;to&nbsp;write&nbsp;unit&nbsp;tests.&nbsp;This&nbsp;chapter&nbsp;introduces&nbsp;unit&nbsp;tests&nbsp;–&nbsp;which<br>are&nbsp;Zope&nbsp;3&nbsp;independent&nbsp;–&nbsp;and&nbsp;introduces&nbsp;some&nbsp;of&nbsp;the&nbsp;subtleties.<br>Solution<br>44.1<br>Implementing&nbsp;the&nbsp;Sample&nbsp;Class<br>Before&nbsp;we&nbsp;can&nbsp;write&nbsp;tests,&nbsp;we&nbsp;have&nbsp;to&nbsp;write&nbsp;some&nbsp;code&nbsp;that&nbsp;we&nbsp;can&nbsp;test.&nbsp;Here,&nbsp;we&nbsp;will&nbsp;implement<br>a&nbsp;simple&nbsp;class&nbsp;called&nbsp;Sample&nbsp;with&nbsp;a&nbsp;public&nbsp;attribute&nbsp;title&nbsp;and&nbsp;description&nbsp;that&nbsp;is&nbsp;accessed<br>via&nbsp;getDescription()&nbsp;and&nbsp;mutated&nbsp;using&nbsp;setDescription().&nbsp;Further,&nbsp;the&nbsp;description&nbsp;must&nbsp;be<br>either&nbsp;a&nbsp;regular&nbsp;or&nbsp;unicode&nbsp;string.<br>Since&nbsp;this&nbsp;code&nbsp;will&nbsp;not&nbsp;depend&nbsp;on&nbsp;Zope,&nbsp;open&nbsp;a&nbsp;ﬁle&nbsp;named&nbsp;test&nbsp;sample.py&nbsp;anywhere&nbsp;and&nbsp;add<br>the&nbsp;following&nbsp;class:<br>1&nbsp;Sample(object):<br>2<br>&quot;&quot;&quot;A&nbsp;trivial&nbsp;Sample&nbsp;object.&quot;&quot;&quot;<br>3<br>4<br>title&nbsp;=&nbsp;None<br>5<br>6<br>def&nbsp;__init__(self):<br>7<br>&quot;&quot;&quot;Initialize&nbsp;object.&quot;&quot;&quot;<br>8<br>self._description&nbsp;=&nbsp;’’<br>9<br>1<br><hr><A name=2></a>2<br>CHAPTER&nbsp;44.&nbsp;WRITING&nbsp;BASIC&nbsp;UNIT&nbsp;TESTS<br>10<br>def&nbsp;setDescription(self,&nbsp;value):<br>11<br>&quot;&quot;&quot;Change&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;description.&quot;&quot;&quot;<br>12<br>assert&nbsp;isinstance(value,&nbsp;(str,&nbsp;unicode))<br>13<br>self._description&nbsp;=&nbsp;value<br>14<br>15<br>def&nbsp;getDescription(self):<br>16<br>&quot;&quot;&quot;Change&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;description.&quot;&quot;&quot;<br>17<br>return&nbsp;self._description<br>Line&nbsp;4:&nbsp;The&nbsp;title&nbsp;is&nbsp;just&nbsp;publicly&nbsp;declared&nbsp;and&nbsp;a&nbsp;value&nbsp;of&nbsp;None&nbsp;is&nbsp;given.&nbsp;Therefore&nbsp;this&nbsp;is&nbsp;just<br>a&nbsp;regular&nbsp;attribute.<br>Line&nbsp;8:&nbsp;The&nbsp;actual&nbsp;description&nbsp;string&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;description.<br>Line&nbsp;12:&nbsp;Make&nbsp;sure&nbsp;that&nbsp;the&nbsp;description&nbsp;is&nbsp;only&nbsp;a&nbsp;regular&nbsp;or&nbsp;unicode&nbsp;string,&nbsp;like&nbsp;it&nbsp;was&nbsp;stated&nbsp;in<br>the&nbsp;requirements.<br>If&nbsp;you&nbsp;wish&nbsp;you&nbsp;can&nbsp;now&nbsp;manually&nbsp;test&nbsp;the&nbsp;class&nbsp;with&nbsp;the&nbsp;interactive&nbsp;Python&nbsp;shell.&nbsp;Just&nbsp;start<br>Python&nbsp;by&nbsp;entering&nbsp;python&nbsp;in&nbsp;your&nbsp;shell&nbsp;prompt.&nbsp;Note&nbsp;that&nbsp;you&nbsp;should&nbsp;be&nbsp;in&nbsp;the&nbsp;directory&nbsp;in<br>which&nbsp;test&nbsp;sample.py&nbsp;is&nbsp;located&nbsp;when&nbsp;starting&nbsp;Python&nbsp;(an&nbsp;alternative&nbsp;is&nbsp;of&nbsp;course&nbsp;to&nbsp;specify&nbsp;the<br>directory&nbsp;in&nbsp;your&nbsp;PYTHONPATH.)<br>1&nbsp;&gt;&gt;&gt;&nbsp;from&nbsp;test_sample&nbsp;import&nbsp;Sample<br>2&nbsp;&gt;&gt;&gt;&nbsp;sample&nbsp;=&nbsp;Sample()<br>3&nbsp;&gt;&gt;&gt;&nbsp;print&nbsp;sample.title<br>4&nbsp;None<br>5&nbsp;&gt;&gt;&gt;&nbsp;sample.title&nbsp;=&nbsp;’Title’<br>6&nbsp;&gt;&gt;&gt;&nbsp;print&nbsp;sample.title<br>7&nbsp;Title<br>8&nbsp;&gt;&gt;&gt;&nbsp;print&nbsp;sample.getDescription()<br>9<br>10&nbsp;&gt;&gt;&gt;&nbsp;sample.setDescription(’Hello&nbsp;World’)<br>11&nbsp;&gt;&gt;&gt;&nbsp;print&nbsp;sample.getDescription()<br>12&nbsp;Hello&nbsp;World<br>13&nbsp;&gt;&gt;&gt;&nbsp;sample.setDescription(None)<br>14&nbsp;Traceback&nbsp;(most&nbsp;recent&nbsp;call&nbsp;last):<br>15<br>File&nbsp;&quot;&lt;stdin&gt;&quot;,&nbsp;line&nbsp;1,&nbsp;in&nbsp;?<br>16<br>File&nbsp;&quot;test_sample.py&quot;,&nbsp;line&nbsp;31,&nbsp;in&nbsp;setDescription<br>17<br>assert&nbsp;isinstance(value,&nbsp;(str,&nbsp;unicode))<br>18&nbsp;AssertionError<br>As&nbsp;you&nbsp;can&nbsp;see&nbsp;in&nbsp;the&nbsp;last&nbsp;test,&nbsp;non-string&nbsp;object&nbsp;types&nbsp;are&nbsp;not&nbsp;allowed&nbsp;as&nbsp;descriptions&nbsp;and&nbsp;an<br>AssertionError&nbsp;is&nbsp;raised.<br>44.2<br>Writing&nbsp;the&nbsp;Unit&nbsp;Tests<br>The&nbsp;goal&nbsp;of&nbsp;writing&nbsp;the&nbsp;unit&nbsp;tests&nbsp;is&nbsp;to&nbsp;convert&nbsp;this&nbsp;informal,&nbsp;manual,&nbsp;and&nbsp;interactive&nbsp;testing&nbsp;session<br>into&nbsp;a&nbsp;formal&nbsp;test&nbsp;class.&nbsp;Python&nbsp;provides&nbsp;already&nbsp;a&nbsp;module&nbsp;called&nbsp;unittest&nbsp;for&nbsp;this&nbsp;purpose,&nbsp;which<br>is&nbsp;a&nbsp;port&nbsp;of&nbsp;the&nbsp;Java-based&nbsp;unit&nbsp;testing&nbsp;product,&nbsp;JUnit,&nbsp;by&nbsp;Kent&nbsp;Beck&nbsp;and&nbsp;Erich&nbsp;Gamma.&nbsp;There&nbsp;are<br>three&nbsp;levels&nbsp;to&nbsp;the&nbsp;testing&nbsp;framework&nbsp;(this&nbsp;list&nbsp;deviates&nbsp;a&nbsp;bit&nbsp;from&nbsp;the&nbsp;original&nbsp;deﬁnitions&nbsp;as&nbsp;found<br>in&nbsp;the&nbsp;Python&nbsp;library&nbsp;documentation.&nbsp;1).<br>1&nbsp;http://www.python.org/doc/current/lib/module-unittest.html<br><hr><A name=3></a>44.2.&nbsp;WRITING&nbsp;THE&nbsp;UNIT&nbsp;TESTS<br>3<br>The&nbsp;smallest&nbsp;unit&nbsp;is&nbsp;obviously&nbsp;the&nbsp;“test”,&nbsp;which&nbsp;is&nbsp;a&nbsp;single&nbsp;method&nbsp;in&nbsp;a&nbsp;TestCase&nbsp;class&nbsp;that<br>tests&nbsp;the&nbsp;behavior&nbsp;of&nbsp;a&nbsp;small&nbsp;piece&nbsp;of&nbsp;code&nbsp;or&nbsp;a&nbsp;particular&nbsp;aspect&nbsp;of&nbsp;an&nbsp;implementation.&nbsp;The&nbsp;“test<br>case”&nbsp;is&nbsp;then&nbsp;a&nbsp;collection&nbsp;tests&nbsp;that&nbsp;share&nbsp;the&nbsp;same&nbsp;setup/inputs.&nbsp;On&nbsp;top&nbsp;of&nbsp;all&nbsp;of&nbsp;this&nbsp;sits&nbsp;the&nbsp;“test<br>suite”&nbsp;which&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;test&nbsp;cases&nbsp;and/or&nbsp;other&nbsp;test&nbsp;suites.&nbsp;Test&nbsp;suites&nbsp;combine&nbsp;tests&nbsp;that<br>should&nbsp;be&nbsp;executed&nbsp;together.&nbsp;With&nbsp;the&nbsp;correct&nbsp;setup&nbsp;(as&nbsp;shown&nbsp;in&nbsp;the&nbsp;example&nbsp;below),&nbsp;you&nbsp;can<br>then&nbsp;execute&nbsp;test&nbsp;suites.&nbsp;For&nbsp;large&nbsp;projects&nbsp;like&nbsp;Zope&nbsp;3,&nbsp;it&nbsp;is&nbsp;useful&nbsp;to&nbsp;know&nbsp;that&nbsp;there&nbsp;is&nbsp;also&nbsp;the<br>concept&nbsp;of&nbsp;a&nbsp;test&nbsp;runner,&nbsp;which&nbsp;manages&nbsp;the&nbsp;test&nbsp;run&nbsp;of&nbsp;all&nbsp;or&nbsp;a&nbsp;set&nbsp;of&nbsp;tests.&nbsp;The&nbsp;runner&nbsp;provides<br>useful&nbsp;feedback&nbsp;to&nbsp;the&nbsp;application,&nbsp;so&nbsp;that&nbsp;various&nbsp;user&nbsp;interaces&nbsp;can&nbsp;be&nbsp;developed&nbsp;on&nbsp;top&nbsp;of&nbsp;it.<br>But&nbsp;enough&nbsp;about&nbsp;the&nbsp;theory.&nbsp;In&nbsp;the&nbsp;following&nbsp;example,&nbsp;which&nbsp;you&nbsp;can&nbsp;simply&nbsp;put&nbsp;into&nbsp;the&nbsp;same<br>ﬁle&nbsp;as&nbsp;your&nbsp;code&nbsp;above,&nbsp;you&nbsp;will&nbsp;see&nbsp;a&nbsp;test&nbsp;in&nbsp;common&nbsp;Zope&nbsp;3&nbsp;style.<br>1&nbsp;import&nbsp;unittest<br>2<br>3&nbsp;class&nbsp;SampleTest(unittest.TestCase):<br>4<br>&quot;&quot;&quot;Test&nbsp;the&nbsp;Sample&nbsp;class&quot;&quot;&quot;<br>5<br>6<br>def&nbsp;test_title(self):<br>7<br>sample&nbsp;=&nbsp;Sample()<br>8<br>self.assertEqual(sample.title,&nbsp;None)<br>9<br>sample.title&nbsp;=&nbsp;’Sample&nbsp;Title’<br>10<br>self.assertEqual(sample.title,&nbsp;’Sample&nbsp;Title’)<br>11<br>12<br>def&nbsp;test_getDescription(self):<br>13<br>sample&nbsp;=&nbsp;Sample()<br>14<br>self.assertEqual(sample.getDescription(),&nbsp;’’)<br>15<br>sample._description&nbsp;=&nbsp;&quot;Description&quot;<br>16<br>self.assertEqual(sample.getDescription(),&nbsp;’Description’)<br>17<br>18<br>def&nbsp;test_setDescription(self):<br>19<br>sample&nbsp;=&nbsp;Sample()<br>20<br>self.assertEqual(sample._description,&nbsp;’’)<br>21<br>sample.setDescription(’Description’)<br>22<br>self.assertEqual(sample._description,&nbsp;’Description’)<br>23<br>sample.setDescription(u’Description2’)<br>24<br>self.assertEqual(sample._description,&nbsp;u’Description2’)<br>25<br>self.assertRaises(AssertionError,&nbsp;sample.setDescription,&nbsp;None)<br>26<br>27<br>28&nbsp;def&nbsp;test_suite():<br>29<br>return&nbsp;unittest.TestSuite((<br>30<br>unittest.makeSuite(SampleTest),<br>31<br>))<br>32<br>33&nbsp;if&nbsp;__name__&nbsp;==&nbsp;’__main__’:<br>34<br>unittest.main(defaultTest=’test_suite’)<br>Line&nbsp;3–4:&nbsp;We&nbsp;usually&nbsp;develop&nbsp;test&nbsp;classes&nbsp;which&nbsp;must&nbsp;inherit&nbsp;from&nbsp;TestCase.&nbsp;While&nbsp;often&nbsp;not<br>done,&nbsp;it&nbsp;is&nbsp;a&nbsp;good&nbsp;idea&nbsp;to&nbsp;give&nbsp;the&nbsp;class&nbsp;a&nbsp;meaningful&nbsp;docstring&nbsp;that&nbsp;describes&nbsp;the&nbsp;purpose&nbsp;of&nbsp;the<br>tests&nbsp;it&nbsp;includes.<br>Line&nbsp;6,&nbsp;12&nbsp;&amp;&nbsp;18:&nbsp;When&nbsp;a&nbsp;test&nbsp;case&nbsp;is&nbsp;run,&nbsp;a&nbsp;method&nbsp;called&nbsp;runTests()&nbsp;is&nbsp;executed.&nbsp;While&nbsp;it<br>is&nbsp;possible&nbsp;to&nbsp;overrride&nbsp;this&nbsp;method&nbsp;to&nbsp;run&nbsp;tests&nbsp;diﬀerently,&nbsp;the&nbsp;default&nbsp;option&nbsp;will&nbsp;look&nbsp;for&nbsp;any<br>method&nbsp;whose&nbsp;name&nbsp;starts&nbsp;with&nbsp;test&nbsp;and&nbsp;execute&nbsp;it&nbsp;as&nbsp;a&nbsp;single&nbsp;test.&nbsp;This&nbsp;way&nbsp;we&nbsp;can&nbsp;create<br>a&nbsp;“test&nbsp;method”&nbsp;for&nbsp;each&nbsp;aspect,&nbsp;method,&nbsp;function&nbsp;or&nbsp;property&nbsp;of&nbsp;the&nbsp;code&nbsp;to&nbsp;be&nbsp;tested.&nbsp;This<br>default&nbsp;is&nbsp;very&nbsp;sensible&nbsp;and&nbsp;is&nbsp;used&nbsp;everywhere&nbsp;in&nbsp;Zope&nbsp;3.<br><hr><A name=4></a>4<br>CHAPTER&nbsp;44.&nbsp;WRITING&nbsp;BASIC&nbsp;UNIT&nbsp;TESTS<br>Note&nbsp;that&nbsp;there&nbsp;is&nbsp;no&nbsp;docstring&nbsp;for&nbsp;test&nbsp;methods.&nbsp;This&nbsp;is&nbsp;intentional.&nbsp;If&nbsp;a&nbsp;docstring&nbsp;is&nbsp;speciﬁed,<br>it&nbsp;is&nbsp;used&nbsp;instead&nbsp;of&nbsp;the&nbsp;method&nbsp;name&nbsp;to&nbsp;identify&nbsp;the&nbsp;test.&nbsp;When&nbsp;specifying&nbsp;a&nbsp;docstring,&nbsp;we&nbsp;have<br>noticed&nbsp;that&nbsp;it&nbsp;is&nbsp;very&nbsp;diﬃcult&nbsp;to&nbsp;identify&nbsp;the&nbsp;test&nbsp;later;&nbsp;therefore&nbsp;the&nbsp;method&nbsp;name&nbsp;is&nbsp;a&nbsp;much<br>better&nbsp;choice.<br>Line&nbsp;8,&nbsp;10,&nbsp;14,&nbsp;.&nbsp;.&nbsp;.&nbsp;:&nbsp;The&nbsp;TestCase&nbsp;class&nbsp;implements&nbsp;a&nbsp;handful&nbsp;of&nbsp;methods&nbsp;that&nbsp;aid&nbsp;you&nbsp;with&nbsp;the<br>testing.&nbsp;Here&nbsp;are&nbsp;some&nbsp;of&nbsp;the&nbsp;most&nbsp;frequently&nbsp;used&nbsp;ones.&nbsp;For&nbsp;a&nbsp;complete&nbsp;list&nbsp;see&nbsp;the&nbsp;standard<br>Python&nbsp;documentation&nbsp;referenced&nbsp;above.<br>•&nbsp;assertEqual(first,second[,msg])<br>Checks&nbsp;whether&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;value&nbsp;are&nbsp;equal.&nbsp;If&nbsp;the&nbsp;test&nbsp;fails,&nbsp;the&nbsp;msg&nbsp;or&nbsp;None<br>is&nbsp;returned.<br>•&nbsp;assertNotEqual(first,second[,msg])<br>This&nbsp;is&nbsp;simply&nbsp;the&nbsp;opposite&nbsp;to&nbsp;assertEqual()&nbsp;by&nbsp;checking&nbsp;for&nbsp;non-equality.<br>•&nbsp;assertRaises(exception,callable,...)<br>You&nbsp;expect&nbsp;the&nbsp;callable&nbsp;to&nbsp;raise&nbsp;exception&nbsp;when&nbsp;executed.&nbsp;After&nbsp;the&nbsp;callable&nbsp;you&nbsp;can<br>specify&nbsp;any&nbsp;amount&nbsp;of&nbsp;positional&nbsp;and&nbsp;keyword&nbsp;arguments&nbsp;for&nbsp;the&nbsp;callable.&nbsp;If&nbsp;you&nbsp;expect<br>a&nbsp;group&nbsp;of&nbsp;exceptions&nbsp;from&nbsp;the&nbsp;execution,&nbsp;you&nbsp;can&nbsp;make&nbsp;exception&nbsp;a&nbsp;tuple&nbsp;of&nbsp;possible<br>exceptions.<br>•&nbsp;assert&nbsp;(expr[,msg])<br>Assert&nbsp;checks&nbsp;whether&nbsp;the&nbsp;speciﬁed&nbsp;expression&nbsp;executes&nbsp;correctly.&nbsp;If&nbsp;not,&nbsp;the&nbsp;test&nbsp;fails&nbsp;and<br>msg&nbsp;or&nbsp;None&nbsp;is&nbsp;returned.<br>•&nbsp;failUnlessEqual()<br>This&nbsp;testing&nbsp;method&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;assertEqual().<br>•&nbsp;failUnless(expr[,msg])<br>This&nbsp;method&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;assert&nbsp;(expr[,msg]).<br>•&nbsp;failif()<br>This&nbsp;is&nbsp;the&nbsp;opposite&nbsp;to&nbsp;failUnless().<br>•&nbsp;fail([msg])<br>Fails&nbsp;the&nbsp;running&nbsp;test&nbsp;without&nbsp;any&nbsp;evaluation.&nbsp;This&nbsp;is&nbsp;commonly&nbsp;used&nbsp;when&nbsp;testing&nbsp;various<br>possible&nbsp;execution&nbsp;paths&nbsp;at&nbsp;once&nbsp;and&nbsp;you&nbsp;would&nbsp;like&nbsp;to&nbsp;signify&nbsp;a&nbsp;failure&nbsp;if&nbsp;an&nbsp;improper&nbsp;path<br>was&nbsp;taken.<br>Line&nbsp;6–10:&nbsp;This&nbsp;method&nbsp;tests&nbsp;the&nbsp;title&nbsp;attribute&nbsp;of&nbsp;the&nbsp;Sample&nbsp;class.&nbsp;The&nbsp;ﬁrst&nbsp;test&nbsp;should<br>be&nbsp;of&nbsp;course&nbsp;that&nbsp;the&nbsp;attribute&nbsp;exists&nbsp;and&nbsp;has&nbsp;the&nbsp;expected&nbsp;initial&nbsp;value&nbsp;(line&nbsp;8).&nbsp;Then&nbsp;the&nbsp;title<br>attribute&nbsp;is&nbsp;changed&nbsp;and&nbsp;we&nbsp;check&nbsp;whether&nbsp;the&nbsp;value&nbsp;was&nbsp;really&nbsp;stored.&nbsp;This&nbsp;might&nbsp;seem&nbsp;like<br>overkill,&nbsp;but&nbsp;later&nbsp;you&nbsp;might&nbsp;change&nbsp;the&nbsp;title&nbsp;in&nbsp;a&nbsp;way&nbsp;that&nbsp;it&nbsp;uses&nbsp;properties&nbsp;instead.&nbsp;Then&nbsp;it<br>becomes&nbsp;very&nbsp;important&nbsp;to&nbsp;check&nbsp;whether&nbsp;this&nbsp;test&nbsp;still&nbsp;passes.<br>Line&nbsp;12–16:&nbsp;First&nbsp;we&nbsp;simply&nbsp;check&nbsp;that&nbsp;getDescription()&nbsp;returns&nbsp;the&nbsp;correct&nbsp;default&nbsp;value.<br>Since&nbsp;we&nbsp;do&nbsp;not&nbsp;want&nbsp;to&nbsp;use&nbsp;other&nbsp;API&nbsp;calls&nbsp;like&nbsp;setDescription()&nbsp;we&nbsp;set&nbsp;a&nbsp;new&nbsp;value&nbsp;of&nbsp;the<br>description&nbsp;via&nbsp;the&nbsp;implementation-internal&nbsp;description&nbsp;attribute&nbsp;(line&nbsp;15).&nbsp;This&nbsp;is&nbsp;okay!&nbsp;Unit<br>tests&nbsp;can&nbsp;make&nbsp;use&nbsp;of&nbsp;implementation-speciﬁc&nbsp;attributes&nbsp;and&nbsp;methods.&nbsp;Finally&nbsp;we&nbsp;just&nbsp;check&nbsp;that<br>the&nbsp;correct&nbsp;value&nbsp;is&nbsp;returned.<br><hr><A name=5></a>44.3.&nbsp;RUNNING&nbsp;THE&nbsp;TESTS<br>5<br>Line&nbsp;18–25:&nbsp;On&nbsp;line&nbsp;21–24&nbsp;it&nbsp;is&nbsp;checked&nbsp;that&nbsp;both&nbsp;regular&nbsp;and&nbsp;unicode&nbsp;strings&nbsp;are&nbsp;set&nbsp;correctly.<br>In&nbsp;the&nbsp;last&nbsp;line&nbsp;of&nbsp;the&nbsp;test&nbsp;we&nbsp;make&nbsp;sure&nbsp;that&nbsp;no&nbsp;other&nbsp;type&nbsp;of&nbsp;objects&nbsp;can&nbsp;be&nbsp;set&nbsp;as&nbsp;a&nbsp;description<br>and&nbsp;that&nbsp;an&nbsp;error&nbsp;is&nbsp;raised.<br>28–31:&nbsp;This&nbsp;method&nbsp;returns&nbsp;a&nbsp;test&nbsp;suite&nbsp;that&nbsp;includes&nbsp;all&nbsp;test&nbsp;cases&nbsp;created&nbsp;in&nbsp;this&nbsp;module.&nbsp;It&nbsp;is<br>used&nbsp;by&nbsp;the&nbsp;Zope&nbsp;3&nbsp;test&nbsp;runner&nbsp;when&nbsp;it&nbsp;picks&nbsp;up&nbsp;all&nbsp;available&nbsp;tests.&nbsp;You&nbsp;would&nbsp;basically&nbsp;add&nbsp;the<br>line&nbsp;unittest.makeSuite(TestCaseClass)&nbsp;for&nbsp;each&nbsp;additional&nbsp;test&nbsp;case.<br>33–34:&nbsp;In&nbsp;order&nbsp;to&nbsp;make&nbsp;the&nbsp;test&nbsp;module&nbsp;runnable&nbsp;by&nbsp;itself,&nbsp;you&nbsp;can&nbsp;execute&nbsp;unittest.main()<br>when&nbsp;the&nbsp;module&nbsp;is&nbsp;run.<br>44.3<br>Running&nbsp;the&nbsp;Tests<br>You&nbsp;can&nbsp;run&nbsp;the&nbsp;test&nbsp;by&nbsp;simply&nbsp;calling&nbsp;pythontest&nbsp;sample.py&nbsp;from&nbsp;the&nbsp;directory&nbsp;you&nbsp;saved&nbsp;the<br>ﬁle&nbsp;in.&nbsp;Here&nbsp;is&nbsp;the&nbsp;result&nbsp;you&nbsp;should&nbsp;see:<br>.<br>--------------------------------------------------------------------<br>n&nbsp;3&nbsp;tests&nbsp;in&nbsp;0.001s<br>The&nbsp;three&nbsp;dots&nbsp;represent&nbsp;the&nbsp;three&nbsp;tests&nbsp;that&nbsp;were&nbsp;run.&nbsp;If&nbsp;a&nbsp;test&nbsp;had&nbsp;failed,&nbsp;it&nbsp;would&nbsp;have&nbsp;been<br>reported&nbsp;pointing&nbsp;out&nbsp;the&nbsp;failing&nbsp;test&nbsp;and&nbsp;providing&nbsp;a&nbsp;small&nbsp;traceback.<br>When&nbsp;using&nbsp;the&nbsp;default&nbsp;Zope&nbsp;3&nbsp;test&nbsp;runner,&nbsp;tests&nbsp;will&nbsp;be&nbsp;picked&nbsp;up&nbsp;as&nbsp;long&nbsp;as&nbsp;they&nbsp;follow&nbsp;some<br>conventions.<br>•&nbsp;The&nbsp;tests&nbsp;must&nbsp;either&nbsp;be&nbsp;in&nbsp;a&nbsp;package&nbsp;or&nbsp;be&nbsp;a&nbsp;module&nbsp;called&nbsp;tests.<br>•&nbsp;If&nbsp;tests&nbsp;is&nbsp;a&nbsp;package,&nbsp;then&nbsp;all&nbsp;test&nbsp;modules&nbsp;inside&nbsp;must&nbsp;also&nbsp;have&nbsp;a&nbsp;name&nbsp;starting&nbsp;with&nbsp;test,<br>as&nbsp;it&nbsp;is&nbsp;the&nbsp;case&nbsp;with&nbsp;our&nbsp;name&nbsp;test&nbsp;sample.py.<br>•&nbsp;The&nbsp;test&nbsp;module&nbsp;must&nbsp;be&nbsp;somewhere&nbsp;in&nbsp;the&nbsp;Zope&nbsp;3&nbsp;source&nbsp;tree,&nbsp;since&nbsp;the&nbsp;test&nbsp;runner&nbsp;looks<br>only&nbsp;for&nbsp;ﬁles&nbsp;there.<br>In&nbsp;our&nbsp;case,&nbsp;you&nbsp;could&nbsp;simply&nbsp;create&nbsp;a&nbsp;tests&nbsp;package&nbsp;in&nbsp;ZOPE3/src&nbsp;(do&nbsp;not&nbsp;forget&nbsp;the<br>init&nbsp;.<br>py&nbsp;ﬁle).&nbsp;Then&nbsp;place&nbsp;the&nbsp;test&nbsp;sample.py&nbsp;ﬁle&nbsp;into&nbsp;this&nbsp;directory.<br>You&nbsp;you&nbsp;can&nbsp;use&nbsp;the&nbsp;test&nbsp;runner&nbsp;to&nbsp;run&nbsp;only&nbsp;the&nbsp;sample&nbsp;tests&nbsp;as&nbsp;follows&nbsp;from&nbsp;the&nbsp;Zope&nbsp;3&nbsp;root<br>directory:<br>python&nbsp;test.py&nbsp;-vp&nbsp;tests.test_sample<br>The&nbsp;-v&nbsp;option&nbsp;stands&nbsp;for&nbsp;verbose&nbsp;mode,&nbsp;so&nbsp;that&nbsp;detailed&nbsp;information&nbsp;about&nbsp;a&nbsp;test&nbsp;failure&nbsp;is<br>provided.&nbsp;The&nbsp;-p&nbsp;option&nbsp;enables&nbsp;a&nbsp;progress&nbsp;bar&nbsp;that&nbsp;tells&nbsp;you&nbsp;how&nbsp;many&nbsp;tests&nbsp;out&nbsp;of&nbsp;all&nbsp;have&nbsp;been<br>completed.&nbsp;There&nbsp;are&nbsp;many&nbsp;more&nbsp;options&nbsp;that&nbsp;can&nbsp;be&nbsp;speciﬁed.&nbsp;You&nbsp;can&nbsp;get&nbsp;a&nbsp;full&nbsp;list&nbsp;of&nbsp;them&nbsp;with<br>the&nbsp;option&nbsp;-h:&nbsp;pythontest.py-h.<br>The&nbsp;output&nbsp;of&nbsp;the&nbsp;call&nbsp;above&nbsp;is&nbsp;as&nbsp;follows:<br>nfiguration&nbsp;file&nbsp;found.<br>nning&nbsp;UNIT&nbsp;tests&nbsp;at&nbsp;level&nbsp;1<br>nning&nbsp;UNIT&nbsp;tests&nbsp;from&nbsp;/opt/zope/Zope3<br>3/3&nbsp;(100.0%):&nbsp;test_title&nbsp;(tests.test_sample.SampleTest)<br>--------------------------------------------------------------------<br>n&nbsp;3&nbsp;tests&nbsp;in&nbsp;0.002s<br><hr><A name=6></a>6<br>CHAPTER&nbsp;44.&nbsp;WRITING&nbsp;BASIC&nbsp;UNIT&nbsp;TESTS<br>nning&nbsp;FUNCTIONAL&nbsp;tests&nbsp;at&nbsp;level&nbsp;1<br>nning&nbsp;FUNCTIONAL&nbsp;tests&nbsp;from&nbsp;/opt/zope/Zope3<br>--------------------------------------------------------------------<br>n&nbsp;0&nbsp;tests&nbsp;in&nbsp;0.000s<br>Line&nbsp;1:&nbsp;The&nbsp;test&nbsp;runner&nbsp;uses&nbsp;a&nbsp;conﬁguration&nbsp;ﬁle&nbsp;for&nbsp;some&nbsp;setup.&nbsp;This&nbsp;allows&nbsp;developers&nbsp;to&nbsp;use<br>the&nbsp;test&nbsp;runner&nbsp;for&nbsp;other&nbsp;projects&nbsp;as&nbsp;well.&nbsp;This&nbsp;message&nbsp;simply&nbsp;tells&nbsp;us&nbsp;that&nbsp;the&nbsp;conﬁguration&nbsp;ﬁle<br>was&nbsp;found.<br>Line&nbsp;2–8:&nbsp;The&nbsp;unit&nbsp;tests&nbsp;are&nbsp;run.&nbsp;On&nbsp;line&nbsp;4&nbsp;you&nbsp;can&nbsp;see&nbsp;the&nbsp;progress&nbsp;bar.<br>Line&nbsp;9–15:&nbsp;The&nbsp;functional&nbsp;tests&nbsp;are&nbsp;run,&nbsp;since&nbsp;the&nbsp;default&nbsp;test&nbsp;runner&nbsp;runs&nbsp;both&nbsp;types&nbsp;of&nbsp;tests.<br>Since&nbsp;we&nbsp;do&nbsp;not&nbsp;have&nbsp;any&nbsp;functional&nbsp;tests&nbsp;in&nbsp;the&nbsp;speciﬁed&nbsp;module,&nbsp;there&nbsp;are&nbsp;no&nbsp;tests&nbsp;to&nbsp;run.&nbsp;To<br>just&nbsp;run&nbsp;the&nbsp;unit&nbsp;tests,&nbsp;use&nbsp;option&nbsp;-u&nbsp;and&nbsp;-f&nbsp;for&nbsp;just&nbsp;running&nbsp;the&nbsp;functional&nbsp;tests.&nbsp;See&nbsp;“Writing<br>Functional&nbsp;Tests”&nbsp;for&nbsp;more&nbsp;detials&nbsp;on&nbsp;functional&nbsp;tests.<br><hr><A name=7></a>44.3.&nbsp;RUNNING&nbsp;THE&nbsp;TESTS<br>7<br>Exercises<br>1.&nbsp;It&nbsp;is&nbsp;not&nbsp;very&nbsp;common&nbsp;to&nbsp;do&nbsp;the&nbsp;setup&nbsp;–&nbsp;in&nbsp;our&nbsp;case&nbsp;sample=Sample()&nbsp;–&nbsp;in&nbsp;every&nbsp;test<br>method.&nbsp;Instead&nbsp;there&nbsp;exists&nbsp;a&nbsp;method&nbsp;called&nbsp;setUp()&nbsp;and&nbsp;its&nbsp;counterpart&nbsp;tearDown&nbsp;that<br>are&nbsp;run&nbsp;before&nbsp;and&nbsp;after&nbsp;each&nbsp;test,&nbsp;respectively.&nbsp;Change&nbsp;the&nbsp;test&nbsp;code&nbsp;above,&nbsp;so&nbsp;that&nbsp;it&nbsp;uses<br>the&nbsp;setUp()&nbsp;method.&nbsp;In&nbsp;later&nbsp;chapters&nbsp;and&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;book&nbsp;we&nbsp;will&nbsp;frequently&nbsp;use&nbsp;this<br>method&nbsp;of&nbsp;setting&nbsp;up&nbsp;tests.<br>2.&nbsp;Currently&nbsp;the&nbsp;test&nbsp;setDescription()&nbsp;test&nbsp;only&nbsp;veriﬁes&nbsp;that&nbsp;None&nbsp;is&nbsp;not&nbsp;allowed&nbsp;as&nbsp;input<br>value.<br>(a)&nbsp;Improve&nbsp;the&nbsp;test,&nbsp;so&nbsp;that&nbsp;all&nbsp;other&nbsp;builtin&nbsp;types&nbsp;are&nbsp;tested&nbsp;as&nbsp;well.<br>(b)&nbsp;Also,&nbsp;make&nbsp;sure&nbsp;that&nbsp;any&nbsp;objects&nbsp;inheriting&nbsp;from&nbsp;str&nbsp;or&nbsp;unicode&nbsp;pass&nbsp;as&nbsp;valid&nbsp;values.<br><hr>]

!=

[<A name=1></a>Chapter 44<br>Writing Basic Unit Tests<br>Diﬃculty<br>Newcomer<br>Skills<br>• All you need to know is some Python.<br>Problem/Task<br>As you know by now, Zope 3 gains its incredible stability from testing any code in great detail. The<br>currently most common method is to write unit tests. This chapter introduces unit tests – which<br>are Zope 3 independent – and introduces some of the subtleties.<br>Solution<br>44.1<br>Implementing the Sample Class<br>Before we can write tests, we have to write some code that we can test. Here, we will implement<br>a simple class called Sample with a public attribute title and description that is accessed<br>via getDescription() and mutated using setDescription(). Further, the description must be<br>either a regular or unicode string.<br>Since this code will not depend on Zope, open a ﬁle named test sample.py anywhere and add<br>the following class:<br>1 Sample(object):<br>2<br>&quot;&quot;&quot;A trivial Sample object.&quot;&quot;&quot;<br>3<br>4<br>title = None<br>5<br>6<br>def __init__(self):<br>7<br>&quot;&quot;&quot;Initialize object.&quot;&quot;&quot;<br>8<br>self._description = ’’<br>9<br>1<br><hr><A name=2></a>2<br>CHAPTER 44. WRITING BASIC UNIT TESTS<br>10<br>def setDescription(self, value):<br>11<br>&quot;&quot;&quot;Change the value of the description.&quot;&quot;&quot;<br>12<br>assert isinstance(value, (str, unicode))<br>13<br>self._description = value<br>14<br>15<br>def getDescription(self):<br>16<br>&quot;&quot;&quot;Change the value of the description.&quot;&quot;&quot;<br>17<br>return self._description<br>Line 4: The title is just publicly declared and a value of None is given. Therefore this is just<br>a regular attribute.<br>Line 8: The actual description string will be stored in description.<br>Line 12: Make sure that the description is only a regular or unicode string, like it was stated in<br>the requirements.<br>If you wish you can now manually test the class with the interactive Python shell. Just start<br>Python by entering python in your shell prompt. Note that you should be in the directory in<br>which test sample.py is located when starting Python (an alternative is of course to specify the<br>directory in your PYTHONPATH.)<br>1 &gt;&gt;&gt; from test_sample import Sample<br>2 &gt;&gt;&gt; sample = Sample()<br>3 &gt;&gt;&gt; print sample.title<br>4 None<br>5 &gt;&gt;&gt; sample.title = ’Title’<br>6 &gt;&gt;&gt; print sample.title<br>7 Title<br>8 &gt;&gt;&gt; print sample.getDescription()<br>9<br>10 &gt;&gt;&gt; sample.setDescription(’Hello World’)<br>11 &gt;&gt;&gt; print sample.getDescription()<br>12 Hello World<br>13 &gt;&gt;&gt; sample.setDescription(None)<br>14 Traceback (most recent call last):<br>15<br>File &quot;&lt;stdin&gt;&quot;, line 1, in ?<br>16<br>File &quot;test_sample.py&quot;, line 31, in setDescription<br>17<br>assert isinstance(value, (str, unicode))<br>18 AssertionError<br>As you can see in the last test, non-string object types are not allowed as descriptions and an<br>AssertionError is raised.<br>44.2<br>Writing the Unit Tests<br>The goal of writing the unit tests is to convert this informal, manual, and interactive testing session<br>into a formal test class. Python provides already a module called unittest for this purpose, which<br>is a port of the Java-based unit testing product, JUnit, by Kent Beck and Erich Gamma. There are<br>three levels to the testing framework (this list deviates a bit from the original deﬁnitions as found<br>in the Python library documentation. 1).<br>1 http://www.python.org/doc/current/lib/module-unittest.html<br><hr><A name=3></a>44.2. WRITING THE UNIT TESTS<br>3<br>The smallest unit is obviously the “test”, which is a single method in a TestCase class that<br>tests the behavior of a small piece of code or a particular aspect of an implementation. The “test<br>case” is then a collection tests that share the same setup/inputs. On top of all of this sits the “test<br>suite” which is a collection of test cases and/or other test suites. Test suites combine tests that<br>should be executed together. With the correct setup (as shown in the example below), you can<br>then execute test suites. For large projects like Zope 3, it is useful to know that there is also the<br>concept of a test runner, which manages the test run of all or a set of tests. The runner provides<br>useful feedback to the application, so that various user interaces can be developed on top of it.<br>But enough about the theory. In the following example, which you can simply put into the same<br>ﬁle as your code above, you will see a test in common Zope 3 style.<br>1 import unittest<br>2<br>3 class SampleTest(unittest.TestCase):<br>4<br>&quot;&quot;&quot;Test the Sample class&quot;&quot;&quot;<br>5<br>6<br>def test_title(self):<br>7<br>sample = Sample()<br>8<br>self.assertEqual(sample.title, None)<br>9<br>sample.title = ’Sample Title’<br>10<br>self.assertEqual(sample.title, ’Sample Title’)<br>11<br>12<br>def test_getDescription(self):<br>13<br>sample = Sample()<br>14<br>self.assertEqual(sample.getDescription(), ’’)<br>15<br>sample._description = &quot;Description&quot;<br>16<br>self.assertEqual(sample.getDescription(), ’Description’)<br>17<br>18<br>def test_setDescription(self):<br>19<br>sample = Sample()<br>20<br>self.assertEqual(sample._description, ’’)<br>21<br>sample.setDescription(’Description’)<br>22<br>self.assertEqual(sample._description, ’Description’)<br>23<br>sample.setDescription(u’Description2’)<br>24<br>self.assertEqual(sample._description, u’Description2’)<br>25<br>self.assertRaises(AssertionError, sample.setDescription, None)<br>26<br>27<br>28 def test_suite():<br>29<br>return unittest.TestSuite((<br>30<br>unittest.makeSuite(SampleTest),<br>31<br>))<br>32<br>33 if __name__ == ’__main__’:<br>34<br>unittest.main(defaultTest=’test_suite’)<br>Line 3–4: We usually develop test classes which must inherit from TestCase. While often not<br>done, it is a good idea to give the class a meaningful docstring that describes the purpose of the<br>tests it includes.<br>Line 6, 12 &amp; 18: When a test case is run, a method called runTests() is executed. While it<br>is possible to overrride this method to run tests diﬀerently, the default option will look for any<br>method whose name starts with test and execute it as a single test. This way we can create<br>a “test method” for each aspect, method, function or property of the code to be tested. This<br>default is very sensible and is used everywhere in Zope 3.<br><hr><A name=4></a>4<br>CHAPTER 44. WRITING BASIC UNIT TESTS<br>Note that there is no docstring for test methods. This is intentional. If a docstring is speciﬁed,<br>it is used instead of the method name to identify the test. When specifying a docstring, we have<br>noticed that it is very diﬃcult to identify the test later; therefore the method name is a much<br>better choice.<br>Line 8, 10, 14, . . . : The TestCase class implements a handful of methods that aid you with the<br>testing. Here are some of the most frequently used ones. For a complete list see the standard<br>Python documentation referenced above.<br>• assertEqual(first,second[,msg])<br>Checks whether the first and second value are equal. If the test fails, the msg or None<br>is returned.<br>• assertNotEqual(first,second[,msg])<br>This is simply the opposite to assertEqual() by checking for non-equality.<br>• assertRaises(exception,callable,...)<br>You expect the callable to raise exception when executed. After the callable you can<br>specify any amount of positional and keyword arguments for the callable. If you expect<br>a group of exceptions from the execution, you can make exception a tuple of possible<br>exceptions.<br>• assert (expr[,msg])<br>Assert checks whether the speciﬁed expression executes correctly. If not, the test fails and<br>msg or None is returned.<br>• failUnlessEqual()<br>This testing method is equivalent to assertEqual().<br>• failUnless(expr[,msg])<br>This method is equivalent to assert (expr[,msg]).<br>• failif()<br>This is the opposite to failUnless().<br>• fail([msg])<br>Fails the running test without any evaluation. This is commonly used when testing various<br>possible execution paths at once and you would like to signify a failure if an improper path<br>was taken.<br>Line 6–10: This method tests the title attribute of the Sample class. The ﬁrst test should<br>be of course that the attribute exists and has the expected initial value (line 8). Then the title<br>attribute is changed and we check whether the value was really stored. This might seem like<br>overkill, but later you might change the title in a way that it uses properties instead. Then it<br>becomes very important to check whether this test still passes.<br>Line 12–16: First we simply check that getDescription() returns the correct default value.<br>Since we do not want to use other API calls like setDescription() we set a new value of the<br>description via the implementation-internal description attribute (line 15). This is okay! Unit<br>tests can make use of implementation-speciﬁc attributes and methods. Finally we just check that<br>the correct value is returned.<br><hr><A name=5></a>44.3. RUNNING THE TESTS<br>5<br>Line 18–25: On line 21–24 it is checked that both regular and unicode strings are set correctly.<br>In the last line of the test we make sure that no other type of objects can be set as a description<br>and that an error is raised.<br>28–31: This method returns a test suite that includes all test cases created in this module. It is<br>used by the Zope 3 test runner when it picks up all available tests. You would basically add the<br>line unittest.makeSuite(TestCaseClass) for each additional test case.<br>33–34: In order to make the test module runnable by itself, you can execute unittest.main()<br>when the module is run.<br>44.3<br>Running the Tests<br>You can run the test by simply calling pythontest sample.py from the directory you saved the<br>ﬁle in. Here is the result you should see:<br>.<br>--------------------------------------------------------------------<br>n 3 tests in 0.001s<br>The three dots represent the three tests that were run. If a test had failed, it would have been<br>reported pointing out the failing test and providing a small traceback.<br>When using the default Zope 3 test runner, tests will be picked up as long as they follow some<br>conventions.<br>• The tests must either be in a package or be a module called tests.<br>• If tests is a package, then all test modules inside must also have a name starting with test,<br>as it is the case with our name test sample.py.<br>• The test module must be somewhere in the Zope 3 source tree, since the test runner looks<br>only for ﬁles there.<br>In our case, you could simply create a tests package in ZOPE3/src (do not forget the<br>init .<br>py ﬁle). Then place the test sample.py ﬁle into this directory.<br>You you can use the test runner to run only the sample tests as follows from the Zope 3 root<br>directory:<br>python test.py -vp tests.test_sample<br>The -v option stands for verbose mode, so that detailed information about a test failure is<br>provided. The -p option enables a progress bar that tells you how many tests out of all have been<br>completed. There are many more options that can be speciﬁed. You can get a full list of them with<br>the option -h: pythontest.py-h.<br>The output of the call above is as follows:<br>nfiguration file found.<br>nning UNIT tests at level 1<br>nning UNIT tests from /opt/zope/Zope3<br>3/3 (100.0%): test_title (tests.test_sample.SampleTest)<br>--------------------------------------------------------------------<br>n 3 tests in 0.002s<br><hr><A name=6></a>6<br>CHAPTER 44. WRITING BASIC UNIT TESTS<br>nning FUNCTIONAL tests at level 1<br>nning FUNCTIONAL tests from /opt/zope/Zope3<br>--------------------------------------------------------------------<br>n 0 tests in 0.000s<br>Line 1: The test runner uses a conﬁguration ﬁle for some setup. This allows developers to use<br>the test runner for other projects as well. This message simply tells us that the conﬁguration ﬁle<br>was found.<br>Line 2–8: The unit tests are run. On line 4 you can see the progress bar.<br>Line 9–15: The functional tests are run, since the default test runner runs both types of tests.<br>Since we do not have any functional tests in the speciﬁed module, there are no tests to run. To<br>just run the unit tests, use option -u and -f for just running the functional tests. See “Writing<br>Functional Tests” for more detials on functional tests.<br><hr><A name=7></a>44.3. RUNNING THE TESTS<br>7<br>Exercises<br>1. It is not very common to do the setup – in our case sample=Sample() – in every test<br>method. Instead there exists a method called setUp() and its counterpart tearDown that<br>are run before and after each test, respectively. Change the test code above, so that it uses<br>the setUp() method. In later chapters and the rest of the book we will frequently use this<br>method of setting up tests.<br>2. Currently the test setDescription() test only veriﬁes that None is not allowed as input<br>value.<br>(a) Improve the test, so that all other builtin types are tested as well.<br>(b) Also, make sure that any objects inheriting from str or unicode pass as valid values.<br><hr>]

IN pdf_to_html(/.../plone-coredev/src/Products.PortalTransforms/Products/PortalTransforms/tests/input/demo1.pdf)

    437/511 (85.5%)

Failure in test testSameNoFilename (Products.PortalTransforms.tests.test_transforms.TransformTestSubclass)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Products.PortalTransforms/Products/PortalTransforms/tests/test_transforms.py", line 74, in testSameNoFilename
    self.do_convert()
  File "/.../plone-coredev/src/Products.PortalTransforms/Products/PortalTransforms/tests/test_transforms.py", line 60, in do_convert
    got, expected, self.transform.name(), self.input))
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: [<A name=1></a>Chapter&nbsp;44<br>Writing&nbsp;Basic&nbsp;Unit&nbsp;Tests<br>Diﬃculty<br>Newcomer<br>Skills<br>•&nbsp;All&nbsp;you&nbsp;need&nbsp;to&nbsp;know&nbsp;is&nbsp;some&nbsp;Python.<br>Problem/Task<br>As&nbsp;you&nbsp;know&nbsp;by&nbsp;now,&nbsp;Zope&nbsp;3&nbsp;gains&nbsp;its&nbsp;incredible&nbsp;stability&nbsp;from&nbsp;testing&nbsp;any&nbsp;code&nbsp;in&nbsp;great&nbsp;detail.&nbsp;The<br>currently&nbsp;most&nbsp;common&nbsp;method&nbsp;is&nbsp;to&nbsp;write&nbsp;unit&nbsp;tests.&nbsp;This&nbsp;chapter&nbsp;introduces&nbsp;unit&nbsp;tests&nbsp;–&nbsp;which<br>are&nbsp;Zope&nbsp;3&nbsp;independent&nbsp;–&nbsp;and&nbsp;introduces&nbsp;some&nbsp;of&nbsp;the&nbsp;subtleties.<br>Solution<br>44.1<br>Implementing&nbsp;the&nbsp;Sample&nbsp;Class<br>Before&nbsp;we&nbsp;can&nbsp;write&nbsp;tests,&nbsp;we&nbsp;have&nbsp;to&nbsp;write&nbsp;some&nbsp;code&nbsp;that&nbsp;we&nbsp;can&nbsp;test.&nbsp;Here,&nbsp;we&nbsp;will&nbsp;implement<br>a&nbsp;simple&nbsp;class&nbsp;called&nbsp;Sample&nbsp;with&nbsp;a&nbsp;public&nbsp;attribute&nbsp;title&nbsp;and&nbsp;description&nbsp;that&nbsp;is&nbsp;accessed<br>via&nbsp;getDescription()&nbsp;and&nbsp;mutated&nbsp;using&nbsp;setDescription().&nbsp;Further,&nbsp;the&nbsp;description&nbsp;must&nbsp;be<br>either&nbsp;a&nbsp;regular&nbsp;or&nbsp;unicode&nbsp;string.<br>Since&nbsp;this&nbsp;code&nbsp;will&nbsp;not&nbsp;depend&nbsp;on&nbsp;Zope,&nbsp;open&nbsp;a&nbsp;ﬁle&nbsp;named&nbsp;test&nbsp;sample.py&nbsp;anywhere&nbsp;and&nbsp;add<br>the&nbsp;following&nbsp;class:<br>1&nbsp;Sample(object):<br>2<br>&quot;&quot;&quot;A&nbsp;trivial&nbsp;Sample&nbsp;object.&quot;&quot;&quot;<br>3<br>4<br>title&nbsp;=&nbsp;None<br>5<br>6<br>def&nbsp;__init__(self):<br>7<br>&quot;&quot;&quot;Initialize&nbsp;object.&quot;&quot;&quot;<br>8<br>self._description&nbsp;=&nbsp;’’<br>9<br>1<br><hr><A name=2></a>2<br>CHAPTER&nbsp;44.&nbsp;WRITING&nbsp;BASIC&nbsp;UNIT&nbsp;TESTS<br>10<br>def&nbsp;setDescription(self,&nbsp;value):<br>11<br>&quot;&quot;&quot;Change&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;description.&quot;&quot;&quot;<br>12<br>assert&nbsp;isinstance(value,&nbsp;(str,&nbsp;unicode))<br>13<br>self._description&nbsp;=&nbsp;value<br>14<br>15<br>def&nbsp;getDescription(self):<br>16<br>&quot;&quot;&quot;Change&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;description.&quot;&quot;&quot;<br>17<br>return&nbsp;self._description<br>Line&nbsp;4:&nbsp;The&nbsp;title&nbsp;is&nbsp;just&nbsp;publicly&nbsp;declared&nbsp;and&nbsp;a&nbsp;value&nbsp;of&nbsp;None&nbsp;is&nbsp;given.&nbsp;Therefore&nbsp;this&nbsp;is&nbsp;just<br>a&nbsp;regular&nbsp;attribute.<br>Line&nbsp;8:&nbsp;The&nbsp;actual&nbsp;description&nbsp;string&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;description.<br>Line&nbsp;12:&nbsp;Make&nbsp;sure&nbsp;that&nbsp;the&nbsp;description&nbsp;is&nbsp;only&nbsp;a&nbsp;regular&nbsp;or&nbsp;unicode&nbsp;string,&nbsp;like&nbsp;it&nbsp;was&nbsp;stated&nbsp;in<br>the&nbsp;requirements.<br>If&nbsp;you&nbsp;wish&nbsp;you&nbsp;can&nbsp;now&nbsp;manually&nbsp;test&nbsp;the&nbsp;class&nbsp;with&nbsp;the&nbsp;interactive&nbsp;Python&nbsp;shell.&nbsp;Just&nbsp;start<br>Python&nbsp;by&nbsp;entering&nbsp;python&nbsp;in&nbsp;your&nbsp;shell&nbsp;prompt.&nbsp;Note&nbsp;that&nbsp;you&nbsp;should&nbsp;be&nbsp;in&nbsp;the&nbsp;directory&nbsp;in<br>which&nbsp;test&nbsp;sample.py&nbsp;is&nbsp;located&nbsp;when&nbsp;starting&nbsp;Python&nbsp;(an&nbsp;alternative&nbsp;is&nbsp;of&nbsp;course&nbsp;to&nbsp;specify&nbsp;the<br>directory&nbsp;in&nbsp;your&nbsp;PYTHONPATH.)<br>1&nbsp;&gt;&gt;&gt;&nbsp;from&nbsp;test_sample&nbsp;import&nbsp;Sample<br>2&nbsp;&gt;&gt;&gt;&nbsp;sample&nbsp;=&nbsp;Sample()<br>3&nbsp;&gt;&gt;&gt;&nbsp;print&nbsp;sample.title<br>4&nbsp;None<br>5&nbsp;&gt;&gt;&gt;&nbsp;sample.title&nbsp;=&nbsp;’Title’<br>6&nbsp;&gt;&gt;&gt;&nbsp;print&nbsp;sample.title<br>7&nbsp;Title<br>8&nbsp;&gt;&gt;&gt;&nbsp;print&nbsp;sample.getDescription()<br>9<br>10&nbsp;&gt;&gt;&gt;&nbsp;sample.setDescription(’Hello&nbsp;World’)<br>11&nbsp;&gt;&gt;&gt;&nbsp;print&nbsp;sample.getDescription()<br>12&nbsp;Hello&nbsp;World<br>13&nbsp;&gt;&gt;&gt;&nbsp;sample.setDescription(None)<br>14&nbsp;Traceback&nbsp;(most&nbsp;recent&nbsp;call&nbsp;last):<br>15<br>File&nbsp;&quot;&lt;stdin&gt;&quot;,&nbsp;line&nbsp;1,&nbsp;in&nbsp;?<br>16<br>File&nbsp;&quot;test_sample.py&quot;,&nbsp;line&nbsp;31,&nbsp;in&nbsp;setDescription<br>17<br>assert&nbsp;isinstance(value,&nbsp;(str,&nbsp;unicode))<br>18&nbsp;AssertionError<br>As&nbsp;you&nbsp;can&nbsp;see&nbsp;in&nbsp;the&nbsp;last&nbsp;test,&nbsp;non-string&nbsp;object&nbsp;types&nbsp;are&nbsp;not&nbsp;allowed&nbsp;as&nbsp;descriptions&nbsp;and&nbsp;an<br>AssertionError&nbsp;is&nbsp;raised.<br>44.2<br>Writing&nbsp;the&nbsp;Unit&nbsp;Tests<br>The&nbsp;goal&nbsp;of&nbsp;writing&nbsp;the&nbsp;unit&nbsp;tests&nbsp;is&nbsp;to&nbsp;convert&nbsp;this&nbsp;informal,&nbsp;manual,&nbsp;and&nbsp;interactive&nbsp;testing&nbsp;session<br>into&nbsp;a&nbsp;formal&nbsp;test&nbsp;class.&nbsp;Python&nbsp;provides&nbsp;already&nbsp;a&nbsp;module&nbsp;called&nbsp;unittest&nbsp;for&nbsp;this&nbsp;purpose,&nbsp;which<br>is&nbsp;a&nbsp;port&nbsp;of&nbsp;the&nbsp;Java-based&nbsp;unit&nbsp;testing&nbsp;product,&nbsp;JUnit,&nbsp;by&nbsp;Kent&nbsp;Beck&nbsp;and&nbsp;Erich&nbsp;Gamma.&nbsp;There&nbsp;are<br>three&nbsp;levels&nbsp;to&nbsp;the&nbsp;testing&nbsp;framework&nbsp;(this&nbsp;list&nbsp;deviates&nbsp;a&nbsp;bit&nbsp;from&nbsp;the&nbsp;original&nbsp;deﬁnitions&nbsp;as&nbsp;found<br>in&nbsp;the&nbsp;Python&nbsp;library&nbsp;documentation.&nbsp;1).<br>1&nbsp;http://www.python.org/doc/current/lib/module-unittest.html<br><hr><A name=3></a>44.2.&nbsp;WRITING&nbsp;THE&nbsp;UNIT&nbsp;TESTS<br>3<br>The&nbsp;smallest&nbsp;unit&nbsp;is&nbsp;obviously&nbsp;the&nbsp;“test”,&nbsp;which&nbsp;is&nbsp;a&nbsp;single&nbsp;method&nbsp;in&nbsp;a&nbsp;TestCase&nbsp;class&nbsp;that<br>tests&nbsp;the&nbsp;behavior&nbsp;of&nbsp;a&nbsp;small&nbsp;piece&nbsp;of&nbsp;code&nbsp;or&nbsp;a&nbsp;particular&nbsp;aspect&nbsp;of&nbsp;an&nbsp;implementation.&nbsp;The&nbsp;“test<br>case”&nbsp;is&nbsp;then&nbsp;a&nbsp;collection&nbsp;tests&nbsp;that&nbsp;share&nbsp;the&nbsp;same&nbsp;setup/inputs.&nbsp;On&nbsp;top&nbsp;of&nbsp;all&nbsp;of&nbsp;this&nbsp;sits&nbsp;the&nbsp;“test<br>suite”&nbsp;which&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;test&nbsp;cases&nbsp;and/or&nbsp;other&nbsp;test&nbsp;suites.&nbsp;Test&nbsp;suites&nbsp;combine&nbsp;tests&nbsp;that<br>should&nbsp;be&nbsp;executed&nbsp;together.&nbsp;With&nbsp;the&nbsp;correct&nbsp;setup&nbsp;(as&nbsp;shown&nbsp;in&nbsp;the&nbsp;example&nbsp;below),&nbsp;you&nbsp;can<br>then&nbsp;execute&nbsp;test&nbsp;suites.&nbsp;For&nbsp;large&nbsp;projects&nbsp;like&nbsp;Zope&nbsp;3,&nbsp;it&nbsp;is&nbsp;useful&nbsp;to&nbsp;know&nbsp;that&nbsp;there&nbsp;is&nbsp;also&nbsp;the<br>concept&nbsp;of&nbsp;a&nbsp;test&nbsp;runner,&nbsp;which&nbsp;manages&nbsp;the&nbsp;test&nbsp;run&nbsp;of&nbsp;all&nbsp;or&nbsp;a&nbsp;set&nbsp;of&nbsp;tests.&nbsp;The&nbsp;runner&nbsp;provides<br>useful&nbsp;feedback&nbsp;to&nbsp;the&nbsp;application,&nbsp;so&nbsp;that&nbsp;various&nbsp;user&nbsp;interaces&nbsp;can&nbsp;be&nbsp;developed&nbsp;on&nbsp;top&nbsp;of&nbsp;it.<br>But&nbsp;enough&nbsp;about&nbsp;the&nbsp;theory.&nbsp;In&nbsp;the&nbsp;following&nbsp;example,&nbsp;which&nbsp;you&nbsp;can&nbsp;simply&nbsp;put&nbsp;into&nbsp;the&nbsp;same<br>ﬁle&nbsp;as&nbsp;your&nbsp;code&nbsp;above,&nbsp;you&nbsp;will&nbsp;see&nbsp;a&nbsp;test&nbsp;in&nbsp;common&nbsp;Zope&nbsp;3&nbsp;style.<br>1&nbsp;import&nbsp;unittest<br>2<br>3&nbsp;class&nbsp;SampleTest(unittest.TestCase):<br>4<br>&quot;&quot;&quot;Test&nbsp;the&nbsp;Sample&nbsp;class&quot;&quot;&quot;<br>5<br>6<br>def&nbsp;test_title(self):<br>7<br>sample&nbsp;=&nbsp;Sample()<br>8<br>self.assertEqual(sample.title,&nbsp;None)<br>9<br>sample.title&nbsp;=&nbsp;’Sample&nbsp;Title’<br>10<br>self.assertEqual(sample.title,&nbsp;’Sample&nbsp;Title’)<br>11<br>12<br>def&nbsp;test_getDescription(self):<br>13<br>sample&nbsp;=&nbsp;Sample()<br>14<br>self.assertEqual(sample.getDescription(),&nbsp;’’)<br>15<br>sample._description&nbsp;=&nbsp;&quot;Description&quot;<br>16<br>self.assertEqual(sample.getDescription(),&nbsp;’Description’)<br>17<br>18<br>def&nbsp;test_setDescription(self):<br>19<br>sample&nbsp;=&nbsp;Sample()<br>20<br>self.assertEqual(sample._description,&nbsp;’’)<br>21<br>sample.setDescription(’Description’)<br>22<br>self.assertEqual(sample._description,&nbsp;’Description’)<br>23<br>sample.setDescription(u’Description2’)<br>24<br>self.assertEqual(sample._description,&nbsp;u’Description2’)<br>25<br>self.assertRaises(AssertionError,&nbsp;sample.setDescription,&nbsp;None)<br>26<br>27<br>28&nbsp;def&nbsp;test_suite():<br>29<br>return&nbsp;unittest.TestSuite((<br>30<br>unittest.makeSuite(SampleTest),<br>31<br>))<br>32<br>33&nbsp;if&nbsp;__name__&nbsp;==&nbsp;’__main__’:<br>34<br>unittest.main(defaultTest=’test_suite’)<br>Line&nbsp;3–4:&nbsp;We&nbsp;usually&nbsp;develop&nbsp;test&nbsp;classes&nbsp;which&nbsp;must&nbsp;inherit&nbsp;from&nbsp;TestCase.&nbsp;While&nbsp;often&nbsp;not<br>done,&nbsp;it&nbsp;is&nbsp;a&nbsp;good&nbsp;idea&nbsp;to&nbsp;give&nbsp;the&nbsp;class&nbsp;a&nbsp;meaningful&nbsp;docstring&nbsp;that&nbsp;describes&nbsp;the&nbsp;purpose&nbsp;of&nbsp;the<br>tests&nbsp;it&nbsp;includes.<br>Line&nbsp;6,&nbsp;12&nbsp;&amp;&nbsp;18:&nbsp;When&nbsp;a&nbsp;test&nbsp;case&nbsp;is&nbsp;run,&nbsp;a&nbsp;method&nbsp;called&nbsp;runTests()&nbsp;is&nbsp;executed.&nbsp;While&nbsp;it<br>is&nbsp;possible&nbsp;to&nbsp;overrride&nbsp;this&nbsp;method&nbsp;to&nbsp;run&nbsp;tests&nbsp;diﬀerently,&nbsp;the&nbsp;default&nbsp;option&nbsp;will&nbsp;look&nbsp;for&nbsp;any<br>method&nbsp;whose&nbsp;name&nbsp;starts&nbsp;with&nbsp;test&nbsp;and&nbsp;execute&nbsp;it&nbsp;as&nbsp;a&nbsp;single&nbsp;test.&nbsp;This&nbsp;way&nbsp;we&nbsp;can&nbsp;create<br>a&nbsp;“test&nbsp;method”&nbsp;for&nbsp;each&nbsp;aspect,&nbsp;method,&nbsp;function&nbsp;or&nbsp;property&nbsp;of&nbsp;the&nbsp;code&nbsp;to&nbsp;be&nbsp;tested.&nbsp;This<br>default&nbsp;is&nbsp;very&nbsp;sensible&nbsp;and&nbsp;is&nbsp;used&nbsp;everywhere&nbsp;in&nbsp;Zope&nbsp;3.<br><hr><A name=4></a>4<br>CHAPTER&nbsp;44.&nbsp;WRITING&nbsp;BASIC&nbsp;UNIT&nbsp;TESTS<br>Note&nbsp;that&nbsp;there&nbsp;is&nbsp;no&nbsp;docstring&nbsp;for&nbsp;test&nbsp;methods.&nbsp;This&nbsp;is&nbsp;intentional.&nbsp;If&nbsp;a&nbsp;docstring&nbsp;is&nbsp;speciﬁed,<br>it&nbsp;is&nbsp;used&nbsp;instead&nbsp;of&nbsp;the&nbsp;method&nbsp;name&nbsp;to&nbsp;identify&nbsp;the&nbsp;test.&nbsp;When&nbsp;specifying&nbsp;a&nbsp;docstring,&nbsp;we&nbsp;have<br>noticed&nbsp;that&nbsp;it&nbsp;is&nbsp;very&nbsp;diﬃcult&nbsp;to&nbsp;identify&nbsp;the&nbsp;test&nbsp;later;&nbsp;therefore&nbsp;the&nbsp;method&nbsp;name&nbsp;is&nbsp;a&nbsp;much<br>better&nbsp;choice.<br>Line&nbsp;8,&nbsp;10,&nbsp;14,&nbsp;.&nbsp;.&nbsp;.&nbsp;:&nbsp;The&nbsp;TestCase&nbsp;class&nbsp;implements&nbsp;a&nbsp;handful&nbsp;of&nbsp;methods&nbsp;that&nbsp;aid&nbsp;you&nbsp;with&nbsp;the<br>testing.&nbsp;Here&nbsp;are&nbsp;some&nbsp;of&nbsp;the&nbsp;most&nbsp;frequently&nbsp;used&nbsp;ones.&nbsp;For&nbsp;a&nbsp;complete&nbsp;list&nbsp;see&nbsp;the&nbsp;standard<br>Python&nbsp;documentation&nbsp;referenced&nbsp;above.<br>•&nbsp;assertEqual(first,second[,msg])<br>Checks&nbsp;whether&nbsp;the&nbsp;first&nbsp;and&nbsp;second&nbsp;value&nbsp;are&nbsp;equal.&nbsp;If&nbsp;the&nbsp;test&nbsp;fails,&nbsp;the&nbsp;msg&nbsp;or&nbsp;None<br>is&nbsp;returned.<br>•&nbsp;assertNotEqual(first,second[,msg])<br>This&nbsp;is&nbsp;simply&nbsp;the&nbsp;opposite&nbsp;to&nbsp;assertEqual()&nbsp;by&nbsp;checking&nbsp;for&nbsp;non-equality.<br>•&nbsp;assertRaises(exception,callable,...)<br>You&nbsp;expect&nbsp;the&nbsp;callable&nbsp;to&nbsp;raise&nbsp;exception&nbsp;when&nbsp;executed.&nbsp;After&nbsp;the&nbsp;callable&nbsp;you&nbsp;can<br>specify&nbsp;any&nbsp;amount&nbsp;of&nbsp;positional&nbsp;and&nbsp;keyword&nbsp;arguments&nbsp;for&nbsp;the&nbsp;callable.&nbsp;If&nbsp;you&nbsp;expect<br>a&nbsp;group&nbsp;of&nbsp;exceptions&nbsp;from&nbsp;the&nbsp;execution,&nbsp;you&nbsp;can&nbsp;make&nbsp;exception&nbsp;a&nbsp;tuple&nbsp;of&nbsp;possible<br>exceptions.<br>•&nbsp;assert&nbsp;(expr[,msg])<br>Assert&nbsp;checks&nbsp;whether&nbsp;the&nbsp;speciﬁed&nbsp;expression&nbsp;executes&nbsp;correctly.&nbsp;If&nbsp;not,&nbsp;the&nbsp;test&nbsp;fails&nbsp;and<br>msg&nbsp;or&nbsp;None&nbsp;is&nbsp;returned.<br>•&nbsp;failUnlessEqual()<br>This&nbsp;testing&nbsp;method&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;assertEqual().<br>•&nbsp;failUnless(expr[,msg])<br>This&nbsp;method&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;assert&nbsp;(expr[,msg]).<br>•&nbsp;failif()<br>This&nbsp;is&nbsp;the&nbsp;opposite&nbsp;to&nbsp;failUnless().<br>•&nbsp;fail([msg])<br>Fails&nbsp;the&nbsp;running&nbsp;test&nbsp;without&nbsp;any&nbsp;evaluation.&nbsp;This&nbsp;is&nbsp;commonly&nbsp;used&nbsp;when&nbsp;testing&nbsp;various<br>possible&nbsp;execution&nbsp;paths&nbsp;at&nbsp;once&nbsp;and&nbsp;you&nbsp;would&nbsp;like&nbsp;to&nbsp;signify&nbsp;a&nbsp;failure&nbsp;if&nbsp;an&nbsp;improper&nbsp;path<br>was&nbsp;taken.<br>Line&nbsp;6–10:&nbsp;This&nbsp;method&nbsp;tests&nbsp;the&nbsp;title&nbsp;attribute&nbsp;of&nbsp;the&nbsp;Sample&nbsp;class.&nbsp;The&nbsp;ﬁrst&nbsp;test&nbsp;should<br>be&nbsp;of&nbsp;course&nbsp;that&nbsp;the&nbsp;attribute&nbsp;exists&nbsp;and&nbsp;has&nbsp;the&nbsp;expected&nbsp;initial&nbsp;value&nbsp;(line&nbsp;8).&nbsp;Then&nbsp;the&nbsp;title<br>attribute&nbsp;is&nbsp;changed&nbsp;and&nbsp;we&nbsp;check&nbsp;whether&nbsp;the&nbsp;value&nbsp;was&nbsp;really&nbsp;stored.&nbsp;This&nbsp;might&nbsp;seem&nbsp;like<br>overkill,&nbsp;but&nbsp;later&nbsp;you&nbsp;might&nbsp;change&nbsp;the&nbsp;title&nbsp;in&nbsp;a&nbsp;way&nbsp;that&nbsp;it&nbsp;uses&nbsp;properties&nbsp;instead.&nbsp;Then&nbsp;it<br>becomes&nbsp;very&nbsp;important&nbsp;to&nbsp;check&nbsp;whether&nbsp;this&nbsp;test&nbsp;still&nbsp;passes.<br>Line&nbsp;12–16:&nbsp;First&nbsp;we&nbsp;simply&nbsp;check&nbsp;that&nbsp;getDescription()&nbsp;returns&nbsp;the&nbsp;correct&nbsp;default&nbsp;value.<br>Since&nbsp;we&nbsp;do&nbsp;not&nbsp;want&nbsp;to&nbsp;use&nbsp;other&nbsp;API&nbsp;calls&nbsp;like&nbsp;setDescription()&nbsp;we&nbsp;set&nbsp;a&nbsp;new&nbsp;value&nbsp;of&nbsp;the<br>description&nbsp;via&nbsp;the&nbsp;implementation-internal&nbsp;description&nbsp;attribute&nbsp;(line&nbsp;15).&nbsp;This&nbsp;is&nbsp;okay!&nbsp;Unit<br>tests&nbsp;can&nbsp;make&nbsp;use&nbsp;of&nbsp;implementation-speciﬁc&nbsp;attributes&nbsp;and&nbsp;methods.&nbsp;Finally&nbsp;we&nbsp;just&nbsp;check&nbsp;that<br>the&nbsp;correct&nbsp;value&nbsp;is&nbsp;returned.<br><hr><A name=5></a>44.3.&nbsp;RUNNING&nbsp;THE&nbsp;TESTS<br>5<br>Line&nbsp;18–25:&nbsp;On&nbsp;line&nbsp;21–24&nbsp;it&nbsp;is&nbsp;checked&nbsp;that&nbsp;both&nbsp;regular&nbsp;and&nbsp;unicode&nbsp;strings&nbsp;are&nbsp;set&nbsp;correctly.<br>In&nbsp;the&nbsp;last&nbsp;line&nbsp;of&nbsp;the&nbsp;test&nbsp;we&nbsp;make&nbsp;sure&nbsp;that&nbsp;no&nbsp;other&nbsp;type&nbsp;of&nbsp;objects&nbsp;can&nbsp;be&nbsp;set&nbsp;as&nbsp;a&nbsp;description<br>and&nbsp;that&nbsp;an&nbsp;error&nbsp;is&nbsp;raised.<br>28–31:&nbsp;This&nbsp;method&nbsp;returns&nbsp;a&nbsp;test&nbsp;suite&nbsp;that&nbsp;includes&nbsp;all&nbsp;test&nbsp;cases&nbsp;created&nbsp;in&nbsp;this&nbsp;module.&nbsp;It&nbsp;is<br>used&nbsp;by&nbsp;the&nbsp;Zope&nbsp;3&nbsp;test&nbsp;runner&nbsp;when&nbsp;it&nbsp;picks&nbsp;up&nbsp;all&nbsp;available&nbsp;tests.&nbsp;You&nbsp;would&nbsp;basically&nbsp;add&nbsp;the<br>line&nbsp;unittest.makeSuite(TestCaseClass)&nbsp;for&nbsp;each&nbsp;additional&nbsp;test&nbsp;case.<br>33–34:&nbsp;In&nbsp;order&nbsp;to&nbsp;make&nbsp;the&nbsp;test&nbsp;module&nbsp;runnable&nbsp;by&nbsp;itself,&nbsp;you&nbsp;can&nbsp;execute&nbsp;unittest.main()<br>when&nbsp;the&nbsp;module&nbsp;is&nbsp;run.<br>44.3<br>Running&nbsp;the&nbsp;Tests<br>You&nbsp;can&nbsp;run&nbsp;the&nbsp;test&nbsp;by&nbsp;simply&nbsp;calling&nbsp;pythontest&nbsp;sample.py&nbsp;from&nbsp;the&nbsp;directory&nbsp;you&nbsp;saved&nbsp;the<br>ﬁle&nbsp;in.&nbsp;Here&nbsp;is&nbsp;the&nbsp;result&nbsp;you&nbsp;should&nbsp;see:<br>.<br>--------------------------------------------------------------------<br>n&nbsp;3&nbsp;tests&nbsp;in&nbsp;0.001s<br>The&nbsp;three&nbsp;dots&nbsp;represent&nbsp;the&nbsp;three&nbsp;tests&nbsp;that&nbsp;were&nbsp;run.&nbsp;If&nbsp;a&nbsp;test&nbsp;had&nbsp;failed,&nbsp;it&nbsp;would&nbsp;have&nbsp;been<br>reported&nbsp;pointing&nbsp;out&nbsp;the&nbsp;failing&nbsp;test&nbsp;and&nbsp;providing&nbsp;a&nbsp;small&nbsp;traceback.<br>When&nbsp;using&nbsp;the&nbsp;default&nbsp;Zope&nbsp;3&nbsp;test&nbsp;runner,&nbsp;tests&nbsp;will&nbsp;be&nbsp;picked&nbsp;up&nbsp;as&nbsp;long&nbsp;as&nbsp;they&nbsp;follow&nbsp;some<br>conventions.<br>•&nbsp;The&nbsp;tests&nbsp;must&nbsp;either&nbsp;be&nbsp;in&nbsp;a&nbsp;package&nbsp;or&nbsp;be&nbsp;a&nbsp;module&nbsp;called&nbsp;tests.<br>•&nbsp;If&nbsp;tests&nbsp;is&nbsp;a&nbsp;package,&nbsp;then&nbsp;all&nbsp;test&nbsp;modules&nbsp;inside&nbsp;must&nbsp;also&nbsp;have&nbsp;a&nbsp;name&nbsp;starting&nbsp;with&nbsp;test,<br>as&nbsp;it&nbsp;is&nbsp;the&nbsp;case&nbsp;with&nbsp;our&nbsp;name&nbsp;test&nbsp;sample.py.<br>•&nbsp;The&nbsp;test&nbsp;module&nbsp;must&nbsp;be&nbsp;somewhere&nbsp;in&nbsp;the&nbsp;Zope&nbsp;3&nbsp;source&nbsp;tree,&nbsp;since&nbsp;the&nbsp;test&nbsp;runner&nbsp;looks<br>only&nbsp;for&nbsp;ﬁles&nbsp;there.<br>In&nbsp;our&nbsp;case,&nbsp;you&nbsp;could&nbsp;simply&nbsp;create&nbsp;a&nbsp;tests&nbsp;package&nbsp;in&nbsp;ZOPE3/src&nbsp;(do&nbsp;not&nbsp;forget&nbsp;the<br>init&nbsp;.<br>py&nbsp;ﬁle).&nbsp;Then&nbsp;place&nbsp;the&nbsp;test&nbsp;sample.py&nbsp;ﬁle&nbsp;into&nbsp;this&nbsp;directory.<br>You&nbsp;you&nbsp;can&nbsp;use&nbsp;the&nbsp;test&nbsp;runner&nbsp;to&nbsp;run&nbsp;only&nbsp;the&nbsp;sample&nbsp;tests&nbsp;as&nbsp;follows&nbsp;from&nbsp;the&nbsp;Zope&nbsp;3&nbsp;root<br>directory:<br>python&nbsp;test.py&nbsp;-vp&nbsp;tests.test_sample<br>The&nbsp;-v&nbsp;option&nbsp;stands&nbsp;for&nbsp;verbose&nbsp;mode,&nbsp;so&nbsp;that&nbsp;detailed&nbsp;information&nbsp;about&nbsp;a&nbsp;test&nbsp;failure&nbsp;is<br>provided.&nbsp;The&nbsp;-p&nbsp;option&nbsp;enables&nbsp;a&nbsp;progress&nbsp;bar&nbsp;that&nbsp;tells&nbsp;you&nbsp;how&nbsp;many&nbsp;tests&nbsp;out&nbsp;of&nbsp;all&nbsp;have&nbsp;been<br>completed.&nbsp;There&nbsp;are&nbsp;many&nbsp;more&nbsp;options&nbsp;that&nbsp;can&nbsp;be&nbsp;speciﬁed.&nbsp;You&nbsp;can&nbsp;get&nbsp;a&nbsp;full&nbsp;list&nbsp;of&nbsp;them&nbsp;with<br>the&nbsp;option&nbsp;-h:&nbsp;pythontest.py-h.<br>The&nbsp;output&nbsp;of&nbsp;the&nbsp;call&nbsp;above&nbsp;is&nbsp;as&nbsp;follows:<br>nfiguration&nbsp;file&nbsp;found.<br>nning&nbsp;UNIT&nbsp;tests&nbsp;at&nbsp;level&nbsp;1<br>nning&nbsp;UNIT&nbsp;tests&nbsp;from&nbsp;/opt/zope/Zope3<br>3/3&nbsp;(100.0%):&nbsp;test_title&nbsp;(tests.test_sample.SampleTest)<br>--------------------------------------------------------------------<br>n&nbsp;3&nbsp;tests&nbsp;in&nbsp;0.002s<br><hr><A name=6></a>6<br>CHAPTER&nbsp;44.&nbsp;WRITING&nbsp;BASIC&nbsp;UNIT&nbsp;TESTS<br>nning&nbsp;FUNCTIONAL&nbsp;tests&nbsp;at&nbsp;level&nbsp;1<br>nning&nbsp;FUNCTIONAL&nbsp;tests&nbsp;from&nbsp;/opt/zope/Zope3<br>--------------------------------------------------------------------<br>n&nbsp;0&nbsp;tests&nbsp;in&nbsp;0.000s<br>Line&nbsp;1:&nbsp;The&nbsp;test&nbsp;runner&nbsp;uses&nbsp;a&nbsp;conﬁguration&nbsp;ﬁle&nbsp;for&nbsp;some&nbsp;setup.&nbsp;This&nbsp;allows&nbsp;developers&nbsp;to&nbsp;use<br>the&nbsp;test&nbsp;runner&nbsp;for&nbsp;other&nbsp;projects&nbsp;as&nbsp;well.&nbsp;This&nbsp;message&nbsp;simply&nbsp;tells&nbsp;us&nbsp;that&nbsp;the&nbsp;conﬁguration&nbsp;ﬁle<br>was&nbsp;found.<br>Line&nbsp;2–8:&nbsp;The&nbsp;unit&nbsp;tests&nbsp;are&nbsp;run.&nbsp;On&nbsp;line&nbsp;4&nbsp;you&nbsp;can&nbsp;see&nbsp;the&nbsp;progress&nbsp;bar.<br>Line&nbsp;9–15:&nbsp;The&nbsp;functional&nbsp;tests&nbsp;are&nbsp;run,&nbsp;since&nbsp;the&nbsp;default&nbsp;test&nbsp;runner&nbsp;runs&nbsp;both&nbsp;types&nbsp;of&nbsp;tests.<br>Since&nbsp;we&nbsp;do&nbsp;not&nbsp;have&nbsp;any&nbsp;functional&nbsp;tests&nbsp;in&nbsp;the&nbsp;speciﬁed&nbsp;module,&nbsp;there&nbsp;are&nbsp;no&nbsp;tests&nbsp;to&nbsp;run.&nbsp;To<br>just&nbsp;run&nbsp;the&nbsp;unit&nbsp;tests,&nbsp;use&nbsp;option&nbsp;-u&nbsp;and&nbsp;-f&nbsp;for&nbsp;just&nbsp;running&nbsp;the&nbsp;functional&nbsp;tests.&nbsp;See&nbsp;“Writing<br>Functional&nbsp;Tests”&nbsp;for&nbsp;more&nbsp;detials&nbsp;on&nbsp;functional&nbsp;tests.<br><hr><A name=7></a>44.3.&nbsp;RUNNING&nbsp;THE&nbsp;TESTS<br>7<br>Exercises<br>1.&nbsp;It&nbsp;is&nbsp;not&nbsp;very&nbsp;common&nbsp;to&nbsp;do&nbsp;the&nbsp;setup&nbsp;–&nbsp;in&nbsp;our&nbsp;case&nbsp;sample=Sample()&nbsp;–&nbsp;in&nbsp;every&nbsp;test<br>method.&nbsp;Instead&nbsp;there&nbsp;exists&nbsp;a&nbsp;method&nbsp;called&nbsp;setUp()&nbsp;and&nbsp;its&nbsp;counterpart&nbsp;tearDown&nbsp;that<br>are&nbsp;run&nbsp;before&nbsp;and&nbsp;after&nbsp;each&nbsp;test,&nbsp;respectively.&nbsp;Change&nbsp;the&nbsp;test&nbsp;code&nbsp;above,&nbsp;so&nbsp;that&nbsp;it&nbsp;uses<br>the&nbsp;setUp()&nbsp;method.&nbsp;In&nbsp;later&nbsp;chapters&nbsp;and&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;book&nbsp;we&nbsp;will&nbsp;frequently&nbsp;use&nbsp;this<br>method&nbsp;of&nbsp;setting&nbsp;up&nbsp;tests.<br>2.&nbsp;Currently&nbsp;the&nbsp;test&nbsp;setDescription()&nbsp;test&nbsp;only&nbsp;veriﬁes&nbsp;that&nbsp;None&nbsp;is&nbsp;not&nbsp;allowed&nbsp;as&nbsp;input<br>value.<br>(a)&nbsp;Improve&nbsp;the&nbsp;test,&nbsp;so&nbsp;that&nbsp;all&nbsp;other&nbsp;builtin&nbsp;types&nbsp;are&nbsp;tested&nbsp;as&nbsp;well.<br>(b)&nbsp;Also,&nbsp;make&nbsp;sure&nbsp;that&nbsp;any&nbsp;objects&nbsp;inheriting&nbsp;from&nbsp;str&nbsp;or&nbsp;unicode&nbsp;pass&nbsp;as&nbsp;valid&nbsp;values.<br><hr>]

!=

[<A name=1></a>Chapter 44<br>Writing Basic Unit Tests<br>Diﬃculty<br>Newcomer<br>Skills<br>• All you need to know is some Python.<br>Problem/Task<br>As you know by now, Zope 3 gains its incredible stability from testing any code in great detail. The<br>currently most common method is to write unit tests. This chapter introduces unit tests – which<br>are Zope 3 independent – and introduces some of the subtleties.<br>Solution<br>44.1<br>Implementing the Sample Class<br>Before we can write tests, we have to write some code that we can test. Here, we will implement<br>a simple class called Sample with a public attribute title and description that is accessed<br>via getDescription() and mutated using setDescription(). Further, the description must be<br>either a regular or unicode string.<br>Since this code will not depend on Zope, open a ﬁle named test sample.py anywhere and add<br>the following class:<br>1 Sample(object):<br>2<br>&quot;&quot;&quot;A trivial Sample object.&quot;&quot;&quot;<br>3<br>4<br>title = None<br>5<br>6<br>def __init__(self):<br>7<br>&quot;&quot;&quot;Initialize object.&quot;&quot;&quot;<br>8<br>self._description = ’’<br>9<br>1<br><hr><A name=2></a>2<br>CHAPTER 44. WRITING BASIC UNIT TESTS<br>10<br>def setDescription(self, value):<br>11<br>&quot;&quot;&quot;Change the value of the description.&quot;&quot;&quot;<br>12<br>assert isinstance(value, (str, unicode))<br>13<br>self._description = value<br>14<br>15<br>def getDescription(self):<br>16<br>&quot;&quot;&quot;Change the value of the description.&quot;&quot;&quot;<br>17<br>return self._description<br>Line 4: The title is just publicly declared and a value of None is given. Therefore this is just<br>a regular attribute.<br>Line 8: The actual description string will be stored in description.<br>Line 12: Make sure that the description is only a regular or unicode string, like it was stated in<br>the requirements.<br>If you wish you can now manually test the class with the interactive Python shell. Just start<br>Python by entering python in your shell prompt. Note that you should be in the directory in<br>which test sample.py is located when starting Python (an alternative is of course to specify the<br>directory in your PYTHONPATH.)<br>1 &gt;&gt;&gt; from test_sample import Sample<br>2 &gt;&gt;&gt; sample = Sample()<br>3 &gt;&gt;&gt; print sample.title<br>4 None<br>5 &gt;&gt;&gt; sample.title = ’Title’<br>6 &gt;&gt;&gt; print sample.title<br>7 Title<br>8 &gt;&gt;&gt; print sample.getDescription()<br>9<br>10 &gt;&gt;&gt; sample.setDescription(’Hello World’)<br>11 &gt;&gt;&gt; print sample.getDescription()<br>12 Hello World<br>13 &gt;&gt;&gt; sample.setDescription(None)<br>14 Traceback (most recent call last):<br>15<br>File &quot;&lt;stdin&gt;&quot;, line 1, in ?<br>16<br>File &quot;test_sample.py&quot;, line 31, in setDescription<br>17<br>assert isinstance(value, (str, unicode))<br>18 AssertionError<br>As you can see in the last test, non-string object types are not allowed as descriptions and an<br>AssertionError is raised.<br>44.2<br>Writing the Unit Tests<br>The goal of writing the unit tests is to convert this informal, manual, and interactive testing session<br>into a formal test class. Python provides already a module called unittest for this purpose, which<br>is a port of the Java-based unit testing product, JUnit, by Kent Beck and Erich Gamma. There are<br>three levels to the testing framework (this list deviates a bit from the original deﬁnitions as found<br>in the Python library documentation. 1).<br>1 http://www.python.org/doc/current/lib/module-unittest.html<br><hr><A name=3></a>44.2. WRITING THE UNIT TESTS<br>3<br>The smallest unit is obviously the “test”, which is a single method in a TestCase class that<br>tests the behavior of a small piece of code or a particular aspect of an implementation. The “test<br>case” is then a collection tests that share the same setup/inputs. On top of all of this sits the “test<br>suite” which is a collection of test cases and/or other test suites. Test suites combine tests that<br>should be executed together. With the correct setup (as shown in the example below), you can<br>then execute test suites. For large projects like Zope 3, it is useful to know that there is also the<br>concept of a test runner, which manages the test run of all or a set of tests. The runner provides<br>useful feedback to the application, so that various user interaces can be developed on top of it.<br>But enough about the theory. In the following example, which you can simply put into the same<br>ﬁle as your code above, you will see a test in common Zope 3 style.<br>1 import unittest<br>2<br>3 class SampleTest(unittest.TestCase):<br>4<br>&quot;&quot;&quot;Test the Sample class&quot;&quot;&quot;<br>5<br>6<br>def test_title(self):<br>7<br>sample = Sample()<br>8<br>self.assertEqual(sample.title, None)<br>9<br>sample.title = ’Sample Title’<br>10<br>self.assertEqual(sample.title, ’Sample Title’)<br>11<br>12<br>def test_getDescription(self):<br>13<br>sample = Sample()<br>14<br>self.assertEqual(sample.getDescription(), ’’)<br>15<br>sample._description = &quot;Description&quot;<br>16<br>self.assertEqual(sample.getDescription(), ’Description’)<br>17<br>18<br>def test_setDescription(self):<br>19<br>sample = Sample()<br>20<br>self.assertEqual(sample._description, ’’)<br>21<br>sample.setDescription(’Description’)<br>22<br>self.assertEqual(sample._description, ’Description’)<br>23<br>sample.setDescription(u’Description2’)<br>24<br>self.assertEqual(sample._description, u’Description2’)<br>25<br>self.assertRaises(AssertionError, sample.setDescription, None)<br>26<br>27<br>28 def test_suite():<br>29<br>return unittest.TestSuite((<br>30<br>unittest.makeSuite(SampleTest),<br>31<br>))<br>32<br>33 if __name__ == ’__main__’:<br>34<br>unittest.main(defaultTest=’test_suite’)<br>Line 3–4: We usually develop test classes which must inherit from TestCase. While often not<br>done, it is a good idea to give the class a meaningful docstring that describes the purpose of the<br>tests it includes.<br>Line 6, 12 &amp; 18: When a test case is run, a method called runTests() is executed. While it<br>is possible to overrride this method to run tests diﬀerently, the default option will look for any<br>method whose name starts with test and execute it as a single test. This way we can create<br>a “test method” for each aspect, method, function or property of the code to be tested. This<br>default is very sensible and is used everywhere in Zope 3.<br><hr><A name=4></a>4<br>CHAPTER 44. WRITING BASIC UNIT TESTS<br>Note that there is no docstring for test methods. This is intentional. If a docstring is speciﬁed,<br>it is used instead of the method name to identify the test. When specifying a docstring, we have<br>noticed that it is very diﬃcult to identify the test later; therefore the method name is a much<br>better choice.<br>Line 8, 10, 14, . . . : The TestCase class implements a handful of methods that aid you with the<br>testing. Here are some of the most frequently used ones. For a complete list see the standard<br>Python documentation referenced above.<br>• assertEqual(first,second[,msg])<br>Checks whether the first and second value are equal. If the test fails, the msg or None<br>is returned.<br>• assertNotEqual(first,second[,msg])<br>This is simply the opposite to assertEqual() by checking for non-equality.<br>• assertRaises(exception,callable,...)<br>You expect the callable to raise exception when executed. After the callable you can<br>specify any amount of positional and keyword arguments for the callable. If you expect<br>a group of exceptions from the execution, you can make exception a tuple of possible<br>exceptions.<br>• assert (expr[,msg])<br>Assert checks whether the speciﬁed expression executes correctly. If not, the test fails and<br>msg or None is returned.<br>• failUnlessEqual()<br>This testing method is equivalent to assertEqual().<br>• failUnless(expr[,msg])<br>This method is equivalent to assert (expr[,msg]).<br>• failif()<br>This is the opposite to failUnless().<br>• fail([msg])<br>Fails the running test without any evaluation. This is commonly used when testing various<br>possible execution paths at once and you would like to signify a failure if an improper path<br>was taken.<br>Line 6–10: This method tests the title attribute of the Sample class. The ﬁrst test should<br>be of course that the attribute exists and has the expected initial value (line 8). Then the title<br>attribute is changed and we check whether the value was really stored. This might seem like<br>overkill, but later you might change the title in a way that it uses properties instead. Then it<br>becomes very important to check whether this test still passes.<br>Line 12–16: First we simply check that getDescription() returns the correct default value.<br>Since we do not want to use other API calls like setDescription() we set a new value of the<br>description via the implementation-internal description attribute (line 15). This is okay! Unit<br>tests can make use of implementation-speciﬁc attributes and methods. Finally we just check that<br>the correct value is returned.<br><hr><A name=5></a>44.3. RUNNING THE TESTS<br>5<br>Line 18–25: On line 21–24 it is checked that both regular and unicode strings are set correctly.<br>In the last line of the test we make sure that no other type of objects can be set as a description<br>and that an error is raised.<br>28–31: This method returns a test suite that includes all test cases created in this module. It is<br>used by the Zope 3 test runner when it picks up all available tests. You would basically add the<br>line unittest.makeSuite(TestCaseClass) for each additional test case.<br>33–34: In order to make the test module runnable by itself, you can execute unittest.main()<br>when the module is run.<br>44.3<br>Running the Tests<br>You can run the test by simply calling pythontest sample.py from the directory you saved the<br>ﬁle in. Here is the result you should see:<br>.<br>--------------------------------------------------------------------<br>n 3 tests in 0.001s<br>The three dots represent the three tests that were run. If a test had failed, it would have been<br>reported pointing out the failing test and providing a small traceback.<br>When using the default Zope 3 test runner, tests will be picked up as long as they follow some<br>conventions.<br>• The tests must either be in a package or be a module called tests.<br>• If tests is a package, then all test modules inside must also have a name starting with test,<br>as it is the case with our name test sample.py.<br>• The test module must be somewhere in the Zope 3 source tree, since the test runner looks<br>only for ﬁles there.<br>In our case, you could simply create a tests package in ZOPE3/src (do not forget the<br>init .<br>py ﬁle). Then place the test sample.py ﬁle into this directory.<br>You you can use the test runner to run only the sample tests as follows from the Zope 3 root<br>directory:<br>python test.py -vp tests.test_sample<br>The -v option stands for verbose mode, so that detailed information about a test failure is<br>provided. The -p option enables a progress bar that tells you how many tests out of all have been<br>completed. There are many more options that can be speciﬁed. You can get a full list of them with<br>the option -h: pythontest.py-h.<br>The output of the call above is as follows:<br>nfiguration file found.<br>nning UNIT tests at level 1<br>nning UNIT tests from /opt/zope/Zope3<br>3/3 (100.0%): test_title (tests.test_sample.SampleTest)<br>--------------------------------------------------------------------<br>n 3 tests in 0.002s<br><hr><A name=6></a>6<br>CHAPTER 44. WRITING BASIC UNIT TESTS<br>nning FUNCTIONAL tests at level 1<br>nning FUNCTIONAL tests from /opt/zope/Zope3<br>--------------------------------------------------------------------<br>n 0 tests in 0.000s<br>Line 1: The test runner uses a conﬁguration ﬁle for some setup. This allows developers to use<br>the test runner for other projects as well. This message simply tells us that the conﬁguration ﬁle<br>was found.<br>Line 2–8: The unit tests are run. On line 4 you can see the progress bar.<br>Line 9–15: The functional tests are run, since the default test runner runs both types of tests.<br>Since we do not have any functional tests in the speciﬁed module, there are no tests to run. To<br>just run the unit tests, use option -u and -f for just running the functional tests. See “Writing<br>Functional Tests” for more detials on functional tests.<br><hr><A name=7></a>44.3. RUNNING THE TESTS<br>7<br>Exercises<br>1. It is not very common to do the setup – in our case sample=Sample() – in every test<br>method. Instead there exists a method called setUp() and its counterpart tearDown that<br>are run before and after each test, respectively. Change the test code above, so that it uses<br>the setUp() method. In later chapters and the rest of the book we will frequently use this<br>method of setting up tests.<br>2. Currently the test setDescription() test only veriﬁes that None is not allowed as input<br>value.<br>(a) Improve the test, so that all other builtin types are tested as well.<br>(b) Also, make sure that any objects inheriting from str or unicode pass as valid values.<br><hr>]

IN pdf_to_html(/.../plone-coredev/src/Products.PortalTransforms/Products/PortalTransforms/tests/input/demo1.pdf)

    440/511 (86.1%)/.../plone-coredev/src/Products.PortalTransforms/Products/PortalTransforms/libtransforms/commandtransform.py:95: DeprecationWarning: os.popen4 is deprecated.  Use the subprocess module.
  cin, couterr = os.popen4(command, 'b')


Failure in test testSame (Products.PortalTransforms.tests.test_transforms.TransformTestSubclass)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Products.PortalTransforms/Products/PortalTransforms/tests/test_transforms.py", line 68, in testSame
    self.do_convert(filename=self.input)
  File "/.../plone-coredev/src/Products.PortalTransforms/Products/PortalTransforms/tests/test_transforms.py", line 60, in do_convert
    got, expected, self.transform.name(), self.input))
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: [Copying Docutils Author: David Goodger Contact: [1]goodger@users.sourceforge.net Date: 2002-10-03 Web site: [2]http://docutils.sourceforge.net/ Most of the files included in this project are in the public domain, and therefore have no license requirement and no restrictions on copying or usage. The exceptions are: * docutils/optik.py, copyright Gregory P. Ward, released under a BSD-style license (which can be found in the module's source code). * docutils/roman.py, copyright by Mark Pilgrim, released under the [3]Python 2.1.1 license. * test/difflib.py, copyright by the Python Software Foundation, released under the [4]Python 2.2 license. This file is included for compatibility with Python versions less than 2.2; if you have Python 2.2 or higher, difflib.py is not needed and may be removed. (It's only used to report test failures anyhow; it isn't installed anywhere. The included file is a pre-generator version of the difflib.py module included in Python 2.2.) (Disclaimer: I am not a lawyer.) Both the BSD license and the Python license are [5]OSI-approved and [6]GPL-compatible. Although complicated by multiple owners and lots of legalese, the Python license basically lets you copy, use, modify, and redistribute files as long as you keep the copyright attribution intact, note any changes you make, and don't use the owner's name in vain. The BSD license is similar. __________________________________________________________________ Generated on: 2003-04-19 15:32 UTC. Generated by [7]Docutils from [8]reStructuredText source. References 1. mailto:goodger@users.sourceforge.net 2. http://docutils.sourceforge.net/ 3. http://www.python.org/2.1.1/license.html 4. http://www.python.org/2.2/license.html 5. http://opensource.org/licenses/ 6. http://www.gnu.org/philosophy/license-list.html 7. http://docutils.sourceforge.net/ 8. http://docutils.sourceforge.net/rst.html ]

!=

[ Copying Docutils Author: David Goodger Contact: [1]goodger@users.sourceforge.net Date: 2002-10-03 Web site: [2]http://docutils.sourceforge.net/ Most of the files included in this project are in the public domain, and therefore have no license requirement and no restrictions on copying or usage. The exceptions are: * docutils/optik.py, copyright Gregory P. Ward, released under a BSD-style license (which can be found in the module's source code). * docutils/roman.py, copyright by Mark Pilgrim, released under the [3]Python 2.1.1 license. * test/difflib.py, copyright by the Python Software Foundation, released under the [4]Python 2.2 license. This file is included for compatibility with Python versions less than 2.2; if you have Python 2.2 or higher, difflib.py is not needed and may be removed. (It's only used to report test failures anyhow; it isn't installed anywhere. The included file is a pre-generator version of the difflib.py module included in Python 2.2.) (Disclaimer: I am not a lawyer.) Both the BSD license and the Python license are [5]OSI-approved and [6]GPL-compatible. Although complicated by multiple owners and lots of legalese, the Python license basically lets you copy, use, modify, and redistribute files as long as you keep the copyright attribution intact, note any changes you make, and don't use the owner's name in vain. The BSD license is similar. _________________________________________________________________ Generated on: 2003-04-19 15:32 UTC. Generated by [7]Docutils from [8]reStructuredText source. References 1. mailto:goodger@users.sourceforge.net 2. http://docutils.sourceforge.net/ 3. http://www.python.org/2.1.1/license.html 4. http://www.python.org/2.2/license.html 5. http://opensource.org/licenses/ 6. http://www.gnu.org/philosophy/license-list.html 7. http://docutils.sourceforge.net/ 8. http://docutils.sourceforge.net/rst.html ]

IN lynx_dump(/.../plone-coredev/src/Products.PortalTransforms/Products/PortalTransforms/tests/input/test_lynx.html)

    441/511 (86.3%)

Failure in test testSameNoFilename (Products.PortalTransforms.tests.test_transforms.TransformTestSubclass)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Products.PortalTransforms/Products/PortalTransforms/tests/test_transforms.py", line 74, in testSameNoFilename
    self.do_convert()
  File "/.../plone-coredev/src/Products.PortalTransforms/Products/PortalTransforms/tests/test_transforms.py", line 60, in do_convert
    got, expected, self.transform.name(), self.input))
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: [Copying Docutils Author: David Goodger Contact: [1]goodger@users.sourceforge.net Date: 2002-10-03 Web site: [2]http://docutils.sourceforge.net/ Most of the files included in this project are in the public domain, and therefore have no license requirement and no restrictions on copying or usage. The exceptions are: * docutils/optik.py, copyright Gregory P. Ward, released under a BSD-style license (which can be found in the module's source code). * docutils/roman.py, copyright by Mark Pilgrim, released under the [3]Python 2.1.1 license. * test/difflib.py, copyright by the Python Software Foundation, released under the [4]Python 2.2 license. This file is included for compatibility with Python versions less than 2.2; if you have Python 2.2 or higher, difflib.py is not needed and may be removed. (It's only used to report test failures anyhow; it isn't installed anywhere. The included file is a pre-generator version of the difflib.py module included in Python 2.2.) (Disclaimer: I am not a lawyer.) Both the BSD license and the Python license are [5]OSI-approved and [6]GPL-compatible. Although complicated by multiple owners and lots of legalese, the Python license basically lets you copy, use, modify, and redistribute files as long as you keep the copyright attribution intact, note any changes you make, and don't use the owner's name in vain. The BSD license is similar. __________________________________________________________________ Generated on: 2003-04-19 15:32 UTC. Generated by [7]Docutils from [8]reStructuredText source. References 1. mailto:goodger@users.sourceforge.net 2. http://docutils.sourceforge.net/ 3. http://www.python.org/2.1.1/license.html 4. http://www.python.org/2.2/license.html 5. http://opensource.org/licenses/ 6. http://www.gnu.org/philosophy/license-list.html 7. http://docutils.sourceforge.net/ 8. http://docutils.sourceforge.net/rst.html ]

!=

[ Copying Docutils Author: David Goodger Contact: [1]goodger@users.sourceforge.net Date: 2002-10-03 Web site: [2]http://docutils.sourceforge.net/ Most of the files included in this project are in the public domain, and therefore have no license requirement and no restrictions on copying or usage. The exceptions are: * docutils/optik.py, copyright Gregory P. Ward, released under a BSD-style license (which can be found in the module's source code). * docutils/roman.py, copyright by Mark Pilgrim, released under the [3]Python 2.1.1 license. * test/difflib.py, copyright by the Python Software Foundation, released under the [4]Python 2.2 license. This file is included for compatibility with Python versions less than 2.2; if you have Python 2.2 or higher, difflib.py is not needed and may be removed. (It's only used to report test failures anyhow; it isn't installed anywhere. The included file is a pre-generator version of the difflib.py module included in Python 2.2.) (Disclaimer: I am not a lawyer.) Both the BSD license and the Python license are [5]OSI-approved and [6]GPL-compatible. Although complicated by multiple owners and lots of legalese, the Python license basically lets you copy, use, modify, and redistribute files as long as you keep the copyright attribution intact, note any changes you make, and don't use the owner's name in vain. The BSD license is similar. _________________________________________________________________ Generated on: 2003-04-19 15:32 UTC. Generated by [7]Docutils from [8]reStructuredText source. References 1. mailto:goodger@users.sourceforge.net 2. http://docutils.sourceforge.net/ 3. http://www.python.org/2.1.1/license.html 4. http://www.python.org/2.2/license.html 5. http://opensource.org/licenses/ 6. http://www.gnu.org/philosophy/license-list.html 7. http://docutils.sourceforge.net/ 8. http://docutils.sourceforge.net/rst.html ]

IN lynx_dump(/.../plone-coredev/src/Products.PortalTransforms/Products/PortalTransforms/tests/input/test_lynx.html)

                    
  Ran 511 tests with 4 failures and 0 errors in # minutes # seconds.
Running Products.CMFTestCase.layer.ZCML tests:
  Tear down Products.Archetypes.tests.layer.ArchetypesSite in # seconds.
  Tear down Products.Archetypes.tests.layer.ZCML in # seconds.
  Tear down Products.CMFCore.testing.FunctionalZCMLLayer in # seconds.
  Set up Products.CMFTestCase.layer.ZCML in # seconds.
  Running:
                  
  Ran 20 tests with 0 failures and 0 errors in # seconds.
Running Products.PloneTestCase.layer.PloneSite tests:
  Tear down Products.CMFTestCase.layer.ZCML in # seconds.
  Set up Products.PloneTestCase.layer.ZCML in # seconds.
  Set up Products.PloneTestCase.layer.PloneSite in # seconds.
  Running:
    12/22 (54.5%)

Failure in test /.../plone-coredev/src/Products.Marshall/Products/Marshall/doc/README.txt
Failed doctest test for README.txt
  File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/doc/README.txt", line 0

----------------------------------------------------------------------
File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/doc/README.txt", line 41, in README.txt
Failed example:
    p = add_predicate(tool, id='atxml',
                      title='ATXML Predicate',
                      predicate='xmlns_attr',
                      expression='',
                      component_name='atxml')
Exception raised:
    Traceback (most recent call last):
      File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 1361, in __run
        compileflags, 1) in test.globs
      File "<doctest README.txt[line 41, example 5]>", line 5, in <module>
        component_name='atxml')
      File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/predicates/_base.py", line 154, in manage_addPredicate
        obj = createPredicate(predicate, id, title, expression, component_name)
      File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/registry.py", line 71, in createPredicate
        return registry[name].create(id, title, expression, component_name)
      File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/registry.py", line 49, in create
        return self.factory(id, title or self.title, expression, component_name)
      File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/predicates/_base.py", line 69, in __init__
        self.setComponentName(component_name)
      File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/predicates/_base.py", line 105, in setComponentName
        'component: %s' % component_name)
    ValueError: Not a valid registered component: atxml
----------------------------------------------------------------------
File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/doc/README.txt", line 50, in README.txt
Failed example:
    p.edit(element_ns=AT_NS, element_name='metadata', value=None)
Exception raised:
    Traceback (most recent call last):
      File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 1361, in __run
        compileflags, 1) in test.globs
      File "<doctest README.txt[line 50, example 6]>", line 1, in <module>
        p.edit(element_ns=AT_NS, element_name='metadata', value=None)
    NameError: name 'p' is not defined
----------------------------------------------------------------------
File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/doc/README.txt", line 134, in README.txt
Failed example:
    article.Title()
Differences (ndiff with -expected +actual):
    - 'Some Title'
    + 'Example Article'
----------------------------------------------------------------------
File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/doc/README.txt", line 137, in README.txt
Failed example:
    article.getText()
Differences (ndiff with -expected +actual):
    - '<p>Here is some Text</p>'
    + '<?xml version="1.0" ?>\n<metadata xmlns="http://plone.org/ns/archetypes/"\n          xmlns:dc="http://purl.org/dc/elements/1.1/"\n          xmlns:xmp="adobe:ns:meta">\n  <dc:title>\n    Some Title\n  </dc:title>\n  <xmp:CreateDate>\n    2004-01-01T00:02:04Z\n  </xmp:CreateDate>\n  <field id="expirationDate">\n    2004-09-09T09:09:08Z\n  </field>\n  <field id="text">\n   Here is some Text\n  </field>\n</metadata>'
----------------------------------------------------------------------
File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/doc/README.txt", line 140, in README.txt
Failed example:
    article.CreationDate()
Differences (ndiff with -expected +actual):
    - '2004-01-01 00:02:04'
    + '2009-09-09 10:59:28'
----------------------------------------------------------------------
File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/doc/README.txt", line 143, in README.txt
Failed example:
    article.ExpirationDate()
Differences (ndiff with -expected +actual):
    - '2004-09-09 09:09:08'
    + 'None'
----------------------------------------------------------------------
File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/doc/README.txt", line 164, in README.txt
Failed example:
    article.Title()
Differences (ndiff with -expected +actual):
    - 'Some Title'
    + 'Example Article'

    13/22 (59.1%)

Failure in test test_marshall_roundtrip (Products.Marshall.tests.test_marshall.simple_xmlDocumentTest)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/tests/test_marshall.py", line 69, in test_marshall_roundtrip
    self.assertEqualsDiff(content, got, normalize=normalize)
  File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/tests/base.py", line 68, in assertEqualsDiff
    self.compare(one, two))
  File "/usr/lib/python2.6/unittest.py", line 325, in failUnless
    if not expr: raise self.failureException, msg
AssertionError:   <?xml version="1.0" ?>
  <document>
   <id>
   document
   </id>
   <title>
   Some Title
   </title>
   <description>
   Neque porro quisquam est qui dolorem ipsum quia dolor sit amet,
   consectetur, adipisci velit...
   There is no one who loves pain
   itself, who seeks after it and wants to have it, simply because it
   is pain...
   </description>
   <subject>
   Test
   Data
   </subject>
   <relatedItems/>
   <location>
   
   </location>
   <language>
   en
   </language>
   <effectiveDate>
   2004/01/01 01:02:03 GMT+1
   </effectiveDate>
   <expirationDate>
   2004/09/09 10:09:08 GMT+1
   </expirationDate>
   <creation_date>
   2004/01/01 01:02:03 GMT+1
   </creation_date>
   <modification_date>
   2004/09/09 10:09:08 GMT+1
   </modification_date>
   <creators>
   sidnei
   cameron
   </creators>
   <contributors>
   sidnei
   alan
   </contributors>
   <rights>
   Copyleft 2004, No Rights Reserved
   </rights>
   <allowDiscussion>
-  0
+  True
   </allowDiscussion>
   <excludeFromNav>
   False
   </excludeFromNav>
   <presentation>
   False
   </presentation>
   <tableContents>
   False
   </tableContents>
  </document>

    15/22 (68.2%)

Failure in test test_marshall_roundtrip (Products.Marshall.tests.test_marshall.rfc822DocumentTest)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/tests/test_marshall.py", line 69, in test_marshall_roundtrip
    self.assertEqualsDiff(content, got, normalize=normalize)
  File "/.../plone-coredev/src/Products.Marshall/Products/Marshall/tests/base.py", line 68, in assertEqualsDiff
    self.compare(one, two))
  File "/usr/lib/python2.6/unittest.py", line 325, in failUnless
    if not expr: raise self.failureException, msg
AssertionError:   id: document
  title: Some Title
  description: Neque porro quisquam est qui dolorem ipsum quia dolor sit amet,
     consectetur, adipisci velit...
     There is no one who loves pain
     itself, who seeks after it and wants to have it, simply because it
     is pain...
  subject: Test
    Data
  relatedItems: 
  location: 
  language: en
  effectiveDate: 2004/01/01 01:02:03 GMT-1
  expirationDate: 2004/09/09 10:09:08 GMT-1
  creation_date: 2004/01/01 01:02:03 GMT-1
  modification_date: 2004/09/09 10:09:08 GMT-1
  creators: sidnei
    cameron
  contributors: sidnei
    alan
  rights: Copyleft 2004, No Rights Reserved
- allowDiscussion: 0
?                  ^

+ allowDiscussion: True
?                  ^^^^

  excludeFromNav: False
  presentation: False
  tableContents: False
  Content-Type: text/plain
  Overview
  This document .....
  First Section
  ....

                  
  Ran 22 tests with 3 failures and 0 errors in # seconds.
Running plone.app.kss.tests.kss_and_plone_layer.KSSAndPloneLayer tests:
  Set up plone.app.kss.tests.kss_and_plone_layer.KSSAndPloneLayer in # seconds.
  Running:
                  
  Ran 19 tests with 0 failures and 0 errors in # seconds.
Running zope.testing.testrunner.layer.UnitTests tests:
  Tear down plone.app.kss.tests.kss_and_plone_layer.KSSAndPloneLayer in # seconds.
  Tear down Products.PloneTestCase.layer.PloneSite in # seconds.
  Tear down Products.PloneTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up zope.testing.testrunner.layer.UnitTests in # seconds.
  Running:
    22/28 (78.6%)/.../plone-coredev/eggs/docutils-0.5-py2.6.egg/docutils/parsers/rst/__init__.py:178: DeprecationWarning: BaseException.message has been deprecated as of Python 2.6
  self.message = message
/.../plone-coredev/eggs/docutils-0.5-py2.6.egg/docutils/parsers/rst/states.py:2046: DeprecationWarning: BaseException.message has been deprecated as of Python 2.6
  directive_error.message)
                  
  Ran 28 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down zope.testing.testrunner.layer.UnitTests in # seconds.
Total: 675 tests, 7 failures, 0 errors in # minutes # seconds.
#### Finished tests for group Archetypes ####

#### Running tests for group CMF ####
Running Testing.ZopeTestCase.layer.ZopeLite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Running:
                    
  Ran 412 tests with 0 failures and 0 errors in # seconds.
Running Products.CMFCore.testing.FunctionalZCMLLayer tests:
  Set up Products.CMFCore.testing.FunctionalZCMLLayer in # seconds.
  Running:
                  
  Ran 54 tests with 0 failures and 0 errors in # seconds.
Running Products.CMFCalendar.testing.FunctionalLayer tests:
  Set up Products.CMFCalendar.testing.FunctionalLayer in # seconds.
  Running:
                  
  Ran 24 tests with 0 failures and 0 errors in # seconds.
Running Products.CMFCore.testing.EventZCMLLayer tests:
  Tear down Products.CMFCalendar.testing.FunctionalLayer in # seconds.
  Tear down Products.CMFCore.testing.FunctionalZCMLLayer in # seconds.
  Set up Products.CMFCore.testing.EventZCMLLayer in # seconds.
  Running:
                  
  Ran 24 tests with 0 failures and 0 errors in # seconds.
Running Products.CMFCore.testing.ExportImportZCMLLayer tests:
  Tear down Products.CMFCore.testing.EventZCMLLayer in # seconds.
  Set up Products.CMFCore.testing.ExportImportZCMLLayer in # seconds.
  Running:
                    
  Ran 112 tests with 0 failures and 0 errors in # seconds.
Running Products.CMFCore.testing.TraversingEventZCMLLayer tests:
  Tear down Products.CMFCore.testing.ExportImportZCMLLayer in # seconds.
  Set up Products.CMFCore.testing.TraversingEventZCMLLayer in # seconds.
  Running:
                  
  Ran 15 tests with 0 failures and 0 errors in # seconds.
Running Products.CMFCore.testing.TraversingZCMLLayer tests:
  Tear down Products.CMFCore.testing.TraversingEventZCMLLayer in # seconds.
  Set up Products.CMFCore.testing.TraversingZCMLLayer in # seconds.
  Running:
                  
  Ran 69 tests with 0 failures and 0 errors in # seconds.
Running Products.CMFDefault.testing.FunctionalLayer tests:
  Tear down Products.CMFCore.testing.TraversingZCMLLayer in # seconds.
  Set up Products.CMFCore.testing.FunctionalZCMLLayer in # seconds.
  Set up Products.CMFDefault.testing.FunctionalLayer in # seconds.
  Running:
                  
  Ran 89 tests with 0 failures and 0 errors in # seconds.
Running Products.CMFTopic.testing.FunctionalLayer tests:
  Tear down Products.CMFDefault.testing.FunctionalLayer in # seconds.
  Set up Products.CMFTopic.testing.FunctionalLayer in # seconds.
  Running:
                
  Ran 1 tests with 0 failures and 0 errors in # seconds.
Running Products.CMFUid.testing.UidEventZCMLLayer tests:
  Tear down Products.CMFTopic.testing.FunctionalLayer in # seconds.
  Tear down Products.CMFCore.testing.FunctionalZCMLLayer in # seconds.
  Set up Products.CMFUid.testing.UidEventZCMLLayer in # seconds.
  Running:
                  
  Ran 12 tests with 0 failures and 0 errors in # seconds.
Running Products.DCWorkflow.testing.ExportImportZCMLLayer tests:
  Tear down Products.CMFUid.testing.UidEventZCMLLayer in # seconds.
  Set up Products.DCWorkflow.testing.ExportImportZCMLLayer in # seconds.
  Running:
                  
  Ran 38 tests with 0 failures and 0 errors in # seconds.
Running Products.GenericSetup.testing.ExportImportZCMLLayer tests:
  Tear down Products.DCWorkflow.testing.ExportImportZCMLLayer in # seconds.
  Set up Products.GenericSetup.testing.ExportImportZCMLLayer in # seconds.
  Running:
                    
  Ran 206 tests with 0 failures and 0 errors in # seconds.
Running zope.testing.testrunner.layer.UnitTests tests:
  Tear down Products.GenericSetup.testing.ExportImportZCMLLayer in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up zope.testing.testrunner.layer.UnitTests in # seconds.
  Running:
                    
  Ran 604 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down zope.testing.testrunner.layer.UnitTests in # seconds.
Total: 1660 tests, 0 failures, 0 errors in # minutes # seconds.
#### Finished tests for group CMF ####

#### Running tests for group CMFEditions ####
Running Testing.ZopeTestCase.layer.ZopeLite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Running:
                  
  Ran 27 tests with 0 failures and 0 errors in # seconds.
Running Products.PloneTestCase.layer.PloneSite tests:
  Set up Products.PloneTestCase.layer.ZCML in # seconds.
  Set up Products.PloneTestCase.layer.PloneSite/.../plone-coredev/src/Products.Archetypes/Products/Archetypes/ArchetypeTool.py:70: DeprecationWarning: package_home is deprecated. import from App.Common instead
  from Globals import package_home
 in # seconds.
  Running:
    72/143 (50.3%)/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/OFS/subscribers.py:73: DeprecationWarning: Products.FAQ.FAQ.FAQ.manage_afterAdd is discouraged. You should use event subscribers instead.
  DeprecationWarning)
    74/143 (51.7%)/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/OFS/subscribers.py:73: DeprecationWarning: Products.FAQ.FAQQuestion.FAQQuestion.manage_afterAdd is discouraged. You should use event subscribers instead.
  DeprecationWarning)
                    
  Ran 143 tests with 0 failures and 0 errors in # minutes # seconds.
Running Products.CMFDiffTool.tests.BaseTestCase.CMFDiffToolLayer tests:
  Set up Products.CMFDiffTool.tests.BaseTestCase.CMFDiffToolLayer in # seconds.
  Running:
                
  Ran 2 tests with 0 failures and 0 errors in # seconds.
Running Products.CMFTestCase.layer.CMFSite tests:
  Tear down Products.CMFDiffTool.tests.BaseTestCase.CMFDiffToolLayer in # seconds.
  Tear down Products.PloneTestCase.layer.PloneSite in # seconds.
  Tear down Products.PloneTestCase.layer.ZCML in # seconds.
  Set up Products.CMFTestCase.layer.ZCML in # seconds.
  Set up Products.CMFTestCase.layer.CMFSite in # seconds.
  Running:
                  
  Ran 20 tests with 0 failures and 0 errors in # seconds.
Running zope.testing.testrunner.layer.UnitTests tests:
  Tear down Products.CMFTestCase.layer.CMFSite in # seconds.
  Tear down Products.CMFTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up zope.testing.testrunner.layer.UnitTests in # seconds.
  Running:
                  
  Ran 10 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down zope.testing.testrunner.layer.UnitTests in # seconds.
Total: 202 tests, 0 failures, 0 errors in # minutes # seconds.
#### Finished tests for group CMFEditions ####

#### Running tests for group Plone ####
Running Testing.ZopeTestCase.layer.ZopeLite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Running:
                    
  Ran 126 tests with 0 failures and 0 errors in # seconds.
Running Products.CMFTestCase.layer.CMFSite tests:
  Set up Products.CMFTestCase.layer.ZCML in # seconds.
  Set up Products.CMFTestCase.layer.CMFSite in # seconds.
  Running:
                  
  Ran 53 tests with 0 failures and 0 errors in # seconds.
Running Products.PloneTestCase.layer.ZCML tests:
  Tear down Products.CMFTestCase.layer.CMFSite in # seconds.
  Tear down Products.CMFTestCase.layer.ZCML in # seconds.
  Set up Products.PloneTestCase.layer.ZCML in # seconds.
  Running:
                  
  Ran 12 tests with 0 failures and 0 errors in # seconds.
Running Products.PloneTestCase.layer.PloneSite tests:
  Set up Products.PloneTestCase.layer.PloneSite in # seconds.
  Running:
    53/1776 (3.0%)

Failure in test test_MembershipTool_deleteMembers (Products.CMFPlone.tests.testCSRFProtection.AuthenticatorTestCase)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Plone/Products/CMFPlone/tests/testCSRFProtection.py", line 101, in test_MembershipTool_deleteMembers
    'member_ids:list=%s' % ptc.default_user)
  File "/.../plone-coredev/src/Plone/Products/CMFPlone/tests/testCSRFProtection.py", line 33, in checkAuthenticator
    self.assertEqual(response.getStatus(), status)
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: 500 != 200

    55/1776 (3.1%)

Failure in test test_PloneTool_acquireLocalRoles (Products.CMFPlone.tests.testCSRFProtection.AuthenticatorTestCase)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Plone/Products/CMFPlone/tests/testCSRFProtection.py", line 51, in test_PloneTool_acquireLocalRoles
    'use_acquisition:int=1', status=302)
  File "/.../plone-coredev/src/Plone/Products/CMFPlone/tests/testCSRFProtection.py", line 33, in checkAuthenticator
    self.assertEqual(response.getStatus(), status)
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: 500 != 302

    291/1776 (16.4%)

Error in test test_bug4333_delete_user_remove_memberdata (Products.CMFPlone.tests.testControlPanelScripts.TestPrefsUserManage)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Plone/Products/CMFPlone/tests/testControlPanelScripts.py", line 140, in test_bug4333_delete_user_remove_memberdata
    self.portal.prefs_user_manage(delete=['barney'])
  File "/.../plone-coredev/src/Products.CMFFormController/Products/CMFFormController/FSControllerPythonScript.py", line 105, in __call__
    result = FSControllerPythonScript.inheritedAttribute('__call__')(self, *args, **kwargs)
  File "/.../plone-coredev/src/Products.CMFFormController/Products/CMFFormController/Script.py", line 145, in __call__
    return BaseFSPythonScript.__call__(self, *args, **kw)
  File "/.../plone-coredev/src/Products.CMFCore/Products/CMFCore/FSPythonScript.py", line 130, in __call__
    return Script.__call__(self, *args, **kw)
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/Shared/DC/Scripts/Bindings.py", line 324, in __call__
    return self._bindAndExec(args, kw, None)
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/Shared/DC/Scripts/Bindings.py", line 361, in _bindAndExec
    return self._exec(bound_data, args, kw)
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/Products/PythonScripts/PythonScript.py", line 344, in _exec
    result = f(*args, **kw)
  File "Script (Python)", line 37, in prefs_user_manage
   - Line 37
  File "<string>", line 4, in deleteMembers
  File "/.../plone-coredev/src/plone.protect/plone/protect/utils.py", line 43, in _curried
    return callable(*args, **kw)
  File "<string>", line 4, in deleteMembers
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/AccessControl/requestmethod.py", line 70, in _curried
    return callable(*args, **kw)
  File "/.../plone-coredev/src/Products.CMFCore/Products/CMFCore/MembershipTool.py", line 526, in deleteMembers
    reindex=1, recursive=1 )
  File "<string>", line 4, in deleteLocalRoles
  File "/.../plone-coredev/src/plone.protect/plone/protect/utils.py", line 43, in _curried
    return callable(*args, **kw)
  File "<string>", line 4, in deleteLocalRoles
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/AccessControl/requestmethod.py", line 70, in _curried
    return callable(*args, **kw)
  File "/.../plone-coredev/src/Products.CMFCore/Products/CMFCore/MembershipTool.py", line 472, in deleteLocalRoles
    obj.reindexObjectSecurity()
AttributeError: reindexObjectSecurity

    300/1776 (16.9%)

Failure in test test_prefsUserManager (Products.CMFPlone.tests.testControlPanelScripts.TestNoGETControlPanel)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Plone/Products/CMFPlone/tests/testControlPanelScripts.py", line 80, in test_prefsUserManager
    self._onlyPOST(path, qstring,success=302)
  File "/.../plone-coredev/src/Plone/Products/CMFPlone/tests/testControlPanelScripts.py", line 38, in _onlyPOST
    self.assertEqual(response.getStatus(), success)
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: 500 != 302

    879/1776 (49.5%)

Failure in test testProcessLatin1 (Products.CMFPlone.tests.testUnicodeSplitter.TestSplitter)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Plone/Products/CMFPlone/tests/testUnicodeSplitter.py", line 89, in testProcessLatin1
    self.assertEqual(self.process(input), output)
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: ['ffin', 'foo'] != ['\xc4ffin', 'foo']

    882/1776 (49.7%)

Failure in test testNormalizeLatin1 (Products.CMFPlone.tests.testUnicodeSplitter.TestCaseNormalizer)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Plone/Products/CMFPlone/tests/testUnicodeSplitter.py", line 122, in testNormalizeLatin1
    self.assertEqual(self.process(input), output)
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: ['\xc4ffin'] != ['\xe4ffin']

    1392/1776 (78.4%)

Failure in test /.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt
Failed doctest test for usergroups.txt
  File "/.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt", line 0

----------------------------------------------------------------------
File "/.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt", line 11, in usergroups.txt
Failed example:
    '@@usergroup-userprefs' in self.browser.url
Expected:
    True
Got:
    False
----------------------------------------------------------------------
File "/.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt", line 29, in usergroups.txt
Failed example:
    'Autumn Brooks' in self.browser.contents
Expected:
    True
Got:
    False
----------------------------------------------------------------------
File "/.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt", line 35, in usergroups.txt
Failed example:
    'Gracie Adams' in self.browser.contents
Expected:
    True
Got:
    False
----------------------------------------------------------------------
File "/.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt", line 39, in usergroups.txt
Failed example:
    self.browser.getControl(name='users.roles:list:records').getControl(value='Contributor').selected
Exception raised:
    Traceback (most recent call last):
      File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 1361, in __run
        compileflags, 1) in test.globs
      File "<doctest usergroups.txt[line 39, example 16]>", line 1, in <module>
        self.browser.getControl(name='users.roles:list:records').getControl(value='Contributor').selected
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 366, in getControl
        control, form = disambiguate(intermediate, msg, index)
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 54, in disambiguate
        raise LookupError(msg)
    LookupError: name 'users.roles:list:records'
----------------------------------------------------------------------
File "/.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt", line 41, in usergroups.txt
Failed example:
    self.browser.getControl(name='users.roles:list:records').getControl(value='Contributor').selected = True
Exception raised:
    Traceback (most recent call last):
      File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 1361, in __run
        compileflags, 1) in test.globs
      File "<doctest usergroups.txt[line 41, example 17]>", line 1, in <module>
        self.browser.getControl(name='users.roles:list:records').getControl(value='Contributor').selected = True
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 366, in getControl
        control, form = disambiguate(intermediate, msg, index)
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 54, in disambiguate
        raise LookupError(msg)
    LookupError: name 'users.roles:list:records'
----------------------------------------------------------------------
File "/.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt", line 42, in usergroups.txt
Failed example:
    self.browser.getControl(name='users.email:records').value
Exception raised:
    Traceback (most recent call last):
      File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 1361, in __run
        compileflags, 1) in test.globs
      File "<doctest usergroups.txt[line 42, example 18]>", line 1, in <module>
        self.browser.getControl(name='users.email:records').value
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 366, in getControl
        control, form = disambiguate(intermediate, msg, index)
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 54, in disambiguate
        raise LookupError(msg)
    LookupError: name 'users.email:records'
----------------------------------------------------------------------
File "/.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt", line 44, in usergroups.txt
Failed example:
    self.browser.getControl(name='users.email:records').value = 'gracie@bar.com'
Exception raised:
    Traceback (most recent call last):
      File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 1361, in __run
        compileflags, 1) in test.globs
      File "<doctest usergroups.txt[line 44, example 19]>", line 1, in <module>
        self.browser.getControl(name='users.email:records').value = 'gracie@bar.com'
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 366, in getControl
        control, form = disambiguate(intermediate, msg, index)
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 54, in disambiguate
        raise LookupError(msg)
    LookupError: name 'users.email:records'
----------------------------------------------------------------------
File "/.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt", line 45, in usergroups.txt
Failed example:
    self.browser.getControl(name='form.button.Modify').click()
Exception raised:
    Traceback (most recent call last):
      File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 1361, in __run
        compileflags, 1) in test.globs
      File "<doctest usergroups.txt[line 45, example 20]>", line 1, in <module>
        self.browser.getControl(name='form.button.Modify').click()
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 366, in getControl
        control, form = disambiguate(intermediate, msg, index)
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 54, in disambiguate
        raise LookupError(msg)
    LookupError: name 'form.button.Modify'
----------------------------------------------------------------------
File "/.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt", line 52, in usergroups.txt
Failed example:
    self.browser.getControl(name='users.roles:list:records').getControl(value='Contributor').selected
Exception raised:
    Traceback (most recent call last):
      File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 1361, in __run
        compileflags, 1) in test.globs
      File "<doctest usergroups.txt[line 52, example 22]>", line 1, in <module>
        self.browser.getControl(name='users.roles:list:records').getControl(value='Contributor').selected
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 366, in getControl
        control, form = disambiguate(intermediate, msg, index)
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 54, in disambiguate
        raise LookupError(msg)
    LookupError: name 'users.roles:list:records'
----------------------------------------------------------------------
File "/.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt", line 54, in usergroups.txt
Failed example:
    self.browser.getControl(name='users.email:records').value
Exception raised:
    Traceback (most recent call last):
      File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 1361, in __run
        compileflags, 1) in test.globs
      File "<doctest usergroups.txt[line 54, example 23]>", line 1, in <module>
        self.browser.getControl(name='users.email:records').value
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 366, in getControl
        control, form = disambiguate(intermediate, msg, index)
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 54, in disambiguate
        raise LookupError(msg)
    LookupError: name 'users.email:records'
----------------------------------------------------------------------
File "/.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt", line 58, in usergroups.txt
Failed example:
    self.browser.getControl(name='users.resetpassword:records').value = True
Exception raised:
    Traceback (most recent call last):
      File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 1361, in __run
        compileflags, 1) in test.globs
      File "<doctest usergroups.txt[line 58, example 24]>", line 1, in <module>
        self.browser.getControl(name='users.resetpassword:records').value = True
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 366, in getControl
        control, form = disambiguate(intermediate, msg, index)
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 54, in disambiguate
        raise LookupError(msg)
    LookupError: name 'users.resetpassword:records'
----------------------------------------------------------------------
File "/.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt", line 59, in usergroups.txt
Failed example:
    self.browser.getControl(name='form.button.Modify').click()
Exception raised:
    Traceback (most recent call last):
      File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 1361, in __run
        compileflags, 1) in test.globs
      File "<doctest usergroups.txt[line 59, example 25]>", line 1, in <module>
        self.browser.getControl(name='form.button.Modify').click()
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 366, in getControl
        control, form = disambiguate(intermediate, msg, index)
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 54, in disambiguate
        raise LookupError(msg)
    LookupError: name 'form.button.Modify'
----------------------------------------------------------------------
File "/.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt", line 62, in usergroups.txt
Failed example:
    'No mailhost defined. Unable to reset passwords.' in self.browser.contents
Expected:
    True
Got:
    False
----------------------------------------------------------------------
File "/.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt", line 84, in usergroups.txt
Failed example:
    self.browser.getControl(name='delete:list').getControl(value='RwAO2YPa').selected = True
Exception raised:
    Traceback (most recent call last):
      File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 1361, in __run
        compileflags, 1) in test.globs
      File "<doctest usergroups.txt[line 84, example 29]>", line 1, in <module>
        self.browser.getControl(name='delete:list').getControl(value='RwAO2YPa').selected = True
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 366, in getControl
        control, form = disambiguate(intermediate, msg, index)
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 54, in disambiguate
        raise LookupError(msg)
    LookupError: name 'delete:list'
----------------------------------------------------------------------
File "/.../plone-coredev/src/plone.app.controlpanel/plone/app/controlpanel/tests/usergroups.txt", line 85, in usergroups.txt
Failed example:
    self.browser.getControl(name='form.button.Modify').click()
Exception raised:
    Traceback (most recent call last):
      File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 1361, in __run
        compileflags, 1) in test.globs
      File "<doctest usergroups.txt[line 85, example 30]>", line 1, in <module>
        self.browser.getControl(name='form.button.Modify').click()
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 366, in getControl
        control, form = disambiguate(intermediate, msg, index)
      File "/.../plone-coredev/eggs/zope.testbrowser-3.6.0a2-py2.6.egg/zope/testbrowser/browser.py", line 54, in disambiguate
        raise LookupError(msg)
    LookupError: name 'form.button.Modify'

    1492/1776 (84.0%)

Error in test test_transitionHistory (plone.app.layout.viewlets.tests.test_history.TestWorkflowHistoryViewlet)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/plone.app.layout/plone/app/layout/viewlets/tests/test_history.py", line 52, in test_transitionHistory
    self.delMember('tempuser')
  File "/.../plone-coredev/src/plone.app.layout/plone/app/layout/viewlets/tests/test_history.py", line 20, in delMember
    self.portal.portal_membership.deleteMembers([username])
  File "<string>", line 4, in deleteMembers
  File "/.../plone-coredev/src/plone.protect/plone/protect/utils.py", line 43, in _curried
    return callable(*args, **kw)
  File "<string>", line 4, in deleteMembers
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/AccessControl/requestmethod.py", line 70, in _curried
    return callable(*args, **kw)
  File "/.../plone-coredev/src/Products.CMFCore/Products/CMFCore/MembershipTool.py", line 526, in deleteMembers
    reindex=1, recursive=1 )
  File "<string>", line 4, in deleteLocalRoles
  File "/.../plone-coredev/src/plone.protect/plone/protect/utils.py", line 43, in _curried
    return callable(*args, **kw)
  File "<string>", line 4, in deleteLocalRoles
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/AccessControl/requestmethod.py", line 70, in _curried
    return callable(*args, **kw)
  File "/.../plone-coredev/src/Products.CMFCore/Products/CMFCore/MembershipTool.py", line 472, in deleteLocalRoles
    obj.reindexObjectSecurity()
AttributeError: reindexObjectSecurity

    1541/1776 (86.8%)

Failure in test testRegisterToolsAsUtilities (plone.app.upgrade.v30.tests.TestMigrations_v2_5_x)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/plone.app.upgrade/plone/app/upgrade/v30/tests.py", line 480, in testRegisterToolsAsUtilities
    self.failIf(sm.queryUtility(i) is None)
  File "/usr/lib/python2.6/unittest.py", line 321, in failIf
    if expr: raise self.failureException, msg
AssertionError

    1554/1776 (87.5%)

Error in test testInstallKss (plone.app.upgrade.v30.tests.TestMigrations_v3_0_alpha1)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/plone.app.upgrade/plone/app/upgrade/v30/tests.py", line 626, in testInstallKss
    mt.manage_delObjects((mtid, ))
  File "/.../plone-coredev/src/Products.MimetypesRegistry/Products/MimetypesRegistry/MimeTypesRegistry.py", line 421, in manage_delObjects
    self.unregister(self.lookup(id)[0])
IndexError: tuple index out of range

    1611/1776 (90.7%)

Error in test testMigrateControlPanelActionIcons (plone.app.upgrade.v40.tests.TestMigrations_v4_0alpha1)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/plone.app.upgrade/plone/app/upgrade/v40/tests.py", line 97, in testMigrateControlPanelActionIcons
    icon_expr=''
TypeError: addAction() got an unexpected keyword argument 'icon_expr'

                      
  Ran 1776 tests with 7 failures and 4 errors in # minutes # seconds.
Running plone.app.contentrules.tests.test_configuration.TestContentrulesGSLayer tests:
  Set up plone.app.contentrules.tests.test_configuration.TestContentrulesGSLayer in # seconds.
  Running:
                
  Ran 6 tests with 0 failures and 0 errors in # seconds.
Running plone.app.customerize.tests.layer.PloneCustomerize tests:
  Tear down plone.app.contentrules.tests.test_configuration.TestContentrulesGSLayer in # seconds.
  Set up plone.app.customerize.tests.layer.PloneCustomerize in # seconds.
  Running:
                  
  Ran 27 tests with 0 failures and 0 errors in # minutes # seconds.
Running plone.app.kss.tests.kss_and_plone_layer.KSSAndPloneLayer tests:
  Tear down plone.app.customerize.tests.layer.PloneCustomerize in # seconds.
  Set up plone.app.kss.tests.kss_and_plone_layer.KSSAndPloneLayer in # seconds.
  Running:
    12/13 (92.3%)

Error in test test_update_of_nav_portlet (plone.app.kss.tests.test_part_reloading.TestPortletReloading)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/plone.app.kss/plone/app/kss/tests/test_part_reloading.py", line 62, in test_update_of_nav_portlet
    attributesTriggerNavigationPortletReload(folder, self.view, modified_event)
  File "/.../plone-coredev/src/plone.app.kss/plone/app/kss/portlets.py", line 20, in attributesTriggerNavigationPortletReload
    portletReloader.reloadPortletsByInterface(INavigationPortlet)
  File "/.../plone-coredev/src/plone.app.kss/plone/app/kss/portlets.py", line 58, in reloadPortletsByInterface
    self.reloadPortletByInfo(info)
  File "/.../plone-coredev/src/plone.app.kss/plone/app/kss/portlets.py", line 70, in reloadPortletByInfo
    result = renderer.render()
  File "/.../plone-coredev/src/plone.app.portlets/plone/app/portlets/portlets/navigation.py", line 211, in render
    return self._template()
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/Products/Five/browser/pagetemplatefile.py", line 126, in __call__
    return self.im_func(im_self, *args, **kw)
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/Products/Five/browser/pagetemplatefile.py", line 60, in __call__
    sourceAnnotations=getattr(debug_flags, 'sourceAnnotations', 0),
  File "/.../plone-coredev/eggs/zope.pagetemplate-3.5.0-py2.6.egg/zope/pagetemplate/pagetemplate.py", line 115, in pt_render
    strictinsert=0, sourceAnnotations=sourceAnnotations)()
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 271, in __call__
    self.interpret(self.program)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 343, in interpret
    handlers[opcode](self, args)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 533, in do_optTag_tal
    self.do_optTag(stuff)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 518, in do_optTag
    return self.no_tag(start, program)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 513, in no_tag
    self.interpret(program)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 343, in interpret
    handlers[opcode](self, args)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 531, in do_optTag_tal
    self.no_tag(stuff[-2], stuff[-1])
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 513, in no_tag
    self.interpret(program)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 343, in interpret
    handlers[opcode](self, args)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 742, in do_insertStructure_tal
    structure = self.engine.evaluateStructure(expr)
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/Products/PageTemplates/Expressions.py", line 195, in evaluateStructure
    text = super(ZopeContext, self).evaluateStructure(expr)
  File "/.../plone-coredev/eggs/zope.tales-3.4.0-py2.6.egg/zope/tales/tales.py", line 696, in evaluate
    return expression(self)
   - /.../plone-coredev/src/plone.app.portlets/plone/app/portlets/portlets/navigation.pt
   - Line 40, Column 12
   - Expression: <PathExpr standard:u'view/createNavTree'>
   - Names:
      {'args': (),
       'container': <ATFolder at /plone/testfolder>,
       'context': <ATFolder at /plone/testfolder>,
       'default': <object object at 0xb8087590>,
       'here': <ATFolder at /plone/testfolder>,
       'loop': {},
       'nothing': None,
       'options': {},
       'repeat': <Products.PageTemplates.Expressions.SafeMapping object at 0x12ed692c>,
       'request': <HTTPRequest, URL=http://nohost>,
       'root': <Application at >,
       'template': <Products.Five.browser.pagetemplatefile.ViewPageTemplateFile object at 0xb53a56c>,
       'traverse_subpath': [],
       'user': <PropertiedUser 'portal_owner'>,
       'view': <plone.app.portlets.portlets.navigation.Renderer object at 0x1239946c>,
       'views': <Products.Five.browser.pagetemplatefile.ViewMapper object at 0x1239964c>}
  File "/.../plone-coredev/eggs/zope.tales-3.4.0-py2.6.egg/zope/tales/expressions.py", line 217, in __call__
    return self._eval(econtext)
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/Products/PageTemplates/Expressions.py", line 135, in _eval
    return render(ob, econtext.vars)
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/Products/PageTemplates/Expressions.py", line 99, in render
    ob = ob()
  File "/.../plone-coredev/src/plone.app.portlets/plone/app/portlets/portlets/navigation.py", line 171, in createNavTree
    return self.recurse(children=data.get('children', []), level=1, bottomLevel=bottomLevel)
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/Products/Five/browser/pagetemplatefile.py", line 126, in __call__
    return self.im_func(im_self, *args, **kw)
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/Products/Five/browser/pagetemplatefile.py", line 60, in __call__
    sourceAnnotations=getattr(debug_flags, 'sourceAnnotations', 0),
  File "/.../plone-coredev/eggs/zope.pagetemplate-3.5.0-py2.6.egg/zope/pagetemplate/pagetemplate.py", line 115, in pt_render
    strictinsert=0, sourceAnnotations=sourceAnnotations)()
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 271, in __call__
    self.interpret(self.program)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 343, in interpret
    handlers[opcode](self, args)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 533, in do_optTag_tal
    self.do_optTag(stuff)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 518, in do_optTag
    return self.no_tag(start, program)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 513, in no_tag
    self.interpret(program)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 343, in interpret
    handlers[opcode](self, args)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 858, in do_defineMacro
    self.interpret(macro)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 343, in interpret
    handlers[opcode](self, args)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 533, in do_optTag_tal
    self.do_optTag(stuff)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 518, in do_optTag
    return self.no_tag(start, program)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 513, in no_tag
    self.interpret(program)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 343, in interpret
    handlers[opcode](self, args)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 821, in do_loop_tal
    self.interpret(block)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 343, in interpret
    handlers[opcode](self, args)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 533, in do_optTag_tal
    self.do_optTag(stuff)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 518, in do_optTag
    return self.no_tag(start, program)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 513, in no_tag
    self.interpret(program)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 343, in interpret
    handlers[opcode](self, args)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 852, in do_condition
    self.interpret(block)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 343, in interpret
    handlers[opcode](self, args)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 533, in do_optTag_tal
    self.do_optTag(stuff)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 518, in do_optTag
    return self.no_tag(start, program)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 513, in no_tag
    self.interpret(program)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 343, in interpret
    handlers[opcode](self, args)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 531, in do_optTag_tal
    self.no_tag(stuff[-2], stuff[-1])
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 513, in no_tag
    self.interpret(program)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 343, in interpret
    handlers[opcode](self, args)
  File "/.../plone-coredev/eggs/zope.tal-3.5.1-py2.6.egg/zope/tal/talinterpreter.py", line 742, in do_insertStructure_tal
    structure = self.engine.evaluateStructure(expr)
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/Products/PageTemplates/Expressions.py", line 195, in evaluateStructure
    text = super(ZopeContext, self).evaluateStructure(expr)
  File "/.../plone-coredev/eggs/zope.tales-3.4.0-py2.6.egg/zope/tales/tales.py", line 696, in evaluate
    return expression(self)
   - /.../plone-coredev/src/plone.app.portlets/plone/app/portlets/portlets/navigation_recurse.pt
   - Line 27, Column 12
   - Expression: <PathExpr standard:u'item_icon/html_tag'>
   - Names:
      {'args': (),
       'container': <ATFolder at /plone/testfolder>,
       'context': <ATFolder at /plone/testfolder>,
       'default': <object object at 0xb8087590>,
       'here': <ATFolder at /plone/testfolder>,
       'loop': {},
       'nothing': None,
       'options': {'bottomLevel': 0,
                   'children': [{'Creator': 'portal_owner',
                                 'Description': "Container for users' home directories",
                                 'Title': 'Users',
                                 '_pruneSubtree': True,
                                 'absolute_url': 'http://nohost/plone/Members',
                                 'children': [],
                                 'creation_date': '2009-09-09 11:06:51',
                                 'currentItem': False,
                                 'currentParent': False,
                                 'depth': 1,
                                 'getRemoteUrl': Missing.Value,
                                 'getURL': 'http://nohost/plone/Members',
                                 'item': <Products.ZCatalog.Catalog.mybrains object at 0x1229b2ac>,
                                 'item_icon': <plone.app.layout.icons.icons.CatalogBrainContentIcon object at 0x12aef0ec>,
                                 'link_remote': Missing.Value,
                                 'no_display': False,
                                 'normalized_portal_type': 'large-plone-folder',
                                 'normalized_review_state': 'visible',
                                 'path': '/plone/Members',
                                 'portal_type': 'Large Plone Folder',
                                 'review_state': 'visible',
                                 'show_children': False},
                                {'Creator': 'portal_owner',
                                 'Description': 'Site News',
                                 'Title': 'News',
                                 '_pruneSubtree': True,
                                 'absolute_url': 'http://nohost/plone/news',
                                 'children': [],
                                 'creation_date': '2009-09-09 11:06:53',
                                 'currentItem': False,
                                 'currentParent': False,
                                 'depth': 1,
                                 'getRemoteUrl': Missing.Value,
                                 'getURL': 'http://nohost/plone/news',
                                 'item': <Products.ZCatalog.Catalog.mybrains object at 0x129e6504>,
                                 'item_icon': <plone.app.layout.icons.icons.CatalogBrainContentIcon object at 0x12aef42c>,
                                 'link_remote': Missing.Value,
                                 'no_display': False,
                                 'normalized_portal_type': 'large-plone-folder',
                                 'normalized_review_state': 'visible',
                                 'path': '/plone/news',
                                 'portal_type': 'Large Plone Folder',
                                 'review_state': 'visible',
                                 'show_children': False},
                                {'Creator': 'portal_owner',
                                 'Description': 'Site Events',
                                 'Title': 'Events',
                                 '_pruneSubtree': True,
                                 'absolute_url': 'http://nohost/plone/events',
                                 'children': [],
                                 'creation_date': '2009-09-09 11:06:53',
                                 'currentItem': False,
                                 'currentParent': False,
                                 'depth': 1,
                                 'getRemoteUrl': Missing.Value,
                                 'getURL': 'http://nohost/plone/events',
                                 'item': <Products.ZCatalog.Catalog.mybrains object at 0x129e6694>,
                                 'item_icon': <plone.app.layout.icons.icons.CatalogBrainContentIcon object at 0x12aef54c>,
                                 'link_remote': Missing.Value,
                                 'no_display': False,
                                 'normalized_portal_type': 'large-plone-folder',
                                 'normalized_review_state': 'visible',
                                 'path': '/plone/events',
                                 'portal_type': 'Large Plone Folder',
                                 'review_state': 'visible',
                                 'show_children': False},
                                {'Creator': 'portal_owner',
                                 'Description': '',
                                 'Title': 'testfolder',
                                 'absolute_url': 'http://nohost/plone/testfolder',
                                 'children': [],
                                 'creation_date': '2009-09-09 11:22:45',
                                 'currentItem': True,
                                 'currentParent': False,
                                 'depth': 1,
                                 'getRemoteUrl': Missing.Value,
                                 'getURL': 'http://nohost/plone/testfolder',
                                 'item': <Products.ZCatalog.Catalog.mybrains object at 0x129e6a2c>,
                                 'item_icon': <plone.app.layout.icons.icons.CatalogBrainContentIcon object at 0x12aef48c>,
                                 'link_remote': Missing.Value,
                                 'no_display': False,
                                 'normalized_portal_type': 'folder',
                                 'normalized_review_state': 'visible',
                                 'path': '/plone/testfolder',
                                 'portal_type': 'Folder',
                                 'review_state': 'visible',
                                 'show_children': True}],
                   'level': 1},
       'repeat': <Products.PageTemplates.Expressions.SafeMapping object at 0x12ed6e8c>,
       'request': <HTTPRequest, URL=http://nohost>,
       'root': <Application at >,
       'template': <Products.Five.browser.pagetemplatefile.ViewPageTemplateFile object at 0xb53a42c>,
       'traverse_subpath': [],
       'user': <PropertiedUser 'portal_owner'>,
       'view': <plone.app.portlets.portlets.navigation.Renderer object at 0x1239946c>,
       'views': <Products.Five.browser.pagetemplatefile.ViewMapper object at 0x12b3866c>}
  File "/.../plone-coredev/eggs/zope.tales-3.4.0-py2.6.egg/zope/tales/expressions.py", line 217, in __call__
    return self._eval(econtext)
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/Products/PageTemplates/Expressions.py", line 127, in _eval
    ob = self._subexprs[-1](econtext)
  File "/.../plone-coredev/eggs/zope.tales-3.4.0-py2.6.egg/zope/tales/expressions.py", line 124, in _eval
    ob = self._traverser(ob, element, econtext)
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/Products/PageTemplates/Expressions.py", line 79, in boboAwareZopeTraverse
    request=request)
  File "/.../plone-coredev/eggs/zope.traversing-3.7.1-py2.6.egg/zope/traversing/adapters.py", line 139, in traversePathElement
    return traversable.traverse(nm, further_path)
   - __traceback_info__: (u'<img width="16" height="16" src="http://nohost/plone/folder_icon.png" alt="Large Folder" />', 'html_tag')
  File "/.../plone-coredev/eggs/zope.traversing-3.7.1-py2.6.egg/zope/traversing/adapters.py", line 53, in traverse
    raise LocationError(subject, name)
   - __traceback_info__: (u'<img width="16" height="16" src="http://nohost/plone/folder_icon.png" alt="Large Folder" />', 'html_tag', [])
LocationError: (u'<img width="16" height="16" src="http://nohost/plone/folder_icon.png" alt="Large Folder" />', 'html_tag')

                  
  Ran 13 tests with 0 failures and 1 errors in # seconds.
Running plone.app.linkintegrity.tests.layer.PloneLinkintegrity tests:
  Tear down plone.app.kss.tests.kss_and_plone_layer.KSSAndPloneLayer in # seconds.
  Set up plone.app.linkintegrity.tests.layer.PloneLinkintegrity in # seconds.
  Running:
                    
  Ran 115 tests with 0 failures and 0 errors in # minutes # seconds.
Running plone.app.viewletmanager.tests.test_exportimport.Layer tests:
  Tear down plone.app.linkintegrity.tests.layer.PloneLinkintegrity in # seconds.
  Tear down Products.PloneTestCase.layer.PloneSite in # seconds.
  Tear down Products.PloneTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up plone.app.viewletmanager.tests.test_exportimport.Layer in # seconds.
  Running:
                  
  Ran 16 tests with 0 failures and 0 errors in # seconds.
Running zope.testing.testrunner.layer.UnitTests tests:
  Tear down plone.app.viewletmanager.tests.test_exportimport.Layer in # seconds.
  Set up zope.testing.testrunner.layer.UnitTests in # seconds.
  Running:
                    
  Ran 133 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down zope.testing.testrunner.layer.UnitTests in # seconds.
Total: 2277 tests, 7 failures, 5 errors in # minutes # seconds.
#### Finished tests for group Plone ####

#### Running tests for group PlonePAS ####
Running Testing.ZopeTestCase.layer.ZopeLite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Running:
                    
  Ran 165 tests with 0 failures and 0 errors in # seconds.
Running Products.PloneTestCase.layer.ZCML tests:
  Set up Products.PloneTestCase.layer.ZCML in # seconds.
  Running:
                  
  Ran 38 tests with 0 failures and 0 errors in # seconds.
Running Products.PlonePAS.tests.layer.PlonePASLayer tests:
  Set up Products.PloneTestCase.layer.PloneSite in # seconds.
  Set up Products.PlonePAS.tests.layer.PlonePASLayer in # seconds.
  Running:
    114/148 (77.0%)

Error in test test_bug4333_delete_user_remove_memberdata (Products.PlonePAS.tests.test_membershiptool.TestMembershipTool)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Products.PlonePAS/Products/PlonePAS/tests/test_membershiptool.py", line 442, in test_bug4333_delete_user_remove_memberdata
    self.membership.deleteMembers(['barney'])
  File "<string>", line 4, in deleteMembers
  File "/.../plone-coredev/src/plone.protect/plone/protect/utils.py", line 43, in _curried
    return callable(*args, **kw)
  File "<string>", line 4, in deleteMembers
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/AccessControl/requestmethod.py", line 70, in _curried
    return callable(*args, **kw)
  File "/.../plone-coredev/src/Products.CMFCore/Products/CMFCore/MembershipTool.py", line 526, in deleteMembers
    reindex=1, recursive=1 )
  File "<string>", line 4, in deleteLocalRoles
  File "/.../plone-coredev/src/plone.protect/plone/protect/utils.py", line 43, in _curried
    return callable(*args, **kw)
  File "<string>", line 4, in deleteLocalRoles
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/AccessControl/requestmethod.py", line 70, in _curried
    return callable(*args, **kw)
  File "/.../plone-coredev/src/Products.CMFCore/Products/CMFCore/MembershipTool.py", line 472, in deleteLocalRoles
    obj.reindexObjectSecurity()
AttributeError: reindexObjectSecurity

                    
  Ran 148 tests with 0 failures and 1 errors in # seconds.
Running zope.testing.testrunner.layer.UnitTests tests:
  Tear down Products.PlonePAS.tests.layer.PlonePASLayer in # seconds.
  Tear down Products.PloneTestCase.layer.PloneSite in # seconds.
  Tear down Products.PloneTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up zope.testing.testrunner.layer.UnitTests in # seconds.
  Running:
                    
  Ran 371 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down zope.testing.testrunner.layer.UnitTests in # seconds.
Total: 722 tests, 0 failures, 1 errors in # minutes # seconds.
#### Finished tests for group PlonePAS ####

#### Running tests for group plone ####
Running Products.PloneTestCase.layer.PloneSite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up Products.PloneTestCase.layer.ZCML in # seconds.
  Set up Products.PloneTestCase.layer.PloneSite in # seconds.
  Running:
    13/36 (36.1%)/.../plone-coredev/src/borg.localrole/borg/localrole/bbb/bbb.txt:1: DeprecationWarning: IWorkspace is deprecated. Please use borg.localrole.interfaces.ILocalRoleProvider instead
  =========
/.../plone-coredev/src/borg.localrole/borg/localrole/bbb/bbb.txt:1: DeprecationWarning: IGroupAwareWorkspace is deprecated. Please use borg.localrole.interfaces.ILocalRoleProvider instead
  =========
                  
  Ran 36 tests with 0 failures and 0 errors in # seconds.
Running plone.browserlayer.tests.test_doctest.PloneBrowserLayerLayer tests:
  Set up plone.browserlayer.tests.test_doctest.PloneBrowserLayerLayer in # seconds.
  Running:
                
  Ran 9 tests with 0 failures and 0 errors in # seconds.
Running plone.theme.tests.test_doctest.PloneThemeLayer tests:
  Tear down plone.browserlayer.tests.test_doctest.PloneBrowserLayerLayer in # seconds.
  Set up plone.theme.tests.test_doctest.PloneThemeLayer in # seconds.
  Running:
                
  Ran 5 tests with 0 failures and 0 errors in # seconds.
Running zope.testing.testrunner.layer.UnitTests tests:
  Tear down plone.theme.tests.test_doctest.PloneThemeLayer in # seconds.
  Tear down Products.PloneTestCase.layer.PloneSite in # seconds.
  Tear down Products.PloneTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up zope.testing.testrunner.layer.UnitTests in # seconds.
  Running:
    74/260 (28.5%)/usr/lib/python2.6/mhlib.py:83: DeprecationWarning: the multifile module has been deprecated since Python 2.5
  import multifile


Error in test /.../plone-coredev/eggs/plone.contentrules-1.1.0-py2.6.egg/plone/contentrules/README.txt
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 270, in run
    self.setUp()
  File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 2289, in setUp
    self._dt_setUp(test)
  File "/.../plone-coredev/eggs/plone.contentrules-1.1.0-py2.6.egg/plone/contentrules/tests.py", line 24, in configurationSetUp
    XMLConfig('configure.zcml', zope.app.security)()
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 703, in __init__
    include(context, file_name, module)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 546, in include
    processxmlfile(f, context)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 378, in processxmlfile
    parser.parse(src)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 109, in parse
    xmlreader.IncrementalParser.parse(self, source)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/xmlreader.py", line 123, in parse
    self.feed(buffer)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 216, in feed
    self._parser.Parse(data, isFinal)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 364, in end_element_ns
    self._cont_handler.endElementNS(pair, None)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 357, in endElementNS
    self.context.end()
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 537, in end
    self.stack.pop().finish()
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 685, in finish
    actions = self.handler(context, **args)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 546, in include
    processxmlfile(f, context)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 378, in processxmlfile
    parser.parse(src)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 109, in parse
    xmlreader.IncrementalParser.parse(self, source)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/xmlreader.py", line 123, in parse
    self.feed(buffer)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 216, in feed
    self._parser.Parse(data, isFinal)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 353, in start_element_ns
    AttributesNSImpl(newattrs, qnames))
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 230, in startElementNS
    self.context.begin(name, data, info)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 534, in begin
    self.stack.append(self.stack[-1].contained(__name, __data, __info))
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 835, in contained
    return RootStackItem.contained(self, name, data, info)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 706, in contained
    adapter = factory(self.context, data, info)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 1179, in factory
    args = toargs(context, schema, data)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 1376, in toargs
    args[str(name)] = field.fromUnicode(s)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/fields.py", line 139, in fromUnicode
    value = self.context.resolve(name)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 180, in resolve
    mod = __import__(mname, *_import_chickens)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/__init__.py", line 105, in <module>
    import Context
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/Context.py", line 15, in <module>
    import CoreFunctions
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/CoreFunctions.py", line 20, in <module>
    from xml.xpath import Util, Conversions
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/Conversions.py", line 22, in <module>
    from xml.utils import boolean
ZopeXMLConfigurationError: File "/.../plone-coredev/eggs/zope.app.security-3.7.0-py2.6.egg/zope/app/security/configure.zcml", line 11.2-11.39
    ZopeXMLConfigurationError: File "/.../plone-coredev/eggs/zope.app.security-3.7.0-py2.6.egg/zope/app/security/globalmodules.zcml", line 375.2
    ImportError: cannot import name boolean

    78/260 (30.0%)

Error in test /.../plone-coredev/eggs/plone.contentrules-1.1.0-py2.6.egg/plone/contentrules/zcml.txt
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 270, in run
    self.setUp()
  File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 2289, in setUp
    self._dt_setUp(test)
  File "/.../plone-coredev/eggs/plone.contentrules-1.1.0-py2.6.egg/plone/contentrules/tests.py", line 24, in configurationSetUp
    XMLConfig('configure.zcml', zope.app.security)()
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 703, in __init__
    include(context, file_name, module)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 546, in include
    processxmlfile(f, context)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 378, in processxmlfile
    parser.parse(src)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 109, in parse
    xmlreader.IncrementalParser.parse(self, source)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/xmlreader.py", line 123, in parse
    self.feed(buffer)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 216, in feed
    self._parser.Parse(data, isFinal)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 364, in end_element_ns
    self._cont_handler.endElementNS(pair, None)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 357, in endElementNS
    self.context.end()
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 537, in end
    self.stack.pop().finish()
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 685, in finish
    actions = self.handler(context, **args)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 546, in include
    processxmlfile(f, context)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 378, in processxmlfile
    parser.parse(src)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 109, in parse
    xmlreader.IncrementalParser.parse(self, source)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/xmlreader.py", line 123, in parse
    self.feed(buffer)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 216, in feed
    self._parser.Parse(data, isFinal)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 353, in start_element_ns
    AttributesNSImpl(newattrs, qnames))
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 230, in startElementNS
    self.context.begin(name, data, info)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 534, in begin
    self.stack.append(self.stack[-1].contained(__name, __data, __info))
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 835, in contained
    return RootStackItem.contained(self, name, data, info)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 706, in contained
    adapter = factory(self.context, data, info)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 1179, in factory
    args = toargs(context, schema, data)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 1376, in toargs
    args[str(name)] = field.fromUnicode(s)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/fields.py", line 139, in fromUnicode
    value = self.context.resolve(name)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 180, in resolve
    mod = __import__(mname, *_import_chickens)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/__init__.py", line 105, in <module>
    import Context
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/Context.py", line 15, in <module>
    import CoreFunctions
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/CoreFunctions.py", line 17, in <module>
    from xml.xpath import ExpandedNameWrapper
ZopeXMLConfigurationError: File "/.../plone-coredev/eggs/zope.app.security-3.7.0-py2.6.egg/zope/app/security/configure.zcml", line 11.2-11.39
    ZopeXMLConfigurationError: File "/.../plone-coredev/eggs/zope.app.security-3.7.0-py2.6.egg/zope/app/security/globalmodules.zcml", line 375.2
    ImportError: cannot import name ExpandedNameWrapper

    259/260 (99.6%)Usage: A simple tool for basic configuration of Speech Dispatcher
and problem diagnostics

usage: test [options]

test: error: no such option: --exit-with-status
Usage: A simple tool for basic configuration of Speech Dispatcher
and problem diagnostics

usage: test [options]

test: error: no such option: --exit-with-status
Usage: A simple tool for basic configuration of Speech Dispatcher
and problem diagnostics

usage: test [options]

test: error: no such option: --exit-with-status
Usage: A simple tool for basic configuration of Speech Dispatcher
and problem diagnostics

usage: test [options]

test: error: no such option: --exit-with-status


Failure in test /.../plone-coredev/eggs/z3c.autoinclude-0.3.1-py2.6.egg/z3c/autoinclude/tests/../dependency.txt
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/usr/lib/python2.6/doctest.py", line 2145, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for dependency.txt
  File "/.../plone-coredev/eggs/z3c.autoinclude-0.3.1-py2.6.egg/z3c/autoinclude/tests/../dependency.txt", line 0

----------------------------------------------------------------------
File "/.../plone-coredev/eggs/z3c.autoinclude-0.3.1-py2.6.egg/z3c/autoinclude/tests/../dependency.txt", line 108, in dependency.txt
Failed example:
    pprint(b_include_finder.includableInfo(['configure.zcml',
                                            'meta.zcml']))
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python2.6/doctest.py", line 1241, in __run
        compileflags, 1) in test.globs
      File "<doctest dependency.txt[25]>", line 2, in <module>
        'meta.zcml']))
      File "/.../plone-coredev/eggs/z3c.autoinclude-0.3.1-py2.6.egg/z3c/autoinclude/dependency.py", line 24, in includableInfo
        module = resolve(dotted_name)
      File "/.../plone-coredev/eggs/zope.dottedname-3.4.5-py2.6.egg/zope/dottedname/resolve.py", line 32, in resolve
        found = __import__(used)
      File "/usr/lib/python2.5/site-packages/speechd_config/__init__.py", line 17, in <module>
        from config import *
      File "/usr/lib/python2.5/site-packages/speechd_config/config.py", line 947, in <module>
        options = Options()
      File "/usr/lib/python2.5/site-packages/speechd_config/config.py", line 247, in __init__
        (cmdline_options, args) = self.cmdline_parser.parse_args()
      File "/usr/lib/python2.6/optparse.py", line 1396, in parse_args
        self.error(str(err))
      File "/usr/lib/python2.6/optparse.py", line 1578, in error
        self.exit(2, "%s: error: %s\n" % (self.get_prog_name(), msg))
      File "/usr/lib/python2.6/optparse.py", line 1568, in exit
        sys.exit(status)
    SystemExit: 2
----------------------------------------------------------------------
File "/.../plone-coredev/eggs/z3c.autoinclude-0.3.1-py2.6.egg/z3c/autoinclude/tests/../dependency.txt", line 126, in dependency.txt
Failed example:
    dummy = xmlconfig.file(resource_filename('a', 'configure.zcml'),
                           package=a)
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python2.6/doctest.py", line 1241, in __run
        compileflags, 1) in test.globs
      File "<doctest dependency.txt[29]>", line 2, in <module>
        package=a)
      File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 647, in file
        include(context, name, package)
      File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 546, in include
        processxmlfile(f, context)
      File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 378, in processxmlfile
        parser.parse(src)
      File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 109, in parse
        xmlreader.IncrementalParser.parse(self, source)
      File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/xmlreader.py", line 123, in parse
        self.feed(buffer)
      File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 216, in feed
        self._parser.Parse(data, isFinal)
      File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 364, in end_element_ns
        self._cont_handler.endElementNS(pair, None)
      File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 357, in endElementNS
        self.context.end()
      File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 537, in end
        self.stack.pop().finish()
      File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 685, in finish
        actions = self.handler(context, **args)
      File "/.../plone-coredev/eggs/z3c.autoinclude-0.3.1-py2.6.egg/z3c/autoinclude/zcml.py", line 54, in includeDependenciesDirective
        includeZCMLGroup(_context, info, 'configure.zcml')
      File "/.../plone-coredev/eggs/z3c.autoinclude-0.3.1-py2.6.egg/z3c/autoinclude/zcml.py", line 30, in includeZCMLGroup
        include(_context, filename, includable_package)
      File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 546, in include
        processxmlfile(f, context)
      File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 378, in processxmlfile
        parser.parse(src)
      File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 109, in parse
        xmlreader.IncrementalParser.parse(self, source)
      File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/xmlreader.py", line 123, in parse
        self.feed(buffer)
      File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 216, in feed
        self._parser.Parse(data, isFinal)
      File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 364, in end_element_ns
        self._cont_handler.endElementNS(pair, None)
      File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 357, in endElementNS
        self.context.end()
      File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 537, in end
        self.stack.pop().finish()
      File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 685, in finish
        actions = self.handler(context, **args)
      File "/.../plone-coredev/eggs/z3c.autoinclude-0.3.1-py2.6.egg/z3c/autoinclude/zcml.py", line 51, in includeDependenciesDirective
        info = DependencyFinder(dist).includableInfo(['configure.zcml', 'meta.zcml'])
      File "/.../plone-coredev/eggs/z3c.autoinclude-0.3.1-py2.6.egg/z3c/autoinclude/dependency.py", line 24, in includableInfo
        module = resolve(dotted_name)
      File "/.../plone-coredev/eggs/zope.dottedname-3.4.5-py2.6.egg/zope/dottedname/resolve.py", line 32, in resolve
        found = __import__(used)
      File "/usr/lib/python2.5/site-packages/speechd_config/__init__.py", line 17, in <module>
        from config import *
      File "/usr/lib/python2.5/site-packages/speechd_config/config.py", line 947, in <module>
        options = Options()
      File "/usr/lib/python2.5/site-packages/speechd_config/config.py", line 247, in __init__
        (cmdline_options, args) = self.cmdline_parser.parse_args()
      File "/usr/lib/python2.6/optparse.py", line 1396, in parse_args
        self.error(str(err))
      File "/usr/lib/python2.6/optparse.py", line 1578, in error
        self.exit(2, "%s: error: %s\n" % (self.get_prog_name(), msg))
      File "/usr/lib/python2.6/optparse.py", line 1568, in exit
        sys.exit(status)
    SystemExit: 2
----------------------------------------------------------------------
File "/.../plone-coredev/eggs/z3c.autoinclude-0.3.1-py2.6.egg/z3c/autoinclude/tests/../dependency.txt", line 129, in dependency.txt
Failed example:
    pprint(test_log)
Expected:
    [u'f.g meta has been loaded',
     u'f.h has been loaded',
     u'BCPackage has been loaded']
Got:
    []
----------------------------------------------------------------------
File "/.../plone-coredev/eggs/z3c.autoinclude-0.3.1-py2.6.egg/z3c/autoinclude/tests/../dependency.txt", line 142, in dependency.txt
Failed example:
    pprint(package_includes('BCPackage'))
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python2.6/doctest.py", line 1241, in __run
        compileflags, 1) in test.globs
      File "<doctest dependency.txt[33]>", line 1, in <module>
        pprint(package_includes('BCPackage'))
      File "/.../plone-coredev/eggs/z3c.autoinclude-0.3.1-py2.6.egg/z3c/autoinclude/dependency.py", line 42, in package_includes
        return include_finder.includableInfo(zcml_filenames)
      File "/.../plone-coredev/eggs/z3c.autoinclude-0.3.1-py2.6.egg/z3c/autoinclude/dependency.py", line 24, in includableInfo
        module = resolve(dotted_name)
      File "/.../plone-coredev/eggs/zope.dottedname-3.4.5-py2.6.egg/zope/dottedname/resolve.py", line 32, in resolve
        found = __import__(used)
      File "/usr/lib/python2.5/site-packages/speechd_config/__init__.py", line 17, in <module>
        from config import *
      File "/usr/lib/python2.5/site-packages/speechd_config/config.py", line 947, in <module>
        options = Options()
      File "/usr/lib/python2.5/site-packages/speechd_config/config.py", line 247, in __init__
        (cmdline_options, args) = self.cmdline_parser.parse_args()
      File "/usr/lib/python2.6/optparse.py", line 1396, in parse_args
        self.error(str(err))
      File "/usr/lib/python2.6/optparse.py", line 1578, in error
        self.exit(2, "%s: error: %s\n" % (self.get_prog_name(), msg))
      File "/usr/lib/python2.6/optparse.py", line 1568, in exit
        sys.exit(status)
    SystemExit: 2
----------------------------------------------------------------------
File "/.../plone-coredev/eggs/z3c.autoinclude-0.3.1-py2.6.egg/z3c/autoinclude/tests/../dependency.txt", line 149, in dependency.txt
Failed example:
    pprint(package_includes('BCPackage', ['configure.zcml', 'silly.zcml']))
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python2.6/doctest.py", line 1241, in __run
        compileflags, 1) in test.globs
      File "<doctest dependency.txt[34]>", line 1, in <module>
        pprint(package_includes('BCPackage', ['configure.zcml', 'silly.zcml']))
      File "/.../plone-coredev/eggs/z3c.autoinclude-0.3.1-py2.6.egg/z3c/autoinclude/dependency.py", line 42, in package_includes
        return include_finder.includableInfo(zcml_filenames)
      File "/.../plone-coredev/eggs/z3c.autoinclude-0.3.1-py2.6.egg/z3c/autoinclude/dependency.py", line 24, in includableInfo
        module = resolve(dotted_name)
      File "/.../plone-coredev/eggs/zope.dottedname-3.4.5-py2.6.egg/zope/dottedname/resolve.py", line 32, in resolve
        found = __import__(used)
      File "/usr/lib/python2.5/site-packages/speechd_config/__init__.py", line 17, in <module>
        from config import *
      File "/usr/lib/python2.5/site-packages/speechd_config/config.py", line 947, in <module>
        options = Options()
      File "/usr/lib/python2.5/site-packages/speechd_config/config.py", line 247, in __init__
        (cmdline_options, args) = self.cmdline_parser.parse_args()
      File "/usr/lib/python2.6/optparse.py", line 1396, in parse_args
        self.error(str(err))
      File "/usr/lib/python2.6/optparse.py", line 1578, in error
        self.exit(2, "%s: error: %s\n" % (self.get_prog_name(), msg))
      File "/usr/lib/python2.6/optparse.py", line 1568, in exit
        sys.exit(status)
    SystemExit: 2


                    
  Ran 260 tests with 1 failures and 2 errors in # minutes # seconds.
Tearing down left over layers:
  Tear down zope.testing.testrunner.layer.UnitTests in # seconds.
Total: 310 tests, 1 failures, 2 errors in # minutes # seconds.
#### Finished tests for group plone ####

#### Running tests for group portlets ####
Running Products.PloneTestCase.layer.PloneSite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up Products.PloneTestCase.layer.ZCML in # seconds.
  Set up Products.PloneTestCase.layer.PloneSite in # seconds.
  Running:
                    
  Ran 166 tests with 0 failures and 0 errors in # seconds.
Running plone.app.portlets.tests.test_configuration.TestPortletZCMLLayer tests:
  Set up plone.app.portlets.tests.test_configuration.TestPortletZCMLLayer in # seconds.
  Running:
                
  Ran 5 tests with 0 failures and 0 errors in # seconds.
Running plone.app.portlets.tests.test_configuration.TestPortletGSLayer tests:
  Set up plone.app.portlets.tests.test_configuration.TestPortletGSLayer in # seconds.
  Running:
                  
  Ran 11 tests with 0 failures and 0 errors in # seconds.
Running zope.testing.testrunner.layer.UnitTests tests:
  Tear down plone.app.portlets.tests.test_configuration.TestPortletGSLayer in # seconds.
  Tear down plone.app.portlets.tests.test_configuration.TestPortletZCMLLayer in # seconds.
  Tear down Products.PloneTestCase.layer.PloneSite in # seconds.
  Tear down Products.PloneTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up zope.testing.testrunner.layer.UnitTests in # seconds.
  Running:
    37/54 (68.5%)/usr/lib/python2.6/mhlib.py:83: DeprecationWarning: the multifile module has been deprecated since Python 2.5
  import multifile


Error in test /.../plone-coredev/eggs/plone.portlets-1.2-py2.6.egg/plone/portlets/README.txt
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 270, in run
    self.setUp()
  File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 2289, in setUp
    self._dt_setUp(test)
  File "/.../plone-coredev/eggs/plone.portlets-1.2-py2.6.egg/plone/portlets/tests.py", line 40, in configurationSetUp
    XMLConfig('configure.zcml', zope.app.security)()
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 703, in __init__
    include(context, file_name, module)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 546, in include
    processxmlfile(f, context)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 378, in processxmlfile
    parser.parse(src)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 109, in parse
    xmlreader.IncrementalParser.parse(self, source)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/xmlreader.py", line 123, in parse
    self.feed(buffer)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 216, in feed
    self._parser.Parse(data, isFinal)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 364, in end_element_ns
    self._cont_handler.endElementNS(pair, None)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 357, in endElementNS
    self.context.end()
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 537, in end
    self.stack.pop().finish()
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 685, in finish
    actions = self.handler(context, **args)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 546, in include
    processxmlfile(f, context)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 378, in processxmlfile
    parser.parse(src)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 109, in parse
    xmlreader.IncrementalParser.parse(self, source)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/xmlreader.py", line 123, in parse
    self.feed(buffer)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 216, in feed
    self._parser.Parse(data, isFinal)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 353, in start_element_ns
    AttributesNSImpl(newattrs, qnames))
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 230, in startElementNS
    self.context.begin(name, data, info)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 534, in begin
    self.stack.append(self.stack[-1].contained(__name, __data, __info))
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 835, in contained
    return RootStackItem.contained(self, name, data, info)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 706, in contained
    adapter = factory(self.context, data, info)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 1179, in factory
    args = toargs(context, schema, data)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 1376, in toargs
    args[str(name)] = field.fromUnicode(s)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/fields.py", line 139, in fromUnicode
    value = self.context.resolve(name)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 180, in resolve
    mod = __import__(mname, *_import_chickens)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/__init__.py", line 105, in <module>
    import Context
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/Context.py", line 15, in <module>
    import CoreFunctions
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/CoreFunctions.py", line 20, in <module>
    from xml.xpath import Util, Conversions
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/Conversions.py", line 22, in <module>
    from xml.utils import boolean
ZopeXMLConfigurationError: File "/.../plone-coredev/eggs/zope.app.security-3.7.0-py2.6.egg/zope/app/security/configure.zcml", line 11.2-11.39
    ZopeXMLConfigurationError: File "/.../plone-coredev/eggs/zope.app.security-3.7.0-py2.6.egg/zope/app/security/globalmodules.zcml", line 375.2
    ImportError: cannot import name boolean

    45/54 (83.3%)

Error in test /.../plone-coredev/eggs/plone.portlets-1.2-py2.6.egg/plone/portlets/uisupport.txt
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 270, in run
    self.setUp()
  File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 2289, in setUp
    self._dt_setUp(test)
  File "/.../plone-coredev/eggs/plone.portlets-1.2-py2.6.egg/plone/portlets/tests.py", line 40, in configurationSetUp
    XMLConfig('configure.zcml', zope.app.security)()
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 703, in __init__
    include(context, file_name, module)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 546, in include
    processxmlfile(f, context)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 378, in processxmlfile
    parser.parse(src)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 109, in parse
    xmlreader.IncrementalParser.parse(self, source)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/xmlreader.py", line 123, in parse
    self.feed(buffer)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 216, in feed
    self._parser.Parse(data, isFinal)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 364, in end_element_ns
    self._cont_handler.endElementNS(pair, None)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 357, in endElementNS
    self.context.end()
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 537, in end
    self.stack.pop().finish()
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 685, in finish
    actions = self.handler(context, **args)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 546, in include
    processxmlfile(f, context)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 378, in processxmlfile
    parser.parse(src)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 109, in parse
    xmlreader.IncrementalParser.parse(self, source)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/xmlreader.py", line 123, in parse
    self.feed(buffer)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 216, in feed
    self._parser.Parse(data, isFinal)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 353, in start_element_ns
    AttributesNSImpl(newattrs, qnames))
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 230, in startElementNS
    self.context.begin(name, data, info)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 534, in begin
    self.stack.append(self.stack[-1].contained(__name, __data, __info))
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 835, in contained
    return RootStackItem.contained(self, name, data, info)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 706, in contained
    adapter = factory(self.context, data, info)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 1179, in factory
    args = toargs(context, schema, data)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 1376, in toargs
    args[str(name)] = field.fromUnicode(s)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/fields.py", line 139, in fromUnicode
    value = self.context.resolve(name)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 180, in resolve
    mod = __import__(mname, *_import_chickens)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/__init__.py", line 105, in <module>
    import Context
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/Context.py", line 15, in <module>
    import CoreFunctions
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/CoreFunctions.py", line 17, in <module>
    from xml.xpath import ExpandedNameWrapper
ZopeXMLConfigurationError: File "/.../plone-coredev/eggs/zope.app.security-3.7.0-py2.6.egg/zope/app/security/configure.zcml", line 11.2-11.39
    ZopeXMLConfigurationError: File "/.../plone-coredev/eggs/zope.app.security-3.7.0-py2.6.egg/zope/app/security/globalmodules.zcml", line 375.2
    ImportError: cannot import name ExpandedNameWrapper

    51/54 (94.4%)

Error in test /.../plone-coredev/eggs/plone.portlets-1.2-py2.6.egg/plone/portlets/utils.txt
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 270, in run
    self.setUp()
  File "/.../plone-coredev/eggs/zope.testing-3.7.7-py2.6.egg/zope/testing/doctest.py", line 2289, in setUp
    self._dt_setUp(test)
  File "/.../plone-coredev/eggs/plone.portlets-1.2-py2.6.egg/plone/portlets/tests.py", line 40, in configurationSetUp
    XMLConfig('configure.zcml', zope.app.security)()
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 703, in __init__
    include(context, file_name, module)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 546, in include
    processxmlfile(f, context)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 378, in processxmlfile
    parser.parse(src)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 109, in parse
    xmlreader.IncrementalParser.parse(self, source)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/xmlreader.py", line 123, in parse
    self.feed(buffer)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 216, in feed
    self._parser.Parse(data, isFinal)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 364, in end_element_ns
    self._cont_handler.endElementNS(pair, None)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 357, in endElementNS
    self.context.end()
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 537, in end
    self.stack.pop().finish()
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 685, in finish
    actions = self.handler(context, **args)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 546, in include
    processxmlfile(f, context)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 378, in processxmlfile
    parser.parse(src)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 109, in parse
    xmlreader.IncrementalParser.parse(self, source)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/xmlreader.py", line 123, in parse
    self.feed(buffer)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 216, in feed
    self._parser.Parse(data, isFinal)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/sax/expatreader.py", line 353, in start_element_ns
    AttributesNSImpl(newattrs, qnames))
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/xmlconfig.py", line 230, in startElementNS
    self.context.begin(name, data, info)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 534, in begin
    self.stack.append(self.stack[-1].contained(__name, __data, __info))
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 835, in contained
    return RootStackItem.contained(self, name, data, info)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 706, in contained
    adapter = factory(self.context, data, info)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 1179, in factory
    args = toargs(context, schema, data)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 1376, in toargs
    args[str(name)] = field.fromUnicode(s)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/fields.py", line 139, in fromUnicode
    value = self.context.resolve(name)
  File "/.../plone-coredev/eggs/zope.configuration-3.6.0-py2.6.egg/zope/configuration/config.py", line 180, in resolve
    mod = __import__(mname, *_import_chickens)
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/__init__.py", line 105, in <module>
    import Context
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/Context.py", line 15, in <module>
    import CoreFunctions
  File "/usr/lib/python2.6/dist-packages/_xmlplus/xpath/CoreFunctions.py", line 17, in <module>
    from xml.xpath import ExpandedNameWrapper
ZopeXMLConfigurationError: File "/.../plone-coredev/eggs/zope.app.security-3.7.0-py2.6.egg/zope/app/security/configure.zcml", line 11.2-11.39
    ZopeXMLConfigurationError: File "/.../plone-coredev/eggs/zope.app.security-3.7.0-py2.6.egg/zope/app/security/globalmodules.zcml", line 375.2
    ImportError: cannot import name ExpandedNameWrapper

                  
  Ran 54 tests with 0 failures and 3 errors in # seconds.
Tearing down left over layers:
  Tear down zope.testing.testrunner.layer.UnitTests in # seconds.
Total: 236 tests, 0 failures, 3 errors in # minutes # seconds.
#### Finished tests for group portlets ####

#### Running tests for Products.CMFPlacefulWorkflow ####
Running Products.PloneTestCase.layer.PloneSite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up Products.PloneTestCase.layer.ZCML in # seconds.
  Set up Products.PloneTestCase.layer.PloneSite in # seconds.
  Running:
                  
  Ran 23 tests with 0 failures and 0 errors in # seconds.
Running Products.CMFPlacefulWorkflow.tests.test_exportimport.ExportImportLayer tests:
  Set up Products.CMFPlacefulWorkflow.tests.test_exportimport.ExportImportLayer in # seconds.
  Running:
                  
  Ran 11 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down Products.CMFPlacefulWorkflow.tests.test_exportimport.ExportImportLayer in # seconds.
  Tear down Products.PloneTestCase.layer.PloneSite in # seconds.
  Tear down Products.PloneTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
Total: 34 tests, 0 failures, 0 errors in # minutes # seconds.
#### Finished tests for Products.CMFPlacefulWorkflow ####

#### Running tests for Products.CMFTestCase ####
Running Products.CMFTestCase.layer.CMFSite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up Products.CMFTestCase.layer.ZCML in # seconds.
  Set up Products.CMFTestCase.layer.CMFSite in # seconds.
  Running:
    5/58 (8.6%)

Error in test testDeleteLocalRoles (Products.CMFTestCase.testMembershipTool.TestMembershipTool)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Products.CMFTestCase/Products/CMFTestCase/testMembershipTool.py", line 220, in testDeleteLocalRoles
    self.membership.setLocalRoles(self.folder, ['user2'], 'Reviewer')
  File "<string>", line 4, in setLocalRoles
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/AccessControl/requestmethod.py", line 70, in _curried
    return callable(*args, **kw)
  File "/.../plone-coredev/src/Products.CMFCore/Products/CMFCore/MembershipTool.py", line 452, in setLocalRoles
    obj.reindexObjectSecurity()
AttributeError: reindexObjectSecurity

    18/58 (31.0%)

Error in test testSetLocalRoles (Products.CMFTestCase.testMembershipTool.TestMembershipTool)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Products.CMFTestCase/Products/CMFTestCase/testMembershipTool.py", line 214, in testSetLocalRoles
    self.membership.setLocalRoles(self.folder, [default_user, 'user2'], 'Reviewer')
  File "<string>", line 4, in setLocalRoles
  File "/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/AccessControl/requestmethod.py", line 70, in _curried
    return callable(*args, **kw)
  File "/.../plone-coredev/src/Products.CMFCore/Products/CMFCore/MembershipTool.py", line 452, in setLocalRoles
    obj.reindexObjectSecurity()
AttributeError: reindexObjectSecurity

                  
  Ran 58 tests with 0 failures and 2 errors in # seconds.
Tearing down left over layers:
  Tear down Products.CMFTestCase.layer.CMFSite in # seconds.
  Tear down Products.CMFTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
#### Finished tests for Products.CMFTestCase ####

#### Running tests for Products.ExtendedPathIndex ####
Running zope.testing.testrunner.layer.UnitTests tests:
  Set up zope.testing.testrunner.layer.UnitTests in # seconds.
  Running:
                  
  Ran 35 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down zope.testing.testrunner.layer.UnitTests in # seconds.
#### Finished tests for Products.ExtendedPathIndex ####

#### Running tests for Products.ExternalEditor ####
Running Testing.ZopeTestCase.layer.ZopeLite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Running:
    16/16 (100.0%)

Failure in test /.../plone-coredev/src/Products.ExternalEditor/Products/ExternalEditor/tests/edit.txt
Failed doctest test for edit.txt
  File "/.../plone-coredev/src/Products.ExternalEditor/Products/ExternalEditor/tests/edit.txt", line 0

----------------------------------------------------------------------
File "/.../plone-coredev/src/Products.ExternalEditor/Products/ExternalEditor/tests/edit.txt", line 18, in edit.txt
Failed example:
    print http(r"""
    GET /test_folder_1_/externalEdit_/some-file HTTP/1.1
    Authorization: Basic %s:%s
    """ % (user_name, user_password))
Differences (ndiff with -expected +actual):
      HTTP/1.1 200 OK
      Content-Length: 167
    - Content-Type: application/x-zope-edit; charset=iso-8859-15
    ?                                      ---------------------
    + Content-Type: application/x-zope-edit
    - Last-Modified:...
    + Last-Modified: Wed, 09 Sep 2009 18:36:01 GMT
      <BLANKLINE>
      url:http://localhost/test_folder_1_/some-file
      meta_type:File
      title:
      content_type:application/octet-stream
    - auth:...
    + auth:Basic dGVzdF91c2VyXzFfOnNlY3JldA==
      cookie:
      <BLANKLINE>
      some content
----------------------------------------------------------------------
File "/.../plone-coredev/src/Products.ExternalEditor/Products/ExternalEditor/tests/edit.txt", line 54, in edit.txt
Failed example:
    print http(r"""
    GET /test_folder_1_/externalEdit_/some-file HTTP/1.1
    Authorization: Basic %s:%s
    """ % (user_name, user_password))
Differences (ndiff with -expected +actual):
      HTTP/1.1 200 OK
    - Content-Length: ...
    ?                 ^^^
    + Content-Length: 236
    ?                 ^^^
    - Content-Type: application/x-zope-edit; charset=iso-8859-15
    ?                                      ---------------------
    + Content-Type: application/x-zope-edit
    - Last-Modified:...
    + Last-Modified: Wed, 09 Sep 2009 18:36:01 GMT
      <BLANKLINE>
      url:http://localhost/test_folder_1_/some-file
      meta_type:File
      title:
      content_type:application/octet-stream
    - auth:...
    + auth:Basic dGVzdF91c2VyXzFfOnNlY3JldA==
      cookie:
    - lock-token:...
    + lock-token:0.365642258174-0.287074370048-00105A989226:1252521361.462
      <BLANKLINE>
      some content
----------------------------------------------------------------------
File "/.../plone-coredev/src/Products.ExternalEditor/Products/ExternalEditor/tests/edit.txt", line 76, in edit.txt
Failed example:
    print http(r"""
    GET /test_folder_1_/externalEdit_/some-file?borrow_lock=1 HTTP/1.1
    Authorization: Basic %s:%s
    """ % (user_name, user_password))
Differences (ndiff with -expected +actual):
      HTTP/1.1 200 OK
    - Content-Length: ...
    ?                 ^^^
    + Content-Length: 250
    ?                 ^^^
    - Content-Type: application/x-zope-edit; charset=iso-8859-15
    ?                                      ---------------------
    + Content-Type: application/x-zope-edit
    - Last-Modified:...
    + Last-Modified: Wed, 09 Sep 2009 18:36:01 GMT
      <BLANKLINE>
      url:http://localhost/test_folder_1_/some-file
      meta_type:File
      title:
      content_type:application/octet-stream
    - auth:...
    + auth:Basic dGVzdF91c2VyXzFfOnNlY3JldA==
      cookie:
    - lock-token:...
    + lock-token:0.365642258174-0.287074370048-00105A989226:1252521361.462
      borrow_lock:1
      <BLANKLINE>
      some content
----------------------------------------------------------------------
File "/.../plone-coredev/src/Products.ExternalEditor/Products/ExternalEditor/tests/edit.txt", line 126, in edit.txt
Failed example:
    print http(r"""
    GET /test_folder_1_/externalEdit_/some-file?borrow_lock=1 HTTP/1.1
    Authorization: Basic %s:%s
    """ % (user_name_2, user_password_2))
Differences (ndiff with -expected +actual):
      HTTP/1.1 200 OK
      Content-Length: 163
    - Content-Type: application/x-zope-edit; charset=iso-8859-15
    ?                                      ---------------------
    + Content-Type: application/x-zope-edit
    - Last-Modified:...
    + Last-Modified: Wed, 09 Sep 2009 18:36:01 GMT
      <BLANKLINE>
      url:http://localhost/test_folder_1_/some-file
      meta_type:File
      title:
      content_type:application/octet-stream
    - auth:...
    + auth:Basic dGVzdF91c2VyXzJfOmZyb2I=
      cookie:
      <BLANKLINE>
      some content
----------------------------------------------------------------------
File "/.../plone-coredev/src/Products.ExternalEditor/Products/ExternalEditor/tests/edit.txt", line 156, in edit.txt
Failed example:
    print http(r"""
    GET /test_folder_1_/externalEdit_/another-file HTTP/1.1
    Authorization: Basic %s:%s
    """ % (user_name, user_password))
Differences (ndiff with -expected +actual):
      HTTP/1.1 200 OK
      Content-Length: 140
    - Content-Type: application/x-zope-edit; charset=iso-8859-15
    ?                                      ---------------------
    + Content-Type: application/x-zope-edit
    - Last-Modified:...
    + Last-Modified: Wed, 09 Sep 2009 18:36:01 GMT
      <BLANKLINE>
      url:http://localhost/test_folder_1_/another-file
      meta_type:Side Effects
      title:
    - auth:...
    + auth:Basic dGVzdF91c2VyXzFfOnNlY3JldA==
      cookie:
      <BLANKLINE>
      some content
----------------------------------------------------------------------
File "/.../plone-coredev/src/Products.ExternalEditor/Products/ExternalEditor/tests/edit.txt", line 186, in edit.txt
Failed example:
    print http(r"""
    GET /test_folder_1_/externalEdit_/some-file?borrow_lock=1 HTTP/1.1
    Authorization: Basic %s:%s
    """ % (user_name, user_password))
Differences (ndiff with -expected +actual):
      HTTP/1.1 200 OK
      Content-Length: 191
    - Content-Type: application/x-zope-edit; charset=iso-8859-15
    ?                                      ---------------------
    + Content-Type: application/x-zope-edit
    - Last-Modified:...
    + Last-Modified: Wed, 09 Sep 2009 18:36:01 GMT
      <BLANKLINE>
      url:http://localhost/test_folder_1_/some-file
      meta_type:File
      title:
      content_type:application/octet-stream
    - auth:...
    + auth:Basic dGVzdF91c2VyXzFfOnNlY3JldA==
      cookie:
      x-my-custom-metadata:42
      <BLANKLINE>
      some content
----------------------------------------------------------------------
File "/.../plone-coredev/src/Products.ExternalEditor/Products/ExternalEditor/tests/edit.txt", line 244, in edit.txt
Failed example:
    print http(r"""
    GET /test_folder_1_/externalEdit_/some-file HTTP/1.1
    Authorization: Basic %s:%s
    """ % (user_name, user_password))
Differences (ndiff with -expected +actual):
      HTTP/1.1 200 OK
      Content-Encoding: gzip
      Content-Length: 159
    - Content-Type: application/x-zope-edit; charset=iso-8859-15
    ?                                      ---------------------
    + Content-Type: application/x-zope-edit
    - Last-Modified:...
    + Last-Modified: Wed, 09 Sep 2009 18:36:01 GMT
    + <BLANKLINE>
    +      -ͱ
    + 0=OPtСnE[
    + >-:~<lf)Рlmu}dR#Y,LOD0%~;DIZܨ܌\]
    + n
    + nymL~.Mi򉛪ome   


  Ran 16 tests with 1 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
#### Finished tests for Products.ExternalEditor ####

#### Running tests for Products.PasswordResetTool ####
Running Products.PloneTestCase.layer.PloneSite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up Products.PloneTestCase.layer.ZCML in # seconds.
  Set up Products.PloneTestCase.layer.PloneSite in # seconds.
  Running:
                  
  Ran 36 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down Products.PloneTestCase.layer.PloneSite in # seconds.
  Tear down Products.PloneTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
#### Finished tests for Products.PasswordResetTool ####

#### Running tests for Products.PloneTestCase ####
Running Products.PloneTestCase.layer.PloneSite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up Products.PloneTestCase.layer.ZCML in # seconds.
  Set up Products.PloneTestCase.layer.PloneSite in # seconds.
  Running:
    19/59 (32.2%)/.../plone-coredev/src/Products.PlonePAS/Products/PlonePAS/tools/membership.py:553: DeprecationWarning: credentialsChanged should be called with 'REQUEST' as second argument. The BBB code will be removed in CMF 2.3.
  self.credentialsChanged(password, REQUEST=REQUEST)
                  
  Ran 59 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down Products.PloneTestCase.layer.PloneSite in # seconds.
  Tear down Products.PloneTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
#### Finished tests for Products.PloneTestCase ####

#### Running tests for Products.ResourceRegistries ####
Running Products.PloneTestCase.layer.PloneSite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up Products.PloneTestCase.layer.ZCML in # seconds.
  Set up Products.PloneTestCase.layer.PloneSite in # seconds.
  Running:
                    
  Ran 239 tests with 0 failures and 0 errors in # seconds.
Running zope.testing.testrunner.layer.UnitTests tests:
  Tear down Products.PloneTestCase.layer.PloneSite in # seconds.
  Tear down Products.PloneTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up zope.testing.testrunner.layer.UnitTests in # seconds.
  Running:
                  
  Ran 55 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down zope.testing.testrunner.layer.UnitTests in # seconds.
Total: 294 tests, 0 failures, 0 errors in # minutes # seconds.
#### Finished tests for Products.ResourceRegistries ####

#### Running tests for Products.SecureMailHost ####
Running Testing.ZopeTestCase.layer.ZopeLite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Running:
    2/8 (25.0%)

Failure in test testMessage (Products.SecureMailHost.tests.test_messages.TestBuergschaftLatin1)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/eggs/Products.SecureMailHost-1.1.2-py2.6.egg/Products/SecureMailHost/tests/test_messages.py", line 77, in testMessage
    self.failUnlessEqual(m, o)
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: 'Date: Wed, 31 Dec 1969 16:00:00 -0800' != 'Date: Thu, 01 Jan 1970 01:00:00 +0100'

    3/8 (37.5%)

Failure in test testMessage (Products.SecureMailHost.tests.test_messages.TestBuergschaftASCII)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/eggs/Products.SecureMailHost-1.1.2-py2.6.egg/Products/SecureMailHost/tests/test_messages.py", line 77, in testMessage
    self.failUnlessEqual(m, o)
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: 'Date: Wed, 31 Dec 1969 16:00:00 -0800' != 'Date: Thu, 01 Jan 1970 01:00:00 +0100'

    4/8 (50.0%)

Failure in test testMessage (Products.SecureMailHost.tests.test_messages.TestBuergschaftUTF8)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/eggs/Products.SecureMailHost-1.1.2-py2.6.egg/Products/SecureMailHost/tests/test_messages.py", line 77, in testMessage
    self.failUnlessEqual(m, o)
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: 'Date: Wed, 31 Dec 1969 16:00:00 -0800' != 'Date: Thu, 01 Jan 1970 01:00:00 +0100'

    5/8 (62.5%)

Failure in test testMessage (Products.SecureMailHost.tests.test_messages.TestLoremIpsum)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/eggs/Products.SecureMailHost-1.1.2-py2.6.egg/Products/SecureMailHost/tests/test_messages.py", line 77, in testMessage
    self.failUnlessEqual(m, o)
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: 'Date: Wed, 31 Dec 1969 16:00:00 -0800' != 'Date: Thu, 01 Jan 1970 01:00:00 +0100'

    6/8 (75.0%)

Failure in test testMessage (Products.SecureMailHost.tests.test_messages.TestMimeTextAndNonAsciiHeaders)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/eggs/Products.SecureMailHost-1.1.2-py2.6.egg/Products/SecureMailHost/tests/test_messages.py", line 77, in testMessage
    self.failUnlessEqual(m, o)
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: 'Date: Wed, 31 Dec 1969 16:00:00 -0800' != 'Date: Thu, 01 Jan 1970 01:00:00 +0100'

                
  Ran 8 tests with 5 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
#### Finished tests for Products.SecureMailHost ####

#### Running tests for Products.ZopeVersionControl ####
Running zope.testing.testrunner.layer.UnitTests tests:
  Set up zope.testing.testrunner.layer.UnitTests in # seconds.
  Running:
                  
  Ran 76 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down zope.testing.testrunner.layer.UnitTests in # seconds.
#### Finished tests for Products.ZopeVersionControl ####

#### Running tests for Products.i18ntestcase ####
Total: 0 tests, 0 failures, 0 errors in # seconds.
#### Finished tests for Products.i18ntestcase ####

#### Running tests for Products.kupu ####
/.../plone-coredev/eggs/Products.i18ntestcase-1.2-py2.6.egg/Products/i18ntestcase/PotTestCase.py:13: DeprecationWarning: The popen2 module is deprecated.  Use the subprocess module.
  from popen2 import popen4
Running Testing.ZopeTestCase.layer.ZopeLite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Running:
                
  Ran 3 tests with 0 failures and 0 errors in # seconds.
Running Products.PloneTestCase.layer.PloneSite tests:
  Set up Products.PloneTestCase.layer.ZCML in # seconds.
  Set up Products.PloneTestCase.layer.PloneSite in # seconds.
  Running:
    336/371 (90.6%)

Failure in test testSame (Products.kupu.plone.tests.test_html2captioned.TransformTestSubclass)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Products.kupu/Products/kupu/plone/tests/test_html2captioned.py", line 77, in testSame
    self.do_convert(filename=self.input)
  File "/.../plone-coredev/src/Products.kupu/Products/kupu/plone/tests/test_html2captioned.py", line 70, in do_convert
    got, expected, self.transform.name(), self.input))
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: Got:
[<div>Simple text containing an embedded image</div><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/gamma/image" alt="Kupu Test Image" title="Kupu Test Image" height="331" width="500" /></dt><dd class="image-caption" style="width:500px">Test image caption</dd></dl><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/gamma/image_thumb" alt="Kupu Test Image" title="Kupu Test Image" height="84" width="128" /></dt><dd class="image-caption" style="width:500px">Test image caption</dd></dl><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/gamma/image" alt="Kupu Test Image" title="Kupu Test Image" height="331" width="500" /></dt><dd class="image-caption" style="width:500px">Test image caption</dd></dl>]

!=

Expected:
[<div>Simple text containing an embedded image</div><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/gamma/image" alt="Kupu Test Image" title="Kupu Test Image" height="331" width="500" /></dt><dd class="image-caption" style="width:500px">Test image caption</dd></dl><dl class="image-left captioned"><dt><a rel="lightbox" href="/plone/folder/gamma"><img src="http://nohost/plone/folder/gamma/image_thumb" alt="Kupu Test Image" title="Kupu Test Image" height="84" width="128" /></a></dt><dd class="image-caption" style="width:128px">Test image caption</dd></dl><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/gamma/image" alt="Kupu Test Image" title="Kupu Test Image" height="331" width="500" /></dt><dd class="image-caption" style="width:500px">Test image caption</dd></dl>]

IN html_to_captioned(/.../plone-coredev/src/Products.kupu/Products/kupu/plone/tests/input/simple.in)

    337/371 (90.8%)

Failure in test testSameNoFilename (Products.kupu.plone.tests.test_html2captioned.TransformTestSubclass)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Products.kupu/Products/kupu/plone/tests/test_html2captioned.py", line 81, in testSameNoFilename
    self.do_convert()
  File "/.../plone-coredev/src/Products.kupu/Products/kupu/plone/tests/test_html2captioned.py", line 70, in do_convert
    got, expected, self.transform.name(), self.input))
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: Got:
[<div>Simple text containing an embedded image</div><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/gamma/image" alt="Kupu Test Image" title="Kupu Test Image" height="331" width="500" /></dt><dd class="image-caption" style="width:500px">Test image caption</dd></dl><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/gamma/image_thumb" alt="Kupu Test Image" title="Kupu Test Image" height="84" width="128" /></dt><dd class="image-caption" style="width:500px">Test image caption</dd></dl><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/gamma/image" alt="Kupu Test Image" title="Kupu Test Image" height="331" width="500" /></dt><dd class="image-caption" style="width:500px">Test image caption</dd></dl>]

!=

Expected:
[<div>Simple text containing an embedded image</div><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/gamma/image" alt="Kupu Test Image" title="Kupu Test Image" height="331" width="500" /></dt><dd class="image-caption" style="width:500px">Test image caption</dd></dl><dl class="image-left captioned"><dt><a rel="lightbox" href="/plone/folder/gamma"><img src="http://nohost/plone/folder/gamma/image_thumb" alt="Kupu Test Image" title="Kupu Test Image" height="84" width="128" /></a></dt><dd class="image-caption" style="width:128px">Test image caption</dd></dl><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/gamma/image" alt="Kupu Test Image" title="Kupu Test Image" height="331" width="500" /></dt><dd class="image-caption" style="width:500px">Test image caption</dd></dl>]

IN html_to_captioned(/.../plone-coredev/src/Products.kupu/Products/kupu/plone/tests/input/simple.in)

    346/371 (93.3%)

Failure in test testSame (Products.kupu.plone.tests.test_html2captioned.TransformTestSubclass)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Products.kupu/Products/kupu/plone/tests/test_html2captioned.py", line 77, in testSame
    self.do_convert(filename=self.input)
  File "/.../plone-coredev/src/Products.kupu/Products/kupu/plone/tests/test_html2captioned.py", line 70, in do_convert
    got, expected, self.transform.name(), self.input))
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: Got:
[<div>Simple text containing an embedded image</div><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/umlauts/image" alt="Kupu Test Image åäö" title="Kupu Test Image åäö" height="331" width="500" /></dt><dd class="image-caption" style="width:500px">Test image caption åäö</dd></dl><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/umlauts/image_thumb" alt="Kupu Test Image åäö" title="Kupu Test Image åäö" height="84" width="128" /></dt><dd class="image-caption" style="width:500px">Test image caption åäö</dd></dl><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/umlauts/image" alt="Kupu Test Image åäö" title="Kupu Test Image åäö" height="331" width="500" /></dt><dd class="image-caption" style="width:500px">Test image caption åäö</dd></dl>]

!=

Expected:
[<div>Simple text containing an embedded image</div><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/umlauts/image" alt="Kupu Test Image åäö" title="Kupu Test Image åäö" height="331" width="500" /></dt><dd class="image-caption" style="width:500px">Test image caption åäö</dd></dl><dl class="image-left captioned"><dt><a rel="lightbox" href="/plone/folder/umlauts"><img src="http://nohost/plone/folder/umlauts/image_thumb" alt="Kupu Test Image åäö" title="Kupu Test Image åäö" height="84" width="128" /></a></dt><dd class="image-caption" style="width:128px">Test image caption åäö</dd></dl><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/umlauts/image" alt="Kupu Test Image åäö" title="Kupu Test Image åäö" height="331" width="500" /></dt><dd class="image-caption" style="width:500px">Test image caption åäö</dd></dl>]

IN html_to_captioned(/.../plone-coredev/src/Products.kupu/Products/kupu/plone/tests/input/umlauts.in)

    347/371 (93.5%)

Failure in test testSameNoFilename (Products.kupu.plone.tests.test_html2captioned.TransformTestSubclass)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/Products.kupu/Products/kupu/plone/tests/test_html2captioned.py", line 81, in testSameNoFilename
    self.do_convert()
  File "/.../plone-coredev/src/Products.kupu/Products/kupu/plone/tests/test_html2captioned.py", line 70, in do_convert
    got, expected, self.transform.name(), self.input))
  File "/usr/lib/python2.6/unittest.py", line 350, in failUnlessEqual
    (msg or '%r != %r' % (first, second))
AssertionError: Got:
[<div>Simple text containing an embedded image</div><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/umlauts/image" alt="Kupu Test Image åäö" title="Kupu Test Image åäö" height="331" width="500" /></dt><dd class="image-caption" style="width:500px">Test image caption åäö</dd></dl><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/umlauts/image_thumb" alt="Kupu Test Image åäö" title="Kupu Test Image åäö" height="84" width="128" /></dt><dd class="image-caption" style="width:500px">Test image caption åäö</dd></dl><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/umlauts/image" alt="Kupu Test Image åäö" title="Kupu Test Image åäö" height="331" width="500" /></dt><dd class="image-caption" style="width:500px">Test image caption åäö</dd></dl>]

!=

Expected:
[<div>Simple text containing an embedded image</div><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/umlauts/image" alt="Kupu Test Image åäö" title="Kupu Test Image åäö" height="331" width="500" /></dt><dd class="image-caption" style="width:500px">Test image caption åäö</dd></dl><dl class="image-left captioned"><dt><a rel="lightbox" href="/plone/folder/umlauts"><img src="http://nohost/plone/folder/umlauts/image_thumb" alt="Kupu Test Image åäö" title="Kupu Test Image åäö" height="84" width="128" /></a></dt><dd class="image-caption" style="width:128px">Test image caption åäö</dd></dl><dl class="image-left captioned"><dt><img src="http://nohost/plone/folder/umlauts/image" alt="Kupu Test Image åäö" title="Kupu Test Image åäö" height="331" width="500" /></dt><dd class="image-caption" style="width:500px">Test image caption åäö</dd></dl>]

IN html_to_captioned(/.../plone-coredev/src/Products.kupu/Products/kupu/plone/tests/input/umlauts.in)

                    
  Ran 371 tests with 4 failures and 0 errors in # minutes # seconds.
Running zope.testing.testrunner.layer.UnitTests tests:
  Tear down Products.PloneTestCase.layer.PloneSite in # seconds.
  Tear down Products.PloneTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up zope.testing.testrunner.layer.UnitTests in # seconds.
  Running:
                
  Ran 8 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down zope.testing.testrunner.layer.UnitTests in # seconds.
Total: 382 tests, 4 failures, 0 errors in # minutes # seconds.
#### Finished tests for Products.kupu ####

#### Running tests for five.customerize ####
Running Testing.ZopeTestCase.layer.ZopeLite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Running:
                  
  Ran 40 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
#### Finished tests for five.customerize ####

#### Running tests for kss.core ####
/.../plone-coredev/src/kss.core/kss/core/tests/test_kssview_core.py:165: UserWarning: The test_class you are using doesn't subclass from ZopeTestCase.Functional. Please fix that.
  tearDown=KSSViewTestCase.beforeTearDown.im_func))
Running Testing.ZopeTestCase.layer.ZopeLite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Running:
                
  Ran 1 tests with 0 failures and 0 errors in # seconds.
Running kss.core.tests.base.KSSLayer tests:
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up kss.core.tests.base.KSSCoreLayer in # seconds.
  Set up kss.core.tests.base.KSSLayer in # seconds.
  Running:
                  
  Ran 29 tests with 0 failures and 0 errors in # seconds.
Running kss.core.tests.test_ttwapi.layer tests:
  Set up kss.core.tests.test_ttwapi.layer in # seconds.
  Running:
                
  Ran 3 tests with 0 failures and 0 errors in # seconds.
Running zope.testing.testrunner.layer.UnitTests tests:
  Tear down kss.core.tests.test_ttwapi.layer in # seconds.
  Tear down kss.core.tests.base.KSSLayer in # seconds.
  Tear down kss.core.tests.base.KSSCoreLayer in # seconds.
  Set up zope.testing.testrunner.layer.UnitTests in # seconds.
  Running:
    14/14 (100.0%)/.../plone-coredev/src/kss.core/kss/core/siteview.txt:1: DeprecationWarning: ISite is deprecated. Moved to zope.location.interfaces. Importing from here will stop working in Zope 3.6
  =========
                  
  Ran 14 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down zope.testing.testrunner.layer.UnitTests in # seconds.
Total: 47 tests, 0 failures, 0 errors in # seconds.
#### Finished tests for kss.core ####

#### Running tests for plone.app.contentlisting ####
Running Products.PloneTestCase.layer.PloneSite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up Products.PloneTestCase.layer.ZCML in # seconds.
  Set up Products.PloneTestCase.layer.PloneSite in # seconds.
  Running:
                  
  Ran 25 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down Products.PloneTestCase.layer.PloneSite in # seconds.
  Tear down Products.PloneTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
#### Finished tests for plone.app.contentlisting ####

#### Running tests for plone.app.locales ####
Total: 0 tests, 0 failures, 0 errors in # seconds.
#### Finished tests for plone.app.locales ####

#### Running tests for plone.app.openid ####
Running Products.PloneTestCase.layer.PloneSite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up Products.PloneTestCase.layer.ZCML in # seconds.
  Set up Products.PloneTestCase.layer.PloneSite in # seconds.
  Running:
                
  Ran 3 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down Products.PloneTestCase.layer.PloneSite in # seconds.
  Tear down Products.PloneTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
#### Finished tests for plone.app.openid ####

#### Running tests for plone.app.search ####
Running Products.PloneTestCase.layer.PloneSite tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up Products.PloneTestCase.layer.ZCML in # seconds.
  Set up Products.PloneTestCase.layer.PloneSite in # seconds.
  Running:
    2/4 (50.0%)testing performance with 1000 pages
********************
old search page vs new search page
0.264065980911 vs 0.566802978516
********************
214.64445233% time usage


Failure in test test_performance_for_1000_items (plone.app.search.tests.test_search_performance.TestSetup)
Traceback (most recent call last):
  File "/usr/lib/python2.6/unittest.py", line 279, in run
    testMethod()
  File "/.../plone-coredev/src/plone.app.search/plone/app/search/tests/test_search_performance.py", line 162, in test_performance_for_1000_items
    self.failUnless((old_time*1.1) > new_time, "the new search results page is slower than the old search results page")
  File "/usr/lib/python2.6/unittest.py", line 325, in failUnless
    if not expr: raise self.failureException, msg
AssertionError: the new search results page is slower than the old search results page

    3/4 (75.0%)testing performance with 100 pages
********************
old search page vs new search page
0.223999977112 vs 0.238936185837
********************
106.667951005% time usage
                
  Ran 4 tests with 1 failures and 0 errors in # minutes # seconds.
Tearing down left over layers:
  Tear down Products.PloneTestCase.layer.PloneSite in # seconds.
  Tear down Products.PloneTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
#### Finished tests for plone.app.search ####

#### Running tests for wicked ####
Running Products.PloneTestCase.layer.ZCML tests:
  Set up Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up Products.PloneTestCase.layer.ZCML in # seconds.
  Running:
    12/16 (75.0%)/.../plone-coredev/src/wicked/wicked/cache.py:34: DeprecationWarning: object.__init__() takes no parameters
  super(CacheStore, self).__init__(self)
                  
  Ran 16 tests with 0 failures and 0 errors in # seconds.
Running wicked.at.tests.wickedtestcase.WickedSite tests:
  Set up Products.PloneTestCase.layer.PloneSite/.../plone-coredev/src/Products.Archetypes/Products/Archetypes/ArchetypeTool.py:70: DeprecationWarning: package_home is deprecated. import from App.Common instead
  from Globals import package_home
 in # seconds.
  Set up wicked.at.tests.wickedtestcase.WickedSite in # seconds.
  Running:
    1/23 (4.3%)/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/OFS/subscribers.py:73: DeprecationWarning: wicked.atcontent.ironicwiki.IronicWiki.manage_afterAdd is discouraged. You should use event subscribers instead.
  DeprecationWarning)
    5/23 (21.7%)/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/OFS/subscribers.py:73: DeprecationWarning: wicked.atcontent.ironicwiki.IronicWiki.manage_beforeDelete is discouraged. You should use event subscribers instead.
  DeprecationWarning)
    13/23 (56.5%)/.../plone-coredev/eggs/Zope2-2.12.0c1-py2.6-linux-i686.egg/OFS/subscribers.py:73: DeprecationWarning: wicked.atcontent.ironicwiki.IronicWiki.manage_afterClone is discouraged. You should use event subscribers instead.
  DeprecationWarning)
                  
  Ran 23 tests with 0 failures and 0 errors in # seconds.
Running wicked.at.tests.test_scope.Scoped tests:
  Set up wicked.at.tests.test_scope.Scoped in # seconds.
  Running:
                
  Ran 3 tests with 0 failures and 0 errors in # seconds.
Running wicked.plone.tests.SelectiveATCT tests:
  Tear down wicked.at.tests.test_scope.Scoped in # seconds.
  Tear down wicked.at.tests.wickedtestcase.WickedSite in # seconds.
  Set up wicked.plone.tests.SelectiveATCT in # seconds.
  Running:
                  
  Ran 22 tests with 0 failures and 0 errors in # seconds.
Running wicked.plone.tests.ZCMLLayer tests:
  Tear down wicked.plone.tests.SelectiveATCT in # seconds.
  Set up wicked.plone.tests.ZCMLLayer in # seconds.
  Running:
                
  Ran 8 tests with 0 failures and 0 errors in # seconds.
Running zope.testing.testrunner.layer.UnitTests tests:
  Tear down wicked.plone.tests.ZCMLLayer in # seconds.
  Tear down Products.PloneTestCase.layer.PloneSite in # seconds.
  Tear down Products.PloneTestCase.layer.ZCML in # seconds.
  Tear down Testing.ZopeTestCase.layer.ZopeLite in # seconds.
  Set up zope.testing.testrunner.layer.UnitTests in # seconds.
  Running:
                  
  Ran 34 tests with 0 failures and 0 errors in # seconds.
Tearing down left over layers:
  Tear down zope.testing.testrunner.layer.UnitTests in # seconds.
Total: 106 tests, 0 failures, 0 errors in # minutes # seconds.
#### Finished tests for wicked ####


#### Begin test results ####

Total time elapsed: # seconds

Failing tests in group Archetypes
Failing tests in group Plone
Failing tests in group PlonePAS
Failing tests in group plone
Failing tests in group portlets
Failing tests in Products.CMFTestCase
Failing tests in Products.ExternalEditor
Failing tests in Products.SecureMailHost
Failing tests in Products.kupu
Failing tests in plone.app.search
#### End test results ####

$ grep ' [1-9][0-9]* \(failures\|errors\)' plips/plip9352-review-rossp-tests.log
  Ran 511 tests with 4 failures and 0 errors in # minutes # seconds.
  Ran 22 tests with 3 failures and 0 errors in # seconds.
Total: 675 tests, 7 failures, 0 errors in # minutes # seconds.
  Ran 1776 tests with 7 failures and 4 errors in # minutes # seconds.
  Ran 13 tests with 0 failures and 1 errors in # seconds.
Total: 2277 tests, 7 failures, 5 errors in # minutes # seconds.
  Ran 148 tests with 0 failures and 1 errors in # seconds.
Total: 722 tests, 0 failures, 1 errors in # minutes # seconds.
  Ran 260 tests with 1 failures and 2 errors in # minutes # seconds.
Total: 310 tests, 1 failures, 2 errors in # minutes # seconds.
  Ran 54 tests with 0 failures and 3 errors in # seconds.
Total: 236 tests, 0 failures, 3 errors in # minutes # seconds.
  Ran 58 tests with 0 failures and 2 errors in # seconds.
  Ran 16 tests with 1 failures and 0 errors in # seconds.
  Ran 8 tests with 5 failures and 0 errors in # seconds.
  Ran 371 tests with 4 failures and 0 errors in # minutes # seconds.
Total: 382 tests, 4 failures, 0 errors in # minutes # seconds.
  Ran 4 tests with 1 failures and 0 errors in # minutes # seconds.
