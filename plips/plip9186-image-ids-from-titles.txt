PLIP 9186: Set Image IDs from Title field
=========================================

This PLIP is ready for review.

PLIP ticket: http://dev.plone.org/old/plone/ticket/9186


Summary of changes
------------------

The changes are limited to the plip9186-image-ids-from-titles branch of
Products.ATContentTypes:

- Images now choose their IDs based on entered Titles, as with other types.

- On creation form submission, the object's ID is assigned as follows:

    - If the Title field is the same as the name of the uploaded file, the ID is
      the contents of the Title field, without going through the typical
      Title-field-normalization filter. This maintains the old behavior as an
      option.
    
    - If the Title field is different than the name of the uploaded file, the ID
      is the normal munged Title field contents.

These are realized by a slight refactoring of _setATCTFileContent, which now
delegates to a _should_set_id_to_filename method in its subclasses, ATFile and
ATImage.


Please test
-----------

In addition to confirming the above, please test FTP and WebDAV uploads. Since
there is no opportunity to provide titles over those protocols, the behavior
should be unchanged.

Note that, when last I checked, FTP was broken in Plone 4. [Ed: It's reported
fixed now.]


Automated tests
---------------

The changes should be completely covered by browsertests in ATContentTypes. All
700 tests pass.


Needed documentation changes
----------------------------

A few minutes of googling finds no references to the Image type's old behavior.
If any exist, they should be updated to say something like "In the absense of a
title, an Image will use the name of the uploaded file as its short name."


Backward compatibility
-----------------------

After Eric and I both stared at an old-style "x and y or z" ternary hack for a
minute without realizing that's what it was, I changed it to use Python 2.5's
ternary syntax. Live a little, right? This makes ATContentTypes require at least
2.5. If fear gets the better of us, we can change that back.


Credits
-------

Erik Rose
