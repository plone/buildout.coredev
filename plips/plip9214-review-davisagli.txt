PLIP 9214 - Review - davisagli
==============================

Notes:
------

- The implementation looks sane and the review notes are impressive. :)  It's
  obvious that this has been well thought through, and has been tested in
  Maurits' client work as part of collective.emaillogin.

- As Maurits notes in his "Further Ideas" section, there are a few potential
  rough edges when the e-mail login is turned on.  But nothing that looks
  terribly worrisome, and the functionality as already implemented is certainly
  better than what we have now for people who want this feature.

- For the sake of this particular PLIP, I disagree with Erik's comment that
  delegating to a view to handle variation in the login UI would be
  appropriate.  I think that it has potential to be a separate useful PLIP if
  properly thought through, and could also allow for a plone.app.openid
  implementation that doesn't have to override so many things.  (Hmm, we
  probably need to adjust those to support the new e-mail login property too.)
  But I think that in trying to tack it on as part of this PLIP at this stage
  in the PLIP process, we'd be liable to make some hasty choices and end up
  with something that adds complexity without actually making things more
  flexible.

- I created a new site, turned on e-mail logins, created a user, and
  successfully logged in as that user using the e-mail address.  However,
  when I went to personalize_form and tried to edit the e-mail address,
  I got the following traceback:

    Traceback (innermost last):
      Module ZPublisher.Publish, line 127, in publish
      Module ZPublisher.mapply, line 77, in mapply
      Module ZPublisher.Publish, line 47, in call_object
      Module Products.CMFFormController.FSControllerPageTemplate, line 91, in __call__
      Module Products.CMFFormController.BaseControllerPageTemplate, line 26, in _call
      Module Products.CMFFormController.FormController, line 384, in validate
      Module ZPublisher.mapply, line 77, in mapply
      Module ZPublisher.Publish, line 47, in call_object
      Module Products.CMFFormController.FSControllerValidator, line 58, in __call__
      Module Products.CMFFormController.Script, line 145, in __call__
      Module Products.CMFCore.FSPythonScript, line 130, in __call__
      Module Shared.DC.Scripts.Bindings, line 324, in __call__
      Module Shared.DC.Scripts.Bindings, line 361, in _bindAndExec
      Module Products.PythonScripts.PythonScript, line 344, in _exec
      Module script, line 27, in validate_personalize
       - <FSControllerValidator at /fresh/validate_personalize>
       - Line 27
    Unauthorized: You are not allowed to access 'isMemberIdAllowed' in this context


Conclusion
----------

This PLIP takes a pragmatic and pretty non-controversial approach to adding
this feature.  The fact that this is hard to implement in an add-on without
monkey patching and the fact that this is a very commonly requested feature
(see uservoice) add to my willingness to accept the PLIP.

My FWT vote: +1 assuming the needed migration to add the property is completed,
the observed traceback is corrected, and the plone.app.openid login form is
updated. A script to migrate existing users to login by e-mail would be nice,
but isn't essential.
